˜
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Hangfire\HangfireBootstrapper .cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Hangfire $
{ 
public 

class  
HangfireBootstrapper %
:& '
IRegisteredObject( 9
{ 
public 
static 
readonly  
HangfireBootstrapper 3
Instance4 <
== >
new? B 
HangfireBootstrapperC W
(W X
)X Y
;Y Z
private

 
readonly

 
object

 
_lockObject

  +
=

, -
new

. 1
object

2 8
(

8 9
)

9 :
;

: ;
private 
bool 
_started 
; 
private 
BackgroundJobServer # 
_backgroundJobServer$ 8
;8 9
private  
HangfireBootstrapper $
($ %
)% &
{ 	
} 	
public 
void 
Start 
( 
) 
{ 	
lock 
( 
_lockObject 
) 
{ 
if 
( 
_started 
) 
return $
;$ %
_started 
= 
true 
;  
HostingEnvironment "
." #
RegisterObject# 1
(1 2
this2 6
)6 7
;7 8
GlobalConfiguration #
.# $
Configuration$ 1
.1 2
UseSqlServerStorage2 E
(E F
$strF U
)U V
;V W 
_backgroundJobServer $
=% &
new' *
BackgroundJobServer+ >
(> ?
)? @
;@ A
}   
}!! 	
public## 
void## 
Stop## 
(## 
)## 
{$$ 	
lock%% 
(%% 
_lockObject%% 
)%% 
{&&  
_backgroundJobServer'' $
?''$ %
.''% &
Dispose''& -
(''- .
)''. /
;''/ 0
HostingEnvironment)) "
.))" #
UnregisterObject))# 3
())3 4
this))4 8
)))8 9
;))9 :
}** 
}++ 	
void-- 
IRegisteredObject-- 
.-- 
Stop-- #
(--# $
bool--$ (
	immediate--) 2
)--2 3
{.. 	
Stop// 
(// 
)// 
;// 
}00 	
}11 
}22 ∏
NE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Hangfire\ApplicationPreload.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Hangfire $
{ 
public 

class 
ApplicationPreload #
:$ %
System& ,
., -
Web- 0
.0 1
Hosting1 8
.8 9%
IProcessHostPreloadClient9 R
{ 
public 
void 
Preload 
( 
string "
[" #
]# $

parameters% /
)/ 0
{ 	 
HangfireBootstrapper  
.  !
Instance! )
.) *
Start* /
(/ 0
)0 1
;1 2
} 	
}		 
}

 À
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\BundleConfig.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

class 
BundleConfig 
{ 
public 
static 
void 
RegisterBundles *
(* +
BundleCollection+ ;
bundles< C
)C D
{		 	
bundles 
. 
Add 
( 
new 
StyleBundle '
(' (
$str( 5
)5 6
.6 7
Include7 >
(> ?
$str "
," #
$str "
," #
$str   ,
,  , -
$str!! )
,!!) *
$str"" !
,""! "
$str## (
,##( )
$str$$ %
,$$% &
$str%% +
,%%+ ,
$str&& $
,&&$ %
$str'' %
,''% &
$str(( &
,((& '
$str)) 
,))  
$str** "
,**" #
$str++ #
,++# $
$str,, /
,,,/ 0
$str-- &
,--& '
$str.. &
,..& '
$str// 8
)00 
)00 
;00 
bundles22 
.22 
Add22 
(22 
new22 
ScriptBundle22 (
(22( )
$str22) 5
)225 6
.226 7
Include227 >
(22> ?
$str44 +
,44+ ,
$str55 '
,55' (
$str66 '
,66' (
$str77 (
,77( )
$str88 $
,88$ %
$str99 *
,99* +
$str::  
,::  !
$str;; '
,;;' (
$str== %
,==% &
$str>> )
,>>) *
$str?? )
,??) *
$str@@ 
,@@ 
$strAA 
,AA 
$strBB 6
,BB6 7
$strCC +
,CC+ ,
$strDD .
,DD. /
$strEE *
,EE* +
$strFF )
,FF) *
$strGG "
,GG" #
$strHH 7
)II 
)II 
;II 
bundlesKK 
.KK 
AddKK 
(KK 
newKK 
ScriptBundleKK (
(KK( )
$strKK) ;
)KK; <
.KK< =
IncludeKK= D
(KKD E
$strLL #
,LL# $
$strMM &
)NN 
)NN 
;NN 
BundleTablePP 
.PP 
EnableOptimizationsPP +
=PP, -
falsePP. 3
;PP3 4
}QQ 	
}RR 
}SS ô
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\FilterConfig.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

class 
FilterConfig 
{ 
public 
static 
void !
RegisterGlobalFilters 0
(0 1"
GlobalFilterCollection1 G
filtersH O
)O P
{ 	
filters		 
.		 
Add		 
(		 
new		  
HandleErrorAttribute		 0
(		0 1
)		1 2
)		2 3
;		3 4
}

 	
} 
} êS
KE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\IdentityConfig.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

class 
EmailService 
: #
IIdentityMessageService  7
{ 
public 
Task 
	SendAsync 
( 
IdentityMessage -
message. 5
)5 6
{ 	
return 
Task 
. 

FromResult "
(" #
$num# $
)$ %
;% &
} 	
} 
public 

class 

SmsService 
: #
IIdentityMessageService 5
{ 
public 
Task 
	SendAsync 
( 
IdentityMessage -
message. 5
)5 6
{ 	
return 
Task 
. 

FromResult "
(" #
$num# $
)$ %
;% &
} 	
} 
public   

class   "
ApplicationUserManager   '
:  ( )
UserManager  * 5
<  5 6
WfpUser  6 =
>  = >
{!! 
public"" "
ApplicationUserManager"" %
(""% &

IUserStore""& 0
<""0 1
WfpUser""1 8
>""8 9
store"": ?
)""? @
:""A B
base""C G
(""G H
store""H M
)""M N
{## 	
}$$ 	
public&& 
static&& "
ApplicationUserManager&& ,
Create&&- 3
(&&3 4"
IdentityFactoryOptions&&4 J
<&&J K"
ApplicationUserManager&&K a
>&&a b
options&&c j
,&&j k
IOwinContext&&l x
context	&&y Ä
)
&&Ä Å
{'' 	
var(( 
manager(( 
=(( 
new(( "
ApplicationUserManager(( 4
(((4 5
new((5 8
	UserStore((9 B
<((B C
WfpUser((C J
>((J K
(((K L
context((L S
.((S T
Get((T W
<((W X
WfpictContext((X e
>((e f
(((f g
)((g h
)((h i
)((i j
;((j k
manager** 
.** 
UserValidator** !
=**" #
new**$ '
UserValidator**( 5
<**5 6
WfpUser**6 =
>**= >
(**> ?
manager**? F
)**F G
{++ *
AllowOnlyAlphanumericUserNames,, .
=,,/ 0
false,,1 6
,,,6 7
RequireUniqueEmail-- "
=--# $
true--% )
}.. 
;.. 
manager11 
.11 
PasswordValidator11 %
=11& '
new11( +
PasswordValidator11, =
{22 
}88 
;88 
manager;; 
.;; '
UserLockoutEnabledByDefault;; /
=;;0 1
true;;2 6
;;;6 7
manager<< 
.<< )
DefaultAccountLockoutTimeSpan<< 1
=<<2 3
TimeSpan<<4 <
.<<< =
FromMinutes<<= H
(<<H I
$num<<I J
)<<J K
;<<K L
manager== 
.== 0
$MaxFailedAccessAttemptsBeforeLockout== 8
===9 :
$num==; <
;==< =
managerAA 
.AA %
RegisterTwoFactorProviderAA -
(AA- .
$strAA. :
,AA: ;
newAA< ?$
PhoneNumberTokenProviderAA@ X
<AAX Y
WfpUserAAY `
>AA` a
{BB 
MessageFormatCC 
=CC 
$strCC  ;
}DD 
)DD 
;DD 
managerEE 
.EE %
RegisterTwoFactorProviderEE -
(EE- .
$strEE. :
,EE: ;
newEE< ?
EmailTokenProviderEE@ R
<EER S
WfpUserEES Z
>EEZ [
{FF 
SubjectGG 
=GG 
$strGG )
,GG) *

BodyFormatHH 
=HH 
$strHH 8
}II 
)II 
;II 
managerJJ 
.JJ 
EmailServiceJJ  
=JJ! "
newJJ# &
EmailServiceJJ' 3
(JJ3 4
)JJ4 5
;JJ5 6
managerKK 
.KK 

SmsServiceKK 
=KK  
newKK! $

SmsServiceKK% /
(KK/ 0
)KK0 1
;KK1 2
varLL "
dataProtectionProviderLL &
=LL' (
optionsLL) 0
.LL0 1"
DataProtectionProviderLL1 G
;LLG H
ifMM 
(MM "
dataProtectionProviderMM &
!=MM' )
nullMM* .
)MM. /
{NN 
managerOO 
.OO 
UserTokenProviderOO )
=OO* +
newPP &
DataProtectorTokenProviderPP 2
<PP2 3
WfpUserPP3 :
>PP: ;
(PP; <"
dataProtectionProviderPP< R
.PPR S
CreatePPS Y
(PPY Z
$strPPZ l
)PPl m
)PPm n
;PPn o
}QQ 
returnRR 
managerRR 
;RR 
}SS 	
}TT 
publicVV 

classVV "
ApplicationRoleManagerVV '
:VV( )
RoleManagerVV* 5
<VV5 6
WfpRoleVV6 =
>VV= >
{WW 
publicXX "
ApplicationRoleManagerXX %
(XX% &

IRoleStoreXX& 0
<XX0 1
WfpRoleXX1 8
,XX8 9
stringXX: @
>XX@ A
	roleStoreXXB K
)XXK L
:XXL M
baseXXN R
(XXR S
	roleStoreXXS \
)XX\ ]
{YY 	
}ZZ 	
public\\ 
static\\ "
ApplicationRoleManager\\ ,
Create\\- 3
(\\3 4"
IdentityFactoryOptions\\4 J
<\\J K"
ApplicationRoleManager\\K a
>\\a b
options\\c j
,\\j k
IOwinContext\\l x
context	\\y Ä
)
\\Ä Å
{]] 	
return^^ 
new^^ "
ApplicationRoleManager^^ -
(^^- .
new^^. 1
	RoleStore^^2 ;
<^^; <
WfpRole^^< C
>^^C D
(^^D E
context^^E L
.^^L M
Get^^M P
<^^P Q
WfpictContext^^Q ^
>^^^ _
(^^_ `
)^^` a
)^^a b
)^^b c
;^^c d
}__ 	
publicaa 
voidaa 
AddClaimaa 
(aa 
WfpictContextaa *
ctxaa+ .
,aa. /
stringaa0 6
roleIdaa7 =
,aa= >
Guidaa? C
claimIdaaD K
)aaK L
{bb 	
ctxcc 
.cc 

RoleClaimscc 
.cc 
Addcc 
(cc 
newcc "
AspNetRoleClaimscc# 3
(cc3 4
)cc4 5
{dd 
Idee 
=ee 
Guidee 
.ee 
NewGuidee !
(ee! "
)ee" #
,ee# $
RoleIDff 
=ff 
roleIdff 
,ff  
ClaimIDgg 
=gg 
claimIdgg !
,gg! "
	CreatedAthh 
=hh 
DateTimehh $
.hh$ %
Nowhh% (
}ii 
)ii 
;ii 
ctxjj 
.jj 
SaveChangesjj 
(jj 
)jj 
;jj 
}kk 	
}ll 
publicoo 

classoo $
ApplicationSignInManageroo )
:oo* +
SignInManageroo, 9
<oo9 :
WfpUseroo: A
,ooA B
stringooC I
>ooI J
{pp 
publicqq $
ApplicationSignInManagerqq '
(qq' ("
ApplicationUserManagerqq( >
userManagerqq? J
,qqJ K"
IAuthenticationManagerqqL b!
authenticationManagerqqc x
)qqx y
:rr 
baserr 
(rr 
userManagerrr 
,rr !
authenticationManagerrr  5
)rr5 6
{ss 	
}tt 	
publicvv 
overridevv 
Taskvv 
<vv 
ClaimsIdentityvv +
>vv+ ,#
CreateUserIdentityAsyncvv- D
(vvD E
WfpUservvE L
uservvM Q
)vvQ R
{ww 	
returnxx 
userxx 
.xx %
GenerateUserIdentityAsyncxx 1
(xx1 2
(xx2 3"
ApplicationUserManagerxx3 I
)xxI J
UserManagerxxJ U
)xxU V
;xxV W
}yy 	
public{{ 
static{{ $
ApplicationSignInManager{{ .
Create{{/ 5
({{5 6"
IdentityFactoryOptions{{6 L
<{{L M$
ApplicationSignInManager{{M e
>{{e f
options{{g n
,{{n o
IOwinContext{{p |
context	{{} Ñ
)
{{Ñ Ö
{|| 	
return}} 
new}} $
ApplicationSignInManager}} /
(}}/ 0
context}}0 7
.}}7 8
GetUserManager}}8 F
<}}F G"
ApplicationUserManager}}G ]
>}}] ^
(}}^ _
)}}_ `
,}}` a
context}}b i
.}}i j
Authentication}}j x
)}}x y
;}}y z
}~~ 	
public
ÄÄ 
override
ÄÄ 
Task
ÄÄ 
SignInAsync
ÄÄ (
(
ÄÄ( )
WfpUser
ÄÄ) 0
user
ÄÄ1 5
,
ÄÄ5 6
bool
ÄÄ7 ;
isPersistent
ÄÄ< H
,
ÄÄH I
bool
ÄÄJ N
rememberBrowser
ÄÄO ^
)
ÄÄ^ _
{
ÅÅ 	
return
ÇÇ 
base
ÇÇ 
.
ÇÇ 
SignInAsync
ÇÇ #
(
ÇÇ# $
user
ÇÇ$ (
,
ÇÇ( )
isPersistent
ÇÇ* 6
,
ÇÇ6 7
rememberBrowser
ÇÇ8 G
)
ÇÇG H
;
ÇÇH I
}
ÉÉ 	
public
ÖÖ 
override
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
SignInStatus
ÖÖ )
>
ÖÖ) *"
TwoFactorSignInAsync
ÖÖ+ ?
(
ÖÖ? @
string
ÖÖ@ F
provider
ÖÖG O
,
ÖÖO P
string
ÖÖQ W
code
ÖÖX \
,
ÖÖ\ ]
bool
ÖÖ^ b
isPersistent
ÖÖc o
,
ÖÖo p
bool
ÖÖq u
rememberBrowserÖÖv Ö
)ÖÖÖ Ü
{
ÜÜ 	
return
áá 
base
áá 
.
áá "
TwoFactorSignInAsync
áá ,
(
áá, -
provider
áá- 5
,
áá5 6
code
áá7 ;
,
áá; <
isPersistent
áá= I
,
ááI J
rememberBrowser
ááK Z
)
ááZ [
;
áá[ \
}
àà 	
}
ªª 
}ºº ˜
HE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\RouteConfig.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

class 
RouteConfig 
{ 
public 
static 
void 
RegisterRoutes )
() *
RouteCollection* 9
routes: @
)@ A
{		 	
routes

 
.

 
IgnoreRoute

 
(

 
$str

 ;
)

; <
;

< =
routes 
. 
MapRoute 
( 
name 
: 
$str 
,  
url 
: 
$str 1
,1 2
defaults 
: 
new 
{ 

controller  *
=+ ,
$str- 8
,8 9
action: @
=A B
$strC J
,J K
idL N
=O P
UrlParameterQ ]
.] ^
Optional^ f
}g h
) 
; 
} 	
} 
} Ù
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\Startup.Auth.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
{

 
public 

partial 
class 
Startup  
{ 
public 
void 
ConfigureAuth !
(! "
IAppBuilder" -
app. 1
)1 2
{ 	
app 
.  
CreatePerOwinContext $
($ %
WfpictContext% 2
.2 3
Create3 9
)9 :
;: ;
app 
.  
CreatePerOwinContext $
<$ %"
ApplicationUserManager% ;
>; <
(< ="
ApplicationUserManager= S
.S T
CreateT Z
)Z [
;[ \
app 
.  
CreatePerOwinContext $
<$ %"
ApplicationRoleManager% ;
>; <
(< ="
ApplicationRoleManager= S
.S T
CreateT Z
)Z [
;[ \
app 
.  
CreatePerOwinContext $
<$ %$
ApplicationSignInManager% =
>= >
(> ?$
ApplicationSignInManager? W
.W X
CreateX ^
)^ _
;_ `
app 
. #
UseCookieAuthentication '
(' (
new( +'
CookieAuthenticationOptions, G
{ 
AuthenticationType "
=# $&
DefaultAuthenticationTypes% ?
.? @
ApplicationCookie@ Q
,Q R
	LoginPath 
= 
new 

PathString  *
(* +
$str+ ;
); <
,< =
Provider 
= 
new (
CookieAuthenticationProvider ;
{ 
OnValidateIdentity!! &
=!!' ("
SecurityStampValidator!!) ?
.!!? @
OnValidateIdentity!!@ R
<!!R S"
ApplicationUserManager!!S i
,!!i j
WfpUser!!k r
>!!r s
(!!s t
validateInterval"" (
:""( )
TimeSpan""* 2
.""2 3
FromMinutes""3 >
(""> ?
$num""? A
)""A B
,""B C
regenerateIdentity## *
:##* +
(##, -
manager##- 4
,##4 5
user##6 :
)##: ;
=>##< >
user##? C
.##C D%
GenerateUserIdentityAsync##D ]
(##] ^
manager##^ e
)##e f
)##f g
}$$ 
}%% 
)%% 
;%% 
app&& 
.&& #
UseExternalSignInCookie&& '
(&&' (&
DefaultAuthenticationTypes&&( B
.&&B C
ExternalCookie&&C Q
)&&Q R
;&&R S
app)) 
.)) $
UseTwoFactorSignInCookie)) (
())( )&
DefaultAuthenticationTypes))) C
.))C D
TwoFactorCookie))D S
,))S T
TimeSpan))U ]
.))] ^
FromMinutes))^ i
())i j
$num))j k
)))k l
)))l m
;))m n
app.. 
... -
!UseTwoFactorRememberBrowserCookie.. 1
(..1 2&
DefaultAuthenticationTypes..2 L
...L M*
TwoFactorRememberBrowserCookie..M k
)..k l
;..l m
}BB 	
}CC 
}DD •
HE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\UnityConfig.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public

 

class

 
UnityConfig

 
{ 
private 
static 
Lazy 
< 
IUnityContainer +
>+ ,

_container- 7
=8 9
new: =
Lazy> B
<B C
IUnityContainerC R
>R S
(S T
(T U
)U V
=>W Y
{ 	
var 
	container 
= 
new 
UnityContainer  .
(. /
)/ 0
;0 1
RegisterTypes 
( 
	container #
)# $
;$ %
return 
	container 
; 
} 	
)	 

;
 
public 
static 
IUnityContainer %"
GetConfiguredContainer& <
(< =
)= >
{ 	
return 

_container 
. 
Value #
;# $
} 	
public!! 
static!! 
void!! 
RegisterTypes!! (
(!!( )
IUnityContainer!!) 8
	container!!9 B
)!!B C
{"" 	
	container)) 
.)) 
RegisterType)) "
<))" #
Controllers))# .
.)). /
AccountController))/ @
>))@ A
())A B
new))B E 
InjectionConstructor))F Z
())Z [
)))[ \
)))\ ]
;))] ^
	container++ 
.++ 
RegisterType++ "
<++" #
System++# )
.++) *
Data++* .
.++. /
Entity++/ 5
.++5 6
	DbContext++6 ?
,++? @
WfpictContext++A N
>++N O
(++O P
new++P S'
HierarchicalLifetimeManager++T o
(++o p
)++p q
)++q r
;++r s
},, 	
}-- 
}.. €
NE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\UnityMvcActivator.cs
[ 
assembly 	
:	 

WebActivatorEx 
. %
PreApplicationStartMethod 3
(3 4
typeof4 :
(: ;
UnityWebActivator; L
)L M
,M N
$strO V
)V W
]W X
[ 
assembly 	
:	 

WebActivatorEx 
. %
ApplicationShutdownMethod 3
(3 4
typeof4 :
(: ;
UnityWebActivator; L
)L M
,M N
$strO Y
)Y Z
]Z [
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
{

 
public 

static 
class 
UnityWebActivator )
{ 
public 
static 
void 
Start  
(  !
)! "
{ 	
var 
	container 
= 
UnityConfig '
.' ("
GetConfiguredContainer( >
(> ?
)? @
;@ A
FilterProviders 
. 
	Providers %
.% &
Remove& ,
(, -
FilterProviders- <
.< =
	Providers= F
.F G
OfTypeG M
<M N)
FilterAttributeFilterProviderN k
>k l
(l m
)m n
.n o
Firsto t
(t u
)u v
)v w
;w x
FilterProviders 
. 
	Providers %
.% &
Add& )
() *
new* -.
"UnityFilterAttributeFilterProvider. P
(P Q
	containerQ Z
)Z [
)[ \
;\ ]
DependencyResolver 
. 
SetResolver *
(* +
new+ .#
UnityDependencyResolver/ F
(F G
	containerG P
)P Q
)Q R
;R S
} 	
public 
static 
void 
Shutdown #
(# $
)$ %
{ 	
var 
	container 
= 
UnityConfig '
.' ("
GetConfiguredContainer( >
(> ?
)? @
;@ A
	container   
.   
Dispose   
(   
)   
;    
}!! 	
}"" 
}## È
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\App_Start\WebApiConfig.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

static 
class 
WebApiConfig $
{		 
public

 
static

 
void

 
Register

 #
(

# $
HttpConfiguration

$ 5
config

6 <
)

< =
{ 	
config 
. "
MapHttpAttributeRoutes )
() *
)* +
;+ ,
config 
. 
Routes 
. 
MapHttpRoute &
(& '
name 
: 
$str "
," #
routeTemplate 
: 
$str 6
,6 7
defaults 
: 
new 
{ 
id  "
=# $
RouteParameter% 3
.3 4
Optional4 <
}= >
) 
; 
var 
jsonFormatter 
= 
config  &
.& '

Formatters' 1
.1 2
OfType2 8
<8 9"
JsonMediaTypeFormatter9 O
>O P
(P Q
)Q R
.R S
FirstS X
(X Y
)Y Z
;Z [
jsonFormatter 
. 
SerializerSettings ,
., -
ContractResolver- =
=> ?
new@ C2
&CamelCasePropertyNamesContractResolverD j
(j k
)k l
;l m
} 	
} 
} ’X
PE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\CompanyController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
public 

class 
CompanyController "
:# $
BaseController% 3
{ 
private "
ApplicationUserManager &
_userManager' 3
;3 4
private "
ApplicationUserManager &
UserManager' 2
{ 	
get 
{ 
return 
_userManager #
??$ &
HttpContext' 2
.2 3
GetOwinContext3 A
(A B
)B C
.C D
GetUserManagerD R
<R S"
ApplicationUserManagerS i
>i j
(j k
)k l
;l m
} 
} 	
public 
ActionResult 
Users !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
var 
model 
= 
UserManager #
.# $
Users$ )
.) *
Select* 0
(0 1
x1 2
=>3 5
new 
UserProfileVm 
( 
) 
{ 
Id   
=   
x   
.   
Id   
,   
UserName!! 
=!! 
x!! 
.!! 
UserName!! %
,!!% &
Email"" 
="" 
x"" 
."" 
Email"" 
,""  
DateCreated## 
=## 
x## 
.##  
	CreatedAt##  )
.##) *
ToString##* 2
(##2 3
)##3 4
,##4 5
Status$$ 
=$$ 
x$$ 
.$$ 
Status$$ !
,$$! "
Type%% 
=%% 
x%% 
.%% 
UserType%% !
,%%! "
	FirstName&& 
=&& 
x&& 
.&& 
	FirstName&& '
,&&' (
LastName'' 
='' 
x'' 
.'' 
LastName'' %
,''% &
CompanyName(( 
=(( 
x(( 
.((  
CompanyName((  +
,((+ ,
CompanyLogo)) 
=)) 
x)) 
.))  
CompanyLogo))  +
,))+ ,

WhiteLabel** 
=** 
x** 
.** 

WhiteLabel** )
,**) *
ReportTemplate++ 
=++  
x++! "
.++" #
ReportTemplate++# 1
,++1 2
IsTestsCreatives,,  
=,,! "
x,,# $
.,,$ %
IsTestsCreatives,,% 5
,,,5 6
	IsUsesApi-- 
=-- 
x-- 
.-- 
	IsUsesApi-- '
}.. 
).. 
... 
ToList.. 
(.. 
).. 
;.. 
ViewBag00 
.00 

WhiteLabel00 
=00  
CustomersList00! .
;00. /
int11 

pageNumber11 
=11 
(11 
sc11  
.11  !
Page11! %
??11& (
$num11) *
)11* +
;11+ ,
return22 
View22 
(22 
$str22 
,22  
model22! &
.22& '
ToPagedList22' 2
(222 3

pageNumber223 =
,22= >
PageSize22? G
)22G H
)22H I
;22I J
}33 	
public55 
ActionResult55 
ChangeWhiteLabel55 ,
(55, -
Guid55- 1
?551 2
userId553 9
,559 :
string55; A

whiteLabel55B L
)55L M
{66 	
try77 
{88 
var99 
user99 
=99 
UserManager99 &
.99& '
FindById99' /
(99/ 0
userId990 6
.996 7
ToString997 ?
(99? @
)99@ A
)99A B
;99B C
user:: 
.:: 

WhiteLabel:: 
=::  !

whiteLabel::" ,
;::, -
Db;; 
.;; 
SaveChanges;; 
(;; 
);;  
;;;  !
return<< 
Json<< 
(<< 
new<< 
JsonResponse<<  ,
(<<, -
)<<- .
{<</ 0
IsSucess<<1 9
=<<: ;
true<<< @
}<<A B
,<<B C
JsonRequestBehavior<<D W
.<<W X
AllowGet<<X `
)<<` a
;<<a b
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
{?? 
return@@ 
Json@@ 
(@@ 
new@@ 
JsonResponse@@  ,
(@@, -
)@@- .
{@@/ 0
IsSucess@@1 9
=@@: ;
false@@< A
,@@A B
ErrorMessage@@C O
=@@P Q
ex@@R T
.@@T U
Message@@U \
}@@] ^
,@@^ _
JsonRequestBehavior@@` s
.@@s t
AllowGet@@t |
)@@| }
;@@} ~
}AA 
}BB 	
publicCC 
ActionResultCC 
SaveUserCC $
(CC$ %
CompanyUsersVmCC% 3
modelCC4 9
)CC9 :
{DD 	
tryEE 
{FF 
varGG 
userGG 
=GG 
UserManagerGG &
.GG& '
FindByIdGG' /
(GG/ 0
modelGG0 5
.GG5 6
IdGG6 8
.GG8 9
ToStringGG9 A
(GGA B
)GGB C
)GGC D
;GGD E
switchHH 
(HH 
modelHH 
.HH 
ActionHH $
)HH$ %
{II 
caseJJ 
$strJJ 
:JJ  
ifKK 
(KK 
userKK  
.KK  !
StatusKK! '
==KK( *
(KK+ ,
intKK, /
)KK/ 0

UserStatusKK0 :
.KK: ;
ActiveKK; A
)KKA B
{LL 
userMM  
.MM  !
StatusMM! '
=MM( )
(MM* +
intMM+ .
)MM. /

UserStatusMM/ 9
.MM9 :
LockedMM: @
;MM@ A
userNN  
.NN  !
LockoutEndDateUtcNN! 2
=NN3 4
newNN5 8
DateTimeNN9 A
(NNA B
$numNNB F
,NNF G
$numNNH J
,NNJ K
$numNNL N
)NNN O
;NNO P
boolOO  
aOO! "
=OO# $
UserManagerOO% 0
.OO0 1
IsLockedOutOO1 <
(OO< =
userOO= A
.OOA B
IdOOB D
)OOD E
;OOE F
}PP 
elseQQ 
ifQQ 
(QQ  !
userQQ! %
.QQ% &
StatusQQ& ,
==QQ- /
(QQ0 1
intQQ1 4
)QQ4 5

UserStatusQQ5 ?
.QQ? @
LockedQQ@ F
)QQF G
{RR 
userSS  
.SS  !
StatusSS! '
=SS( )
(SS* +
intSS+ .
)SS. /

UserStatusSS/ 9
.SS9 :
ActiveSS: @
;SS@ A
userTT  
.TT  !
LockoutEndDateUtcTT! 2
=TT3 4
nullTT5 9
;TT9 :
boolUU  
aUU! "
=UU# $
UserManagerUU% 0
.UU0 1
IsLockedOutUU1 <
(UU< =
userUU= A
.UUA B
IdUUB D
)UUD E
;UUE F
}VV 
breakWW 
;WW 
caseXX 
$strXX 
:XX  
switchYY 
(YY  
userYY  $
.YY$ %
UserTypeYY% -
)YY- .
{ZZ 
case[[  
([[! "
int[[" %
)[[% &
UserType[[& .
.[[. /
Admin[[/ 4
:[[4 5
user\\  $
.\\$ %
UserType\\% -
=\\. /
(\\0 1
int\\1 4
)\\4 5
UserType\\5 =
.\\= >
User\\> B
;\\B C
break]]  %
;]]% &
case^^  
(^^! "
int^^" %
)^^% &
UserType^^& .
.^^. /
User^^/ 3
:^^3 4
user__  $
.__$ %
UserType__% -
=__. /
(__0 1
int__1 4
)__4 5
UserType__5 =
.__= >
Admin__> C
;__C D
break``  %
;``% &
}aa 
breakbb 
;bb 
casecc 
$strcc  
:cc  !
userdd 
.dd 
IsTestsCreativesdd -
=dd. /
!dd0 1
userdd1 5
.dd5 6
IsTestsCreativesdd6 F
;ddF G
breakee 
;ee 
caseff 
$strff #
:ff# $
ifgg 
(gg 
!gg 
stringgg #
.gg# $
IsNullOrEmptygg$ 1
(gg1 2
modelgg2 7
.gg7 8
Passwordgg8 @
)gg@ A
)ggA B
{hh 
stringii "

resetTokenii# -
=ii. /
UserManagerii0 ;
.ii; <&
GeneratePasswordResetTokenii< V
(iiV W
useriiW [
.ii[ \
Idii\ ^
)ii^ _
;ii_ `
IdentityResultjj * 
passwordChangeResultjj+ ?
=jj@ A
UserManagerjjB M
.jjM N
ResetPasswordjjN [
(jj[ \
userjj\ `
.jj` a
Idjja c
,jjc d

resetTokenjje o
,jjo p
modeljjq v
.jjv w
Passwordjjw 
)	jj Ä
;
jjÄ Å
ifkk 
(kk   
passwordChangeResultkk  4
!=kk5 7
IdentityResultkk8 F
.kkF G
SuccesskkG N
)kkN O
{ll 
throwmm  %
newmm& )
AdsExceptionmm* 6
(mm6 7 
passwordChangeResultmm7 K
.mmK L
ErrorsmmL R
.mmR S
FirstOrDefaultmmS a
(mma b
)mmb c
)mmc d
;mmd e
}nn 
}oo 
breakpp 
;pp 
caseqq 
$strqq !
:qq! "
UserManagerrr #
.rr# $
Deleterr$ *
(rr* +
userrr+ /
)rr/ 0
;rr0 1
breakss 
;ss 
}tt 
Dbuu 
.uu 
SaveChangesuu 
(uu 
)uu  
;uu  !
returnvv 
Jsonvv 
(vv 
newvv 
JsonResponsevv  ,
(vv, -
)vv- .
{vv/ 0
IsSucessvv1 9
=vv: ;
truevv< @
}vvA B
,vvB C
JsonRequestBehaviorvvD W
.vvW X
AllowGetvvX `
)vv` a
;vva b
}ww 
catchxx 
(xx 
	Exceptionxx 
exxx 
)xx  
{yy 
returnzz 
Jsonzz 
(zz 
newzz 
JsonResponsezz  ,
(zz, -
)zz- .
{zz/ 0
IsSucesszz1 9
=zz: ;
falsezz< A
,zzA B
ErrorMessagezzC O
=zzP Q
exzzR T
.zzT U
MessagezzU \
}zz] ^
,zz^ _
JsonRequestBehavior{{ '
.{{' (
AllowGet{{( 0
){{0 1
;{{1 2
}|| 
}}} 	
}
ÄÄ 
}ÅÅ •
ME:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\TestController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
public 

class 
TestController 
:  !
BaseController" 0
{		 
public

 
ActionResult

 
AddCustomers

 (
(

( )
)

) *
{ 	

Dictionary 
< 
string 
, 
string %
>% & 
whiteLabelDictionary' ;
=< =
new> A

DictionaryB L
<L M
stringM S
,S T
stringU [
>[ \
(\ ]
)] ^
{ 
{ 
$str 
, 
$str 2
}2 3
,3 4
{ 
$str 
, 
$str .
}. /
,/ 0
{ 
$str 
, 
$str 1
}1 2
,2 3
{ 
$str 
, 
$str =
}= >
,> ?
{ 
$str 
, 
$str :
}: ;
,; <
{ 
$str 
, 
$str =
}= >
,> ?
{ 
$str !
,! "
$str# B
}B C
,C D
{ 
$str 
, 
$str >
}> ?
,? @
{ 
$str 
, 
$str <
}< =
,= >
{ 
$str 
, 
$str :
}: ;
,; <
{ 
$str 
, 
$str ;
}; <
,< =
{ 
$str 
, 
$str 3
}3 4
,4 5
{ 
$str 
, 
$str 2
}2 3
} 
; 
foreach 
( 
var 
dic 
in  
whiteLabelDictionary  4
)4 5
{ 
Db 
. 
	Customers 
. 
Add  
(  !
new! $
Customer% -
{   
Id!! 
=!! 
Guid!! 
.!! 
NewGuid!! %
(!!% &
)!!& '
,!!' (
	CreatedAt"" 
="" 
DateTime""  (
.""( )
Now"") ,
,"", -
Code## 
=## 
dic## 
.## 
Key## "
.##" #
Trim### '
(##' (
)##( )
,##) *
Name$$ 
=$$ 
dic$$ 
.$$ 
Key$$ "
.$$" #
Trim$$# '
($$' (
)$$( )
,$$) *
	WebDomain%% 
=%% 
dic%%  #
.%%# $
Value%%$ )
.%%) *
Trim%%* .
(%%. /
)%%/ 0
}&& 
)&& 
;&& 
}'' 
Db(( 
.(( 
SaveChanges(( 
((( 
)(( 
;(( 
return)) 
View)) 
()) 
$str)) !
)))! "
;))" #
}** 	
}++ 
},, ∆S
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\CustomerController.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
.		 
Controllers		 '
{

 
[ 
	Authorize 
] 
public 

class 
CustomerController #
:$ %
BaseController& 4
{ 
private 
const 
int 
PageSize "
=# $
$num% '
;' (
public 
ActionResult 
Index !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
var 
customer 
= 
Db 
. 
	Customers '
.' (
Select( .
(. /
x/ 0
=>1 3
new 

CustomerVm 
{ 
Id 
= 
x 
. 
Id 
. 
ToString "
(" #
)# $
,$ %
Code 
= 
x 
. 
Code 
, 
Name 
= 
x 
. 
Name 
, 
	WebDomain 
= 
x 
. 
	WebDomain '
,' (
Phone 
= 
x 
. 
Phone 
,  
Email 
= 
x 
. 
Email 
,  
DateCreated 
= 
x 
.  
	CreatedAt  )
.) *
ToString* 2
(2 3
)3 4
} 
) 
. 
ToList 
( 
) 
; 
int 

pageNumber 
= 
( 
sc  
.  !
Page! %
??& (
$num) *
)* +
;+ ,
var 
model 
= 
customer  
.  !
ToPagedList! ,
(, -

pageNumber- 7
,7 8
PageSize9 A
)A B
;B C
return 
View 
( 
model 
) 
; 
}   	
public"" 
ActionResult"" 
New"" 
(""  
)""  !
{## 	
return$$ 
View$$ 
($$ 
)$$ 
;$$ 
}%% 	
['' 	
HttpPost''	 
]'' 
public(( 
ActionResult(( 
New(( 
(((  

CustomerVm((  *

customerVm((+ 5
)((5 6
{)) 	
try** 
{++ 
var,, 
customer,, 
=,, 
new,, "
Customer,,# +
{-- 
Id.. 
=.. 
Guid.. 
... 
NewGuid.. %
(..% &
)..& '
,..' (
	CreatedAt// 
=// 
DateTime//  (
.//( )
Now//) ,
,//, -
	CreatedBy00 
=00 
LoggedInUser00  ,
.00, -
Id00- /
,00/ 0
Code11 
=11 

customerVm11 %
.11% &
Code11& *
,11* +
Name22 
=22 

customerVm22 %
.22% &
Name22& *
,22* +
Email33 
=33 

customerVm33 &
.33& '
Email33' ,
,33, -
Phone44 
=44 

customerVm44 &
.44& '
Phone44' ,
,44, -
	WebDomain55 
=55 

customerVm55  *
.55* +
	WebDomain55+ 4
,554 5
}66 
;66 
Db77 
.77 
	Customers77 
.77 
Add77  
(77  !
customer77! )
)77) *
;77* +
Db88 
.88 
SaveChanges88 
(88 
)88  
;88  !
ForceCustomers:: 
=::  
true::! %
;::% &
TempData<< 
[<< 
$str<< "
]<<" #
=<<$ %
$str<<& T
;<<T U
return== 
RedirectToAction== '
(==' (
$str==( /
)==/ 0
;==0 1
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
}BB 
returnCC 
ViewCC 
(CC 
$strCC 
)CC  
;CC  !
}DD 	
publicFF 
ActionResultFF 
EditFF  
(FF  !
GuidFF! %
?FF% &
idFF' )
)FF) *
{GG 	
ifHH 
(HH 
idHH 
==HH 
nullHH 
)HH 
{II 
throwJJ 
newJJ 
HttpExceptionJJ '
(JJ' (
$numJJ( +
,JJ+ ,
$strJJ- :
)JJ: ;
;JJ; <
}KK 
varLL 
xLL 
=LL 
DbLL 
.LL 
	CustomersLL  
.LL  !
FindLL! %
(LL% &
idLL& (
)LL( )
;LL) *
ifMM 
(MM 
xMM 
==MM 
nullMM 
)MM 
{NN 
throwOO 
newOO 
HttpExceptionOO '
(OO' (
$numOO( +
,OO+ ,
$strOO- 8
)OO8 9
;OO9 :
}PP 
varQQ 
vendorQQ 
=QQ 
newQQ 

CustomerVmQQ '
{RR 
IdSS 
=SS 
xSS 
.SS 
IdSS 
.SS 
ToStringSS "
(SS" #
)SS# $
,SS$ %
CodeTT 
=TT 
xTT 
.TT 
CodeTT 
,TT 
NameUU 
=UU 
xUU 
.UU 
NameUU 
,UU 
EmailVV 
=VV 
xVV 
.VV 
EmailVV 
,VV  
PhoneWW 
=WW 
xWW 
.WW 
PhoneWW 
,WW  
	WebDomainXX 
=XX 
xXX 
.XX 
	WebDomainXX '
,XX' (
DateCreatedYY 
=YY 
xYY 
.YY  
	CreatedAtYY  )
.YY) *
ToStringYY* 2
(YY2 3
)YY3 4
}ZZ 
;ZZ 
return\\ 
View\\ 
(\\ 
$str\\ 
,\\ 
vendor\\ %
)\\% &
;\\& '
}]] 	
[__ 	
HttpPost__	 
]__ 
public`` 
ActionResult`` 
Edit``  
(``  !

CustomerVm``! +

customerVm``, 6
)``6 7
{aa 	
trybb 
{cc 
vardd 
customerdd 
=dd 
Dbdd !
.dd! "
	Customersdd" +
.dd+ ,
Finddd, 0
(dd0 1
Guiddd1 5
.dd5 6
Parsedd6 ;
(dd; <

customerVmdd< F
.ddF G
IdddG I
)ddI J
)ddJ K
;ddK L
ifee 
(ee 
customeree 
!=ee 
nullee  $
)ee$ %
{ff 
customergg 
.gg 
Codegg !
=gg" #

customerVmgg$ .
.gg. /
Codegg/ 3
;gg3 4
customerhh 
.hh 
Namehh !
=hh" #

customerVmhh$ .
.hh. /
Namehh/ 3
;hh3 4
customerii 
.ii 
	WebDomainii &
=ii' (

customerVmii) 3
.ii3 4
	WebDomainii4 =
;ii= >
customerjj 
.jj 
Emailjj "
=jj# $

customerVmjj% /
.jj/ 0
Emailjj0 5
;jj5 6
customerkk 
.kk 
Phonekk "
=kk# $

customerVmkk% /
.kk/ 0
Phonekk0 5
;kk5 6
}ll 
Dbmm 
.mm 
SaveChangesmm 
(mm 
)mm  
;mm  !
TempDatann 
[nn 
$strnn "
]nn" #
=nn$ %
$strnn& [
;nn[ \
ForceCustomerspp 
=pp  
truepp! %
;pp% &
returnqq 
RedirectToActionqq '
(qq' (
$strqq( /
)qq/ 0
;qq0 1
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
}vv 
returnww 
Viewww 
(ww 
$strww 
)ww  
;ww  !
}xx 	
publiczz 
ActionResultzz 
Deletezz "
(zz" #
Guidzz# '
?zz' (
idzz) +
)zz+ ,
{{{ 	
try|| 
{}} 
var~~ 
customer~~ 
=~~ 
Db~~ !
.~~! "
	Customers~~" +
.~~+ ,
Find~~, 0
(~~0 1
id~~1 3
)~~3 4
;~~4 5
if 
( 
customer 
!= 
null  $
)$ %
{
ÄÄ 
Db
ÅÅ 
.
ÅÅ 
	Customers
ÅÅ  
.
ÅÅ  !
Remove
ÅÅ! '
(
ÅÅ' (
customer
ÅÅ( 0
)
ÅÅ0 1
;
ÅÅ1 2
Db
ÇÇ 
.
ÇÇ 
SaveChanges
ÇÇ "
(
ÇÇ" #
)
ÇÇ# $
;
ÇÇ$ %
ForceCustomers
ÉÉ "
=
ÉÉ# $
true
ÉÉ% )
;
ÉÉ) *
}
ÑÑ 
return
ÖÖ 
Json
ÖÖ 
(
ÖÖ 
new
ÖÖ 
JsonResponse
ÖÖ  ,
(
ÖÖ, -
)
ÖÖ- .
{
ÖÖ/ 0
IsSucess
ÖÖ1 9
=
ÖÖ: ;
true
ÖÖ< @
}
ÖÖA B
,
ÖÖB C!
JsonRequestBehavior
ÖÖD W
.
ÖÖW X
AllowGet
ÖÖX `
)
ÖÖ` a
;
ÖÖa b
}
ÜÜ 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
àà 
return
ââ 
Json
ââ 
(
ââ 
new
ââ 
JsonResponse
ââ  ,
(
ââ, -
)
ââ- .
{
ââ/ 0
IsSucess
ââ1 9
=
ââ: ;
false
ââ< A
,
ââA B
ErrorMessage
ââC O
=
ââP Q
ex
ââR T
.
ââT U
Message
ââU \
}
ââ] ^
,
ââ^ _!
JsonRequestBehavior
ää '
.
ää' (
AllowGet
ää( 0
)
ää0 1
;
ää1 2
}
ãã 
}
åå 	
}
çç 
}éé ¿S
OE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\VendorController.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
.		 
Controllers		 '
{

 
[ 
	Authorize 
] 
public 

class 
VendorController !
:" #
BaseController$ 2
{ 
private 
const 
int 
PageSize "
=# $
$num% '
;' (
public 
ActionResult 
Index !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
var 
vendors 
= 
Db 
. 
Vendors $
.$ %
Select% +
(+ ,
x, -
=>. 0
new 
VendorVm 
{ 
Id 
= 
x 
. 
Id 
. 
ToString "
(" #
)# $
,$ %
Name 
= 
x 
. 
Name 
, 
CompanyName 
= 
x 
.  
CompanyName  +
,+ ,
Phone 
= 
x 
. 
Phone 
,  
Email 
= 
x 
. 
Email 
,  
CcEmails 
= 
x 
. 
CcEmails %
,% &
DateCreated 
= 
x 
.  
	CreatedAt  )
.) *
ToString* 2
(2 3
)3 4
} 
) 
. 
ToList 
( 
) 
; 
int 

pageNumber 
= 
( 
sc  
.  !
Page! %
??& (
$num) *
)* +
;+ ,
var 
model 
= 
vendors 
.  
ToPagedList  +
(+ ,

pageNumber, 6
,6 7
PageSize8 @
)@ A
;A B
return 
View 
( 
model 
) 
; 
}   	
public"" 
ActionResult"" 
New"" 
(""  
)""  !
{## 	
return$$ 
View$$ 
($$ 
)$$ 
;$$ 
}%% 	
['' 	
HttpPost''	 
]'' 
public(( 
ActionResult(( 
New(( 
(((  
VendorVm((  (
vendorVm(() 1
)((1 2
{)) 	
try** 
{++ 
var,, 
vendor,, 
=,, 
new,,  
Vendor,,! '
(,,' (
),,( )
{-- 
Id.. 
=.. 
Guid.. 
... 
NewGuid.. %
(..% &
)..& '
,..' (
	CreatedAt// 
=// 
DateTime//  (
.//( )
Now//) ,
,//, -
	CreatedBy00 
=00 
LoggedInUser00  ,
.00, -
Id00- /
,00/ 0
Name11 
=11 
vendorVm11 #
.11# $
Name11$ (
,11( )
CompanyName22 
=22  !
vendorVm22" *
.22* +
CompanyName22+ 6
,226 7
Email33 
=33 
vendorVm33 $
.33$ %
Email33% *
,33* +
CcEmails44 
=44 
vendorVm44 '
.44' (
CcEmails44( 0
,440 1
Phone55 
=55 
vendorVm55 $
.55$ %
Phone55% *
,55* +
}66 
;66 
Db77 
.77 
Vendors77 
.77 
Add77 
(77 
vendor77 %
)77% &
;77& '
Db88 
.88 
SaveChanges88 
(88 
)88  
;88  !
ForceVendors:: 
=:: 
true:: #
;::# $
TempData<< 
[<< 
$str<< "
]<<" #
=<<$ %
$str<<& T
;<<T U
return== 
RedirectToAction== '
(==' (
$str==( /
)==/ 0
;==0 1
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
}BB 
returnCC 
ViewCC 
(CC 
$strCC 
)CC  
;CC  !
}DD 	
publicFF 
ActionResultFF 
EditFF  
(FF  !
GuidFF! %
?FF% &
idFF' )
)FF) *
{GG 	
ifHH 
(HH 
idHH 
==HH 
nullHH 
)HH 
{II 
throwJJ 
newJJ 
HttpExceptionJJ '
(JJ' (
$numJJ( +
,JJ+ ,
$strJJ- :
)JJ: ;
;JJ; <
}KK 
varLL 
xLL 
=LL 
DbLL 
.LL 
VendorsLL 
.LL 
FindLL #
(LL# $
idLL$ &
)LL& '
;LL' (
ifMM 
(MM 
xMM 
==MM 
nullMM 
)MM 
{NN 
throwOO 
newOO 
HttpExceptionOO '
(OO' (
$numOO( +
,OO+ ,
$strOO- 8
)OO8 9
;OO9 :
}PP 
varQQ 
vendorQQ 
=QQ 
newQQ 
VendorVmQQ %
{RR 
IdSS 
=SS 
xSS 
.SS 
IdSS 
.SS 
ToStringSS "
(SS" #
)SS# $
,SS$ %
NameTT 
=TT 
xTT 
.TT 
NameTT 
,TT 
CompanyNameUU 
=UU 
xUU 
.UU  
CompanyNameUU  +
,UU+ ,
EmailVV 
=VV 
xVV 
.VV 
EmailVV 
,VV  
CcEmailsWW 
=WW 
xWW 
.WW 
CcEmailsWW %
,WW% &
PhoneXX 
=XX 
xXX 
.XX 
PhoneXX 
,XX  
DateCreatedYY 
=YY 
xYY 
.YY  
	CreatedAtYY  )
.YY) *
ToStringYY* 2
(YY2 3
)YY3 4
}ZZ 
;ZZ 
return\\ 
View\\ 
(\\ 
$str\\ 
,\\ 
vendor\\ %
)\\% &
;\\& '
}]] 	
[__ 	
HttpPost__	 
]__ 
public`` 
ActionResult`` 
Edit``  
(``  !
VendorVm``! )
vendorVm``* 2
)``2 3
{aa 	
trybb 
{cc 
vardd 
vendordd 
=dd 
Dbdd 
.dd  
Vendorsdd  '
.dd' (
Finddd( ,
(dd, -
Guiddd- 1
.dd1 2
Parsedd2 7
(dd7 8
vendorVmdd8 @
.dd@ A
IdddA C
)ddC D
)ddD E
;ddE F
ifee 
(ee 
vendoree 
!=ee 
nullee "
)ee" #
{ff 
vendorgg 
.gg 
Namegg 
=gg  !
vendorVmgg" *
.gg* +
Namegg+ /
;gg/ 0
vendorhh 
.hh 
CompanyNamehh &
=hh' (
vendorVmhh) 1
.hh1 2
CompanyNamehh2 =
;hh= >
vendorii 
.ii 
Emailii  
=ii! "
vendorVmii# +
.ii+ ,
Emailii, 1
;ii1 2
vendorjj 
.jj 
Phonejj  
=jj! "
vendorVmjj# +
.jj+ ,
Phonejj, 1
;jj1 2
vendorkk 
.kk 
CcEmailskk #
=kk$ %
vendorVmkk& .
.kk. /
CcEmailskk/ 7
;kk7 8
}ll 
Dbmm 
.mm 
SaveChangesmm 
(mm 
)mm  
;mm  !
TempDatann 
[nn 
$strnn "
]nn" #
=nn$ %
$strnn& V
;nnV W
ForceVendorspp 
=pp 
truepp #
;pp# $
returnqq 
RedirectToActionqq '
(qq' (
$strqq( /
)qq/ 0
;qq0 1
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
}vv 
returnww 
Viewww 
(ww 
$strww 
)ww  
;ww  !
}xx 	
publiczz 
ActionResultzz 
Deletezz "
(zz" #
Guidzz# '
?zz' (
idzz) +
)zz+ ,
{{{ 	
try|| 
{}} 
var~~ 
vendor~~ 
=~~ 
Db~~ 
.~~  
Vendors~~  '
.~~' (
Find~~( ,
(~~, -
id~~- /
)~~/ 0
;~~0 1
if 
( 
vendor 
!= 
null "
)" #
{
ÄÄ 
Db
ÅÅ 
.
ÅÅ 
Vendors
ÅÅ 
.
ÅÅ 
Remove
ÅÅ %
(
ÅÅ% &
vendor
ÅÅ& ,
)
ÅÅ, -
;
ÅÅ- .
Db
ÇÇ 
.
ÇÇ 
SaveChanges
ÇÇ "
(
ÇÇ" #
)
ÇÇ# $
;
ÇÇ$ %
ForceVendors
ÉÉ  
=
ÉÉ! "
true
ÉÉ# '
;
ÉÉ' (
}
ÑÑ 
return
ÖÖ 
Json
ÖÖ 
(
ÖÖ 
new
ÖÖ 
JsonResponse
ÖÖ  ,
(
ÖÖ, -
)
ÖÖ- .
{
ÖÖ/ 0
IsSucess
ÖÖ1 9
=
ÖÖ: ;
true
ÖÖ< @
}
ÖÖA B
,
ÖÖB C!
JsonRequestBehavior
ÖÖD W
.
ÖÖW X
AllowGet
ÖÖX `
)
ÖÖ` a
;
ÖÖa b
}
ÜÜ 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
àà 
return
ââ 
Json
ââ 
(
ââ 
new
ââ 
JsonResponse
ââ  ,
(
ââ, -
)
ââ- .
{
ââ/ 0
IsSucess
ââ1 9
=
ââ: ;
false
ââ< A
,
ââA B
ErrorMessage
ââC O
=
ââP Q
ex
ââR T
.
ââT U
Message
ââU \
}
ââ] ^
,
ââ^ _!
JsonRequestBehavior
ää '
.
ää' (
AllowGet
ää( 0
)
ää0 1
;
ää1 2
}
ãã 
}
åå 	
}
çç 
}éé æ
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\AdsException.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
[ 
Serializable 
] 
public 

class 
AdsException 
: 
	Exception  )
{ 
public		 
AdsException		 
(		 
)		 
:

 	
base


 
(

 
)

 
{

 
}

 
public 
AdsException 
( 
string "
message# *
)* +
: 	
base
 
( 
message 
) 
{ 
} 
public 
AdsException 
( 
string "
format# )
,) *
params+ 1
object2 8
[8 9
]9 :
args; ?
)? @
: 	
base
 
( 
string 
. 
Format 
( 
format #
,# $
args% )
)) *
)* +
{, -
}. /
public 
AdsException 
( 
string "
message# *
,* +
	Exception, 5
innerException6 D
)D E
: 	
base
 
( 
message 
, 
innerException &
)& '
{( )
}* +
public 
AdsException 
( 
string "
format# )
,) *
	Exception+ 4
innerException5 C
,C D
paramsE K
objectL R
[R S
]S T
argsU Y
)Y Z
: 	
base
 
( 
string 
. 
Format 
( 
format #
,# $
args% )
)) *
,* +
innerException, :
): ;
{< =
}> ?
	protected 
AdsException 
( 
SerializationInfo 0
info1 5
,5 6
StreamingContext7 G
contextH O
)O P
: 	
base
 
( 
info 
, 
context 
) 
{ 
}  !
} 
} Å
DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\SettingsVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 

SettingsVm 
{ 
public 
bool !
IsAutoProcessTracking )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
bool $
IsSendNotificationEmails ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
} 
} ‰

DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CustomerVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 

CustomerVm 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Code 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
	WebDomain 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
Phone

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
string 
DateCreated !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} Ê

BE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\VendorVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
VendorVm 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
CompanyName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
CcEmails

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
DateCreated !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} Ú_
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\ProData\NotificationsProcessor.cs
	namespace

 	
ADSDataDirect


 
.

 
Web

 
.

 
ProData

 #
{ 
public 

static 
class "
NotificationsProcessor .
{ 
public 
static 
void #
FetchAndCheckForQcRules 2
(2 3
)3 4
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
bool !
isAutoProcessTracking *
=+ ,
false- 2
;2 3
var 
settingAuto 
=  !
db" $
.$ %
Settings% -
.- .
FirstOrDefault. <
(< =
x= >
=>? A
xB C
.C D
KeyD G
==H J
StringConstantsK Z
.Z ["
KeyAutoProcessTracking[ q
)q r
;r s
if 
( 
settingAuto 
!=  "
null# '
)' (!
isAutoProcessTracking) >
=? @
intA D
.D E
ParseE J
(J K
settingAutoK V
.V W
ValueW \
)\ ]
==^ `
$numa b
;b c
if 
( 
! !
isAutoProcessTracking )
)) *
return+ 1
;1 2
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
RulesProcessing- <
,< =
$str> @
,@ A
$"B D/
#FetchAndCheckForQCRules started at D g
{g h
DateTimeh p
.p q
Nowq t
}t u
"u v
)v w
;w x
List 
< 
Campaign 
> 
	campaigns (
=) *
db+ -
.- .
	Campaigns. 7
. 
Include 
( 
x 
=> !
x" #
.# $
Approved$ ,
), -
. 
Include 
( 
x 
=> !
x" #
.# $
Segments$ ,
), -
. 
Include 
( 
x 
=> !
x" #
.# $
	Trackings$ -
)- .
. 
Where 
( 
x 
=> 
x  !
.! "
Status" (
==) +
(, -
int- 0
)0 1
CampaignStatus1 ?
.? @

Monitoring@ J
||K M
xN O
.O P
SegmentsP X
.X Y
AnyY \
(\ ]
s] ^
=>_ a
sb c
.c d
SegmentStatusd q
==r t
(u v
intv y
)y z
SegmentStatus	z á
.
á à

Monitoring
à í
)
í ì
)
ì î
. 
Where 
( 
x 
=> 
x  !
.! "
Approved" *
!=+ -
null. 2
)2 3
.   
ToList   
(   
)   
;   
	LogHelper"" 
."" 
AddLog""  
(""  !
db""! #
,""# $
LogType""% ,
."", -
RulesProcessing""- <
,""< =
$str""> @
,""@ A
$"""B D/
#FetchAndCheckForQCRules processing ""D g
{""g h
	campaigns""h q
.""q r
Count""r w
}""w x
 campaigns.	""x É
"
""É Ñ
)
""Ñ Ö
;
""Ö Ü
int%% 
index%% 
=%% 
$num%% 
;%% 
foreach&& 
(&& 
var&& 
campaign&& %
in&&& (
	campaigns&&) 2
)&&2 3
{'' 
ProDataApiManager(( %
.((% &#
FetchAndUpdateTrackings((& =
(((= >
db((> @
,((@ A
campaign((B J
)((J K
;((K L
	LogHelper)) 
.)) 
AddLog)) $
())$ %
db))% '
,))' (
LogType))) 0
.))0 1
RulesProcessing))1 @
,))@ A
$str))B D
,))D E
$"))F H.
"FetchAndCheckForQCRules completed ))H j
{))j k
index))k p
}))p q
 out of ))q y
{))y z
	campaigns	))z É
.
))É Ñ
Count
))Ñ â
}
))â ä
 campaigns.
))ä ï
"
))ï ñ
)
))ñ ó
;
))ó ò
index** 
++** 
;** 
}++ 
var// 
toBeExpired// 
=//  !
db//" $
.//$ %
Notifications//% 2
.//2 3
ToList//3 9
(//9 :
)//: ;
.00 
Where00 
(00 
x00  
=>00! #
(00$ %
DateTime00% -
.00- .
Now00. 1
.001 2
	TimeOfDay002 ;
.00; <
Hours00< A
-00B C
x00D E
.00E F
FoundAt00F M
?00M N
.00N O
	TimeOfDay00O X
.00X Y
Hours00Y ^
)00^ _
>=00` b
$num00c f
)00f g
.11 
ToList11 
(11  
)11  !
;11! "
if22 
(22 
toBeExpired22 
.22  
Count22  %
>22& '
$num22( )
)22) *
{33 
	LogHelper44 
.44 
AddLog44 $
(44$ %
db44% '
,44' (
LogType44) 0
.440 1
RulesProcessing441 @
,44@ A
$str44B D
,44D E
$str44F i
)44i j
;44j k
foreach55 
(55 
var55  
notification55! -
in55. 0
toBeExpired551 <
)55< =
{66 
notification77 $
.77$ %
Status77% +
=77, -
(77. /
int77/ 2
)772 3
NotificationStatus773 E
.77E F
Expired77F M
;77M N
}88 
db99 
.99 
SaveChanges99 "
(99" #
)99# $
;99$ %
}:: 
var== 
logs== 
=== 
db== 
.== 

SystemLogs== (
.==( )
ToList==) /
(==/ 0
)==0 1
.>> 
Where>> 
(>> 
x>> 
=>>> 
(>>  !
x>>! "
.>>" #
LogType>># *
==>>+ -
(>>. /
int>>/ 2
)>>2 3
LogType>>3 :
.>>: ;
RulesProcessing>>; J
||>>K M
x>>N O
.>>O P
LogType>>P W
==>>X Z
(>>[ \
int>>\ _
)>>_ `
LogType>>` g
.>>g h
ProData>>h o
)>>o p
&&>>q s
(??  !
DateTime??! )
.??) *
Now??* -
.??- .
	TimeOfDay??. 7
.??7 8
Hours??8 =
-??> ?
x??@ A
.??A B
	CreatedAt??B K
.??K L
	TimeOfDay??L U
.??U V
Hours??V [
)??[ \
>=??] _
$num??` b
)??b c
.??c d
ToList??d j
(??j k
)??k l
;??l m
ifAA 
(AA 
logsAA 
.AA 
CountAA 
>AA  
$numAA! "
)AA" #
{BB 
foreachCC 
(CC 
varCC  
logCC! $
inCC% '
logsCC( ,
)CC, -
{DD 
dbEE 
.EE 

SystemLogsEE %
.EE% &
RemoveEE& ,
(EE, -
logEE- 0
)EE0 1
;EE1 2
}FF 
dbGG 
.GG 
SaveChangesGG "
(GG" #
)GG# $
;GG$ %
}HH 
	LogHelperJJ 
.JJ 
AddLogJJ  
(JJ  !
dbJJ! #
,JJ# $
LogTypeJJ% ,
.JJ, -
RulesProcessingJJ- <
,JJ< =
$strJJ> @
,JJ@ A
$"JJB D0
$FetchAndCheckForQCRules finished at JJD h
{JJh i
DateTimeJJi q
.JJq r
NowJJr u
}JJu v
, JJv x
{JJx y
	campaigns	JJy Ç
.
JJÇ É
Count
JJÉ à
}
JJà â#
 campaigns refreshed.
JJâ û
"
JJû ü
)
JJü †
;
JJ† °
}LL 
}MM 	
publicOO 
staticOO 
voidOO "
SendNotificationEmailsOO 1
(OO1 2
)OO2 3
{PP 	
usingQQ 
(QQ 
varQQ 
dbQQ 
=QQ 
newQQ 
WfpictContextQQ  -
(QQ- .
)QQ. /
)QQ/ 0
{RR 
boolSS $
isSendNotificationEmailsSS -
=SS. /
falseSS0 5
;SS5 6
varTT $
settingSendNotificationsTT ,
=TT- .
dbTT/ 1
.TT1 2
SettingsTT2 :
.TT: ;
FirstOrDefaultTT; I
(TTI J
xTTJ K
=>TTL N
xTTO P
.TTP Q
KeyTTQ T
==TTU W
StringConstantsTTX g
.TTg h&
KeySendNotificationEmails	TTh Å
)
TTÅ Ç
;
TTÇ É
ifUU 
(UU $
settingSendNotificationsUU ,
!=UU- /
nullUU0 4
)UU4 5$
isSendNotificationEmailsUU6 N
=UUO P
intUUQ T
.UUT U
ParseUUU Z
(UUZ [$
settingSendNotificationsUU[ s
.UUs t
ValueUUt y
)UUy z
==UU{ }
$numUU~ 
;	UU Ä
ifVV 
(VV 
!VV $
isSendNotificationEmailsVV ,
)VV, -
returnVV. 4
;VV4 5
varZZ 
	campaignsZZ 
=ZZ 
(ZZ  !
fromZZ! %
cZZ& '
inZZ( *
dbZZ+ -
.ZZ- .
	CampaignsZZ. 7
join[[  $
n[[% &
in[[' )
db[[* ,
.[[, -
Notifications[[- :
on[[; =
c[[> ?
.[[? @
Id[[@ B
equals[[C I
n[[J K
.[[K L

CampaignId[[L V
where\\  %
n\\& '
.\\' (
Status\\( .
==\\/ 1
(\\2 3
int\\3 6
)\\6 7
NotificationStatus\\7 I
.\\I J
Found\\J O
select]]  &
c]]' (
)]]( )
.]]) *
Distinct]]* 2
(]]2 3
)]]3 4
.]]4 5
Include]]5 <
(]]< =
x]]= >
=>]]? A
x]]B C
.]]C D
Notifications]]D Q
)]]Q R
.]]R S
ToList]]S Y
(]]Y Z
)]]Z [
;]][ \
var__ 
vendor__ 
=__ 
db__ 
.__  
Vendors__  '
.__' (
FirstOrDefault__( 6
(__6 7
x__7 8
=>__9 ;
x__< =
.__= >
Name__> B
.__B C
Contains__C K
(__K L
$str__L Q
)__Q R
||__S U
x__V W
.__W X
Name__X \
.__\ ]
Contains__] e
(__e f
$str__f l
)__l m
)__m n
;__n o
ifaa 
(aa 
	campaignsaa 
.aa 
Countaa #
>aa$ %
$numaa& '
)aa' (
{bb 
	LogHelpercc 
.cc 
AddLogcc $
(cc$ %
dbcc% '
,cc' (
LogTypecc) 0
.cc0 1
RulesProcessingcc1 @
,cc@ A
$strccB D
,ccD E
$strccF c
)ccc d
;ccd e
EmailHelperdd 
.dd  %
SendNotificationsToVendordd  9
(dd9 :
vendordd: @
,dd@ A
	campaignsddB K
)ddK L
;ddL M
}ee 
}ff 
}gg 	
}ii 
}jj Äë
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\CampaignProcessor.cs
	namespace

 	
ADSDataDirect


 
.

 
Web

 
.

 
Async

 !
{ 
public 

static 
class 
CampaignProcessor )
{ 
public 
static 
void 
ProcessNewOrder *
(* +
string+ 1
orderNumber2 =
,= >
string? E
userNameF N
)N O
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
var 
campaign 
= 
db !
.! "
	Campaigns" +
.+ ,
Include, 3
(3 4
x4 5
=>6 8
x9 :
.: ;
Assets; A
)A B
.B C
IncludeC J
(J K
xK L
=>M O
xP Q
.Q R
SegmentsR Z
)Z [
.! "
FirstOrDefault" 0
(0 1
x1 2
=>3 5
x6 7
.7 8
OrderNumber8 C
==D F
orderNumberG R
)R S
;S T
var 
user 
= 
db 
. 
Users #
.# $
FirstOrDefault$ 2
(2 3
x3 4
=>5 7
x8 9
.9 :
UserName: B
==C E
userNameF N
)N O
;O P
FileProcessor 
.  
ProcessNewOrderFiles 2
(2 3
db3 5
,5 6
campaign7 ?
)? @
;@ A
EmailHelper 
. "
SendOrderEmailToClient 2
(2 3
campaign3 ;
,; <
user= A
)A B
;B C
var 
ads 
= 
db 
. 
Vendors $
.$ %
FirstOrDefault% 3
(3 4
x4 5
=>6 8
x9 :
.: ;
Name; ?
.? @
Contains@ H
(H I
$strI N
)N O
)O P
;P Q
if 
( 
ads 
!= 
null 
)  
{ 
EmailHelper 
.  
SendOrderEmailToAds  3
(3 4
campaign4 <
,< =
user> B
,B C
adsD G
.G H
EmailH M
,M N
adsO R
.R S
CcEmailsS [
)[ \
;\ ]
} 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
Orders- 3
,3 4
campaign5 =
.= >
OrderNumber> I
,I J
$strK W
+X Y
campaignZ b
.b c
CampaignNamec o
+p q
$str	r ¢
+
£ §
campaign
• ≠
.
≠ Æ 
RepresentativeName
Æ ¿
)
¿ ¡
;
¡ ¬
} 
}   	
public"" 
static"" 
void"" 
SendToVendor"" '
(""' (
OrderVia""( 0
orderVia""1 9
,""9 :
Guid""; ?
?""? @
vendorId""A I
,""I J
string""K Q
orderNumber""R ]
,""] ^
string""_ e
[""e f
]""f g
segmentsSelected""h x
,""x y
string	""z Ä
whiteLabelDomain
""Å ë
)
""ë í
{## 	
using$$ 
($$ 
var$$ 
db$$ 
=$$ 
new$$ 
WfpictContext$$  -
($$- .
)$$. /
)$$/ 0
{%% 
Campaign&& 
campaign&& !
=&&" #
db&&$ &
.&&& '
	Campaigns&&' 0
.'' 
Include'' 
('' 
x'' 
=>'' !
x''" #
.''# $
Assets''$ *
)''* +
.(( 
Include(( 
((( 
x(( 
=>(( !
x((" #
.((# $
Segments(($ ,
)((, -
.)) 
Include)) 
()) 
x)) 
=>)) !
x))" #
.))# $
Approved))$ ,
))), -
.** 
Include** 
(** 
x** 
=>** !
x**" #
.**# $
	Trackings**$ -
)**- .
.++ 
FirstOrDefault++ #
(++# $
x++$ %
=>++& (
x++) *
.++* +
OrderNumber+++ 6
==++7 9
orderNumber++: E
)++E F
;++F G
var-- 
vendor-- 
=-- 
db-- 
.--  
Vendors--  '
.--' (
FirstOrDefault--( 6
(--6 7
x--7 8
=>--9 ;
x--< =
.--= >
Id--> @
==--A C
vendorId--D L
)--L M
;--M N
if// 
(// 
segmentsSelected// $
==//% '
null//( ,
)//, -
{00 
SendToVendorSingle11 &
(11& '
orderVia11' /
,11/ 0
db111 3
,113 4
campaign115 =
,11= >
vendor11? E
,11E F
whiteLabelDomain11G W
)11W X
;11X Y
}22 
else33 
{44 
SendToVendorMulti55 %
(55% &
orderVia55& .
,55. /
db550 2
,552 3
campaign554 <
,55< =
vendor55> D
,55D E
segmentsSelected55F V
,55V W
whiteLabelDomain55X h
)55h i
;55i j
}66 
var99 #
ifSomeSegmentsRemaining99 +
=99, -
db99. 0
.990 1
CampaignSegments991 A
.:: 
Where:: $
(::$ %
c::% &
=>::' )
c::* +
.::+ ,

CampaignId::, 6
==::7 9
campaign::: B
.::B C
Id::C E
)::E F
.;; 
Any;; "
(;;" #
x;;# $
=>;;% '
x;;( )
.;;) *
SegmentStatus;;* 7
==;;8 :
(;;; <
int;;< ?
);;? @
SegmentStatus;;@ M
.;;M N
	Generated;;N W
||;;X Z
x;;[ \
.;;\ ]
SegmentStatus;;] j
==;;k m
(;;n o
int;;o r
);;r s
SegmentStatus	;;s Ä
.
;;Ä Å
Approved
;;Å â
)
;;â ä
;
;;ä ã
if<< 
(<< 
!<< #
ifSomeSegmentsRemaining<< ,
)<<, -
{== 
campaign>> 
.>> 
Status>> #
=>>$ %
(>>& '
int>>' *
)>>* +
CampaignStatus>>+ 9
.>>9 :

Monitoring>>: D
;>>D E
db?? 
.?? 
SaveChanges?? "
(??" #
)??# $
;??$ %
}@@ 
}BB 
}CC 	
privateEE 
staticEE 
voidEE 
SendToVendorMultiEE -
(EE- .
OrderViaEE. 6
orderViaEE7 ?
,EE? @
WfpictContextEEA N
dbEEO Q
,EEQ R
CampaignEES [
campaignEE\ d
,EEd e
VendorEEf l
vendorEEm s
,EEs t
stringEEu {
[EE{ |
]EE| }
segmentsSelected	EE~ é
,
EEé è
string
EEê ñ
whiteLabelDomain
EEó ß
)
EEß ®
{FF 	
varGG 
segmentsGG 
=GG 
dbGG 
.GG 
CampaignSegmentsGG .
.HH# $
WhereHH$ )
(HH) *
cHH* +
=>HH, .
cHH/ 0
.HH0 1

CampaignIdHH1 ;
==HH< >
campaignHH? G
.HHG H
IdHHH J
&&HHK M
segmentsSelectedHHN ^
.HH^ _
ContainsHH_ g
(HHg h
cHHh i
.HHi j
SegmentNumberHHj w
)HHw x
)HHx y
.II# $
ToListII$ *
(II* +
)II+ ,
;II, -
foreachKK 
(KK 
varKK 
segmentKK  
inKK! #
segmentsKK$ ,
)KK, -
{LL 
switchMM 
(MM 
orderViaMM  
)MM  !
{NN 
caseOO 
OrderViaOO !
.OO! "
EmailOO" '
:OO' (
EmailHelperPP #
.PP# $ 
SendApprovedToVendorPP$ 8
(PP8 9
vendorPP9 ?
,PP? @
campaignPPA I
,PPI J
segmentPPK R
)PPR S
;PPS T
breakQQ 
;QQ 
caseRR 
OrderViaRR !
.RR! "
ApiRR" %
:RR% &
varSS 
responseSS $
=SS% &
ProDataApiManagerSS' 8
.SS8 9
CreateSS9 ?
(SS? @
campaignSS@ H
,SSH I
segmentSSJ Q
,SSQ R
whiteLabelDomainSSS c
)SSc d
;SSd e
ifTT 
(TT 
responseTT $
.TT$ %
StatusTT% +
!=TT, .
ProDataApiManagerTT/ @
.TT@ A
SuccessTTA H
)TTH I
{UU 
throwVV !
newVV" %
AdsExceptionVV& 2
(VV2 3
responseVV3 ;
.VV; <
ErrorMessageVV< H
)VVH I
;VVI J
}WW 
breakXX 
;XX 
defaultYY 
:YY 
throwZZ 
newZZ !'
ArgumentOutOfRangeExceptionZZ" =
(ZZ= >
nameofZZ> D
(ZZD E
orderViaZZE M
)ZZM N
,ZZN O
orderViaZZP X
,ZZX Y
nullZZZ ^
)ZZ^ _
;ZZ_ `
}[[ 
segment]] 
.]] 
SegmentStatus]] %
=]]& '
(]]( )
int]]) ,
)]], -
SegmentStatus]]- :
.]]: ;

Monitoring]]; E
;]]E F
var__ 
campaignTracking__ $
=__% &
db`` 
.`` 
CampaignTrackings`` (
.``( )
FirstOrDefault``) 7
(``7 8
x``8 9
=>``: <
x``= >
.``> ?

CampaignId``? I
==``J L
campaign``M U
.``U V
Id``V X
&&``Y [
x``\ ]
.``] ^
SegmentNumber``^ k
==``l n
segment``o v
.``v w
SegmentNumber	``w Ñ
)
``Ñ Ö
;
``Ö Ü
ifbb 
(bb 
campaignTrackingbb $
==bb% '
nullbb( ,
)bb, -
{cc 
vardd 

trackingIddd "
=dd# $
Guiddd% )
.dd) *
NewGuiddd* 1
(dd1 2
)dd2 3
;dd3 4
varee 
trackingee  
=ee! "
newee# &
CampaignTrackingee' 7
(ee7 8
)ee8 9
{ff 
Idgg 
=gg 

trackingIdgg '
,gg' (
	CreatedAthh !
=hh" #
DateTimehh$ ,
.hh, -
Nowhh- 0
,hh0 1

CampaignIdii "
=ii# $
campaignii% -
.ii- .
Idii. 0
,ii0 1
OrderNumberjj #
=jj$ %
campaignjj& .
.jj. /
OrderNumberjj/ :
,jj: ;
SegmentNumberkk %
=kk& '
segmentkk( /
.kk/ 0
SegmentNumberkk0 =
,kk= >
Quantityll  
=ll! "
segmentll# *
.ll* +
Quantityll+ 3
,ll3 4
DateSentmm  
=mm! "
DateTimemm# +
.mm+ ,
Nowmm, /
,mm/ 0
IsCreatedThroughApinn +
=nn, -
falsenn. 3
}oo 
;oo 
dbpp 
.pp 
CampaignTrackingspp (
.pp( )
Addpp) ,
(pp, -
trackingpp- 5
)pp5 6
;pp6 7
}qq 
	LogHelperrr 
.rr 
AddLogrr  
(rr  !
dbrr! #
,rr# $
LogTyperr% ,
.rr, -
ProDatarr- 4
,rr4 5
campaignrr6 >
.rr> ?
OrderNumberrr? J
,rrJ K
$"rrL N
Segment rrN V
{rrV W
segmentrrW ^
.rr^ _
SegmentNumberrr_ l
}rrl m3
& has been sent to vendor successfully.	rrm ì
"
rrì î
)
rrî ï
;
rrï ñ
}ss 
}tt 	
privatevv 
staticvv 
voidvv 
SendToVendorSinglevv .
(vv. /
OrderViavv/ 7
orderViavv8 @
,vv@ A
WfpictContextvvB O
dbvvP R
,vvR S
CampaignvvT \
campaignvv] e
,vve f
Vendorvvg m
vendorvvn t
,vvt u
stringvvv |
whiteLabelDomain	vv} ç
)
vvç é
{ww 	
switchxx 
(xx 
orderViaxx 
)xx 
{yy 
casezz 
OrderViazz 
.zz 
Emailzz #
:zz# $
EmailHelper{{ 
.{{   
SendApprovedToVendor{{  4
({{4 5
vendor{{5 ;
,{{; <
campaign{{= E
,{{E F
null{{G K
){{K L
;{{L M
break|| 
;|| 
case}} 
OrderVia}} 
.}} 
Api}} !
:}}! "
var~~ 
response~~  
=~~! "
ProDataApiManager~~# 4
.~~4 5
Create~~5 ;
(~~; <
campaign~~< D
,~~D E
null~~F J
,~~J K
whiteLabelDomain~~L \
)~~\ ]
;~~] ^
if 
( 
response  
.  !
Status! '
!=( *
ProDataApiManager+ <
.< =
Success= D
)D E
{
ÄÄ 
throw
ÅÅ 
new
ÅÅ !
AdsException
ÅÅ" .
(
ÅÅ. /
response
ÅÅ/ 7
.
ÅÅ7 8
ErrorMessage
ÅÅ8 D
)
ÅÅD E
;
ÅÅE F
}
ÇÇ 
break
ÉÉ 
;
ÉÉ 
default
ÑÑ 
:
ÑÑ 
throw
ÖÖ 
new
ÖÖ )
ArgumentOutOfRangeException
ÖÖ 9
(
ÖÖ9 :
nameof
ÖÖ: @
(
ÖÖ@ A
orderVia
ÖÖA I
)
ÖÖI J
,
ÖÖJ K
orderVia
ÖÖL T
,
ÖÖT U
null
ÖÖV Z
)
ÖÖZ [
;
ÖÖ[ \
}
ÜÜ 
string
àà 
orderNumberRdp
àà !
=
àà" #
campaign
àà$ ,
.
àà, -
OrderNumber
àà- 8
;
àà8 9
long
ââ 
quantity
ââ 
;
ââ 
if
ää 
(
ää 
campaign
ää 
.
ää 
ReBroadcasted
ää &
)
ää& '
{
ãã 
orderNumberRdp
åå 
=
åå  
campaign
åå! )
.
åå) *&
ReBroadcastedOrderNumber
åå* B
;
ååB C
quantity
çç 
=
çç 
campaign
çç #
.
çç# $#
ReBroadcastedQuantity
çç$ 9
;
çç9 :
}
éé 
else
èè 
{
êê 
orderNumberRdp
ëë 
=
ëë  
campaign
ëë! )
.
ëë) *
OrderNumber
ëë* 5
;
ëë5 6
quantity
íí 
=
íí 
campaign
íí #
.
íí# $
Approved
íí$ ,
.
íí, -
Quantity
íí- 5
;
íí5 6
}
ìì 
var
ïï 
campaignTracking
ïï  
=
ïï! "
db
ññ 
.
ññ 
CampaignTrackings
ññ '
.
ññ' (
FirstOrDefault
ññ( 6
(
ññ6 7
x
ññ7 8
=>
ññ9 ;
x
ññ< =
.
ññ= >

CampaignId
ññ> H
==
ññI K
campaign
ññL T
.
ññT U
Id
ññU W
&&
ññX Z
x
ññ[ \
.
ññ\ ]
OrderNumber
ññ] h
==
ññi k
orderNumberRdp
ññl z
&&
ññ{ }
stringññ~ Ñ
.ññÑ Ö
IsNullOrEmptyññÖ í
(ññí ì
xññì î
.ññî ï
SegmentNumberññï ¢
)ññ¢ £
)ññ£ §
;ññ§ •
if
òò 
(
òò 
campaignTracking
òò  
==
òò! #
null
òò$ (
)
òò( )
{
ôô 
var
öö 

trackingId
öö 
=
öö  
Guid
öö! %
.
öö% &
NewGuid
öö& -
(
öö- .
)
öö. /
;
öö/ 0
var
õõ 
tracking
õõ 
=
õõ 
new
õõ "
CampaignTracking
õõ# 3
(
õõ3 4
)
õõ4 5
{
úú 
Id
ùù 
=
ùù 

trackingId
ùù #
,
ùù# $
	CreatedAt
ûû 
=
ûû 
DateTime
ûû  (
.
ûû( )
Now
ûû) ,
,
ûû, -

CampaignId
üü 
=
üü  
campaign
üü! )
.
üü) *
Id
üü* ,
,
üü, -
OrderNumber
†† 
=
††  !
orderNumberRdp
††" 0
,
††0 1
SegmentNumber
°° !
=
°°" #
string
°°$ *
.
°°* +
Empty
°°+ 0
,
°°0 1
Quantity
¢¢ 
=
¢¢ 
quantity
¢¢ '
,
¢¢' (
DateSent
££ 
=
££ 
DateTime
££ '
.
££' (
Now
££( +
,
££+ ,!
IsCreatedThroughApi
§§ '
=
§§( )
false
§§* /
}
•• 
;
•• 
db
¶¶ 
.
¶¶ 
CampaignTrackings
¶¶ $
.
¶¶$ %
Add
¶¶% (
(
¶¶( )
tracking
¶¶) 1
)
¶¶1 2
;
¶¶2 3
}
ßß 
	LogHelper
©© 
.
©© 
AddLog
©© 
(
©© 
db
©© 
,
©©  
LogType
©©! (
.
©©( )
ProData
©©) 0
,
©©0 1
campaign
©©2 :
.
©©: ;
OrderNumber
©©; F
,
©©F G
!
©©H I
campaign
©©I Q
.
©©Q R
ReBroadcasted
©©R _
?
™™ 
$str
™™ C
:
´´ 
$str
´´ J
)
´´J K
;
´´K L
db
¨¨ 
.
¨¨ 
SaveChanges
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 	
}
ÆÆ 
}ØØ ìn
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\DataFileProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Async !
{ 
public 

class 
DataFileProcessor "
{ 
public 
DataFileProcessor  
(  !
)! "
{ 	
} 	
public 
static 
async 
Task  
FetchSqlDataFile! 1
(1 2
string2 8

uploadPath9 C
,C D
stringE K
orderNumberL W
,W X
stringY _
zipCodeFile` k
,k l
long 
dataQuantity 
) 
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
DataProcessing- ;
,; <
orderNumber= H
,H I
$strJ l
)l m
;m n
try 
{ 
string 
zipFilePath &
=' (
Path) -
.- .
Combine. 5
(5 6

uploadPath6 @
,@ A
zipCodeFileB M
)M N
;N O
S3FileManager   !
.  ! "
Download  " *
(  * +
zipCodeFile  + 6
,  6 7
zipFilePath  8 C
)  C D
;  D E
var!! 
list!! 
=!! 
new!! "
List!!# '
<!!' (
string!!( .
>!!. /
(!!/ 0
)!!0 1
;!!1 2
foreach"" 
("" 
var""  
line""! %
in""& (
File"") -
.""- .
ReadAllLines"". :
("": ;
zipFilePath""; F
)""F G
)""G H
{## 
var$$ 
trimmed$$ #
=$$$ %
StringHelper$$& 2
.$$2 3
Trim$$3 7
($$7 8
line$$8 <
)$$< =
;$$= >
if%% 
(%% 
string%% "
.%%" #
IsNullOrEmpty%%# 0
(%%0 1
trimmed%%1 8
)%%8 9
)%%9 :
continue%%; C
;%%C D
list&& 
.&& 
Add&&  
(&&  !
trimmed&&! (
)&&( )
;&&) *
}'' 
	LogHelper(( 
.(( 
AddLog(( $
((($ %
db((% '
,((' (
LogType(() 0
.((0 1
DataProcessing((1 ?
,((? @
orderNumber((A L
,((L M
zipCodeFile)) #
+))$ %
$str))& ?
)))? @
;))@ A
try,, 
{-- 
var.. 
data..  
=..! "
SegmentDataManager..# 5
...5 6
FetchSegmentsData..6 G
(..G H
new..H K
SegmentParameters..L ]
(..] ^
)..^ _
{// 
DataQuantity00 (
=00) *
dataQuantity00+ 7
,007 8
CustomerCode11 (
=11) *
SegmentDataManager11+ =
.11= >
CustomerCode11> J
,11J K
ZipCodes22 $
=22% &
list22' +
}33 
)33 
;33 
string44 
fileName44 '
=44( )
string44* 0
.440 1
Format441 7
(447 8
$str448 J
,44J K
orderNumber44L W
)44W X
;44X Y
var55 
filePath55 $
=55% &
$"55' )
{55) *

uploadPath55* 4
}554 5
\\555 7
{557 8
fileName558 @
}55@ A
"55A B
;55B C
data66 
.66 
ToCsv66 "
(66" #
filePath66# +
,66+ ,
new66- 0
CsvDefinition661 >
(66> ?
)66? @
{77 
	EndOfLine88 %
=88& '
$str88( .
,88. /
FieldSeparator99 *
=99+ ,
$char99- 0
,990 1
TextQualifier:: )
=::* +
$char::, /
,::/ 0
Columns;; #
=;;$ %
new<<  #
List<<$ (
<<<( )
string<<) /
><</ 0
{==  !
$str>> +
,>>+ ,
$str?? '
,??' (
$str@@ &
,@@& '
$strAA %
,AA% &
$strBB "
,BB" #
$strCC #
,CC# $
$strDD !
,DD! "
$strEE "
,EE" #
$strFF !
,FF! "
$strGG +
,GG+ ,
$strHH #
}II  !
}JJ 
)JJ 
;JJ 
stringKK 
amazonFileKeyKK ,
=KK- .
stringKK/ 5
.KK5 6
FormatKK6 <
(KK< =
$strKK= N
,KKN O
orderNumberKKP [
)KK[ \
;KK\ ]
S3FileManagerLL %
.LL% &
UploadLL& ,
(LL, -
amazonFileKeyLL- :
,LL: ;
filePathLL< D
,LLD E
trueLLF J
)LLJ K
;LLK L
	LogHelperMM !
.MM! "
AddLogMM" (
(MM( )
dbMM) +
,MM+ ,
LogTypeMM- 4
.MM4 5
DataProcessingMM5 C
,MMC D
orderNumberMME P
,MMP Q
amazonFileKeyNN $
+NN% &
$strNN' a
)NNa b
;NNb c
CampaignQQ  
campaignQQ! )
=QQ* +
dbRR 
.RR 
	CampaignsRR (
.RR( )
IncludeRR) 0
(RR0 1
xRR1 2
=>RR3 5
xRR6 7
.RR7 8
SegmentsRR8 @
)RR@ A
.RRA B
FirstOrDefaultRRB P
(RRP Q
xRRQ R
=>RRS U
xRRV W
.RRW X
OrderNumberRRX c
==RRd f
orderNumberRRg r
)RRr s
;RRs t
varTT 
campaignTestingTT +
=TT, -
dbTT. 0
.TT0 1
CampaignsTestingTT1 A
.TTA B
FirstOrDefaultTTB P
(TTP Q
xTTQ R
=>TTS U
xTTV W
.TTW X

CampaignIdTTX b
==TTc e
campaignTTf n
.TTn o
IdTTo q
)TTq r
;TTr s
campaignTestingUU '
.UU' (
DataFileUrlUU( 3
=UU4 5
amazonFileKeyUU6 C
;UUC D
campaignTestingVV '
.VV' (
DateFetchedVV( 3
=VV4 5
DateTimeVV6 >
.VV> ?
NowVV? B
;VVB C
dbWW 
.WW 
SaveChangesWW &
(WW& '
)WW' (
;WW( )
foreachYY 
(YY  !
varYY! $
segmentYY% ,
inYY- /
campaignYY0 8
.YY8 9
SegmentsYY9 A
.YYA B
OrderByYYB I
(YYI J
xYYJ K
=>YYL N
xYYO P
.YYP Q
SegmentNumberYYQ ^
)YY^ _
)YY_ `
{ZZ 
string[[ "
	fileName1[[# ,
=[[- .
$"[[/ 1
{[[1 2
campaign[[2 :
.[[: ;
OrderNumber[[; F
}[[F G
\\[[G I
{[[I J
segment[[J Q
.[[Q R
SegmentNumber[[R _
}[[_ `
data.csv[[` h
"[[h i
;[[i j
var\\ 
	filePath1\\  )
=\\* +
$"\\, .
{\\. /

uploadPath\\/ 9
}\\9 :
\\\\: <
{\\< =
	fileName1\\= F
}\\F G
"\\G H
;\\H I
var]] 
data1]]  %
=]]& '
data^^  $
.^^$ %
Where^^% *
(^^* +
x^^+ ,
=>^^- /
x^^0 1
.^^1 2
Index^^2 7
>=^^8 :
segment^^; B
.^^B C
FirstRangeStart^^C R
&&^^S U
x^^V W
.^^W X
Index^^X ]
<=^^^ `
segment^^a h
.^^h i
FirstRangeEnd^^i v
)^^v w
.^^w x
ToList^^x ~
(^^~ 
)	^^ Ä
;
^^Ä Å
var__ 
data2__  %
=__& '
data``  $
.``$ %
Where``% *
(``* +
x``+ ,
=>``- /
x``0 1
.``1 2
Index``2 7
>=``8 :
segment``; B
.``B C
SecondRangeStart``C S
&&``T V
x``W X
.``X Y
Index``Y ^
<=``_ a
segment``b i
.``i j
SecondRangeEnd``j x
)``x y
.aa$ %
ToListaa% +
(aa+ ,
)aa, -
;aa- .
varbb 
data3bb  %
=bb& '
datacc  $
.cc$ %
Wherecc% *
(cc* +
xcc+ ,
=>cc- /
xcc0 1
.cc1 2
Indexcc2 7
>=cc8 :
segmentcc; B
.ccB C
ThirdRangeStartccC R
&&ccS U
xccV W
.ccW X
IndexccX ]
<=cc^ `
segmentcca h
.cch i
ThirdRangeEndcci v
)ccv w
.ccw x
ToListccx ~
(cc~ 
)	cc Ä
;
ccÄ Å
data2dd !
.dd! "
AddRangedd" *
(dd* +
data3dd+ 0
)dd0 1
;dd1 2
data1ee !
.ee! "
AddRangeee" *
(ee* +
data2ee+ 0
)ee0 1
;ee1 2
data1ff !
.ff! "
ToCsvff" '
(ff' (
	filePath1ff( 1
,ff1 2
newff3 6
CsvDefinitionff7 D
(ffD E
)ffE F
{gg 
	EndOfLinehh  )
=hh* +
$strhh, 2
,hh2 3
FieldSeparatorii  .
=ii/ 0
$charii1 4
,ii4 5
TextQualifierjj  -
=jj. /
$charjj0 3
,jj3 4
Columnskk  '
=kk( )
newll$ '
Listll( ,
<ll, -
stringll- 3
>ll3 4
{mm$ %
$strnn  /
,nn/ 0
$stroo  +
,oo+ ,
$strpp  *
,pp* +
$strqq  )
,qq) *
$strrr  &
,rr& '
$strss  '
,ss' (
$strtt  %
,tt% &
$struu  &
,uu& '
$strvv  %
,vv% &
$strww  /
,ww/ 0
$strxx  '
}yy$ %
}zz 
)zz 
;zz 
string{{ "
amazonFileKey1{{# 1
={{2 3
$"{{4 6
{{{6 7
campaign{{7 ?
.{{? @
OrderNumber{{@ K
}{{K L
/{{L M
{{{M N
segment{{N U
.{{U V
SegmentNumber{{V c
}{{c d
data.csv{{d l
"{{l m
;{{m n
S3FileManager|| )
.||) *
Upload||* 0
(||0 1
amazonFileKey1||1 ?
,||? @
filePath||A I
,||I J
true||K O
)||O P
;||P Q
segment~~ #
.~~# $
SegmentDataFileUrl~~$ 6
=~~7 8
FileManager~~9 D
.~~D E
GetFilePathLive~~E T
(~~T U
UploadFileType~~U c
.~~c d
DataFile~~d l
,~~l m
campaign  (
.( )
OrderNumber) 4
,4 5
string6 <
.< =
Empty= B
,B C
segmentD K
.K L
SegmentNumberL Y
)Y Z
;Z [
segment
ÄÄ #
.
ÄÄ# $
DateFetched
ÄÄ$ /
=
ÄÄ0 1
DateTime
ÄÄ2 :
.
ÄÄ: ;
Now
ÄÄ; >
;
ÄÄ> ?
segment
ÅÅ #
.
ÅÅ# $
UploadStatus
ÅÅ$ 0
=
ÅÅ1 2
(
ÅÅ3 4
int
ÅÅ4 7
)
ÅÅ7 8
UploadFileStatus
ÅÅ8 H
.
ÅÅH I
	Completed
ÅÅI R
;
ÅÅR S
segment
ÇÇ #
.
ÇÇ# $
SegmentStatus
ÇÇ$ 1
=
ÇÇ2 3
(
ÇÇ4 5
int
ÇÇ5 8
)
ÇÇ8 9
SegmentStatus
ÇÇ9 F
.
ÇÇF G
	Generated
ÇÇG P
;
ÇÇP Q
	LogHelper
ÑÑ %
.
ÑÑ% &
AddLog
ÑÑ& ,
(
ÑÑ, -
db
ÑÑ- /
,
ÑÑ/ 0
LogType
ÑÑ1 8
.
ÑÑ8 9
DataProcessing
ÑÑ9 G
,
ÑÑG H
orderNumber
ÑÑI T
,
ÑÑT U
amazonFileKey1
ÖÖ  .
+
ÖÖ/ 0
$str
ÖÖ1 k
)
ÖÖk l
;
ÖÖl m
}
áá 
db
àà 
.
àà 
SaveChanges
àà &
(
àà& '
)
àà' (
;
àà( )
	LogHelper
ää !
.
ää! "
AddLog
ää" (
(
ää( )
db
ää) +
,
ää+ ,
LogType
ää- 4
.
ää4 5
DataProcessing
ää5 C
,
ääC D
orderNumber
ääE P
,
ääP Q
$str
ääR z
)
ääz {
;
ää{ |
}
ãã 
catch
åå 
(
åå 
	Exception
åå $
ex
åå% '
)
åå' (
{
çç 
	LogHelper
éé !
.
éé! "
AddError
éé" *
(
éé* +
db
éé+ -
,
éé- .
LogType
éé/ 6
.
éé6 7
DataProcessing
éé7 E
,
ééE F
orderNumber
ééG R
,
ééR S
$str
ééT z
+
éé{ |
ex
éé} 
.éé Ä
MessageééÄ á
)ééá à
;ééà â
}
èè 
}
ëë 
catch
íí 
(
íí 
	Exception
íí  
ex
íí! #
)
íí# $
{
ìì 
	LogHelper
îî 
.
îî 
AddError
îî &
(
îî& '
db
îî' )
,
îî) *
LogType
îî+ 2
.
îî2 3
DataProcessing
îî3 A
,
îîA B
orderNumber
îîC N
,
îîN O
$str
îîP c
+
îîd e
zipCodeFile
îîf q
+
îîr s
$str
îît w
+
îîx y
ex
îîz |
.
îî| }
Messageîî} Ñ
)îîÑ Ö
;îîÖ Ü
}
ïï 
}
ññ 
}
óó 	
}
òò 
}ôô »æ
KE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\MailChimpProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Async !
{ 
public 

class 
MailChimpProcessor #
{ 
public 
MailChimpProcessor !
(! "
)" #
{ 	
} 	
public 
static 
void 
QucikTestSend (
(( )

CreativeVm) 3
model4 9
)9 :
{ 	
string 

campaignId !
=" #$
CreateCampignWithContent$ <
(< =
model= B
)B C
;C D!
QuickTestSendCampaign %
(% &
model& +
,+ ,

campaignId- 7
,7 8
model9 >
.> ?
QuickTestEmails? N
.N O
SplitO T
(T U
$strU X
.X Y
ToCharArrayY d
(d e
)e f
)f g
)g h
;h i
} 	
private 
static 
void !
QuickTestSendCampaign 1
(1 2

CreativeVm2 <
model= B
,B C
stringD J

campaignIdK U
,U V
stringW ]
[] ^
]^ _

testEmails` j
)j k
{ 	
IMailChimpManager 
manager %
=& '
new( +
MailChimpManager, <
(< =
)= >
;> ?
var 
testSend 
= 
manager "
." #
	Campaigns# ,
., -
	TestAsync- 6
(6 7

campaignId7 A
,A B
newC F
CampaignTestRequestG Z
{ 
Emails!! 
=!! 

testEmails!! #
,!!# $
	EmailType"" 
="" 
$str"" "
}## 
)## 
.## 
ConfigureAwait## 
(## 
false## #
)### $
;##$ %
}%% 	
public'' 
static'' 
void'' 
TestSend'' #
(''# $

CreativeVm''$ .
model''/ 4
)''4 5
{(( 	
using)) 
()) 
var)) 
db)) 
=)) 
new)) 
WfpictContext))  -
())- .
))). /
)))/ 0
{** 
var++ 
logs++ 
=++ 
db++ 
.++ 

SystemLogs++ (
.++( )
Where++) .
(++. /
x++/ 0
=>++1 3
x++4 5
.++5 6
OrderNumber++6 A
==++B D
model++E J
.++J K
OrderNumber++K V
&&++W Y
x++Z [
.++[ \
LogType++\ c
==++d f
(++g h
int++h k
)++k l
LogType++l s
.++s t
	MailChimp++t }
)++} ~
;++~ 
foreach,, 
(,, 
var,, 
log,,  
in,,! #
logs,,$ (
),,( )
{-- 
db.. 
... 

SystemLogs.. !
...! "
Remove.." (
(..( )
log..) ,
).., -
;..- .
}// 
db00 
.00 
SaveChanges00 
(00 
)00  
;00  !
	LogHelper22 
.22 
AddLog22  
(22  !
db22! #
,22# $
LogType22% ,
.22, -
	MailChimp22- 6
,226 7
model228 =
.22= >
OrderNumber22> I
,22I J
$str22K p
+22q r
model22s x
.22x y
OrderNumber	22y Ñ
)
22Ñ Ö
;
22Ö Ü
string33 
listId33 
=33 

CreateList33  *
(33* +
db33+ -
,33- .
model33/ 4
)334 5
;335 6
CreateMembers44 
(44 
db44  
,44  !
listId44" (
,44( )
model44* /
)44/ 0
;440 1
Thread77 
.77 
Sleep77 
(77 
$num77 !
*77" #
$num77$ &
*77' (
$num77) *
)77* +
;77+ ,
int:: 

templateId:: 
=::  
CreateTemplate::! /
(::/ 0
db::0 2
,::2 3
model::4 9
)::9 :
;::: ;
string<< 

campaignId<< !
=<<" #%
CreateCampignWithTemplate<<$ =
(<<= >
db<<> @
,<<@ A
model<<B G
,<<G H
listId<<I O
,<<O P

templateId<<Q [
)<<[ \
;<<\ ]
SendCampaign>> 
(>> 
db>> 
,>>  
model>>! &
,>>& '

campaignId>>( 2
)>>2 3
;>>3 4
	LogHelper@@ 
.@@ 
AddLog@@  
(@@  !
db@@! #
,@@# $
LogType@@% ,
.@@, -
	MailChimp@@- 6
,@@6 7
model@@8 =
.@@= >
OrderNumber@@> I
,@@I J
$str@@K n
)@@n o
;@@o p
}AA 
}BB 	
privateDD 
staticDD 
voidDD 
SendCampaignDD (
(DD( )
WfpictContextDD) 6
dbDD7 9
,DD9 :

CreativeVmDD; E
modelDDF K
,DDK L
stringDDM S

campaignIdDDT ^
)DD^ _
{EE 	
IMailChimpManagerFF 
managerFF %
=FF& '
newFF( +
MailChimpManagerFF, <
(FF< =
)FF= >
;FF> ?
	LogHelperGG 
.GG 
AddLogGG 
(GG 
dbGG 
,GG  
LogTypeGG! (
.GG( )
	MailChimpGG) 2
,GG2 3
modelGG4 9
.GG9 :
OrderNumberGG: E
,GGE F
$strGGG ]
)GG] ^
;GG^ _
varHH 
sentHH 
=HH 
managerHH 
.HH 
	CampaignsHH (
.HH( )
	SendAsyncHH) 2
(HH2 3

campaignIdHH3 =
)HH= >
.HH> ?
ConfigureAwaitHH? M
(HHM N
falseHHN S
)HHS T
;HHT U
}JJ 	
privateLL 
staticLL 
stringLL $
CreateCampignWithContentLL 6
(LL6 7

CreativeVmLL7 A
modelLLB G
)LLG H
{MM 	
IMailChimpManagerNN 
managerNN %
=NN& '
newNN( +
MailChimpManagerNN, <
(NN< =
)NN= >
;NN> ?
varPP 
campaignPP 
=PP 
managerPP "
.PP" #
	CampaignsPP# ,
.PP, -
AddAsyncPP- 5
(PP5 6
newPP6 9
	MailChimpPP: C
.PPC D
NetPPD G
.PPG H
ModelsPPH N
.PPN O
CampaignPPO W
{QQ 
SettingsRR 
=RR 
newRR 
SettingRR &
{SS 
ReplyToTT 
=TT 
$strTT <
,TT< =
TitleUU 
=UU 
modelUU !
.UU! "
SubjectLineUU" -
,UU- .
FromNameVV 
=VV 
$strVV ,
,VV, -
SubjectLineWW 
=WW  !
modelWW" '
.WW' (
SubjectLineWW( 3
,WW3 4
}XX 
,XX 
TypeYY 
=YY 
CampaignTypeYY #
.YY# $
RegularYY$ +
,YY+ ,
}ZZ 
)ZZ 
.ZZ 
ConfigureAwaitZZ 
(ZZ 
falseZZ #
)ZZ# $
;ZZ$ %
var\\ 

campaignId\\ 
=\\ 
campaign\\ %
.\\% &

GetAwaiter\\& 0
(\\0 1
)\\1 2
.\\2 3
	GetResult\\3 <
(\\< =
)\\= >
.\\> ?
Id\\? A
;\\A B
var^^ 
content^^ 
=^^ 
new^^ 
ContentRequest^^ ,
{__ 
Htmlaa 
=aa 
modelaa 
.aa 
	Creativesaa &
,aa& '
}bb 
;bb 
managercc 
.cc 
Contentcc 
.cc 
AddOrUpdateAsynccc ,
(cc, -

campaignIdcc- 7
,cc7 8
contentcc9 @
)cc@ A
;ccA B
returndd 

campaignIddd 
;dd 
}ee 	
privategg 
staticgg 
stringgg %
CreateCampignWithTemplategg 7
(gg7 8
WfpictContextgg8 E
dbggF H
,ggH I

CreativeVmggJ T
modelggU Z
,ggZ [
stringgg\ b
listIdggc i
,ggi j
intggk n

templateIdggo y
)ggy z
{hh 	
IMailChimpManagerii 
managerii %
=ii& '
newii( +
MailChimpManagerii, <
(ii< =
)ii= >
;ii> ?
	LogHelperjj 
.jj 
AddLogjj 
(jj 
dbjj 
,jj  
LogTypejj! (
.jj( )
	MailChimpjj) 2
,jj2 3
modeljj4 9
.jj9 :
OrderNumberjj: E
,jjE F
$strjjG h
)jjh i
;jji j
varkk 
campaignkk 
=kk 
managerkk "
.kk" #
	Campaignskk# ,
.kk, -
AddAsynckk- 5
(kk5 6
newkk6 9
	MailChimpkk: C
.kkC D
NetkkD G
.kkG H
ModelskkH N
.kkN O
CampaignkkO W
{ll 

Recipientsmm 
=mm 
newmm  
	Recipientmm! *
{nn 
ListIdoo 
=oo 
listIdoo #
}pp 
,pp 
Settingsqq 
=qq 
newqq 
Settingqq &
{rr 
ReplyToss 
=ss 
$strss <
,ss< =
Titlett 
=tt 
modeltt !
.tt! "
SubjectLinett" -
,tt- .
FromNameuu 
=uu 
$struu ,
,uu, -
SubjectLinevv 
=vv  !
modelvv" '
.vv' (
SubjectLinevv( 3
,vv3 4

TemplateIdww 
=ww  

templateIdww! +
,ww+ ,
}xx 
,xx 
Typeyy 
=yy 
CampaignTypeyy #
.yy# $
Regularyy$ +
,yy+ ,
}zz 
)zz 
.zz 
ConfigureAwaitzz 
(zz 
falsezz #
)zz# $
;zz$ %
var|| 

campaignId|| 
=|| 
campaign|| %
.||% &

GetAwaiter||& 0
(||0 1
)||1 2
.||2 3
	GetResult||3 <
(||< =
)||= >
.||> ?
Id||? A
;||A B
return}} 

campaignId}} 
;}} 
}~~ 	
private
ÄÄ 
static
ÄÄ 
int
ÄÄ 
CreateTemplate
ÄÄ )
(
ÄÄ) *
WfpictContext
ÄÄ* 7
db
ÄÄ8 :
,
ÄÄ: ;

CreativeVm
ÄÄ< F
model
ÄÄG L
)
ÄÄL M
{
ÅÅ 	
IMailChimpManager
ÇÇ 
manager
ÇÇ %
=
ÇÇ& '
new
ÇÇ( +
MailChimpManager
ÇÇ, <
(
ÇÇ< =
)
ÇÇ= >
;
ÇÇ> ?
	LogHelper
ÉÉ 
.
ÉÉ 
AddLog
ÉÉ 
(
ÉÉ 
db
ÉÉ 
,
ÉÉ  
LogType
ÉÉ! (
.
ÉÉ( )
	MailChimp
ÉÉ) 2
,
ÉÉ2 3
model
ÉÉ4 9
.
ÉÉ9 :
OrderNumber
ÉÉ: E
,
ÉÉE F
$str
ÉÉG i
)
ÉÉi j
;
ÉÉj k
var
ÑÑ !
allTemplatesRequest
ÑÑ #
=
ÑÑ$ %
manager
ÑÑ& -
.
ÑÑ- .
	Templates
ÑÑ. 7
.
ÑÑ7 8
GetAllAsync
ÑÑ8 C
(
ÑÑC D
)
ÑÑD E
.
ÑÑE F
ConfigureAwait
ÑÑF T
(
ÑÑT U
false
ÑÑU Z
)
ÑÑZ [
;
ÑÑ[ \
var
ÖÖ 
allTemplates
ÖÖ 
=
ÖÖ !
allTemplatesRequest
ÖÖ 2
.
ÖÖ2 3

GetAwaiter
ÖÖ3 =
(
ÖÖ= >
)
ÖÖ> ?
.
ÖÖ? @
	GetResult
ÖÖ@ I
(
ÖÖI J
)
ÖÖJ K
;
ÖÖK L
int
ÜÜ 
templateIdOld
ÜÜ 
=
ÜÜ 
-
ÜÜ  !
$num
ÜÜ! "
;
ÜÜ" #
foreach
áá 
(
áá 
var
áá 
allTemplate
áá $
in
áá% '
allTemplates
áá( 4
)
áá4 5
{
àà 
if
ââ 
(
ââ 
allTemplate
ââ 
.
ââ  
Name
ââ  $
==
ââ% '
model
ââ( -
.
ââ- .
OrderNumber
ââ. 9
)
ââ9 :
{
ää 
templateIdOld
ãã !
=
ãã" #
allTemplate
ãã$ /
.
ãã/ 0
Id
ãã0 2
;
ãã2 3
break
åå 
;
åå 
}
çç 
}
éé 
if
èè 
(
èè 
templateIdOld
èè 
!=
èè  
-
èè! "
$num
èè" #
)
èè# $
{
êê 
	LogHelper
ëë 
.
ëë 
AddLog
ëë  
(
ëë  !
db
ëë! #
,
ëë# $
LogType
ëë% ,
.
ëë, -
	MailChimp
ëë- 6
,
ëë6 7
model
ëë8 =
.
ëë= >
OrderNumber
ëë> I
,
ëëI J
$str
ëëK V
+
ëëW X
model
ëëY ^
.
ëë^ _
OrderNumber
ëë_ j
+
ëëk l
$strëëm ë
)ëëë í
;ëëí ì
var
íí #
deleteTemplateRequest
íí )
=
íí* +
manager
íí, 3
.
íí3 4
	Templates
íí4 =
.
íí= >
DeleteAsync
íí> I
(
ííI J
templateIdOld
ííJ W
.
ííW X
ToString
ííX `
(
íí` a
)
íía b
)
ííb c
.
ííc d
ConfigureAwait
ííd r
(
íír s
false
íís x
)
ííx y
;
ííy z
}
ìì 
var
ïï 
template
ïï 
=
ïï 
manager
ïï "
.
ïï" #
	Templates
ïï# ,
.
ïï, -
CreateAsync
ïï- 8
(
ïï8 9
model
ïï9 >
.
ïï> ?
OrderNumber
ïï? J
,
ïïJ K
$str
ïïL N
,
ïïN O
model
ïïP U
.
ïïU V
	Creatives
ïïV _
)
ïï_ `
.
ïï` a
ConfigureAwait
ïïa o
(
ïïo p
false
ïïp u
)
ïïu v
;
ïïv w
var
ññ 

templateId
ññ 
=
ññ 
template
ññ %
.
ññ% &

GetAwaiter
ññ& 0
(
ññ0 1
)
ññ1 2
.
ññ2 3
	GetResult
ññ3 <
(
ññ< =
)
ññ= >
.
ññ> ?
Id
ññ? A
;
ññA B
	LogHelper
óó 
.
óó 
AddLog
óó 
(
óó 
db
óó 
,
óó  
LogType
óó! (
.
óó( )
	MailChimp
óó) 2
,
óó2 3
model
óó4 9
.
óó9 :
OrderNumber
óó: E
,
óóE F
$str
óóG q
)
óóq r
;
óór s
return
òò 

templateId
òò 
;
òò 
}
ôô 	
private
õõ 
static
õõ 
void
õõ "
CreateTemplateFolder
õõ 0
(
õõ0 1

CreativeVm
õõ1 ;
model
õõ< A
)
õõA B
{
úú 	
IMailChimpManager
ùù 
manager
ùù %
=
ùù& '
new
ùù( +
MailChimpManager
ùù, <
(
ùù< =
)
ùù= >
;
ùù> ?
var
ûû 
folder
ûû 
=
ûû 
manager
ûû 
.
ûû  
TemplateFolders
ûû  /
.
ûû/ 0
AddAsync
ûû0 8
(
ûû8 9
model
ûû9 >
.
ûû> ?
OrderNumber
ûû? J
)
ûûJ K
.
ûûK L
ConfigureAwait
ûûL Z
(
ûûZ [
false
ûû[ `
)
ûû` a
;
ûûa b
var
üü 
folderStatus
üü 
=
üü 
folder
üü %
.
üü% &

GetAwaiter
üü& 0
(
üü0 1
)
üü1 2
.
üü2 3
	GetResult
üü3 <
(
üü< =
)
üü= >
;
üü> ?
}
†† 	
private
¢¢ 
static
¢¢ 
void
¢¢ 
CreateMembers
¢¢ )
(
¢¢) *
WfpictContext
¢¢* 7
db
¢¢8 :
,
¢¢: ;
string
¢¢< B
listId
¢¢C I
,
¢¢I J

CreativeVm
¢¢K U
model
¢¢V [
)
¢¢[ \
{
££ 	
IMailChimpManager
§§ 
manager
§§ %
=
§§& '
new
§§( +
MailChimpManager
§§, <
(
§§< =
)
§§= >
;
§§> ?
	LogHelper
•• 
.
•• 
AddLog
•• 
(
•• 
db
•• 
,
••  
LogType
••! (
.
••( )
	MailChimp
••) 2
,
••2 3
model
••4 9
.
••9 :
OrderNumber
••: E
,
••E F
$str
••G Y
)
••Y Z
;
••Z [
foreach
¶¶ 
(
¶¶ 
var
¶¶ 
email
¶¶ 
in
¶¶ !
model
¶¶" '
.
¶¶' (

TestEmails
¶¶( 2
)
¶¶2 3
{
ßß 
var
®® 
member
®® 
=
®® 
new
®®  
Member
®®! '
{
®®( )
EmailAddress
®®* 6
=
®®7 8
email
®®9 >
.
®®> ?
Text
®®? C
,
®®C D
StatusIfNew
®®E P
=
®®Q R
Status
®®S Y
.
®®Y Z

Subscribed
®®Z d
}
®®e f
;
®®f g
var
©© 
memberResult
©©  
=
©©! "
manager
©©# *
.
©©* +
Members
©©+ 2
.
©©2 3
AddOrUpdateAsync
©©3 C
(
©©C D
listId
©©D J
,
©©J K
member
©©L R
)
©©R S
.
©©S T
ConfigureAwait
©©T b
(
©©b c
false
©©c h
)
©©h i
;
©©i j
var
™™ 
result
™™ 
=
™™ 
memberResult
™™ )
.
™™) *

GetAwaiter
™™* 4
(
™™4 5
)
™™5 6
.
™™6 7
	GetResult
™™7 @
(
™™@ A
)
™™A B
;
™™B C
var
¨¨ 
exists
¨¨ 
=
¨¨ 
manager
¨¨ $
.
¨¨$ %
Members
¨¨% ,
.
¨¨, -
ExistsAsync
¨¨- 8
(
¨¨8 9
listId
¨¨9 ?
,
¨¨? @
email
¨¨A F
.
¨¨F G
Text
¨¨G K
)
¨¨K L
.
¨¨L M
Result
¨¨M S
;
¨¨S T
}
≠≠ 
	LogHelper
ÆÆ 
.
ÆÆ 
AddLog
ÆÆ 
(
ÆÆ 
db
ÆÆ 
,
ÆÆ  
LogType
ÆÆ! (
.
ÆÆ( )
	MailChimp
ÆÆ) 2
,
ÆÆ2 3
model
ÆÆ4 9
.
ÆÆ9 :
OrderNumber
ÆÆ: E
,
ÆÆE F
$str
ÆÆG f
)
ÆÆf g
;
ÆÆg h
}
ØØ 	
private
±± 
static
±± 
string
±± 

CreateList
±± (
(
±±( )
WfpictContext
±±) 6
db
±±7 9
,
±±9 :

CreativeVm
±±; E
model
±±F K
)
±±K L
{
≤≤ 	
bool
≥≥ 
isListExists
≥≥ 
=
≥≥ 
false
≥≥  %
;
≥≥% &
string
¥¥ 
listId
¥¥ 
=
¥¥ 
string
¥¥ "
.
¥¥" #
Empty
¥¥# (
;
¥¥( )
IMailChimpManager
µµ 
manager
µµ %
=
µµ& '
new
µµ( +
MailChimpManager
µµ, <
(
µµ< =
)
µµ= >
;
µµ> ?
var
∂∂ 
lists
∂∂ 
=
∂∂ 
manager
∂∂ 
.
∂∂  
Lists
∂∂  %
.
∂∂% &
GetAllAsync
∂∂& 1
(
∂∂1 2
)
∂∂2 3
.
∂∂3 4
ConfigureAwait
∂∂4 B
(
∂∂B C
false
∂∂C H
)
∂∂H I
;
∂∂I J
foreach
∑∑ 
(
∑∑ 
var
∑∑ 
list
∑∑ 
in
∑∑  
lists
∑∑! &
.
∑∑& '

GetAwaiter
∑∑' 1
(
∑∑1 2
)
∑∑2 3
.
∑∑3 4
	GetResult
∑∑4 =
(
∑∑= >
)
∑∑> ?
)
∑∑? @
{
∏∏ 
if
ππ 
(
ππ 
list
ππ 
.
ππ 
Name
ππ 
==
ππ  
model
ππ! &
.
ππ& '
OrderNumber
ππ' 2
)
ππ2 3
{
∫∫ 
isListExists
ªª  
=
ªª! "
true
ªª# '
;
ªª' (
listId
ºº 
=
ºº 
list
ºº !
.
ºº! "
Id
ºº" $
;
ºº$ %
break
ΩΩ 
;
ΩΩ 
}
ææ 
}
øø 
if
¡¡ 
(
¡¡ 
isListExists
¡¡ 
)
¡¡ 
{
¬¬ 
	LogHelper
√√ 
.
√√ 
AddLog
√√  
(
√√  !
db
√√! #
,
√√# $
LogType
√√% ,
.
√√, -
	MailChimp
√√- 6
,
√√6 7
model
√√8 =
.
√√= >
OrderNumber
√√> I
,
√√I J
$str
√√K R
+
√√S T
model
√√U Z
.
√√Z [
OrderNumber
√√[ f
+
√√g h
$str
√√i {
)
√√{ |
;
√√| }
}
ƒƒ 
else
≈≈ 
{
∆∆ 
	LogHelper
«« 
.
«« 
AddLog
««  
(
««  !
db
««! #
,
««# $
LogType
««% ,
.
««, -
	MailChimp
««- 6
,
««6 7
model
««8 =
.
««= >
OrderNumber
««> I
,
««I J
$str
««K Z
)
««Z [
;
««[ \
var
»» 
testList
»» 
=
»» 
manager
»» &
.
»»& '
Lists
»»' ,
.
»», -
AddOrUpdateAsync
»»- =
(
»»= >
new
…… 
List
……  
(
……  !
)
……! "
{
   
Name
ÀÀ  
=
ÀÀ! "
model
ÀÀ# (
.
ÀÀ( )
OrderNumber
ÀÀ) 4
,
ÀÀ4 5 
PermissionReminder
ÃÃ .
=
ÃÃ/ 0
$str
ÃÃ1 7
,
ÃÃ7 8
Contact
ÕÕ #
=
ÕÕ$ %
new
ÕÕ& )
Contact
ÕÕ* 1
{
ŒŒ 
Address1
œœ  (
=
œœ) *
$str
œœ+ 1
,
œœ1 2
City
––  $
=
––% &
$str
––' 3
,
––3 4
Country
——  '
=
——( )
$str
——* /
,
——/ 0
State
““  %
=
““& '
$str
““( ,
,
““, -
Zip
””  #
=
””$ %
$str
””& -
,
””- .
Company
‘‘  '
=
‘‘( )
$str
‘‘* 0
}
’’ 
,
’’ 
CampaignDefaults
÷÷ ,
=
÷÷- .
new
÷÷/ 2
CampaignDefaults
÷÷3 C
{
◊◊ 
	FromEmail
ÿÿ  )
=
ÿÿ* +
$str
ÿÿ, K
,
ÿÿK L
FromName
ŸŸ  (
=
ŸŸ) *
model
ŸŸ+ 0
.
ŸŸ0 1
FromLine
ŸŸ1 9
,
ŸŸ9 :
Language
⁄⁄  (
=
⁄⁄) *
$str
⁄⁄+ /
,
⁄⁄/ 0
Subject
€€  '
=
€€( )
model
€€* /
.
€€/ 0
SubjectLine
€€0 ;
}
‹‹ 
}
›› 
)
›› 
.
›› 
ConfigureAwait
›› )
(
››) *
false
››* /
)
››/ 0
;
››0 1
var
ﬁﬁ 
list
ﬁﬁ 
=
ﬁﬁ 
testList
ﬁﬁ #
.
ﬁﬁ# $

GetAwaiter
ﬁﬁ$ .
(
ﬁﬁ. /
)
ﬁﬁ/ 0
.
ﬁﬁ0 1
	GetResult
ﬁﬁ1 :
(
ﬁﬁ: ;
)
ﬁﬁ; <
;
ﬁﬁ< =
listId
ﬂﬂ 
=
ﬂﬂ 
list
ﬂﬂ 
.
ﬂﬂ 
Id
ﬂﬂ  
;
ﬂﬂ  !
	LogHelper
‡‡ 
.
‡‡ 
AddLog
‡‡  
(
‡‡  !
db
‡‡! #
,
‡‡# $
LogType
‡‡% ,
.
‡‡, -
	MailChimp
‡‡- 6
,
‡‡6 7
model
‡‡8 =
.
‡‡= >
OrderNumber
‡‡> I
,
‡‡I J
$str
‡‡K g
)
‡‡g h
;
‡‡h i
}
·· 
return
„„ 
listId
„„ 
;
„„ 
}
‰‰ 	
}
ÁÁ 
}ËË ≤
HE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\ProData\ProDataHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
ProData #
{ 
public 

static 
class 
ProDataHelper %
{ 
public 
static 
int 
GetIndex "
(" #
string# )
reportSiteUrl* 7
)7 8
{ 	
var 
parts 
= 
reportSiteUrl %
.% &
Split& +
(+ ,
$char, /
)/ 0
;0 1
return		 
int		 
.		 
Parse		 
(		 
parts		 "
[		" #
parts		# (
.		( )
Length		) /
-		0 1
$num		2 3
]		3 4
)		4 5
;		5 6
}

 	
} 
} áí
PE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\AccountController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
AccountController "
:# $
BaseController% 3
{ 
private "
ApplicationUserManager &
_userManager' 3
;3 4
private $
ApplicationSignInManager (
_signInManager) 7
;7 8
public 
AccountController  
(  !
)! "
{ 	
} 	
public 
AccountController  
(  !"
ApplicationUserManager! 7
userManager8 C
,C D$
ApplicationSignInManagerE ]
signInManager^ k
)l m
{ 	
UserManager 
= 
userManager %
;% &
SignInManager 
= 
signInManager )
;) *
} 	
public   "
ApplicationUserManager   %
UserManager  & 1
{!! 	
get"" 
{## 
return$$ 
_userManager$$ #
??$$$ &
HttpContext$$' 2
.$$2 3
GetOwinContext$$3 A
($$A B
)$$B C
.$$C D
GetUserManager$$D R
<$$R S"
ApplicationUserManager$$S i
>$$i j
($$j k
)$$k l
;$$l m
}%% 
set&& 
{'' 
_userManager(( 
=(( 
value(( $
;(($ %
})) 
}** 	
public,, $
ApplicationSignInManager,, '
SignInManager,,( 5
{-- 	
get.. 
{// 
return00 
_signInManager00 %
??00& (
HttpContext00) 4
.004 5
GetOwinContext005 C
(00C D
)00D E
.00E F
Get00F I
<00I J$
ApplicationSignInManager00J b
>00b c
(00c d
)00d e
;00e f
}11 
private22 
set22 
{33 
_signInManager44 
=44  
value44! &
;44& '
}55 
}66 	
[:: 	
AllowAnonymous::	 
]:: 
public;; 
ActionResult;; 
Login;; !
(;;! "
string;;" (
	returnUrl;;) 2
);;2 3
{<< 	
ViewBag== 
.== 
	ReturnUrl== 
=== 
	returnUrl==  )
;==) *
if>> 
(>> 
LoggedInUser>> 
!=>> 
null>>  $
)>>$ %
{?? 
if@@ 
(@@ 
	returnUrl@@ 
!=@@  
null@@! %
)@@% &
returnAA 
RedirectAA #
(AA# $
	returnUrlAA$ -
)AA- .
;AA. /
elseBB 
returnCC 
RedirectToActionCC +
(CC+ ,
$strCC, 3
,CC3 4
$strCC5 ;
)CC; <
;CC< =
}DD 
elseEE 
returnFF 
ViewFF 
(FF 
)FF 
;FF 
}GG 	
[KK 	
HttpPostKK	 
]KK 
[LL 	
AllowAnonymousLL	 
]LL 
[MM 	$
ValidateAntiForgeryTokenMM	 !
]MM! "
publicNN 
asyncNN 
TaskNN 
<NN 
ActionResultNN &
>NN& '
LoginNN( -
(NN- .
LoginViewModelNN. <
modelNN= B
,NNB C
stringNND J
	returnUrlNNK T
)NNT U
{OO 	
tryRR 
{SS 
ifTT 
(TT 
!TT 

ModelStateTT 
.TT  
IsValidTT  '
)TT' (
{UU 
StringBuilderVV !
errorsVV" (
=VV) *
newVV+ .
StringBuilderVV/ <
(VV< =
)VV= >
;VV> ?
foreachWW 
(WW 
varWW  
msWW! #
inWW$ &

ModelStateWW' 1
.WW1 2
ValuesWW2 8
)WW8 9
{XX 
foreachYY 
(YY  !
varYY! $
errorYY% *
inYY+ -
msYY. 0
.YY0 1
ErrorsYY1 7
)YY7 8
{ZZ 
errors[[ "
.[[" #
Append[[# )
([[) *
$"[[* ,
{[[, -
error[[- 2
.[[2 3
ErrorMessage[[3 ?
}[[? @
<br/>[[@ E
"[[E F
)[[F G
;[[G H
}\\ 
}]] 
if^^ 
(^^ 
!^^ 
string^^ 
.^^  
IsNullOrEmpty^^  -
(^^- .
errors^^. 4
.^^4 5
ToString^^5 =
(^^= >
)^^> ?
)^^? @
)^^@ A
throw__ 
new__ !
AdsException__" .
(__. /
errors__/ 5
.__5 6
ToString__6 >
(__> ?
)__? @
)__@ A
;__A B
}`` 
varbb 
resultbb 
=bb 
awaitbb "
SignInManagerbb# 0
.bb0 1
PasswordSignInAsyncbb1 D
(bbD E
modelbbE J
.bbJ K
UsernamebbK S
,bbS T
modelbbU Z
.bbZ [
Passwordbb[ c
,bbc d
modelbbe j
.bbj k

RememberMebbk u
,bbu v
shouldLockout	bbw Ñ
:
bbÑ Ö
false
bbÜ ã
)
bbã å
;
bbå ç
switchcc 
(cc 
resultcc 
)cc 
{dd 
caseee 
SignInStatusee %
.ee% &
Successee& -
:ee- .
SetupLoggedInUserff )
(ff) *
modelff* /
.ff/ 0
Usernameff0 8
)ff8 9
;ff9 :
returngg 
Jsongg #
(gg# $
newgg$ '
JsonResponsegg( 4
(gg4 5
)gg5 6
{gg7 8
IsSucessgg9 A
=ggB C
trueggD H
}ggI J
,ggJ K
JsonRequestBehaviorggL _
.gg_ `
AllowGetgg` h
)ggh i
;ggi j
caseii 
SignInStatusii %
.ii% & 
RequiresVerificationii& :
:ii: ;
returnss 
RedirectToLocalss .
(ss. /
	returnUrlss/ 8
)ss8 9
;ss9 :
casevv 
SignInStatusvv %
.vv% &
	LockedOutvv& /
:vv/ 0
throwww 
newww !
AdsExceptionww" .
(ww. /
$strww/ ?
)ww? @
;ww@ A
caseyy 
SignInStatusyy %
.yy% &
Failureyy& -
:yy- .
throwzz 
newzz !
AdsExceptionzz" .
(zz. /
$strzz/ S
)zzS T
;zzT U
default{{ 
:{{ 
throw|| 
new|| !
AdsException||" .
(||. /
$str||/ S
)||S T
;||T U
} 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÉÉ 
return
ÑÑ 
Json
ÑÑ 
(
ÑÑ 
new
ÑÑ 
JsonResponse
ÑÑ  ,
(
ÑÑ, -
)
ÑÑ- .
{
ÑÑ/ 0
IsSucess
ÑÑ1 9
=
ÑÑ: ;
false
ÑÑ< A
,
ÑÑA B
ErrorMessage
ÑÑC O
=
ÑÑP Q
ex
ÑÑR T
.
ÑÑT U
Message
ÑÑU \
}
ÑÑ] ^
,
ÑÑ^ _!
JsonRequestBehavior
ÑÑ` s
.
ÑÑs t
AllowGet
ÑÑt |
)
ÑÑ| }
;
ÑÑ} ~
}
ÖÖ 
}
ÜÜ 	
[
åå 	
	Authorize
åå	 
]
åå 
public
çç 
ActionResult
çç 
LogOff
çç "
(
çç" #
)
çç# $
{
éé 	
Session
èè 
.
èè 
Clear
èè 
(
èè 
)
èè 
;
èè 
Session
êê 
.
êê 
Abandon
êê 
(
êê 
)
êê 
;
êê #
AuthenticationManager
ëë !
.
ëë! "
SignOut
ëë" )
(
ëë) *(
DefaultAuthenticationTypes
ëë* D
.
ëëD E
ApplicationCookie
ëëE V
)
ëëV W
;
ëëW X
return
íí 
RedirectToAction
íí #
(
íí# $
$str
íí$ +
,
íí+ ,
$str
íí- 6
)
íí6 7
;
íí7 8
}
ìì 	
[
¬¬ 	
AllowAnonymous
¬¬	 
]
¬¬ 
public
√√ 
ActionResult
√√ 
Register
√√ $
(
√√$ %
)
√√% &
{
ƒƒ 	
ViewBag
≈≈ 
.
≈≈ 

WhiteLabel
≈≈ 
=
≈≈  
new
≈≈! $

SelectList
≈≈% /
(
≈≈/ 0
CustomersList
≈≈0 =
,
≈≈= >
$str
≈≈? F
,
≈≈F G
$str
≈≈H N
)
≈≈N O
;
≈≈O P
return
∆∆ 
View
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
}
«« 	
[
ÀÀ 	
HttpPost
ÀÀ	 
]
ÀÀ 
[
ÃÃ 	
AllowAnonymous
ÃÃ	 
]
ÃÃ 
[
ÕÕ 	&
ValidateAntiForgeryToken
ÕÕ	 !
]
ÕÕ! "
public
ŒŒ 
async
ŒŒ 
Task
ŒŒ 
<
ŒŒ 
ActionResult
ŒŒ &
>
ŒŒ& '
Register
ŒŒ( 0
(
ŒŒ0 1
RegisterViewModel
ŒŒ1 B
model
ŒŒC H
)
ŒŒH I
{
œœ 	
if
–– 
(
–– 

ModelState
–– 
.
–– 
IsValid
–– "
)
––" #
{
—— 
var
’’ 
appUser
’’ 
=
’’ 
new
’’ !
WfpUser
’’" )
{
÷÷ 
Id
◊◊ 
=
◊◊ 
Guid
◊◊ 
.
◊◊ 
NewGuid
◊◊ %
(
◊◊% &
)
◊◊& '
.
◊◊' (
ToString
◊◊( 0
(
◊◊0 1
)
◊◊1 2
,
◊◊2 3
	CreatedAt
ÿÿ 
=
ÿÿ 
DateTime
ÿÿ  (
.
ÿÿ( )
Now
ÿÿ) ,
,
ÿÿ, -

WhiteLabel
ŸŸ 
=
ŸŸ  
model
ŸŸ! &
.
ŸŸ& '

WhiteLabel
ŸŸ' 1
,
ŸŸ1 2
UserName
⁄⁄ 
=
⁄⁄ 
model
⁄⁄ $
.
⁄⁄$ %
UserName
⁄⁄% -
,
⁄⁄- .
Email
€€ 
=
€€ 
model
€€ !
.
€€! "
Email
€€" '
,
€€' (
Status
‹‹ 
=
‹‹ 
(
‹‹ 
int
‹‹ !
)
‹‹! "

UserStatus
‹‹" ,
.
‹‹, -
Active
‹‹- 3
,
‹‹3 4
UserType
›› 
=
›› 
model
›› $
.
››$ %
IsAdminUser
››% 0
?
››1 2
(
››3 4
int
››4 7
)
››7 8
UserType
››8 @
.
››@ A
Admin
››A F
:
››F G
(
››H I
int
››I L
)
››L M
UserType
››M U
.
››U V
User
››V Z
,
››Z [
	IsUsesApi
ﬁﬁ 
=
ﬁﬁ 
model
ﬁﬁ  %
.
ﬁﬁ% &
	IsUsesApi
ﬁﬁ& /
,
ﬁﬁ/ 0
IsTestsCreatives
ﬂﬂ $
=
ﬂﬂ% &
model
ﬂﬂ' ,
.
ﬂﬂ, -
IsTestsCreatives
ﬂﬂ- =
}
‡‡ 
;
‡‡ 
var
·· 
result
·· 
=
·· 
UserManager
·· (
.
··( )
CreateAsync
··) 4
(
··4 5
appUser
··5 <
,
··< =
model
··> C
.
··C D
Password
··D L
)
··L M
;
··M N
if
‚‚ 
(
‚‚ 
result
‚‚ 
.
‚‚ 
Result
‚‚ !
==
‚‚" $
IdentityResult
‚‚% 3
.
‚‚3 4
Success
‚‚4 ;
)
‚‚; <
{
„„ 
return
‰‰ 
RedirectToAction
‰‰ +
(
‰‰+ ,
$str
‰‰, 3
,
‰‰3 4
$str
‰‰5 >
)
‰‰> ?
;
‰‰? @
}
ÂÂ 
	AddErrors
ÊÊ 
(
ÊÊ 
result
ÊÊ  
.
ÊÊ  !
Result
ÊÊ! '
)
ÊÊ' (
;
ÊÊ( )
}
ÁÁ 
ViewBag
ËË 
.
ËË 

WhiteLabel
ËË 
=
ËË  
new
ËË! $

SelectList
ËË% /
(
ËË/ 0
CustomersList
ËË0 =
,
ËË= >
$str
ËË? F
,
ËËF G
$str
ËËH N
)
ËËN O
;
ËËO P
return
ÍÍ 
View
ÍÍ 
(
ÍÍ 
model
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}
ÎÎ 	
[
≈≈ 	
AllowAnonymous
≈≈	 
]
≈≈ 
public
∆∆ 
ActionResult
∆∆ "
ExternalLoginFailure
∆∆ 0
(
∆∆0 1
)
∆∆1 2
{
«« 	
return
»» 
View
»» 
(
»» 
)
»» 
;
»» 
}
…… 	
	protected
ÀÀ 
override
ÀÀ 
void
ÀÀ 
Dispose
ÀÀ  '
(
ÀÀ' (
bool
ÀÀ( ,
	disposing
ÀÀ- 6
)
ÀÀ6 7
{
ÃÃ 	
if
ÕÕ 
(
ÕÕ 
	disposing
ÕÕ 
)
ÕÕ 
{
ŒŒ 
if
œœ 
(
œœ 
_userManager
œœ  
!=
œœ! #
null
œœ$ (
)
œœ( )
{
–– 
_userManager
——  
.
——  !
Dispose
——! (
(
——( )
)
——) *
;
——* +
_userManager
““  
=
““! "
null
““# '
;
““' (
}
”” 
if
’’ 
(
’’ 
_signInManager
’’ "
!=
’’# %
null
’’& *
)
’’* +
{
÷÷ 
_signInManager
◊◊ "
.
◊◊" #
Dispose
◊◊# *
(
◊◊* +
)
◊◊+ ,
;
◊◊, -
_signInManager
ÿÿ "
=
ÿÿ# $
null
ÿÿ% )
;
ÿÿ) *
}
ŸŸ 
}
⁄⁄ 
base
‹‹ 
.
‹‹ 
Dispose
‹‹ 
(
‹‹ 
	disposing
‹‹ "
)
‹‹" #
;
‹‹# $
}
›› 	
private
·· 
const
·· 
string
·· 
XsrfKey
·· $
=
··% &
$str
··' /
;
··/ 0
private
„„ $
IAuthenticationManager
„„ &#
AuthenticationManager
„„' <
{
‰‰ 	
get
ÂÂ 
{
ÊÊ 
return
ÁÁ 
HttpContext
ÁÁ "
.
ÁÁ" #
GetOwinContext
ÁÁ# 1
(
ÁÁ1 2
)
ÁÁ2 3
.
ÁÁ3 4
Authentication
ÁÁ4 B
;
ÁÁB C
}
ËË 
}
ÈÈ 	
private
ÎÎ 
void
ÎÎ 
	AddErrors
ÎÎ 
(
ÎÎ 
IdentityResult
ÎÎ -
result
ÎÎ. 4
)
ÎÎ4 5
{
ÏÏ 	
foreach
ÌÌ 
(
ÌÌ 
var
ÌÌ 
error
ÌÌ 
in
ÌÌ !
result
ÌÌ" (
.
ÌÌ( )
Errors
ÌÌ) /
)
ÌÌ/ 0
{
ÓÓ 

ModelState
ÔÔ 
.
ÔÔ 
AddModelError
ÔÔ (
(
ÔÔ( )
$str
ÔÔ) +
,
ÔÔ+ ,
error
ÔÔ- 2
)
ÔÔ2 3
;
ÔÔ3 4
}
 
}
ÒÒ 	
private
ÛÛ 
ActionResult
ÛÛ 
RedirectToLocal
ÛÛ ,
(
ÛÛ, -
string
ÛÛ- 3
	returnUrl
ÛÛ4 =
)
ÛÛ= >
{
ÙÙ 	
if
ıı 
(
ıı 
Url
ıı 
.
ıı 

IsLocalUrl
ıı 
(
ıı 
	returnUrl
ıı (
)
ıı( )
)
ıı) *
{
ˆˆ 
return
˜˜ 
Redirect
˜˜ 
(
˜˜  
	returnUrl
˜˜  )
)
˜˜) *
;
˜˜* +
}
¯¯ 
return
˘˘ 
RedirectToAction
˘˘ #
(
˘˘# $
$str
˘˘$ +
,
˘˘+ ,
$str
˘˘- 3
)
˘˘3 4
;
˘˘4 5
}
˙˙ 	
internal
¸¸ 
class
¸¸ 
ChallengeResult
¸¸ &
:
¸¸' ($
HttpUnauthorizedResult
¸¸) ?
{
˝˝ 	
public
˛˛ 
ChallengeResult
˛˛ "
(
˛˛" #
string
˛˛# )
provider
˛˛* 2
,
˛˛2 3
string
˛˛4 :
redirectUri
˛˛; F
)
˛˛F G
:
ˇˇ 
this
ˇˇ 
(
ˇˇ 
provider
ˇˇ 
,
ˇˇ  
redirectUri
ˇˇ! ,
,
ˇˇ, -
null
ˇˇ. 2
)
ˇˇ2 3
{
ÄÄ 
}
ÅÅ 
public
ÉÉ 
ChallengeResult
ÉÉ "
(
ÉÉ" #
string
ÉÉ# )
provider
ÉÉ* 2
,
ÉÉ2 3
string
ÉÉ4 :
redirectUri
ÉÉ; F
,
ÉÉF G
string
ÉÉH N
userId
ÉÉO U
)
ÉÉU V
{
ÑÑ 
LoginProvider
ÖÖ 
=
ÖÖ 
provider
ÖÖ  (
;
ÖÖ( )
RedirectUri
ÜÜ 
=
ÜÜ 
redirectUri
ÜÜ )
;
ÜÜ) *
UserId
áá 
=
áá 
userId
áá 
;
áá  
}
àà 
public
ää 
string
ää 
LoginProvider
ää '
{
ää( )
get
ää* -
;
ää- .
set
ää/ 2
;
ää2 3
}
ää4 5
public
ãã 
string
ãã 
RedirectUri
ãã %
{
ãã& '
get
ãã( +
;
ãã+ ,
set
ãã- 0
;
ãã0 1
}
ãã2 3
public
åå 
string
åå 
UserId
åå  
{
åå! "
get
åå# &
;
åå& '
set
åå( +
;
åå+ ,
}
åå- .
public
éé 
override
éé 
void
éé  
ExecuteResult
éé! .
(
éé. /
ControllerContext
éé/ @
context
ééA H
)
ééH I
{
èè 
var
êê 

properties
êê 
=
êê  
new
êê! $&
AuthenticationProperties
êê% =
{
êê> ?
RedirectUri
êê@ K
=
êêL M
RedirectUri
êêN Y
}
êêZ [
;
êê[ \
if
ëë 
(
ëë 
UserId
ëë 
!=
ëë 
null
ëë "
)
ëë" #
{
íí 

properties
ìì 
.
ìì 

Dictionary
ìì )
[
ìì) *
XsrfKey
ìì* 1
]
ìì1 2
=
ìì3 4
UserId
ìì5 ;
;
ìì; <
}
îî 
context
ïï 
.
ïï 
HttpContext
ïï #
.
ïï# $
GetOwinContext
ïï$ 2
(
ïï2 3
)
ïï3 4
.
ïï4 5
Authentication
ïï5 C
.
ïïC D
	Challenge
ïïD M
(
ïïM N

properties
ïïN X
,
ïïX Y
LoginProvider
ïïZ g
)
ïïg h
;
ïïh i
}
ññ 
}
óó 	
}
ôô 
}öö ÏW
DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\API\AdsController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
API 
{ 
public 

class 
AdsController 
:  
ApiController! .
{ 
private 
readonly 
string (
_authenticationParameterName  <
== >
$str? K
;K L
private 
readonly 
int 
_apiMaxDailyLimit .
=/ 0
$num1 3
;3 4
private 
readonly 
WfpictContext &
_db' *
=+ ,
new- 0
WfpictContext1 >
(> ?
)? @
;@ A
public 

JsonResult 
< 
JsonResponse &
>& '
Get( +
(+ ,
), -
{ 	
try 
{ 
if 
( 
! 
Request 
. 
Headers $
.$ %
Contains% -
(- .(
_authenticationParameterName. J
)J K
)K L
{ 
throw 
new 
AdsException *
(* +
$str+ N
)N O
;O P
} 
string 
token 
= 
Request &
.& '
Headers' .
.. /
	GetValues/ 8
(8 9(
_authenticationParameterName9 U
)U V
.V W
FirstW \
(\ ]
)] ^
;^ _
var!! 
user!! 
=!! 
_db!! 
.!! 
Users!! $
.!!$ %
FirstOrDefault!!% 3
(!!3 4
x!!4 5
=>!!6 8
x!!9 :
.!!: ;
ApiKey!!; A
.!!A B
Equals!!B H
(!!H I
token!!I N
)!!N O
)!!O P
;!!P Q
var"" 
isValidUser"" 
=""  !
user""" &
!=""' )
null""* .
;"". /
if## 
(## 
!## 
isValidUser##  
)##  !
{$$ 
throw%% 
new%% 
AdsException%% *
(%%* +
$str%%+ K
)%%K L
;%%L M
}&& 
int(( 
todaysRequests(( "
=((# $
_db((% (
.((( )
ApiRequests(() 4
.((4 5
Count((5 :
(((: ;
x((; <
=>((= ?
x((@ A
.((A B
APIKey((B H
==((I K
token((L Q
&&((R T
x((U V
.((V W
	CreatedAt((W `
.((` a
Date((a e
==((f h
DateTime((i q
.((q r
Now((r u
.((u v
Date((v z
)((z {
;(({ |
if)) 
()) 
todaysRequests)) "
>))# $
_apiMaxDailyLimit))% 6
)))6 7
{** 
throw++ 
new++ 
AdsException++ *
(++* +
$str+++ A
+++B C
_apiMaxDailyLimit++D U
+++V W
$str,,( N
),,N O
;,,O P
}-- 
_db// 
.// 
ApiRequests// 
.//  
Add//  #
(//# $
new//$ '

ApiRequest//( 2
(//2 3
)//3 4
{00 
Id11 
=11 
Guid11 
.11 
NewGuid11 %
(11% &
)11& '
,11' (
	CreatedAt22 
=22 
DateTime22  (
.22( )
Now22) ,
,22, -
APIKey33 
=33 
token33 "
}44 
)44 
;44 
_db55 
.55 
SaveChanges55 
(55  
)55  !
;55! "
var77 
	campaigns77 
=77 
_db77  #
.77# $
	Campaigns77$ -
.88 
Include88 
(88 
x88 
=>88 !
x88" #
.88# $
ProDatas88$ ,
)88, -
.99 
Include99 
(99 
x99 
=>99 !
x99" #
.99# $
Testing99$ +
)99+ ,
.:: 
Include:: 
(:: 
x:: 
=>:: !
x::" #
.::# $
Approved::$ ,
)::, -
.;; 
Where;; 
(;; 
x;; 
=>;; 
x;;  !
.;;! "
AssignedToCustomer;;" 4
==;;5 7
user;;8 <
.;;< =
Id;;= ?
&&;;@ B
x;;C D
.;;D E
Status;;E K
==;;L N
(;;O P
int;;P S
);;S T
CampaignStatus;;T b
.;;b c
	Completed;;c l
);;l m
.<< 
ToList<< 
(<< 
)<< 
.== 
Select== 
(== 
x== 
=>==  
Campaign==! )
.==) *
FromCampaign==* 6
(==6 7
x==7 8
)==8 9
)==9 :
;==: ;
return?? 
Json?? 
(?? 
new?? 
JsonResponse??  ,
(??, -
)??- .
{??/ 0
IsSucess??0 8
=??9 :
true??; ?
,??? @
Result??A G
=??H I
	campaigns??J S
}??S T
)??T U
;??U V
}@@ 
catchAA 
(AA 
	ExceptionAA 
exAA 
)AA  
{BB 
returnCC 
JsonCC 
(CC 
newCC 
JsonResponseCC  ,
(CC, -
)CC- .
{CC/ 0
IsSucessCC0 8
=CC9 :
falseCC; @
,CC@ A
ErrorMessageCCB N
=CCO P
exCCQ S
.CCS T
MessageCCT [
}CC[ \
)CC\ ]
;CC] ^
}DD 
}EE 	
publicHH 

JsonResultHH 
<HH 
JsonResponseHH &
>HH& '
PostHH( ,
(HH, -
[HH- .
FromBodyHH. 6
]HH6 7
CampaignHH8 @
campaginHHA I
)HHI J
{II 	
tryJJ 
{KK 
ifLL 
(LL 
!LL 
RequestLL 
.LL 
HeadersLL $
.LL$ %
ContainsLL% -
(LL- .(
_authenticationParameterNameLL. J
)LLJ K
)LLK L
{MM 
throwNN 
newNN 
AdsExceptionNN *
(NN* +
$strNN+ N
)NNN O
;NNO P
}OO 
ifPP 
(PP 
stringPP 
.PP 
IsNullOrEmptyPP (
(PP( )
campaginPP) 1
.PP1 2
OrderNumberPP2 =
)PP= >
)PP> ?
{QQ 
throwRR 
newRR 
AdsExceptionRR *
(RR* +
$strRR+ C
)RRC D
;RRD E
}SS 
ifTT 
(TT 
stringTT 
.TT 
IsNullOrEmptyTT (
(TT( )
campaginTT) 1
.TT1 2
IoNumberTT2 :
)TT: ;
)TT; <
{UU 
throwVV 
newVV 
AdsExceptionVV *
(VV* +
$strVV+ @
)VV@ A
;VVA B
}WW 
stringYY 
tokenYY 
=YY 
RequestYY &
.YY& '
HeadersYY' .
.YY. /
	GetValuesYY/ 8
(YY8 9(
_authenticationParameterNameYY9 U
)YYU V
.YYV W
FirstYYW \
(YY\ ]
)YY] ^
;YY^ _
var[[ 
user[[ 
=[[ 
_db[[ 
.[[ 
Users[[ $
.[[$ %
FirstOrDefault[[% 3
([[3 4
x[[4 5
=>[[6 8
x[[9 :
.[[: ;
ApiKey[[; A
.[[A B
Equals[[B H
([[H I
token[[I N
)[[N O
)[[O P
;[[P Q
var\\ 
isValidUser\\ 
=\\  !
user\\" &
!=\\' )
null\\* .
;\\. /
if]] 
(]] 
!]] 
isValidUser]]  
)]]  !
{^^ 
throw__ 
new__ 
AdsException__ *
(__* +
$str__+ K
)__K L
;__L M
}`` 
_dbbb 
.bb 
ApiRequestsbb 
.bb  
Addbb  #
(bb# $
newbb$ '

ApiRequestbb( 2
(bb2 3
)bb3 4
{cc 
Iddd 
=dd 
Guiddd 
.dd 
NewGuiddd %
(dd% &
)dd& '
,dd' (
	CreatedAtee 
=ee 
DateTimeee  (
.ee( )
Nowee) ,
,ee, -
APIKeyff 
=ff 
tokenff "
}gg 
)gg 
;gg 
_dbhh 
.hh 
SaveChangeshh 
(hh  
)hh  !
;hh! "
varjj 
campaignTrackingjj $
=jj% &
_dbjj' *
.jj* +
CampaignTrackingsjj+ <
.kk  !
FirstOrDefaultkk! /
(kk/ 0
xkk0 1
=>kk2 4
xkk5 6
.kk6 7
SegmentNumberkk7 D
==kkE G
campaginkkH P
.kkP Q
OrderNumberkkQ \
.kk\ ]
Trimkk] a
(kka b
)kkb c
)kkc d
;kkd e
ifmm 
(mm 
campaignTrackingmm $
==mm% '
nullmm( ,
)mm, -
{nn 
throwoo 
newoo 
AdsExceptionoo *
(oo* +
$stroo+ H
+ooI J
campaginooK S
.ooS T
OrderNumberooT _
+oo` a
$stroob t
)oot u
;oou v
}pp 
campaignTrackingrr  
.rr  !
IoNumberrr! )
=rr* +
campaginrr, 4
.rr4 5
IoNumberrr5 =
.rr= >
Trimrr> B
(rrB C
)rrC D
;rrD E
_dbss 
.ss 
SaveChangesss 
(ss  
)ss  !
;ss! "
stringuu 
messageuu 
=uu  
$struu! >
+uu? @
campaginuuA I
.uuI J
OrderNumberuuJ U
+uuV W
$strvv! D
+vvE F
campaginvvG O
.vvO P
IoNumbervvP X
;vvX Y
returnxx 
Jsonxx 
(xx 
newxx 
JsonResponsexx  ,
(xx, -
)xx- .
{xx/ 0
IsSucessxx1 9
=xx: ;
truexx< @
,xx@ A
ResultxxB H
=xxI J
messagexxK R
}xxS T
)xxT U
;xxU V
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
return|| 
Json|| 
(|| 
new|| 
JsonResponse||  ,
(||, -
)||- .
{||/ 0
IsSucess||1 9
=||: ;
false||< A
,||A B
ErrorMessage||C O
=||P Q
ex||R T
.||T U
Message||U \
}||] ^
)||^ _
;||_ `
}}} 
}~~ 	
}
ÄÄ 
}ÅÅ Å“
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\ApprovedController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
ApprovedController #
:$ %
BaseController& 4
{ 
public 
ActionResult 
Index !
(! "
Guid" &
?& '
id( *
)* +
{ 	
var 
campaign 
= 
Db 
. 
	Campaigns '
. 
Include 
( 
c 
=> 
c 
.  
Testing  '
)' (
. 
Include 
( 
c 
=> 
c 
.  
Approved  (
)( )
. 
FirstOrDefault 
(  
c  !
=>" $
c% &
.& '
Id' )
==* ,
id- /
)/ 0
;0 1
Session 
[ 
$str 
] 
= 
id 
; 
Session 
[ 
$str !
]! "
=# $
campaign% -
.- .
OrderNumber. 9
;9 :
if 
( 
campaign 
. 
Testing  
==! #
null$ (
)( )
{ 
TempData   
[   
$str    
]    !
=  " #
$str  $ H
;  H I
return!! 
RedirectToAction!! '
(!!' (
$str!!( /
,!!/ 0
$str!!1 <
)!!< =
;!!= >
}"" 
if$$ 
($$ 
campaign$$ 
.$$ 
Approved$$ !
==$$" $
null$$% )
)$$) *
{%% 
var&& 
testing&& 
=&& 
campaign&& &
.&&& '
Testing&&' .
;&&. /
var'' 

approvedId'' 
=''  
Guid''! %
.''% &
NewGuid''& -
(''- .
)''. /
;''/ 0
var(( 
approved(( 
=(( 
new(( "
CampaignApproved((# 3
(((3 4
)((4 5
{)) 
Id** 
=** 

approvedId** #
,**# $

CampaignId++ 
=++  
campaign++! )
.++) *
Id++* ,
,++, -
	CreatedAt,, 
=,, 
DateTime,,  (
.,,( )
Now,,) ,
,,,, -
	CreatedBy-- 
=-- 
campaign--  (
.--( )
	CreatedBy--) 2
,--2 3
CampaignName..  
=..! "
testing..# *
...* +
CampaignName..+ 7
,..7 8

WhiteLabel// 
=//  
testing//! (
.//( )

WhiteLabel//) 3
,//3 4
ReBroadCast00 
=00  !
testing00" )
.00) *
ReBroadCast00* 5
,005 6
ReBroadcastDate11 #
=11$ %
testing11& -
.11- .
ReBroadcastDate11. =
,11= >
FromLine22 
=22 
testing22 &
.22& '
FromLine22' /
,22/ 0
SubjectLine33 
=33  !
testing33" )
.33) *
SubjectLine33* 5
,335 6

DeployDate44 
=44  
testing44! (
.44( )

DeployDate44) 3
,443 4

GeoDetails66 
=66  
testing66! (
.66( )

GeoDetails66) 3
,663 4
Demographics77  
=77! "
testing77# *
.77* +
Demographics77+ 7
,777 8
Quantity88 
=88 
testing88 &
.88& '
Quantity88' /
,88/ 0
SpecialInstructions99 '
=99( )
testing99* 1
.991 2
SpecialInstructions992 E
,99E F
ReportSiteLink:: "
=::# $
$"::% '(
http://report-site.com/c/ADS::' C
{::C D
campaign::D L
.::L M
OrderNumber::M X
}::X Y
"::Y Z
,::Z [
LinkBreakout;;  
=;;! "
$";;# %/
#http://www.digitaldynamixs.net/ep2/;;% H
{;;H I
campaign;;I Q
.;;Q R
OrderNumber;;R ]
};;] ^
/;;^ _
{;;_ `
campaign;;` h
.;;h i
OrderNumber;;i t
};;t u
	linkr.csv;;u ~
";;~ 
,	;; Ä
IsOpenPixel<< 
=<<  !
testing<<" )
.<<) *
IsOpenPixel<<* 5
,<<5 6
OpenPixelUrl==  
===! "
testing==# *
.==* +
OpenPixelUrl==+ 7
,==7 8
	OpenGoals>> 
=>> 
testing>>  '
.>>' (
	OpenGoals>>( 1
,>>1 2

ClickGoals?? 
=??  
testing??! (
.??( )

ClickGoals??) 3
,??3 4
DataFileQuantity@@ $
=@@% &
testing@@' .
.@@. /
DataFileQuantity@@/ ?
,@@? @
DataFileUrlAA 
=AA  !
testingAA" )
.AA) *
DataFileUrlAA* 5
,AA5 6
IsOmniOrderCC 
=CC  !
testingCC" )
.CC) *
IsOmniOrderCC* 5
,CC5 6
OmniDeployDateDD "
=DD# $
testingDD% ,
.DD, -
OmniDeployDateDD- ;
,DD; <
ImpressionsEE 
=EE  !
testingEE" )
.EE) *
ImpressionsEE* 5
,EE5 6
ChannelTypesFF  
=FF! "
testingFF# *
.FF* +
ChannelTypesFF+ 7
,FF7 8
}GG 
;GG 
DbHH 
.HH 
CampaignsApprovedHH $
.HH$ %
AddHH% (
(HH( )
approvedHH) 1
)HH1 2
;HH2 3
DbII 
.II 
SaveChangesII 
(II 
)II  
;II  !
campaignJJ 
.JJ 

ApprovedIdJJ #
=JJ$ %

approvedIdJJ& 0
;JJ0 1
DbKK 
.KK 
SaveChangesKK 
(KK 
)KK  
;KK  !
}LL 
campaignMM 
.MM 
StatusMM 
=MM 
(MM 
intMM "
)MM" #
CampaignStatusMM# 1
.MM1 2
ApprovedMM2 :
;MM: ;
DbNN 
.NN 
SaveChangesNN 
(NN 
)NN 
;NN 
returnOO 
RedirectToActionOO #
(OO# $
$strOO$ 2
,OO2 3
$strOO4 >
,OO> ?
newOO@ C
{OOD E
idOOF H
=OOI J
campaignOOK S
.OOS T

ApprovedIdOOT ^
}OO_ `
)OO` a
;OOa b
}QQ 	
publicTT 
ActionResultTT 
EditApprovedTT (
(TT( )
GuidTT) -
?TT- .
idTT/ 1
)TT1 2
{UU 	
CampaignApprovedVV 
campaignApprovedVV -
=VV. /
DbVV0 2
.VV2 3
CampaignsApprovedVV3 D
.VVD E
FirstOrDefaultVVE S
(VVS T
cVVT U
=>VVV X
cVVY Z
.VVZ [
IdVV[ ]
==VV^ `
idVVa c
)VVc d
;VVd e
ifWW 
(WW 
campaignApprovedWW  
==WW! #
nullWW$ (
)WW( )
{XX 
throwYY 
newYY 
HttpExceptionYY '
(YY' (
$numYY( +
,YY+ ,
$strYY- 8
)YY8 9
;YY9 :
}ZZ 

TinyMapper\\ 
.\\ 
Bind\\ 
<\\ 
CampaignApproved\\ ,
,\\, -
CampaignApprovedVm\\. @
>\\@ A
(\\A B
config\\B H
=>\\I K
{]] 
config^^ 
.^^ 
Ignore^^ 
(^^ 
x^^ 
=>^^  "
x^^# $
.^^$ %
ChannelTypes^^% 1
)^^1 2
;^^2 3
}__ 
)__ 
;__ 
varaa 
campaignApprovedVmaa "
=aa# $

TinyMapperaa% /
.aa/ 0
Mapaa0 3
<aa3 4
CampaignApprovedVmaa4 F
>aaF G
(aaG H
campaignApprovedaaH X
)aaX Y
;aaY Z
Campaignbb 
campaignbb 
=bb 
Dbbb  "
.bb" #
	Campaignsbb# ,
.cc 
Includecc 
(cc 
xcc 
=>cc  
xcc! "
.cc" #
Assetscc# )
)cc) *
.dd 
Includedd 
(dd 
xdd 
=>dd  
xdd! "
.dd" #
Segmentsdd# +
)dd+ ,
.ee 
FirstOrDefaultee "
(ee" #
xee# $
=>ee% '
xee( )
.ee) *
Idee* ,
==ee- /
campaignApprovedVmee0 B
.eeB C

CampaignIdeeC M
)eeM N
;eeN O
campaignApprovedVmff 
.ff 
OrderNumberff *
=ff+ ,
campaignff- 5
.ff5 6
OrderNumberff6 A
;ffA B
campaignApprovedVmgg 
.gg 
Assetsgg %
=gg& '
campaigngg( 0
.gg0 1
Assetsgg1 7
;gg7 8
foreachhh 
(hh 
varhh 
segmenthh  
inhh! #
campaignhh$ ,
.hh, -
Segmentshh- 5
)hh5 6
{ii 
varjj 
	segmentVmjj 
=jj 

TinyMapperjj  *
.jj* +
Mapjj+ .
<jj. /
CampaignSegmentVmjj/ @
>jj@ A
(jjA B
segmentjjB I
)jjI J
;jjJ K
campaignApprovedVmkk "
.kk" #
Segmentskk# +
.kk+ ,
Addkk, /
(kk/ 0
	segmentVmkk0 9
)kk9 :
;kk: ;
}ll 
campaignApprovedVmnn 
.nn 
ChannelTypesnn +
=nn, -
stringnn. 4
.nn4 5
IsNullOrEmptynn5 B
(nnB C
campaignApprovednnC S
.nnS T
ChannelTypesnnT `
)nn` a
?nnb c
newnnd g
Listnnh l
<nnl m
ChannelTypennm x
>nnx y
{nnz {
}nn| }
:nn~ 
campaignApprovedoo  
.oo  !
ChannelTypesoo! -
.pp 
Splitpp 
(pp 
$strpp 
.pp 
ToCharArraypp *
(pp* +
)pp+ ,
)pp, -
.qq 
Selectqq 
(qq 
xqq 
=>qq  
(qq! "
ChannelTypeqq" -
)qq- .
Systemqq. 4
.qq4 5
Enumqq5 9
.qq9 :
Parseqq: ?
(qq? @
typeofqq@ F
(qqF G
ChannelTypeqqG R
)qqR S
,qqS T
xqqU V
)qqV W
)qqW X
.qqX Y
ToListqqY _
(qq_ `
)qq` a
;qqa b
varss 
proDatass 
=ss 
VendorsListss %
.ss% &
FirstOrDefaultss& 4
(ss4 5
xss5 6
=>ss7 9
xss: ;
.ss; <
Textss< @
.ss@ A
ToLowerInvariantssA Q
(ssQ R
)ssR S
.ssS T
ContainsssT \
(ss\ ]
$strss] b
)ssb c
)ssc d
;ssd e
ViewBagtt 
.tt 
Vendortt 
=tt 
newtt  

SelectListtt! +
(tt+ ,
VendorsListtt, 7
,tt7 8
$strtt9 @
,tt@ A
$strttB H
,ttH I
proDatattJ Q
)ttQ R
;ttR S
ViewBaguu 
.uu 

WhiteLabeluu 
=uu  
newuu! $

SelectListuu% /
(uu/ 0
CustomersListuu0 =
,uu= >
$struu? F
,uuF G
$struuH N
,uuN O
campaignApprovedVmuuP b
.uub c

WhiteLabeluuc m
)uum n
;uun o
returnvv 
Viewvv 
(vv 
campaignApprovedVmvv *
)vv* +
;vv+ ,
}ww 	
[yy 	
HttpPostyy	 
]yy 
[zz 	$
ValidateAntiForgeryTokenzz	 !
]zz! "
public{{ 
ActionResult{{ 
EditApproved{{ (
({{( )
[{{) *
Bind{{* .
({{. /
Include{{/ 6
={{7 8
$str	{{9 ÷
)
{{÷ ◊
]
{{◊ ÿ 
CampaignApprovedVm
{{Ÿ Î 
campaignApprovedVm
{{Ï ˛
)
{{˛ ˇ
{|| 	
if}} 
(}} 

ModelState}} 
.}} 
IsValid}} "
)}}" #
{~~ 

TinyMapper
ÅÅ 
.
ÅÅ 
Bind
ÅÅ 
<
ÅÅ   
CampaignApprovedVm
ÅÅ  2
,
ÅÅ2 3
CampaignApproved
ÅÅ4 D
>
ÅÅD E
(
ÅÅE F
config
ÅÅF L
=>
ÅÅM O
{
ÇÇ 
config
ÉÉ 
.
ÉÉ 
Ignore
ÉÉ !
(
ÉÉ! "
x
ÉÉ" #
=>
ÉÉ$ &
x
ÉÉ' (
.
ÉÉ( )
ChannelTypes
ÉÉ) 5
)
ÉÉ5 6
;
ÉÉ6 7
config
ÑÑ 
.
ÑÑ 
Ignore
ÑÑ !
(
ÑÑ! "
x
ÑÑ" #
=>
ÑÑ$ &
x
ÑÑ' (
.
ÑÑ( )
Assets
ÑÑ) /
)
ÑÑ/ 0
;
ÑÑ0 1
config
ÖÖ 
.
ÖÖ 
Ignore
ÖÖ !
(
ÖÖ! "
x
ÖÖ" #
=>
ÖÖ$ &
x
ÖÖ' (
.
ÖÖ( )
Segments
ÖÖ) 1
)
ÖÖ1 2
;
ÖÖ2 3
}
ÜÜ 
)
ÜÜ 
;
ÜÜ 
var
áá 
campaignApproved
áá $
=
áá% &

TinyMapper
áá' 1
.
áá1 2
Map
áá2 5
<
áá5 6
CampaignApproved
áá6 F
>
ááF G
(
ááG H 
campaignApprovedVm
ááH Z
)
ááZ [
;
áá[ \
campaignApproved
àà  
.
àà  !
ChannelTypes
àà! -
=
àà. / 
campaignApprovedVm
àà0 B
.
ààB C
ChannelTypes
ààC O
==
ààP R
null
ààS W
?
ààX Y
null
ààZ ^
:
àà_ `
string
ââ 
.
ââ 
Join
ââ 
(
ââ  
$str
ââ  #
,
ââ# $ 
campaignApprovedVm
ââ% 7
.
ââ7 8
ChannelTypes
ââ8 D
)
ââD E
;
ââE F
Db
ää 
.
ää 
Entry
ää 
(
ää 
campaignApproved
ää )
)
ää) *
.
ää* +
State
ää+ 0
=
ää1 2
EntityState
ää3 >
.
ää> ?
Modified
ää? G
;
ääG H
Db
ãã 
.
ãã 
SaveChanges
ãã 
(
ãã 
)
ãã  
;
ãã  !
var
éé 
campaignAssets
éé "
=
éé# $
Db
éé% '
.
éé' (
CampaignAssets
éé( 6
.
éé6 7
FirstOrDefault
éé7 E
(
ééE F
x
ééF G
=>
ééH J
x
ééK L
.
ééL M

CampaignId
ééM W
==
ééX Z 
campaignApprovedVm
éé[ m
.
éém n

CampaignId
één x
)
ééx y
;
ééy z
campaignAssets
èè 
.
èè 
CreativeFiles
èè ,
=
èè- . 
campaignApprovedVm
èè/ A
.
èèA B
Assets
èèB H
.
èèH I
CreativeFiles
èèI V
;
èèV W
campaignAssets
êê 
.
êê 
CreativeUrl
êê *
=
êê+ , 
campaignApprovedVm
êê- ?
.
êê? @
Assets
êê@ F
.
êêF G
CreativeUrl
êêG R
;
êêR S
campaignAssets
ëë 
.
ëë 
ZipCodeFile
ëë *
=
ëë+ , 
campaignApprovedVm
ëë- ?
.
ëë? @
Assets
ëë@ F
.
ëëF G
ZipCodeFile
ëëG R
;
ëëR S
campaignAssets
íí 
.
íí 

ZipCodeUrl
íí )
=
íí* + 
campaignApprovedVm
íí, >
.
íí> ?
Assets
íí? E
.
ííE F

ZipCodeUrl
ííF P
;
ííP Q
campaignAssets
ìì 
.
ìì 
TestSeedFile
ìì +
=
ìì, - 
campaignApprovedVm
ìì. @
.
ìì@ A
Assets
ììA G
.
ììG H
TestSeedFile
ììH T
;
ììT U
campaignAssets
îî 
.
îî 
LiveSeedFile
îî +
=
îî, - 
campaignApprovedVm
îî. @
.
îî@ A
Assets
îîA G
.
îîG H
LiveSeedFile
îîH T
;
îîT U
Db
ïï 
.
ïï 
Entry
ïï 
(
ïï 
campaignAssets
ïï '
)
ïï' (
.
ïï( )
State
ïï) .
=
ïï/ 0
EntityState
ïï1 <
.
ïï< =
Modified
ïï= E
;
ïïE F
Db
ññ 
.
ññ 
SaveChanges
ññ 
(
ññ 
)
ññ  
;
ññ  !
TempData
òò 
[
òò 
$str
òò "
]
òò" #
=
òò$ %
$str
òò& I
;
òòI J
}
ôô 
else
öö 
{
õõ 
var
úú 
	errorList
úú 
=
úú 
(
úú  !
from
úú! %
item
úú& *
in
úú+ -

ModelState
úú. 8
.
úú8 9
Values
úú9 ?
from
ùù! %
error
ùù& +
in
ùù, .
item
ùù/ 3
.
ùù3 4
Errors
ùù4 :
select
ûû! '
error
ûû( -
.
ûû- .
ErrorMessage
ûû. :
)
ûû: ;
.
ûû; <
ToList
ûû< B
(
ûûB C
)
ûûC D
;
ûûD E
TempData
üü 
[
üü 
$str
üü  
]
üü  !
=
üü" #
$str
üü$ D
+
üüE F
string
üüG M
.
üüM N
Join
üüN R
(
üüR S
$str
üüS Z
,
üüZ [
	errorList
üü\ e
)
üüe f
;
üüf g
}
†† 
var
°° 
proData
°° 
=
°° 
VendorsList
°° %
.
°°% &
FirstOrDefault
°°& 4
(
°°4 5
x
°°5 6
=>
°°7 9
x
°°: ;
.
°°; <
Text
°°< @
.
°°@ A
Contains
°°A I
(
°°I J
$str
°°J O
)
°°O P
)
°°P Q
;
°°Q R
ViewBag
¢¢ 
.
¢¢ 
Vendor
¢¢ 
=
¢¢ 
new
¢¢  

SelectList
¢¢! +
(
¢¢+ ,
VendorsList
¢¢, 7
,
¢¢7 8
$str
¢¢9 @
,
¢¢@ A
$str
¢¢B H
,
¢¢H I
proData
¢¢J Q
)
¢¢Q R
;
¢¢R S
ViewBag
££ 
.
££ 

WhiteLabel
££ 
=
££  
new
££! $

SelectList
££% /
(
££/ 0
CustomersList
££0 =
,
££= >
$str
££? F
,
££F G
$str
££H N
,
££N O 
campaignApprovedVm
££P b
.
££b c

WhiteLabel
££c m
)
££m n
;
££n o
return
•• 
View
•• 
(
••  
campaignApprovedVm
•• *
)
••* +
;
••+ ,
}
¶¶ 	
public
®® 
ActionResult
®® 
CompleteSegment
®® +
(
®®+ ,
Guid
®®, 0
?
®®0 1
id
®®2 4
)
®®4 5
{
©© 	
try
™™ 
{
´´ 
var
¨¨ 
segment
¨¨ 
=
¨¨ 
Db
¨¨  
.
¨¨  !
CampaignSegments
¨¨! 1
.
¨¨1 2
FirstOrDefault
¨¨2 @
(
¨¨@ A
x
¨¨A B
=>
¨¨C E
x
¨¨F G
.
¨¨G H
Id
¨¨H J
==
¨¨K M
id
¨¨N P
)
¨¨P Q
;
¨¨Q R
segment
≠≠ 
.
≠≠ 
SegmentStatus
≠≠ %
=
≠≠& '
(
≠≠( )
int
≠≠) ,
)
≠≠, -
SegmentStatus
≠≠- :
.
≠≠: ;
Complete
≠≠; C
;
≠≠C D
segment
ÆÆ 
.
ÆÆ 
DateComplete
ÆÆ $
=
ÆÆ% &
DateTime
ÆÆ' /
.
ÆÆ/ 0
Now
ÆÆ0 3
;
ÆÆ3 4
Db
ØØ 
.
ØØ 
SaveChanges
ØØ 
(
ØØ 
)
ØØ  
;
ØØ  !
return
∞∞ 
Json
∞∞ 
(
∞∞ 
new
∞∞ 
JsonResponse
∞∞  ,
(
∞∞, -
)
∞∞- .
{
∞∞/ 0
IsSucess
∞∞1 9
=
∞∞: ;
true
∞∞< @
}
∞∞A B
,
∞∞B C!
JsonRequestBehavior
∞∞D W
.
∞∞W X
AllowGet
∞∞X `
)
∞∞` a
;
∞∞a b
}
±± 
catch
≤≤ 
(
≤≤ 
	Exception
≤≤ 
ex
≤≤ 
)
≤≤  
{
≥≥ 
return
¥¥ 
Json
¥¥ 
(
¥¥ 
new
¥¥ 
JsonResponse
¥¥  ,
(
¥¥, -
)
¥¥- .
{
¥¥/ 0
IsSucess
¥¥1 9
=
¥¥: ;
false
¥¥< A
,
¥¥A B
ErrorMessage
¥¥C O
=
¥¥P Q
ex
¥¥R T
.
¥¥T U
Message
¥¥U \
}
¥¥] ^
,
¥¥^ _!
JsonRequestBehavior
¥¥` s
.
¥¥s t
AllowGet
¥¥t |
)
¥¥| }
;
¥¥} ~
}
µµ 
}
∂∂ 	
public
∏∏ 
ActionResult
∏∏ 
SendToVendor
∏∏ (
(
∏∏( )
OrderVia
∏∏) 1
via
∏∏2 5
,
∏∏5 6
Guid
∏∏7 ;
?
∏∏; <
vendorId
∏∏= E
,
∏∏E F
Guid
∏∏G K
?
∏∏K L
id
∏∏M O
,
∏∏O P
string
∏∏Q W
[
∏∏W X
]
∏∏X Y
segmentsSelected
∏∏Z j
)
∏∏j k
{
ππ 	
try
∫∫ 
{
ªª 
Campaign
ºº 
campaign
ºº !
=
ºº" #
Db
ºº$ &
.
ºº& '
	Campaigns
ºº' 0
.
ºº0 1
Include
ºº1 8
(
ºº8 9
x
ºº9 :
=>
ºº; =
x
ºº> ?
.
ºº? @
Approved
ºº@ H
)
ººH I
.
ººI J
FirstOrDefault
ººJ X
(
ººX Y
x
ººY Z
=>
ºº[ ]
x
ºº^ _
.
ºº_ `
Id
ºº` b
==
ººc e
id
ººf h
)
ººh i
;
ººi j
if
ΩΩ 
(
ΩΩ 
campaign
ΩΩ 
==
ΩΩ 
null
ΩΩ  $
)
ΩΩ$ %
{
ææ 
throw
øø 
new
øø 
AdsException
øø *
(
øø* +
$str
øø+ ?
+
øø@ A
id
øøB D
+
øøE F
$str
øøG T
)
øøT U
;
øøU V
}
¿¿ 
if
¡¡ 
(
¡¡ 
campaign
¡¡ 
.
¡¡ 
Approved
¡¡ %
==
¡¡& (
null
¡¡) -
)
¡¡- .
{
¬¬ 
throw
√√ 
new
√√ 
AdsException
√√ *
(
√√* +
$str
√√+ 7
+
√√8 9
campaign
√√: B
.
√√B C
CampaignName
√√C O
+
√√P Q
$str
√√R i
)
√√i j
;
√√j k
}
ƒƒ 
switch
∆∆ 
(
∆∆ 
via
∆∆ 
)
∆∆ 
{
«« 
case
»» 
OrderVia
»» %
.
»»% &
Email
»»& +
:
»»+ ,
BackgroundJob
…… )
.
……) *
Enqueue
……* 1
(
……1 2
(
……2 3
)
……3 4
=>
……5 7
CampaignProcessor
……8 I
.
……I J
SendToVendor
……J V
(
……V W
via
……W Z
,
……Z [
vendorId
……\ d
,
……d e
campaign
……f n
.
……n o
OrderNumber
……o z
,
……z {
segmentsSelected……| å
,……å ç
string……é î
.……î ï
Empty……ï ö
)……ö õ
)……õ ú
;……ú ù
break
   
;
   
case
ÀÀ 
OrderVia
ÀÀ %
.
ÀÀ% &
Api
ÀÀ& )
:
ÀÀ) *
string
ÃÃ "

whiteLabel
ÃÃ# -
=
ÃÃ. /
string
ÃÃ0 6
.
ÃÃ6 7
IsNullOrEmpty
ÃÃ7 D
(
ÃÃD E
LoggedInUser
ÃÃE Q
?
ÃÃQ R
.
ÃÃR S

WhiteLabel
ÃÃS ]
)
ÃÃ] ^
?
ÃÃ_ `
$str
ÃÃa f
:
ÃÃg h
LoggedInUser
ÃÃi u
?
ÃÃu v
.
ÃÃv w

WhiteLabelÃÃw Å
;ÃÃÅ Ç
string
ÕÕ "
whiteLabelDomain
ÕÕ# 3
=
ÕÕ4 5
CustomersList
ÕÕ6 C
.
ÕÕC D
FirstOrDefault
ÕÕD R
(
ÕÕR S
x
ÕÕS T
=>
ÕÕU W
x
ÕÕX Y
.
ÕÕY Z
Value
ÕÕZ _
==
ÕÕ` b

whiteLabel
ÕÕc m
)
ÕÕm n
?
ÕÕn o
.
ÕÕo p
Text
ÕÕp t
.
ÕÕt u
Split
ÕÕu z
(
ÕÕz {
$str
ÕÕ{ ~
.
ÕÕ~ 
ToCharArrayÕÕ ä
(ÕÕä ã
)ÕÕã å
)ÕÕå ç
.ÕÕç é
LastOrDefaultÕÕé õ
(ÕÕõ ú
)ÕÕú ù
?ÕÕù û
.ÕÕû ü
TrimÕÕü £
(ÕÕ£ §
$strÕÕ§ ®
.ÕÕ® ©
ToCharArrayÕÕ© ¥
(ÕÕ¥ µ
)ÕÕµ ∂
)ÕÕ∂ ∑
;ÕÕ∑ ∏
CampaignProcessor
ŒŒ -
.
ŒŒ- .
SendToVendor
ŒŒ. :
(
ŒŒ: ;
via
ŒŒ; >
,
ŒŒ> ?
vendorId
ŒŒ@ H
,
ŒŒH I
campaign
ŒŒJ R
.
ŒŒR S
OrderNumber
ŒŒS ^
,
ŒŒ^ _
segmentsSelected
ŒŒ` p
,
ŒŒp q
whiteLabelDomainŒŒr Ç
)ŒŒÇ É
;ŒŒÉ Ñ
break
œœ 
;
œœ 
}
–– 
return
““ 
Json
““ 
(
““ 
new
““ 
JsonResponse
““  ,
(
““, -
)
““- .
{
““/ 0
IsSucess
““1 9
=
““: ;
true
““< @
}
““A B
,
““B C!
JsonRequestBehavior
““D W
.
““W X
AllowGet
““X `
)
““` a
;
““a b
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
return
÷÷ 
Json
÷÷ 
(
÷÷ 
new
÷÷ 
JsonResponse
÷÷  ,
(
÷÷, -
)
÷÷- .
{
÷÷/ 0
IsSucess
÷÷1 9
=
÷÷: ;
false
÷÷< A
,
÷÷A B
ErrorMessage
÷÷C O
=
÷÷P Q
ex
÷÷R T
.
÷÷T U
Message
÷÷U \
}
÷÷] ^
,
÷÷^ _!
JsonRequestBehavior
÷÷` s
.
÷÷s t
AllowGet
÷÷t |
)
÷÷| }
;
÷÷} ~
}
◊◊ 
}
ŸŸ 	
}
⁄⁄ 
}€€ †ß
ME:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\BaseController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
public 

class 
BaseController 
:  !

Controller" ,
{ 
	protected 
readonly 
Random !
Random" (
=) *
new+ .
Random/ 5
(5 6
)6 7
;7 8
	protected 
const 
int 
PageSize $
=% &
$num' )
;) *
private 
WfpictContext 
_db !
;! "
	protected 
WfpictContext 
Db  "
{ 	
get 
{ 
if 
( 
_db 
!= 
null 
)  
return! '
_db( +
;+ ,
_db 
= 
HttpContext !
.! "
GetOwinContext" 0
(0 1
)1 2
.2 3
Get3 6
<6 7
WfpictContext7 D
>D E
(E F
)F G
;G H
return 
_db 
; 
} 
private 
set 
{ 
_db 
= 
value 
; 
}   
}!! 	
public## 
void## 
SetupLoggedInUser## %
(##% &
string##& ,
userName##- 5
)##5 6
{$$ 	
var%% 
user%% 
=%% 
Db%% 
.%% 
Users%% 
.%%  
Include%%  '
(%%' (
u%%( )
=>%%* ,
u%%- .
.%%. /
Roles%%/ 4
)%%4 5
.%%5 6
FirstOrDefault%%6 D
(%%D E
x%%E F
=>%%G I
x%%J K
.%%K L
UserName%%L T
==%%U W
userName%%X `
)%%` a
;%%a b
Session&& 
[&& 
$str&& 
]&& 
=&& 
user&& "
;&&" #
}'' 	
	protected)) 
WfpUser)) 
LoggedInUser)) &
{** 	
get++ 
{,, 
return-- 
Session-- 
[-- 
$str-- %
]--% &
as--' )
WfpUser--* 1
;--1 2
}.. 
}// 	
	protected11 
bool11 
IsAdmin11 
{22 	
get33 
{44 
return55 
LoggedInUser55 #
!=55$ &
null55' +
&&55, .
(55/ 0
LoggedInUser550 <
.55< =
UserType55= E
==55F H
(55I J
int55J M
)55M N
UserType55N V
.55V W
Admin55W \
)55\ ]
;55] ^
}66 
}77 	
readonly99 
string99 
_uploadPath99 #
=99$ %
$"99& (
	~/Uploads99( 1
"991 2
;992 3
	protected:: 
string:: 

UploadPath:: #
{;; 	
get<< 
{== 
string>> 

uploadPath>> !
=>>" #
Server>>$ *
.>>* +
MapPath>>+ 2
(>>2 3
_uploadPath>>3 >
)>>> ?
;>>? @
if?? 
(?? 
!?? 
System?? 
.?? 
IO?? 
.?? 
	Directory?? (
.??( )
Exists??) /
(??/ 0

uploadPath??0 :
)??: ;
)??; <
System??= C
.??C D
IO??D F
.??F G
	Directory??G P
.??P Q
CreateDirectory??Q `
(??` a

uploadPath??a k
)??k l
;??l m
return@@ 

uploadPath@@ !
;@@! "
}AA 
}BB 	
readonlyDD 
stringDD 
_downloadPathDD %
=DD& '
$"DD( *
~/DownloadsDD* 5
"DD5 6
;DD6 7
	protectedEE 
stringEE 
DownloadPathEE %
{FF 	
getGG 
{HH 
stringII 
downloadPathII #
=II$ %
ServerII& ,
.II, -
MapPathII- 4
(II4 5
_downloadPathII5 B
)IIB C
;IIC D
ifJJ 
(JJ 
!JJ 
SystemJJ 
.JJ 
IOJJ 
.JJ 
	DirectoryJJ (
.JJ( )
ExistsJJ) /
(JJ/ 0
downloadPathJJ0 <
)JJ< =
)JJ= >
SystemJJ? E
.JJE F
IOJJF H
.JJH I
	DirectoryJJI R
.JJR S
CreateDirectoryJJS b
(JJb c
downloadPathJJc o
)JJo p
;JJp q
returnKK 
downloadPathKK #
;KK# $
}LL 
}MM 	
readonlyOO 
stringOO 
_imagesPathOO #
=OO$ %
$"OO& (
~/imagesOO( 0
"OO0 1
;OO1 2
	protectedPP 
stringPP 

ImagesPathPP #
{QQ 	
getRR 
{SS 
returnTT 
ServerTT 
.TT 
MapPathTT %
(TT% &
_imagesPathTT& 1
)TT1 2
;TT2 3
}UU 
}VV 	
	protectedXX 

SelectListXX 

StatusListXX '
{YY 	
getZZ 
{[[ 
var\\ 
items\\ 
=\\ 

EnumHelper\\ &
.\\& '
GetEnumTextValues\\' 8
(\\8 9
typeof\\9 ?
(\\? @
CampaignStatus\\@ N
)\\N O
)\\O P
.]] 
Select]] 
(]] 
x]] 
=>]]  
new]]! $
SelectListItem]]% 3
(]]3 4
)]]4 5
{^^ 
Text__ 
=__ 
x__  
.__  !
Text__! %
,__% &
Value`` 
=`` 
x``  !
.``! "
Value``" '
}aa 
)aa 
.aa 
ToListaa 
(aa 
)aa 
;aa  
itemsbb 
.bb 
Insertbb 
(bb 
$numbb 
,bb 
newbb  #
SelectListItembb$ 2
(bb2 3
)bb3 4
{cc 
Textdd 
=dd 
$strdd *
,dd* +
Valueee 
=ee 
stringee "
.ee" #
Emptyee# (
}ff 
)ff 
;ff 
returngg 
newgg 

SelectListgg %
(gg% &
itemsgg& +
,gg+ ,
$strgg- 4
,gg4 5
$strgg6 <
)gg< =
;gg= >
}hh 
}ii 	
	protectedkk 
IEnumerablekk 
<kk 
SelectListItemkk ,
>kk, -
ReportTemplateskk. =
{ll 	
getmm 
{nn 
varoo 
itemsoo 
=oo 

EnumHelperoo &
.oo& '
GetEnumTextValuesoo' 8
(oo8 9
typeofoo9 ?
(oo? @
ReportTemplateoo@ N
)ooN O
)ooO P
.pp 
Selectpp 
(pp 
xpp 
=>pp  
newpp! $
SelectListItempp% 3
(pp3 4
)pp4 5
{qq 
Textrr 
=rr 
xrr  
.rr  !
Textrr! %
,rr% &
Valuess 
=ss 
xss  !
.ss! "
Valuess" '
}tt 
)tt 
.tt 
ToListtt 
(tt 
)tt 
;tt  
itemsuu 
.uu 
Insertuu 
(uu 
$numuu 
,uu 
newuu  #
SelectListItemuu$ 2
(uu2 3
)uu3 4
{vv 
Textww 
=ww 
$strww ,
,ww, -
Valuexx 
=xx 
stringxx "
.xx" #
Emptyxx# (
}yy 
)yy 
;yy 
returnzz 
itemszz 
;zz 
}{{ 
}|| 	
public~~ 
IEnumerable~~ 
<~~ 
SelectListItem~~ )
>~~) *

MonthsList~~+ 5
{ 	
get
ÄÄ 
{
ÅÅ 
var
ÇÇ 
months
ÇÇ 
=
ÇÇ 
new
ÇÇ  
List
ÇÇ! %
<
ÇÇ% &
SelectListItem
ÇÇ& 4
>
ÇÇ4 5
(
ÇÇ5 6
)
ÇÇ6 7
;
ÇÇ7 8
for
ÉÉ 
(
ÉÉ 
int
ÉÉ 
i
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
i
ÉÉ  !
<
ÉÉ" #
$num
ÉÉ$ &
;
ÉÉ& '
i
ÉÉ( )
++
ÉÉ) +
)
ÉÉ+ ,
{
ÑÑ 
months
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
SelectListItem
ÖÖ# 1
(
ÖÖ1 2
)
ÖÖ2 3
{
ÜÜ 
Text
áá 
=
áá 
CultureInfo
áá *
.
áá* +
CurrentCulture
áá+ 9
.
áá9 :
DateTimeFormat
áá: H
.
ááH I
GetMonthName
ááI U
(
ááU V
i
ááV W
+
ááX Y
$num
ááZ [
)
áá[ \
,
áá\ ]
Value
àà 
=
àà 
i
àà  !
.
àà! "
ToString
àà" *
(
àà* +
)
àà+ ,
}
ââ 
)
ââ 
;
ââ 
}
ää 
months
ãã 
.
ãã 
Insert
ãã 
(
ãã 
$num
ãã 
,
ãã  
new
ãã! $
SelectListItem
ãã% 3
(
ãã3 4
)
ãã4 5
{
åå 
Text
çç 
=
çç 
$str
çç )
,
çç) *
Value
éé 
=
éé 
string
éé "
.
éé" #
Empty
éé# (
}
èè 
)
èè 
;
èè 
return
êê 
months
êê 
;
êê 
}
ëë 
}
íí 	
private
îî 
static
îî 
List
îî 
<
îî 
SelectListItem
îî *
>
îî* +
_users
îî, 2
;
îî2 3
	protected
ïï 
IEnumerable
ïï 
<
ïï 
SelectListItem
ïï ,
>
ïï, -
	UsersList
ïï. 7
{
ññ 	
get
óó 
{
òò 
if
ôô 
(
ôô 
_users
ôô 
==
ôô 
null
ôô "
)
ôô" #
{
öö 
var
õõ 
user
õõ 
=
õõ 
Session
õõ &
[
õõ& '
$str
õõ' -
]
õõ- .
as
õõ/ 1
WfpUser
õõ2 9
;
õõ9 :
_users
úú 
=
úú 
Db
úú 
.
úú  
Users
úú  %
.
ùù 
OrderBy
ùù  
(
ùù  !
x
ùù! "
=>
ùù# %
x
ùù& '
.
ùù' (
	CreatedAt
ùù( 1
)
ùù1 2
.
ùù2 3
Select
ùù3 9
(
ùù9 :
x
ûû 
=>
ûû !
new
ûû" %
SelectListItem
ûû& 4
(
ûû4 5
)
ûû5 6
{
üü 
Text
††! %
=
††& '
x
††( )
.
††) *
UserName
††* 2
,
††2 3
Value
°°! &
=
°°' (
x
°°) *
.
°°* +
UserName
°°+ 3
}
¢¢ 
)
¢¢ 
.
¢¢  
ToList
¢¢  &
(
¢¢& '
)
¢¢' (
;
¢¢( )
_users
££ 
.
££ 
Insert
££ !
(
££! "
$num
££" #
,
££# $
new
££% (
SelectListItem
££) 7
(
££7 8
)
££8 9
{
§§ 
Text
•• 
=
•• 
$str
•• ,
,
••, -
Value
¶¶ 
=
¶¶ 
string
¶¶  &
.
¶¶& '
Empty
¶¶' ,
}
ßß 
)
ßß 
;
ßß 
}
®® 
return
©© 
_users
©© 
;
©© 
}
™™ 
}
´´ 	
private
≠≠ 
static
≠≠ 
bool
≠≠ 
_forceOrders
≠≠ (
;
≠≠( )
public
ØØ 
static
ØØ 
bool
ØØ 
ForceOrders
ØØ &
{
∞∞ 	
get
±± 
{
±± 
return
±± 
_forceOrders
±± %
;
±±% &
}
±±' (
set
≤≤ 
{
≤≤ 
_forceOrders
≤≤ 
=
≤≤  
value
≤≤! &
;
≤≤& '
}
≤≤( )
}
≥≥ 	
private
¥¥ 
List
¥¥ 
<
¥¥ 
SelectListItem
¥¥ #
>
¥¥# $
_orderNumbers
¥¥% 2
;
¥¥2 3
public
µµ 
IEnumerable
µµ 
<
µµ 
SelectListItem
µµ )
>
µµ) *
OrderNumberList
µµ+ :
{
∂∂ 	
get
∑∑ 
{
∏∏ 
if
ππ 
(
ππ 
_orderNumbers
ππ !
==
ππ" $
null
ππ% )
||
ππ* ,
_forceOrders
ππ- 9
)
ππ9 :
{
∫∫ 
_orderNumbers
ªª !
=
ªª" #
Db
ªª$ &
.
ªª& '
	Campaigns
ªª' 0
.
ºº 
OrderBy
ºº  
(
ºº  !
x
ºº! "
=>
ºº# %
x
ºº& '
.
ºº' (
	CreatedAt
ºº( 1
)
ºº1 2
.
ºº2 3
Select
ºº3 9
(
ºº9 :
x
ΩΩ 
=>
ΩΩ !
new
ΩΩ" %
SelectListItem
ΩΩ& 4
(
ΩΩ4 5
)
ΩΩ5 6
{
ææ 
Text
øø! %
=
øø& '
x
øø( )
.
øø) *
OrderNumber
øø* 5
,
øø5 6
Value
¿¿! &
=
¿¿' (
x
¿¿) *
.
¿¿* +
Id
¿¿+ -
.
¿¿- .
ToString
¿¿. 6
(
¿¿6 7
)
¿¿7 8
}
¡¡ 
)
¡¡ 
.
¡¡  
ToList
¡¡  &
(
¡¡& '
)
¡¡' (
;
¡¡( )
_orderNumbers
¬¬ !
.
¬¬! "
Insert
¬¬" (
(
¬¬( )
$num
¬¬) *
,
¬¬* +
new
¬¬, /
SelectListItem
¬¬0 >
(
¬¬> ?
)
¬¬? @
{
√√ 
Text
ƒƒ 
=
ƒƒ 
$str
ƒƒ /
,
ƒƒ/ 0
Value
≈≈ 
=
≈≈ 
string
≈≈  &
.
≈≈& '
Empty
≈≈' ,
}
∆∆ 
)
∆∆ 
;
∆∆ 
}
«« 
return
»» 
_orderNumbers
»» $
;
»»$ %
}
…… 
}
   	
private
ÃÃ 
static
ÃÃ 
bool
ÃÃ 
_forceVendors
ÃÃ )
;
ÃÃ) *
	protected
ÕÕ 
static
ÕÕ 
bool
ÕÕ 
ForceVendors
ÕÕ *
{
ŒŒ 	
get
œœ 
{
œœ 
return
œœ 
_forceVendors
œœ &
;
œœ& '
}
œœ( )
set
–– 
{
–– 
_forceVendors
–– 
=
––  !
value
––" '
;
––' (
}
––) *
}
—— 	
private
”” 
List
”” 
<
”” 
SelectListItem
”” #
>
””# $
_vendors
””% -
;
””- .
	protected
‘‘ 
IEnumerable
‘‘ 
<
‘‘ 
SelectListItem
‘‘ ,
>
‘‘, -
VendorsList
‘‘. 9
{
’’ 	
get
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
_vendors
ÿÿ 
==
ÿÿ 
null
ÿÿ  $
||
ÿÿ% '
_forceVendors
ÿÿ( 5
)
ÿÿ5 6
{
ŸŸ 
_vendors
⁄⁄ 
=
⁄⁄ 
Db
⁄⁄ !
.
⁄⁄! "
Vendors
⁄⁄" )
.
€€ 
OrderBy
€€  
(
€€  !
x
€€! "
=>
€€# %
x
€€& '
.
€€' (
	CreatedAt
€€( 1
)
€€1 2
.
€€2 3
Select
€€3 9
(
€€9 :
x
‹‹ 
=>
‹‹ !
new
‹‹" %
SelectListItem
‹‹& 4
(
‹‹4 5
)
‹‹5 6
{
›› 
Text
ﬁﬁ! %
=
ﬁﬁ& '
x
ﬁﬁ( )
.
ﬁﬁ) *
Name
ﬁﬁ* .
,
ﬁﬁ. /
Value
ﬂﬂ! &
=
ﬂﬂ' (
x
ﬂﬂ) *
.
ﬂﬂ* +
Id
ﬂﬂ+ -
.
ﬂﬂ- .
ToString
ﬂﬂ. 6
(
ﬂﬂ6 7
)
ﬂﬂ7 8
}
‡‡ 
)
‡‡ 
.
‡‡  
ToList
‡‡  &
(
‡‡& '
)
‡‡' (
;
‡‡( )
_vendors
·· 
.
·· 
Insert
·· #
(
··# $
$num
··$ %
,
··% &
new
··' *
SelectListItem
··+ 9
(
··9 :
)
··: ;
{
‚‚ 
Text
„„ 
=
„„ 
$str
„„ .
,
„„. /
Value
‰‰ 
=
‰‰ 
string
‰‰  &
.
‰‰& '
Empty
‰‰' ,
}
ÂÂ 
)
ÂÂ 
;
ÂÂ 
}
ÊÊ 
return
ÁÁ 
_vendors
ÁÁ 
;
ÁÁ  
}
ËË 
}
ÈÈ 	
private
ÎÎ 
static
ÎÎ 
bool
ÎÎ 
_forceCustomers
ÎÎ +
;
ÎÎ+ ,
	protected
ÏÏ 
static
ÏÏ 
bool
ÏÏ 
ForceCustomers
ÏÏ ,
{
ÌÌ 	
get
ÓÓ 
{
ÓÓ 
return
ÓÓ 
_forceCustomers
ÓÓ (
;
ÓÓ( )
}
ÓÓ* +
set
ÔÔ 
{
ÔÔ 
_forceCustomers
ÔÔ !
=
ÔÔ" #
value
ÔÔ$ )
;
ÔÔ) *
}
ÔÔ+ ,
}
 	
private
ÚÚ 
List
ÚÚ 
<
ÚÚ 
SelectListItem
ÚÚ #
>
ÚÚ# $

_customers
ÚÚ% /
;
ÚÚ/ 0
	protected
ÛÛ 
IEnumerable
ÛÛ 
<
ÛÛ 
SelectListItem
ÛÛ ,
>
ÛÛ, -
CustomersList
ÛÛ. ;
{
ÙÙ 	
get
ıı 
{
ˆˆ 
if
˜˜ 
(
˜˜ 

_customers
˜˜ 
==
˜˜ !
null
˜˜" &
||
˜˜' )
_forceCustomers
˜˜* 9
)
˜˜9 :
{
¯¯ 

_customers
˘˘ 
=
˘˘  
Db
˘˘! #
.
˘˘# $
	Customers
˘˘$ -
.
˙˙ 
OrderBy
˙˙  
(
˙˙  !
x
˙˙! "
=>
˙˙# %
x
˙˙& '
.
˙˙' (
	CreatedAt
˙˙( 1
)
˙˙1 2
.
˙˙2 3
Select
˙˙3 9
(
˙˙9 :
x
˚˚ 
=>
˚˚ !
new
˚˚" %
SelectListItem
˚˚& 4
(
˚˚4 5
)
˚˚5 6
{
¸¸ 
Text
˝˝! %
=
˝˝& '
x
˝˝( )
.
˝˝) *
Name
˝˝* .
+
˝˝/ 0
$str
˝˝1 5
+
˝˝6 7
x
˝˝8 9
.
˝˝9 :
	WebDomain
˝˝: C
+
˝˝D E
$str
˝˝F I
,
˝˝I J
Value
˛˛! &
=
˛˛' (
x
˛˛) *
.
˛˛* +
Code
˛˛+ /
}
ˇˇ 
)
ˇˇ 
.
ˇˇ  
ToList
ˇˇ  &
(
ˇˇ& '
)
ˇˇ' (
;
ˇˇ( )

_customers
ÄÄ 
.
ÄÄ 
Insert
ÄÄ %
(
ÄÄ% &
$num
ÄÄ& '
,
ÄÄ' (
new
ÄÄ) ,
SelectListItem
ÄÄ- ;
(
ÄÄ; <
)
ÄÄ< =
{
ÅÅ 
Text
ÇÇ 
=
ÇÇ 
$str
ÇÇ 0
,
ÇÇ0 1
Value
ÉÉ 
=
ÉÉ 
string
ÉÉ  &
.
ÉÉ& '
Empty
ÉÉ' ,
}
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
return
ÜÜ 

_customers
ÜÜ !
;
ÜÜ! "
}
áá 
}
àà 	
private
ää 
List
ää 
<
ää 
SelectListItem
ää #
>
ää# $
_claimTypes
ää% 0
;
ää0 1
public
ãã 
IEnumerable
ãã 
<
ãã 
SelectListItem
ãã )
>
ãã) *

ClaimTypes
ãã+ 5
{
åå 	
get
çç 
{
éé 
if
èè 
(
èè 
_claimTypes
èè 
==
èè  "
null
èè# '
)
èè' (
{
êê 
var
ëë 
mgr
ëë 
=
ëë 
new
ëë !!
AspNetClaimsManager
ëë" 5
(
ëë5 6
)
ëë6 7
;
ëë7 8
_claimTypes
íí 
=
íí  !
mgr
íí" %
.
íí% &
GetAll
íí& ,
(
íí, -
)
íí- .
.
íí. /
Select
íí/ 5
(
íí5 6
x
ìì 
=>
ìì 
new
ìì 
SelectListItem
ìì +
(
ìì+ ,
)
ìì, -
{
îî 
Text
ïï 
=
ïï 
x
ïï  
.
ïï  !
	ClaimType
ïï! *
,
ïï* +
Value
ññ 
=
ññ 
x
ññ  !
.
ññ! "
	ClaimType
ññ" +
}
óó 
)
óó 
.
óó 
Distinct
óó 
(
óó  
)
óó  !
.
óó! "
ToList
óó" (
(
óó( )
)
óó) *
;
óó* +
_claimTypes
òò 
.
òò  
Insert
òò  &
(
òò& '
$num
òò' (
,
òò( )
new
òò* -
SelectListItem
òò. <
(
òò< =
)
òò= >
{
ôô 
Text
öö 
=
öö 
$str
öö 0
,
öö0 1
Value
õõ 
=
õõ 
string
õõ  &
.
õõ& '
Empty
õõ' ,
}
úú 
)
úú 
;
úú 
}
ùù 
return
ûû 
_claimTypes
ûû "
;
ûû" #
}
üü 
}
†† 	
}
¢¢ 
}££ Ò6
UE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\NotificationController.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
.		 
Controllers		 '
{

 
[ 
	Authorize 
] 
public 

class "
NotificationController '
:( )
BaseController* 8
{ 
public 
ActionResult 
Index !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
var 
notifications 
= 
Db  "
." #
Notifications# 0
.0 1
Where1 6
(6 7
x7 8
=>9 ;
x< =
.= >
Status> D
==E G
(H I
intI L
)L M
NotificationStatusM _
._ `
Found` e
)e f
.f g
ToListg m
(m n
)n o
;o p
int 

pageNumber 
= 
( 
sc  
.  !
Page! %
??& (
$num) *
)* +
;+ ,
return 
View 
( 
notifications %
.% &
ToPagedList& 1
(1 2

pageNumber2 <
,< =
PageSize> F
)F G
)G H
;H I
} 	
public 
ActionResult 
Settings $
($ %
)% &
{ 	

SettingsVm 
sc 
= 
new 

SettingsVm  *
(* +
)+ ,
;, -
var 
settingAuto 
= 
Db  
.  !
Settings! )
.) *
FirstOrDefault* 8
(8 9
x9 :
=>; =
x> ?
.? @
Key@ C
==D F
StringConstantsG V
.V W"
KeyAutoProcessTrackingW m
)m n
;n o
if 
( 
settingAuto 
!= 
null #
)# $
sc% '
.' (!
IsAutoProcessTracking( =
=> ?
int@ C
.C D
ParseD I
(I J
settingAutoJ U
.U V
ValueV [
)[ \
==] _
$num` a
;a b
var $
settingSendNotifications (
=) *
Db+ -
.- .
Settings. 6
.6 7
FirstOrDefault7 E
(E F
xF G
=>H J
xK L
.L M
KeyM P
==Q S
StringConstantsT c
.c d%
KeySendNotificationEmailsd }
)} ~
;~ 
if 
( $
settingSendNotifications (
!=) +
null, 0
)0 1
sc2 4
.4 5$
IsSendNotificationEmails5 M
=N O
intP S
.S T
ParseT Y
(Y Z$
settingSendNotificationsZ r
.r s
Values x
)x y
==z |
$num} ~
;~ 
return 
View 
( 
sc 
) 
; 
}   	
["" 	
HttpPost""	 
]"" 
public## 
ActionResult## 
Settings## $
(##$ %

SettingsVm##% /
sc##0 2
)##2 3
{$$ 	
var%% 
settingAuto%% 
=%% 
Db%%  
.%%  !
Settings%%! )
.%%) *
FirstOrDefault%%* 8
(%%8 9
x%%9 :
=>%%; =
x%%> ?
.%%? @
Key%%@ C
==%%D F
StringConstants%%G V
.%%V W"
KeyAutoProcessTracking%%W m
)%%m n
;%%n o
if&& 
(&& 
settingAuto&& 
==&& 
null&& #
)&&# $
{'' 
Db(( 
.(( 
Settings(( 
.(( 
Add(( 
(((  
new((  #
Settings(($ ,
{)) 
Id** 
=** 
Guid** 
.** 
NewGuid** %
(**% &
)**& '
,**' (
	CreatedAt++ 
=++ 
DateTime++  (
.++( )
Now++) ,
,++, -
Key,, 
=,, 
StringConstants,, )
.,,) *"
KeyAutoProcessTracking,,* @
,,,@ A
Value-- 
=-- 
sc-- 
.-- !
IsAutoProcessTracking-- 4
?--5 6
$str--7 :
:--; <
$str--= @
}.. 
).. 
;.. 
}// 
else00 
{11 
settingAuto22 
.22 
Value22 !
=22" #
sc22$ &
.22& '!
IsAutoProcessTracking22' <
?22= >
$str22? B
:22C D
$str22E H
;22H I
}33 
var44 $
settingSendNotifications44 (
=44) *
Db44+ -
.44- .
Settings44. 6
.446 7
FirstOrDefault447 E
(44E F
x44F G
=>44H J
x44K L
.44L M
Key44M P
==44Q S
StringConstants44T c
.44c d%
KeySendNotificationEmails44d }
)44} ~
;44~ 
if55 
(55 $
settingSendNotifications55 (
==55) +
null55, 0
)550 1
{66 
Db77 
.77 
Settings77 
.77 
Add77 
(77  
new77  #
Settings77$ ,
{88 
Id99 
=99 
Guid99 
.99 
NewGuid99 %
(99% &
)99& '
,99' (
	CreatedAt:: 
=:: 
DateTime::  (
.::( )
Now::) ,
,::, -
Key;; 
=;; 
StringConstants;; )
.;;) *%
KeySendNotificationEmails;;* C
,;;C D
Value<< 
=<< 
sc<< 
.<< $
IsSendNotificationEmails<< 7
?<<8 9
$str<<: =
:<<> ?
$str<<@ C
}== 
)== 
;== 
}>> 
else?? 
{@@ $
settingSendNotificationsAA (
.AA( )
ValueAA) .
=AA/ 0
scAA1 3
.AA3 4$
IsSendNotificationEmailsAA4 L
?AAM N
$strAAO R
:AAS T
$strAAU X
;AAX Y
}BB 
DbCC 
.CC 
SaveChangesCC 
(CC 
)CC 
;CC 
TempDataDD 
[DD 
$strDD 
]DD 
=DD  !
$strDD" U
;DDU V
returnEE 
RedirectToActionEE #
(EE# $
$strEE$ .
)EE. /
;EE/ 0
}FF 	
}
⁄⁄ 
}€€ ¢Â
OE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\StatusController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
StatusController !
:" #
BaseController$ 2
{ 
public 
ActionResult 
Index !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
sc& (
.( )
ClearSessionId) 7
)7 8
)8 9
{ 
Session 
[ 
$str 
] 
= 
null  $
;$ %
sc 
. 
BasicString 
=  
string! '
.' (
Empty( -
;- .
} 
ViewBag 
. 
CurrentSort 
=  !
sc" $
.$ %
	SortOrder% .
;. /
ViewBag 
.  
CampaignNameSortParm (
=) *
sc+ -
.- .
	SortOrder. 7
==8 :
$str; I
?J K
$strL _
:` a
$strb p
;p q
ViewBag 
. !
BroadcastDateSortParm )
=* +
sc, .
.. /
	SortOrder/ 8
==9 ;
$str< K
?L M
$strN b
:c d
$stre t
;t u
ViewBag 
. 
CreatedBySortParm %
=& '
sc( *
.* +
	SortOrder+ 4
==5 7
$str8 C
?D E
$strF V
:W X
$strY d
;d e
ViewBag 
. 
StatusSortParm "
=# $
sc% '
.' (
	SortOrder( 1
==2 4
$str5 =
?> ?
$str@ M
:N O
$strP X
;X Y
ViewBag 
. 
OrderNumberSortParm '
=( )
sc* ,
., -
	SortOrder- 6
==7 9
$str: G
?H I
$strJ \
:] ^
$str_ l
;l m
var!! 
	campagins!! 
=!! 
Db!! 
.!! 
	Campaigns!! (
."" 
Include"" 
("" 
x"" 
=>"" 
x"" 
.""  
Testing""  '
)""' (
.## 
Include## 
(## 
x## 
=>## 
x## 
.##  
Approved##  (
)##( )
.$$ 
Include$$ 
($$ 
x$$ 
=>$$ 
x$$ 
.$$  
	Trackings$$  )
)$$) *
.%% 
ToList%% 
(%% 
)%% 
;%% 
switch'' 
('' 
sc'' 
.'' 
	SortOrder''  
)''  !
{(( 
case)) 
$str)) #
:))# $
	campagins** 
=** 
	campagins**  )
.**) *
OrderBy*** 1
(**1 2
s**2 3
=>**4 6
s**7 8
.**8 9
CampaignName**9 E
)**E F
.**F G
ToList**G M
(**M N
)**N O
;**O P
break++ 
;++ 
case,, 
$str,, (
:,,( )
	campagins-- 
=-- 
	campagins--  )
.--) *
OrderByDescending--* ;
(--; <
s--< =
=>--> @
s--A B
.--B C
CampaignName--C O
)--O P
.--P Q
ToList--Q W
(--W X
)--X Y
;--Y Z
break.. 
;.. 
case// 
$str// $
://$ %
	campagins00 
=00 
	campagins00  )
.00) *
OrderBy00* 1
(001 2
s002 3
=>004 6
s007 8
.008 9
BroadcastDate009 F
)00F G
.00G H
ToList00H N
(00N O
)00O P
;00P Q
break11 
;11 
case22 
$str22 )
:22) *
	campagins33 
=33 
	campagins33  )
.33) *
OrderByDescending33* ;
(33; <
s33< =
=>33> @
s33A B
.33B C
BroadcastDate33C P
)33P Q
.33Q R
ToList33R X
(33X Y
)33Y Z
;33Z [
break44 
;44 
case55 
$str55  
:55  !
	campagins66 
=66 
	campagins66  )
.66) *
OrderBy66* 1
(661 2
s662 3
=>664 6
s667 8
.668 9
	CreatedBy669 B
)66B C
.66C D
ToList66D J
(66J K
)66K L
;66L M
break77 
;77 
case88 
$str88 %
:88% &
	campagins99 
=99 
	campagins99  )
.99) *
OrderByDescending99* ;
(99; <
s99< =
=>99> @
s99A B
.99B C
	CreatedBy99C L
)99L M
.99M N
ToList99N T
(99T U
)99U V
;99V W
break:: 
;:: 
case;; 
$str;; 
:;; 
	campagins<< 
=<< 
	campagins<<  )
.<<) *
OrderBy<<* 1
(<<1 2
s<<2 3
=><<4 6
s<<7 8
.<<8 9
Status<<9 ?
)<<? @
.<<@ A
ToList<<A G
(<<G H
)<<H I
;<<I J
break== 
;== 
case>> 
$str>> "
:>>" #
	campagins?? 
=?? 
	campagins??  )
.??) *
OrderByDescending??* ;
(??; <
s??< =
=>??> @
s??A B
.??B C
Status??C I
)??I J
.??J K
ToList??K Q
(??Q R
)??R S
;??S T
break@@ 
;@@ 
caseAA 
$strAA "
:AA" #
	campaginsBB 
=BB 
	campaginsBB  )
.BB) *
OrderByBB* 1
(BB1 2
sBB2 3
=>BB4 6
sBB7 8
.BB8 9
OrderNumberBB9 D
)BBD E
.BBE F
ToListBBF L
(BBL M
)BBM N
;BBN O
breakCC 
;CC 
caseDD 
$strDD '
:DD' (
	campaginsEE 
=EE 
	campaginsEE  )
.EE) *
OrderByDescendingEE* ;
(EE; <
sEE< =
=>EE> @
sEEA B
.EEB C
OrderNumberEEC N
)EEN O
.EEO P
ToListEEP V
(EEV W
)EEW X
;EEX Y
breakFF 
;FF 
defaultGG 
:GG 
	campaginsHH 
=HH 
	campaginsHH  )
.HH) *
OrderByDescendingHH* ;
(HH; <
sHH< =
=>HH> @
sHHA B
.HHB C
	CreatedAtHHC L
)HHL M
.HHM N
ToListHHN T
(HHT U
)HHU V
;HHV W
breakII 
;II 
}JJ 
ViewBagLL 
.LL 

SearchTypeLL 
=LL  
scLL! #
.LL# $

SearchTypeLL$ .
;LL. /
ifMM 
(MM 
scMM 
.MM 

SearchTypeMM 
==MM  
$strMM! (
)MM( )
{NN 
ifOO 
(OO 
!OO 
stringOO 
.OO 
IsNullOrEmptyOO )
(OO) *
scOO* ,
.OO, -
BasicStringOO- 8
)OO8 9
)OO9 :
{PP 
	campaginsQQ 
=QQ 
	campaginsQQ  )
.QQ) *
WhereQQ* /
(QQ/ 0
sQQ0 1
=>QQ2 4
sRR 
.RR 
OrderNumberRR !
.RR! "
EqualsRR" (
(RR( )
scRR) +
.RR+ ,
BasicStringRR, 7
)RR7 8
||RR9 ;
sSS 
.SS $
ReBroadcastedOrderNumberSS .
==SS/ 1
scSS2 4
.SS4 5
BasicStringSS5 @
||SSA C
sTT 
.TT 
CampaignNameTT "
.TT" #
IndexOfTT# *
(TT* +
scTT+ -
.TT- .
BasicStringTT. 9
,TT9 :
StringComparisonTT; K
.TTK L&
InvariantCultureIgnoreCaseTTL f
)TTf g
>=TTh j
$numTTk l
)TTl m
.TTm n
ToListTTn t
(TTt u
)TTu v
;TTv w
ViewBagUU 
.UU 
BasicStringSearchedUU /
=UU0 1
scUU2 4
.UU4 5
BasicStringUU5 @
;UU@ A
}VV 
elseWW 
ifWW 
(WW 
!WW 
stringWW  
.WW  !
IsNullOrEmptyWW! .
(WW. /
scWW/ 1
.WW1 2
BasicStatusWW2 =
)WW= >
)WW> ?
{XX 
intYY 
statusYY 
=YY  
intYY! $
.YY$ %
ParseYY% *
(YY* +
scYY+ -
.YY- .
BasicStatusYY. 9
)YY9 :
;YY: ;
ifZZ 
(ZZ 
statusZZ 
==ZZ !
(ZZ" #
intZZ# &
)ZZ& '
CampaignStatusZZ' 5
.ZZ5 6
RebroadcastedZZ6 C
)ZZC D
	campagins[[ !
=[[" #
	campagins[[$ -
.[[- .
Where[[. 3
([[3 4
s[[4 5
=>[[6 8
s[[9 :
.[[: ;
ReBroadcasted[[; H
)[[H I
.[[I J
ToList[[J P
([[P Q
)[[Q R
;[[R S
else\\ 
if\\ 
(\\ 
status\\ #
==\\$ &
(\\' (
int\\( +
)\\+ ,
CampaignStatus\\, :
.\\: ;
NotRebroadcasted\\; K
)\\K L
	campagins]] !
=]]" #
	campagins]]$ -
.]]- .
Where]]. 3
(]]3 4
s]]4 5
=>]]6 8
s]]9 :
.]]: ;
ReBroadCast]]; F
&&]]G I
!]]J K
s]]K L
.]]L M
ReBroadcasted]]M Z
)]]Z [
.]][ \
ToList]]\ b
(]]b c
)]]c d
;]]d e
else^^ 
	campagins__ !
=__" #
	campagins__$ -
.__- .
Where__. 3
(__3 4
s__4 5
=>__6 8
s__9 :
.__: ;
Status__; A
==__B D
status__E K
)__K L
.__L M
ToList__M S
(__S T
)__T U
;__U V
ViewBag`` 
.`` 
BasicStatusSearched`` /
=``0 1
sc``2 4
.``4 5
BasicStatus``5 @
;``@ A
}aa 
elsebb 
ifbb 
(bb 
!bb 
stringbb  
.bb  !
IsNullOrEmptybb! .
(bb. /
scbb/ 1
.bb1 2
BasicOrderNumberbb2 B
)bbB C
)bbC D
{cc 
	campaginsdd 
=dd 
	campaginsdd  )
.dd) *
Wheredd* /
(dd/ 0
sdd0 1
=>dd2 4
sdd5 6
.dd6 7
Iddd7 9
.dd9 :
ToStringdd: B
(ddB C
)ddC D
.ddD E
EqualsddE K
(ddK L
scddL N
.ddN O
BasicOrderNumberddO _
)dd_ `
)dd` a
.dda b
ToListddb h
(ddh i
)ddi j
;ddj k
}ee 
}ff 
elsegg 
ifgg 
(gg 
scgg 
.gg 

SearchTypegg "
==gg# %
$strgg& 0
)gg0 1
{hh 
ifii 
(ii 
!ii 
stringii 
.ii 
IsNullOrEmptyii )
(ii) *
scii* ,
.ii, -
AdvancedStatusii- ;
)ii; <
)ii< =
{jj 
intkk 
statuskk 
=kk  
intkk! $
.kk$ %
Parsekk% *
(kk* +
sckk+ -
.kk- .
AdvancedStatuskk. <
)kk< =
;kk= >
ifll 
(ll 
statusll 
==ll !
(ll" #
intll# &
)ll& '
CampaignStatusll' 5
.ll5 6
Rebroadcastedll6 C
)llC D
	campaginsmm !
=mm" #
	campaginsmm$ -
.mm- .
Wheremm. 3
(mm3 4
smm4 5
=>mm6 8
smm9 :
.mm: ;
OrderNumbermm; F
.mmF G
EndsWithmmG O
(mmO P
$strmmP U
)mmU V
)mmV W
.mmW X
ToListmmX ^
(mm^ _
)mm_ `
;mm` a
elsenn 
	campaginsoo !
=oo" #
	campaginsoo$ -
.oo- .
Whereoo. 3
(oo3 4
soo4 5
=>oo6 8
soo9 :
.oo: ;
Statusoo; A
==ooB D
statusooE K
)ooK L
.ooL M
ToListooM S
(ooS T
)ooT U
;ooU V
ViewBagpp 
.pp "
AdvancedStatusSearchedpp 2
=pp3 4
scpp5 7
.pp7 8
AdvancedStatuspp8 F
;ppF G
}qq 
ifrr 
(rr 
!rr 
stringrr 
.rr 
IsNullOrEmptyrr )
(rr) *
scrr* ,
.rr, -
AdvancedUserrr- 9
)rr9 :
)rr: ;
{ss 
	campaginstt 
=tt 
	campaginstt  )
.tt) *
Wherett* /
(tt/ 0
stt0 1
=>tt2 4
stt5 6
.tt6 7
	CreatedBytt7 @
==ttA C
scttD F
.ttF G
AdvancedUserttG S
)ttS T
.ttT U
ToListttU [
(tt[ \
)tt\ ]
;tt] ^
ViewBaguu 
.uu  
AdvancedUserSearcheduu 0
=uu1 2
scuu3 5
.uu5 6
AdvancedUseruu6 B
;uuB C
}vv 
ifxx 
(xx 
!xx 
stringxx 
.xx 
IsNullOrEmptyxx )
(xx) *
scxx* ,
.xx, -
CampaignNamexx- 9
)xx9 :
)xx: ;
{yy 
sczz 
.zz 
CampaignNamezz #
=zz$ %
sczz& (
.zz( )
CampaignNamezz) 5
.zz5 6
ToLowerInvariantzz6 F
(zzF G
)zzG H
;zzH I
	campagins{{ 
={{ 
	campagins{{  )
.{{) *
Where{{* /
({{/ 0
s{{0 1
=>{{2 4
s{{5 6
.{{6 7
CampaignName{{7 C
.{{C D
IndexOf{{D K
({{K L
sc{{L N
.{{N O
CampaignName{{O [
,{{[ \
StringComparison{{] m
.{{m n%
CurrentCultureIgnoreCase	{{n Ü
)
{{Ü á
>=
{{à ä
$num
{{ã å
)
{{å ç
.
{{ç é
ToList
{{é î
(
{{î ï
)
{{ï ñ
;
{{ñ ó
ViewBag|| 
.|| 
CampaignName|| (
=||) *
sc||+ -
.||- .
CampaignName||. :
;||: ;
}}} 
if 
( 
! 
string 
. 
IsNullOrEmpty )
() *
sc* ,
., -
IsTested- 5
)5 6
)6 7
{
ÄÄ 
bool
ÅÅ 
isTested
ÅÅ !
=
ÅÅ" #
Boolean
ÅÅ$ +
.
ÅÅ+ ,
Parse
ÅÅ, 1
(
ÅÅ1 2
sc
ÅÅ2 4
.
ÅÅ4 5
IsTested
ÅÅ5 =
)
ÅÅ= >
;
ÅÅ> ?
	campagins
ÇÇ 
=
ÇÇ 
	campagins
ÇÇ  )
.
ÇÇ) *
Where
ÇÇ* /
(
ÇÇ/ 0
s
ÇÇ0 1
=>
ÇÇ2 4
s
ÇÇ5 6
.
ÇÇ6 7
Testing
ÇÇ7 >
!=
ÇÇ? A
null
ÇÇB F
&&
ÉÉ2 4
s
ÉÉ5 6
.
ÉÉ6 7
Testing
ÉÉ7 >
?
ÉÉ> ?
.
ÉÉ? @
IsTested
ÉÉ@ H
==
ÉÉI K
isTested
ÉÉL T
)
ÉÉT U
.
ÉÉU V
ToList
ÉÉV \
(
ÉÉ\ ]
)
ÉÉ] ^
;
ÉÉ^ _
ViewBag
ÑÑ 
.
ÑÑ 
IsTested
ÑÑ $
=
ÑÑ% &
sc
ÑÑ' )
.
ÑÑ) *
IsTested
ÑÑ* 2
;
ÑÑ2 3
}
ÖÖ 
if
áá 
(
áá 
!
áá 
string
áá 
.
áá 
IsNullOrEmpty
áá )
(
áá) *
sc
áá* ,
.
áá, -
OrderedFrom
áá- 8
)
áá8 9
)
áá9 :
{
àà 
DateTime
ââ 
dateFrom
ââ %
=
ââ& '
DateTime
ââ( 0
.
ââ0 1

ParseExact
ââ1 ;
(
ââ; <
sc
ââ< >
.
ââ> ?
OrderedFrom
ââ? J
,
ââJ K
$str
ââL X
,
ââX Y
CultureInfo
ââZ e
.
ââe f
InvariantCulture
ââf v
)
ââv w
;
ââw x
	campagins
ää 
=
ää 
	campagins
ää  )
.
ää) *
Where
ää* /
(
ää/ 0
s
ää0 1
=>
ää2 4
s
ää5 6
.
ää6 7
	CreatedAt
ää7 @
.
ää@ A
Date
ääA E
>=
ääF H
dateFrom
ääI Q
.
ääQ R
Date
ääR V
)
ääV W
.
ääW X
ToList
ääX ^
(
ää^ _
)
ää_ `
;
ää` a
ViewBag
ãã 
.
ãã 
OrderedFrom
ãã '
=
ãã( )
sc
ãã* ,
.
ãã, -
OrderedFrom
ãã- 8
;
ãã8 9
}
åå 
if
éé 
(
éé 
!
éé 
string
éé 
.
éé 
IsNullOrEmpty
éé )
(
éé) *
sc
éé* ,
.
éé, -
	OrderedTo
éé- 6
)
éé6 7
)
éé7 8
{
èè 
DateTime
êê 
dateTo
êê #
=
êê$ %
DateTime
êê& .
.
êê. /

ParseExact
êê/ 9
(
êê9 :
sc
êê: <
.
êê< =
	OrderedTo
êê= F
,
êêF G
$str
êêH T
,
êêT U
CultureInfo
êêV a
.
êêa b
InvariantCulture
êêb r
)
êêr s
;
êês t
	campagins
ëë 
=
ëë 
	campagins
ëë  )
.
ëë) *
Where
ëë* /
(
ëë/ 0
s
ëë0 1
=>
ëë2 4
s
ëë5 6
.
ëë6 7
	CreatedAt
ëë7 @
.
ëë@ A
Date
ëëA E
<=
ëëF H
dateTo
ëëI O
.
ëëO P
Date
ëëP T
)
ëëT U
.
ëëU V
ToList
ëëV \
(
ëë\ ]
)
ëë] ^
;
ëë^ _
ViewBag
íí 
.
íí 
	OrderedTo
íí %
=
íí& '
sc
íí( *
.
íí* +
	OrderedTo
íí+ 4
;
íí4 5
}
ìì 
if
ïï 
(
ïï 
!
ïï 
string
ïï 
.
ïï 
IsNullOrEmpty
ïï )
(
ïï) *
sc
ïï* ,
.
ïï, -
BroadcastFrom
ïï- :
)
ïï: ;
)
ïï; <
{
ññ 
DateTime
óó 
dateFrom
óó %
=
óó& '
DateTime
óó( 0
.
óó0 1

ParseExact
óó1 ;
(
óó; <
sc
óó< >
.
óó> ?
BroadcastFrom
óó? L
,
óóL M
$str
óóN Z
,
óóZ [
CultureInfo
óó\ g
.
óóg h
InvariantCulture
óóh x
)
óóx y
;
óóy z
	campagins
òò 
=
òò 
	campagins
òò  )
.
òò) *
Where
òò* /
(
òò/ 0
s
òò0 1
=>
òò2 4
s
òò5 6
.
òò6 7
BroadcastDate
òò7 D
?
òòD E
.
òòE F
Date
òòF J
>=
òòK M
dateFrom
òòN V
.
òòV W
Date
òòW [
)
òò[ \
.
òò\ ]
ToList
òò] c
(
òòc d
)
òòd e
;
òòe f
ViewBag
ôô 
.
ôô 
BroadcastFrom
ôô )
=
ôô* +
sc
ôô, .
.
ôô. /
BroadcastFrom
ôô/ <
;
ôô< =
}
öö 
if
úú 
(
úú 
!
úú 
string
úú 
.
úú 
IsNullOrEmpty
úú )
(
úú) *
sc
úú* ,
.
úú, -
BroadcastTo
úú- 8
)
úú8 9
)
úú9 :
{
ùù 
DateTime
ûû 
dateTo
ûû #
=
ûû$ %
DateTime
ûû& .
.
ûû. /

ParseExact
ûû/ 9
(
ûû9 :
sc
ûû: <
.
ûû< =
BroadcastTo
ûû= H
,
ûûH I
$str
ûûJ V
,
ûûV W
CultureInfo
ûûX c
.
ûûc d
InvariantCulture
ûûd t
)
ûût u
;
ûûu v
	campagins
üü 
=
üü 
	campagins
üü  )
.
üü) *
Where
üü* /
(
üü/ 0
s
üü0 1
=>
üü2 4
s
üü5 6
.
üü6 7
BroadcastDate
üü7 D
?
üüD E
.
üüE F
Date
üüF J
<=
üüK M
dateTo
üüN T
.
üüT U
Date
üüU Y
)
üüY Z
.
üüZ [
ToList
üü[ a
(
üüa b
)
üüb c
;
üüc d
ViewBag
†† 
.
†† 
BroadcastTo
†† '
=
††( )
sc
††* ,
.
††, -
BroadcastTo
††- 8
;
††8 9
}
°° 
}
¢¢ 
if
§§ 
(
§§ 
!
§§ 
IsAdmin
§§ 
)
§§ 
{
•• 
	campagins
¶¶ 
=
¶¶ 
	campagins
¶¶ %
.
¶¶% &
Where
¶¶& +
(
¶¶+ ,
s
¶¶, -
=>
¶¶. 0
s
¶¶1 2
.
¶¶2 3
	CreatedBy
¶¶3 <
==
¶¶= ?
LoggedInUser
¶¶@ L
?
¶¶L M
.
¶¶M N
UserName
¶¶N V
)
¶¶V W
.
¶¶W X
ToList
¶¶X ^
(
¶¶^ _
)
¶¶_ `
;
¶¶` a
}
ßß 
ViewBag
©© 
.
©© 
BasicOrderNumber
©© $
=
©©% &
OrderNumberList
©©' 6
;
©©6 7
ViewBag
™™ 
.
™™ 
BasicStatus
™™ 
=
™™  !

StatusList
™™" ,
;
™™, -
ViewBag
´´ 
.
´´ 
AdvancedStatus
´´ "
=
´´# $

StatusList
´´% /
;
´´/ 0
ViewBag
¨¨ 
.
¨¨ 
AdvancedUser
¨¨  
=
¨¨! "
	UsersList
¨¨# ,
;
¨¨, -
ViewBag
≠≠ 
.
≠≠ 
Customer
≠≠ 
=
≠≠ 
	UsersList
≠≠ (
;
≠≠( )
int
∞∞ 

pageNumber
∞∞ 
=
∞∞ 
(
∞∞ 
sc
∞∞  
.
∞∞  !
Page
∞∞! %
??
∞∞& (
$num
∞∞) *
)
∞∞* +
;
∞∞+ ,
return
±± 
View
±± 
(
±± 
	campagins
±± !
.
±±! "
ToPagedList
±±" -
(
±±- .

pageNumber
±±. 8
,
±±8 9
PageSize
±±: B
)
±±B C
)
±±C D
;
±±D E
}
≤≤ 	
public
¥¥ 
ActionResult
¥¥ 
ChangeAssigned
¥¥ *
(
¥¥* +
Guid
¥¥+ /
?
¥¥/ 0
id
¥¥1 3
,
¥¥3 4
string
¥¥5 ;
userId
¥¥< B
)
¥¥B C
{
µµ 	
Campaign
∂∂ 
campaign
∂∂ 
=
∂∂ 
Db
∂∂  "
.
∂∂" #
	Campaigns
∂∂# ,
.
∂∂, -
FirstOrDefault
∂∂- ;
(
∂∂; <
x
∂∂< =
=>
∂∂> @
x
∂∂A B
.
∂∂B C
Id
∂∂C E
==
∂∂F H
id
∂∂I K
)
∂∂K L
;
∂∂L M
if
∑∑ 
(
∑∑ 
campaign
∑∑ 
==
∑∑ 
null
∑∑  
)
∑∑  !
{
∏∏ 
throw
ππ 
new
ππ 
HttpException
ππ '
(
ππ' (
$num
ππ( +
,
ππ+ ,
$str
ππ- 8
)
ππ8 9
;
ππ9 :
}
∫∫ 
try
ªª 
{
ºº 
campaign
ΩΩ 
.
ΩΩ  
AssignedToCustomer
ΩΩ +
=
ΩΩ, -
userId
ΩΩ. 4
;
ΩΩ4 5
Db
ææ 
.
ææ 
SaveChanges
ææ 
(
ææ 
)
ææ  
;
ææ  !
return
øø 
Json
øø 
(
øø 
new
øø 
JsonResponse
øø  ,
(
øø, -
)
øø- .
{
øø/ 0
IsSucess
øø1 9
=
øø: ;
true
øø< @
}
øøA B
,
øøB C!
JsonRequestBehavior
øøD W
.
øøW X
AllowGet
øøX `
)
øø` a
;
øøa b
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¬¬ 
return
√√ 
Json
√√ 
(
√√ 
new
√√ 
JsonResponse
√√  ,
(
√√, -
)
√√- .
{
√√/ 0
IsSucess
√√1 9
=
√√: ;
false
√√< A
,
√√A B
ErrorMessage
√√C O
=
√√P Q
ex
√√R T
.
√√T U
Message
√√U \
}
√√] ^
,
√√^ _!
JsonRequestBehavior
√√` s
.
√√s t
AllowGet
√√t |
)
√√| }
;
√√} ~
}
ƒƒ 
}
≈≈ 	
public
«« 
ActionResult
«« 
SendToTracking
«« *
(
««* +
Guid
««+ /
?
««/ 0
id
««1 3
,
««3 4
string
««5 ;
segmentNumber
««< I
,
««I J
string
««K Q
ioNumber
««R Z
)
««Z [
{
»» 	
Campaign
…… 
campaign
…… 
=
…… 
Db
……  "
.
……" #
	Campaigns
……# ,
.
……, -
FirstOrDefault
……- ;
(
……; <
x
……< =
=>
……> @
x
……A B
.
……B C
Id
……C E
==
……F H
id
……I K
)
……K L
;
……L M
if
   
(
   
campaign
   
==
   
null
    
)
    !
{
ÀÀ 
throw
ÃÃ 
new
ÃÃ 
HttpException
ÃÃ '
(
ÃÃ' (
$num
ÃÃ( +
,
ÃÃ+ ,
$str
ÃÃ- 8
)
ÃÃ8 9
;
ÃÃ9 :
}
ÕÕ 
try
ŒŒ 
{
œœ 
CampaignTracking
––  
campaignTracking
––! 1
=
––2 3
null
––4 8
;
––8 9
if
““ 
(
““ 
string
““ 
.
““ 
IsNullOrEmpty
““ '
(
““' (
segmentNumber
““( 5
)
““5 6
)
““6 7
campaignTracking
”” $
=
””% &
Db
””' )
.
””) *
CampaignTrackings
””* ;
.
””; <
FirstOrDefault
””< J
(
””J K
x
””K L
=>
””M O
x
””P Q
.
””Q R

CampaignId
””R \
==
””] _
id
””` b
)
””b c
;
””c d
else
‘‘ 
campaignTracking
’’ $
=
’’% &
Db
’’' )
.
’’) *
CampaignTrackings
’’* ;
.
’’; <
FirstOrDefault
’’< J
(
’’J K
x
’’K L
=>
’’M O
x
’’P Q
.
’’Q R

CampaignId
’’R \
==
’’] _
id
’’` b
&&
’’c e
x
’’f g
.
’’g h
SegmentNumber
’’h u
==
’’v x
segmentNumber’’y Ü
)’’Ü á
;’’á à
if
◊◊ 
(
◊◊ 
campaignTracking
◊◊ $
!=
◊◊% '
null
◊◊( ,
)
◊◊, -
{
ÿÿ 
campaignTracking
ŸŸ $
.
ŸŸ$ %
IoNumber
ŸŸ% -
=
ŸŸ. /
ioNumber
ŸŸ0 8
;
ŸŸ8 9
}
⁄⁄ 
campaign
€€ 
.
€€ 
Status
€€ 
=
€€  !
(
€€" #
int
€€# &
)
€€& '
CampaignStatus
€€( 6
.
€€6 7

Monitoring
€€7 A
;
€€A B
Db
‹‹ 
.
‹‹ 
SaveChanges
‹‹ 
(
‹‹ 
)
‹‹  
;
‹‹  !
return
›› 
Json
›› 
(
›› 
new
›› 
JsonResponse
››  ,
(
››, -
)
››- .
{
››/ 0
IsSucess
››1 9
=
››: ;
true
››< @
}
››A B
,
››B C!
JsonRequestBehavior
››D W
.
››W X
AllowGet
››X `
)
››` a
;
››a b
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
	Exception
ﬂﬂ 
ex
ﬂﬂ 
)
ﬂﬂ  
{
‡‡ 
return
·· 
Json
·· 
(
·· 
new
·· 
JsonResponse
··  ,
(
··, -
)
··- .
{
··/ 0
IsSucess
··1 9
=
··: ;
false
··< A
,
··A B
ErrorMessage
··C O
=
··P Q
ex
··R T
.
··T U
Message
··U \
}
··] ^
,
··^ _!
JsonRequestBehavior
··` s
.
··s t
AllowGet
··t |
)
··| }
;
··} ~
}
‚‚ 
}
„„ 	
}
‰‰ 
}ÂÂ “ù
RE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\CampaignsController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
CampaignsController $
:% &
BaseController' 5
{ 
private 
static 
char 
_c1 
;  
public 
ActionResult 
Index !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
CampaignProcessor 
. 
ProcessNewOrder -
(- .
$str. 4
,4 5
LoggedInUser6 B
.B C
UserNameC K
)K L
;L M
if 
( 
LoggedInUser 
== 
null  $
)$ %
return& ,
RedirectToAction- =
(= >
$str> F
,F G
$strH Q
)Q R
;R S
ViewBag   
.   
CurrentSort   
=    !
sc  " $
.  $ %
	SortOrder  % .
;  . /
ViewBag!! 
.!! 
OrderNumberSortParm!! '
=!!( )
sc!!* ,
.!!, -
	SortOrder!!- 6
==!!7 9
$str!!: G
?!!H I
$str!!J \
:!!] ^
$str!!_ l
;!!l m
ViewBag"" 
.""  
CampaignNameSortParm"" (
="") *
sc""+ -
.""- .
	SortOrder"". 7
==""8 :
$str""; I
?""J K
$str""L _
:""` a
$str""b p
;""p q
ViewBag## 
.## 
CreatedBySortParm## %
=##& '
sc##( *
.##* +
	SortOrder##+ 4
==##5 7
$str##8 C
?##D E
$str##F V
:##W X
$str##Y d
;##d e
ViewBag$$ 
.$$ 
CreatedAtSortParm$$ %
=$$& '
sc$$( *
.$$* +
	SortOrder$$+ 4
==$$5 7
$str$$8 C
?$$D E
$str$$F V
:$$W X
$str$$Y d
;$$d e
ViewBag%% 
.%% 
DeployDateSortParm%% &
=%%' (
sc%%) +
.%%+ ,
	SortOrder%%, 5
==%%6 8
$str%%9 E
?%%F G
$str%%H Y
:%%Z [
$str%%\ h
;%%h i
ViewBag&& 
.&& 
QuantitySortParm&& $
=&&% &
sc&&' )
.&&) *
	SortOrder&&* 3
==&&4 6
$str&&7 A
?&&B C
$str&&D S
:&&T U
$str&&V `
;&&` a
ViewBag'' 
.'' 
StatusSortParm'' "
=''# $
sc''% '
.''' (
	SortOrder''( 1
==''2 4
$str''5 =
?''> ?
$str''@ M
:''N O
$str''P X
;''X Y
var)) 
	campagins)) 
=)) 
Db** 
.** 
	Campaigns** 
.++ 
Include++ 
(++ 
x++ 
=>++ 
x++ 
.++  
Testing++  '
)++' (
.,, 
Include,, 
(,, 
x,, 
=>,, 
x,, 
.,,  
Approved,,  (
),,( )
.-- 
Include-- 
(-- 
x-- 
=>-- 
x-- 
.--  
Segments--  (
)--( )
... 
ToList.. 
(.. 
).. 
;.. 
switch00 
(00 
sc00 
.00 
	SortOrder00  
)00  !
{11 
case22 
$str22 "
:22" #
	campagins33 
=33 
	campagins33  )
.33) *
OrderBy33* 1
(331 2
s332 3
=>334 6
s337 8
.338 9
OrderNumber339 D
)33D E
.33E F
ToList33F L
(33L M
)33M N
;33N O
break44 
;44 
case55 
$str55 '
:55' (
	campagins66 
=66 
	campagins66  )
.66) *
OrderByDescending66* ;
(66; <
s66< =
=>66> @
s66A B
.66B C
OrderNumber66C N
)66N O
.66O P
ToList66P V
(66V W
)66W X
;66X Y
break77 
;77 
case88 
$str88 #
:88# $
	campagins99 
=99 
	campagins99  )
.99) *
OrderBy99* 1
(991 2
s992 3
=>994 6
s997 8
.998 9
CampaignName999 E
)99E F
.99F G
ToList99G M
(99M N
)99N O
;99O P
break:: 
;:: 
case;; 
$str;; (
:;;( )
	campagins<< 
=<< 
	campagins<<  )
.<<) *
OrderByDescending<<* ;
(<<; <
s<<< =
=><<> @
s<<A B
.<<B C
CampaignName<<C O
)<<O P
.<<P Q
ToList<<Q W
(<<W X
)<<X Y
;<<Y Z
break== 
;== 
case>> 
$str>>  
:>>  !
	campagins?? 
=?? 
	campagins??  )
.??) *
OrderBy??* 1
(??1 2
s??2 3
=>??4 6
s??7 8
.??8 9
	CreatedBy??9 B
)??B C
.??C D
ToList??D J
(??J K
)??K L
;??L M
break@@ 
;@@ 
caseAA 
$strAA %
:AA% &
	campaginsBB 
=BB 
	campaginsBB  )
.BB) *
OrderByDescendingBB* ;
(BB; <
sBB< =
=>BB> @
sBBA B
.BBB C
	CreatedByBBC L
)BBL M
.BBM N
ToListBBN T
(BBT U
)BBU V
;BBV W
breakCC 
;CC 
caseDD 
$strDD  
:DD  !
	campaginsEE 
=EE 
	campaginsEE  )
.EE) *
OrderByEE* 1
(EE1 2
sEE2 3
=>EE4 6
sEE7 8
.EE8 9
	CreatedAtEE9 B
)EEB C
.EEC D
ToListEED J
(EEJ K
)EEK L
;EEL M
breakFF 
;FF 
caseGG 
$strGG %
:GG% &
	campaginsHH 
=HH 
	campaginsHH  )
.HH) *
OrderByDescendingHH* ;
(HH; <
sHH< =
=>HH> @
sHHA B
.HHB C
	CreatedAtHHC L
)HHL M
.HHM N
ToListHHN T
(HHT U
)HHU V
;HHV W
breakII 
;II 
caseJJ 
$strJJ $
:JJ$ %
	campaginsKK 
=KK 
	campaginsKK  )
.KK) *
OrderByKK* 1
(KK1 2
sKK2 3
=>KK4 6
sKK7 8
.KK8 9
BroadcastDateKK9 F
)KKF G
.KKG H
ToListKKH N
(KKN O
)KKO P
;KKP Q
breakLL 
;LL 
caseMM 
$strMM )
:MM) *
	campaginsNN 
=NN 
	campaginsNN  )
.NN) *
OrderByDescendingNN* ;
(NN; <
sNN< =
=>NN> @
sNNA B
.NNB C
BroadcastDateNNC P
)NNP Q
.NNQ R
ToListNNR X
(NNX Y
)NNY Z
;NNZ [
breakOO 
;OO 
casePP 
$strPP 
:PP  
	campaginsQQ 
=QQ 
	campaginsQQ  )
.QQ) *
OrderByQQ* 1
(QQ1 2
sQQ2 3
=>QQ4 6
sQQ7 8
.QQ8 9
QuantityQQ9 A
)QQA B
.QQB C
ToListQQC I
(QQI J
)QQJ K
;QQK L
breakRR 
;RR 
caseSS 
$strSS $
:SS$ %
	campaginsTT 
=TT 
	campaginsTT  )
.TT) *
OrderByDescendingTT* ;
(TT; <
sTT< =
=>TT> @
sTTA B
.TTB C
QuantityTTC K
)TTK L
.TTL M
ToListTTM S
(TTS T
)TTT U
;TTU V
breakUU 
;UU 
caseVV 
$strVV 
:VV 
	campaginsWW 
=WW 
	campaginsWW  )
.WW) *
OrderByWW* 1
(WW1 2
sWW2 3
=>WW4 6
sWW7 8
.WW8 9
StatusWW9 ?
)WW? @
.WW@ A
ToListWWA G
(WWG H
)WWH I
;WWI J
breakXX 
;XX 
caseYY 
$strYY "
:YY" #
	campaginsZZ 
=ZZ 
	campaginsZZ  )
.ZZ) *
OrderByDescendingZZ* ;
(ZZ; <
sZZ< =
=>ZZ> @
sZZA B
.ZZB C
StatusZZC I
)ZZI J
.ZZJ K
ToListZZK Q
(ZZQ R
)ZZR S
;ZZS T
break[[ 
;[[ 
default\\ 
:\\ 
	campagins]] 
=]] 
	campagins]]  )
.]]) *
OrderByDescending]]* ;
(]]; <
s]]< =
=>]]> @
s]]A B
.]]B C
	CreatedAt]]C L
)]]L M
.]]M N
ToList]]N T
(]]T U
)]]U V
;]]V W
break^^ 
;^^ 
}__ 
ViewBagaa 
.aa 

SearchTypeaa 
=aa  
scaa! #
.aa# $

SearchTypeaa$ .
;aa. /
ifbb 
(bb 
scbb 
.bb 

SearchTypebb 
==bb  
$strbb! (
)bb( )
{cc 
ifdd 
(dd 
!dd 
stringdd 
.dd 
IsNullOrEmptydd )
(dd) *
scdd* ,
.dd, -
BasicStringdd- 8
)dd8 9
)dd9 :
{ee 
	campaginsff 
=ff 
	campaginsff  )
.ff) *
Whereff* /
(ff/ 0
sff0 1
=>ff2 4
sgg 
.gg 
OrderNumbergg !
.gg! "
Equalsgg" (
(gg( )
scgg) +
.gg+ ,
BasicStringgg, 7
)gg7 8
||gg9 ;
shh 
.hh $
ReBroadcastedOrderNumberhh .
==hh/ 1
schh2 4
.hh4 5
BasicStringhh5 @
||hhA C
sii 
.ii 
CampaignNameii "
.ii" #
IndexOfii# *
(ii* +
scii+ -
.ii- .
BasicStringii. 9
,ii9 :
StringComparisonii; K
.iiK L&
InvariantCultureIgnoreCaseiiL f
)iif g
>=iih j
$numiik l
)iil m
.iim n
ToListiin t
(iit u
)iiu v
;iiv w
ViewBagjj 
.jj 
BasicStringSearchedjj /
=jj0 1
scjj2 4
.jj4 5
BasicStringjj5 @
;jj@ A
}kk 
elsekk 
ifkk 
(kk 
!kk 
stringkk "
.kk" #
IsNullOrEmptykk# 0
(kk0 1
sckk1 3
.kk3 4
BasicStatuskk4 ?
)kk? @
)kk@ A
{ll 
intmm 
statusmm 
=mm  
intmm! $
.mm$ %
Parsemm% *
(mm* +
scmm+ -
.mm- .
BasicStatusmm. 9
)mm9 :
;mm: ;
ifnn 
(nn 
statusnn 
==nn !
(nn" #
intnn# &
)nn& '
CampaignStatusnn' 5
.nn5 6
Rebroadcastednn6 C
)nnC D
	campaginsoo !
=oo" #
	campaginsoo$ -
.oo- .
Whereoo. 3
(oo3 4
soo4 5
=>oo6 8
soo9 :
.oo: ;
ReBroadcastedoo; H
)ooH I
.ooI J
ToListooJ P
(ooP Q
)ooQ R
;ooR S
elsepp 
ifpp 
(pp 
statuspp #
==pp$ &
(pp' (
intpp( +
)pp+ ,
CampaignStatuspp, :
.pp: ;
NotRebroadcastedpp; K
)ppK L
	campaginsqq !
=qq" #
	campaginsqq$ -
.qq- .
Whereqq. 3
(qq3 4
sqq4 5
=>qq6 8
sqq9 :
.qq: ;
ReBroadCastqq; F
&&qqG I
!qqJ K
sqqK L
.qqL M
ReBroadcastedqqM Z
)qqZ [
.qq[ \
ToListqq\ b
(qqb c
)qqc d
;qqd e
elserr 
	campaginsss !
=ss" #
	campaginsss$ -
.ss- .
Wheress. 3
(ss3 4
sss4 5
=>ss6 8
sss9 :
.ss: ;
Statusss; A
==ssB D
statusssE K
)ssK L
.ssL M
ToListssM S
(ssS T
)ssT U
;ssU V
ViewBagtt 
.tt 
BasicStatusSearchedtt /
=tt0 1
sctt2 4
.tt4 5
BasicStatustt5 @
;tt@ A
}uu 
elseuu 
ifuu 
(uu 
!uu 
stringuu "
.uu" #
IsNullOrEmptyuu# 0
(uu0 1
scuu1 3
.uu3 4
BasicOrderNumberuu4 D
)uuD E
)uuE F
{vv 
	campaginsww 
=ww 
	campaginsww  )
.ww) *
Whereww* /
(ww/ 0
sww0 1
=>ww2 4
sww5 6
.ww6 7
Idww7 9
.ww9 :
ToStringww: B
(wwB C
)wwC D
.wwD E
EqualswwE K
(wwK L
scwwL N
.wwN O
BasicOrderNumberwwO _
)ww_ `
)ww` a
.wwa b
ToListwwb h
(wwh i
)wwi j
;wwj k
}xx 
}zz 
else{{ 
if{{ 
({{ 
sc{{ 
.{{ 

SearchType{{ "
=={{# %
$str{{& 0
){{0 1
{|| 
if}} 
(}} 
!}} 
string}} 
.}} 
IsNullOrEmpty}} )
(}}) *
sc}}* ,
.}}, -
AdvancedStatus}}- ;
)}}; <
)}}< =
{~~ 
int 
status 
=  
int! $
.$ %
Parse% *
(* +
sc+ -
.- .
AdvancedStatus. <
)< =
;= >
if
ÄÄ 
(
ÄÄ 
status
ÄÄ 
==
ÄÄ !
(
ÄÄ" #
int
ÄÄ# &
)
ÄÄ& '
CampaignStatus
ÄÄ' 5
.
ÄÄ5 6
Rebroadcasted
ÄÄ6 C
)
ÄÄC D
	campagins
ÅÅ !
=
ÅÅ" #
	campagins
ÅÅ$ -
.
ÅÅ- .
Where
ÅÅ. 3
(
ÅÅ3 4
s
ÅÅ4 5
=>
ÅÅ6 8
s
ÅÅ9 :
.
ÅÅ: ;
OrderNumber
ÅÅ; F
.
ÅÅF G
EndsWith
ÅÅG O
(
ÅÅO P
$str
ÅÅP U
)
ÅÅU V
)
ÅÅV W
.
ÅÅW X
ToList
ÅÅX ^
(
ÅÅ^ _
)
ÅÅ_ `
;
ÅÅ` a
else
ÇÇ 
	campagins
ÉÉ !
=
ÉÉ" #
	campagins
ÉÉ$ -
.
ÉÉ- .
Where
ÉÉ. 3
(
ÉÉ3 4
s
ÉÉ4 5
=>
ÉÉ6 8
s
ÉÉ9 :
.
ÉÉ: ;
Status
ÉÉ; A
==
ÉÉB D
status
ÉÉE K
)
ÉÉK L
.
ÉÉL M
ToList
ÉÉM S
(
ÉÉS T
)
ÉÉT U
;
ÉÉU V
ViewBag
ÑÑ 
.
ÑÑ $
AdvancedStatusSearched
ÑÑ 2
=
ÑÑ3 4
sc
ÑÑ5 7
.
ÑÑ7 8
AdvancedStatus
ÑÑ8 F
;
ÑÑF G
}
ÖÖ 
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
string
ÜÜ 
.
ÜÜ 
IsNullOrEmpty
ÜÜ )
(
ÜÜ) *
sc
ÜÜ* ,
.
ÜÜ, -
AdvancedUser
ÜÜ- 9
)
ÜÜ9 :
)
ÜÜ: ;
{
áá 
	campagins
àà 
=
àà 
	campagins
àà  )
.
àà) *
Where
àà* /
(
àà/ 0
s
àà0 1
=>
àà2 4
s
àà5 6
.
àà6 7
	CreatedBy
àà7 @
==
ààA C
sc
ààD F
.
ààF G
AdvancedUser
ààG S
)
ààS T
.
ààT U
ToList
ààU [
(
àà[ \
)
àà\ ]
;
àà] ^
ViewBag
ââ 
.
ââ "
AdvancedUserSearched
ââ 0
=
ââ1 2
sc
ââ3 5
.
ââ5 6
AdvancedUser
ââ6 B
;
ââB C
}
ää 
if
åå 
(
åå 
!
åå 
string
åå 
.
åå 
IsNullOrEmpty
åå )
(
åå) *
sc
åå* ,
.
åå, -
CampaignName
åå- 9
)
åå9 :
)
åå: ;
{
çç 
sc
éé 
.
éé 
CampaignName
éé #
=
éé$ %
sc
éé& (
.
éé( )
CampaignName
éé) 5
.
éé5 6
ToLowerInvariant
éé6 F
(
ééF G
)
ééG H
;
ééH I
	campagins
èè 
=
èè 
	campagins
èè  )
.
èè) *
Where
èè* /
(
èè/ 0
s
èè0 1
=>
èè2 4
s
èè5 6
.
èè6 7
CampaignName
èè7 C
.
èèC D
IndexOf
èèD K
(
èèK L
sc
èèL N
.
èèN O
CampaignName
èèO [
,
èè[ \
StringComparison
èè] m
.
èèm n'
CurrentCultureIgnoreCaseèèn Ü
)èèÜ á
>=èèà ä
$numèèã å
)èèå ç
.èèç é
ToListèèé î
(èèî ï
)èèï ñ
;èèñ ó
ViewBag
êê 
.
êê 
CampaignName
êê (
=
êê) *
sc
êê+ -
.
êê- .
CampaignName
êê. :
;
êê: ;
}
ëë 
if
ìì 
(
ìì 
!
ìì 
string
ìì 
.
ìì 
IsNullOrEmpty
ìì )
(
ìì) *
sc
ìì* ,
.
ìì, -
IsTested
ìì- 5
)
ìì5 6
)
ìì6 7
{
îî 
bool
ïï 
isTested
ïï !
=
ïï" #
Boolean
ïï$ +
.
ïï+ ,
Parse
ïï, 1
(
ïï1 2
sc
ïï2 4
.
ïï4 5
IsTested
ïï5 =
)
ïï= >
;
ïï> ?
	campagins
ññ 
=
ññ 
	campagins
ññ  )
.
ññ) *
Where
ññ* /
(
ññ/ 0
s
ññ0 1
=>
ññ2 4
s
ññ5 6
.
ññ6 7
Testing
ññ7 >
!=
ññ? A
null
ññB F
&&
óó2 4
s
óó5 6
.
óó6 7
Testing
óó7 >
?
óó> ?
.
óó? @
IsTested
óó@ H
==
óóI K
isTested
óóL T
)
óóT U
.
óóU V
ToList
óóV \
(
óó\ ]
)
óó] ^
;
óó^ _
ViewBag
òò 
.
òò 
IsTested
òò $
=
òò% &
sc
òò' )
.
òò) *
IsTested
òò* 2
;
òò2 3
}
ôô 
if
õõ 
(
õõ 
!
õõ 
string
õõ 
.
õõ 
IsNullOrEmpty
õõ )
(
õõ) *
sc
õõ* ,
.
õõ, -
OrderedFrom
õõ- 8
)
õõ8 9
)
õõ9 :
{
úú 
DateTime
ùù 
dateFrom
ùù %
=
ùù& '
DateTime
ùù( 0
.
ùù0 1

ParseExact
ùù1 ;
(
ùù; <
sc
ùù< >
.
ùù> ?
OrderedFrom
ùù? J
,
ùùJ K
$str
ùùL X
,
ùùX Y
CultureInfo
ùùZ e
.
ùùe f
InvariantCulture
ùùf v
)
ùùv w
;
ùùw x
	campagins
ûû 
=
ûû 
	campagins
ûû  )
.
ûû) *
Where
ûû* /
(
ûû/ 0
s
ûû0 1
=>
ûû2 4
s
ûû5 6
.
ûû6 7
	CreatedAt
ûû7 @
.
ûû@ A
Date
ûûA E
>=
ûûF H
dateFrom
ûûI Q
.
ûûQ R
Date
ûûR V
)
ûûV W
.
ûûW X
ToList
ûûX ^
(
ûû^ _
)
ûû_ `
;
ûû` a
ViewBag
üü 
.
üü 
OrderedFrom
üü '
=
üü( )
sc
üü* ,
.
üü, -
OrderedFrom
üü- 8
;
üü8 9
}
†† 
if
¢¢ 
(
¢¢ 
!
¢¢ 
string
¢¢ 
.
¢¢ 
IsNullOrEmpty
¢¢ )
(
¢¢) *
sc
¢¢* ,
.
¢¢, -
	OrderedTo
¢¢- 6
)
¢¢6 7
)
¢¢7 8
{
££ 
DateTime
§§ 
dateTo
§§ #
=
§§$ %
DateTime
§§& .
.
§§. /

ParseExact
§§/ 9
(
§§9 :
sc
§§: <
.
§§< =
	OrderedTo
§§= F
,
§§F G
$str
§§H T
,
§§T U
CultureInfo
§§V a
.
§§a b
InvariantCulture
§§b r
)
§§r s
;
§§s t
	campagins
•• 
=
•• 
	campagins
••  )
.
••) *
Where
••* /
(
••/ 0
s
••0 1
=>
••2 4
s
••5 6
.
••6 7
	CreatedAt
••7 @
.
••@ A
Date
••A E
<=
••F H
dateTo
••I O
.
••O P
Date
••P T
)
••T U
.
••U V
ToList
••V \
(
••\ ]
)
••] ^
;
••^ _
ViewBag
¶¶ 
.
¶¶ 
	OrderedTo
¶¶ %
=
¶¶& '
sc
¶¶( *
.
¶¶* +
	OrderedTo
¶¶+ 4
;
¶¶4 5
}
ßß 
if
©© 
(
©© 
!
©© 
string
©© 
.
©© 
IsNullOrEmpty
©© )
(
©©) *
sc
©©* ,
.
©©, -
BroadcastFrom
©©- :
)
©©: ;
)
©©; <
{
™™ 
DateTime
´´ 
dateFrom
´´ %
=
´´& '
DateTime
´´( 0
.
´´0 1

ParseExact
´´1 ;
(
´´; <
sc
´´< >
.
´´> ?
BroadcastFrom
´´? L
,
´´L M
$str
´´N Z
,
´´Z [
CultureInfo
´´\ g
.
´´g h
InvariantCulture
´´h x
)
´´x y
;
´´y z
	campagins
¨¨ 
=
¨¨ 
	campagins
¨¨  )
.
¨¨) *
Where
¨¨* /
(
¨¨/ 0
s
¨¨0 1
=>
¨¨2 4
s
¨¨5 6
.
¨¨6 7
BroadcastDate
¨¨7 D
?
¨¨D E
.
¨¨E F
Date
¨¨F J
>=
¨¨K M
dateFrom
¨¨N V
.
¨¨V W
Date
¨¨W [
)
¨¨[ \
.
¨¨\ ]
ToList
¨¨] c
(
¨¨c d
)
¨¨d e
;
¨¨e f
ViewBag
≠≠ 
.
≠≠ 
BroadcastFrom
≠≠ )
=
≠≠* +
sc
≠≠, .
.
≠≠. /
BroadcastFrom
≠≠/ <
;
≠≠< =
}
ÆÆ 
if
∞∞ 
(
∞∞ 
!
∞∞ 
string
∞∞ 
.
∞∞ 
IsNullOrEmpty
∞∞ )
(
∞∞) *
sc
∞∞* ,
.
∞∞, -
BroadcastTo
∞∞- 8
)
∞∞8 9
)
∞∞9 :
{
±± 
DateTime
≤≤ 
dateTo
≤≤ #
=
≤≤$ %
DateTime
≤≤& .
.
≤≤. /

ParseExact
≤≤/ 9
(
≤≤9 :
sc
≤≤: <
.
≤≤< =
BroadcastTo
≤≤= H
,
≤≤H I
$str
≤≤J V
,
≤≤V W
CultureInfo
≤≤X c
.
≤≤c d
InvariantCulture
≤≤d t
)
≤≤t u
;
≤≤u v
	campagins
≥≥ 
=
≥≥ 
	campagins
≥≥  )
.
≥≥) *
Where
≥≥* /
(
≥≥/ 0
s
≥≥0 1
=>
≥≥2 4
s
≥≥5 6
.
≥≥6 7
BroadcastDate
≥≥7 D
?
≥≥D E
.
≥≥E F
Date
≥≥F J
<=
≥≥K M
dateTo
≥≥N T
.
≥≥T U
Date
≥≥U Y
)
≥≥Y Z
.
≥≥Z [
ToList
≥≥[ a
(
≥≥a b
)
≥≥b c
;
≥≥c d
ViewBag
¥¥ 
.
¥¥ 
BroadcastTo
¥¥ '
=
¥¥( )
sc
¥¥* ,
.
¥¥, -
BroadcastTo
¥¥- 8
;
¥¥8 9
}
µµ 
}
∂∂ 
if
∏∏ 
(
∏∏ 
LoggedInUser
∏∏ 
!=
∏∏ 
null
∏∏  $
&&
∏∏% '
!
∏∏( )
IsAdmin
∏∏) 0
)
∏∏0 1
{
ππ 
	campagins
∫∫ 
=
∫∫ 
	campagins
∫∫ %
.
∫∫% &
Where
∫∫& +
(
∫∫+ ,
s
∫∫, -
=>
∫∫. 0
s
∫∫1 2
.
∫∫2 3
	CreatedBy
∫∫3 <
==
∫∫= ?
LoggedInUser
∫∫@ L
.
∫∫L M
UserName
∫∫M U
)
∫∫U V
.
∫∫V W
ToList
∫∫W ]
(
∫∫] ^
)
∫∫^ _
;
∫∫_ `
}
ªª 
ViewBag
ΩΩ 
.
ΩΩ 
BasicOrderNumber
ΩΩ $
=
ΩΩ% &
OrderNumberList
ΩΩ' 6
;
ΩΩ6 7
ViewBag
ææ 
.
ææ 
BasicStatus
ææ 
=
ææ  !

StatusList
ææ" ,
;
ææ, -
ViewBag
øø 
.
øø 
AdvancedStatus
øø "
=
øø# $

StatusList
øø% /
;
øø/ 0
ViewBag
¿¿ 
.
¿¿ 
AdvancedUser
¿¿  
=
¿¿! "
	UsersList
¿¿# ,
;
¿¿, -
string
¬¬ 
idsForPrint
¬¬ 
=
¬¬  
string
¬¬! '
.
¬¬' (
IsNullOrEmpty
¬¬( 5
(
¬¬5 6
ViewBag
¬¬6 =
.
¬¬= >
	SearchIds
¬¬> G
)
¬¬G H
?
¬¬I J
string
√√$ *
.
√√* +
Join
√√+ /
(
√√/ 0
$str
√√0 3
,
√√3 4
	campagins
√√5 >
.
√√> ?
Select
√√? E
(
√√E F
x
√√F G
=>
√√H J
x
√√K L
.
√√L M
Id
√√M O
.
√√O P
ToString
√√P X
(
√√X Y
)
√√Y Z
)
√√Z [
)
√√[ \
:
ƒƒ$ %
ViewBag
ƒƒ& -
.
ƒƒ- .
	SearchIds
ƒƒ. 7
;
ƒƒ7 8
Session
≈≈ 
[
≈≈ 
$str
≈≈ !
]
≈≈! "
=
≈≈# $
idsForPrint
≈≈% 0
;
≈≈0 1
int
»» 

pageNumber
»» 
=
»» 
(
»» 
sc
»»  
.
»»  !
Page
»»! %
??
»»& (
$num
»») *
)
»»* +
;
»»+ ,
return
…… 
View
…… 
(
…… 
	campagins
…… !
.
……! "
ToPagedList
……" -
(
……- .

pageNumber
……. 8
,
……8 9
PageSize
……: B
)
……B C
)
……C D
;
……D E
}
   	
public
ÃÃ 
ActionResult
ÃÃ 
Download
ÃÃ $
(
ÃÃ$ %
)
ÃÃ% &
{
ÕÕ 	
string
ŒŒ 
fileName
ŒŒ 
=
ŒŒ 
$"
ŒŒ  
Orders_
ŒŒ  '
{
ŒŒ' (
DateTime
ŒŒ( 0
.
ŒŒ0 1
Now
ŒŒ1 4
:
ŒŒ4 5
yyyyMMdd_HHmmss
ŒŒ5 D
}
ŒŒD E
.csv
ŒŒE I
"
ŒŒI J
;
ŒŒJ K
var
œœ 
filePath
œœ 
=
œœ 
$"
œœ 
{
œœ 
DownloadPath
œœ *
}
œœ* +
\\
œœ+ -
{
œœ- .
fileName
œœ. 6
}
œœ6 7
"
œœ7 8
;
œœ8 9
if
–– 
(
–– 
Session
–– 
[
–– 
$str
–– %
]
––% &
!=
––' )
null
––* .
)
––. /
{
—— 
List
““ 
<
““ 
Guid
““ 
>
““ 
ids
““ 
;
““ 
try
”” 
{
‘‘ 
ids
’’ 
=
’’ 
(
’’ 
Session
’’ "
[
’’" #
$str
’’# 0
]
’’0 1
as
’’2 4
string
’’5 ;
)
’’; <
?
’’< =
.
’’= >
Split
’’> C
(
’’C D
$str
’’D G
.
’’G H
ToCharArray
’’H S
(
’’S T
)
’’T U
)
’’U V
.
’’V W
Select
’’W ]
(
’’] ^
Guid
’’^ b
.
’’b c
Parse
’’c h
)
’’h i
.
’’i j
ToList
’’j p
(
’’p q
)
’’q r
;
’’r s
var
÷÷ 
	campagins
÷÷ !
=
÷÷" #
Db
÷÷$ &
.
÷÷& '
	Campaigns
÷÷' 0
.
◊◊ 
Include
◊◊  
(
◊◊  !
x
◊◊! "
=>
◊◊# %
x
◊◊& '
.
◊◊' (
Testing
◊◊( /
)
◊◊/ 0
.
◊◊0 1
Include
◊◊1 8
(
◊◊8 9
x
◊◊9 :
=>
◊◊; =
x
◊◊> ?
.
◊◊? @
Approved
◊◊@ H
)
◊◊H I
.
ÿÿ 
Where
ÿÿ 
(
ÿÿ 
x
ÿÿ  
=>
ÿÿ! #
ids
ÿÿ$ '
.
ÿÿ' (
Contains
ÿÿ( 0
(
ÿÿ0 1
x
ÿÿ1 2
.
ÿÿ2 3
Id
ÿÿ3 5
)
ÿÿ5 6
)
ÿÿ6 7
.
ŸŸ 
ToList
ŸŸ 
(
ŸŸ  
)
ŸŸ  !
.
⁄⁄ 
Select
⁄⁄ 
(
⁄⁄  
x
⁄⁄  !
=>
⁄⁄" $
new
⁄⁄% (

CampaignVm
⁄⁄) 3
(
⁄⁄3 4
)
⁄⁄4 5
{
€€ 
OrderNumber
‹‹ '
=
‹‹( )
x
‹‹* +
.
‹‹+ ,
OrderNumber
‹‹, 7
,
‹‹7 8
CampaignName
›› (
=
››) *
x
››+ ,
.
››, -
CampaignName
››- 9
,
››9 :

DeployDate
ﬁﬁ &
=
ﬁﬁ' (
x
ﬁﬁ) *
.
ﬁﬁ* +
Approved
ﬁﬁ+ 3
?
ﬁﬁ3 4
.
ﬁﬁ4 5

DeployDate
ﬁﬁ5 ?
??
ﬁﬁ@ B
(
ﬁﬁC D
x
ﬁﬁD E
.
ﬁﬁE F
Testing
ﬁﬁF M
?
ﬁﬁM N
.
ﬁﬁN O

DeployDate
ﬁﬁO Y
??
ﬁﬁZ \
x
ﬁﬁ] ^
.
ﬁﬁ^ _
BroadcastDate
ﬁﬁ_ l
)
ﬁﬁl m
,
ﬁﬁm n
Quantity
ﬂﬂ $
=
ﬂﬂ% &
x
ﬂﬂ' (
.
ﬂﬂ( )
Approved
ﬂﬂ) 1
?
ﬂﬂ1 2
.
ﬂﬂ2 3
Quantity
ﬂﬂ3 ;
??
ﬂﬂ< >
(
ﬂﬂ? @
x
ﬂﬂ@ A
.
ﬂﬂA B
Testing
ﬂﬂB I
?
ﬂﬂI J
.
ﬂﬂJ K
Quantity
ﬂﬂK S
??
ﬂﬂT V
x
ﬂﬂW X
.
ﬂﬂX Y
Quantity
ﬂﬂY a
)
ﬂﬂa b
,
ﬂﬂb c
Status
‡‡ "
=
‡‡# $
System
‡‡% +
.
‡‡+ ,
Enum
‡‡, 0
.
‡‡0 1
GetName
‡‡1 8
(
‡‡8 9
typeof
‡‡9 ?
(
‡‡? @
CampaignStatus
‡‡@ N
)
‡‡N O
,
‡‡O P
x
‡‡Q R
.
‡‡R S
Status
‡‡S Y
)
‡‡Y Z
}
·· 
)
·· 
;
·· 
	campagins
„„ 
.
„„ 
ToCsv
„„ #
(
„„# $
filePath
„„$ ,
,
„„, -
new
„„. 1
CsvDefinition
„„2 ?
(
„„? @
)
„„@ A
{
‰‰ 
	EndOfLine
ÂÂ !
=
ÂÂ" #
$str
ÂÂ$ *
,
ÂÂ* +
FieldSeparator
ÊÊ &
=
ÊÊ' (
$char
ÊÊ) ,
,
ÊÊ, -
TextQualifier
ÁÁ %
=
ÁÁ& '
$char
ÁÁ( +
,
ÁÁ+ ,
Columns
ËË 
=
ËË" #
new
ËË$ '
List
ËË( ,
<
ËË, -
string
ËË- 3
>
ËË3 4
{
ËË5 6
$str
ËË7 D
,
ËËD E
$str
ËËF T
,
ËËT U
$str
ËËV b
,
ËËb c
$str
ËËd n
,
ËËn o
$str
ËËp x
}
ËËy z
}
ÈÈ 
)
ÈÈ 
;
ÈÈ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ  
ex
ÎÎ! #
)
ÎÎ# $
{
ÏÏ 
throw
ÌÌ 
new
ÌÌ 
AdsException
ÌÌ *
(
ÌÌ* +
$str
ÌÌ+ :
+
ÌÌ; <
ex
ÌÌ= ?
.
ÌÌ? @
Message
ÌÌ@ G
)
ÌÌG H
;
ÌÌH I
}
ÓÓ 
}
ÔÔ 
return
 
File
 
(
 
filePath
  
,
  !
$str
" ,
,
, -
fileName
. 6
)
6 7
;
7 8
}
ÒÒ 	
public
ÙÙ 
ActionResult
ÙÙ 
Details
ÙÙ #
(
ÙÙ# $
Guid
ÙÙ$ (
?
ÙÙ( )
id
ÙÙ* ,
)
ÙÙ, -
{
ıı 	
if
ˆˆ 
(
ˆˆ 
id
ˆˆ 
==
ˆˆ 
null
ˆˆ 
)
ˆˆ 
{
˜˜ 
throw
¯¯ 
new
¯¯ 
HttpException
¯¯ '
(
¯¯' (
$num
¯¯( +
,
¯¯+ ,
$str
¯¯- :
)
¯¯: ;
;
¯¯; <
}
˘˘ 
Campaign
˙˙ 
campaign
˙˙ 
=
˙˙ 
Db
˙˙  "
.
˙˙" #
	Campaigns
˙˙# ,
.
˙˙, -
Find
˙˙- 1
(
˙˙1 2
id
˙˙2 4
)
˙˙4 5
;
˙˙5 6
if
˚˚ 
(
˚˚ 
campaign
˚˚ 
==
˚˚ 
null
˚˚  
)
˚˚  !
{
¸¸ 
throw
˝˝ 
new
˝˝ 
HttpException
˝˝ '
(
˝˝' (
$num
˝˝( +
,
˝˝+ ,
$str
˝˝- 8
)
˝˝8 9
;
˝˝9 :
}
˛˛ 
return
ˇˇ 
View
ˇˇ 
(
ˇˇ 
campaign
ˇˇ  
)
ˇˇ  !
;
ˇˇ! "
}
ÄÄ 	
public
ÇÇ 
ActionResult
ÇÇ 

NewSegment
ÇÇ &
(
ÇÇ& '
)
ÇÇ' (
{
ÉÉ 	
var
ÖÖ 
segment
ÖÖ 
=
ÖÖ 
new
ÖÖ 
CampaignSegment
ÖÖ -
(
ÖÖ- .
)
ÖÖ. /
{
ÜÜ 
Id
áá 
=
áá 
Guid
áá 
.
áá 
NewGuid
áá !
(
áá! "
)
áá" #
,
áá# $
	CreatedAt
àà 
=
àà 
DateTime
àà $
.
àà$ %
Now
àà% (
,
àà( )
SegmentNumber
ââ 
=
ââ 
$str
ââ  "
+
ââ# $
_c1
ââ% (
++
ââ( *
,
ââ* +

WhiteLabel
ää 
=
ää 
LoggedInUser
ää )
.
ää) *

WhiteLabel
ää* 4
}
ãã 
;
ãã 
return
åå 
PartialView
åå 
(
åå 
$str
åå J
,
ååJ K
segment
ååL S
)
ååS T
;
ååT U
}
çç 	
public
êê 
ActionResult
êê 
Create
êê "
(
êê" #
)
êê# $
{
ëë 	
_c1
íí 
=
íí 
$char
íí 
;
íí 

CampaignVm
ìì 
model
ìì 
=
ìì 
new
ìì "

CampaignVm
ìì# -
(
ìì- .
)
ìì. /
{
îî  
RepresentativeName
ïï "
=
ïï# $
LoggedInUser
ïï% 1
?
ïï1 2
.
ïï2 3
UserName
ïï3 ;
,
ïï; <!
RepresentativeEmail
ññ #
=
ññ$ %
LoggedInUser
ññ& 2
?
ññ2 3
.
ññ3 4
Email
ññ4 9
,
ññ9 :
ChannelTypes
óó 
=
óó 
new
óó "
List
óó# '
<
óó' (
ChannelType
óó( 3
>
óó3 4
{
óó5 6
}
óó7 8
}
ôô 
;
ôô 
ViewBag
öö 
.
öö 
TestingUrgency
öö "
=
öö# $
new
öö% (

SelectList
öö) 3
(
öö3 4

EnumHelper
öö4 >
.
öö> ?
GetEnumTextValues
öö? P
(
ööP Q
typeof
ööQ W
(
ööW X
TestingUrgency
ööX f
)
ööf g
)
öög h
,
ööh i
$str
ööj q
,
ööq r
$str
õõ 
,
õõ 
model
õõ 
.
õõ 
TestingUrgency
õõ ,
)
õõ, -
;
õõ- .
ViewBag
úú 
.
úú 

WhiteLabel
úú 
=
úú  
new
úú! $

SelectList
úú% /
(
úú/ 0
CustomersList
úú0 =
,
úú= >
$str
úú? F
,
úúF G
$str
úúH N
,
úúN O
LoggedInUser
úúP \
?
úú\ ]
.
úú] ^

WhiteLabel
úú^ h
)
úúh i
;
úúi j
return
ùù 
View
ùù 
(
ùù 
model
ùù 
)
ùù 
;
ùù 
}
ûû 	
[
££ 	
HttpPost
££	 
]
££ 
[
§§ 	&
ValidateAntiForgeryToken
§§	 !
]
§§! "
public
•• 
ActionResult
•• 
Create
•• "
(
••" #
[
¶¶ 
Bind
¶¶ 
(
¶¶ 
Include
ßß 
=
ßß 
$str®® ∑
)®®∑ ∏
]®®∏ π

CampaignVm®®∫ ƒ

campaignVm®®≈ œ
)®®œ –
{
©© 	
if
™™ 
(
™™ 

ModelState
™™ 
.
™™ 
IsValid
™™ "
)
™™" #
{
´´ 
try
¨¨ 
{
≠≠ 
var
ØØ 
camps
ØØ 
=
ØØ 
Db
ØØ  "
.
ØØ" #
	Campaigns
ØØ# ,
.
ØØ, -
ToList
ØØ- 3
(
ØØ3 4
)
ØØ4 5
;
ØØ5 6
int
∞∞ 
newOrderNumber
∞∞ &
=
∞∞' (
camps
∞∞) .
.
∞∞. /
Count
∞∞/ 4
>
∞∞5 6
$num
∞∞7 8
?
±± 
camps
±± 
.
±±  
Max
±±  #
(
±±# $
x
±±$ %
=>
±±& (
int
±±) ,
.
±±, -
Parse
±±- 2
(
±±2 3
x
±±3 4
.
±±4 5
OrderNumber
±±5 @
.
±±@ A
TrimEnd
±±A H
(
±±H I
$str
±±I N
.
±±N O
ToCharArray
±±O Z
(
±±Z [
)
±±[ \
)
±±\ ]
)
±±] ^
)
±±^ _
+
±±` a
$num
±±b c
:
≤≤ 
$num
≤≤ 
;
≤≤ 
string
¥¥ 
userName
¥¥ #
=
¥¥$ %
LoggedInUser
¥¥& 2
?
¥¥2 3
.
¥¥3 4
UserName
¥¥4 <
;
¥¥< =

TinyMapper
∂∂ 
.
∂∂ 
Bind
∂∂ #
<
∂∂# $

CampaignVm
∂∂$ .
,
∂∂. /
Campaign
∂∂0 8
>
∂∂8 9
(
∂∂9 :
config
∂∂: @
=>
∂∂A C
{
∑∑ 
config
∏∏ 
.
∏∏ 
Ignore
∏∏ %
(
∏∏% &
x
∏∏& '
=>
∏∏( *
x
∏∏+ ,
.
∏∏, -
Segments
∏∏- 5
)
∏∏5 6
;
∏∏6 7
config
ππ 
.
ππ 
Ignore
ππ %
(
ππ% &
x
ππ& '
=>
ππ( *
x
ππ+ ,
.
ππ, -
ChannelTypes
ππ- 9
)
ππ9 :
;
ππ: ;
}
∫∫ 
)
∫∫ 
;
∫∫ 
var
ºº 
campaign
ºº  
=
ºº! "

TinyMapper
ºº# -
.
ºº- .
Map
ºº. 1
<
ºº1 2
Campaign
ºº2 :
>
ºº: ;
(
ºº; <

campaignVm
ºº< F
)
ººF G
;
ººG H
char
ΩΩ 
c2
ΩΩ 
=
ΩΩ 
$char
ΩΩ !
;
ΩΩ! "
foreach
ææ 
(
ææ 
var
ææ  
	segmentVm
ææ! *
in
ææ+ -

campaignVm
ææ. 8
.
ææ8 9
Segments
ææ9 A
)
ææA B
{
øø 
var
¿¿ 
segment
¿¿ #
=
¿¿$ %

TinyMapper
¿¿& 0
.
¿¿0 1
Map
¿¿1 4
<
¿¿4 5
CampaignSegment
¿¿5 D
>
¿¿D E
(
¿¿E F
	segmentVm
¿¿F O
)
¿¿O P
;
¿¿P Q
segment
¡¡ 
.
¡¡  
Id
¡¡  "
=
¡¡# $
Guid
¡¡% )
.
¡¡) *
NewGuid
¡¡* 1
(
¡¡1 2
)
¡¡2 3
;
¡¡3 4
segment
¬¬ 
.
¬¬  
	CreatedAt
¬¬  )
=
¬¬* +
DateTime
¬¬, 4
.
¬¬4 5
Now
¬¬5 8
;
¬¬8 9
segment
√√ 
.
√√  
OrderNumber
√√  +
=
√√, -
$str
√√. 0
+
√√1 2
newOrderNumber
√√3 A
;
√√A B
segment
ƒƒ 
.
ƒƒ  
SegmentNumber
ƒƒ  -
=
ƒƒ. /
newOrderNumber
ƒƒ0 >
+
ƒƒ? @
$str
ƒƒA C
+
ƒƒD E
c2
ƒƒF H
++
ƒƒH J
;
ƒƒJ K
campaign
≈≈  
.
≈≈  !
Segments
≈≈! )
.
≈≈) *
Add
≈≈* -
(
≈≈- .
segment
≈≈. 5
)
≈≈5 6
;
≈≈6 7
}
∆∆ 
campaign
«« 
.
«« 
Id
«« 
=
««  !
Guid
««" &
.
««& '
NewGuid
««' .
(
««. /
)
««/ 0
;
««0 1
campaign
»» 
.
»» 
	CreatedAt
»» &
=
»»' (
DateTime
»») 1
.
»»1 2
Now
»»2 5
;
»»5 6
campaign
…… 
.
…… 
	CreatedBy
…… &
=
……' (
userName
……) 1
;
……1 2
campaign
   
.
   
OrderNumber
   (
=
  ) *
newOrderNumber
  + 9
.
  9 :
ToString
  : B
(
  B C
)
  C D
;
  D E
campaign
ÀÀ 
.
ÀÀ 
IP
ÀÀ 
=
ÀÀ  !
Request
ÀÀ" )
.
ÀÀ) *
ServerVariables
ÀÀ* 9
[
ÀÀ9 :
$str
ÀÀ: G
]
ÀÀG H
;
ÀÀH I
campaign
ÃÃ 
.
ÃÃ 
Browser
ÃÃ $
=
ÃÃ% &
Request
ÃÃ' .
.
ÃÃ. /
	UserAgent
ÃÃ/ 8
;
ÃÃ8 9
campaign
ÕÕ 
.
ÕÕ 
OS
ÕÕ 
=
ÕÕ  !
Environment
ÕÕ" -
.
ÕÕ- .
	OSVersion
ÕÕ. 7
.
ÕÕ7 8
Platform
ÕÕ8 @
+
ÕÕA B
$str
ÕÕC F
+
ÕÕG H
Environment
ÕÕI T
.
ÕÕT U
	OSVersion
ÕÕU ^
.
ÕÕ^ _
VersionString
ÕÕ_ l
;
ÕÕl m
campaign
ŒŒ 
.
ŒŒ 
Referrer
ŒŒ %
=
ŒŒ& '
Request
ŒŒ( /
.
ŒŒ/ 0
UrlReferrer
ŒŒ0 ;
.
ŒŒ; <
AbsolutePath
ŒŒ< H
;
ŒŒH I
campaign
œœ 
.
œœ 
ChannelTypes
œœ )
=
œœ* +

campaignVm
œœ, 6
.
œœ6 7
ChannelTypes
œœ7 C
==
œœD F
null
œœG K
?
œœL M
null
œœN R
:
œœS T
string
–– 
.
–– 
Join
–– #
(
––# $
$str
––$ '
,
––' (

campaignVm
––) 3
.
––3 4
ChannelTypes
––4 @
)
––@ A
;
––A B
campaign
—— 
.
—— 
Assets
—— #
.
——# $
Id
——$ &
=
——' (
Guid
——) -
.
——- .
NewGuid
——. 5
(
——5 6
)
——6 7
;
——7 8
campaign
““ 
.
““ 
Assets
““ #
.
““# $

CampaignId
““$ .
=
““/ 0
campaign
““1 9
.
““9 :
Id
““: <
;
““< =
campaign
”” 
.
”” 
Assets
”” #
.
””# $
	CreatedAt
””$ -
=
””. /
DateTime
””0 8
.
””8 9
Now
””9 <
;
””< =
campaign
‘‘ 
.
‘‘ 
Assets
‘‘ #
.
‘‘# $
	CreatedBy
‘‘$ -
=
‘‘. /
userName
‘‘0 8
;
‘‘8 9
Db
÷÷ 
.
÷÷ 
	Campaigns
÷÷  
.
÷÷  !
Add
÷÷! $
(
÷÷$ %
campaign
÷÷% -
)
÷÷- .
;
÷÷. /
Db
◊◊ 
.
◊◊ 
SaveChanges
◊◊ "
(
◊◊" #
)
◊◊# $
;
◊◊$ %
BackgroundJob
ŸŸ !
.
ŸŸ! "
Enqueue
ŸŸ" )
(
ŸŸ) *
(
ŸŸ* +
)
ŸŸ+ ,
=>
ŸŸ- /
CampaignProcessor
ŸŸ0 A
.
ŸŸA B
ProcessNewOrder
ŸŸB Q
(
ŸŸQ R
campaign
ŸŸR Z
.
ŸŸZ [
OrderNumber
ŸŸ[ f
,
ŸŸf g
userName
ŸŸh p
)
ŸŸp q
)
ŸŸq r
;
ŸŸr s
ForceOrders
€€ 
=
€€  !
true
€€" &
;
€€& '
TempData
‹‹ 
[
‹‹ 
$str
‹‹ &
]
‹‹& '
=
‹‹( )
$str
‹‹* 5
+
‹‹5 6
campaign
‹‹7 ?
.
‹‹? @
OrderNumber
‹‹@ K
+
‹‹L M
$str
‹‹N \
+
‹‹] ^
campaign
‹‹_ g
.
‹‹g h
CampaignName
‹‹h t
+
‹‹u v
$str‹‹w ô
;‹‹ô ö
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ  
ex
ﬁﬁ! #
)
ﬁﬁ# $
{
ﬂﬂ 
TempData
‡‡ 
[
‡‡ 
$str
‡‡ $
]
‡‡$ %
=
‡‡& '
$str
‡‡( M
+
‡‡N O
ex
‡‡P R
.
‡‡R S
Message
‡‡S Z
;
‡‡Z [
}
·· 
return
‚‚ 
RedirectToAction
‚‚ '
(
‚‚' (
$str
‚‚( /
)
‚‚/ 0
;
‚‚0 1
}
„„ 

campaignVm
‰‰ 
.
‰‰ 
ChannelTypes
‰‰ #
=
‰‰$ %

campaignVm
‰‰& 0
.
‰‰0 1
ChannelTypes
‰‰1 =
??
‰‰> @
new
‰‰A D
List
‰‰E I
<
‰‰I J
ChannelType
‰‰J U
>
‰‰U V
{
‰‰W X
}
‰‰X Y
;
‰‰Y Z
ViewBag
ÊÊ 
.
ÊÊ 
TestingUrgency
ÊÊ "
=
ÊÊ# $
new
ÊÊ% (

SelectList
ÊÊ) 3
(
ÊÊ3 4

EnumHelper
ÊÊ4 >
.
ÊÊ> ?
GetEnumTextValues
ÊÊ? P
(
ÊÊP Q
typeof
ÊÊQ W
(
ÊÊW X
TestingUrgency
ÊÊX f
)
ÊÊf g
)
ÊÊg h
,
ÊÊh i
$str
ÊÊj q
,
ÊÊq r
$str
ÁÁ 
,
ÁÁ 

campaignVm
ÁÁ "
.
ÁÁ" #
TestingUrgency
ÁÁ# 1
)
ÁÁ1 2
;
ÁÁ2 3
ViewBag
ËË 
.
ËË 

WhiteLabel
ËË 
=
ËË  
new
ËË! $

SelectList
ËË% /
(
ËË/ 0
CustomersList
ËË0 =
,
ËË= >
$str
ËË? F
,
ËËF G
$str
ËËH N
,
ËËN O
LoggedInUser
ËËP \
?
ËË\ ]
.
ËË] ^

WhiteLabel
ËË^ h
)
ËËh i
;
ËËi j
return
ÈÈ 
View
ÈÈ 
(
ÈÈ 

campaignVm
ÈÈ "
)
ÈÈ" #
;
ÈÈ# $
}
ÍÍ 	
public
ÓÓ 
ActionResult
ÓÓ 
Edit
ÓÓ  
(
ÓÓ  !
Guid
ÓÓ! %
?
ÓÓ% &
id
ÓÓ' )
)
ÓÓ) *
{
ÔÔ 	
if
 
(
 
id
 
==
 
null
 
)
 
{
ÒÒ 
throw
ÚÚ 
new
ÚÚ 
HttpException
ÚÚ '
(
ÚÚ' (
$num
ÚÚ( +
,
ÚÚ+ ,
$str
ÚÚ- :
)
ÚÚ: ;
;
ÚÚ; <
}
ÛÛ 
Campaign
ÙÙ 
campaign
ÙÙ 
=
ÙÙ 
Db
ÙÙ  "
.
ÙÙ" #
	Campaigns
ÙÙ# ,
.
ÙÙ, -
Find
ÙÙ- 1
(
ÙÙ1 2
id
ÙÙ2 4
)
ÙÙ4 5
;
ÙÙ5 6
if
ıı 
(
ıı 
campaign
ıı 
==
ıı 
null
ıı  
)
ıı  !
{
ˆˆ 
throw
˜˜ 
new
˜˜ 
HttpException
˜˜ '
(
˜˜' (
$num
˜˜( +
,
˜˜+ ,
$str
˜˜- 8
)
˜˜8 9
;
˜˜9 :
}
¯¯ 
ViewBag
˘˘ 
.
˘˘ 
TestingUrgency
˘˘ "
=
˘˘# $
new
˘˘% (

SelectList
˘˘) 3
(
˘˘3 4

EnumHelper
˘˘4 >
.
˘˘> ?
GetEnumTextValues
˘˘? P
(
˘˘P Q
typeof
˘˘Q W
(
˘˘W X
TestingUrgency
˘˘X f
)
˘˘f g
)
˘˘g h
,
˘˘h i
$str
˘˘j q
,
˘˘q r
$str
˙˙ 
,
˙˙ 
campaign
˙˙  
.
˙˙  !
TestingUrgency
˙˙! /
)
˙˙/ 0
;
˙˙0 1
ViewBag
˚˚ 
.
˚˚ 
Status
˚˚ 
=
˚˚ 
new
˚˚  

SelectList
˚˚! +
(
˚˚+ ,

EnumHelper
˚˚, 6
.
˚˚6 7
GetEnumTextValues
˚˚7 H
(
˚˚H I
typeof
˚˚I O
(
˚˚O P
CampaignStatus
˚˚P ^
)
˚˚^ _
)
˚˚_ `
,
˚˚` a
$str
˚˚b i
,
˚˚i j
$str
˚˚k q
,
˚˚q r
campaign
¸¸ 
.
¸¸ 
Status
¸¸ 
)
¸¸  
;
¸¸  !
return
˝˝ 
View
˝˝ 
(
˝˝ 
campaign
˝˝  
)
˝˝  !
;
˝˝! "
}
˛˛ 	
[
ÉÉ 	
HttpPost
ÉÉ	 
]
ÉÉ 
[
ÑÑ 	&
ValidateAntiForgeryToken
ÑÑ	 !
]
ÑÑ! "
public
ÖÖ 
ActionResult
ÖÖ 
Edit
ÖÖ  
(
ÖÖ  !
[
ÜÜ 
Bind
ÜÜ 
(
ÜÜ 
Include
áá 
=
áá 
$stràà Å
)
ââ 
]
ââ 
Campaign
ââ 
campaign
ââ !
)
ââ! "
{
ää 	
if
ãã 
(
ãã 

ModelState
ãã 
.
ãã 
IsValid
ãã "
)
ãã" #
{
åå 
Db
çç 
.
çç 
Entry
çç 
(
çç 
campaign
çç !
)
çç! "
.
çç" #
State
çç# (
=
çç) *
EntityState
çç+ 6
.
çç6 7
Modified
çç7 ?
;
çç? @
Db
éé 
.
éé 
SaveChanges
éé 
(
éé 
)
éé  
;
éé  !
return
èè 
RedirectToAction
èè '
(
èè' (
$str
èè( /
)
èè/ 0
;
èè0 1
}
êê 
ViewBag
ëë 
.
ëë 
TestingUrgency
ëë "
=
ëë# $
new
ëë% (

SelectList
ëë) 3
(
ëë3 4

EnumHelper
ëë4 >
.
ëë> ?
GetEnumTextValues
ëë? P
(
ëëP Q
typeof
ëëQ W
(
ëëW X
TestingUrgency
ëëX f
)
ëëf g
)
ëëg h
,
ëëh i
$str
ëëj q
,
ëëq r
$str
íí 
,
íí 
campaign
íí  
.
íí  !
TestingUrgency
íí! /
)
íí/ 0
;
íí0 1
ViewBag
ìì 
.
ìì 
Status
ìì 
=
ìì 
new
ìì  

SelectList
ìì! +
(
ìì+ ,

EnumHelper
ìì, 6
.
ìì6 7
GetEnumTextValues
ìì7 H
(
ììH I
typeof
ììI O
(
ììO P
CampaignStatus
ììP ^
)
ìì^ _
)
ìì_ `
,
ìì` a
$str
ììb i
,
ììi j
$str
ììk q
,
ììq r
campaign
îî 
.
îî 
Status
îî 
)
îî  
;
îî  !
return
ïï 
View
ïï 
(
ïï 
campaign
ïï  
)
ïï  !
;
ïï! "
}
ññ 	
public
òò 
ActionResult
òò 
Clone
òò !
(
òò! "
Guid
òò" &
?
òò& '
id
òò( *
)
òò* +
{
ôô 	
Campaign
öö 
campaign
öö 
=
öö 
Db
öö  "
.
öö" #
	Campaigns
öö# ,
.
öö, -
Find
öö- 1
(
öö1 2
id
öö2 4
)
öö4 5
;
öö5 6
if
õõ 
(
õõ 
campaign
õõ 
==
õõ 
null
õõ  
)
õõ  !
{
úú 
throw
ùù 
new
ùù 
HttpException
ùù '
(
ùù' (
$num
ùù( +
,
ùù+ ,
$str
ùù- 8
)
ùù8 9
;
ùù9 :
}
ûû 
return
üü 
View
üü 
(
üü 
$str
üü 
,
üü  
campaign
üü! )
)
üü) *
;
üü* +
}
†† 	
[
¢¢ 	
HttpPost
¢¢	 
,
¢¢ 

ActionName
¢¢ 
(
¢¢ 
$str
¢¢ %
)
¢¢% &
]
¢¢& '
[
££ 	&
ValidateAntiForgeryToken
££	 !
]
££! "
public
§§ 
ActionResult
§§ 
CloneConfirmed
§§ *
(
§§* +
Guid
§§+ /
id
§§0 2
)
§§2 3
{
•• 	
var
¶¶ 
camps
¶¶ 
=
¶¶ 
Db
¶¶ 
.
¶¶ 
	Campaigns
¶¶ $
.
¶¶$ %
ToList
¶¶% +
(
¶¶+ ,
)
¶¶, -
;
¶¶- .
int
ßß 
newOrderNumber
ßß 
=
ßß  
camps
ßß! &
.
ßß& '
Count
ßß' ,
>
ßß- .
$num
ßß/ 0
?
ßß1 2
camps
ßß3 8
.
ßß8 9
Max
ßß9 <
(
ßß< =
x
ßß= >
=>
ßß? A
int
ßßB E
.
ßßE F
Parse
ßßF K
(
ßßK L
x
ßßL M
.
ßßM N
OrderNumber
ßßN Y
.
ßßY Z
TrimEnd
ßßZ a
(
ßßa b
$str
ßßb g
.
ßßg h
ToCharArray
ßßh s
(
ßßs t
)
ßßt u
)
ßßu v
)
ßßv w
)
ßßw x
+
ßßy z
$num
ßß{ |
:
ßß} ~
$numßß É
;ßßÉ Ñ
Campaign
©© 
campaign
©© 
=
©© 
Db
©©  "
.
©©" #
	Campaigns
©©# ,
.
™™ 
Include
™™ 
(
™™ 
x
™™ 
=>
™™ 
x
™™ 
.
™™  
Assets
™™  &
)
™™& '
.
´´ 
Include
´´ 
(
´´ 
x
´´ 
=>
´´ 
x
´´ 
.
´´  
Segments
´´  (
)
´´( )
.
¨¨ 
Include
¨¨ 
(
¨¨ 
x
¨¨ 
=>
¨¨ 
x
¨¨ 
.
¨¨  
Testing
¨¨  '
)
¨¨' (
.
≠≠ 
Include
≠≠ 
(
≠≠ 
x
≠≠ 
=>
≠≠ 
x
≠≠ 
.
≠≠  
Approved
≠≠  (
)
≠≠( )
.
ÆÆ 
FirstOrDefault
ÆÆ 
(
ÆÆ  
x
ÆÆ  !
=>
ÆÆ" $
x
ÆÆ% &
.
ÆÆ& '
Id
ÆÆ' )
==
ÆÆ* ,
id
ÆÆ- /
)
ÆÆ/ 0
;
ÆÆ0 1
var
∞∞ 
copyId
∞∞ 
=
∞∞ 
Guid
∞∞ 
.
∞∞ 
NewGuid
∞∞ %
(
∞∞% &
)
∞∞& '
;
∞∞' (
var
±± 
copy
±± 
=
±± 
new
±± 
Campaign
±± #
(
±±# $
)
±±$ %
;
±±% &
Db
≤≤ 
.
≤≤ 
	Campaigns
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
copy
≤≤ !
)
≤≤! "
;
≤≤" #
Db
≥≥ 
.
≥≥ 
Entry
≥≥ 
(
≥≥ 
copy
≥≥ 
)
≥≥ 
.
≥≥ 
CurrentValues
≥≥ (
.
≥≥( )
	SetValues
≥≥) 2
(
≥≥2 3
Db
≥≥3 5
.
≥≥5 6
Entry
≥≥6 ;
(
≥≥; <
campaign
≥≥< D
)
≥≥D E
.
≥≥E F
CurrentValues
≥≥F S
)
≥≥S T
;
≥≥T U
copy
¥¥ 
.
¥¥ 
Id
¥¥ 
=
¥¥ 
copyId
¥¥ 
;
¥¥ 
copy
µµ 
.
µµ 
	CreatedAt
µµ 
=
µµ 
DateTime
µµ %
.
µµ% &
Now
µµ& )
;
µµ) *
copy
∂∂ 
.
∂∂ 
OrderNumber
∂∂ 
=
∂∂ 
newOrderNumber
∂∂ -
.
∂∂- .
ToString
∂∂. 6
(
∂∂6 7
)
∂∂7 8
;
∂∂8 9
copy
∑∑ 
.
∑∑ 
Status
∑∑ 
=
∑∑ 
(
∑∑ 
int
∑∑ 
)
∑∑ 
CampaignStatus
∑∑ -
.
∑∑- .
OrderRecevied
∑∑. ;
;
∑∑; <
copy
∏∏ 
.
∏∏ 
	TestingId
∏∏ 
=
∏∏ 
null
∏∏ !
;
∏∏! "
copy
ππ 
.
ππ 

ApprovedId
ππ 
=
ππ 
null
ππ "
;
ππ" #
Db
∫∫ 
.
∫∫ 
SaveChanges
∫∫ 
(
∫∫ 
)
∫∫ 
;
∫∫ 
var
ºº 

copyAssets
ºº 
=
ºº 
new
ºº  
CampaignAsset
ºº! .
(
ºº. /
)
ºº/ 0
;
ºº0 1
Db
ΩΩ 
.
ΩΩ 
CampaignAssets
ΩΩ 
.
ΩΩ 
Add
ΩΩ !
(
ΩΩ! "

copyAssets
ΩΩ" ,
)
ΩΩ, -
;
ΩΩ- .
Db
ææ 
.
ææ 
Entry
ææ 
(
ææ 

copyAssets
ææ 
)
ææ  
.
ææ  !
CurrentValues
ææ! .
.
ææ. /
	SetValues
ææ/ 8
(
ææ8 9
Db
ææ9 ;
.
ææ; <
Entry
ææ< A
(
ææA B
campaign
ææB J
.
ææJ K
Assets
ææK Q
)
ææQ R
.
ææR S
CurrentValues
ææS `
)
ææ` a
;
ææa b

copyAssets
øø 
.
øø 
Id
øø 
=
øø 
Guid
øø  
.
øø  !
NewGuid
øø! (
(
øø( )
)
øø) *
;
øø* +

copyAssets
¿¿ 
.
¿¿ 

CampaignId
¿¿ !
=
¿¿" #
copyId
¿¿$ *
;
¿¿* +

copyAssets
¡¡ 
.
¡¡ 
	CreatedAt
¡¡  
=
¡¡! "
DateTime
¡¡# +
.
¡¡+ ,
Now
¡¡, /
;
¡¡/ 0
Db
¬¬ 
.
¬¬ 
SaveChanges
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
copy
√√ 
.
√√ 
AssetsId
√√ 
=
√√ 

copyAssets
√√ &
.
√√& '
Id
√√' )
;
√√) *
Db
ƒƒ 
.
ƒƒ 
SaveChanges
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ 
foreach
∆∆ 
(
∆∆ 
var
∆∆ 
segment
∆∆  
in
∆∆! #
campaign
∆∆$ ,
.
∆∆, -
Segments
∆∆- 5
.
∆∆5 6
ToList
∆∆6 <
(
∆∆< =
)
∆∆= >
)
∆∆> ?
{
«« 
var
»» 
copySegment
»» 
=
»»  !
new
»»" %
CampaignSegment
»»& 5
(
»»5 6
)
»»6 7
;
»»7 8
Db
…… 
.
…… 
CampaignSegments
…… #
.
……# $
Add
……$ '
(
……' (
copySegment
……( 3
)
……3 4
;
……4 5
Db
   
.
   
Entry
   
(
   
copySegment
   $
)
  $ %
.
  % &
CurrentValues
  & 3
.
  3 4
	SetValues
  4 =
(
  = >
Db
  > @
.
  @ A
Entry
  A F
(
  F G
segment
  G N
)
  N O
.
  O P
CurrentValues
  P ]
)
  ] ^
;
  ^ _
copySegment
ÀÀ 
.
ÀÀ 
Id
ÀÀ 
=
ÀÀ  
Guid
ÀÀ! %
.
ÀÀ% &
NewGuid
ÀÀ& -
(
ÀÀ- .
)
ÀÀ. /
;
ÀÀ/ 0
copySegment
ÃÃ 
.
ÃÃ 

CampaignId
ÃÃ &
=
ÃÃ' (
copyId
ÃÃ) /
;
ÃÃ/ 0
copySegment
ÕÕ 
.
ÕÕ 
OrderNumber
ÕÕ '
=
ÕÕ( )
$str
ÕÕ* ,
+
ÕÕ- .
newOrderNumber
ÕÕ/ =
;
ÕÕ= >
copySegment
ŒŒ 
.
ŒŒ 
	CreatedAt
ŒŒ %
=
ŒŒ& '
DateTime
ŒŒ( 0
.
ŒŒ0 1
Now
ŒŒ1 4
;
ŒŒ4 5
Db
œœ 
.
œœ 
SaveChanges
œœ 
(
œœ 
)
œœ  
;
œœ  !
}
–– 
if
““ 
(
““ 
campaign
““ 
.
““ 
Testing
““  
!=
““! #
null
““$ (
)
““( )
{
”” 
var
‘‘ 
	testingId
‘‘ 
=
‘‘ 
Guid
‘‘  $
.
‘‘$ %
NewGuid
‘‘% ,
(
‘‘, -
)
‘‘- .
;
‘‘. /
var
’’ 
testing
’’ 
=
’’ 
new
’’ !
CampaignTesting
’’" 1
(
’’1 2
)
’’2 3
;
’’3 4
Db
÷÷ 
.
÷÷ 
CampaignsTesting
÷÷ #
.
÷÷# $
Add
÷÷$ '
(
÷÷' (
testing
÷÷( /
)
÷÷/ 0
;
÷÷0 1
Db
◊◊ 
.
◊◊ 
Entry
◊◊ 
(
◊◊ 
testing
◊◊  
)
◊◊  !
.
◊◊! "
CurrentValues
◊◊" /
.
◊◊/ 0
	SetValues
◊◊0 9
(
◊◊9 :
Db
◊◊: <
.
◊◊< =
Entry
◊◊= B
(
◊◊B C
campaign
◊◊C K
.
◊◊K L
Testing
◊◊L S
)
◊◊S T
.
◊◊T U
CurrentValues
◊◊U b
)
◊◊b c
;
◊◊c d
testing
ÿÿ 
.
ÿÿ 
Id
ÿÿ 
=
ÿÿ 
	testingId
ÿÿ &
;
ÿÿ& '
testing
ŸŸ 
.
ŸŸ 
	CreatedAt
ŸŸ !
=
ŸŸ" #
DateTime
ŸŸ$ ,
.
ŸŸ, -
Now
ŸŸ- 0
;
ŸŸ0 1
testing
⁄⁄ 
.
⁄⁄ 

CampaignId
⁄⁄ "
=
⁄⁄# $
copy
⁄⁄% )
.
⁄⁄) *
Id
⁄⁄* ,
;
⁄⁄, -
Db
€€ 
.
€€ 
SaveChanges
€€ 
(
€€ 
)
€€  
;
€€  !
copy
›› 
.
›› 
	TestingId
›› 
=
››  
	testingId
››! *
;
››* +
Db
ﬁﬁ 
.
ﬁﬁ 
SaveChanges
ﬁﬁ 
(
ﬁﬁ 
)
ﬁﬁ  
;
ﬁﬁ  !
}
ﬂﬂ 
if
·· 
(
·· 
campaign
·· 
.
·· 
Approved
·· !
!=
··" $
null
··% )
)
··) *
{
‚‚ 
var
„„ 

approvedId
„„ 
=
„„  
Guid
„„! %
.
„„% &
NewGuid
„„& -
(
„„- .
)
„„. /
;
„„/ 0
var
‰‰ 
approved
‰‰ 
=
‰‰ 
new
‰‰ "
CampaignApproved
‰‰# 3
(
‰‰3 4
)
‰‰4 5
;
‰‰5 6
Db
ÂÂ 
.
ÂÂ 
CampaignsApproved
ÂÂ $
.
ÂÂ$ %
Add
ÂÂ% (
(
ÂÂ( )
approved
ÂÂ) 1
)
ÂÂ1 2
;
ÂÂ2 3
Db
ÊÊ 
.
ÊÊ 
Entry
ÊÊ 
(
ÊÊ 
approved
ÊÊ !
)
ÊÊ! "
.
ÊÊ" #
CurrentValues
ÊÊ# 0
.
ÊÊ0 1
	SetValues
ÊÊ1 :
(
ÊÊ: ;
Db
ÊÊ; =
.
ÊÊ= >
Entry
ÊÊ> C
(
ÊÊC D
campaign
ÊÊD L
.
ÊÊL M
Approved
ÊÊM U
)
ÊÊU V
.
ÊÊV W
CurrentValues
ÊÊW d
)
ÊÊd e
;
ÊÊe f
approved
ÁÁ 
.
ÁÁ 
Id
ÁÁ 
=
ÁÁ 

approvedId
ÁÁ (
;
ÁÁ( )
approved
ËË 
.
ËË 
	CreatedAt
ËË "
=
ËË# $
DateTime
ËË% -
.
ËË- .
Now
ËË. 1
;
ËË1 2
approved
ÈÈ 
.
ÈÈ 

CampaignId
ÈÈ #
=
ÈÈ$ %
copy
ÈÈ& *
.
ÈÈ* +
Id
ÈÈ+ -
;
ÈÈ- .
Db
ÍÍ 
.
ÍÍ 
SaveChanges
ÍÍ 
(
ÍÍ 
)
ÍÍ  
;
ÍÍ  !
copy
ÏÏ 
.
ÏÏ 

ApprovedId
ÏÏ 
=
ÏÏ  !

approvedId
ÏÏ" ,
;
ÏÏ, -
Db
ÌÌ 
.
ÌÌ 
SaveChanges
ÌÌ 
(
ÌÌ 
)
ÌÌ  
;
ÌÌ  !
}
ÓÓ 
ForceOrders
ÔÔ 
=
ÔÔ 
true
ÔÔ 
;
ÔÔ 
TempData
 
[
 
$str
 
]
 
=
  !
$str
" ,
+
- .
campaign
/ 7
.
7 8
OrderNumber
8 C
+
D E
$str
F c
+
d e
newOrderNumber
f t
+
u v
$strw Ü
;Ü á
return
ÒÒ 
RedirectToAction
ÒÒ #
(
ÒÒ# $
$str
ÒÒ$ +
,
ÒÒ+ ,
$str
ÒÒ- 8
)
ÒÒ8 9
;
ÒÒ9 :
}
ÚÚ 	
public
ıı 
ActionResult
ıı 
Delete
ıı "
(
ıı" #
Guid
ıı# '
?
ıı' (
id
ıı) +
)
ıı+ ,
{
ˆˆ 	
if
˜˜ 
(
˜˜ 
id
˜˜ 
==
˜˜ 
null
˜˜ 
)
˜˜ 
{
¯¯ 
throw
˘˘ 
new
˘˘ 
HttpException
˘˘ '
(
˘˘' (
$num
˘˘( +
,
˘˘+ ,
$str
˘˘- :
)
˘˘: ;
;
˘˘; <
}
˙˙ 
Campaign
˚˚ 
campaign
˚˚ 
=
˚˚ 
Db
˚˚  "
.
˚˚" #
	Campaigns
˚˚# ,
.
˚˚, -
Find
˚˚- 1
(
˚˚1 2
id
˚˚2 4
)
˚˚4 5
;
˚˚5 6
if
¸¸ 
(
¸¸ 
campaign
¸¸ 
==
¸¸ 
null
¸¸  
)
¸¸  !
{
˝˝ 
throw
˛˛ 
new
˛˛ 
HttpException
˛˛ '
(
˛˛' (
$num
˛˛( +
,
˛˛+ ,
$str
˛˛- 8
)
˛˛8 9
;
˛˛9 :
}
ˇˇ 
return
ÄÄ 
View
ÄÄ 
(
ÄÄ 
campaign
ÄÄ  
)
ÄÄ  !
;
ÄÄ! "
}
ÅÅ 	
[
ÑÑ 	
HttpPost
ÑÑ	 
,
ÑÑ 

ActionName
ÑÑ 
(
ÑÑ 
$str
ÑÑ &
)
ÑÑ& '
]
ÑÑ' (
[
ÖÖ 	&
ValidateAntiForgeryToken
ÖÖ	 !
]
ÖÖ! "
public
ÜÜ 
ActionResult
ÜÜ 
DeleteConfirmed
ÜÜ +
(
ÜÜ+ ,
Guid
ÜÜ, 0
id
ÜÜ1 3
)
ÜÜ3 4
{
áá 	
Campaign
àà 
campaign
àà 
=
àà 
Db
àà  "
.
àà" #
	Campaigns
àà# ,
.
àà, -
Find
àà- 1
(
àà1 2
id
àà2 4
)
àà4 5
;
àà5 6
var
ââ 
proDatas
ââ 
=
ââ 
Db
ââ 
.
ââ 
ProDatas
ââ &
.
ââ& '
Where
ââ' ,
(
ââ, -
x
ââ- .
=>
ââ/ 1
x
ââ2 3
.
ââ3 4

CampaignId
ââ4 >
==
ââ? A
campaign
ââB J
.
ââJ K
Id
ââK M
)
ââM N
;
ââN O
foreach
ää 
(
ää 
var
ää 
proData
ää  
in
ää! #
proDatas
ää$ ,
)
ää, -
{
ãã 
Db
åå 
.
åå 
ProDatas
åå 
.
åå 
Remove
åå "
(
åå" #
proData
åå# *
)
åå* +
;
åå+ ,
}
çç 
Db
éé 
.
éé 
SaveChanges
éé 
(
éé 
)
éé 
;
éé 
var
êê 
segments
êê 
=
êê 
Db
êê 
.
êê 
CampaignSegments
êê .
.
êê. /
Where
êê/ 4
(
êê4 5
x
êê5 6
=>
êê7 9
x
êê: ;
.
êê; <

CampaignId
êê< F
==
êêG I
campaign
êêJ R
.
êêR S
Id
êêS U
)
êêU V
;
êêV W
foreach
ëë 
(
ëë 
var
ëë 
segment
ëë  
in
ëë! #
segments
ëë$ ,
)
ëë, -
{
íí 
Db
ìì 
.
ìì 
CampaignSegments
ìì #
.
ìì# $
Remove
ìì$ *
(
ìì* +
segment
ìì+ 2
)
ìì2 3
;
ìì3 4
}
îî 
Db
ïï 
.
ïï 
SaveChanges
ïï 
(
ïï 
)
ïï 
;
ïï 
var
óó 
assets
óó 
=
óó 
Db
óó 
.
óó 
CampaignAssets
óó *
.
óó* +
FirstOrDefault
óó+ 9
(
óó9 :
x
óó: ;
=>
óó< >
x
óó? @
.
óó@ A

CampaignId
óóA K
==
óóL N
campaign
óóO W
.
óóW X
Id
óóX Z
)
óóZ [
;
óó[ \
if
òò 
(
òò 
assets
òò 
!=
òò 
null
òò 
)
òò 
Db
ôô 
.
ôô 
CampaignAssets
ôô !
.
ôô! "
Remove
ôô" (
(
ôô( )
assets
ôô) /
)
ôô/ 0
;
ôô0 1
Db
öö 
.
öö 
SaveChanges
öö 
(
öö 
)
öö 
;
öö 
var
úú 
testing
úú 
=
úú 
Db
úú 
.
úú 
CampaignsTesting
úú -
.
úú- .
FirstOrDefault
úú. <
(
úú< =
x
úú= >
=>
úú? A
x
úúB C
.
úúC D

CampaignId
úúD N
==
úúO Q
campaign
úúR Z
.
úúZ [
Id
úú[ ]
)
úú] ^
;
úú^ _
if
ùù 
(
ùù 
testing
ùù 
!=
ùù 
null
ùù 
)
ùù 
Db
ûû 
.
ûû 
CampaignsTesting
ûû #
.
ûû# $
Remove
ûû$ *
(
ûû* +
testing
ûû+ 2
)
ûû2 3
;
ûû3 4
Db
üü 
.
üü 
SaveChanges
üü 
(
üü 
)
üü 
;
üü 
var
°° 
approved
°° 
=
°° 
Db
°° 
.
°° 
CampaignsApproved
°° /
.
°°/ 0
FirstOrDefault
°°0 >
(
°°> ?
x
°°? @
=>
°°A C
x
°°D E
.
°°E F

CampaignId
°°F P
==
°°Q S
campaign
°°T \
.
°°\ ]
Id
°°] _
)
°°_ `
;
°°` a
if
¢¢ 
(
¢¢ 
approved
¢¢ 
!=
¢¢ 
null
¢¢  
)
¢¢  !
Db
££ 
.
££ 
CampaignsApproved
££ $
.
££$ %
Remove
££% +
(
££+ ,
approved
££, 4
)
££4 5
;
££5 6
Db
§§ 
.
§§ 
SaveChanges
§§ 
(
§§ 
)
§§ 
;
§§ 
Db
¶¶ 
.
¶¶ 
	Campaigns
¶¶ 
.
¶¶ 
Remove
¶¶ 
(
¶¶  
campaign
¶¶  (
)
¶¶( )
;
¶¶) *
Db
ßß 
.
ßß 
SaveChanges
ßß 
(
ßß 
)
ßß 
;
ßß 
ForceOrders
®® 
=
®® 
true
®® 
;
®® 
TempData
©© 
[
©© 
$str
©© 
]
©© 
=
©©  !
$str
©©" +
+
©©, -
campaign
©©. 6
.
©©6 7
OrderNumber
©©7 B
+
©©C D
$str
©©E e
;
©©e f
return
™™ 
RedirectToAction
™™ #
(
™™# $
$str
™™$ +
)
™™+ ,
;
™™, -
}
´´ 	
public
≠≠ 
ActionResult
≠≠ 
Cancel
≠≠ "
(
≠≠" #
Guid
≠≠# '
?
≠≠' (
id
≠≠) +
)
≠≠+ ,
{
ÆÆ 	
if
ØØ 
(
ØØ 
id
ØØ 
==
ØØ 
null
ØØ 
)
ØØ 
{
∞∞ 
throw
±± 
new
±± 
HttpException
±± '
(
±±' (
$num
±±( +
,
±±+ ,
$str
±±- :
)
±±: ;
;
±±; <
}
≤≤ 
Campaign
≥≥ 
campaign
≥≥ 
=
≥≥ 
Db
≥≥  "
.
≥≥" #
	Campaigns
≥≥# ,
.
≥≥, -
Find
≥≥- 1
(
≥≥1 2
id
≥≥2 4
)
≥≥4 5
;
≥≥5 6
if
¥¥ 
(
¥¥ 
campaign
¥¥ 
==
¥¥ 
null
¥¥  
)
¥¥  !
{
µµ 
throw
∂∂ 
new
∂∂ 
HttpException
∂∂ '
(
∂∂' (
$num
∂∂( +
,
∂∂+ ,
$str
∂∂- 8
)
∂∂8 9
;
∂∂9 :
}
∑∑ 
return
∏∏ 
View
∏∏ 
(
∏∏ 
campaign
∏∏  
)
∏∏  !
;
∏∏! "
}
ππ 	
[
ªª 	
HttpPost
ªª	 
,
ªª 

ActionName
ªª 
(
ªª 
$str
ªª &
)
ªª& '
]
ªª' (
[
ºº 	&
ValidateAntiForgeryToken
ºº	 !
]
ºº! "
public
ΩΩ 
ActionResult
ΩΩ 
CancelConfirmed
ΩΩ +
(
ΩΩ+ ,
Guid
ΩΩ, 0
id
ΩΩ1 3
)
ΩΩ3 4
{
ææ 	
var
øø 
campaign
øø 
=
øø 
Db
øø 
.
øø 
	Campaigns
øø '
.
øø' (
Find
øø( ,
(
øø, -
id
øø- /
)
øø/ 0
;
øø0 1
campaign
¿¿ 
.
¿¿ 
Status
¿¿ 
=
¿¿ 
(
¿¿ 
int
¿¿ "
)
¿¿" #
CampaignStatus
¿¿# 1
.
¿¿1 2
	Cancelled
¿¿2 ;
;
¿¿; <
Db
¡¡ 
.
¡¡ 
SaveChanges
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡ 
TempData
¬¬ 
[
¬¬ 
$str
¬¬ 
]
¬¬ 
=
¬¬  !
$str
¬¬" +
+
¬¬, -
campaign
¬¬. 6
.
¬¬6 7
OrderNumber
¬¬7 B
+
¬¬C D
$str
¬¬E g
;
¬¬g h
return
√√ 
RedirectToAction
√√ #
(
√√# $
$str
√√$ +
,
√√+ ,
$str
√√- 8
)
√√8 9
;
√√9 :
}
ƒƒ 	
public
∆∆ 
ActionResult
∆∆ 
Complete
∆∆ $
(
∆∆$ %
Guid
∆∆% )
?
∆∆) *
id
∆∆+ -
)
∆∆- .
{
«« 	
if
»» 
(
»» 
id
»» 
==
»» 
null
»» 
)
»» 
{
…… 
throw
   
new
   
HttpException
   '
(
  ' (
$num
  ( +
,
  + ,
$str
  - :
)
  : ;
;
  ; <
}
ÀÀ 
Campaign
ÃÃ 
campaign
ÃÃ 
=
ÃÃ 
Db
ÃÃ  "
.
ÃÃ" #
	Campaigns
ÃÃ# ,
.
ÃÃ, -
Find
ÃÃ- 1
(
ÃÃ1 2
id
ÃÃ2 4
)
ÃÃ4 5
;
ÃÃ5 6
if
ÕÕ 
(
ÕÕ 
campaign
ÕÕ 
==
ÕÕ 
null
ÕÕ  
)
ÕÕ  !
{
ŒŒ 
throw
œœ 
new
œœ 
HttpException
œœ '
(
œœ' (
$num
œœ( +
,
œœ+ ,
$str
œœ- 8
)
œœ8 9
;
œœ9 :
}
–– 
return
—— 
View
—— 
(
—— 
campaign
——  
)
——  !
;
——! "
}
““ 	
[
‘‘ 	
HttpPost
‘‘	 
,
‘‘ 

ActionName
‘‘ 
(
‘‘ 
$str
‘‘ (
)
‘‘( )
]
‘‘) *
[
’’ 	&
ValidateAntiForgeryToken
’’	 !
]
’’! "
public
÷÷ 
ActionResult
÷÷ 
CompleteConfirmed
÷÷ -
(
÷÷- .
Guid
÷÷. 2
id
÷÷3 5
)
÷÷5 6
{
◊◊ 	
var
ÿÿ 
campaign
ÿÿ 
=
ÿÿ 
Db
ÿÿ 
.
ÿÿ 
	Campaigns
ÿÿ '
.
ÿÿ' (
Include
ÿÿ( /
(
ÿÿ/ 0
x
ÿÿ0 1
=>
ÿÿ2 4
x
ÿÿ5 6
.
ÿÿ6 7
Testing
ÿÿ7 >
)
ÿÿ> ?
.
ÿÿ? @
FirstOrDefault
ÿÿ@ N
(
ÿÿN O
x
ÿÿO P
=>
ÿÿQ S
x
ÿÿT U
.
ÿÿU V
Id
ÿÿV X
==
ÿÿY [
id
ÿÿ\ ^
)
ÿÿ^ _
;
ÿÿ_ `
if
ŸŸ 
(
ŸŸ 
campaign
ŸŸ 
.
ŸŸ 
Testing
ŸŸ  
==
ŸŸ! #
null
ŸŸ$ (
)
ŸŸ( )
{
⁄⁄ 
TempData
€€ 
[
€€ 
$str
€€  
]
€€  !
=
€€" #
$str
€€$ H
;
€€H I
return
‹‹ 
RedirectToAction
‹‹ '
(
‹‹' (
$str
‹‹( /
,
‹‹/ 0
$str
‹‹1 <
)
‹‹< =
;
‹‹= >
}
›› 
var
ﬁﬁ "
notCompletedSegments
ﬁﬁ $
=
ﬁﬁ% &
Db
ﬁﬁ' )
.
ﬁﬁ) *
CampaignSegments
ﬁﬁ* :
.
ﬂﬂ 
Where
ﬂﬂ 
(
ﬂﬂ 
x
ﬂﬂ 
=>
ﬂﬂ 
x
ﬂﬂ 
.
ﬂﬂ 

CampaignId
ﬂﬂ (
==
ﬂﬂ) +
campaign
ﬂﬂ, 4
.
ﬂﬂ4 5
Id
ﬂﬂ5 7
&&
ﬂﬂ8 :
x
ﬂﬂ; <
.
ﬂﬂ< =
SegmentStatus
ﬂﬂ= J
!=
ﬂﬂK M
(
ﬂﬂN O
int
ﬂﬂO R
)
ﬂﬂR S
SegmentStatus
ﬂﬂS `
.
ﬂﬂ` a
Complete
ﬂﬂa i
)
ﬂﬂi j
;
ﬂﬂj k
if
‡‡ 
(
‡‡ "
notCompletedSegments
‡‡ $
.
‡‡$ %
Any
‡‡% (
(
‡‡( )
)
‡‡) *
)
‡‡* +
{
·· 
string
‚‚ 
segments
‚‚ 
=
‚‚  !
string
‚‚" (
.
‚‚( )
Join
‚‚) -
(
‚‚- .
$str
‚‚. 1
,
‚‚1 2"
notCompletedSegments
‚‚3 G
.
‚‚G H
Select
‚‚H N
(
‚‚N O
x
‚‚O P
=>
‚‚Q S
x
‚‚T U
.
‚‚U V
SegmentNumber
‚‚V c
)
‚‚c d
)
‚‚d e
;
‚‚e f
TempData
„„ 
[
„„ 
$str
„„  
]
„„  !
=
„„" #
$str
„„$ /
+
„„0 1
segments
„„2 :
+
„„; <
$str
„„= _
;
„„_ `
return
‰‰ 
RedirectToAction
‰‰ '
(
‰‰' (
$str
‰‰( /
,
‰‰/ 0
$str
‰‰1 <
)
‰‰< =
;
‰‰= >
}
ÂÂ 
campaign
ÊÊ 
.
ÊÊ 
Status
ÊÊ 
=
ÊÊ 
(
ÊÊ 
int
ÊÊ "
)
ÊÊ" #
CampaignStatus
ÊÊ# 1
.
ÊÊ1 2
	Completed
ÊÊ2 ;
;
ÊÊ; <
Db
ÁÁ 
.
ÁÁ 
SaveChanges
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ 
TempData
ËË 
[
ËË 
$str
ËË 
]
ËË 
=
ËË  !
$str
ËË" -
+
ËË. /
campaign
ËË0 8
.
ËË8 9
CampaignName
ËË9 E
+
ËËF G
$str
ËËH j
;
ËËj k
return
ÈÈ 
RedirectToAction
ÈÈ #
(
ÈÈ# $
$str
ÈÈ$ +
,
ÈÈ+ ,
$str
ÈÈ- 8
)
ÈÈ8 9
;
ÈÈ9 :
}
ÍÍ 	
public
ÏÏ 
ActionResult
ÏÏ 
Rebroad
ÏÏ #
(
ÏÏ# $
Guid
ÏÏ$ (
?
ÏÏ( )
id
ÏÏ* ,
)
ÏÏ, -
{
ÌÌ 	
if
ÓÓ 
(
ÓÓ 
id
ÓÓ 
==
ÓÓ 
null
ÓÓ 
)
ÓÓ 
{
ÔÔ 
throw
 
new
 
HttpException
 '
(
' (
$num
( +
,
+ ,
$str
- :
)
: ;
;
; <
}
ÒÒ 
Campaign
ÚÚ 
campaign
ÚÚ 
=
ÚÚ 
Db
ÚÚ  "
.
ÚÚ" #
	Campaigns
ÚÚ# ,
.
ÚÚ, -
Include
ÚÚ- 4
(
ÚÚ4 5
x
ÚÚ5 6
=>
ÚÚ7 9
x
ÚÚ: ;
.
ÚÚ; <
Segments
ÚÚ< D
)
ÚÚD E
.
ÚÚE F
Include
ÚÚF M
(
ÚÚM N
x
ÚÚN O
=>
ÚÚP R
x
ÚÚS T
.
ÚÚT U
	Trackings
ÚÚU ^
)
ÚÚ^ _
.
ÛÛ 
FirstOrDefault
ÛÛ 
(
ÛÛ  
x
ÛÛ  !
=>
ÛÛ" $
x
ÛÛ% &
.
ÛÛ& '
Id
ÛÛ' )
==
ÛÛ* ,
id
ÛÛ- /
)
ÛÛ/ 0
;
ÛÛ0 1
if
ÙÙ 
(
ÙÙ 
campaign
ÙÙ 
==
ÙÙ 
null
ÙÙ  
)
ÙÙ  !
{
ıı 
throw
ˆˆ 
new
ˆˆ 
HttpException
ˆˆ '
(
ˆˆ' (
$num
ˆˆ( +
,
ˆˆ+ ,
$str
ˆˆ- 8
)
ˆˆ8 9
;
ˆˆ9 :
}
˜˜ 
var
¯¯ 
proData
¯¯ 
=
¯¯ 
VendorsList
¯¯ %
.
¯¯% &
FirstOrDefault
¯¯& 4
(
¯¯4 5
x
¯¯5 6
=>
¯¯7 9
x
¯¯: ;
.
¯¯; <
Text
¯¯< @
.
¯¯@ A
Contains
¯¯A I
(
¯¯I J
$str
¯¯J O
)
¯¯O P
)
¯¯P Q
;
¯¯Q R
ViewBag
˘˘ 
.
˘˘ 
Vendor
˘˘ 
=
˘˘ 
new
˘˘  

SelectList
˘˘! +
(
˘˘+ ,
VendorsList
˘˘, 7
,
˘˘7 8
$str
˘˘9 @
,
˘˘@ A
$str
˘˘B H
,
˘˘H I
proData
˘˘J Q
)
˘˘Q R
;
˘˘R S
var
˚˚ 
campaignTracking
˚˚  
=
˚˚! "
campaign
˚˚# +
.
˚˚+ ,
	Trackings
˚˚, 5
.
˚˚5 6
FirstOrDefault
˚˚6 D
(
˚˚D E
x
˚˚E F
=>
˚˚G I
x
˚˚J K
.
˚˚K L
SegmentNumber
˚˚L Y
==
˚˚Z \
string
˚˚] c
.
˚˚c d
Empty
˚˚d i
)
˚˚i j
;
˚˚j k
long
˝˝  
opennedFromOrignal
˝˝ #
=
˝˝$ %
campaignTracking
˝˝& 6
?
˝˝6 7
.
˝˝7 8
Opened
˝˝8 >
??
˝˝? A
campaign
˝˝B J
.
˝˝J K
Quantity
˝˝K S
;
˝˝S T
campaign
˛˛ 
.
˛˛ #
ReBroadcastedQuantity
˛˛ *
=
˛˛+ , 
opennedFromOrignal
˛˛- ?
;
˛˛? @
return
ˇˇ 
View
ˇˇ 
(
ˇˇ 
campaign
ˇˇ  
)
ˇˇ  !
;
ˇˇ! "
}
ÄÄ 	
[
ÇÇ 	
HttpPost
ÇÇ	 
,
ÇÇ 

ActionName
ÇÇ 
(
ÇÇ 
$str
ÇÇ '
)
ÇÇ' (
]
ÇÇ( )
[
ÉÉ 	&
ValidateAntiForgeryToken
ÉÉ	 !
]
ÉÉ! "
public
ÑÑ 
ActionResult
ÑÑ 
RebroadConfirmed
ÑÑ ,
(
ÑÑ, -
Guid
ÑÑ- 1
?
ÑÑ1 2
id
ÑÑ2 4
,
ÑÑ4 5
DateTime
ÑÑ6 >
?
ÑÑ> ?
reBroadcastedDate
ÑÑ@ Q
,
ÑÑQ R
long
ÑÑS W#
reBroadcastedQuantity
ÑÑX m
,
ÑÑm n
Guid
ÑÑo s
?
ÑÑs t
vendor
ÑÑu {
,
ÑÑ{ |
stringÑÑ} É
[ÑÑÉ Ñ
]ÑÑÑ Ö 
segmentsSelectedÑÑÜ ñ
)ÑÑñ ó
{
ÖÖ 	
if
ÜÜ 
(
ÜÜ 
reBroadcastedDate
ÜÜ !
==
ÜÜ" $
null
ÜÜ% )
||
ÜÜ* ,
vendor
ÜÜ- 3
==
ÜÜ4 6
null
ÜÜ7 ;
)
ÜÜ; <
{
áá 
TempData
àà 
[
àà 
$str
àà  
]
àà  !
=
àà" #
$"
àà$ &7
)ReBroadcastedDate and Vendor is required.
àà& O
"
ààO P
;
ààP Q
return
ââ 
RedirectToAction
ââ '
(
ââ' (
$str
ââ( 1
,
ââ1 2
$str
ââ3 >
,
ââ> ?
new
ââ@ C
{
ââD E
id
ââF H
=
ââJ K
id
ââL N
}
ââN O
)
ââO P
;
ââP Q
}
ää 
Campaign
ãã 
campaign
ãã 
=
ãã 
Db
ãã  "
.
ãã" #
	Campaigns
ãã# ,
.
ãã, -
FirstOrDefault
ãã- ;
(
ãã; <
x
ãã< =
=>
ãã> @
x
ããA B
.
ããB C
Id
ããC E
==
ããF H
id
ããI K
)
ããK L
;
ããL M
if
åå 
(
åå 
campaign
åå 
.
åå 
ReBroadcasted
åå &
)
åå& '
{
çç 
TempData
éé 
[
éé 
$str
éé  
]
éé  !
=
éé" #
$"
éé$ &$
Already rebroadcasted.
éé& <
"
éé< =
;
éé= >
return
èè 
RedirectToAction
èè '
(
èè' (
$str
èè( 1
,
èè1 2
$str
èè3 >
,
èè> ?
new
èè@ C
{
èèD E
id
èèF H
=
èèI J
id
èèK M
}
èèN O
)
èèO P
;
èèP Q
}
êê 
campaign
ëë 
.
ëë 
ReBroadcasted
ëë "
=
ëë# $
true
ëë% )
;
ëë) *
campaign
íí 
.
íí 
ReBroadcastedDate
íí &
=
íí' (
reBroadcastedDate
íí) :
;
íí: ;
campaign
ìì 
.
ìì #
ReBroadcastedQuantity
ìì *
=
ìì+ ,#
reBroadcastedQuantity
ìì- B
;
ììB C
campaign
îî 
.
îî &
ReBroadcastedOrderNumber
îî -
=
îî. /
campaign
îî0 8
.
îî8 9
OrderNumber
îî9 D
+
îîE F
$str
îîG L
;
îîL M
Db
ïï 
.
ïï 
SaveChanges
ïï 
(
ïï 
)
ïï 
;
ïï 
BackgroundJob
òò 
.
òò 
Enqueue
òò !
(
òò! "
(
òò" #
)
òò# $
=>
òò% '
CampaignProcessor
òò( 9
.
òò9 :
SendToVendor
òò: F
(
òòF G
OrderVia
òòG O
.
òòO P
Email
òòP U
,
òòU V
vendor
òòW ]
,
òò] ^
campaign
òò_ g
.
òòg h
OrderNumber
òòh s
,
òòs t
segmentsSelectedòòu Ö
,òòÖ Ü
Stringòòá ç
.òòç é
Emptyòòé ì
)òòì î
)òòî ï
;òòï ñ
TempData
öö 
[
öö 
$str
öö 
]
öö 
=
öö  !
$str
öö" ,
+
öö- .
campaign
öö/ 7
.
öö7 8
OrderNumber
öö8 C
+
ööD E
$str
ööF S
+
ööT U
campaign
ööV ^
.
öö^ _
CampaignName
öö_ k
+
ööl m
$ströön ù
;ööù û
return
õõ 
RedirectToAction
õõ #
(
õõ# $
$str
õõ$ +
,
õõ+ ,
$str
õõ- 8
)
õõ8 9
;
õõ9 :
}
úú 	
}
ùù 
}ûû ƒ
NE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\ErrorController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
public 

class 
ErrorController  
:! "
BaseController# 1
{ 
public

 
ActionResult

 
Index

 !
(

! "
)

" #
{ 	
return 
RedirectToAction #
(# $
$str$ 2
,2 3
new4 7
HandleErrorInfo8 G
(G H
newH K
HttpExceptionL Y
(Y Z
$numZ ]
,] ^
$str_ |
)| }
,} ~
$str	 ê
,
ê ë
$str
í ô
)
ô ö
)
ö õ
;
õ ú
} 	
public 

ViewResult 
GenericError &
(& '
HandleErrorInfo' 6
	exception7 @
)@ A
{ 	
return 
View 
( 
$str 
,  
	exception! *
)* +
;+ ,
} 	
public 

ViewResult 
NotFound "
(" #
HandleErrorInfo# 2
	exception3 <
)< =
{ 	
ViewBag 
. 
Title 
= 
$str ,
;, -
return 
View 
( 
$str 
,  
new! $
HandleErrorInfo% 4
(4 5
new5 8
HttpException9 F
(F G
$numG J
,J K
$strL \
)\ ]
,] ^
$str_ p
,p q
$strr y
)y z
)z {
;{ |
} 	
public 

ViewResult 

BadRequest $
($ %
HandleErrorInfo% 4
	exception5 >
)> ?
{ 	
ViewBag 
. 
Title 
= 
$str .
;. /
return 
View 
( 
$str 
,  
new! $
HandleErrorInfo% 4
(4 5
new5 8
HttpException9 F
(F G
$numG J
,J K
$strL ^
)^ _
,_ `
$stra r
,r s
$strt {
){ |
)| }
;} ~
} 	
public   

ViewResult   
NotAuthorized   '
(  ' (
)  ( )
{!! 	
ViewBag"" 
."" 
Title"" 
="" 
$str"" 4
;""4 5
return## 
View## 
(## 
$str## 
)##  
;##  !
}$$ 	
}%% 
}&& ƒg
ME:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\FileController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{		 
public

 

sealed

 
class

 
FileController

 &
:

' (
BaseController

) 7
{ 
[ 	
HttpPost	 
] 
public 

JsonResult 

UploadFile $
($ %
UploadFileVm% 1
fileVm2 8
)8 9
{ 	
string 
amazonFileKey  
=! "
$str# %
,% &
filePath' /
=0 1
$str2 4
;4 5
try 
{ 
if 
( 
Request 
. 
Files !
.! "
Count" '
==( *
$num+ ,
), -
throw. 3
new4 7
AdsException8 D
(D E
$strE \
)\ ]
;] ^
var 
fileContent 
=  !
Request" )
.) *
Files* /
[/ 0
$num0 1
]1 2
;2 3
if 
( 
fileContent 
!=  "
null# '
&&( *
fileContent+ 6
.6 7
ContentLength7 D
>E F
$numG H
)H I
{ 
var 
stream 
=  
fileContent! ,
., -
InputStream- 8
;8 9
filePath 
= 
Path #
.# $
Combine$ +
(+ ,

UploadPath, 6
,6 7
fileContent8 C
.C D
FileNameD L
)L M
;M N
using 
( 
var 

fileStream )
=* +
System, 2
.2 3
IO3 5
.5 6
File6 :
.: ;
Create; A
(A B
filePathB J
)J K
)K L
{ 
stream 
. 
CopyTo %
(% &

fileStream& 0
)0 1
;1 2
} 
if 
( 
! 
fileVm 
.  
IsValid  '
(' (
filePath( 0
)0 1
)1 2
{   
throw!! 
new!! !
AdsException!!" .
(!!. /
fileVm!!/ 5
.!!5 6
FileType!!6 >
+!!? @
$str!!A k
)!!k l
;!!l m
}"" 
if$$ 
($$ 
fileVm$$ 
.$$ 
FileType$$ '
==$$( *
$str$$+ 8
)$$8 9
{%% 
string&& 
logoFileName&& +
=&&, -

FileHelper'' &
.''& '
GetValidFileName''' 7
(''7 8
LoggedInUser''8 D
?''D E
.''E F
Id''F H
+''I J
Path''K O
.''O P
GetExtension''P \
(''\ ]
fileContent''] h
.''h i
FileName''i q
)''q r
)''r s
;''s t
string(( 
logoFilePath(( +
=((, -
Path((. 2
.((2 3
Combine((3 :
(((: ;

ImagesPath((; E
,((E F
logoFileName((G S
)((S T
;((T U
System)) 
.)) 
IO)) !
.))! "
File))" &
.))& '
Copy))' +
())+ ,
filePath)), 4
,))4 5
logoFilePath))6 B
,))B C
true))D H
)))H I
;))I J
amazonFileKey** %
=**& '
logoFileName**( 4
;**4 5
}++ 
else,, 
if,, 
(,, 
string,, #
.,,# $
IsNullOrEmpty,,$ 1
(,,1 2
fileVm,,2 8
.,,8 9
OrderNumber,,9 D
),,D E
),,E F
{-- 
amazonFileKey.. %
=..& '
$"..( *
{..* +
DateTime..+ 3
...3 4
Now..4 7
:..7 8
yyyyMMddHHmmss..8 F
}..F G
_..G H
{..H I
fileContent..I T
...T U
FileName..U ]
}..] ^
"..^ _
;.._ `
S3FileManager// %
.//% &
Upload//& ,
(//, -
amazonFileKey//- :
,//: ;
filePath//< D
)//D E
;//E F
}00 
else11 
if11 
(11 
!11 
string11 $
.11$ %
IsNullOrEmpty11% 2
(112 3
fileVm113 9
.119 :
SegmentNumber11: G
)11G H
)11H I
{33 
amazonFileKey44 %
=44& '
$"44( *
{44* +
fileVm44+ 1
.441 2
OrderNumber442 =
}44= >
/44> ?
{44? @
fileVm44@ F
.44F G
SegmentNumber44G T
}44T U
	_html.zip44U ^
"44^ _
;44_ `
S3FileManager55 %
.55% &
Upload55& ,
(55, -
amazonFileKey55- :
,55: ;
filePath55< D
,55D E
true55F J
,55J K
true55L P
)55P Q
;55Q R
}66 
else77 
{88 
switch99 
(99  
fileVm99  &
.99& '
FileType99' /
)99/ 0
{:: 
case;;  
$str;;! 7
:;;7 8
amazonFileKey<<  -
=<<. /
string<<0 6
.<<6 7
Format<<7 =
(<<= >
$str<<> P
,<<P Q
fileVm<<R X
.<<X Y
OrderNumber<<Y d
)<<d e
;<<e f
break==  %
;==% &
case>>  
$str>>! 5
:>>5 6
amazonFileKey??  -
=??. /
string??0 6
.??6 7
Format??7 =
(??= >
$str??> N
,??N O
fileVm??P V
.??V W
OrderNumber??W b
)??b c
;??c d
break@@  %
;@@% &
caseAA  
$strAA! 6
:AA6 7
amazonFileKeyBB  -
=BB. /
stringBB0 6
.BB6 7
FormatBB7 =
(BB= >
$strBB> O
,BBO P
fileVmBBQ W
.BBW X
OrderNumberBBX c
)BBc d
;BBd e
breakCC  %
;CC% &
caseDD  
$strDD! 6
:DD6 7
amazonFileKeyEE  -
=EE. /
stringEE0 6
.EE6 7
FormatEE7 =
(EE= >
$strEE> O
,EEO P
fileVmEEQ W
.EEW X
OrderNumberEEX c
)EEc d
;EEd e
breakFF  %
;FF% &
caseGG  
$strGG! 5
:GG5 6
amazonFileKeyHH  -
=HH. /
stringHH0 6
.HH6 7
FormatHH7 =
(HH= >
$strHH> Q
,HHQ R
fileVmHHS Y
.HHY Z
OrderNumberHHZ e
,HHe f
PathII$ (
.II( )
GetExtensionII) 5
(II5 6
filePathII6 >
)II> ?
)II? @
;II@ A
breakJJ  %
;JJ% &
caseKK  
$strKK! 9
:KK9 :
amazonFileKeyLL  -
=LL. /
stringLL0 6
.LL6 7
FormatLL7 =
(LL= >
$strLL> V
,LLV W
fileVmLLX ^
.LL^ _
OrderNumberLL_ j
,LLj k
PathMM$ (
.MM( )
GetExtensionMM) 5
(MM5 6
filePathMM6 >
)MM> ?
)MM? @
;MM@ A
breakNN  %
;NN% &
caseOO  
$strOO! 2
:OO2 3
amazonFileKeyPP  -
=PP. /
stringPP0 6
.PP6 7
FormatPP7 =
(PP= >
$strPP> O
,PPO P
fileVmPPQ W
.PPW X
OrderNumberPPX c
,PPc d
PathQQ$ (
.QQ( )
GetExtensionQQ) 5
(QQ5 6
filePathQQ6 >
)QQ> ?
)QQ? @
;QQ@ A
breakRR  %
;RR% &
}SS 
S3FileManagerTT %
.TT% &
UploadTT& ,
(TT, -
amazonFileKeyTT- :
,TT: ;
filePathTT< D
,TTD E
trueTTF J
,TTJ K
trueTTL P
)TTP Q
;TTQ R
}UU 
}VV 
returnXX 
JsonXX 
(XX 
newXX 
JsonResponseXX  ,
(XX, -
)XX- .
{XX/ 0
IsSucessXX0 8
=XX9 :
trueXX; ?
,XX? @
ResultXXA G
=XXH I
amazonFileKeyXXJ W
}XXW X
)XXX Y
;XXY Z
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 
return\\ 
Json\\ 
(\\ 
new\\ 
JsonResponse\\  ,
(\\, -
)\\- .
{\\/ 0
IsSucess\\0 8
=\\9 :
false\\; @
,\\@ A
ErrorMessage\\B N
=\\O P
$str\\Q a
+\\b c
ex\\d f
.\\f g
Message\\g n
}\\n o
)\\o p
;\\p q
}]] 
finally^^ 
{__ 
ifaa 
(aa 
Systemaa 
.aa 
IOaa 
.aa 
Fileaa "
.aa" #
Existsaa# )
(aa) *
filePathaa* 2
)aa2 3
)aa3 4
Systembb 
.bb 
IObb 
.bb 
Filebb "
.bb" #
Deletebb# )
(bb) *
filePathbb* 2
)bb2 3
;bb3 4
}cc 
}dd 	
[ff 	
HttpGetff	 
]ff 
publicgg 
ActionResultgg 
DownloadFilegg (
(gg( )
UploadFileVmgg) 5
fileVmgg6 <
)gg< =
{hh 	
stringii 
filePathii 
=ii 
Pathii "
.ii" #
Combineii# *
(ii* +

UploadPathii+ 5
,ii5 6
fileVmii7 =
.ii= >
FileNameii> F
)iiF G
;iiG H
ifjj 
(jj 
fileVmjj 
.jj 
FileTypejj 
==jj  "
$strjj# 0
)jj0 1
{kk 
filePathll 
=ll 
Pathll 
.ll  
Combinell  '
(ll' (

ImagesPathll( 2
,ll2 3
fileVmll4 :
.ll: ;
FileNamell; C
)llC D
;llD E
}mm 
elsenn 
{oo 
S3FileManagerpp 
.pp 
Downloadpp &
(pp& '
fileVmpp' -
.pp- .
FileNamepp. 6
,pp6 7
filePathpp8 @
)pp@ A
;ppA B
}qq 
returnrr 
Filerr 
(rr 
filePathrr  
,rr  !
$strrr" ,
,rr, -
fileVmrr. 4
.rr4 5
FileNamerr5 =
)rr= >
;rr> ?
}ss 	
[uu 	
HttpPostuu	 
]uu 
publicvv 

JsonResultvv 

DeleteFilevv $
(vv$ %
UploadFileVmvv% 1
fileVmvv2 8
)vv8 9
{ww 	
tryxx 
{yy 
ifzz 
(zz 
fileVmzz 
.zz 
FileTypezz #
==zz$ &
$strzz' 4
)zz4 5
{{{ 
string|| 
filePath|| #
=||$ %
Path||& *
.||* +
Combine||+ 2
(||2 3

ImagesPath||3 =
,||= >
fileVm||? E
.||E F
FileName||F N
)||N O
;||O P
if}} 
(}} 
System}} 
.}} 
IO}} !
.}}! "
File}}" &
.}}& '
Exists}}' -
(}}- .
filePath}}. 6
)}}6 7
)}}7 8
System~~ 
.~~ 
IO~~ !
.~~! "
File~~" &
.~~& '
Delete~~' -
(~~- .
filePath~~. 6
)~~6 7
;~~7 8
} 
else
ÄÄ 
{
ÅÅ 
S3FileManager
ÇÇ !
.
ÇÇ! "
Delete
ÇÇ" (
(
ÇÇ( )
fileVm
ÇÇ) /
.
ÇÇ/ 0
FileName
ÇÇ0 8
)
ÇÇ8 9
;
ÇÇ9 :
}
ÉÉ 
return
ÑÑ 
Json
ÑÑ 
(
ÑÑ 
new
ÑÑ 
JsonResponse
ÑÑ  ,
(
ÑÑ, -
)
ÑÑ- .
{
ÑÑ/ 0
IsSucess
ÑÑ0 8
=
ÑÑ9 :
true
ÑÑ; ?
}
ÑÑ? @
)
ÑÑ@ A
;
ÑÑA B
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
áá 
return
àà 
Json
àà 
(
àà 
new
àà 
JsonResponse
àà  ,
(
àà, -
)
àà- .
{
àà/ 0
IsSucess
àà0 8
=
àà9 :
false
àà; @
,
àà@ A
ErrorMessage
ààB N
=
ààO P
$str
ààQ g
+
ààh i
ex
ààj l
.
ààl m
Message
ààm t
}
ààu v
)
ààv w
;
ààw x
}
ââ 
}
ää 	
}
ãã 
}åå À4
ME:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\HomeController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public		 

class		 
HomeController		 
:		  !
BaseController		" 0
{

 
public 
ActionResult 
Index !
(! "
)" #
{ 	
return 
RedirectToAction #
(# $
$str$ +
,+ ,
$str- 8
)8 9
;9 :
} 	
public 
ActionResult 
Settings $
($ %
)% &
{ 	
UserProfileVm 
profile !
=" #
null$ (
;( )
if 
( 
LoggedInUser 
== 
null  $
)$ %
return& ,
View- 1
(1 2
$str2 <
,< =
(> ?
UserProfileVm? L
)L M
nullN R
)R S
;S T
if 
( 
string 
. 
IsNullOrEmpty $
($ %
LoggedInUser% 1
?1 2
.2 3
ApiKey3 9
)9 :
): ;
{ 
var 
user 
= 
Db 
. 
Users #
.# $
FirstOrDefault$ 2
(2 3
x3 4
=>5 7
x8 9
.9 :
Id: <
=== ?
LoggedInUser@ L
.L M
IdM O
)O P
;P Q
if 
( 
user 
!= 
null  
)  !
user" &
.& '
ApiKey' -
=. /
KeyGenerator0 <
.< =
GetUniqueKey= I
(I J
$numJ L
)L M
;M N
Db 
. 
SaveChanges 
( 
)  
;  !
SetupLoggedInUser !
(! "
LoggedInUser" .
.. /
UserName/ 7
)7 8
;8 9
} 
profile 
= 
new 
UserProfileVm '
(' (
)( )
{   
UserName!! 
=!! 
LoggedInUser!! '
.!!' (
UserName!!( 0
,!!0 1
	FirstName"" 
="" 
LoggedInUser"" (
.""( )
	FirstName"") 2
,""2 3
LastName## 
=## 
LoggedInUser## '
.##' (
LastName##( 0
,##0 1
Email$$ 
=$$ 
LoggedInUser$$ $
.$$$ %
Email$$% *
,$$* +
CompanyName%% 
=%% 
LoggedInUser%% *
.%%* +
CompanyName%%+ 6
,%%6 7

WhiteLabel&& 
=&& 
LoggedInUser&& )
.&&) *

WhiteLabel&&* 4
,&&4 5
CompanyLogo'' 
='' 
LoggedInUser'' *
.''* +
CompanyLogo''+ 6
,''6 7
ReportTemplate(( 
=((  
LoggedInUser((! -
.((- .
ReportTemplate((. <
,((< =
	IsUsesApi)) 
=)) 
LoggedInUser)) (
.))( )
	IsUsesApi))) 2
,))2 3
ApiKey** 
=** 
LoggedInUser** %
.**% &
ApiKey**& ,
,**, -
}++ 
;++ 
ViewBag-- 
.-- 
ReportTemplate-- "
=--# $
new--% (

SelectList--) 3
(--3 4
ReportTemplates--4 C
,--C D
$str--E L
,--L M
$str--N T
,--T U
profile--V ]
.--] ^
ReportTemplate--^ l
)--l m
;--m n
return// 
View// 
(// 
$str// "
,//" #
profile//$ +
)//+ ,
;//, -
}00 	
[22 	
HttpPost22	 
]22 
public33 
ActionResult33 
Settings33 $
(33$ %
UserProfileVm33% 2
profile333 :
)33: ;
{44 	
var55 
user55 
=55 
Db55 
.55 
Users55 
.55  
FirstOrDefault55  .
(55. /
x55/ 0
=>551 3
x554 5
.555 6
Id556 8
==559 ;
LoggedInUser55< H
.55H I
Id55I K
)55K L
;55L M
if66 
(66 
user66 
==66 
null66 
)66 
return66 $
View66% )
(66) *
$str66* 1
)661 2
;662 3
user88 
.88 
	FirstName88 
=88 
profile88 $
.88$ %
	FirstName88% .
;88. /
user99 
.99 
LastName99 
=99 
profile99 #
.99# $
LastName99$ ,
;99, -
user:: 
.:: 
Email:: 
=:: 
profile::  
.::  !
Email::! &
;::& '
user;; 
.;; 
CompanyName;; 
=;; 
profile;; &
.;;& '
CompanyName;;' 2
;;;2 3
user<< 
.<< 

WhiteLabel<< 
=<< 
profile<< %
.<<% &

WhiteLabel<<& 0
;<<0 1
user== 
.== 
CompanyLogo== 
=== 
profile== &
.==& '
CompanyLogo==' 2
;==2 3
user>> 
.>> 
ReportTemplate>> 
=>>  !
profile>>" )
.>>) *
ReportTemplate>>* 8
;>>8 9
Db?? 
.?? 
SaveChanges?? 
(?? 
)?? 
;?? 
SetupLoggedInUserAA 
(AA 
LoggedInUserAA *
.AA* +
UserNameAA+ 3
)AA3 4
;AA4 5
ViewBagCC 
.CC 
ReportTemplateCC "
=CC# $
newCC% (

SelectListCC) 3
(CC3 4
ReportTemplatesCC4 C
,CCC D
$strCCE L
,CCL M
$strCCM S
,CCS T
profileCCU \
.CC\ ]
ReportTemplateCC] k
)CCk l
;CCl m
TempDataDD 
[DD 
$strDD 
]DD 
=DD  !
$strDD" I
;DDI J
returnEE 
RedirectToActionEE #
(EE# $
$strEE$ .
)EE. /
;EE/ 0
}FF 	
}JJ 
}KK ï¿
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\CreativeController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
CreativeController #
:$ %
BaseController& 4
{ 
public 
ActionResult 
Index !
(! "
Guid" &
id' )
)) *
{ 	
var 
campaign 
= 
Db 
. 
	Campaigns '
. 
Include 
( 
c 
=> 
c 
.  
Assets  &
)& '
. 
Include 
( 
c 
=> 
c 
.  
Testing  '
)' (
. 
Include 
( 
c 
=> 
c 
.  
Approved  (
)( )
. 
Include 
( 
c 
=> 
c 
.  
Creative  (
)( )
. 
FirstOrDefault 
(  
c  !
=>" $
c% &
.& '
Id' )
==* ,
id- /
)/ 0
;0 1
Session 
[ 
$str 
] 
= 
id 
; 
Session 
[ 
$str !
]! "
=# $
campaign% -
.- .
OrderNumber. 9
;9 :
var!! 
creative!! 
=!! 
new!! 

CreativeVm!! )
(!!) *
)!!* +
{"" 

CampaignId## 
=## 
campaign## %
.##% &
Id##& (
.##( )
ToString##) 1
(##1 2
)##2 3
,##3 4
OrderNumber$$ 
=$$ 
campaign$$ &
.$$& '
OrderNumber$$' 2
,$$2 3
CampaignName%% 
=%% 
campaign%% '
.%%' (
Testing%%( /
.%%/ 0
CampaignName%%0 <
,%%< =
FromLine&& 
=&& 
campaign&& #
.&&# $
Testing&&$ +
.&&+ ,
FromLine&&, 4
,&&4 5
SubjectLine'' 
='' 
campaign'' &
.''& '
Testing''' .
.''. /
SubjectLine''/ :
,'': ;
TestSeedFile(( 
=(( 
campaign(( '
.((' (
Assets((( .
.((. /
TestSeedFile((/ ;
,((; <
LiveSeedFile)) 
=)) 
campaign)) '
.))' (
Assets))( .
.)). /
LiveSeedFile))/ ;
,)); <
	Creatives** 
=** 
campaign** $
.**$ %
Creative**% -
?**- .
.**. /
CreativeHtml**/ ;
,**; <

TestEmails++ 
=++ 
new++  
List++! %
<++% &
SelectItemPair++& 4
>++4 5
(++5 6
)++6 7
,++7 8

LiveEmails,, 
=,, 
new,,  
List,,! %
<,,% &
SelectItemPair,,& 4
>,,4 5
(,,5 6
),,6 7
}-- 
;-- 
if// 
(// 
!// 
string// 
.// 
IsNullOrEmpty// %
(//% &
campaign//& .
.//. /
Assets/// 5
.//5 6
TestSeedFile//6 B
)//B C
)//C D
{00 
string11 
filePath11 
=11  !
Path11" &
.11& '
Combine11' .
(11. /

UploadPath11/ 9
,119 :
campaign11; C
.11C D
Assets11D J
.11J K
TestSeedFile11K W
)11W X
;11X Y
if22 
(22 
!22 
System22 
.22 
IO22 
.22 
File22 "
.22" #
Exists22# )
(22) *
filePath22* 2
)222 3
&&224 6
!227 8
string228 >
.22> ?
IsNullOrEmpty22? L
(22L M
campaign22M U
.22U V
Assets22V \
.22\ ]
TestSeedFile22] i
)22i j
)22j k
S3FileManager33 !
.33! "
Download33" *
(33* +
campaign33+ 3
.333 4
Assets334 :
.33: ;
TestSeedFile33; G
,33G H
filePath33I Q
)33Q R
;33R S
creative44 
.44 

TestEmails44 #
=44$ %
CreativeHelper44& 4
.444 5

ReadEmails445 ?
(44? @
filePath44@ H
)44H I
;44I J
}55 
if77 
(77 
!77 
string77 
.77 
IsNullOrEmpty77 %
(77% &
campaign77& .
.77. /
Assets77/ 5
.775 6
LiveSeedFile776 B
)77B C
)77C D
{88 
string99 
filePathLive99 #
=99$ %
Path99& *
.99* +
Combine99+ 2
(992 3

UploadPath993 =
,99= >
campaign99? G
.99G H
Assets99H N
.99N O
LiveSeedFile99O [
)99[ \
;99\ ]
if:: 
(:: 
!:: 
System:: 
.:: 
IO:: 
.:: 
File:: #
.::# $
Exists::$ *
(::* +
filePathLive::+ 7
)::7 8
&&::9 ;
!::< =
string::= C
.::C D
IsNullOrEmpty::D Q
(::Q R
campaign::R Z
.::Z [
Assets::[ a
.::a b
LiveSeedFile::b n
)::n o
)::o p
S3FileManager;; !
.;;! "
Download;;" *
(;;* +
campaign;;+ 3
.;;3 4
Assets;;4 :
.;;: ;
LiveSeedFile;;; G
,;;G H
filePathLive;;I U
);;U V
;;;V W
creative<< 
.<< 

LiveEmails<< #
=<<$ %
CreativeHelper<<& 4
.<<4 5

ReadEmails<<5 ?
(<<? @
filePathLive<<@ L
)<<L M
;<<M N
}== 
Session?? 
[?? 
$str?? "
]??" #
=??$ %
campaign??& .
.??. /
Assets??/ 5
.??5 6
TestSeedFile??6 B
;??B C
Session@@ 
[@@ 
$str@@ !
]@@! "
=@@# $
campaign@@% -
.@@- .
Assets@@. 4
.@@4 5
TestSeedUrl@@5 @
;@@@ A
SessionAA 
[AA 
$strAA "
]AA" #
=AA$ %
campaignAA& .
.AA. /
AssetsAA/ 5
.AA5 6
LiveSeedFileAA6 B
;AAB C
SessionBB 
[BB 
$strBB !
]BB! "
=BB# $
campaignBB% -
.BB- .
AssetsBB. 4
.BB4 5
LiveSeedUrlBB5 @
;BB@ A
returnCC 
ViewCC 
(CC 
creativeCC  
)CC  !
;CC! "
}DD 	
[FF 	
HttpPostFF	 
]FF 
[GG 	
ValidateInputGG	 
(GG 
falseGG 
)GG 
]GG 
[HH 	
MultipleButtonHH	 
(HH 
NameHH 
=HH 
$strHH '
,HH' (
ArgumentHH) 1
=HH2 3
$strHH4 :
)HH: ;
]HH; <
publicII 
ActionResultII 
SaveII  
(II  !

CreativeVmII! +
modelII, 1
)II1 2
{JJ 	
tryKK 
{LL 
varMM 
alreayMM 
=MM 
DbMM 
.MM  
CampaignCreativesMM  1
.MM1 2
FirstOrDefaultMM2 @
(MM@ A
xMMA B
=>MMC E
xMMF G
.MMG H

CampaignIdMMH R
.MMR S
ToStringMMS [
(MM[ \
)MM\ ]
==MM^ `
modelMMa f
.MMf g

CampaignIdMMg q
)MMq r
;MMr s
ifNN 
(NN 
alreayNN 
==NN 
nullNN "
)NN" #
{OO 
varPP 

creativeIdPP "
=PP# $
GuidPP% )
.PP) *
NewGuidPP* 1
(PP1 2
)PP2 3
;PP3 4
alreayQQ 
=QQ 
newQQ  
CampaignCreativeQQ! 1
(QQ1 2
)QQ2 3
{RR 
IdSS 
=SS 

creativeIdSS '
,SS' (
	CreatedAtTT !
=TT" #
DateTimeTT$ ,
.TT, -
NowTT- 0
,TT0 1

CampaignIdUU "
=UU# $
GuidUU% )
.UU) *
ParseUU* /
(UU/ 0
modelUU0 5
.UU5 6

CampaignIdUU6 @
)UU@ A
,UUA B
CreativeHtmlVV $
=VV% &
modelVV' ,
.VV, -
	CreativesVV- 6
}WW 
;WW 
DbXX 
.XX 
CampaignCreativesXX (
.XX( )
AddXX) ,
(XX, -
alreayXX- 3
)XX3 4
;XX4 5
varYY 
campaignYY  
=YY! "
DbYY# %
.YY% &
	CampaignsYY& /
.YY/ 0
FirstOrDefaultYY0 >
(YY> ?
cYY? @
=>YYA C
cYYD E
.YYE F
IdYYF H
.YYH I
ToStringYYI Q
(YYQ R
)YYR S
==YYT V
modelYYW \
.YY\ ]

CampaignIdYY] g
)YYg h
;YYh i
campaignZZ 
.ZZ 

CreativeIdZZ '
=ZZ( )

creativeIdZZ* 4
;ZZ4 5
}[[ 
else\\ 
{]] 
alreay^^ 
.^^ 
CreativeHtml^^ '
=^^( )
model^^* /
.^^/ 0
	Creatives^^0 9
;^^9 :
}__ 
Db`` 
.`` 
SaveChanges`` 
(`` 
)``  
;``  !
TempDataaa 
[aa 
$straa "
]aa" #
=aa$ %
$straa& N
;aaN O
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
TempDataee 
[ee 
$stree  
]ee  !
=ee" #
$stree$ D
+eeE F
stringeeG M
.eeM N
JoineeN R
(eeR S
$streeS Z
,eeZ [
exee\ ^
.ee^ _
Messageee_ f
)eef g
;eeg h
}ff 
returngg 
RedirectToActiongg #
(gg# $
$strgg$ +
,gg+ ,
newgg- 0
{gg1 2
idgg3 5
=gg6 7
modelgg8 =
.gg= >

CampaignIdgg> H
}ggI J
)ggJ K
;ggK L
}hh 	
publicjj 
ActionResultjj 
	AddToListjj %
(jj% &
stringjj& ,
listjj- 1
,jj1 2
stringjj3 9
emailjj: ?
)jj? @
{kk 	
tryll 
{mm 
switchnn 
(nn 
listnn 
)nn 
{oo 
casepp 
$strpp 
:pp  
stringqq 
filePathqq '
=qq( )
Pathqq* .
.qq. /
Combineqq/ 6
(qq6 7

UploadPathqq7 A
,qqA B
(qqC D
stringqqD J
)qqJ K
SessionqqK R
[qqR S
$strqqS a
]qqa b
)qqb c
;qqc d
newrr 
CreativeHelperrr *
(rr* +
)rr+ ,
.rr, -
Addrr- 0
(rr0 1
filePathrr1 9
,rr9 :
emailrr; @
)rr@ A
;rrA B
S3FileManagerss %
.ss% &
Uploadss& ,
(ss, -
(ss- .
stringss. 4
)ss4 5
Sessionss5 <
[ss< =
$strss= J
]ssJ K
,ssK L
filePathssM U
,ssU V
truessW [
)ss[ \
;ss\ ]
breaktt 
;tt 
caseuu 
$struu 
:uu  
stringvv 
filePathLivevv +
=vv, -
Pathvv. 2
.vv2 3
Combinevv3 :
(vv: ;

UploadPathvv; E
,vvE F
(vvG H
stringvvH N
)vvN O
SessionvvO V
[vvV W
$strvvW f
]vvf g
)vvg h
;vvh i
newww 
CreativeHelperww *
(ww* +
)ww+ ,
.ww, -
Addww- 0
(ww0 1
filePathLiveww1 =
,ww= >
emailww? D
)wwD E
;wwE F
S3FileManagerxx %
.xx% &
Uploadxx& ,
(xx, -
(xx- .
stringxx. 4
)xx4 5
Sessionxx5 <
[xx< =
$strxx= J
]xxJ K
,xxK L
filePathLivexxM Y
,xxY Z
truexx[ _
)xx_ `
;xx` a
breakyy 
;yy 
}zz 
return{{ 
Json{{ 
({{ 
new{{ 
JsonResponse{{  ,
({{, -
){{- .
{{{/ 0
IsSucess{{0 8
={{9 :
true{{; ?
}{{? @
){{@ A
;{{A B
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
return 
Json 
( 
new 
JsonResponse  ,
(, -
)- .
{/ 0
IsSucess0 8
=9 :
false; @
,@ A
ErrorMessageB N
=O P
exQ S
.S T
MessageT [
}[ \
)\ ]
;] ^
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
ActionResult
ÉÉ 
DeleteFromList
ÉÉ *
(
ÉÉ* +
string
ÉÉ+ 1
list
ÉÉ2 6
,
ÉÉ6 7
string
ÉÉ8 >
email
ÉÉ? D
)
ÉÉD E
{
ÑÑ 	
try
ÖÖ 
{
ÜÜ 
switch
áá 
(
áá 
list
áá 
)
áá 
{
àà 
case
ââ 
$str
ââ 
:
ââ  
string
ää 
filePath
ää '
=
ää( )
Path
ää* .
.
ää. /
Combine
ää/ 6
(
ää6 7

UploadPath
ää7 A
,
ääA B
(
ääC D
string
ääD J
)
ääJ K
Session
ääK R
[
ääR S
$str
ääS a
]
ääa b
)
ääb c
;
ääc d
new
ãã 
CreativeHelper
ãã *
(
ãã* +
)
ãã+ ,
.
ãã, -
Remove
ãã- 3
(
ãã3 4
filePath
ãã4 <
,
ãã< =
email
ãã> C
)
ããC D
;
ããD E
S3FileManager
åå %
.
åå% &
Upload
åå& ,
(
åå, -
(
åå- .
string
åå. 4
)
åå4 5
Session
åå5 <
[
åå< =
$str
åå= J
]
ååJ K
,
ååK L
filePath
ååM U
,
ååU V
true
ååW [
)
åå[ \
;
åå\ ]
break
çç 
;
çç 
case
éé 
$str
éé 
:
éé  
string
èè 
filePathLive
èè +
=
èè, -
Path
èè. 2
.
èè2 3
Combine
èè3 :
(
èè: ;

UploadPath
èè; E
,
èèE F
(
èèG H
string
èèH N
)
èèN O
Session
èèO V
[
èèV W
$str
èèW f
]
èèf g
)
èèg h
;
èèh i
new
êê 
CreativeHelper
êê *
(
êê* +
)
êê+ ,
.
êê, -
Remove
êê- 3
(
êê3 4
filePathLive
êê4 @
,
êê@ A
email
êêB G
)
êêG H
;
êêH I
S3FileManager
ëë %
.
ëë% &
Upload
ëë& ,
(
ëë, -
(
ëë- .
string
ëë. 4
)
ëë4 5
Session
ëë5 <
[
ëë< =
$str
ëë= J
]
ëëJ K
,
ëëK L
filePathLive
ëëM Y
,
ëëY Z
true
ëë[ _
)
ëë_ `
;
ëë` a
break
íí 
;
íí 
}
ìì 
return
îî 
Json
îî 
(
îî 
new
îî 
JsonResponse
îî  ,
(
îî, -
)
îî- .
{
îî/ 0
IsSucess
îî1 9
=
îî: ;
true
îî< @
}
îîA B
)
îîB C
;
îîC D
}
ïï 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
óó 
return
òò 
Json
òò 
(
òò 
new
òò 
JsonResponse
òò  ,
(
òò, -
)
òò- .
{
òò/ 0
IsSucess
òò1 9
=
òò: ;
false
òò< A
,
òòA B
ErrorMessage
òòC O
=
òòP Q
ex
òòR T
.
òòT U
Message
òòU \
}
òò] ^
)
òò^ _
;
òò_ `
}
ôô 
}
öö 	
[
úú 	
HttpPost
úú	 
]
úú 
[
ùù 	
ValidateInput
ùù	 
(
ùù 
false
ùù 
)
ùù 
]
ùù 
[
ûû 	
MultipleButton
ûû	 
(
ûû 
Name
ûû 
=
ûû 
$str
ûû '
,
ûû' (
Argument
ûû) 1
=
ûû2 3
$str
ûû4 >
)
ûû> ?
]
ûû? @
public
üü 
ActionResult
üü 
TestSend
üü $
(
üü$ %

CreativeVm
üü% /
model
üü0 5
)
üü5 6
{
†† 	
try
°° 
{
¢¢ 
string
££ 
filePath
££ 
=
££  !
Path
££" &
.
££& '
Combine
££' .
(
££. /

UploadPath
££/ 9
,
££9 :
(
££; <
string
££< B
)
££B C
Session
££C J
[
££J K
$str
££K Y
]
££Y Z
)
££Z [
;
££[ \
string
§§ 
filePathLive
§§ #
=
§§$ %
Path
§§& *
.
§§* +
Combine
§§+ 2
(
§§2 3

UploadPath
§§3 =
,
§§= >
(
§§? @
string
§§@ F
)
§§F G
Session
§§G N
[
§§N O
$str
§§O ^
]
§§^ _
)
§§_ `
;
§§` a
model
•• 
.
•• 

TestEmails
••  
=
••! "
CreativeHelper
••# 1
.
••1 2

ReadEmails
••2 <
(
••< =
filePath
••= E
)
••E F
;
••F G
model
¶¶ 
.
¶¶ 

LiveEmails
¶¶  
=
¶¶! "
CreativeHelper
¶¶# 1
.
¶¶1 2

ReadEmails
¶¶2 <
(
¶¶< =
filePathLive
¶¶= I
)
¶¶I J
;
¶¶J K
BackgroundJob
®® 
.
®® 
Enqueue
®® %
(
®®% &
(
®®& '
)
®®' (
=>
®®) + 
MailChimpProcessor
®®, >
.
®®> ?
TestSend
®®? G
(
®®G H
model
®®H M
)
®®M N
)
®®N O
;
®®O P
TempData
©© 
[
©© 
$str
©© "
]
©©" #
=
©©$ %
$str
©©& X
;
©©X Y
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
¨¨ 
TempData
≠≠ 
[
≠≠ 
$str
≠≠  
]
≠≠  !
=
≠≠" #
$str
≠≠$ D
+
≠≠E F
string
≠≠G M
.
≠≠M N
Join
≠≠N R
(
≠≠R S
$str
≠≠S Z
,
≠≠Z [
ex
≠≠\ ^
.
≠≠^ _
Message
≠≠_ f
)
≠≠f g
;
≠≠g h
}
ÆÆ 
return
ØØ 
RedirectToAction
ØØ #
(
ØØ# $
$str
ØØ$ +
,
ØØ+ ,
new
ØØ- 0
{
ØØ1 2
id
ØØ2 4
=
ØØ4 5
model
ØØ6 ;
.
ØØ; <

CampaignId
ØØ< F
}
ØØF G
)
ØØG H
;
ØØH I
}
∞∞ 	
[
≤≤ 	
HttpPost
≤≤	 
]
≤≤ 
[
≥≥ 	
ValidateInput
≥≥	 
(
≥≥ 
false
≥≥ 
)
≥≥ 
]
≥≥ 
[
¥¥ 	
MultipleButton
¥¥	 
(
¥¥ 
Name
¥¥ 
=
¥¥ 
$str
¥¥ '
,
¥¥' (
Argument
¥¥) 1
=
¥¥2 3
$str
¥¥4 C
)
¥¥C D
]
¥¥D E
public
µµ 
ActionResult
µµ 
QuickTestSend
µµ )
(
µµ) *

CreativeVm
µµ* 4
model
µµ5 :
)
µµ: ;
{
∂∂ 	
try
∑∑ 
{
∏∏  
MailChimpProcessor
ππ "
.
ππ" #
QucikTestSend
ππ# 0
(
ππ0 1
model
ππ1 6
)
ππ6 7
;
ππ7 8
TempData
∫∫ 
[
∫∫ 
$str
∫∫ "
]
∫∫" #
=
∫∫$ %
$str
∫∫& N
;
∫∫N O
}
ªª 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
ΩΩ 
TempData
ææ 
[
ææ 
$str
ææ  
]
ææ  !
=
ææ" #
$str
ææ$ D
+
ææE F
string
ææG M
.
ææM N
Join
ææN R
(
ææR S
$str
ææS Z
,
ææZ [
ex
ææ\ ^
.
ææ^ _
Message
ææ_ f
)
ææf g
;
ææg h
}
øø 
return
¿¿ 
RedirectToAction
¿¿ #
(
¿¿# $
$str
¿¿$ +
,
¿¿+ ,
new
¿¿- 0
{
¿¿1 2
id
¿¿3 5
=
¿¿6 7
model
¿¿8 =
.
¿¿= >

CampaignId
¿¿> H
}
¿¿I J
)
¿¿J K
;
¿¿K L
}
¡¡ 	
public
√√ 

JsonResult
√√ !
RefreshMailChimpLog
√√ -
(
√√- .
string
√√. 4
orderNumber
√√5 @
)
√√@ A
{
ƒƒ 	
try
≈≈ 
{
∆∆ 
if
«« 
(
«« 
orderNumber
«« 
==
««  "
null
««# '
)
««' (
{
»» 
throw
…… 
new
…… 
AdsException
…… *
(
……* +
$str
……+ A
)
……A B
;
……B C
}
   
var
ÃÃ 
messages
ÃÃ 
=
ÃÃ 
Db
ÃÃ !
.
ÃÃ! "

SystemLogs
ÃÃ" ,
.
ÃÃ, -
Where
ÃÃ- 2
(
ÃÃ2 3
x
ÃÃ3 4
=>
ÃÃ5 7
x
ÃÃ8 9
.
ÃÃ9 :
OrderNumber
ÃÃ: E
==
ÃÃF H
orderNumber
ÃÃI T
&&
ÃÃU W
x
ÃÃX Y
.
ÃÃY Z
LogType
ÃÃZ a
==
ÃÃb d
(
ÃÃe f
int
ÃÃf i
)
ÃÃi j
LogType
ÃÃj q
.
ÃÃq r
	MailChimp
ÃÃr {
)
ÃÃ{ |
.
ÕÕ 
OrderByDescending
ÕÕ &
(
ÕÕ& '
x
ÕÕ' (
=>
ÕÕ) +
x
ÕÕ, -
.
ÕÕ- .
	CreatedAt
ÕÕ. 7
)
ÕÕ7 8
.
ŒŒ 
Select
ŒŒ 
(
ŒŒ 
x
ŒŒ 
=>
ŒŒ  
new
ŒŒ! $
{
ŒŒ% &
	CreatedAt
ŒŒ' 0
=
ŒŒ1 2
x
ŒŒ3 4
.
ŒŒ4 5
	CreatedAt
ŒŒ5 >
.
ŒŒ> ?
ToString
ŒŒ? G
(
ŒŒG H
)
ŒŒH I
,
ŒŒI J
Message
ŒŒK R
=
ŒŒS T
x
ŒŒU V
.
ŒŒV W
Message
ŒŒW ^
}
ŒŒ_ `
)
ŒŒ` a
.
œœ 
ToList
œœ 
(
œœ 
)
œœ 
;
œœ 
return
—— 
Json
—— 
(
—— 
new
—— 
JsonResponse
——  ,
(
——, -
)
——- .
{
——/ 0
IsSucess
——1 9
=
——: ;
true
——< @
,
——@ A
Result
——B H
=
——I J
messages
——K S
}
——T U
)
——U V
;
——V W
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
‘‘ 
return
’’ 
Json
’’ 
(
’’ 
new
’’ 
JsonResponse
’’  ,
(
’’, -
)
’’- .
{
’’/ 0
IsSucess
’’1 9
=
’’: ;
false
’’< A
,
’’A B
ErrorMessage
’’C O
=
’’P Q
ex
’’R T
.
’’T U
Message
’’U \
}
’’] ^
)
’’^ _
;
’’_ `
}
÷÷ 
}
◊◊ 	
}
ÿÿ 
}ŸŸ ’é
OE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\ManageController.cs
	namespace

 	
ADSDataDirect


 
.

 
Web

 
.

 
Controllers

 '
{ 
public 

class 
ManageController !
:" #

Controller$ .
{ 
private $
ApplicationSignInManager (
_signInManager) 7
;7 8
private "
ApplicationUserManager &
_userManager' 3
;3 4
public 
ManageController 
(  
)  !
{ 	
} 	
public 
ManageController 
(  "
ApplicationUserManager  6
userManager7 B
,B C$
ApplicationSignInManagerD \
signInManager] j
)j k
{ 	
UserManager 
= 
userManager %
;% &
SignInManager 
= 
signInManager )
;) *
} 	
public $
ApplicationSignInManager '
SignInManager( 5
{ 	
get 
{ 
return   
_signInManager   %
??  & (
HttpContext  ) 4
.  4 5
GetOwinContext  5 C
(  C D
)  D E
.  E F
Get  F I
<  I J$
ApplicationSignInManager  J b
>  b c
(  c d
)  d e
;  e f
}!! 
private"" 
set"" 
{## 
_signInManager$$ 
=$$  
value$$! &
;$$& '
}%% 
}&& 	
public(( "
ApplicationUserManager(( %
UserManager((& 1
{)) 	
get** 
{++ 
return,, 
_userManager,, #
??,,$ &
HttpContext,,' 2
.,,2 3
GetOwinContext,,3 A
(,,A B
),,B C
.,,C D
GetUserManager,,D R
<,,R S"
ApplicationUserManager,,S i
>,,i j
(,,j k
),,k l
;,,l m
}-- 
private.. 
set.. 
{// 
_userManager00 
=00 
value00 $
;00$ %
}11 
}22 	
public66 
async66 
Task66 
<66 
ActionResult66 &
>66& '
Index66( -
(66- .
ManageMessageId66. =
?66= >
message66? F
)66F G
{77 	
ViewBag88 
.88 
StatusMessage88 !
=88" #
message99 
==99 
ManageMessageId99 *
.99* +!
ChangePasswordSuccess99+ @
?99A B
$str99C d
::: 
message:: 
==:: 
ManageMessageId:: ,
.::, -
SetPasswordSuccess::- ?
?::@ A
$str::B _
:;; 
message;; 
==;; 
ManageMessageId;; ,
.;;, -
SetTwoFactorSuccess;;- @
?;;A B
$str;;C z
:<< 
message<< 
==<< 
ManageMessageId<< ,
.<<, -
Error<<- 2
?<<3 4
$str<<5 M
:== 
message== 
==== 
ManageMessageId== ,
.==, -
AddPhoneSuccess==- <
?=== >
$str==? ]
:>> 
message>> 
==>> 
ManageMessageId>> ,
.>>, -
RemovePhoneSuccess>>- ?
?>>@ A
$str>>B b
:?? 
$str?? 
;?? 
varAA 
userIdAA 
=AA 
UserAA 
.AA 
IdentityAA &
.AA& '
	GetUserIdAA' 0
(AA0 1
)AA1 2
;AA2 3
varBB 
modelBB 
=BB 
newBB 
IndexViewModelBB *
{CC 
HasPasswordDD 
=DD 
HasPasswordDD )
(DD) *
)DD* +
,DD+ ,
PhoneNumberEE 
=EE 
awaitEE #
UserManagerEE$ /
.EE/ 0
GetPhoneNumberAsyncEE0 C
(EEC D
userIdEED J
)EEJ K
,EEK L
	TwoFactorFF 
=FF 
awaitFF !
UserManagerFF" -
.FF- .$
GetTwoFactorEnabledAsyncFF. F
(FFF G
userIdFFG M
)FFM N
,FFN O
LoginsGG 
=GG 
awaitGG 
UserManagerGG *
.GG* +
GetLoginsAsyncGG+ 9
(GG9 :
userIdGG: @
)GG@ A
,GGA B
BrowserRememberedHH !
=HH" #
awaitHH$ )!
AuthenticationManagerHH* ?
.HH? @+
TwoFactorBrowserRememberedAsyncHH@ _
(HH_ `
userIdHH` f
)HHf g
}II 
;II 
returnJJ 
ViewJJ 
(JJ 
modelJJ 
)JJ 
;JJ 
}KK 	
[OO 	
HttpPostOO	 
]OO 
[PP 	$
ValidateAntiForgeryTokenPP	 !
]PP! "
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
ActionResultQQ &
>QQ& '
RemoveLoginQQ( 3
(QQ3 4
stringQQ4 :
loginProviderQQ; H
,QQH I
stringQQJ P
providerKeyQQQ \
)QQ\ ]
{RR 	
ManageMessageIdSS 
?SS 
messageSS $
;SS$ %
varTT 
resultTT 
=TT 
awaitTT 
UserManagerTT *
.TT* +
RemoveLoginAsyncTT+ ;
(TT; <
UserTT< @
.TT@ A
IdentityTTA I
.TTI J
	GetUserIdTTJ S
(TTS T
)TTT U
,TTU V
newTTW Z
UserLoginInfoTT[ h
(TTh i
loginProviderTTi v
,TTv w
providerKey	TTx É
)
TTÉ Ñ
)
TTÑ Ö
;
TTÖ Ü
ifUU 
(UU 
resultUU 
.UU 
	SucceededUU  
)UU  !
{VV 
varWW 
userWW 
=WW 
awaitWW  
UserManagerWW! ,
.WW, -
FindByIdAsyncWW- :
(WW: ;
UserWW; ?
.WW? @
IdentityWW@ H
.WWH I
	GetUserIdWWI R
(WWR S
)WWS T
)WWT U
;WWU V
ifXX 
(XX 
userXX 
!=XX 
nullXX  
)XX  !
{YY 
awaitZZ 
SignInManagerZZ '
.ZZ' (
SignInAsyncZZ( 3
(ZZ3 4
userZZ4 8
,ZZ8 9
isPersistentZZ: F
:ZZF G
falseZZH M
,ZZM N
rememberBrowserZZO ^
:ZZ^ _
falseZZ` e
)ZZe f
;ZZf g
}[[ 
message\\ 
=\\ 
ManageMessageId\\ )
.\\) *
RemoveLoginSuccess\\* <
;\\< =
}]] 
else^^ 
{__ 
message`` 
=`` 
ManageMessageId`` )
.``) *
Error``* /
;``/ 0
}aa 
returnbb 
RedirectToActionbb #
(bb# $
$strbb$ 2
,bb2 3
newbb4 7
{bb8 9
Messagebb: A
=bbB C
messagebbD K
}bbL M
)bbM N
;bbN O
}cc 	
publicgg 
ActionResultgg 
AddPhoneNumbergg *
(gg* +
)gg+ ,
{hh 	
returnii 
Viewii 
(ii 
)ii 
;ii 
}jj 	
[nn 	
HttpPostnn	 
]nn 
[oo 	$
ValidateAntiForgeryTokenoo	 !
]oo! "
publicpp 
asyncpp 
Taskpp 
<pp 
ActionResultpp &
>pp& '
AddPhoneNumberpp( 6
(pp6 7#
AddPhoneNumberViewModelpp7 N
modelppO T
)ppT U
{qq 	
ifrr 
(rr 
!rr 

ModelStaterr 
.rr 
IsValidrr #
)rr# $
{ss 
returntt 
Viewtt 
(tt 
modeltt !
)tt! "
;tt" #
}uu 
varww 
codeww 
=ww 
awaitww 
UserManagerww (
.ww( )/
#GenerateChangePhoneNumberTokenAsyncww) L
(wwL M
UserwwM Q
.wwQ R
IdentitywwR Z
.wwZ [
	GetUserIdww[ d
(wwd e
)wwe f
,wwf g
modelwwh m
.wwm n
Numberwwn t
)wwt u
;wwu v
ifxx 
(xx 
UserManagerxx 
.xx 

SmsServicexx &
!=xx' )
nullxx* .
)xx. /
{yy 
varzz 
messagezz 
=zz 
newzz !
IdentityMessagezz" 1
{{{ 
Destination|| 
=||  !
model||" '
.||' (
Number||( .
,||. /
Body}} 
=}} 
$str}} 4
+}}5 6
code}}7 ;
}~~ 
;~~ 
await 
UserManager !
.! "

SmsService" ,
., -
	SendAsync- 6
(6 7
message7 >
)> ?
;? @
}
ÄÄ 
return
ÅÅ 
RedirectToAction
ÅÅ #
(
ÅÅ# $
$str
ÅÅ$ 7
,
ÅÅ7 8
new
ÅÅ9 <
{
ÅÅ= >
PhoneNumber
ÅÅ? J
=
ÅÅK L
model
ÅÅM R
.
ÅÅR S
Number
ÅÅS Y
}
ÅÅZ [
)
ÅÅ[ \
;
ÅÅ\ ]
}
ÇÇ 	
[
ÜÜ 	
HttpPost
ÜÜ	 
]
ÜÜ 
[
áá 	&
ValidateAntiForgeryToken
áá	 !
]
áá! "
public
àà 
async
àà 
Task
àà 
<
àà 
ActionResult
àà &
>
àà& '+
EnableTwoFactorAuthentication
àà( E
(
ààE F
)
ààF G
{
ââ 	
await
ää 
UserManager
ää 
.
ää &
SetTwoFactorEnabledAsync
ää 6
(
ää6 7
User
ää7 ;
.
ää; <
Identity
ää< D
.
ääD E
	GetUserId
ääE N
(
ääN O
)
ääO P
,
ääP Q
true
ääR V
)
ääV W
;
ääW X
var
ãã 
user
ãã 
=
ãã 
await
ãã 
UserManager
ãã (
.
ãã( )
FindByIdAsync
ãã) 6
(
ãã6 7
User
ãã7 ;
.
ãã; <
Identity
ãã< D
.
ããD E
	GetUserId
ããE N
(
ããN O
)
ããO P
)
ããP Q
;
ããQ R
if
åå 
(
åå 
user
åå 
!=
åå 
null
åå 
)
åå 
{
çç 
await
éé 
SignInManager
éé #
.
éé# $
SignInAsync
éé$ /
(
éé/ 0
user
éé0 4
,
éé4 5
isPersistent
éé6 B
:
ééB C
false
ééD I
,
ééI J
rememberBrowser
ééK Z
:
ééZ [
false
éé\ a
)
ééa b
;
ééb c
}
èè 
return
êê 
RedirectToAction
êê #
(
êê# $
$str
êê$ +
,
êê+ ,
$str
êê- 5
)
êê5 6
;
êê6 7
}
ëë 	
[
ïï 	
HttpPost
ïï	 
]
ïï 
[
ññ 	&
ValidateAntiForgeryToken
ññ	 !
]
ññ! "
public
óó 
async
óó 
Task
óó 
<
óó 
ActionResult
óó &
>
óó& ',
DisableTwoFactorAuthentication
óó( F
(
óóF G
)
óóG H
{
òò 	
await
ôô 
UserManager
ôô 
.
ôô &
SetTwoFactorEnabledAsync
ôô 6
(
ôô6 7
User
ôô7 ;
.
ôô; <
Identity
ôô< D
.
ôôD E
	GetUserId
ôôE N
(
ôôN O
)
ôôO P
,
ôôP Q
false
ôôR W
)
ôôW X
;
ôôX Y
var
öö 
user
öö 
=
öö 
await
öö 
UserManager
öö (
.
öö( )
FindByIdAsync
öö) 6
(
öö6 7
User
öö7 ;
.
öö; <
Identity
öö< D
.
ööD E
	GetUserId
ööE N
(
ööN O
)
ööO P
)
ööP Q
;
ööQ R
if
õõ 
(
õõ 
user
õõ 
!=
õõ 
null
õõ 
)
õõ 
{
úú 
await
ùù 
SignInManager
ùù #
.
ùù# $
SignInAsync
ùù$ /
(
ùù/ 0
user
ùù0 4
,
ùù4 5
isPersistent
ùù6 B
:
ùùB C
false
ùùD I
,
ùùI J
rememberBrowser
ùùK Z
:
ùùZ [
false
ùù\ a
)
ùùa b
;
ùùb c
}
ûû 
return
üü 
RedirectToAction
üü #
(
üü# $
$str
üü$ +
,
üü+ ,
$str
üü- 5
)
üü5 6
;
üü6 7
}
†† 	
public
§§ 
async
§§ 
Task
§§ 
<
§§ 
ActionResult
§§ &
>
§§& '
VerifyPhoneNumber
§§( 9
(
§§9 :
string
§§: @
phoneNumber
§§A L
)
§§L M
{
•• 	
var
¶¶ 
code
¶¶ 
=
¶¶ 
await
¶¶ 
UserManager
¶¶ (
.
¶¶( )1
#GenerateChangePhoneNumberTokenAsync
¶¶) L
(
¶¶L M
User
¶¶M Q
.
¶¶Q R
Identity
¶¶R Z
.
¶¶Z [
	GetUserId
¶¶[ d
(
¶¶d e
)
¶¶e f
,
¶¶f g
phoneNumber
¶¶h s
)
¶¶s t
;
¶¶t u
return
®® 
phoneNumber
®® 
==
®® !
null
®®" &
?
®®' (
View
®®) -
(
®®- .
$str
®®. 5
)
®®5 6
:
®®7 8
View
®®9 =
(
®®= >
new
®®> A(
VerifyPhoneNumberViewModel
®®B \
{
®®] ^
PhoneNumber
®®_ j
=
®®k l
phoneNumber
®®m x
}
®®y z
)
®®z {
;
®®{ |
}
©© 	
[
≠≠ 	
HttpPost
≠≠	 
]
≠≠ 
[
ÆÆ 	&
ValidateAntiForgeryToken
ÆÆ	 !
]
ÆÆ! "
public
ØØ 
async
ØØ 
Task
ØØ 
<
ØØ 
ActionResult
ØØ &
>
ØØ& '
VerifyPhoneNumber
ØØ( 9
(
ØØ9 :(
VerifyPhoneNumberViewModel
ØØ: T
model
ØØU Z
)
ØØZ [
{
∞∞ 	
if
±± 
(
±± 
!
±± 

ModelState
±± 
.
±± 
IsValid
±± #
)
±±# $
{
≤≤ 
return
≥≥ 
View
≥≥ 
(
≥≥ 
model
≥≥ !
)
≥≥! "
;
≥≥" #
}
¥¥ 
var
µµ 
result
µµ 
=
µµ 
await
µµ 
UserManager
µµ *
.
µµ* +$
ChangePhoneNumberAsync
µµ+ A
(
µµA B
User
µµB F
.
µµF G
Identity
µµG O
.
µµO P
	GetUserId
µµP Y
(
µµY Z
)
µµZ [
,
µµ[ \
model
µµ] b
.
µµb c
PhoneNumber
µµc n
,
µµn o
model
µµp u
.
µµu v
Code
µµv z
)
µµz {
;
µµ{ |
if
∂∂ 
(
∂∂ 
result
∂∂ 
.
∂∂ 
	Succeeded
∂∂  
)
∂∂  !
{
∑∑ 
var
∏∏ 
user
∏∏ 
=
∏∏ 
await
∏∏  
UserManager
∏∏! ,
.
∏∏, -
FindByIdAsync
∏∏- :
(
∏∏: ;
User
∏∏; ?
.
∏∏? @
Identity
∏∏@ H
.
∏∏H I
	GetUserId
∏∏I R
(
∏∏R S
)
∏∏S T
)
∏∏T U
;
∏∏U V
if
ππ 
(
ππ 
user
ππ 
!=
ππ 
null
ππ  
)
ππ  !
{
∫∫ 
await
ªª 
SignInManager
ªª '
.
ªª' (
SignInAsync
ªª( 3
(
ªª3 4
user
ªª4 8
,
ªª8 9
isPersistent
ªª: F
:
ªªF G
false
ªªH M
,
ªªM N
rememberBrowser
ªªO ^
:
ªª^ _
false
ªª` e
)
ªªe f
;
ªªf g
}
ºº 
return
ΩΩ 
RedirectToAction
ΩΩ '
(
ΩΩ' (
$str
ΩΩ( /
,
ΩΩ/ 0
new
ΩΩ1 4
{
ΩΩ5 6
Message
ΩΩ7 >
=
ΩΩ? @
ManageMessageId
ΩΩA P
.
ΩΩP Q
AddPhoneSuccess
ΩΩQ `
}
ΩΩa b
)
ΩΩb c
;
ΩΩc d
}
ææ 

ModelState
¿¿ 
.
¿¿ 
AddModelError
¿¿ $
(
¿¿$ %
$str
¿¿% '
,
¿¿' (
$str
¿¿) A
)
¿¿A B
;
¿¿B C
return
¡¡ 
View
¡¡ 
(
¡¡ 
model
¡¡ 
)
¡¡ 
;
¡¡ 
}
¬¬ 	
[
∆∆ 	
HttpPost
∆∆	 
]
∆∆ 
[
«« 	&
ValidateAntiForgeryToken
««	 !
]
««! "
public
»» 
async
»» 
Task
»» 
<
»» 
ActionResult
»» &
>
»»& '
RemovePhoneNumber
»»( 9
(
»»9 :
)
»»: ;
{
…… 	
var
   
result
   
=
   
await
   
UserManager
   *
.
  * +!
SetPhoneNumberAsync
  + >
(
  > ?
User
  ? C
.
  C D
Identity
  D L
.
  L M
	GetUserId
  M V
(
  V W
)
  W X
,
  X Y
null
  Z ^
)
  ^ _
;
  _ `
if
ÀÀ 
(
ÀÀ 
!
ÀÀ 
result
ÀÀ 
.
ÀÀ 
	Succeeded
ÀÀ !
)
ÀÀ! "
{
ÃÃ 
return
ÕÕ 
RedirectToAction
ÕÕ '
(
ÕÕ' (
$str
ÕÕ( /
,
ÕÕ/ 0
new
ÕÕ1 4
{
ÕÕ5 6
Message
ÕÕ7 >
=
ÕÕ? @
ManageMessageId
ÕÕA P
.
ÕÕP Q
Error
ÕÕQ V
}
ÕÕW X
)
ÕÕX Y
;
ÕÕY Z
}
ŒŒ 
var
œœ 
user
œœ 
=
œœ 
await
œœ 
UserManager
œœ (
.
œœ( )
FindByIdAsync
œœ) 6
(
œœ6 7
User
œœ7 ;
.
œœ; <
Identity
œœ< D
.
œœD E
	GetUserId
œœE N
(
œœN O
)
œœO P
)
œœP Q
;
œœQ R
if
–– 
(
–– 
user
–– 
!=
–– 
null
–– 
)
–– 
{
—— 
await
““ 
SignInManager
““ #
.
““# $
SignInAsync
““$ /
(
““/ 0
user
““0 4
,
““4 5
isPersistent
““6 B
:
““B C
false
““D I
,
““I J
rememberBrowser
““K Z
:
““Z [
false
““\ a
)
““a b
;
““b c
}
”” 
return
‘‘ 
RedirectToAction
‘‘ #
(
‘‘# $
$str
‘‘$ +
,
‘‘+ ,
new
‘‘- 0
{
‘‘1 2
Message
‘‘3 :
=
‘‘; <
ManageMessageId
‘‘= L
.
‘‘L M 
RemovePhoneSuccess
‘‘M _
}
‘‘` a
)
‘‘a b
;
‘‘b c
}
’’ 	
public
ŸŸ 
ActionResult
ŸŸ 
ChangePassword
ŸŸ *
(
ŸŸ* +
)
ŸŸ+ ,
{
⁄⁄ 	
return
€€ 
View
€€ 
(
€€ 
)
€€ 
;
€€ 
}
‹‹ 	
[
‡‡ 	
HttpPost
‡‡	 
]
‡‡ 
[
·· 	&
ValidateAntiForgeryToken
··	 !
]
··! "
public
‚‚ 
async
‚‚ 
Task
‚‚ 
<
‚‚ 
ActionResult
‚‚ &
>
‚‚& '
ChangePassword
‚‚( 6
(
‚‚6 7%
ChangePasswordViewModel
‚‚7 N
model
‚‚O T
)
‚‚T U
{
„„ 	
if
‰‰ 
(
‰‰ 
!
‰‰ 

ModelState
‰‰ 
.
‰‰ 
IsValid
‰‰ #
)
‰‰# $
{
ÂÂ 
return
ÊÊ 
View
ÊÊ 
(
ÊÊ 
model
ÊÊ !
)
ÊÊ! "
;
ÊÊ" #
}
ÁÁ 
var
ËË 
result
ËË 
=
ËË 
await
ËË 
UserManager
ËË *
.
ËË* +!
ChangePasswordAsync
ËË+ >
(
ËË> ?
User
ËË? C
.
ËËC D
Identity
ËËD L
.
ËËL M
	GetUserId
ËËM V
(
ËËV W
)
ËËW X
,
ËËX Y
model
ËËZ _
.
ËË_ `
OldPassword
ËË` k
,
ËËk l
model
ËËm r
.
ËËr s
NewPassword
ËËs ~
)
ËË~ 
;ËË Ä
if
ÈÈ 
(
ÈÈ 
result
ÈÈ 
.
ÈÈ 
	Succeeded
ÈÈ  
)
ÈÈ  !
{
ÍÍ 
var
ÎÎ 
user
ÎÎ 
=
ÎÎ 
await
ÎÎ  
UserManager
ÎÎ! ,
.
ÎÎ, -
FindByIdAsync
ÎÎ- :
(
ÎÎ: ;
User
ÎÎ; ?
.
ÎÎ? @
Identity
ÎÎ@ H
.
ÎÎH I
	GetUserId
ÎÎI R
(
ÎÎR S
)
ÎÎS T
)
ÎÎT U
;
ÎÎU V
if
ÏÏ 
(
ÏÏ 
user
ÏÏ 
!=
ÏÏ 
null
ÏÏ  
)
ÏÏ  !
{
ÌÌ 
await
ÓÓ 
SignInManager
ÓÓ '
.
ÓÓ' (
SignInAsync
ÓÓ( 3
(
ÓÓ3 4
user
ÓÓ4 8
,
ÓÓ8 9
isPersistent
ÓÓ: F
:
ÓÓF G
false
ÓÓH M
,
ÓÓM N
rememberBrowser
ÓÓO ^
:
ÓÓ^ _
false
ÓÓ` e
)
ÓÓe f
;
ÓÓf g
}
ÔÔ 
return
 
RedirectToAction
 '
(
' (
$str
( /
,
/ 0
new
1 4
{
5 6
Message
7 >
=
? @
ManageMessageId
A P
.
P Q#
ChangePasswordSuccess
Q f
}
g h
)
h i
;
i j
}
ÒÒ 
	AddErrors
ÚÚ 
(
ÚÚ 
result
ÚÚ 
)
ÚÚ 
;
ÚÚ 
return
ÛÛ 
View
ÛÛ 
(
ÛÛ 
model
ÛÛ 
)
ÛÛ 
;
ÛÛ 
}
ÙÙ 	
public
¯¯ 
ActionResult
¯¯ 
SetPassword
¯¯ '
(
¯¯' (
)
¯¯( )
{
˘˘ 	
return
˙˙ 
View
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 	
[
ˇˇ 	
HttpPost
ˇˇ	 
]
ˇˇ 
[
ÄÄ 	&
ValidateAntiForgeryToken
ÄÄ	 !
]
ÄÄ! "
public
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
<
ÅÅ 
ActionResult
ÅÅ &
>
ÅÅ& '
SetPassword
ÅÅ( 3
(
ÅÅ3 4"
SetPasswordViewModel
ÅÅ4 H
model
ÅÅI N
)
ÅÅN O
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 

ModelState
ÉÉ 
.
ÉÉ 
IsValid
ÉÉ "
)
ÉÉ" #
{
ÑÑ 
var
ÖÖ 
result
ÖÖ 
=
ÖÖ 
await
ÖÖ "
UserManager
ÖÖ# .
.
ÖÖ. /
AddPasswordAsync
ÖÖ/ ?
(
ÖÖ? @
User
ÖÖ@ D
.
ÖÖD E
Identity
ÖÖE M
.
ÖÖM N
	GetUserId
ÖÖN W
(
ÖÖW X
)
ÖÖX Y
,
ÖÖY Z
model
ÖÖ[ `
.
ÖÖ` a
NewPassword
ÖÖa l
)
ÖÖl m
;
ÖÖm n
if
ÜÜ 
(
ÜÜ 
result
ÜÜ 
.
ÜÜ 
	Succeeded
ÜÜ $
)
ÜÜ$ %
{
áá 
var
àà 
user
àà 
=
àà 
await
àà $
UserManager
àà% 0
.
àà0 1
FindByIdAsync
àà1 >
(
àà> ?
User
àà? C
.
ààC D
Identity
ààD L
.
ààL M
	GetUserId
ààM V
(
ààV W
)
ààW X
)
ààX Y
;
ààY Z
if
ââ 
(
ââ 
user
ââ 
!=
ââ 
null
ââ  $
)
ââ$ %
{
ää 
await
ãã 
SignInManager
ãã +
.
ãã+ ,
SignInAsync
ãã, 7
(
ãã7 8
user
ãã8 <
,
ãã< =
isPersistent
ãã> J
:
ããJ K
false
ããL Q
,
ããQ R
rememberBrowser
ããS b
:
ããb c
false
ããd i
)
ããi j
;
ããj k
}
åå 
return
çç 
RedirectToAction
çç +
(
çç+ ,
$str
çç, 3
,
çç3 4
new
çç5 8
{
çç9 :
Message
çç; B
=
ççC D
ManageMessageId
ççE T
.
ççT U 
SetPasswordSuccess
ççU g
}
ççh i
)
ççi j
;
ççj k
}
éé 
	AddErrors
èè 
(
èè 
result
èè  
)
èè  !
;
èè! "
}
êê 
return
ìì 
View
ìì 
(
ìì 
model
ìì 
)
ìì 
;
ìì 
}
îî 	
public
òò 
async
òò 
Task
òò 
<
òò 
ActionResult
òò &
>
òò& '
ManageLogins
òò( 4
(
òò4 5
ManageMessageId
òò5 D
?
òòD E
message
òòF M
)
òòM N
{
ôô 	
ViewBag
öö 
.
öö 
StatusMessage
öö !
=
öö" #
message
õõ 
==
õõ 
ManageMessageId
õõ *
.
õõ* + 
RemoveLoginSuccess
õõ+ =
?
õõ> ?
$str
õõ@ a
:
úú 
message
úú 
==
úú 
ManageMessageId
úú ,
.
úú, -
Error
úú- 2
?
úú3 4
$str
úú5 M
:
ùù 
$str
ùù 
;
ùù 
var
ûû 
user
ûû 
=
ûû 
await
ûû 
UserManager
ûû (
.
ûû( )
FindByIdAsync
ûû) 6
(
ûû6 7
User
ûû7 ;
.
ûû; <
Identity
ûû< D
.
ûûD E
	GetUserId
ûûE N
(
ûûN O
)
ûûO P
)
ûûP Q
;
ûûQ R
if
üü 
(
üü 
user
üü 
==
üü 
null
üü 
)
üü 
{
†† 
return
°° 
View
°° 
(
°° 
$str
°° #
)
°°# $
;
°°$ %
}
¢¢ 
var
££ 

userLogins
££ 
=
££ 
await
££ "
UserManager
££# .
.
££. /
GetLoginsAsync
££/ =
(
££= >
User
££> B
.
££B C
Identity
££C K
.
££K L
	GetUserId
££L U
(
££U V
)
££V W
)
££W X
;
££X Y
var
§§ 
otherLogins
§§ 
=
§§ #
AuthenticationManager
§§ 3
.
§§3 4,
GetExternalAuthenticationTypes
§§4 R
(
§§R S
)
§§S T
.
§§T U
Where
§§U Z
(
§§Z [
auth
§§[ _
=>
§§` b

userLogins
§§c m
.
§§m n
All
§§n q
(
§§q r
ul
§§r t
=>
§§u w
auth
§§x |
.
§§| }!
AuthenticationType§§} è
!=§§ê í
ul§§ì ï
.§§ï ñ
LoginProvider§§ñ £
)§§£ §
)§§§ •
.§§• ¶
ToList§§¶ ¨
(§§¨ ≠
)§§≠ Æ
;§§Æ Ø
ViewBag
•• 
.
•• 
ShowRemoveButton
•• $
=
••% &
user
••' +
.
••+ ,
PasswordHash
••, 8
!=
••9 ;
null
••< @
||
••A C

userLogins
••D N
.
••N O
Count
••O T
>
••U V
$num
••W X
;
••X Y
return
¶¶ 
View
¶¶ 
(
¶¶ 
new
¶¶ #
ManageLoginsViewModel
¶¶ 1
{
ßß 
CurrentLogins
®® 
=
®® 

userLogins
®®  *
,
®®* +
OtherLogins
©© 
=
©© 
otherLogins
©© )
}
™™ 
)
™™ 
;
™™ 
}
´´ 	
[
ØØ 	
HttpPost
ØØ	 
]
ØØ 
[
∞∞ 	&
ValidateAntiForgeryToken
∞∞	 !
]
∞∞! "
public
±± 
ActionResult
±± 
	LinkLogin
±± %
(
±±% &
string
±±& ,
provider
±±- 5
)
±±5 6
{
≤≤ 	
return
¥¥ 
new
¥¥ 
AccountController
¥¥ (
.
¥¥( )
ChallengeResult
¥¥) 8
(
¥¥8 9
provider
¥¥9 A
,
¥¥A B
Url
¥¥C F
.
¥¥F G
Action
¥¥G M
(
¥¥M N
$str
¥¥N a
,
¥¥a b
$str
¥¥c k
)
¥¥k l
,
¥¥l m
User
¥¥n r
.
¥¥r s
Identity
¥¥s {
.
¥¥{ |
	GetUserId¥¥| Ö
(¥¥Ö Ü
)¥¥Ü á
)¥¥á à
;¥¥à â
}
µµ 	
public
ππ 
async
ππ 
Task
ππ 
<
ππ 
ActionResult
ππ &
>
ππ& '
LinkLoginCallback
ππ( 9
(
ππ9 :
)
ππ: ;
{
∫∫ 	
var
ªª 
	loginInfo
ªª 
=
ªª 
await
ªª !#
AuthenticationManager
ªª" 7
.
ªª7 8'
GetExternalLoginInfoAsync
ªª8 Q
(
ªªQ R
XsrfKey
ªªR Y
,
ªªY Z
User
ªª[ _
.
ªª_ `
Identity
ªª` h
.
ªªh i
	GetUserId
ªªi r
(
ªªr s
)
ªªs t
)
ªªt u
;
ªªu v
if
ºº 
(
ºº 
	loginInfo
ºº 
==
ºº 
null
ºº !
)
ºº! "
{
ΩΩ 
return
ææ 
RedirectToAction
ææ '
(
ææ' (
$str
ææ( 6
,
ææ6 7
new
ææ8 ;
{
ææ< =
Message
ææ> E
=
ææF G
ManageMessageId
ææH W
.
ææW X
Error
ææX ]
}
ææ^ _
)
ææ_ `
;
ææ` a
}
øø 
var
¿¿ 
result
¿¿ 
=
¿¿ 
await
¿¿ 
UserManager
¿¿ *
.
¿¿* +
AddLoginAsync
¿¿+ 8
(
¿¿8 9
User
¿¿9 =
.
¿¿= >
Identity
¿¿> F
.
¿¿F G
	GetUserId
¿¿G P
(
¿¿P Q
)
¿¿Q R
,
¿¿R S
	loginInfo
¿¿T ]
.
¿¿] ^
Login
¿¿^ c
)
¿¿c d
;
¿¿d e
return
¡¡ 
result
¡¡ 
.
¡¡ 
	Succeeded
¡¡ #
?
¡¡$ %
RedirectToAction
¡¡& 6
(
¡¡6 7
$str
¡¡7 E
)
¡¡E F
:
¡¡G H
RedirectToAction
¡¡I Y
(
¡¡Y Z
$str
¡¡Z h
,
¡¡h i
new
¡¡j m
{
¡¡n o
Message
¡¡p w
=
¡¡x y
ManageMessageId¡¡z â
.¡¡â ä
Error¡¡ä è
}¡¡ê ë
)¡¡ë í
;¡¡í ì
}
¬¬ 	
	protected
ƒƒ 
override
ƒƒ 
void
ƒƒ 
Dispose
ƒƒ  '
(
ƒƒ' (
bool
ƒƒ( ,
	disposing
ƒƒ- 6
)
ƒƒ6 7
{
≈≈ 	
if
∆∆ 
(
∆∆ 
	disposing
∆∆ 
&&
∆∆ 
_userManager
∆∆ )
!=
∆∆* ,
null
∆∆- 1
)
∆∆1 2
{
«« 
_userManager
»» 
.
»» 
Dispose
»» $
(
»»$ %
)
»»% &
;
»»& '
_userManager
…… 
=
…… 
null
…… #
;
……# $
}
   
base
ÃÃ 
.
ÃÃ 
Dispose
ÃÃ 
(
ÃÃ 
	disposing
ÃÃ "
)
ÃÃ" #
;
ÃÃ# $
}
ÕÕ 	
private
—— 
const
—— 
string
—— 
XsrfKey
—— $
=
——% &
$str
——' /
;
——/ 0
private
”” $
IAuthenticationManager
”” &#
AuthenticationManager
””' <
{
‘‘ 	
get
’’ 
{
÷÷ 
return
◊◊ 
HttpContext
◊◊ "
.
◊◊" #
GetOwinContext
◊◊# 1
(
◊◊1 2
)
◊◊2 3
.
◊◊3 4
Authentication
◊◊4 B
;
◊◊B C
}
ÿÿ 
}
ŸŸ 	
private
€€ 
void
€€ 
	AddErrors
€€ 
(
€€ 
IdentityResult
€€ -
result
€€. 4
)
€€4 5
{
‹‹ 	
foreach
›› 
(
›› 
var
›› 
error
›› 
in
›› !
result
››" (
.
››( )
Errors
››) /
)
››/ 0
{
ﬁﬁ 

ModelState
ﬂﬂ 
.
ﬂﬂ 
AddModelError
ﬂﬂ (
(
ﬂﬂ( )
$str
ﬂﬂ) +
,
ﬂﬂ+ ,
error
ﬂﬂ- 2
)
ﬂﬂ2 3
;
ﬂﬂ3 4
}
‡‡ 
}
·· 	
private
„„ 
bool
„„ 
HasPassword
„„  
(
„„  !
)
„„! "
{
‰‰ 	
var
ÂÂ 
user
ÂÂ 
=
ÂÂ 
UserManager
ÂÂ "
.
ÂÂ" #
FindById
ÂÂ# +
(
ÂÂ+ ,
User
ÂÂ, 0
.
ÂÂ0 1
Identity
ÂÂ1 9
.
ÂÂ9 :
	GetUserId
ÂÂ: C
(
ÂÂC D
)
ÂÂD E
)
ÂÂE F
;
ÂÂF G
if
ÊÊ 
(
ÊÊ 
user
ÊÊ 
!=
ÊÊ 
null
ÊÊ 
)
ÊÊ 
{
ÁÁ 
return
ËË 
user
ËË 
.
ËË 
PasswordHash
ËË (
!=
ËË) +
null
ËË, 0
;
ËË0 1
}
ÈÈ 
return
ÍÍ 
false
ÍÍ 
;
ÍÍ 
}
ÎÎ 	
private
ÌÌ 
bool
ÌÌ 
HasPhoneNumber
ÌÌ #
(
ÌÌ# $
)
ÌÌ$ %
{
ÓÓ 	
var
ÔÔ 
user
ÔÔ 
=
ÔÔ 
UserManager
ÔÔ "
.
ÔÔ" #
FindById
ÔÔ# +
(
ÔÔ+ ,
User
ÔÔ, 0
.
ÔÔ0 1
Identity
ÔÔ1 9
.
ÔÔ9 :
	GetUserId
ÔÔ: C
(
ÔÔC D
)
ÔÔD E
)
ÔÔE F
;
ÔÔF G
if
 
(
 
user
 
!=
 
null
 
)
 
{
ÒÒ 
return
ÚÚ 
user
ÚÚ 
.
ÚÚ 
PhoneNumber
ÚÚ '
!=
ÚÚ( *
null
ÚÚ+ /
;
ÚÚ/ 0
}
ÛÛ 
return
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ıı 	
public
˜˜ 
enum
˜˜ 
ManageMessageId
˜˜ #
{
¯¯ 	
AddPhoneSuccess
˘˘ 
,
˘˘ #
ChangePasswordSuccess
˙˙ !
,
˙˙! "!
SetTwoFactorSuccess
˚˚ 
,
˚˚   
SetPasswordSuccess
¸¸ 
,
¸¸  
RemoveLoginSuccess
˝˝ 
,
˝˝  
RemovePhoneSuccess
˛˛ 
,
˛˛ 
Error
ˇˇ 
}
ÄÄ 	
}
ÉÉ 
}ÑÑ æ¶
PE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\TestingController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
TestingController "
:# $
BaseController% 3
{ 
public 
ActionResult 
Index !
(! "
Guid" &
?& '
id( *
)* +
{ 	
var 
campaign 
= 
Db 
. 
	Campaigns '
. 
Include 
( 
c 
=> 
c 
.  
Assets  &
)& '
. 
Include 
( 
c 
=> 
c 
.  
Testing  '
)' (
. 
FirstOrDefault 
(  
c  !
=>" $
c% &
.& '
Id' )
==* ,
id- /
)/ 0
;0 1
if 
( 
campaign 
== 
null  
)  !
return" (
View) -
(- .
$str. 5
)5 6
;6 7
Session 
[ 
$str 
] 
= 
id 
; 
Session 
[ 
$str !
]! "
=# $
campaign% -
.- .
OrderNumber. 9
;9 :
if   
(   
campaign   
.   
Testing    
==  ! #
null  $ (
)  ( )
{!! 
campaign"" 
."" 
Assets"" 
.""  

ZipCodeUrl""  *
=""+ ,
$"""- //
#http://www.digitaldynamixs.net/ep2/""/ R
{""R S
campaign""S [
.""[ \
OrderNumber""\ g
}""g h
/""h i
{""i j
campaign""j r
.""r s
OrderNumber""s ~
}""~ 
zip.csv	"" Ü
"
""Ü á
;
""á à
campaign## 
.## 
Assets## 
.##  
CreativeUrl##  +
=##, -
$"##- //
#http://www.digitaldynamixs.net/ep2/##/ R
{##R S
campaign##S [
.##[ \
OrderNumber##\ g
}##g h
/##h i
{##i j
campaign##j r
.##r s
OrderNumber##s ~
}##~ 
.htm	## É
"
##É Ñ
;
##Ñ Ö
var%% 
	testingId%% 
=%% 
Guid%%  $
.%%$ %
NewGuid%%% ,
(%%, -
)%%- .
;%%. /
var&& 
testing&& 
=&& 
new&& !
CampaignTesting&&" 1
(&&1 2
)&&2 3
{'' 
Id(( 
=(( 
	testingId(( "
,((" #

CampaignId)) 
=))  
campaign))! )
.))) *
Id))* ,
,)), -
	CreatedAt** 
=** 
DateTime**  (
.**( )
Now**) ,
,**, -
	CreatedBy++ 
=++ 
campaign++  (
.++( )
	CreatedBy++) 2
,++2 3
CampaignName,,  
=,,! "
campaign,,# +
.,,+ ,
CampaignName,,, 8
,,,8 9

WhiteLabel-- 
=--  
campaign--! )
.--) *

WhiteLabel--* 4
,--4 5
ReBroadCast.. 
=..  !
campaign.." *
...* +
ReBroadCast..+ 6
,..6 7
ReBroadcastDate// #
=//$ %
campaign//& .
.//. /
ReBroadcastDate/// >
,//> ?
FromLine00 
=00 
campaign00 '
.00' (
FromLine00( 0
,000 1
SubjectLine11 
=11  !
campaign11" *
.11* +
SubjectLine11+ 6
,116 7
TestingUrgency33 "
=33# $
campaign33% -
.33- .
TestingUrgency33. <
,33< =

DeployDate44 
=44  
campaign44! )
.44) *
BroadcastDate44* 7
,447 8

GeoDetails55 
=55  
campaign55! )
.55) *

GeoDetails55* 4
,554 5
Demographics66  
=66! "
campaign66# +
.66+ ,
Demographics66, 8
,668 9
Quantity77 
=77 
campaign77 '
.77' (
Quantity77( 0
,770 1
SpecialInstructions88 '
=88( )
campaign88* 2
.882 3
SpecialInstructions883 F
,88F G
IsOpenPixel:: 
=::  !
campaign::" *
.::* +
IsOpenPixel::+ 6
,::6 7
OpenPixelUrl;;  
=;;! "
campaign;;# +
.;;+ ,
OpenPixelUrl;;, 8
,;;8 9
	OpenGoals<< 
=<< 
campaign<<  (
.<<( )
Quantity<<) 1
*<<2 3
$num<<4 6
/<<7 8
$num<<9 <
,<<< =

ClickGoals== 
===  
campaign==! )
.==) *
Quantity==* 2
*==3 4
$num==5 7
/==8 9
$num==: =
,=== >
DataFileQuantity>> $
=>>% &
campaign>>' /
.>>/ 0
DataFileQuantity>>0 @
,>>@ A
IsOmniOrderAA 
=AA  !
campaignAA" *
.AA* +
IsOmniOrderAA+ 6
,AA6 7
OmniDeployDateBB "
=BB# $
campaignBB% -
.BB- .
OmniDeployDateBB. <
,BB< =
ImpressionsCC 
=CC  !
campaignCC" *
.CC* +
ImpressionsCC+ 6
,CC6 7
ChannelTypesDD  
=DD! "
campaignDD# +
.DD+ ,
ChannelTypesDD, 8
,DD8 9
}FF 
;FF 
DbGG 
.GG 
CampaignsTestingGG #
.GG# $
AddGG$ '
(GG' (
testingGG( /
)GG/ 0
;GG0 1
DbHH 
.HH 
SaveChangesHH 
(HH 
)HH  
;HH  !
campaignJJ 
.JJ 
	TestingIdJJ "
=JJ# $
	testingIdJJ% .
;JJ. /
DbKK 
.KK 
SaveChangesKK 
(KK 
)KK  
;KK  !
}LL 
campaignMM 
.MM 
StatusMM 
=MM 
(MM 
intMM "
)MM" #
CampaignStatusMM# 1
.MM1 2
TestingMM2 9
;MM9 :
DbNN 
.NN 
SaveChangesNN 
(NN 
)NN 
;NN 
returnOO 
RedirectToActionOO #
(OO# $
$strOO$ 1
,OO1 2
$strOO3 <
,OO< =
newOO> A
{OOB C
idOOD F
=OOG H
campaignOOI Q
.OOQ R
	TestingIdOOR [
}OO\ ]
)OO] ^
;OO^ _
}PP 	
staticSS 
charSS 
_c1SS 
;SS 
publicTT 
ActionResultTT 
EditTestingTT '
(TT' (
GuidTT( ,
?TT, -
idTT. 0
)TT0 1
{UU 	
varVV 
campaignTestingVV 
=VV  !
DbVV" $
.VV$ %
CampaignsTestingVV% 5
.VV5 6
FirstOrDefaultVV6 D
(VVD E
cVVE F
=>VVG I
cVVJ K
.VVK L
IdVVL N
==VVO Q
idVVR T
)VVT U
;VVU V
ifXX 
(XX 
campaignTestingXX 
==XX  "
nullXX# '
)XX' (
{YY 
throwZZ 
newZZ 
HttpExceptionZZ '
(ZZ' (
$numZZ( +
,ZZ+ ,
$strZZ- 8
)ZZ8 9
;ZZ9 :
}[[ 

TinyMapper]] 
.]] 
Bind]] 
<]] 
CampaignTesting]] +
,]]+ ,
CampaignTestingVm]]- >
>]]> ?
(]]? @
config]]@ F
=>]]G I
{^^ 
config__ 
.__ 
Ignore__ 
(__ 
x__ 
=>__  "
x__# $
.__$ %
ChannelTypes__% 1
)__1 2
;__2 3
}`` 
)`` 
;`` 
varbb 
campaignTestingVmbb !
=bb" #

TinyMapperbb$ .
.bb. /
Mapbb/ 2
<bb2 3
CampaignTestingVmbb3 D
>bbD E
(bbE F
campaignTestingbbF U
)bbU V
;bbV W
Campaigncc 
campaigncc 
=cc 
Dbcc  "
.cc" #
	Campaignscc# ,
.dd 
Includedd 
(dd 
xdd 
=>dd  
xdd! "
.dd" #
Assetsdd# )
)dd) *
.ee 
Includeee 
(ee 
xee 
=>ee  
xee! "
.ee" #
Segmentsee# +
)ee+ ,
.ff 
FirstOrDefaultff "
(ff" #
xff# $
=>ff% '
xff( )
.ff) *
Idff* ,
==ff- /
campaignTestingff0 ?
.ff? @

CampaignIdff@ J
)ffJ K
;ffK L
campaignTestingVmgg 
.gg 
OrderNumbergg )
=gg* +
campaigngg, 4
.gg4 5
OrderNumbergg5 @
;gg@ A
ifhh 
(hh 
campaignhh 
.hh 
Assetshh 
==hh  "
nullhh# '
)hh' (
{ii 
varjj 
assetIdjj 
=jj 
Guidjj "
.jj" #
NewGuidjj# *
(jj* +
)jj+ ,
;jj, -
Dbkk 
.kk 
CampaignAssetskk !
.kk! "
Addkk" %
(kk% &
newkk& )
CampaignAssetkk* 7
(kk7 8
)kk8 9
{ll 
Idmm 
=mm 
assetIdmm  
,mm  !

CampaignIdnn 
=nn  
campaignnn! )
.nn) *
Idnn* ,
,nn, -
	CreatedAtoo 
=oo 
DateTimeoo  (
.oo( )
Nowoo) ,
}pp 
)pp 
;pp 
campaignqq 
.qq 
AssetsIdqq !
=qq" #
assetIdqq$ +
;qq+ ,
Dbrr 
.rr 
SaveChangesrr 
(rr 
)rr  
;rr  !
campaignss 
=ss 
Dbss 
.ss 
	Campaignsss '
.tt 
Includett 
(tt 
xtt 
=>tt  
xtt! "
.tt" #
Assetstt# )
)tt) *
.uu 
Includeuu 
(uu 
xuu 
=>uu  
xuu! "
.uu" #
Segmentsuu# +
)uu+ ,
.vv 
FirstOrDefaultvv "
(vv" #
xvv# $
=>vv% '
xvv( )
.vv) *
Idvv* ,
==vv- /
campaignTestingvv0 ?
.vv? @

CampaignIdvv@ J
)vvJ K
;vvK L
}ww 
campaignTestingVmxx 
.xx 
Assetsxx $
=xx% &
campaignxx' /
.xx/ 0
Assetsxx0 6
;xx6 7
_c1yy 
=yy 
$charyy 
;yy 
foreachzz 
(zz 
varzz 
segmentzz  
inzz! #
campaignzz$ ,
.zz, -
Segmentszz- 5
.zz5 6
OrderByzz6 =
(zz= >
xzz> ?
=>zz@ B
xzzC D
.zzD E
SegmentNumberzzE R
)zzR S
)zzS T
{{{ 
var|| 
	segmentVm|| 
=|| 

TinyMapper||  *
.||* +
Map||+ .
<||. /
CampaignSegmentVm||/ @
>||@ A
(||A B
segment||B I
)||I J
;||J K
campaignTestingVm}} !
.}}! "
Segments}}" *
.}}* +
Add}}+ .
(}}. /
	segmentVm}}/ 8
)}}8 9
;}}9 :
_c1~~ 
=~~ 
segment~~ 
.~~ 
SegmentNumber~~ +
.~~+ ,
Replace~~, 3
(~~3 4
campaignTestingVm~~4 E
.~~E F
OrderNumber~~F Q
,~~Q R
string~~S Y
.~~Y Z
Empty~~Z _
)~~_ `
.~~` a
ToCharArray~~a l
(~~l m
)~~m n
.~~n o
Select~~o u
(~~u v
x~~v w
=>~~x z
++~~{ }
x~~} ~
)~~~ 
.	~~ Ä
FirstOrDefault
~~Ä é
(
~~é è
)
~~è ê
;
~~ê ë
} 
campaignTestingVm
ÄÄ 
.
ÄÄ 
ChannelTypes
ÄÄ *
=
ÄÄ+ ,
string
ÄÄ- 3
.
ÄÄ3 4
IsNullOrEmpty
ÄÄ4 A
(
ÄÄA B
campaignTesting
ÄÄB Q
.
ÄÄQ R
ChannelTypes
ÄÄR ^
)
ÄÄ^ _
?
ÄÄ` a
new
ÄÄb e
List
ÄÄf j
<
ÄÄj k
ChannelType
ÄÄk v
>
ÄÄv w
{
ÄÄx y
}
ÄÄz {
:
ÄÄ| }
campaignTesting
ÅÅ 
.
ÅÅ  
ChannelTypes
ÅÅ  ,
.
ÇÇ 
Split
ÇÇ 
(
ÇÇ 
$str
ÇÇ 
.
ÇÇ 
ToCharArray
ÇÇ *
(
ÇÇ* +
)
ÇÇ+ ,
)
ÇÇ, -
.
ÉÉ 
Select
ÉÉ 
(
ÉÉ 
x
ÉÉ 
=>
ÉÉ  
(
ÉÉ! "
ChannelType
ÉÉ" -
)
ÉÉ- .
System
ÉÉ. 4
.
ÉÉ4 5
Enum
ÉÉ5 9
.
ÉÉ9 :
Parse
ÉÉ: ?
(
ÉÉ? @
typeof
ÉÉ@ F
(
ÉÉF G
ChannelType
ÉÉG R
)
ÉÉR S
,
ÉÉS T
x
ÉÉT U
)
ÉÉU V
)
ÉÉV W
.
ÉÉW X
ToList
ÉÉX ^
(
ÉÉ^ _
)
ÉÉ_ `
;
ÉÉ` a
ViewBag
ÑÑ 
.
ÑÑ 
TestingUrgency
ÑÑ "
=
ÑÑ# $
new
ÑÑ% (

SelectList
ÑÑ) 3
(
ÑÑ3 4

EnumHelper
ÑÑ4 >
.
ÑÑ> ?
GetEnumTextValues
ÑÑ? P
(
ÑÑP Q
typeof
ÑÑQ W
(
ÑÑW X
TestingUrgency
ÑÑX f
)
ÑÑf g
)
ÑÑg h
,
ÑÑh i
$str
ÑÑj q
,
ÑÑq r
$str
ÖÖ 
,
ÖÖ 
campaignTestingVm
ÖÖ )
.
ÖÖ) *
TestingUrgency
ÖÖ* 8
)
ÖÖ8 9
;
ÖÖ9 :
ViewBag
ÜÜ 
.
ÜÜ 

WhiteLabel
ÜÜ 
=
ÜÜ  
new
ÜÜ! $

SelectList
ÜÜ% /
(
ÜÜ/ 0
CustomersList
ÜÜ0 =
,
ÜÜ= >
$str
ÜÜ? F
,
ÜÜF G
$str
ÜÜH N
,
ÜÜN O
campaignTestingVm
ÜÜP a
.
ÜÜa b

WhiteLabel
ÜÜb l
)
ÜÜl m
;
ÜÜm n
return
áá 
View
áá 
(
áá 
campaignTestingVm
áá )
)
áá) *
;
áá* +
}
àà 	
public
ää 
ActionResult
ää 

NewSegment
ää &
(
ää& '
string
ää' -
orderNumber
ää. 9
)
ää9 :
{
ãã 	
var
çç 
segment
çç 
=
çç 
new
çç 
CampaignSegment
çç -
(
çç- .
)
çç. /
{
éé 
Id
èè 
=
èè 
Guid
èè 
.
èè 
NewGuid
èè !
(
èè! "
)
èè" #
,
èè# $
	CreatedAt
êê 
=
êê 
DateTime
êê $
.
êê$ %
Now
êê% (
,
êê( )
SegmentNumber
ëë 
=
ëë 
orderNumber
ëë  +
+
ëë, -
_c1
ëë. 1
++
ëë1 3
}
íí 
;
íí 
return
ìì 
PartialView
ìì 
(
ìì 
$str
ìì J
,
ììJ K
segment
ììL S
)
ììS T
;
ììT U
}
îî 	
[
óó 	
HttpPost
óó	 
]
óó 
[
òò 	&
ValidateAntiForgeryToken
òò	 !
]
òò! "
[
ôô 	
MultipleButton
ôô	 
(
ôô 
Name
ôô 
=
ôô 
$str
ôô '
,
ôô' (
Argument
ôô) 1
=
ôô2 3
$str
ôô4 A
)
ôôA B
]
ôôB C
public
öö 
ActionResult
öö 
EditTesting
öö '
(
öö' (
[
öö( )
Bind
öö) -
(
öö- .
Include
öö. 5
=
öö6 7
$strõõ Ω
)
úú 
]
úú 
CampaignTestingVm
úú  
campaignTestingVm
úú! 2
)
úú2 3
{
ùù 	
if
ûû 
(
ûû 

ModelState
ûû 
.
ûû 
IsValid
ûû "
)
ûû" #
{
üü 

TinyMapper
°° 
.
°° 
Bind
°° 
<
°°  
CampaignTestingVm
°°  1
,
°°1 2
CampaignTesting
°°3 B
>
°°B C
(
°°C D
config
°°D J
=>
°°K M
{
¢¢ 
config
££ 
.
££ 
Ignore
££ !
(
££! "
x
££" #
=>
££$ &
x
££' (
.
££( )
ChannelTypes
££) 5
)
££5 6
;
££6 7
config
§§ 
.
§§ 
Ignore
§§ !
(
§§! "
x
§§" #
=>
§§$ &
x
§§' (
.
§§( )
Assets
§§) /
)
§§/ 0
;
§§0 1
config
•• 
.
•• 
Ignore
•• !
(
••! "
x
••" #
=>
••$ &
x
••' (
.
••( )
Segments
••) 1
)
••1 2
;
••2 3
}
¶¶ 
)
¶¶ 
;
¶¶ 
var
ßß 
campaignTesting
ßß #
=
ßß$ %

TinyMapper
ßß& 0
.
ßß0 1
Map
ßß1 4
<
ßß4 5
CampaignTesting
ßß5 D
>
ßßD E
(
ßßE F
campaignTestingVm
ßßF W
)
ßßW X
;
ßßX Y
campaignTesting
®® 
.
®®  
ChannelTypes
®®  ,
=
®®- .
campaignTestingVm
®®/ @
.
®®@ A
ChannelTypes
®®A M
==
®®N P
null
®®Q U
?
®®V W
null
®®X \
:
®®] ^
string
©© 
.
©© 
Join
©© 
(
©©  
$str
©©  #
,
©©# $
campaignTestingVm
©©% 6
.
©©6 7
ChannelTypes
©©7 C
)
©©C D
;
©©D E
Db
™™ 
.
™™ 
Entry
™™ 
(
™™ 
campaignTesting
™™ (
)
™™( )
.
™™) *
State
™™* /
=
™™0 1
EntityState
™™2 =
.
™™= >
Modified
™™> F
;
™™F G
Db
´´ 
.
´´ 
SaveChanges
´´ 
(
´´ 
)
´´  
;
´´  !
var
ÆÆ 
campaignAssets
ÆÆ "
=
ÆÆ# $
Db
ÆÆ% '
.
ÆÆ' (
CampaignAssets
ÆÆ( 6
.
ÆÆ6 7
FirstOrDefault
ÆÆ7 E
(
ÆÆE F
x
ÆÆF G
=>
ÆÆH J
x
ÆÆK L
.
ÆÆL M

CampaignId
ÆÆM W
==
ÆÆX Z
campaignTestingVm
ÆÆ[ l
.
ÆÆl m

CampaignId
ÆÆm w
)
ÆÆw x
;
ÆÆx y
campaignAssets
ØØ 
.
ØØ 
CreativeFiles
ØØ ,
=
ØØ- .
campaignTestingVm
ØØ/ @
.
ØØ@ A
Assets
ØØA G
.
ØØG H
CreativeFiles
ØØH U
;
ØØU V
campaignAssets
∞∞ 
.
∞∞ 
CreativeUrl
∞∞ *
=
∞∞+ ,
campaignTestingVm
∞∞- >
.
∞∞> ?
Assets
∞∞? E
.
∞∞E F
CreativeUrl
∞∞F Q
;
∞∞Q R
campaignAssets
±± 
.
±± 
ZipCodeFile
±± *
=
±±+ ,
campaignTestingVm
±±- >
.
±±> ?
Assets
±±? E
.
±±E F
ZipCodeFile
±±F Q
;
±±Q R
campaignAssets
≤≤ 
.
≤≤ 

ZipCodeUrl
≤≤ )
=
≤≤* +
campaignTestingVm
≤≤, =
.
≤≤= >
Assets
≤≤> D
.
≤≤D E

ZipCodeUrl
≤≤E O
;
≤≤O P
campaignAssets
≥≥ 
.
≥≥ 
TestSeedFile
≥≥ +
=
≥≥, -
campaignTestingVm
≥≥. ?
.
≥≥? @
Assets
≥≥@ F
.
≥≥F G
TestSeedFile
≥≥G S
;
≥≥S T
campaignAssets
¥¥ 
.
¥¥ 
LiveSeedFile
¥¥ +
=
¥¥, -
campaignTestingVm
¥¥. ?
.
¥¥? @
Assets
¥¥@ F
.
¥¥F G
LiveSeedFile
¥¥G S
;
¥¥S T
Db
µµ 
.
µµ 
Entry
µµ 
(
µµ 
campaignAssets
µµ '
)
µµ' (
.
µµ( )
State
µµ) .
=
µµ/ 0
EntityState
µµ1 <
.
µµ< =
Modified
µµ= E
;
µµE F
Db
∂∂ 
.
∂∂ 
SaveChanges
∂∂ 
(
∂∂ 
)
∂∂  
;
∂∂  !
if
ππ 
(
ππ 
campaignTestingVm
ππ $
.
ππ$ %
Segments
ππ% -
!=
ππ. 0
null
ππ1 5
)
ππ5 6
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
	segmentVm
∫∫ &
in
∫∫' )
campaignTestingVm
∫∫* ;
.
∫∫; <
Segments
∫∫< D
)
∫∫D E
{
ªª 
var
ºº 
segment
ºº 
=
ºº  !
Db
ºº" $
.
ºº$ %
CampaignSegments
ºº% 5
.
ºº5 6
FirstOrDefault
ºº6 D
(
ººD E
x
ººE F
=>
ººG I
x
ººJ K
.
ººK L
Id
ººL N
==
ººO Q
	segmentVm
ººR [
.
ºº[ \
Id
ºº\ ^
)
ºº^ _
;
ºº_ `
if
ΩΩ 
(
ΩΩ 
segment
ΩΩ 
==
ΩΩ  "
null
ΩΩ# '
)
ΩΩ' (
{
ææ 
segment
øø 
=
øø  !
new
øø" %
CampaignSegment
øø& 5
(
øø5 6
)
øø6 7
{
¿¿ 
Id
¡¡ 
=
¡¡  
Guid
¡¡! %
.
¡¡% &
NewGuid
¡¡& -
(
¡¡- .
)
¡¡. /
,
¡¡/ 0
	CreatedAt
¬¬ %
=
¬¬& '
DateTime
¬¬( 0
.
¬¬0 1
Now
¬¬1 4
,
¬¬4 5

CampaignId
√√ &
=
√√' (
campaignTestingVm
√√) :
.
√√: ;

CampaignId
√√; E
,
√√E F
OrderNumber
ƒƒ '
=
ƒƒ( )
campaignTestingVm
ƒƒ* ;
.
ƒƒ; <
OrderNumber
ƒƒ< G
,
ƒƒG H
SegmentNumber
≈≈ )
=
≈≈* +
	segmentVm
≈≈, 5
.
≈≈5 6
SegmentNumber
≈≈6 C
}
∆∆ 
;
∆∆ 
Db
«« 
.
«« 
CampaignSegments
«« +
.
««+ ,
Add
««, /
(
««/ 0
segment
««0 7
)
««7 8
;
««8 9
Db
»» 
.
»» 
SaveChanges
»» &
(
»»& '
)
»»' (
;
»»( )
}
…… 
segment
   
.
   
SubjectLine
   '
=
  ( )
	segmentVm
  * 3
.
  3 4
SubjectLine
  4 ?
;
  ? @
segment
ÀÀ 
.
ÀÀ 
FromLine
ÀÀ $
=
ÀÀ% &
	segmentVm
ÀÀ' 0
.
ÀÀ0 1
FromLine
ÀÀ1 9
;
ÀÀ9 :
segment
ÃÃ 
.
ÃÃ 

WhiteLabel
ÃÃ &
=
ÃÃ' (
	segmentVm
ÃÃ) 2
.
ÃÃ2 3

WhiteLabel
ÃÃ3 =
;
ÃÃ= >
segment
ÕÕ 
.
ÕÕ 
Quantity
ÕÕ $
=
ÕÕ% &
	segmentVm
ÕÕ' 0
.
ÕÕ0 1
Quantity
ÕÕ1 9
;
ÕÕ9 :
segment
ŒŒ 
.
ŒŒ 
DeploymentDate
ŒŒ *
=
ŒŒ+ ,
	segmentVm
ŒŒ- 6
.
ŒŒ6 7
DeploymentDate
ŒŒ7 E
;
ŒŒE F
segment
œœ 
.
œœ 
CreativeFiles
œœ )
=
œœ* +
	segmentVm
œœ, 5
.
œœ5 6
CreativeFiles
œœ6 C
;
œœC D
segment
–– 
.
–– 
FirstRangeStart
–– +
=
––, -
	segmentVm
––. 7
.
––7 8
FirstRangeStart
––8 G
;
––G H
segment
—— 
.
—— 
FirstRangeEnd
—— )
=
——* +
	segmentVm
——, 5
.
——5 6
FirstRangeEnd
——6 C
;
——C D
segment
““ 
.
““ 
SecondRangeStart
““ ,
=
““- .
	segmentVm
““/ 8
.
““8 9
SecondRangeStart
““9 I
;
““I J
segment
”” 
.
”” 
SecondRangeEnd
”” *
=
””+ ,
	segmentVm
””- 6
.
””6 7
SecondRangeEnd
””7 E
;
””E F
segment
‘‘ 
.
‘‘ 
ThirdRangeStart
‘‘ +
=
‘‘, -
	segmentVm
‘‘. 7
.
‘‘7 8
ThirdRangeStart
‘‘8 G
;
‘‘G H
segment
’’ 
.
’’ 
ThirdRangeEnd
’’ )
=
’’* +
	segmentVm
’’, 5
.
’’5 6
ThirdRangeEnd
’’6 C
;
’’C D
Db
÷÷ 
.
÷÷ 
Entry
÷÷ 
(
÷÷ 
segment
÷÷ $
)
÷÷$ %
.
÷÷% &
State
÷÷& +
=
÷÷, -
EntityState
÷÷. 9
.
÷÷9 :
Modified
÷÷: B
;
÷÷B C
Db
◊◊ 
.
◊◊ 
SaveChanges
◊◊ "
(
◊◊" #
)
◊◊# $
;
◊◊$ %
}
ÿÿ 
TempData
⁄⁄ 
[
⁄⁄ 
$str
⁄⁄ "
]
⁄⁄" #
=
⁄⁄$ %
$str
⁄⁄& H
;
⁄⁄H I
}
€€ 
else
‹‹ 
{
›› 
var
ﬁﬁ 
	errorList
ﬁﬁ 
=
ﬁﬁ 
(
ﬁﬁ  !
from
ﬁﬁ! %
item
ﬁﬁ& *
in
ﬁﬁ+ -

ModelState
ﬁﬁ. 8
.
ﬁﬁ8 9
Values
ﬁﬁ9 ?
from
ﬂﬂ! %
error
ﬂﬂ& +
in
ﬂﬂ, .
item
ﬂﬂ/ 3
.
ﬂﬂ3 4
Errors
ﬂﬂ4 :
select
‡‡! '
error
‡‡( -
.
‡‡- .
ErrorMessage
‡‡. :
)
‡‡: ;
.
‡‡; <
ToList
‡‡< B
(
‡‡B C
)
‡‡C D
;
‡‡D E
TempData
·· 
[
·· 
$str
··  
]
··  !
=
··" #
$str
··$ D
+
··E F
string
··G M
.
··M N
Join
··N R
(
··R S
$str
··S Z
,
··Z [
	errorList
··\ e
)
··e f
;
··f g
}
‚‚ 
ViewBag
„„ 
.
„„ 
TestingUrgency
„„ "
=
„„# $
new
„„% (

SelectList
„„) 3
(
„„3 4

EnumHelper
„„4 >
.
„„> ?
GetEnumTextValues
„„? P
(
„„P Q
typeof
„„Q W
(
„„W X
TestingUrgency
„„X f
)
„„f g
)
„„g h
,
„„h i
$str
„„j q
,
„„q r
$str
‰‰ 
,
‰‰ 
campaignTestingVm
‰‰ )
.
‰‰) *
TestingUrgency
‰‰* 8
)
‰‰8 9
;
‰‰9 :
ViewBag
ÂÂ 
.
ÂÂ 

WhiteLabel
ÂÂ 
=
ÂÂ  
new
ÂÂ! $

SelectList
ÂÂ% /
(
ÂÂ/ 0
CustomersList
ÂÂ0 =
,
ÂÂ= >
$str
ÂÂ? F
,
ÂÂF G
$str
ÂÂH N
,
ÂÂN O
campaignTestingVm
ÂÂP a
.
ÂÂa b

WhiteLabel
ÂÂb l
)
ÂÂl m
;
ÂÂm n
return
ÊÊ 
View
ÊÊ 
(
ÊÊ 
$str
ÊÊ %
,
ÊÊ% &
campaignTestingVm
ÊÊ' 8
)
ÊÊ8 9
;
ÊÊ9 :
}
ÁÁ 	
public
ÈÈ 
ActionResult
ÈÈ 
ApproveSegment
ÈÈ *
(
ÈÈ* +
Guid
ÈÈ+ /
?
ÈÈ/ 0
id
ÈÈ1 3
)
ÈÈ3 4
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
var
ÌÌ 
segment
ÌÌ 
=
ÌÌ 
Db
ÌÌ  
.
ÌÌ  !
CampaignSegments
ÌÌ! 1
.
ÌÌ1 2
FirstOrDefault
ÌÌ2 @
(
ÌÌ@ A
x
ÌÌA B
=>
ÌÌC E
x
ÌÌF G
.
ÌÌG H
Id
ÌÌH J
==
ÌÌK M
id
ÌÌN P
)
ÌÌP Q
;
ÌÌQ R
segment
ÓÓ 
.
ÓÓ 
SegmentStatus
ÓÓ %
=
ÓÓ& '
(
ÓÓ( )
int
ÓÓ) ,
)
ÓÓ, -
SegmentStatus
ÓÓ- :
.
ÓÓ: ;
Approved
ÓÓ; C
;
ÓÓC D
segment
ÔÔ 
.
ÔÔ 
DateApproved
ÔÔ $
=
ÔÔ% &
DateTime
ÔÔ' /
.
ÔÔ/ 0
Now
ÔÔ0 3
;
ÔÔ3 4
Db
 
.
 
SaveChanges
 
(
 
)
  
;
  !
return
ÒÒ 
Json
ÒÒ 
(
ÒÒ 
new
ÒÒ 
JsonResponse
ÒÒ  ,
(
ÒÒ, -
)
ÒÒ- .
{
ÒÒ/ 0
IsSucess
ÒÒ1 9
=
ÒÒ: ;
true
ÒÒ< @
}
ÒÒA B
,
ÒÒB C!
JsonRequestBehavior
ÒÒD W
.
ÒÒW X
AllowGet
ÒÒX `
)
ÒÒ` a
;
ÒÒa b
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÙÙ 
return
ıı 
Json
ıı 
(
ıı 
new
ıı 
JsonResponse
ıı  ,
(
ıı, -
)
ıı- .
{
ıı/ 0
IsSucess
ıı1 9
=
ıı: ;
false
ıı< A
,
ııA B
ErrorMessage
ııC O
=
ııP Q
ex
ııR T
.
ııT U
Message
ııU \
}
ıı] ^
,
ıı^ _!
JsonRequestBehavior
ıı` s
.
ııs t
AllowGet
ııt |
)
ıı| }
;
ıı} ~
}
ˆˆ 
}
˜˜ 	
[
˘˘ 	
HttpPost
˘˘	 
]
˘˘ 
[
˙˙ 	&
ValidateAntiForgeryToken
˙˙	 !
]
˙˙! "
[
˚˚ 	
MultipleButton
˚˚	 
(
˚˚ 
Name
˚˚ 
=
˚˚ 
$str
˚˚ '
,
˚˚' (
Argument
˚˚) 1
=
˚˚2 3
$str
˚˚4 =
)
˚˚= >
]
˚˚> ?
public
¸¸ 
ActionResult
¸¸ 
Approve
¸¸ #
(
¸¸# $
[
¸¸$ %
Bind
¸¸% )
(
¸¸) *
Include
¸¸* 1
=
¸¸2 3
$str¸¸4 ‹
)¸¸‹ ›
]¸¸› ﬁ!
CampaignTestingVm¸¸ﬁ Ô!
campaignTestingVm¸¸ Å
)¸¸Å Ç
{
˝˝ 	
if
˛˛ 
(
˛˛ 

ModelState
˛˛ 
.
˛˛ 
IsValid
˛˛ "
)
˛˛" #
{
ˇˇ 
return
ÄÄ 
RedirectToAction
ÄÄ '
(
ÄÄ' (
$str
ÄÄ( /
,
ÄÄ/ 0
$str
ÄÄ1 ;
,
ÄÄ; <
new
ÄÄ= @
{
ÄÄA B
id
ÄÄC E
=
ÄÄF G
Session
ÄÄH O
[
ÄÄO P
$str
ÄÄP T
]
ÄÄT U
}
ÄÄV W
)
ÄÄW X
;
ÄÄX Y
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
var
ÑÑ 
	errorList
ÑÑ 
=
ÑÑ 
(
ÑÑ  !
from
ÑÑ! %
item
ÑÑ& *
in
ÑÑ+ -

ModelState
ÑÑ. 8
.
ÑÑ8 9
Values
ÑÑ9 ?
from
ÖÖ! %
error
ÖÖ& +
in
ÖÖ, .
item
ÖÖ/ 3
.
ÖÖ3 4
Errors
ÖÖ4 :
select
ÜÜ! '
error
ÜÜ( -
.
ÜÜ- .
ErrorMessage
ÜÜ. :
)
ÜÜ: ;
.
ÜÜ; <
ToList
ÜÜ< B
(
ÜÜB C
)
ÜÜC D
;
ÜÜD E
TempData
áá 
[
áá 
$str
áá  
]
áá  !
=
áá" #
$str
áá$ D
+
ááE F
string
ááG M
.
ááM N
Join
ááN R
(
ááR S
$str
ááS Z
,
ááZ [
	errorList
áá\ e
)
ááe f
;
ááf g
}
àà 
ViewBag
ââ 
.
ââ 
TestingUrgency
ââ "
=
ââ# $
new
ââ% (

SelectList
ââ) 3
(
ââ3 4

EnumHelper
ââ4 >
.
ââ> ?
GetEnumTextValues
ââ? P
(
ââP Q
typeof
ââQ W
(
ââW X
TestingUrgency
ââX f
)
ââf g
)
ââg h
,
ââh i
$str
ââj q
,
ââq r
$str
ää 
,
ää 
campaignTestingVm
ää )
.
ää) *
TestingUrgency
ää* 8
)
ää8 9
;
ää9 :
return
ãã 
View
ãã 
(
ãã 
$str
ãã %
,
ãã% &
campaignTestingVm
ãã' 8
)
ãã8 9
;
ãã9 :
}
åå 	
[
éé 	
HttpPost
éé	 
]
éé 
[
èè 	&
ValidateAntiForgeryToken
èè	 !
]
èè! "
[
êê 	
MultipleButton
êê	 
(
êê 
Name
êê 
=
êê 
$str
êê '
,
êê' (
Argument
êê) 1
=
êê2 3
$str
êê4 B
)
êêB C
]
êêC D
public
ëë 
ActionResult
ëë 
ProcessFiles
ëë (
(
ëë( )
[
ëë) *
Bind
ëë* .
(
ëë. /
Include
ëë/ 6
=
ëë7 8
$str
ëë9 T
)
ëëT U
]
ëëU V
CampaignTestingVm
ëëW h
campaignTestingVm
ëëi z
)
ëëz {
{
íí 	
var
ìì 
campaign
ìì 
=
ìì 
Db
ìì 
.
ìì 
	Campaigns
ìì '
.
ìì' (
FirstOrDefault
ìì( 6
(
ìì6 7
x
ìì7 8
=>
ìì9 ;
x
ìì< =
.
ìì= >
Id
ìì> @
==
ììA C
campaignTestingVm
ììD U
.
ììU V

CampaignId
ììV `
)
ìì` a
;
ììa b
BackgroundJob
îî 
.
îî 
Enqueue
îî !
(
îî! "
(
îî" #
)
îî# $
=>
îî% '
FileProcessor
îî( 5
.
îî5 6$
ProcessAssetUpdateUrls
îî6 L
(
îîL M

UploadPath
îîM W
,
îîW X
campaign
îîY a
.
îîa b
OrderNumber
îîb m
)
îîm n
)
îîn o
;
îîo p
TempData
ññ 
[
ññ 
$str
ññ 
]
ññ 
=
ññ  !
$str
ññ" Q
;
ññQ R
return
óó 
RedirectToAction
óó #
(
óó# $
$str
óó$ 1
,
óó1 2
new
óó3 6
{
óó7 8
id
óó9 ;
=
óó< =
campaignTestingVm
óó> O
.
óóO P
Id
óóP R
}
óóS T
)
óóT U
;
óóU V
}
òò 	
[
öö 	
HttpPost
öö	 
]
öö 
[
õõ 	&
ValidateAntiForgeryToken
õõ	 !
]
õõ! "
[
úú 	
MultipleButton
úú	 
(
úú 
Name
úú 
=
úú 
$str
úú '
,
úú' (
Argument
úú) 1
=
úú2 3
$str
úú4 K
)
úúK L
]
úúL M
public
ùù 
ActionResult
ùù #
FetchProcessDataFiles
ùù 1
(
ùù1 2
[
ùù2 3
Bind
ùù3 7
(
ùù7 8
Include
ùù8 ?
=
ùù@ A
$strùùB Ñ
)ùùÑ Ö
]ùùÖ Ü!
CampaignTestingVmùùá ò!
campaignTestingVmùùô ™
)ùù™ ´
{
ûû 	
try
üü 
{
†† 
var
°° 
campaign
°° 
=
°° 
Db
°° !
.
°°! "
	Campaigns
°°" +
.
¢¢ 
Include
¢¢ 
(
¢¢ 
x
¢¢ 
=>
¢¢ 
x
¢¢ 
.
¢¢  
Assets
¢¢  &
)
¢¢& '
.
££ 
Include
££ 
(
££ 
x
££ 
=>
££ 
x
££ 
.
££  
Segments
££  (
)
££( )
.
§§ 
FirstOrDefault
§§ 
(
§§  
x
§§  !
=>
§§" $
x
§§% &
.
§§& '
Id
§§' )
==
§§* ,
campaignTestingVm
§§- >
.
§§> ?

CampaignId
§§? I
)
§§I J
;
§§J K
if
¶¶ 
(
¶¶ 
campaign
¶¶ 
.
¶¶ 
Segments
¶¶ $
.
¶¶$ %
Count
¶¶% *
==
¶¶+ -
$num
¶¶. /
)
¶¶/ 0
throw
ßß 
new
ßß 
AdsException
ßß *
(
ßß* +
$str
ßß+ H
)
ßßH I
;
ßßI J
BackgroundJob
©© 
.
©© 
Enqueue
©© %
(
©©% &
(
©©& '
)
©©' (
=>
©©) +
DataFileProcessor
©©, =
.
©©= >
FetchSqlDataFile
©©> N
(
©©N O

UploadPath
©©O Y
,
©©Y Z
campaign
©©[ c
.
©©c d
OrderNumber
©©d o
,
©©o p
campaign
©©q y
.
©©y z
Assets©©z Ä
.©©Ä Å
ZipCodeFile©©Å å
,©©å ç!
campaignTestingVm©©é ü
.©©ü † 
DataFileQuantity©©† ∞
)©©∞ ±
)©©± ≤
;©©≤ ≥
TempData
´´ 
[
´´ 
$str
´´ "
]
´´" #
=
´´$ %
$str
´´& i
;
´´i j
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
ex
≠≠ 
)
≠≠  
{
ÆÆ 
TempData
ØØ 
[
ØØ 
$str
ØØ  
]
ØØ  !
=
ØØ" #
ex
ØØ$ &
.
ØØ& '
Message
ØØ' .
;
ØØ. /
}
∞∞ 
return
±± 
RedirectToAction
±± #
(
±±# $
$str
±±$ 1
,
±±1 2
new
±±3 6
{
±±7 8
id
±±9 ;
=
±±< =
campaignTestingVm
±±> O
.
±±O P
Id
±±P R
}
±±S T
)
±±T U
;
±±U V
}
≤≤ 	
}
¥¥ 
}µµ Ò∆
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Controllers\TrackingController.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Controllers '
{ 
[ 
	Authorize 
] 
public 

class 
TrackingController #
:$ %
BaseController& 4
{ 
public 
ActionResult 
Index !
(! "
CampaignSearchVm" 2
sc3 5
)5 6
{ 	
ViewBag 
. 
CurrentSort 
=  !
sc" $
.$ %
	SortOrder% .
;. /
ViewBag 
.  
CampaignNameSortParm (
=) *
sc+ -
.- .
	SortOrder. 7
==8 :
$str; I
?J K
$strL _
:` a
$strb p
;p q
ViewBag 
. !
BroadcastDateSortParm )
=* +
sc, .
.. /
	SortOrder/ 8
==9 ;
$str< K
?L M
$strN b
:c d
$stre t
;t u
ViewBag 
. 
CreatedBySortParm %
=& '
sc( *
.* +
	SortOrder+ 4
==5 7
$str8 C
?D E
$strF V
:W X
$strY d
;d e
ViewBag 
. 
StatusSortParm "
=# $
sc% '
.' (
	SortOrder( 1
==2 4
$str5 =
?> ?
$str@ M
:N O
$strP X
;X Y
ViewBag 
. 
OrderNumberSortParm '
=( )
sc* ,
., -
	SortOrder- 6
==7 9
$str: G
?H I
$strJ \
:] ^
$str_ l
;l m
var 
	campagins 
= 
Db 
. 
	Campaigns (
.   
Include   
(   
x   
=>   
x   
.    
Approved    (
)  ( )
.!! 
Include!! 
(!! 
x!! 
=>!! 
x!! 
.!!  
ProDatas!!  (
)!!( )
."" 
Include"" 
("" 
x"" 
=>"" 
x"" 
.""  
	Trackings""  )
)"") *
.## 
OrderByDescending## "
(##" #
x### $
=>##% '
x##( )
.##) *
	CreatedAt##* 3
)##3 4
.$$ 
Where$$ 
($$ 
x$$ 
=>$$ 
x$$ 
.$$ 
Status$$ $
==$$% '
($$( )
int$$) ,
)$$, -
CampaignStatus$$- ;
.$$; <

Monitoring$$< F
&&$$G I
x$$J K
.$$K L
Approved$$L T
!=$$U W
null$$X \
)$$\ ]
.%% 
ToList%% 
(%% 
)%% 
;%% 
switch'' 
('' 
sc'' 
.'' 
	SortOrder''  
)''  !
{(( 
case)) 
$str)) #
:))# $
	campagins** 
=** 
	campagins**  )
.**) *
OrderBy*** 1
(**1 2
s**2 3
=>**4 6
s**7 8
.**8 9
CampaignName**9 E
)**E F
.**F G
ToList**G M
(**M N
)**N O
;**O P
break++ 
;++ 
case,, 
$str,, (
:,,( )
	campagins-- 
=-- 
	campagins--  )
.--) *
OrderByDescending--* ;
(--; <
s--< =
=>--> @
s--A B
.--B C
CampaignName--C O
)--O P
.--P Q
ToList--Q W
(--W X
)--X Y
;--Y Z
break.. 
;.. 
case// 
$str// $
://$ %
	campagins00 
=00 
	campagins00  )
.00) *
OrderBy00* 1
(001 2
s002 3
=>004 6
s007 8
.008 9
BroadcastDate009 F
)00F G
.00G H
ToList00H N
(00N O
)00O P
;00P Q
break11 
;11 
case22 
$str22 )
:22) *
	campagins33 
=33 
	campagins33  )
.33) *
OrderByDescending33* ;
(33; <
s33< =
=>33> @
s33A B
.33B C
BroadcastDate33C P
)33P Q
.33Q R
ToList33R X
(33X Y
)33Y Z
;33Z [
break44 
;44 
case55 
$str55  
:55  !
	campagins66 
=66 
	campagins66  )
.66) *
OrderBy66* 1
(661 2
s662 3
=>664 6
s667 8
.668 9
	CreatedBy669 B
)66B C
.66C D
ToList66D J
(66J K
)66K L
;66L M
break77 
;77 
case88 
$str88 %
:88% &
	campagins99 
=99 
	campagins99  )
.99) *
OrderByDescending99* ;
(99; <
s99< =
=>99> @
s99A B
.99B C
	CreatedBy99C L
)99L M
.99M N
ToList99N T
(99T U
)99U V
;99V W
break:: 
;:: 
case;; 
$str;; 
:;; 
	campagins<< 
=<< 
	campagins<<  )
.<<) *
OrderBy<<* 1
(<<1 2
s<<2 3
=><<4 6
s<<7 8
.<<8 9
Status<<9 ?
)<<? @
.<<@ A
ToList<<A G
(<<G H
)<<H I
;<<I J
break== 
;== 
case>> 
$str>> "
:>>" #
	campagins?? 
=?? 
	campagins??  )
.??) *
OrderByDescending??* ;
(??; <
s??< =
=>??> @
s??A B
.??B C
Status??C I
)??I J
.??J K
ToList??K Q
(??Q R
)??R S
;??S T
break@@ 
;@@ 
caseAA 
$strAA "
:AA" #
	campaginsBB 
=BB 
	campaginsBB  )
.BB) *
OrderByBB* 1
(BB1 2
sBB2 3
=>BB4 6
sBB7 8
.BB8 9
OrderNumberBB9 D
)BBD E
.BBE F
ToListBBF L
(BBL M
)BBM N
;BBN O
breakCC 
;CC 
caseDD 
$strDD '
:DD' (
	campaginsEE 
=EE 
	campaginsEE  )
.EE) *
OrderByDescendingEE* ;
(EE; <
sEE< =
=>EE> @
sEEA B
.EEB C
OrderNumberEEC N
)EEN O
.EEO P
ToListEEP V
(EEV W
)EEW X
;EEX Y
breakFF 
;FF 
defaultGG 
:GG 
	campaginsHH 
=HH 
	campaginsHH  )
.HH) *
OrderByDescendingHH* ;
(HH; <
sHH< =
=>HH> @
sHHA B
.HHB C
	CreatedAtHHC L
)HHL M
.HHM N
ToListHHN T
(HHT U
)HHU V
;HHV W
breakII 
;II 
}JJ 
ViewBagLL 
.LL 

SearchTypeLL 
=LL  
scLL! #
.LL# $

SearchTypeLL$ .
;LL. /
switchMM 
(MM 
scMM 
.MM 

SearchTypeMM !
)MM! "
{NN 
caseOO 
$strOO 
:OO 
ifPP 
(PP 
!PP 
stringPP 
.PP  
IsNullOrEmptyPP  -
(PP- .
scPP. 0
.PP0 1
BasicStringPP1 <
)PP< =
)PP= >
{QQ 
	campaginsRR !
=RR" #
	campaginsRR$ -
.RR- .
WhereRR. 3
(RR3 4
sRR4 5
=>RR6 8
sSS 
.SS 
OrderNumberSS %
.SS% &
EqualsSS& ,
(SS, -
scSS- /
.SS/ 0
BasicStringSS0 ;
)SS; <
||SS= ?
sTT 
.TT $
ReBroadcastedOrderNumberTT 2
==TT3 5
scTT6 8
.TT8 9
BasicStringTT9 D
||TTE G
sUU 
.UU 
CampaignNameUU &
.UU& '
IndexOfUU' .
(UU. /
scUU/ 1
.UU1 2
BasicStringUU2 =
,UU= >
StringComparisonUU? O
.UUO P&
InvariantCultureIgnoreCaseUUP j
)UUj k
>=UUl n
$numUUo p
)UUp q
.UUq r
ToListUUr x
(UUx y
)UUy z
;UUz {
ViewBagVV 
.VV  
BasicStringSearchedVV  3
=VV4 5
scVV6 8
.VV8 9
BasicStringVV9 D
;VVD E
}WW 
elseXX 
ifXX 
(XX 
!XX 
stringXX $
.XX$ %
IsNullOrEmptyXX% 2
(XX2 3
scXX3 5
.XX5 6
BasicStatusXX6 A
)XXA B
)XXB C
{YY 
intZZ 
statusZZ "
=ZZ# $
intZZ% (
.ZZ( )
ParseZZ) .
(ZZ. /
scZZ/ 1
.ZZ1 2
BasicStatusZZ2 =
)ZZ= >
;ZZ> ?
if[[ 
([[ 
status[[ "
==[[# %
([[& '
int[[' *
)[[* +
CampaignStatus[[+ 9
.[[9 :
Rebroadcasted[[: G
)[[G H
	campagins\\ %
=\\& '
	campagins\\( 1
.\\1 2
Where\\2 7
(\\7 8
s\\8 9
=>\\: <
s\\= >
.\\> ?
ReBroadcasted\\? L
)\\L M
.\\M N
ToList\\N T
(\\T U
)\\U V
;\\V W
else]] 
if]] 
(]]  !
status]]! '
==]]( *
(]]+ ,
int]], /
)]]/ 0
CampaignStatus]]0 >
.]]> ?
NotRebroadcasted]]? O
)]]O P
	campagins^^ %
=^^& '
	campagins^^( 1
.^^1 2
Where^^2 7
(^^7 8
s^^8 9
=>^^: <
s^^= >
.^^> ?
ReBroadCast^^? J
&&^^K M
!^^N O
s^^O P
.^^P Q
ReBroadcasted^^Q ^
)^^^ _
.^^_ `
ToList^^` f
(^^f g
)^^g h
;^^h i
else__ 
	campagins`` %
=``& '
	campagins``( 1
.``1 2
Where``2 7
(``7 8
s``8 9
=>``: <
s``= >
.``> ?
Status``? E
==``F H
status``I O
)``O P
.``P Q
ToList``Q W
(``W X
)``X Y
;``Y Z
ViewBagaa 
.aa  
BasicStatusSearchedaa  3
=aa4 5
scaa6 8
.aa8 9
BasicStatusaa9 D
;aaD E
}bb 
elsecc 
ifcc 
(cc 
!cc 
stringcc $
.cc$ %
IsNullOrEmptycc% 2
(cc2 3
sccc3 5
.cc5 6
BasicOrderNumbercc6 F
)ccF G
)ccG H
{dd 
	campaginsee !
=ee" #
	campaginsee$ -
.ee- .
Whereee. 3
(ee3 4
see4 5
=>ee6 8
see9 :
.ee: ;
Idee; =
.ee= >
ToStringee> F
(eeF G
)eeG H
.eeH I
EqualseeI O
(eeO P
sceeP R
.eeR S
BasicOrderNumbereeS c
)eec d
)eed e
.eee f
ToListeef l
(eel m
)eem n
;een o
}ff 
breakgg 
;gg 
casehh 
$strhh 
:hh  
ifii 
(ii 
!ii 
stringii 
.ii  
IsNullOrEmptyii  -
(ii- .
scii. 0
.ii0 1
AdvancedStatusii1 ?
)ii? @
)ii@ A
{jj 
intkk 
statuskk "
=kk# $
intkk% (
.kk( )
Parsekk) .
(kk. /
sckk/ 1
.kk1 2
AdvancedStatuskk2 @
)kk@ A
;kkA B
ifll 
(ll 
statusll "
==ll# %
(ll& '
intll' *
)ll* +
CampaignStatusll+ 9
.ll9 :
Rebroadcastedll: G
)llG H
	campaginsmm %
=mm& '
	campaginsmm( 1
.mm1 2
Wheremm2 7
(mm7 8
smm8 9
=>mm: <
smm= >
.mm> ?
OrderNumbermm? J
.mmJ K
EndsWithmmK S
(mmS T
$strmmT Y
)mmY Z
)mmZ [
.mm[ \
ToListmm\ b
(mmb c
)mmc d
;mmd e
elsenn 
	campaginsoo %
=oo& '
	campaginsoo( 1
.oo1 2
Whereoo2 7
(oo7 8
soo8 9
=>oo: <
soo= >
.oo> ?
Statusoo? E
==ooF H
statusooI O
)ooO P
.ooP Q
ToListooQ W
(ooW X
)ooX Y
;ooY Z
ViewBagpp 
.pp  "
AdvancedStatusSearchedpp  6
=pp7 8
scpp9 ;
.pp; <
AdvancedStatuspp< J
;ppJ K
}qq 
ifrr 
(rr 
!rr 
stringrr 
.rr  
IsNullOrEmptyrr  -
(rr- .
scrr. 0
.rr0 1
AdvancedUserrr1 =
)rr= >
)rr> ?
{ss 
	campaginstt !
=tt" #
	campaginstt$ -
.tt- .
Wherett. 3
(tt3 4
stt4 5
=>tt6 8
stt9 :
.tt: ;
	CreatedBytt; D
==ttE G
scttH J
.ttJ K
AdvancedUserttK W
)ttW X
.ttX Y
ToListttY _
(tt_ `
)tt` a
;tta b
ViewBaguu 
.uu   
AdvancedUserSearcheduu  4
=uu5 6
scuu7 9
.uu9 :
AdvancedUseruu: F
;uuF G
}vv 
ifxx 
(xx 
!xx 
stringxx 
.xx  
IsNullOrEmptyxx  -
(xx- .
scxx. 0
.xx0 1
CampaignNamexx1 =
)xx= >
)xx> ?
{yy 
sczz 
.zz 
CampaignNamezz '
=zz( )
sczz* ,
.zz, -
CampaignNamezz- 9
.zz9 :
ToLowerInvariantzz: J
(zzJ K
)zzK L
;zzL M
	campagins{{ !
={{" #
	campagins{{$ -
.{{- .
Where{{. 3
({{3 4
s{{4 5
=>{{6 8
s{{9 :
.{{: ;
CampaignName{{; G
.{{G H
IndexOf{{H O
({{O P
sc{{P R
.{{R S
CampaignName{{S _
,{{_ `
StringComparison{{a q
.{{q r%
CurrentCultureIgnoreCase	{{r ä
)
{{ä ã
>=
{{å é
$num
{{è ê
)
{{ê ë
.
{{ë í
ToList
{{í ò
(
{{ò ô
)
{{ô ö
;
{{ö õ
ViewBag|| 
.||  
CampaignName||  ,
=||- .
sc||/ 1
.||1 2
CampaignName||2 >
;||> ?
}}} 
if 
( 
! 
string 
.  
IsNullOrEmpty  -
(- .
sc. 0
.0 1
IsTested1 9
)9 :
): ;
{
ÄÄ 
bool
ÅÅ 
isTested
ÅÅ %
=
ÅÅ& '
bool
ÅÅ( ,
.
ÅÅ, -
Parse
ÅÅ- 2
(
ÅÅ2 3
sc
ÅÅ3 5
.
ÅÅ5 6
IsTested
ÅÅ6 >
)
ÅÅ> ?
;
ÅÅ? @
	campagins
ÇÇ !
=
ÇÇ" #
	campagins
ÇÇ$ -
.
ÇÇ- .
Where
ÇÇ. 3
(
ÇÇ3 4
s
ÇÇ4 5
=>
ÇÇ6 8
s
ÇÇ9 :
.
ÇÇ: ;
Testing
ÇÇ; B
!=
ÇÇC E
null
ÇÇF J
&&
ÉÉ6 8
s
ÉÉ9 :
.
ÉÉ: ;
Testing
ÉÉ; B
?
ÉÉB C
.
ÉÉC D
IsTested
ÉÉD L
==
ÉÉM O
isTested
ÉÉP X
)
ÉÉX Y
.
ÉÉY Z
ToList
ÉÉZ `
(
ÉÉ` a
)
ÉÉa b
;
ÉÉb c
ViewBag
ÑÑ 
.
ÑÑ  
IsTested
ÑÑ  (
=
ÑÑ) *
sc
ÑÑ+ -
.
ÑÑ- .
IsTested
ÑÑ. 6
;
ÑÑ6 7
}
ÖÖ 
if
áá 
(
áá 
!
áá 
string
áá 
.
áá  
IsNullOrEmpty
áá  -
(
áá- .
sc
áá. 0
.
áá0 1
OrderedFrom
áá1 <
)
áá< =
)
áá= >
{
àà 
DateTime
ââ  
dateFrom
ââ! )
=
ââ* +
DateTime
ââ, 4
.
ââ4 5

ParseExact
ââ5 ?
(
ââ? @
sc
ââ@ B
.
ââB C
OrderedFrom
ââC N
,
ââN O
$str
ââP \
,
ââ\ ]
CultureInfo
ââ^ i
.
ââi j
InvariantCulture
ââj z
)
ââz {
;
ââ{ |
	campagins
ää !
=
ää" #
	campagins
ää$ -
.
ää- .
Where
ää. 3
(
ää3 4
s
ää4 5
=>
ää6 8
s
ää9 :
.
ää: ;
	CreatedAt
ää; D
.
ääD E
Date
ääE I
>=
ääJ L
dateFrom
ääM U
.
ääU V
Date
ääV Z
)
ääZ [
.
ää[ \
ToList
ää\ b
(
ääb c
)
ääc d
;
ääd e
ViewBag
ãã 
.
ãã  
OrderedFrom
ãã  +
=
ãã, -
sc
ãã. 0
.
ãã0 1
OrderedFrom
ãã1 <
;
ãã< =
}
åå 
if
éé 
(
éé 
!
éé 
string
éé 
.
éé  
IsNullOrEmpty
éé  -
(
éé- .
sc
éé. 0
.
éé0 1
	OrderedTo
éé1 :
)
éé: ;
)
éé; <
{
èè 
DateTime
êê  
dateTo
êê! '
=
êê( )
DateTime
êê* 2
.
êê2 3

ParseExact
êê3 =
(
êê= >
sc
êê> @
.
êê@ A
	OrderedTo
êêA J
,
êêJ K
$str
êêL X
,
êêX Y
CultureInfo
êêZ e
.
êêe f
InvariantCulture
êêf v
)
êêv w
;
êêw x
	campagins
ëë !
=
ëë" #
	campagins
ëë$ -
.
ëë- .
Where
ëë. 3
(
ëë3 4
s
ëë4 5
=>
ëë6 8
s
ëë9 :
.
ëë: ;
	CreatedAt
ëë; D
.
ëëD E
Date
ëëE I
<=
ëëJ L
dateTo
ëëM S
.
ëëS T
Date
ëëT X
)
ëëX Y
.
ëëY Z
ToList
ëëZ `
(
ëë` a
)
ëëa b
;
ëëb c
ViewBag
íí 
.
íí  
	OrderedTo
íí  )
=
íí* +
sc
íí, .
.
íí. /
	OrderedTo
íí/ 8
;
íí8 9
}
ìì 
if
ïï 
(
ïï 
!
ïï 
string
ïï 
.
ïï  
IsNullOrEmpty
ïï  -
(
ïï- .
sc
ïï. 0
.
ïï0 1
BroadcastFrom
ïï1 >
)
ïï> ?
)
ïï? @
{
ññ 
DateTime
óó  
dateFrom
óó! )
=
óó* +
DateTime
óó, 4
.
óó4 5

ParseExact
óó5 ?
(
óó? @
sc
óó@ B
.
óóB C
BroadcastFrom
óóC P
,
óóP Q
$str
óóR ^
,
óó^ _
CultureInfo
óó` k
.
óók l
InvariantCulture
óól |
)
óó| }
;
óó} ~
	campagins
òò !
=
òò" #
	campagins
òò$ -
.
òò- .
Where
òò. 3
(
òò3 4
s
òò4 5
=>
òò6 8
s
òò9 :
.
òò: ;
BroadcastDate
òò; H
?
òòH I
.
òòI J
Date
òòJ N
>=
òòO Q
dateFrom
òòR Z
.
òòZ [
Date
òò[ _
)
òò_ `
.
òò` a
ToList
òòa g
(
òòg h
)
òòh i
;
òòi j
ViewBag
ôô 
.
ôô  
BroadcastFrom
ôô  -
=
ôô. /
sc
ôô0 2
.
ôô2 3
BroadcastFrom
ôô3 @
;
ôô@ A
}
öö 
if
úú 
(
úú 
!
úú 
string
úú 
.
úú  
IsNullOrEmpty
úú  -
(
úú- .
sc
úú. 0
.
úú0 1
BroadcastTo
úú1 <
)
úú< =
)
úú= >
{
ùù 
DateTime
ûû  
dateTo
ûû! '
=
ûû( )
DateTime
ûû* 2
.
ûû2 3

ParseExact
ûû3 =
(
ûû= >
sc
ûû> @
.
ûû@ A
BroadcastTo
ûûA L
,
ûûL M
$str
ûûN Z
,
ûûZ [
CultureInfo
ûû\ g
.
ûûg h
InvariantCulture
ûûh x
)
ûûx y
;
ûûy z
	campagins
üü !
=
üü" #
	campagins
üü$ -
.
üü- .
Where
üü. 3
(
üü3 4
s
üü4 5
=>
üü6 8
s
üü9 :
.
üü: ;
BroadcastDate
üü; H
?
üüH I
.
üüI J
Date
üüJ N
<=
üüO Q
dateTo
üüR X
.
üüX Y
Date
üüY ]
)
üü] ^
.
üü^ _
ToList
üü_ e
(
üüe f
)
üüf g
;
üüg h
ViewBag
†† 
.
††  
BroadcastTo
††  +
=
††, -
sc
††. 0
.
††0 1
BroadcastTo
††1 <
;
††< =
}
°° 
break
¢¢ 
;
¢¢ 
}
££ 
if
•• 
(
•• 
LoggedInUser
•• 
!=
•• 
null
••  $
&&
••% '
!
••( )
IsAdmin
••) 0
)
••0 1
{
¶¶ 
	campagins
ßß 
=
ßß 
	campagins
ßß %
.
ßß% &
Where
ßß& +
(
ßß+ ,
s
ßß, -
=>
ßß. 0
s
ßß1 2
.
ßß2 3
	CreatedBy
ßß3 <
==
ßß= ?
LoggedInUser
ßß@ L
.
ßßL M
UserName
ßßM U
)
ßßU V
.
ßßV W
ToList
ßßW ]
(
ßß] ^
)
ßß^ _
;
ßß_ `
}
®® 
ViewBag
™™ 
.
™™ 
BasicOrderNumber
™™ $
=
™™% &
OrderNumberList
™™' 6
;
™™6 7
ViewBag
´´ 
.
´´ 
BasicStatus
´´ 
=
´´  !

StatusList
´´" ,
;
´´, -
ViewBag
¨¨ 
.
¨¨ 
AdvancedStatus
¨¨ "
=
¨¨# $

StatusList
¨¨% /
;
¨¨/ 0
ViewBag
≠≠ 
.
≠≠ 
AdvancedUser
≠≠  
=
≠≠! "
	UsersList
≠≠# ,
;
≠≠, -
var
ØØ 
trackingVms
ØØ 
=
ØØ 
new
ØØ !
List
ØØ" &
<
ØØ& ' 
CampaignTrackingVm
ØØ' 9
>
ØØ9 :
(
ØØ: ;
)
ØØ; <
;
ØØ< =
foreach
∞∞ 
(
∞∞ 
var
∞∞ 
campaign
∞∞ !
in
∞∞" $
	campagins
∞∞% .
)
∞∞. /
{
±± 
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
campaignTracking
≤≤ -
in
≤≤. 0
campaign
≤≤1 9
.
≤≤9 :
	Trackings
≤≤: C
)
≤≤C D
{
≥≥ 
var
¥¥ 
model
¥¥ 
=
¥¥  
CampaignTrackingVm
¥¥  2
.
¥¥2 3"
FromCampaignTracking
¥¥3 G
(
¥¥G H
campaign
¥¥H P
,
¥¥P Q
campaignTracking
¥¥R b
)
¥¥b c
;
¥¥c d
trackingVms
µµ 
.
µµ  
Add
µµ  #
(
µµ# $
model
µµ$ )
)
µµ) *
;
µµ* +
}
∂∂ 
}
∑∑ 
ViewBag
ππ 
.
ππ 
Status
ππ 
=
ππ 

StatusList
ππ '
;
ππ' (
ViewBag
∫∫ 
.
∫∫ 
SearchStatus
∫∫  
=
∫∫! "

StatusList
∫∫# -
;
∫∫- .
int
ΩΩ 

pageNumber
ΩΩ 
=
ΩΩ 
(
ΩΩ 
sc
ΩΩ  
.
ΩΩ  !
Page
ΩΩ! %
??
ΩΩ& (
$num
ΩΩ) *
)
ΩΩ* +
;
ΩΩ+ ,
return
ææ 
View
ææ 
(
ææ 
trackingVms
ææ #
.
ææ# $
OrderBy
ææ$ +
(
ææ+ ,
x
ææ, -
=>
ææ. 0
x
ææ1 2
.
ææ2 3
OrderNumber
ææ3 >
)
ææ> ?
.
ææ? @
ToPagedList
ææ@ K
(
ææK L

pageNumber
ææL V
,
ææV W
PageSize
ææX `
)
ææ` a
)
ææa b
;
ææb c
}
øø 	
public
¡¡ 
ActionResult
¡¡ 
Report
¡¡ "
(
¡¡" #
Guid
¡¡# '
?
¡¡' (
id
¡¡) +
)
¡¡+ ,
{
¬¬ 	
if
√√ 
(
√√ 
id
√√ 
==
√√ 
null
√√ 
)
√√ 
{
ƒƒ 
throw
≈≈ 
new
≈≈ 
HttpException
≈≈ '
(
≈≈' (
$num
≈≈( +
,
≈≈+ ,
$str
≈≈- :
)
≈≈: ;
;
≈≈; <
}
∆∆ 
Campaign
«« 
campaign
«« 
=
«« 
Db
««  "
.
««" #
	Campaigns
««# ,
.
»» 
Include
»» 
(
»» 
x
»» 
=>
»» 
x
»» 
.
»»  
Approved
»»  (
)
»»( )
.
…… 
Include
…… 
(
…… 
x
…… 
=>
…… 
x
…… 
.
……  
ProDatas
……  (
)
……( )
.
   
Include
   
(
   
x
   
=>
   
x
   
.
    
	Trackings
    )
)
  ) *
.
ÀÀ 
FirstOrDefault
ÀÀ 
(
ÀÀ  
x
ÀÀ  !
=>
ÀÀ" $
x
ÀÀ% &
.
ÀÀ& '
Id
ÀÀ' )
==
ÀÀ* ,
id
ÀÀ- /
)
ÀÀ/ 0
;
ÀÀ0 1
if
ÃÃ 
(
ÃÃ 
campaign
ÃÃ 
==
ÃÃ 
null
ÃÃ  
)
ÃÃ  !
{
ÕÕ 
throw
ŒŒ 
new
ŒŒ 
HttpException
ŒŒ '
(
ŒŒ' (
$num
ŒŒ( +
,
ŒŒ+ ,
$str
ŒŒ- 8
)
ŒŒ8 9
;
ŒŒ9 :
}
œœ 
if
–– 
(
–– 
campaign
–– 
.
–– 
Approved
–– !
==
––" $
null
––% )
)
––) *
{
—— 
TempData
““ 
[
““ 
$str
““  
]
““  !
=
““" #
$str
““$ `
;
““` a
return
”” 
RedirectToAction
”” '
(
””' (
$str
””( /
,
””/ 0
$str
””1 <
)
””< =
;
””= >
}
‘‘ 
var
’’ 
trackingVms
’’ 
=
’’ 
new
’’ !
List
’’" &
<
’’& ' 
CampaignTrackingVm
’’' 9
>
’’9 :
(
’’: ;
)
’’; <
;
’’< =
foreach
÷÷ 
(
÷÷ 
var
÷÷ 
campaignTracking
÷÷ )
in
÷÷* ,
campaign
÷÷- 5
.
÷÷5 6
	Trackings
÷÷6 ?
)
÷÷? @
{
◊◊ 
var
ÿÿ 
model
ÿÿ 
=
ÿÿ  
CampaignTrackingVm
ÿÿ .
.
ÿÿ. /"
FromCampaignTracking
ÿÿ/ C
(
ÿÿC D
campaign
ÿÿD L
,
ÿÿL M
campaignTracking
ÿÿN ^
)
ÿÿ^ _
;
ÿÿ_ `
trackingVms
ŸŸ 
.
ŸŸ 
Add
ŸŸ 
(
ŸŸ  
model
ŸŸ  %
)
ŸŸ% &
;
ŸŸ& '
}
⁄⁄ 
trackingVms
€€ 
=
€€ 
trackingVms
€€ %
.
€€% &
OrderBy
€€& -
(
€€- .
x
€€. /
=>
€€0 2
x
€€3 4
.
€€4 5
OrderNumber
€€5 @
)
€€@ A
.
€€A B
ToList
€€B H
(
€€H I
)
€€I J
;
€€J K
return
‹‹ 
View
‹‹ 
(
‹‹ 
trackingVms
‹‹ #
)
‹‹# $
;
‹‹$ %
}
›› 	
public
ﬂﬂ 
ActionResult
ﬂﬂ 
DownloadReport
ﬂﬂ *
(
ﬂﬂ* +
Guid
ﬂﬂ+ /
?
ﬂﬂ/ 0
id
ﬂﬂ1 3
,
ﬂﬂ3 4
Guid
ﬂﬂ5 9
?
ﬂﬂ9 :

trackingId
ﬂﬂ; E
)
ﬂﬂE F
{
‡‡ 	
if
·· 
(
·· 
id
·· 
==
·· 
null
·· 
)
·· 
{
‚‚ 
throw
„„ 
new
„„ 
HttpException
„„ '
(
„„' (
$num
„„( +
,
„„+ ,
$str
„„- :
)
„„: ;
;
„„; <
}
‰‰ 
Campaign
ÂÂ 
campaign
ÂÂ 
=
ÂÂ 
Db
ÂÂ  "
.
ÂÂ" #
	Campaigns
ÂÂ# ,
.
ÊÊ 
Include
ÊÊ 
(
ÊÊ 
x
ÊÊ 
=>
ÊÊ 
x
ÊÊ 
.
ÊÊ  
Assets
ÊÊ  &
)
ÊÊ& '
.
ÁÁ 
Include
ÁÁ 
(
ÁÁ 
x
ÁÁ 
=>
ÁÁ 
x
ÁÁ 
.
ÁÁ  
Segments
ÁÁ  (
)
ÁÁ( )
.
ËË 
Include
ËË 
(
ËË 
x
ËË 
=>
ËË 
x
ËË 
.
ËË  
ProDatas
ËË  (
)
ËË( )
.
ÈÈ 
Include
ÈÈ 
(
ÈÈ 
x
ÈÈ 
=>
ÈÈ 
x
ÈÈ 
.
ÈÈ  
Testing
ÈÈ  '
)
ÈÈ' (
.
ÍÍ 
Include
ÍÍ 
(
ÍÍ 
x
ÍÍ 
=>
ÍÍ 
x
ÍÍ 
.
ÍÍ  
Approved
ÍÍ  (
)
ÍÍ( )
.
ÎÎ 
Include
ÎÎ 
(
ÎÎ 
x
ÎÎ 
=>
ÎÎ 
x
ÎÎ 
.
ÎÎ  
	Trackings
ÎÎ  )
)
ÎÎ) *
.
ÏÏ 
FirstOrDefault
ÏÏ 
(
ÏÏ  
x
ÏÏ  !
=>
ÏÏ" $
x
ÏÏ% &
.
ÏÏ& '
Id
ÏÏ' )
==
ÏÏ* ,
id
ÏÏ- /
)
ÏÏ/ 0
;
ÏÏ0 1
if
ÌÌ 
(
ÌÌ 
campaign
ÌÌ 
==
ÌÌ 
null
ÌÌ  
)
ÌÌ  !
{
ÓÓ 
throw
ÔÔ 
new
ÔÔ 
HttpException
ÔÔ '
(
ÔÔ' (
$num
ÔÔ( +
,
ÔÔ+ ,
$str
ÔÔ- 8
)
ÔÔ8 9
;
ÔÔ9 :
}
 
if
ÒÒ 
(
ÒÒ 
campaign
ÒÒ 
.
ÒÒ 
Approved
ÒÒ !
==
ÒÒ" $
null
ÒÒ% )
)
ÒÒ) *
{
ÚÚ 
TempData
ÛÛ 
[
ÛÛ 
$str
ÛÛ  
]
ÛÛ  !
=
ÛÛ" #
$str
ÛÛ$ `
;
ÛÛ` a
return
ÙÙ 
RedirectToAction
ÙÙ '
(
ÙÙ' (
$str
ÙÙ( /
,
ÙÙ/ 0
$str
ÙÙ1 <
)
ÙÙ< =
;
ÙÙ= >
}
ıı 
var
˜˜ 
campaignTracking
˜˜  
=
˜˜! "
campaign
˜˜# +
.
˜˜+ ,
	Trackings
˜˜, 5
.
˜˜5 6
FirstOrDefault
˜˜6 D
(
˜˜D E
x
˜˜E F
=>
˜˜G I
x
˜˜J K
.
˜˜K L
Id
˜˜L N
==
˜˜O Q

trackingId
˜˜R \
)
˜˜\ ]
;
˜˜] ^
if
¯¯ 
(
¯¯ 
campaignTracking
¯¯  
==
¯¯! #
null
¯¯$ (
)
¯¯( )
{
˘˘ 
TempData
˙˙ 
[
˙˙ 
$str
˙˙  
]
˙˙  !
=
˙˙" #
$str
˙˙$ A
;
˙˙A B
return
˚˚ 
RedirectToAction
˚˚ '
(
˚˚' (
$str
˚˚( /
,
˚˚/ 0
$str
˚˚1 <
)
˚˚< =
;
˚˚= >
}
¸¸ 
var
˝˝ 
model
˝˝ 
=
˝˝  
CampaignTrackingVm
˝˝ *
.
˝˝* +"
FromCampaignTracking
˝˝+ ?
(
˝˝? @
campaign
˝˝@ H
,
˝˝H I
campaignTracking
˝˝J Z
)
˝˝Z [
;
˝˝[ \
string
ˇˇ 
creativeUrl
ˇˇ 
=
ˇˇ  
campaign
ˇˇ! )
.
ˇˇ) *
Assets
ˇˇ* 0
.
ˇˇ0 1
CreativeUrl
ˇˇ1 <
,
ˇˇ< =
imagePathTemp
ÄÄ 
=
ÄÄ 
$"
ÄÄ  "
{
ÄÄ" #

UploadPath
ÄÄ# -
}
ÄÄ- .
\\
ÄÄ. 0
{
ÄÄ0 1
model
ÄÄ1 6
.
ÄÄ6 7
OrderNumber
ÄÄ7 B
}
ÄÄB C
t.png
ÄÄC H
"
ÄÄH I
,
ÄÄI J
	imagePath
ÅÅ 
=
ÅÅ 
$"
ÅÅ 
{
ÅÅ 

UploadPath
ÅÅ )
}
ÅÅ) *
\\
ÅÅ* ,
{
ÅÅ, -
model
ÅÅ- 2
.
ÅÅ2 3
OrderNumber
ÅÅ3 >
}
ÅÅ> ?
.png
ÅÅ? C
"
ÅÅC D
,
ÅÅD E
fileName
ÇÇ 
=
ÇÇ 
$"
ÇÇ 
{
ÇÇ 
model
ÇÇ #
.
ÇÇ# $
OrderNumber
ÇÇ$ /
}
ÇÇ/ 0
.xlsx
ÇÇ0 5
"
ÇÇ5 6
,
ÇÇ6 7
filePath
ÉÉ 
=
ÉÉ 
Path
ÉÉ 
.
ÉÉ  
Combine
ÉÉ  '
(
ÉÉ' (
DownloadPath
ÉÉ( 4
,
ÉÉ4 5
fileName
ÉÉ6 >
)
ÉÉ> ?
;
ÉÉ? @
string
ÖÖ 
logoFilePath
ÖÖ 
=
ÖÖ  !
!
ÖÖ" #
string
ÖÖ# )
.
ÖÖ) *
IsNullOrEmpty
ÖÖ* 7
(
ÖÖ7 8
LoggedInUser
ÖÖ8 D
?
ÖÖD E
.
ÖÖE F
CompanyLogo
ÖÖF Q
)
ÖÖQ R
?
ÜÜ 
$"
ÜÜ 
{
ÜÜ 

ImagesPath
ÜÜ 
}
ÜÜ  
\\
ÜÜ  "
{
ÜÜ" #
LoggedInUser
ÜÜ# /
.
ÜÜ/ 0
CompanyLogo
ÜÜ0 ;
}
ÜÜ; <
"
ÜÜ< =
:
áá 
$"
áá 
{
áá 

ImagesPath
áá 
}
áá  
\\logo1.png
áá  +
"
áá+ ,
;
áá, -
var
ââ 
helper
ââ 
=
ââ 
new
ââ 
ImageHelper
ââ (
(
ââ( )
creativeUrl
ââ) 4
,
ââ4 5
imagePathTemp
ââ6 C
)
ââC D
;
ââD E
if
ää 
(
ää 
!
ää 
System
ää 
.
ää 
IO
ää 
.
ää 
File
ää 
.
ää  
Exists
ää  &
(
ää& '
	imagePath
ää' 0
)
ää0 1
)
ää1 2
{
ãã 
helper
åå 
.
åå 
Capture
åå 
(
åå 
)
åå  
;
åå  !
if
çç 
(
çç 
System
çç 
.
çç 
IO
çç 
.
çç 
File
çç "
.
çç" #
Exists
çç# )
(
çç) *
imagePathTemp
çç* 7
)
çç7 8
)
çç8 9
helper
éé 
.
éé 
ResizeImage
éé &
(
éé& '
imagePathTemp
éé' 4
,
éé4 5
	imagePath
éé6 ?
,
éé? @
$num
ééA D
,
ééD E
$num
ééF I
,
ééI J
true
ééK O
)
ééO P
;
ééP Q
if
èè 
(
èè 
System
èè 
.
èè 
IO
èè 
.
èè 
File
èè "
.
èè" #
Exists
èè# )
(
èè) *
imagePathTemp
èè* 7
)
èè7 8
)
èè8 9
System
êê 
.
êê 
IO
êê 
.
êê 
File
êê "
.
êê" #
Delete
êê# )
(
êê) *
imagePathTemp
êê* 7
)
êê7 8
;
êê8 9
}
ëë 
string
ìì 
templateFile
ìì 
;
ìì  
if
îî 
(
îî 
LoggedInUser
îî 
?
îî 
.
îî 
ReportTemplate
îî ,
==
îî- /
$str
îî0 3
||
îî4 6
string
îî7 =
.
îî= >
IsNullOrEmpty
îî> K
(
îîK L
LoggedInUser
îîL X
?
îîX Y
.
îîY Z
ReportTemplate
îîZ h
)
îîh i
)
îîi j
templateFile
ïï 
=
ïï 
$"
ïï !(
~/Templates/Tracking1.xlsx
ïï! ;
"
ïï; <
;
ïï< =
else
ññ 
templateFile
óó 
=
óó 
$"
óó !(
~/Templates/Tracking2.xlsx
óó! ;
"
óó; <
;
óó< =
string
ôô 
logoResized
ôô 
=
ôô  
$"
ôô! #
{
ôô# $

ImagesPath
ôô$ .
}
ôô. /
\\logoResized.png
ôô/ @
"
ôô@ A
;
ôôA B
if
öö 
(
öö 
templateFile
öö 
==
öö 
$"
öö  "(
~/Templates/Tracking1.xlsx
öö" <
"
öö< =
)
öö= >
{
õõ 
helper
úú 
.
úú 
ResizeImage
úú "
(
úú" #
logoFilePath
úú# /
,
úú/ 0
logoResized
úú1 <
,
úú< =
$num
úú> A
,
úúA B
$num
úúC F
,
úúF G
true
úúH L
)
úúL M
;
úúM N
TrackingReports
ùù 
.
ùù  
GenerateTemplate1
ùù  1
(
ùù1 2
model
ùù2 7
,
ùù7 8
Server
ùù9 ?
.
ùù? @
MapPath
ùù@ G
(
ùùG H
templateFile
ùùH T
)
ùùT U
,
ùùU V
logoResized
ùùW b
,
ùùb c
	imagePath
ùùd m
,
ùùm n
filePath
ùùo w
)
ùùw x
;
ùùx y
}
ûû 
else
üü 
{
†† 
helper
°° 
.
°° 
ResizeImage
°° "
(
°°" #
logoFilePath
°°# /
,
°°/ 0
logoResized
°°1 <
,
°°< =
$num
°°> A
,
°°A B
$num
°°C E
,
°°E F
true
°°G K
)
°°K L
;
°°L M
TrackingReports
¢¢ 
.
¢¢  
GenerateTemplate2
¢¢  1
(
¢¢1 2
model
¢¢2 7
,
¢¢7 8
Server
¢¢9 ?
.
¢¢? @
MapPath
¢¢@ G
(
¢¢G H
templateFile
¢¢H T
)
¢¢T U
,
¢¢U V
logoResized
¢¢W b
,
¢¢b c
	imagePath
¢¢d m
,
¢¢m n
filePath
¢¢o w
)
¢¢w x
;
¢¢x y
}
££ 
return
•• 
File
•• 
(
•• 
filePath
••  
,
••  !
$str
••" e
,
••e f
fileName
••g o
)
••o p
;
••p q
}
¶¶ 	
public
®® 

JsonResult
®® 
RefreshProData
®® (
(
®®( )
string
®®) /
orderNumber
®®0 ;
)
®®; <
{
©© 	
try
™™ 
{
´´ 
if
¨¨ 
(
¨¨ 
orderNumber
¨¨ 
==
¨¨  "
null
¨¨# '
)
¨¨' (
{
≠≠ 
throw
ÆÆ 
new
ÆÆ 
AdsException
ÆÆ *
(
ÆÆ* +
$str
ÆÆ+ A
)
ÆÆA B
;
ÆÆB C
}
ØØ 
Campaign
±± 
campaign
±± !
=
±±" #
Db
±±$ &
.
±±& '
	Campaigns
±±' 0
.
≤≤ 
Include
≤≤ 
(
≤≤ 
x
≤≤ 
=>
≤≤ !
x
≤≤" #
.
≤≤# $
Approved
≤≤$ ,
)
≤≤, -
.
≥≥ 
Include
≥≥ 
(
≥≥ 
x
≥≥ 
=>
≥≥ !
x
≥≥" #
.
≥≥# $
Segments
≥≥$ ,
)
≥≥, -
.
¥¥ 
Include
¥¥ 
(
¥¥ 
x
¥¥ 
=>
¥¥ !
x
¥¥" #
.
¥¥# $
	Trackings
¥¥$ -
)
¥¥- .
.
µµ 
Where
µµ 
(
µµ 
x
µµ 
=>
µµ 
x
µµ  !
.
µµ! "
Status
µµ" (
==
µµ) +
(
µµ, -
int
µµ- 0
)
µµ0 1
CampaignStatus
µµ1 ?
.
µµ? @

Monitoring
µµ@ J
||
µµK M
x
µµN O
.
µµO P
Segments
µµP X
.
µµX Y
Any
µµY \
(
µµ\ ]
s
µµ] ^
=>
µµ_ a
s
µµb c
.
µµc d
SegmentStatus
µµd q
==
µµr t
(
µµu v
int
µµv y
)
µµy z
SegmentStatusµµz á
.µµá à

Monitoringµµà í
)µµí ì
)µµì î
.
∂∂ 
Where
∂∂ 
(
∂∂ 
x
∂∂ 
=>
∂∂ 
x
∂∂  !
.
∂∂! "
Approved
∂∂" *
!=
∂∂+ -
null
∂∂. 2
)
∂∂2 3
.
∑∑ 
FirstOrDefault
∑∑ #
(
∑∑# $
x
∑∑$ %
=>
∑∑& (
x
∑∑) *
.
∑∑* +
OrderNumber
∑∑+ 6
==
∑∑7 9
orderNumber
∑∑: E
)
∑∑E F
;
∑∑F G
if
∫∫ 
(
∫∫ 
campaign
∫∫ 
!=
∫∫ 
null
∫∫ #
)
∫∫# $
ProDataApiManager
ªª %
.
ªª% &%
FetchAndUpdateTrackings
ªª& =
(
ªª= >
Db
ªª> @
,
ªª@ A
campaign
ªªB J
)
ªªJ K
;
ªªK L
return
¿¿ 
Json
¿¿ 
(
¿¿ 
new
¿¿ 
JsonResponse
¿¿  ,
(
¿¿, -
)
¿¿- .
{
¿¿/ 0
IsSucess
¿¿1 9
=
¿¿: ;
true
¿¿< @
}
¿¿A B
)
¿¿B C
;
¿¿C D
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
√√ 
return
ƒƒ 
Json
ƒƒ 
(
ƒƒ 
new
ƒƒ 
JsonResponse
ƒƒ  ,
(
ƒƒ, -
)
ƒƒ- .
{
ƒƒ/ 0
IsSucess
ƒƒ1 9
=
ƒƒ: ;
false
ƒƒ< A
,
ƒƒA B
ErrorMessage
ƒƒC O
=
ƒƒP Q
ex
ƒƒR T
.
ƒƒT U
Message
ƒƒU \
}
ƒƒ] ^
)
ƒƒ^ _
;
ƒƒ_ `
}
≈≈ 
}
∆∆ 	
}
»» 
}…… ˆ?
>E:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Global.asax.cs
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

class 
MvcApplication 
:  !
HttpApplication" 1
{ 
	protected 
void 
Application_Start (
(( )
)) *
{ 	
AreaRegistration 
. 
RegisterAllAreas -
(- .
). /
;/ 0
GlobalConfiguration 
.  
	Configure  )
() *
WebApiConfig* 6
.6 7
Register7 ?
)? @
;@ A
FilterConfig 
. !
RegisterGlobalFilters .
(. /
GlobalFilters/ <
.< =
Filters= D
)D E
;E F
RouteConfig 
. 
RegisterRoutes &
(& '

RouteTable' 1
.1 2
Routes2 8
)8 9
;9 :
BundleConfig 
. 
RegisterBundles (
(( )
BundleTable) 4
.4 5
Bundles5 <
)< =
;= > 
HangfireBootstrapper  
.  !
Instance! )
.) *
Start* /
(/ 0
)0 1
;1 2
} 	
	protected 
void 
Application_End &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{   	 
HangfireBootstrapper!!  
.!!  !
Instance!!! )
.!!) *
Stop!!* .
(!!. /
)!!/ 0
;!!0 1
}"" 	
	protected$$ 
void$$ 
Application_Error$$ (
($$( )
object$$) /
sender$$0 6
,$$6 7
	EventArgs$$8 A
e$$B C
)$$C D
{%% 	
var&& 
httpContext&& 
=&& 
(&& 
(&&  
MvcApplication&&  .
)&&. /
sender&&/ 5
)&&5 6
.&&6 7
Context&&7 >
;&&> ?
var'' 
currentController'' !
=''" #
$str''$ '
;''' (
var(( 
currentAction(( 
=(( 
$str((  #
;((# $
var)) 
currentRouteData))  
=))! "

RouteTable))# -
.))- .
Routes)). 4
.))4 5
GetRouteData))5 A
())A B
new))B E
HttpContextWrapper))F X
())X Y
httpContext))Y d
)))d e
)))e f
;))f g
if++ 
(++ 
currentRouteData++  
!=++! #
null++$ (
)++( )
{,, 
if-- 
(-- 
currentRouteData-- $
.--$ %
Values--% +
[--+ ,
$str--, 8
]--8 9
!=--: <
null--= A
&&--B D
!--E F
string--F L
.--L M
IsNullOrEmpty--M Z
(--Z [
currentRouteData--[ k
.--k l
Values--l r
[--r s
$str--s 
]	-- Ä
.
--Ä Å
ToString
--Å â
(
--â ä
)
--ä ã
)
--ã å
)
--å ç
{.. 
currentController// %
=//& '
currentRouteData//( 8
.//8 9
Values//9 ?
[//? @
$str//@ L
]//L M
.//M N
ToString//N V
(//V W
)//W X
;//X Y
}00 
if22 
(22 
currentRouteData22 $
.22$ %
Values22% +
[22+ ,
$str22, 4
]224 5
!=226 8
null229 =
&&22> @
!22A B
string22B H
.22H I
IsNullOrEmpty22I V
(22V W
currentRouteData22W g
.22g h
Values22h n
[22n o
$str22o w
]22w x
.22x y
ToString	22y Å
(
22Å Ç
)
22Ç É
)
22É Ñ
)
22Ñ Ö
{33 
currentAction44 !
=44" #
currentRouteData44$ 4
.444 5
Values445 ;
[44; <
$str44< D
]44D E
.44E F
ToString44F N
(44N O
)44O P
;44P Q
}55 
}66 
var77 
ex77 
=77 
Server77 
.77 
GetLastError77 (
(77( )
)77) *
;77* +
try99 
{:: 
EmailHelper;; 
.;; 
SendErrorEmail;; *
(;;* + 
ConfigurationManager;;+ ?
.;;? @
AppSettings;;@ K
[;;K L
$str;;L _
];;_ `
,;;` a
ex;;b d
,;;d e
currentController;;f w
,;;w x
currentAction<< !
)<<! "
;<<" #
}== 
catch>> 
(>> 
	Exception>> 
exx>>  
)>>  !
{?? 
}AA 
varCC 
	routeDataCC 
=CC 
newCC 
	RouteDataCC  )
(CC) *
)CC* +
;CC+ ,
varDD 
actionDD 
=DD 
$strDD '
;DD' (
ifFF 
(FF 
exFF 
isFF 
HttpExceptionFF #
)FF# $
{GG 
varHH 
httpExHH 
=HH 
exHH 
asHH  "
HttpExceptionHH# 0
;HH0 1
switchJJ 
(JJ 
httpExJJ 
.JJ 
GetHttpCodeJJ *
(JJ* +
)JJ+ ,
)JJ, -
{KK 
caseLL 
$numLL 
:LL 
actionMM 
=MM  
$strMM! -
;MM- .
breakNN 
;NN 
caseOO 
$numOO 
:OO 
actionPP 
=PP  
$strPP! +
;PP+ ,
breakQQ 
;QQ 
}SS 
}TT 
httpContextVV 
.VV 

ClearErrorVV "
(VV" #
)VV# $
;VV$ %
httpContextWW 
.WW 
ResponseWW  
.WW  !
ClearWW! &
(WW& '
)WW' (
;WW( )
httpContextXX 
.XX 
ResponseXX  
.XX  !

StatusCodeXX! +
=XX, -
exXX. 0
isXX1 3
HttpExceptionXX4 A
?XXB C
(XXD E
(XXE F
HttpExceptionXXF S
)XXS T
exXXT V
)XXV W
.XXW X
GetHttpCodeXXX c
(XXc d
)XXd e
:XXf g
$numXXh k
;XXk l
httpContextYY 
.YY 
ResponseYY  
.YY  !"
TrySkipIisCustomErrorsYY! 7
=YY8 9
trueYY: >
;YY> ?
	routeData[[ 
.[[ 
Values[[ 
[[[ 
$str[[ )
][[) *
=[[+ ,
$str[[- 4
;[[4 5
	routeData\\ 
.\\ 
Values\\ 
[\\ 
$str\\ %
]\\% &
=\\' (
action\\) /
;\\/ 0
	routeData]] 
.]] 
Values]] 
[]] 
$str]] (
]]]( )
=]]* +
new]], /
HandleErrorInfo]]0 ?
(]]? @
ex]]@ B
,]]B C
currentController]]D U
,]]U V
currentAction]]W d
)]]d e
;]]e f
IController__ 
errorController__ '
=__( )
new__* -
ErrorController__. =
(__= >
)__> ?
;__? @
HttpContextWrapper`` 
wrapper`` &
=``' (
new``) ,
HttpContextWrapper``- ?
(``? @
httpContext``@ K
)``K L
;``L M
varaa 
rcaa 
=aa 
newaa 
RequestContextaa '
(aa' (
wrapperaa( /
,aa/ 0
	routeDataaa1 :
)aa: ;
;aa; <
errorControllerbb 
.bb 
Executebb #
(bb# $
rcbb$ &
)bb& '
;bb' (
}cc 	
}dd 
}ee Î
QE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\AjaxAuthorizeAttribute.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class "
AjaxAuthorizeAttribute '
:( )
AuthorizeAttribute* <
{ 
	protected 
override 
void %
HandleUnauthorizedRequest  9
(9 : 
AuthorizationContext: N
contextO V
)V W
{ 	
if		 
(		 
context		 
.		 
HttpContext		 #
.		# $
Request		$ +
.		+ ,
IsAjaxRequest		, 9
(		9 :
)		: ;
)		; <
{

 
var 
	urlHelper 
= 
new  #
	UrlHelper$ -
(- .
context. 5
.5 6
RequestContext6 D
)D E
;E F
context 
. 
HttpContext #
.# $
Response$ ,
., -

StatusCode- 7
=8 9
$num: =
;= >
context 
. 
Result 
=  
new! $

JsonResult% /
{ 
Data 
= 
new 
{ 
Error 
= 
$str  /
,/ 0
LogOnUrl  
=! "
	urlHelper# ,
., -
Action- 3
(3 4
$str4 ;
,; <
$str= F
)F G
} 
, 
JsonRequestBehavior '
=( )
JsonRequestBehavior* =
.= >
AllowGet> F
} 
; 
} 
else 
{ 
base 
. %
HandleUnauthorizedRequest .
(. /
context/ 6
)6 7
;7 8
} 
} 	
} 
} ë
HE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\AuthorizeRole.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public		 

class		 
AuthorizeRole		 
:		  !
ActionFilterAttribute		! 6
{

 
public 
string 
Roles 
{ 
get !
;! "
set# &
;& '
}( )
public 
override 
void 
OnActionExecuting .
(. /"
ActionExecutingContext/ E
filterContextF S
)S T
{ 	
bool 
	ifAllowed 
= 
false "
;" #
try 
{ 
var 
userIdentity  
=! "
filterContext# 0
.0 1
HttpContext1 <
.< =
User= A
.A B
IdentityB J
asK M
ClaimsIdentityN \
;\ ]
var 
roles 
= 
userIdentity (
.( )
Claims) /
./ 0
Where0 5
(5 6
x6 7
=>8 :
x; <
.< =
Type= A
==B D

ClaimTypesE O
.O P
RoleP T
)T U
.U V
SelectV \
(\ ]
claim] b
=>c e
claime j
.j k
Valuek p
)p q
.q r
ToArrayr y
(y z
)z {
;{ |
var 
	rolesList 
= 
Roles  %
.% &
Split& +
(+ ,
$str, /
./ 0
ToCharArray0 ;
(; <
)< =
,= >
StringSplitOptions? Q
.Q R
RemoveEmptyEntriesR d
)d e
;e f
foreach 
( 
var 
requestedRole *
in+ -
	rolesList. 7
)7 8
{ 
if   
(   
roles   
.   
Contains   &
(  & '
requestedRole  ' 4
)  4 5
)  5 6
{!! 
	ifAllowed"" !
=""" #
true""$ (
;""( )
break## 
;## 
}$$ 
}%% 
if'' 
('' 
	ifAllowed'' 
)'' 
{(( 
base)) 
.)) 
OnActionExecuting)) *
())* +
filterContext))+ 8
)))8 9
;))9 :
return** 
;** 
}++ 
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)-- 
{.. 
}00 
filterContext33 
.33 
Result33  
=33! "
new44 !
RedirectToRouteResult44 -
(44- .
new44. 1 
RouteValueDictionary442 F
{55 
{66 
$str66 "
,66" #
$str66$ 3
}664 5
,665 6
{77 
$str77 &
,77& '
$str77( /
}770 1
,771 2
}88 
)88 
;88 
return99 
;99 
}:: 	
};; 
}<< í
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\AuthorizeClaim.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public		 

class		 
AuthorizeClaim		 
:		  !!
ActionFilterAttribute		" 7
{

 
public 
string 
Claims 
{ 
get "
;" #
set$ '
;' (
}) *
public 
override 
void 
OnActionExecuting .
(. /"
ActionExecutingContext/ E
filterContextF S
)S T
{ 	
bool 
	ifAllowed 
= 
false "
;" #
try 
{ 
var 
userIdentity  
=! "
filterContext# 0
.0 1
HttpContext1 <
.< =
User= A
.A B
IdentityB J
asK M
ClaimsIdentityN \
;\ ]
var 
claims 
= 
userIdentity )
.) *
Claims* 0
.0 1
Where1 6
(6 7
x7 8
=>9 ;
x< =
.= >
Type> B
==C E

ClaimTypesF P
.P Q
UserDataQ Y
)Y Z
.Z [
Select[ a
(a b
claimb g
=>h j
claimk p
.p q
Valueq v
)v w
.w x
ToListx ~
(~ 
)	 Ä
;
Ä Å
var 

claimsList 
=  
Claims! '
.' (
Split( -
(- .
$str. 1
.1 2
ToCharArray2 =
(= >
)> ?
,? @
StringSplitOptionsA S
.S T
RemoveEmptyEntriesT f
)f g
;g h
foreach 
( 
var 
requestedClaim +
in, .

claimsList/ 9
)9 :
{   
if!! 
(!! 
claims!! 
.!! 
Contains!! '
(!!' (
requestedClaim!!( 6
)!!6 7
)!!7 8
{"" 
	ifAllowed## !
=##" #
true##$ (
;##( )
break$$ 
;$$ 
}%% 
}&& 
if(( 
((( 
	ifAllowed(( 
)(( 
{)) 
base** 
.** 
OnActionExecuting** *
(*** +
filterContext**+ 8
)**8 9
;**9 :
return++ 
;++ 
},, 
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
).. 
{// 
}11 
filterContext44 
.44 
Result44  
=44! "
new55 !
RedirectToRouteResult55 -
(55- .
new55. 1 
RouteValueDictionary552 F
{66 
{77 
$str77 "
,77" #
$str77$ 3
}774 5
,775 6
{88 
$str88 &
,88& '
$str88( /
}880 1
}99 
)99 
;99 
return:: 
;:: 
};; 	
}<< 
}== ì∆
DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\CsvHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
CsvFile 
: 
IDisposable &
{ 
public 
static 
CsvDefinition # 
DefaultCsvDefinition$ 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
static 
bool 

UseLambdas %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
static 
bool 
UseTasks #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
static 
bool 
FastIndexOfAny )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
static 
CsvFile 
( 
) 
{ 	 
DefaultCsvDefinition%%  
=%%! "
new%%# &
CsvDefinition%%' 4
{&& 
	EndOfLine'' 
='' 
$str'' "
,''" #
FieldSeparator(( 
=((  
$char((! $
,(($ %
TextQualifier)) 
=)) 
$char))  #
}** 
;** 

UseLambdas++ 
=++ 
true++ 
;++ 
UseTasks,, 
=,, 
true,, 
;,, 
FastIndexOfAny-- 
=-- 
true-- !
;--! "
}.. 	
internal22 
	protected22 
Stream22 !

BaseStream22" ,
;22, -
	protected33 
static33 
DateTime33 !
DateTimeZero33" .
=33/ 0
new331 4
DateTime335 =
(33= >
)33> ?
;33? @
public66 
static66 
IEnumerable66 !
<66! "
T66" #
>66# $
Read66% )
<66) *
T66* +
>66+ ,
(66, -
	CsvSource66- 6
	csvSource667 @
)66@ A
where66B G
T66H I
:66J K
new66L O
(66O P
)66P Q
{77 	
var88 
csvFileReader88 
=88 
new88  #
CsvFileReader88$ 1
<881 2
T882 3
>883 4
(884 5
	csvSource885 >
)88> ?
;88? @
return99 
(99 
IEnumerable99 
<99  
T99  !
>99! "
)99" #
csvFileReader99# 0
;990 1
}:: 	
public<< 
char<< 
FieldSeparator<< "
{<<# $
get<<% (
;<<( )
private<<* 1
set<<2 5
;<<5 6
}<<7 8
public== 
char== 
TextQualifier== !
{==" #
get==$ '
;==' (
private==) 0
set==1 4
;==4 5
}==6 7
public>> 
IEnumerable>> 
<>> 
String>> !
>>>! "
Columns>># *
{>>+ ,
get>>- 0
;>>0 1
private>>2 9
set>>: =
;>>= >
}>>? @
public@@ 
void@@ 
Dispose@@ 
(@@ 
)@@ 
{AA 	
DisposeBB 
(BB 
trueBB 
)BB 
;BB 
}CC 	
	protectedEE 
virtualEE 
voidEE 
DisposeEE &
(EE& '
boolEE' +
	disposingEE, 5
)EE5 6
{FF 	
}II 	
}JJ 
publicLL 

classLL 
CsvFileLL 
<LL 
TLL 
>LL 
:LL 
CsvFileLL %
{MM 
privateNN 
readonlyNN 
charNN 
_fieldSeparatorNN -
;NN- .
privateOO 
readonlyOO 
stringOO #
_fieldSeparatorAsStringOO  7
;OO7 8
privatePP 
readonlyPP 
charPP 
[PP 
]PP !
_invalidCharsInFieldsPP  5
;PP5 6
privateQQ 
readonlyQQ 
StreamWriterQQ %
_streamWriterQQ& 3
;QQ3 4
privateRR 
readonlyRR 
charRR 
_textQualifierRR ,
;RR, -
privateSS 
readonlySS 
StringSS 
[SS  
]SS  !
_columnsSS" *
;SS* +
privateTT 
FuncTT 
<TT 
TTT 
,TT 
objectTT 
>TT 
[TT  
]TT  !
_gettersTT" *
;TT* +
readonlyUU 
boolUU 
[UU 
]UU "
_isInvalidCharInFieldsUU .
;UU. /
privateWW 
intWW 
_linesToWriteWW !
;WW! "
privateXX 
readonlyXX 
BlockingCollectionXX +
<XX+ ,
stringXX, 2
>XX2 3
_csvLinesToWriteXX4 D
=XXE F
newXXG J
BlockingCollectionXXK ]
<XX] ^
stringXX^ d
>XXd e
(XXe f
$numXXf j
)XXj k
;XXk l
privateYY 
readonlyYY 
ThreadYY 
_writeCsvLinesTaskYY  2
;YY2 3
privateZZ 
TaskZZ 
_addAsyncTaskZZ "
;ZZ" #
public]] 
CsvFile]] 
(]] 
CsvDestination]] %
csvDestination]]& 4
)]]4 5
:^^ 
this^^ 
(^^ 
csvDestination^^ !
,^^! "
null^^# '
)^^' (
{__ 	
}`` 	
publicbb 
CsvFilebb 
(bb 
)bb 
{cc 	
}dd 	
publicff 
CsvFileff 
(ff 
CsvDestinationff %
csvDestinationff& 4
,ff4 5
CsvDefinitionff6 C
csvDefinitionffD Q
)ffQ R
{gg 	
ifhh 
(hh 
csvDefinitionhh 
==hh  
nullhh! %
)hh% &
csvDefinitionii 
=ii  
DefaultCsvDefinitionii  4
;ii4 5
thisjj 
.jj 
_columnsjj 
=jj 
(jj 
csvDefinitionjj *
.jj* +
Columnsjj+ 2
??jj3 5
InferColumnsjj6 B
(jjB C
typeofjjC I
(jjI J
TjjJ K
)jjK L
)jjL M
)jjM N
.jjN O
ToArrayjjO V
(jjV W
)jjW X
;jjX Y
thiskk 
.kk 
_fieldSeparatorkk  
=kk! "
csvDefinitionkk# 0
.kk0 1
FieldSeparatorkk1 ?
;kk? @
thisll 
.ll #
_fieldSeparatorAsStringll (
=ll) *
thisll+ /
.ll/ 0
_fieldSeparatorll0 ?
.ll? @
ToStringll@ H
(llH I
CultureInfollI T
.llT U
InvariantCulturellU e
)lle f
;llf g
thismm 
.mm 
_textQualifiermm 
=mm  !
csvDefinitionmm" /
.mm/ 0
TextQualifiermm0 =
;mm= >
thisnn 
.nn 
_streamWriternn 
=nn  
csvDestinationnn! /
.nn/ 0
StreamWriternn0 <
;nn< =
thispp 
.pp !
_invalidCharsInFieldspp &
=pp' (
newpp) ,
[pp, -
]pp- .
{pp/ 0
$charpp1 5
,pp5 6
$charpp7 ;
,pp; <
thispp= A
.ppA B
_textQualifierppB P
,ppP Q
thisppR V
.ppV W
_fieldSeparatorppW f
}ppg h
;pph i
thisqq 
.qq "
_isInvalidCharInFieldsqq '
=qq( )
newqq* -
boolqq. 2
[qq2 3
$numqq3 6
]qq6 7
;qq7 8
foreachss 
(ss 
varss 
css 
inss 
thisss "
.ss" #!
_invalidCharsInFieldsss# 8
)ss8 9
{tt 
thisuu 
.uu "
_isInvalidCharInFieldsuu +
[uu+ ,
cuu, -
]uu- .
=uu/ 0
trueuu1 5
;uu5 6
}vv 
thisww 
.ww 
WriteHeaderww 
(ww 
)ww 
;ww 
thisyy 
.yy 
CreateGettersyy 
(yy 
)yy  
;yy  !
if{{ 
({{ 
CsvFile{{ 
.{{ 
UseTasks{{  
){{  !
{|| 
_writeCsvLinesTask}} "
=}}# $
new}}% (
Thread}}) /
(}}/ 0
(}}0 1
o}}1 2
)}}2 3
=>}}4 6
this}}7 ;
.}}; <
WriteCsvLines}}< I
(}}I J
)}}J K
)}}K L
;}}L M
_writeCsvLinesTask~~ "
.~~" #
Start~~# (
(~~( )
)~~) *
;~~* +
} 
this
ÄÄ 
.
ÄÄ 
_addAsyncTask
ÄÄ 
=
ÄÄ  
Task
ÄÄ! %
.
ÄÄ% &
Factory
ÄÄ& -
.
ÄÄ- .
StartNew
ÄÄ. 6
(
ÄÄ6 7
(
ÄÄ7 8
)
ÄÄ8 9
=>
ÄÄ: <
{
ÄÄ= >
}
ÄÄ? @
)
ÄÄ@ A
;
ÄÄA B
}
ÑÑ 	
	protected
ÜÜ 
override
ÜÜ 
void
ÜÜ 
Dispose
ÜÜ  '
(
ÜÜ' (
bool
ÜÜ( ,
	disposing
ÜÜ- 6
)
ÜÜ6 7
{
áá 	
if
àà 
(
àà 
	disposing
àà 
)
àà 
{
ââ 
_addAsyncTask
çç 
.
çç 
Wait
çç "
(
çç" #
)
çç# $
;
çç$ %
if
éé 
(
éé 
_csvLinesToWrite
éé $
!=
éé% '
null
éé( ,
)
éé, -
{
èè 
_csvLinesToWrite
êê $
.
êê$ %
CompleteAdding
êê% 3
(
êê3 4
)
êê4 5
;
êê5 6
}
ëë 
if
íí 
(
íí  
_writeCsvLinesTask
íí &
!=
íí' )
null
íí* .
)
íí. / 
_writeCsvLinesTask
ìì &
.
ìì& '
Join
ìì' +
(
ìì+ ,
)
ìì, -
;
ìì- .
this
ïï 
.
ïï 
_streamWriter
ïï "
.
ïï" #
Close
ïï# (
(
ïï( )
)
ïï) *
;
ïï* +
}
ññ 
}
óó 	
	protected
ôô 
static
ôô 
IEnumerable
ôô $
<
ôô$ %
string
ôô% +
>
ôô+ ,
InferColumns
ôô- 9
(
ôô9 :
Type
ôô: >

recordType
ôô? I
)
ôôI J
{
öö 	
var
õõ 
columns
õõ 
=
õõ 

recordType
õõ $
.
úú 
GetProperties
úú 
(
úú 
BindingFlags
úú +
.
úú+ ,
Public
úú, 2
|
úú3 4
BindingFlags
úú5 A
.
úúA B
Instance
úúB J
)
úúJ K
.
ùù 
Where
ùù 
(
ùù 
pi
ùù 
=>
ùù 
pi
ùù 
.
ùù   
GetIndexParameters
ùù  2
(
ùù2 3
)
ùù3 4
.
ùù4 5
Length
ùù5 ;
==
ùù< >
$num
ùù? @
&&
ûû 
pi
ûû 
.
ûû 
GetSetMethod
ûû &
(
ûû& '
)
ûû' (
!=
ûû) +
null
ûû, 0
&&
üü 
!
üü 
	Attribute
üü !
.
üü! "
	IsDefined
üü" +
(
üü+ ,
pi
üü, .
,
üü. /
typeof
üü0 6
(
üü6 7(
CsvIgnorePropertyAttribute
üü7 Q
)
üüQ R
)
üüR S
)
üüS T
.
†† 
Select
†† 
(
†† 
pi
†† 
=>
†† 
pi
††  
.
††  !
Name
††! %
)
††% &
.
°° 
Concat
°° 
(
°° 

recordType
°° "
.
¢¢ 
	GetFields
¢¢ 
(
¢¢ 
BindingFlags
¢¢ +
.
¢¢+ ,
Public
¢¢, 2
|
¢¢3 4
BindingFlags
¢¢5 A
.
¢¢A B
Instance
¢¢B J
)
¢¢J K
.
££ 
Where
££ 
(
££ 
fi
££ 
=>
££  
!
££! "
	Attribute
££" +
.
££+ ,
	IsDefined
££, 5
(
££5 6
fi
££6 8
,
££8 9
typeof
££: @
(
££@ A(
CsvIgnorePropertyAttribute
££A [
)
££[ \
)
££\ ]
)
££] ^
.
§§ 
Select
§§ 
(
§§ 
fi
§§ 
=>
§§ !
fi
§§" $
.
§§$ %
Name
§§% )
)
§§) *
)
§§* +
.
•• 
ToList
•• 
(
•• 
)
•• 
;
•• 
return
¶¶ 
columns
¶¶ 
;
¶¶ 
}
ßß 	
private
™™ 
void
™™ 
WriteCsvLines
™™ "
(
™™" #
)
™™# $
{
´´ 	
int
¨¨ 
written
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
csvLine
≠≠  
in
≠≠! #
_csvLinesToWrite
≠≠$ 4
.
≠≠4 5$
GetConsumingEnumerable
≠≠5 K
(
≠≠K L
)
≠≠L M
)
≠≠M N
{
ÆÆ 
this
ØØ 
.
ØØ 
_streamWriter
ØØ "
.
ØØ" #
	WriteLine
ØØ# ,
(
ØØ, -
csvLine
ØØ- 4
)
ØØ4 5
;
ØØ5 6
written
∞∞ 
++
∞∞ 
;
∞∞ 
}
±± 
Interlocked
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
ref
≤≤ 
this
≤≤  $
.
≤≤$ %
_linesToWrite
≤≤% 2
,
≤≤2 3
-
≤≤4 5
written
≤≤5 <
)
≤≤< =
;
≤≤= >
}
≥≥ 	
public
∑∑ 
void
∑∑ 
Append
∑∑ 
(
∑∑ 
T
∑∑ 
record
∑∑ #
)
∑∑# $
{
∏∏ 	
if
∫∫ 
(
∫∫ 
CsvFile
∫∫ 
.
∫∫ 
UseTasks
∫∫  
)
∫∫  !
{
ªª 
var
ææ 
linesWaiting
ææ  
=
ææ! "
Interlocked
ææ# .
.
ææ. /
	Increment
ææ/ 8
(
ææ8 9
ref
ææ9 <
this
ææ= A
.
ææA B
_linesToWrite
ææB O
)
ææO P
;
ææP Q
Action
øø 
<
øø 
Task
øø 
>
øø 
	addRecord
øø &
=
øø' (
(
øø) *
t
øø* +
)
øø+ ,
=>
øø- /
{
¿¿ 
var
¡¡ 
csvLine
¡¡ 
=
¡¡  !
this
¡¡" &
.
¡¡& '
ToCsv
¡¡' ,
(
¡¡, -
record
¡¡- 3
)
¡¡3 4
;
¡¡4 5
this
¬¬ 
.
¬¬ 
_csvLinesToWrite
¬¬ )
.
¬¬) *
Add
¬¬* -
(
¬¬- .
csvLine
¬¬. 5
)
¬¬5 6
;
¬¬6 7
}
√√ 
;
√√ 
if
≈≈ 
(
≈≈ 
linesWaiting
≈≈  
<
≈≈! "
$num
≈≈# (
)
≈≈( )
this
∆∆ 
.
∆∆ 
_addAsyncTask
∆∆ &
=
∆∆' (
this
∆∆) -
.
∆∆- .
_addAsyncTask
∆∆. ;
.
∆∆; <
ContinueWith
∆∆< H
(
∆∆H I
	addRecord
∆∆I R
)
∆∆R S
;
∆∆S T
else
«« 
	addRecord
»» 
(
»» 
null
»» "
)
»»" #
;
»»# $
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
var
œœ 
csvLine
œœ 
=
œœ 
this
œœ "
.
œœ" #
ToCsv
œœ# (
(
œœ( )
record
œœ) /
)
œœ/ 0
;
œœ0 1
this
–– 
.
–– 
_streamWriter
–– "
.
––" #
	WriteLine
––# ,
(
––, -
csvLine
––- 4
)
––4 5
;
––5 6
}
—— 
}
““ 	
private
‘‘ 
static
‘‘ 
Func
‘‘ 
<
‘‘ 
T
‘‘ 
,
‘‘ 
object
‘‘ %
>
‘‘% &

FindGetter
‘‘' 1
(
‘‘1 2
string
‘‘2 8
c
‘‘9 :
,
‘‘: ;
bool
‘‘< @
staticMember
‘‘A M
)
‘‘M N
{
’’ 	
var
÷÷ 
flags
÷÷ 
=
÷÷ 
BindingFlags
÷÷ $
.
÷÷$ %
Public
÷÷% +
|
÷÷, -
BindingFlags
÷÷. :
.
÷÷: ;
	NonPublic
÷÷; D
|
÷÷E F
BindingFlags
÷÷G S
.
÷÷S T

IgnoreCase
÷÷T ^
|
÷÷_ `
(
÷÷a b
staticMember
÷÷b n
?
÷÷o p
BindingFlags
÷÷q }
.
÷÷} ~
Static÷÷~ Ñ
:÷÷Ö Ü
BindingFlags÷÷á ì
.÷÷ì î
Instance÷÷î ú
)÷÷ú ù
;÷÷ù û
Func
◊◊ 
<
◊◊ 
T
◊◊ 
,
◊◊ 
object
◊◊ 
>
◊◊ 
func
◊◊  
=
◊◊! "
null
◊◊# '
;
◊◊' (
PropertyInfo
ÿÿ 
pi
ÿÿ 
=
ÿÿ 
typeof
ÿÿ $
(
ÿÿ$ %
T
ÿÿ% &
)
ÿÿ& '
.
ÿÿ' (
GetProperty
ÿÿ( 3
(
ÿÿ3 4
c
ÿÿ4 5
,
ÿÿ5 6
flags
ÿÿ7 <
)
ÿÿ< =
;
ÿÿ= >
	FieldInfo
ŸŸ 
fi
ŸŸ 
=
ŸŸ 
typeof
ŸŸ !
(
ŸŸ! "
T
ŸŸ" #
)
ŸŸ# $
.
ŸŸ$ %
GetField
ŸŸ% -
(
ŸŸ- .
c
ŸŸ. /
,
ŸŸ/ 0
flags
ŸŸ1 6
)
ŸŸ6 7
;
ŸŸ7 8
if
€€ 
(
€€ 
CsvFile
€€ 
.
€€ 

UseLambdas
€€ "
)
€€" #
{
‹‹ 

Expression
›› 
expr
›› 
=
››  !
null
››" &
;
››& '!
ParameterExpression
ﬁﬁ #
	parameter
ﬁﬁ$ -
=
ﬁﬁ. /

Expression
ﬁﬁ0 :
.
ﬁﬁ: ;
	Parameter
ﬁﬁ; D
(
ﬁﬁD E
typeof
ﬁﬁE K
(
ﬁﬁK L
T
ﬁﬁL M
)
ﬁﬁM N
,
ﬁﬁN O
$str
ﬁﬁP S
)
ﬁﬁS T
;
ﬁﬁT U
Type
ﬂﬂ 
type
ﬂﬂ 
=
ﬂﬂ 
null
ﬂﬂ  
;
ﬂﬂ  !
if
·· 
(
·· 
pi
·· 
!=
·· 
null
·· 
)
·· 
{
‚‚ 
type
„„ 
=
„„ 
pi
„„ 
.
„„ 
PropertyType
„„ *
;
„„* +
expr
‰‰ 
=
‰‰ 

Expression
‰‰ %
.
‰‰% &
Property
‰‰& .
(
‰‰. /
	parameter
‰‰/ 8
,
‰‰8 9
pi
‰‰: <
.
‰‰< =
Name
‰‰= A
)
‰‰A B
;
‰‰B C
}
ÂÂ 
else
ÊÊ 
if
ÊÊ 
(
ÊÊ 
fi
ÊÊ 
!=
ÊÊ 
null
ÊÊ #
)
ÊÊ# $
{
ÁÁ 
type
ËË 
=
ËË 
fi
ËË 
.
ËË 
	FieldType
ËË '
;
ËË' (
expr
ÈÈ 
=
ÈÈ 

Expression
ÈÈ %
.
ÈÈ% &
Field
ÈÈ& +
(
ÈÈ+ ,
	parameter
ÈÈ, 5
,
ÈÈ5 6
fi
ÈÈ7 9
.
ÈÈ9 :
Name
ÈÈ: >
)
ÈÈ> ?
;
ÈÈ? @
}
ÍÍ 
if
ÎÎ 
(
ÎÎ 
expr
ÎÎ 
!=
ÎÎ 
null
ÎÎ  
)
ÎÎ  !
{
ÏÏ 

Expression
ÌÌ 
<
ÌÌ 
Func
ÌÌ #
<
ÌÌ# $
T
ÌÌ$ %
,
ÌÌ% &
object
ÌÌ' -
>
ÌÌ- .
>
ÌÌ. /
lambda
ÌÌ0 6
;
ÌÌ6 7
if
ÓÓ 
(
ÓÓ 
type
ÓÓ 
.
ÓÓ 
IsValueType
ÓÓ (
)
ÓÓ( )
{
ÔÔ 
lambda
 
=
  

Expression
! +
.
+ ,
Lambda
, 2
<
2 3
Func
3 7
<
7 8
T
8 9
,
9 :
object
; A
>
A B
>
B C
(
C D

Expression
D N
.
N O
TypeAs
O U
(
U V
expr
V Z
,
Z [
typeof
\ b
(
b c
object
c i
)
i j
)
j k
,
k l
	parameter
m v
)
v w
;
w x
}
ÒÒ 
else
ÚÚ 
{
ÛÛ 
lambda
ÙÙ 
=
ÙÙ  

Expression
ÙÙ! +
.
ÙÙ+ ,
Lambda
ÙÙ, 2
<
ÙÙ2 3
Func
ÙÙ3 7
<
ÙÙ7 8
T
ÙÙ8 9
,
ÙÙ9 :
object
ÙÙ; A
>
ÙÙA B
>
ÙÙB C
(
ÙÙC D
expr
ÙÙD H
,
ÙÙH I
	parameter
ÙÙJ S
)
ÙÙS T
;
ÙÙT U
}
ıı 
func
ˆˆ 
=
ˆˆ 
lambda
ˆˆ !
.
ˆˆ! "
Compile
ˆˆ" )
(
ˆˆ) *
)
ˆˆ* +
;
ˆˆ+ ,
}
˜˜ 
}
¯¯ 
else
˘˘ 
{
˙˙ 
if
˚˚ 
(
˚˚ 
pi
˚˚ 
!=
˚˚ 
null
˚˚ 
)
˚˚ 
func
¸¸ 
=
¸¸ 
o
¸¸ 
=>
¸¸ 
pi
¸¸  "
.
¸¸" #
GetValue
¸¸# +
(
¸¸+ ,
o
¸¸, -
,
¸¸- .
null
¸¸/ 3
)
¸¸3 4
;
¸¸4 5
else
˝˝ 
if
˝˝ 
(
˝˝ 
fi
˝˝ 
!=
˝˝ 
null
˝˝ #
)
˝˝# $
func
˛˛ 
=
˛˛ 
o
˛˛ 
=>
˛˛ 
fi
˛˛  "
.
˛˛" #
GetValue
˛˛# +
(
˛˛+ ,
o
˛˛, -
)
˛˛- .
;
˛˛. /
}
ˇˇ 
return
ÄÄ 
func
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
void
ÉÉ 
CreateGetters
ÉÉ "
(
ÉÉ" #
)
ÉÉ# $
{
ÑÑ 	
var
ÖÖ 
list
ÖÖ 
=
ÖÖ 
new
ÖÖ 
List
ÖÖ 
<
ÖÖ  
Func
ÖÖ  $
<
ÖÖ$ %
T
ÖÖ% &
,
ÖÖ& '
object
ÖÖ( .
>
ÖÖ. /
>
ÖÖ/ 0
(
ÖÖ0 1
)
ÖÖ1 2
;
ÖÖ2 3
foreach
áá 
(
áá 
var
áá 

columnName
áá #
in
áá$ &
_columns
áá' /
)
áá/ 0
{
àà 
Func
ââ 
<
ââ 
T
ââ 
,
ââ 
Object
ââ 
>
ââ 
func
ââ  $
=
ââ% &
null
ââ' +
;
ââ+ ,
var
ää 
propertyName
ää  
=
ää! "
(
ää# $

columnName
ää$ .
.
ää. /
IndexOf
ää/ 6
(
ää6 7
$char
ää7 :
)
ää: ;
<
ää< =
$num
ää> ?
?
ää@ A

columnName
ääB L
:
ääM N

columnName
ääO Y
.
ääY Z
Replace
ääZ a
(
ääa b
$str
ääb e
,
ääe f
$str
ääg i
)
ääi j
)
ääj k
;
ääk l
func
ãã 
=
ãã 

FindGetter
ãã !
(
ãã! "

columnName
ãã" ,
,
ãã, -
false
ãã. 3
)
ãã3 4
??
ãã5 7

FindGetter
ãã8 B
(
ããB C

columnName
ããC M
,
ããM N
true
ããO S
)
ããS T
;
ããT U
list
çç 
.
çç 
Add
çç 
(
çç 
func
çç 
)
çç 
;
çç 
}
éé 
this
èè 
.
èè 
_getters
èè 
=
èè 
list
èè  
.
èè  !
ToArray
èè! (
(
èè( )
)
èè) *
;
èè* +
}
êê 	
private
íí 
string
íí 
ToCsv
íí 
(
íí 
T
íí 
record
íí %
)
íí% &
{
ìì 	
if
îî 
(
îî 
record
îî 
==
îî 
null
îî 
)
îî 
throw
ïï 
new
ïï 
AdsException
ïï &
(
ïï& '
$str
ïï' 7
,
ïï7 8
$str
ïï9 A
)
ïïA B
;
ïïB C
string
óó 
[
óó 
]
óó 

csvStrings
óó 
=
óó  !
new
óó" %
string
óó& ,
[
óó, -
_getters
óó- 5
.
óó5 6
Length
óó6 <
]
óó< =
;
óó= >
for
ôô 
(
ôô 
int
ôô 
i
ôô 
=
ôô 
$num
ôô 
;
ôô 
i
ôô 
<
ôô 
_getters
ôô  (
.
ôô( )
Length
ôô) /
;
ôô/ 0
i
ôô1 2
++
ôô2 4
)
ôô4 5
{
öö 
var
õõ 
getter
õõ 
=
õõ 
_getters
õõ %
[
õõ% &
i
õõ& '
]
õõ' (
;
õõ( )
object
úú 

fieldValue
úú !
=
úú" #
getter
úú$ *
==
úú+ -
null
úú. 2
?
úú3 4
null
úú5 9
:
úú: ;
getter
úú< B
(
úúB C
record
úúC I
)
úúI J
;
úúJ K

csvStrings
ùù 
[
ùù 
i
ùù 
]
ùù 
=
ùù 
this
ùù  $
.
ùù$ %
ToCsvString
ùù% 0
(
ùù0 1

fieldValue
ùù1 ;
)
ùù; <
;
ùù< =
}
ûû 
return
üü 
string
üü 
.
üü 
Join
üü 
(
üü 
this
üü #
.
üü# $%
_fieldSeparatorAsString
üü$ ;
,
üü; <

csvStrings
üü= G
)
üüG H
;
üüH I
}
°° 	
private
££ 
string
££ 
ToCsvString
££ "
(
££" #
object
££# )
o
££* +
)
££+ ,
{
§§ 	
if
•• 
(
•• 
o
•• 
!=
•• 
null
•• 
)
•• 
{
¶¶ 
string
ßß 
valueString
ßß "
=
ßß# $
o
ßß% &
as
ßß' )
string
ßß* 0
??
ßß1 3
Convert
ßß4 ;
.
ßß; <
ToString
ßß< D
(
ßßD E
o
ßßE F
,
ßßF G
CultureInfo
ßßH S
.
ßßS T
CurrentUICulture
ßßT d
)
ßßd e
;
ßße f
if
®® 
(
®® 
RequiresQuotes
®® "
(
®®" #
valueString
®®# .
)
®®. /
)
®®/ 0
{
©© 
var
™™ 
csvLine
™™ 
=
™™  !
new
™™" %
StringBuilder
™™& 3
(
™™3 4
)
™™4 5
;
™™5 6
csvLine
´´ 
.
´´ 
Append
´´ "
(
´´" #
this
´´# '
.
´´' (
_textQualifier
´´( 6
)
´´6 7
;
´´7 8
foreach
¨¨ 
(
¨¨ 
char
¨¨ !
c
¨¨" #
in
¨¨$ &
valueString
¨¨' 2
)
¨¨2 3
{
≠≠ 
if
ÆÆ 
(
ÆÆ 
c
ÆÆ 
==
ÆÆ  
this
ÆÆ! %
.
ÆÆ% &
_textQualifier
ÆÆ& 4
)
ÆÆ4 5
csvLine
ØØ #
.
ØØ# $
Append
ØØ$ *
(
ØØ* +
c
ØØ+ ,
)
ØØ, -
;
ØØ- .
csvLine
±± 
.
±±  
Append
±±  &
(
±±& '
c
±±' (
)
±±( )
;
±±) *
}
≤≤ 
csvLine
≥≥ 
.
≥≥ 
Append
≥≥ "
(
≥≥" #
this
≥≥# '
.
≥≥' (
_textQualifier
≥≥( 6
)
≥≥6 7
;
≥≥7 8
return
¥¥ 
csvLine
¥¥ "
.
¥¥" #
ToString
¥¥# +
(
¥¥+ ,
)
¥¥, -
;
¥¥- .
}
µµ 
else
∂∂ 
return
∑∑ 
valueString
∑∑ &
;
∑∑& '
}
∏∏ 
return
ππ 
string
ππ 
.
ππ 
Empty
ππ 
;
ππ  
}
∫∫ 	
private
ºº 
bool
ºº 
RequiresQuotes
ºº #
(
ºº# $
string
ºº$ *
valueString
ºº+ 6
)
ºº6 7
{
ΩΩ 	
if
ææ 
(
ææ 
CsvFile
ææ 
.
ææ 
FastIndexOfAny
ææ &
)
ææ& '
{
øø 
var
¿¿ 
len
¿¿ 
=
¿¿ 
valueString
¿¿ %
.
¿¿% &
Length
¿¿& ,
;
¿¿, -
for
¡¡ 
(
¡¡ 
int
¡¡ 
i
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
i
¡¡  !
<
¡¡" #
len
¡¡$ '
;
¡¡' (
i
¡¡) *
++
¡¡* ,
)
¡¡, -
{
¬¬ 
char
√√ 
c
√√ 
=
√√ 
valueString
√√ (
[
√√( )
i
√√) *
]
√√* +
;
√√+ ,
if
ƒƒ 
(
ƒƒ 
c
ƒƒ 
<=
ƒƒ 
$num
ƒƒ  
&&
ƒƒ! #
this
ƒƒ$ (
.
ƒƒ( )$
_isInvalidCharInFields
ƒƒ) ?
[
ƒƒ? @
c
ƒƒ@ A
]
ƒƒA B
)
ƒƒB C
return
≈≈ 
true
≈≈ #
;
≈≈# $
}
∆∆ 
return
«« 
false
«« 
;
«« 
}
»» 
else
…… 
{
   
return
ÀÀ 
valueString
ÀÀ "
.
ÀÀ" #

IndexOfAny
ÀÀ# -
(
ÀÀ- .
this
ÀÀ. 2
.
ÀÀ2 3#
_invalidCharsInFields
ÀÀ3 H
)
ÀÀH I
>=
ÀÀJ L
$num
ÀÀM N
;
ÀÀN O
}
ÃÃ 
}
ÕÕ 	
private
œœ 
void
œœ 
WriteHeader
œœ  
(
œœ  !
)
œœ! "
{
–– 	
var
—— 
csvLine
—— 
=
—— 
new
—— 
StringBuilder
—— +
(
——+ ,
)
——, -
;
——- .
for
““ 
(
““ 
int
““ 
i
““ 
=
““ 
$num
““ 
;
““ 
i
““ 
<
““ 
this
““  $
.
““$ %
_columns
““% -
.
““- .
Length
““. 4
;
““4 5
i
““6 7
++
““7 9
)
““9 :
{
”” 
if
‘‘ 
(
‘‘ 
i
‘‘ 
>
‘‘ 
$num
‘‘ 
)
‘‘ 
csvLine
’’ 
.
’’ 
Append
’’ "
(
’’" #
this
’’# '
.
’’' (
_fieldSeparator
’’( 7
)
’’7 8
;
’’8 9
csvLine
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
this
÷÷ #
.
÷÷# $
ToCsvString
÷÷$ /
(
÷÷/ 0
this
÷÷0 4
.
÷÷4 5
_columns
÷÷5 =
[
÷÷= >
i
÷÷> ?
]
÷÷? @
)
÷÷@ A
)
÷÷A B
;
÷÷B C
}
◊◊ 
this
ÿÿ 
.
ÿÿ 
_streamWriter
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ (
(
ÿÿ( )
csvLine
ÿÿ) 0
.
ÿÿ0 1
ToString
ÿÿ1 9
(
ÿÿ9 :
)
ÿÿ: ;
)
ÿÿ; <
;
ÿÿ< =
}
ŸŸ 	
}
⁄⁄ 
internal
‹‹ 
class
‹‹ 
CsvFileReader
‹‹  
<
‹‹  !
T
‹‹! "
>
‹‹" #
:
‹‹$ %
CsvFile
‹‹& -
,
‹‹- .
IEnumerable
‹‹/ :
<
‹‹: ;
T
‹‹; <
>
‹‹< =
,
‹‹= >
IEnumerator
‹‹? J
<
‹‹J K
T
‹‹K L
>
‹‹L M
where
›› 

T
›› 
:
›› 
new
›› 
(
›› 
)
›› 
{
ﬁﬁ 
private
ﬂﬂ 
readonly
ﬂﬂ 

Dictionary
ﬂﬂ #
<
ﬂﬂ# $
Type
ﬂﬂ$ (
,
ﬂﬂ( )
List
ﬂﬂ* .
<
ﬂﬂ. /
Action
ﬂﬂ/ 5
<
ﬂﬂ5 6
T
ﬂﬂ6 7
,
ﬂﬂ7 8
String
ﬂﬂ9 ?
>
ﬂﬂ? @
>
ﬂﬂ@ A
>
ﬂﬂA B
_allSetters
ﬂﬂC N
=
ﬂﬂO P
new
ﬂﬂQ T

Dictionary
ﬂﬂU _
<
ﬂﬂ_ `
Type
ﬂﬂ` d
,
ﬂﬂd e
List
ﬂﬂf j
<
ﬂﬂj k
Action
ﬂﬂk q
<
ﬂﬂq r
T
ﬂﬂr s
,
ﬂﬂs t
String
ﬂﬂu {
>
ﬂﬂ{ |
>
ﬂﬂ| }
>
ﬂﬂ} ~
(
ﬂﬂ~ 
)ﬂﬂ Ä
;ﬂﬂÄ Å
private
‡‡ 
string
‡‡ 
[
‡‡ 
]
‡‡ 
_columns
‡‡ !
;
‡‡! "
private
·· 
char
·· 
_curChar
·· 
;
·· 
private
‚‚ 
int
‚‚ 
_len
‚‚ 
;
‚‚ 
private
„„ 
string
„„ 
_line
„„ 
;
„„ 
private
‰‰ 
int
‰‰ 
_pos
‰‰ 
;
‰‰ 
private
ÂÂ 
T
ÂÂ 
_record
ÂÂ 
;
ÂÂ 
private
ÊÊ 
readonly
ÊÊ 
char
ÊÊ 
_fieldSeparator
ÊÊ -
;
ÊÊ- .
private
ÁÁ 
readonly
ÁÁ 

TextReader
ÁÁ #
_textReader
ÁÁ$ /
;
ÁÁ/ 0
private
ËË 
readonly
ËË 
char
ËË 
_textQualifier
ËË ,
;
ËË, -
private
ÈÈ 
readonly
ÈÈ 
StringBuilder
ÈÈ &
_parseFieldResult
ÈÈ' 8
=
ÈÈ9 :
new
ÈÈ; >
StringBuilder
ÈÈ? L
(
ÈÈL M
)
ÈÈM N
;
ÈÈN O
public
ÎÎ 
CsvFileReader
ÎÎ 
(
ÎÎ 
	CsvSource
ÎÎ &
	csvSource
ÎÎ' 0
)
ÎÎ0 1
:
ÏÏ 
this
ÏÏ 
(
ÏÏ 
	csvSource
ÏÏ 
,
ÏÏ 
null
ÏÏ "
)
ÏÏ" #
{
ÌÌ 	
}
ÓÓ 	
public
 
CsvFileReader
 
(
 
	CsvSource
 &
	csvSource
' 0
,
0 1
CsvDefinition
2 ?
csvDefinition
@ M
)
M N
{
ÒÒ 	
var
ÚÚ 
streamReader
ÚÚ 
=
ÚÚ 
	csvSource
ÚÚ (
.
ÚÚ( )

TextReader
ÚÚ) 3
as
ÚÚ4 6
StreamReader
ÚÚ7 C
;
ÚÚC D
if
ÛÛ 
(
ÛÛ 
streamReader
ÛÛ 
!=
ÛÛ 
null
ÛÛ  $
)
ÛÛ$ %
this
ÙÙ 
.
ÙÙ 

BaseStream
ÙÙ 
=
ÙÙ  !
streamReader
ÙÙ" .
.
ÙÙ. /

BaseStream
ÙÙ/ 9
;
ÙÙ9 :
if
ıı 
(
ıı 
csvDefinition
ıı 
==
ıı  
null
ıı! %
)
ıı% &
csvDefinition
ˆˆ 
=
ˆˆ "
DefaultCsvDefinition
ˆˆ  4
;
ˆˆ4 5
this
˜˜ 
.
˜˜ 
_fieldSeparator
˜˜  
=
˜˜! "
csvDefinition
˜˜# 0
.
˜˜0 1
FieldSeparator
˜˜1 ?
;
˜˜? @
this
¯¯ 
.
¯¯ 
_textQualifier
¯¯ 
=
¯¯  !
csvDefinition
¯¯" /
.
¯¯/ 0
TextQualifier
¯¯0 =
;
¯¯= >
this
˙˙ 
.
˙˙ 
_textReader
˙˙ 
=
˙˙ 
	csvSource
˙˙ (
.
˙˙( )

TextReader
˙˙) 3
;
˙˙3 4
this
˝˝ 
.
˝˝ 

ReadHeader
˝˝ 
(
˝˝ 
csvDefinition
˝˝ )
.
˝˝) *
Header
˝˝* 0
)
˝˝0 1
;
˝˝1 2
}
ˇˇ 	
public
ÅÅ 
T
ÅÅ 
Current
ÅÅ 
{
ÇÇ 	
get
ÉÉ 
{
ÉÉ 
return
ÉÉ 
this
ÉÉ 
.
ÉÉ 
_record
ÉÉ %
;
ÉÉ% &
}
ÉÉ' (
}
ÑÑ 	
public
ÜÜ 
bool
ÜÜ 
Eof
ÜÜ 
{
áá 	
get
àà 
{
àà 
return
àà 
this
àà 
.
àà 
_line
àà #
==
àà$ &
null
àà' +
;
àà+ ,
}
àà- .
}
ââ 	
object
ãã 
IEnumerator
ãã 
.
ãã 
Current
ãã "
{
åå 	
get
çç 
{
çç 
return
çç 
this
çç 
.
çç 
Current
çç %
;
çç% &
}
çç' (
}
éé 	
	protected
êê 
override
êê 
void
êê 
Dispose
êê  '
(
êê' (
bool
êê( ,
	disposing
êê- 6
)
êê6 7
{
ëë 	
if
íí 
(
íí 
	disposing
íí 
)
íí 
{
ìì 
this
ññ 
.
ññ 
_textReader
ññ  
.
ññ  !
Dispose
ññ! (
(
ññ( )
)
ññ) *
;
ññ* +
}
óó 
}
òò 	
IEnumerator
öö 
IEnumerable
öö 
.
öö  
GetEnumerator
öö  -
(
öö- .
)
öö. /
{
õõ 	
return
úú 
this
úú 
.
úú 
GetEnumerator
úú %
(
úú% &
)
úú& '
;
úú' (
}
ùù 	
public
üü 
IEnumerator
üü 
<
üü 
T
üü 
>
üü 
GetEnumerator
üü +
(
üü+ ,
)
üü, -
{
†† 	
return
°° 
this
°° 
;
°° 
}
¢¢ 	
public
§§ 
bool
§§ 
MoveNext
§§ 
(
§§ 
)
§§ 
{
•• 	
this
¶¶ 
.
¶¶ 
ReadNextLine
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶  
if
ßß 
(
ßß 
this
ßß 
.
ßß 
_line
ßß 
==
ßß 
null
ßß "
&&
ßß# %
(
ßß& '
this
ßß' +
.
ßß+ ,
_line
ßß, 1
=
ßß2 3
this
ßß4 8
.
ßß8 9
_textReader
ßß9 D
.
ßßD E
ReadLine
ßßE M
(
ßßM N
)
ßßN O
)
ßßO P
==
ßßQ S
null
ßßT X
)
ßßX Y
{
®® 
this
©© 
.
©© 
_record
©© 
=
©© 
default
©© &
(
©©& '
T
©©' (
)
©©( )
;
©©) *
}
™™ 
else
´´ 
{
¨¨ 
this
≠≠ 
.
≠≠ 
_record
≠≠ 
=
≠≠ 
new
≠≠ "
T
≠≠# $
(
≠≠$ %
)
≠≠% &
;
≠≠& '
Type
ÆÆ 

recordType
ÆÆ 
=
ÆÆ  !
typeof
ÆÆ" (
(
ÆÆ( )
T
ÆÆ) *
)
ÆÆ* +
;
ÆÆ+ ,
List
ØØ 
<
ØØ 
Action
ØØ 
<
ØØ 
T
ØØ 
,
ØØ 
String
ØØ %
>
ØØ% &
>
ØØ& '
setters
ØØ( /
;
ØØ/ 0
if
∞∞ 
(
∞∞ 
!
∞∞ 
this
∞∞ 
.
∞∞ 
_allSetters
∞∞ %
.
∞∞% &
TryGetValue
∞∞& 1
(
∞∞1 2

recordType
∞∞2 <
,
∞∞< =
out
∞∞> A
setters
∞∞B I
)
∞∞I J
)
∞∞J K
{
±± 
setters
≤≤ 
=
≤≤ 
this
≤≤ "
.
≤≤" #
CreateSetters
≤≤# 0
(
≤≤0 1
)
≤≤1 2
;
≤≤2 3
this
≥≥ 
.
≥≥ 
_allSetters
≥≥ $
[
≥≥$ %

recordType
≥≥% /
]
≥≥/ 0
=
≥≥1 2
setters
≥≥3 :
;
≥≥: ;
}
¥¥ 
var
∂∂ 
fieldValues
∂∂ 
=
∂∂  !
new
∂∂" %
string
∂∂& ,
[
∂∂, -
setters
∂∂- 4
.
∂∂4 5
Count
∂∂5 :
]
∂∂: ;
;
∂∂; <
for
∑∑ 
(
∑∑ 
int
∑∑ 
i
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
i
∑∑  !
<
∑∑" #
setters
∑∑$ +
.
∑∑+ ,
Count
∑∑, 1
;
∑∑1 2
i
∑∑3 4
++
∑∑4 6
)
∑∑6 7
{
∏∏ 
fieldValues
ππ 
[
ππ  
i
ππ  !
]
ππ! "
=
ππ# $
this
ππ% )
.
ππ) *

ParseField
ππ* 4
(
ππ4 5
)
ππ5 6
;
ππ6 7
if
∫∫ 
(
∫∫ 
this
∫∫ 
.
∫∫ 
_curChar
∫∫ %
==
∫∫& (
this
∫∫) -
.
∫∫- .
_fieldSeparator
∫∫. =
)
∫∫= >
this
ªª 
.
ªª 
NextChar
ªª %
(
ªª% &
)
ªª& '
;
ªª' (
else
ºº 
break
ΩΩ 
;
ΩΩ 
}
ææ 
for
øø 
(
øø 
int
øø 
i
øø 
=
øø 
$num
øø 
;
øø 
i
øø  !
<
øø" #
setters
øø$ +
.
øø+ ,
Count
øø, 1
;
øø1 2
i
øø3 4
++
øø4 6
)
øø6 7
{
¿¿ 
var
¡¡ 
setter
¡¡ 
=
¡¡  
setters
¡¡! (
[
¡¡( )
i
¡¡) *
]
¡¡* +
;
¡¡+ ,
if
¬¬ 
(
¬¬ 
setter
¬¬ 
!=
¬¬ !
null
¬¬" &
)
¬¬& '
{
√√ 
setter
ƒƒ 
(
ƒƒ 
this
ƒƒ #
.
ƒƒ# $
_record
ƒƒ$ +
,
ƒƒ+ ,
fieldValues
ƒƒ- 8
[
ƒƒ8 9
i
ƒƒ9 :
]
ƒƒ: ;
)
ƒƒ; <
;
ƒƒ< =
}
≈≈ 
}
∆∆ 
}
«« 
return
»» 
(
»» 
this
»» 
.
»» 
_record
»»  
!=
»»! #
null
»»$ (
)
»»( )
;
»») *
}
…… 	
public
ÃÃ 
void
ÃÃ 
Reset
ÃÃ 
(
ÃÃ 
)
ÃÃ 
{
ÕÕ 	
throw
ŒŒ 
new
ŒŒ %
NotImplementedException
ŒŒ -
(
ŒŒ- .
$str
ŒŒ. W
)
ŒŒW X
;
ŒŒX Y
}
œœ 	
private
—— 
static
—— 
Action
—— 
<
—— 
T
—— 
,
——  
string
——! '
>
——' ( 
EmitSetValueAction
——) ;
(
——; <

MemberInfo
——< F
mi
——G I
,
——I J
Func
——K O
<
——O P
string
——P V
,
——V W
object
——X ^
>
——^ _
func
——` d
)
——d e
{
““ 	!
ParameterExpression
”” 
paramExpObj
””  +
=
””, -

Expression
””. 8
.
””8 9
	Parameter
””9 B
(
””B C
typeof
””C I
(
””I J
object
””J P
)
””P Q
,
””Q R
$str
””S X
)
””X Y
;
””Y Z!
ParameterExpression
‘‘ 
	paramExpT
‘‘  )
=
‘‘* +

Expression
‘‘, 6
.
‘‘6 7
	Parameter
‘‘7 @
(
‘‘@ A
typeof
‘‘A G
(
‘‘G H
T
‘‘H I
)
‘‘I J
,
‘‘J K
$str
‘‘L V
)
‘‘V W
;
‘‘W X
{
÷÷ 
var
◊◊ 
pi
◊◊ 
=
◊◊ 
mi
◊◊ 
as
◊◊ 
PropertyInfo
◊◊ +
;
◊◊+ ,
if
ÿÿ 
(
ÿÿ 
pi
ÿÿ 
!=
ÿÿ 
null
ÿÿ 
)
ÿÿ 
{
ŸŸ 
if
€€ 
(
€€ 
CsvFile
€€ 
.
€€  

UseLambdas
€€  *
)
€€* +
{
‹‹ 
var
›› 
callExpr
›› $
=
››% &

Expression
››' 1
.
››1 2
Call
››2 6
(
››6 7
	paramExpT
ﬁﬁ %
,
ﬁﬁ% &
pi
ﬂﬂ 
.
ﬂﬂ 
GetSetMethod
ﬂﬂ +
(
ﬂﬂ+ ,
)
ﬂﬂ, -
,
ﬂﬂ- .

Expression
‡‡ &
.
‡‡& '
ConvertChecked
‡‡' 5
(
‡‡5 6
paramExpObj
‡‡6 A
,
‡‡A B
pi
‡‡C E
.
‡‡E F
PropertyType
‡‡F R
)
‡‡R S
)
‡‡S T
;
‡‡T U
var
·· 
setter
·· "
=
··# $

Expression
··% /
.
··/ 0
Lambda
··0 6
<
··6 7
Action
··7 =
<
··= >
T
··> ?
,
··? @
object
··A G
>
··G H
>
··H I
(
··I J
callExpr
‚‚ $
,
‚‚$ %
	paramExpT
„„ %
,
„„% &
paramExpObj
‰‰ '
)
‰‰' (
.
‰‰( )
Compile
‰‰) 0
(
‰‰0 1
)
‰‰1 2
;
‰‰2 3
return
ÂÂ 
(
ÂÂ  
o
ÂÂ  !
,
ÂÂ! "
s
ÂÂ# $
)
ÂÂ$ %
=>
ÂÂ& (
setter
ÂÂ) /
(
ÂÂ/ 0
o
ÂÂ0 1
,
ÂÂ1 2
func
ÂÂ3 7
(
ÂÂ7 8
s
ÂÂ8 9
)
ÂÂ9 :
)
ÂÂ: ;
;
ÂÂ; <
}
ÊÊ 
return
ËË 
(
ËË 
o
ËË 
,
ËË 
v
ËË  
)
ËË  !
=>
ËË" $
pi
ËË% '
.
ËË' (
SetValue
ËË( 0
(
ËË0 1
o
ËË1 2
,
ËË2 3
(
ËË4 5
object
ËË5 ;
)
ËË; <
func
ËË< @
(
ËË@ A
v
ËËA B
)
ËËB C
,
ËËC D
null
ËËE I
)
ËËI J
;
ËËJ K
}
ÍÍ 
}
ÎÎ 
{
ÏÏ 
var
ÌÌ 
fi
ÌÌ 
=
ÌÌ 
mi
ÌÌ 
as
ÌÌ 
	FieldInfo
ÌÌ (
;
ÌÌ( )
if
ÓÓ 
(
ÓÓ 
fi
ÓÓ 
!=
ÓÓ 
null
ÓÓ 
)
ÓÓ 
{
ÔÔ 
if
ÒÒ 
(
ÒÒ 
CsvFile
ÒÒ 
.
ÒÒ  

UseLambdas
ÒÒ  *
)
ÒÒ* +
{
ÚÚ 
var
ıı 
valueExp
ıı $
=
ıı% &

Expression
ıı' 1
.
ıı1 2
ConvertChecked
ıı2 @
(
ıı@ A
paramExpObj
ııA L
,
ııL M
fi
ııN P
.
ııP Q
	FieldType
ııQ Z
)
ııZ [
;
ıı[ \
MemberExpression
˘˘ (
fieldExp
˘˘) 1
=
˘˘2 3

Expression
˘˘4 >
.
˘˘> ?
Field
˘˘? D
(
˘˘D E
	paramExpT
˘˘E N
,
˘˘N O
fi
˘˘P R
)
˘˘R S
;
˘˘S T
BinaryExpression
˙˙ (
	assignExp
˙˙) 2
=
˙˙3 4

Expression
˙˙5 ?
.
˙˙? @
Assign
˙˙@ F
(
˙˙F G
fieldExp
˙˙G O
,
˙˙O P
valueExp
˙˙Q Y
)
˙˙Y Z
;
˙˙Z [
var
¸¸ 
setter
¸¸ "
=
¸¸# $

Expression
¸¸% /
.
¸¸/ 0
Lambda
¸¸0 6
<
¸¸6 7
Action
¸¸7 =
<
¸¸= >
T
¸¸> ?
,
¸¸? @
object
¸¸A G
>
¸¸G H
>
¸¸H I
(
˝˝ 
	assignExp
˝˝ &
,
˝˝& '
	paramExpT
˝˝( 1
,
˝˝1 2
paramExpObj
˝˝3 >
)
˝˝> ?
.
˝˝? @
Compile
˝˝@ G
(
˝˝G H
)
˝˝H I
;
˝˝I J
return
ˇˇ 
(
ˇˇ  
o
ˇˇ  !
,
ˇˇ! "
s
ˇˇ# $
)
ˇˇ$ %
=>
ˇˇ& (
setter
ˇˇ) /
(
ˇˇ/ 0
o
ˇˇ0 1
,
ˇˇ1 2
func
ˇˇ3 7
(
ˇˇ7 8
s
ˇˇ8 9
)
ˇˇ9 :
)
ˇˇ: ;
;
ˇˇ; <
}
ÄÄ 
return
ÇÇ 
(
ÇÇ 
(
ÇÇ 
o
ÇÇ 
,
ÇÇ 
v
ÇÇ  !
)
ÇÇ! "
=>
ÇÇ# %
fi
ÇÇ& (
.
ÇÇ( )
SetValue
ÇÇ) 1
(
ÇÇ1 2
o
ÇÇ2 3
,
ÇÇ3 4
func
ÇÇ5 9
(
ÇÇ9 :
v
ÇÇ: ;
)
ÇÇ; <
)
ÇÇ< =
)
ÇÇ= >
;
ÇÇ> ?
}
ÉÉ 
}
ÑÑ 
throw
ÖÖ 
new
ÖÖ %
NotImplementedException
ÖÖ -
(
ÖÖ- .
)
ÖÖ. /
;
ÖÖ/ 0
}
ÜÜ 	
private
àà 
static
àà 
Action
àà 
<
àà 
T
àà 
,
àà  
string
àà! '
>
àà' (

FindSetter
àà) 3
(
àà3 4
string
àà4 :
c
àà; <
,
àà< =
bool
àà> B
staticMember
ààC O
)
ààO P
{
ââ 	
var
ää 
flags
ää 
=
ää 
BindingFlags
ää $
.
ää$ %
Public
ää% +
|
ää, -
BindingFlags
ää. :
.
ää: ;
	NonPublic
ää; D
|
ääE F
BindingFlags
ääG S
.
ääS T

IgnoreCase
ääT ^
|
ää_ `
(
ääa b
staticMember
ääb n
?
ääo p
BindingFlags
ääq }
.
ää} ~
Staticää~ Ñ
:ääÖ Ü
BindingFlagsääá ì
.ääì î
Instanceääî ú
)ääú ù
;ääù û
Action
ãã 
<
ãã 
T
ãã 
,
ãã 
string
ãã 
>
ãã 
action
ãã $
=
ãã% &
null
ãã' +
;
ãã+ ,
PropertyInfo
åå 
pi
åå 
=
åå 
typeof
åå $
(
åå$ %
T
åå% &
)
åå& '
.
åå' (
GetProperty
åå( 3
(
åå3 4
c
åå4 5
,
åå5 6
flags
åå7 <
)
åå< =
;
åå= >
if
çç 
(
çç 
pi
çç 
!=
çç 
null
çç 
)
çç 
{
éé 
var
èè 
pFunc
èè 
=
èè 
StringToObject
èè *
(
èè* +
pi
èè+ -
.
èè- .
PropertyType
èè. :
)
èè: ;
;
èè; <
action
êê 
=
êê  
EmitSetValueAction
êê +
(
êê+ ,
pi
êê, .
,
êê. /
pFunc
êê0 5
)
êê5 6
;
êê6 7
}
ëë 
	FieldInfo
íí 
fi
íí 
=
íí 
typeof
íí !
(
íí! "
T
íí" #
)
íí# $
.
íí$ %
GetField
íí% -
(
íí- .
c
íí. /
,
íí/ 0
flags
íí1 6
)
íí6 7
;
íí7 8
if
ìì 
(
ìì 
fi
ìì 
!=
ìì 
null
ìì 
)
ìì 
{
îî 
var
ïï 
fFunc
ïï 
=
ïï 
StringToObject
ïï *
(
ïï* +
fi
ïï+ -
.
ïï- .
	FieldType
ïï. 7
)
ïï7 8
;
ïï8 9
action
ññ 
=
ññ  
EmitSetValueAction
ññ +
(
ññ+ ,
fi
ññ, .
,
ññ. /
fFunc
ññ0 5
)
ññ5 6
;
ññ6 7
}
óó 
return
òò 
action
òò 
;
òò 
}
ôô 	
private
õõ 
static
õõ 
Func
õõ 
<
õõ 
string
õõ "
,
õõ" #
object
õõ$ *
>
õõ* +
StringToObject
õõ, :
(
õõ: ;
Type
õõ; ?
propertyType
õõ@ L
)
õõL M
{
úú 	
if
ùù 
(
ùù 
propertyType
ùù 
==
ùù 
typeof
ùù  &
(
ùù& '
string
ùù' -
)
ùù- .
)
ùù. /
return
ûû 
(
ûû 
s
ûû 
)
ûû 
=>
ûû 
s
ûû 
??
ûû  "
String
ûû# )
.
ûû) *
Empty
ûû* /
;
ûû/ 0
else
üü 
if
üü 
(
üü 
propertyType
üü !
==
üü" $
typeof
üü% +
(
üü+ ,
Int32
üü, 1
)
üü1 2
)
üü2 3
return
†† 
(
†† 
s
†† 
)
†† 
=>
†† 
String
†† $
.
††$ %
IsNullOrEmpty
††% 2
(
††2 3
s
††3 4
)
††4 5
?
††6 7
$num
††8 9
:
††: ;
Int32
††< A
.
††A B
Parse
††B G
(
††G H
s
††H I
)
††I J
;
††J K
if
°° 
(
°° 
propertyType
°° 
==
°° 
typeof
°°  &
(
°°& '
DateTime
°°' /
)
°°/ 0
)
°°0 1
return
¢¢ 
(
¢¢ 
s
¢¢ 
)
¢¢ 
=>
¢¢ 
String
¢¢ $
.
¢¢$ %
IsNullOrEmpty
¢¢% 2
(
¢¢2 3
s
¢¢3 4
)
¢¢4 5
?
¢¢6 7
DateTimeZero
¢¢8 D
:
¢¢E F
DateTime
¢¢G O
.
¢¢O P
Parse
¢¢P U
(
¢¢U V
s
¢¢V W
)
¢¢W X
;
¢¢X Y
else
££ 
throw
§§ 
new
§§ %
NotImplementedException
§§ 1
(
§§1 2
)
§§2 3
;
§§3 4
}
•• 	
private
ßß 
List
ßß 
<
ßß 
Action
ßß 
<
ßß 
T
ßß 
,
ßß 
string
ßß %
>
ßß% &
>
ßß& '
CreateSetters
ßß( 5
(
ßß5 6
)
ßß6 7
{
®® 	
var
©© 
list
©© 
=
©© 
new
©© 
List
©© 
<
©©  
Action
©©  &
<
©©& '
T
©©' (
,
©©( )
string
©©* 0
>
©©0 1
>
©©1 2
(
©©2 3
)
©©3 4
;
©©4 5
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
$num
™™ 
;
™™ 
i
™™ 
<
™™ 
this
™™  $
.
™™$ %
_columns
™™% -
.
™™- .
Length
™™. 4
;
™™4 5
i
™™6 7
++
™™7 9
)
™™9 :
{
´´ 
string
¨¨ 

columnName
¨¨ !
=
¨¨" #
this
¨¨$ (
.
¨¨( )
_columns
¨¨) 1
[
¨¨1 2
i
¨¨2 3
]
¨¨3 4
;
¨¨4 5
Action
≠≠ 
<
≠≠ 
T
≠≠ 
,
≠≠ 
string
≠≠  
>
≠≠  !
action
≠≠" (
=
≠≠) *
null
≠≠+ /
;
≠≠/ 0
if
ÆÆ 
(
ÆÆ 

columnName
ÆÆ 
.
ÆÆ 
IndexOf
ÆÆ &
(
ÆÆ& '
$char
ÆÆ' *
)
ÆÆ* +
>=
ÆÆ, .
$num
ÆÆ/ 0
)
ÆÆ0 1

columnName
ØØ 
=
ØØ  

columnName
ØØ! +
.
ØØ+ ,
Replace
ØØ, 3
(
ØØ3 4
$str
ØØ4 7
,
ØØ7 8
$str
ØØ9 ;
)
ØØ; <
;
ØØ< =
action
∞∞ 
=
∞∞ 

FindSetter
∞∞ #
(
∞∞# $

columnName
∞∞$ .
,
∞∞. /
false
∞∞0 5
)
∞∞5 6
??
∞∞7 9

FindSetter
∞∞: D
(
∞∞D E

columnName
∞∞E O
,
∞∞O P
true
∞∞Q U
)
∞∞U V
;
∞∞V W
list
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
action
≤≤ 
)
≤≤  
;
≤≤  !
}
≥≥ 
return
¥¥ 
list
¥¥ 
;
¥¥ 
}
µµ 	
private
∑∑ 
void
∑∑ 
NextChar
∑∑ 
(
∑∑ 
)
∑∑ 
{
∏∏ 	
if
ππ 
(
ππ 
this
ππ 
.
ππ 
_pos
ππ 
<
ππ 
this
ππ  
.
ππ  !
_len
ππ! %
)
ππ% &
{
∫∫ 
this
ªª 
.
ªª 
_pos
ªª 
++
ªª 
;
ªª 
this
ºº 
.
ºº 
_curChar
ºº 
=
ºº 
this
ºº  $
.
ºº$ %
_pos
ºº% )
<
ºº* +
this
ºº, 0
.
ºº0 1
_len
ºº1 5
?
ºº6 7
this
ºº8 <
.
ºº< =
_line
ºº= B
[
ººB C
this
ººC G
.
ººG H
_pos
ººH L
]
ººL M
:
ººN O
$char
ººP T
;
ººT U
}
ΩΩ 
}
ææ 	
private
¿¿ 
void
¿¿ 
ParseEndOfLine
¿¿ #
(
¿¿# $
)
¿¿$ %
{
¡¡ 	
throw
¬¬ 
new
¬¬ %
NotImplementedException
¬¬ -
(
¬¬- .
)
¬¬. /
;
¬¬/ 0
}
√√ 	
private
∆∆ 
string
∆∆ 

ParseField
∆∆ !
(
∆∆! "
)
∆∆" #
{
«« 	
_parseFieldResult
»» 
.
»» 
Length
»» $
=
»»% &
$num
»»' (
;
»»( )
if
…… 
(
…… 
this
…… 
.
…… 
_line
…… 
==
…… 
null
…… "
||
……# %
this
……& *
.
……* +
_pos
……+ /
>=
……0 2
this
……3 7
.
……7 8
_len
……8 <
)
……< =
return
   
null
   
;
   
while
ÀÀ 
(
ÀÀ 
this
ÀÀ 
.
ÀÀ 
_curChar
ÀÀ  
==
ÀÀ! #
$char
ÀÀ$ '
||
ÀÀ( *
this
ÀÀ+ /
.
ÀÀ/ 0
_curChar
ÀÀ0 8
==
ÀÀ9 ;
$char
ÀÀ< @
)
ÀÀ@ A
{
ÃÃ 
this
ÕÕ 
.
ÕÕ 
NextChar
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ  
}
ŒŒ 
if
œœ 
(
œœ 
this
œœ 
.
œœ 
_curChar
œœ 
==
œœ  
this
œœ! %
.
œœ% &
_textQualifier
œœ& 4
)
œœ4 5
{
–– 
this
—— 
.
—— 
NextChar
—— 
(
—— 
)
—— 
;
——  
while
““ 
(
““ 
this
““ 
.
““ 
_curChar
““ $
!=
““% '
$num
““( )
)
““) *
{
”” 
if
‘‘ 
(
‘‘ 
this
‘‘ 
.
‘‘ 
_curChar
‘‘ %
==
‘‘& (
this
‘‘) -
.
‘‘- .
_textQualifier
‘‘. <
)
‘‘< =
{
’’ 
this
÷÷ 
.
÷÷ 
NextChar
÷÷ %
(
÷÷% &
)
÷÷& '
;
÷÷' (
if
◊◊ 
(
◊◊ 
this
◊◊  
.
◊◊  !
_curChar
◊◊! )
==
◊◊* ,
this
◊◊- 1
.
◊◊1 2
_textQualifier
◊◊2 @
)
◊◊@ A
{
ÿÿ 
this
ŸŸ  
.
ŸŸ  !
NextChar
ŸŸ! )
(
ŸŸ) *
)
ŸŸ* +
;
ŸŸ+ ,
_parseFieldResult
⁄⁄ -
.
⁄⁄- .
Append
⁄⁄. 4
(
⁄⁄4 5
this
⁄⁄5 9
.
⁄⁄9 :
_textQualifier
⁄⁄: H
)
⁄⁄H I
;
⁄⁄I J
}
€€ 
else
‹‹ 
return
›› "
_parseFieldResult
››# 4
.
››4 5
ToString
››5 =
(
››= >
)
››> ?
;
››? @
}
ﬁﬁ 
else
ﬂﬂ 
if
ﬂﬂ 
(
ﬂﬂ 
this
ﬂﬂ !
.
ﬂﬂ! "
_curChar
ﬂﬂ" *
==
ﬂﬂ+ -
$char
ﬂﬂ. 2
)
ﬂﬂ2 3
{
‡‡ 
if
·· 
(
·· 
this
··  
.
··  !
_line
··! &
==
··' )
null
··* .
)
··. /
return
‚‚ "
_parseFieldResult
‚‚# 4
.
‚‚4 5
ToString
‚‚5 =
(
‚‚= >
)
‚‚> ?
;
‚‚? @
this
„„ 
.
„„ 
ReadNextLine
„„ )
(
„„) *
)
„„* +
;
„„+ ,
}
‰‰ 
else
ÂÂ 
{
ÊÊ 
_parseFieldResult
ÁÁ )
.
ÁÁ) *
Append
ÁÁ* 0
(
ÁÁ0 1
this
ÁÁ1 5
.
ÁÁ5 6
_curChar
ÁÁ6 >
)
ÁÁ> ?
;
ÁÁ? @
this
ËË 
.
ËË 
NextChar
ËË %
(
ËË% &
)
ËË& '
;
ËË' (
}
ÈÈ 
}
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
while
ÓÓ 
(
ÓÓ 
this
ÓÓ 
.
ÓÓ 
_curChar
ÓÓ $
!=
ÓÓ% '
$num
ÓÓ( )
&&
ÓÓ* ,
this
ÓÓ- 1
.
ÓÓ1 2
_curChar
ÓÓ2 :
!=
ÓÓ; =
this
ÓÓ> B
.
ÓÓB C
_fieldSeparator
ÓÓC R
&&
ÓÓS U
this
ÓÓV Z
.
ÓÓZ [
_curChar
ÓÓ[ c
!=
ÓÓd f
$char
ÓÓg k
&&
ÓÓl n
this
ÓÓo s
.
ÓÓs t
_curChar
ÓÓt |
!=
ÓÓ} 
$charÓÓÄ Ñ
)ÓÓÑ Ö
{
ÔÔ 
_parseFieldResult
 %
.
% &
Append
& ,
(
, -
this
- 1
.
1 2
_curChar
2 :
)
: ;
;
; <
this
ÒÒ 
.
ÒÒ 
NextChar
ÒÒ !
(
ÒÒ! "
)
ÒÒ" #
;
ÒÒ# $
}
ÚÚ 
}
ÛÛ 
return
ÙÙ 
_parseFieldResult
ÙÙ $
.
ÙÙ$ %
ToString
ÙÙ% -
(
ÙÙ- .
)
ÙÙ. /
;
ÙÙ/ 0
}
ıı 	
private
˜˜ 
void
˜˜ 

ReadHeader
˜˜ 
(
˜˜  
string
˜˜  &
header
˜˜' -
)
˜˜- .
{
¯¯ 	
if
˘˘ 
(
˘˘ 
header
˘˘ 
==
˘˘ 
null
˘˘ 
)
˘˘ 
{
˙˙ 
this
˚˚ 
.
˚˚ 
ReadNextLine
˚˚ !
(
˚˚! "
)
˚˚" #
;
˚˚# $
}
¸¸ 
else
˝˝ 
{
˛˛ 
this
ÅÅ 
.
ÅÅ 
_line
ÅÅ 
=
ÅÅ 
header
ÅÅ #
;
ÅÅ# $
this
ÇÇ 
.
ÇÇ 
_pos
ÇÇ 
=
ÇÇ 
-
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
this
ÉÉ 
.
ÉÉ 
_len
ÉÉ 
=
ÉÉ 
this
ÉÉ  
.
ÉÉ  !
_line
ÉÉ! &
.
ÉÉ& '
Length
ÉÉ' -
;
ÉÉ- .
this
ÑÑ 
.
ÑÑ 
NextChar
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ  
}
ÖÖ 
var
áá 
readColumns
áá 
=
áá 
new
áá !
List
áá" &
<
áá& '
string
áá' -
>
áá- .
(
áá. /
)
áá/ 0
;
áá0 1
string
àà 

columnName
àà 
;
àà 
while
ââ 
(
ââ 
(
ââ 

columnName
ââ 
=
ââ  
this
ââ! %
.
ââ% &

ParseField
ââ& 0
(
ââ0 1
)
ââ1 2
)
ââ2 3
!=
ââ4 6
null
ââ7 ;
)
ââ; <
{
ää 
readColumns
ãã 
.
ãã 
Add
ãã 
(
ãã  

columnName
ãã  *
)
ãã* +
;
ãã+ ,
if
åå 
(
åå 
this
åå 
.
åå 
_curChar
åå !
==
åå" $
this
åå% )
.
åå) *
_fieldSeparator
åå* 9
)
åå9 :
this
çç 
.
çç 
NextChar
çç !
(
çç! "
)
çç" #
;
çç# $
else
éé 
break
èè 
;
èè 
}
êê 
this
ëë 
.
ëë 
_columns
ëë 
=
ëë 
readColumns
ëë '
.
ëë' (
ToArray
ëë( /
(
ëë/ 0
)
ëë0 1
;
ëë1 2
}
íí 	
private
îî 
void
îî 
ReadNextLine
îî !
(
îî! "
)
îî" #
{
ïï 	
this
ññ 
.
ññ 
_line
ññ 
=
ññ 
this
ññ 
.
ññ 
_textReader
ññ )
.
ññ) *
ReadLine
ññ* 2
(
ññ2 3
)
ññ3 4
;
ññ4 5
this
óó 
.
óó 
_pos
óó 
=
óó 
-
óó 
$num
óó 
;
óó 
if
òò 
(
òò 
this
òò 
.
òò 
_line
òò 
==
òò 
null
òò "
)
òò" #
{
ôô 
this
öö 
.
öö 
_len
öö 
=
öö 
$num
öö 
;
öö 
this
õõ 
.
õõ 
_curChar
õõ 
=
õõ 
$char
õõ  $
;
õõ$ %
}
úú 
else
ùù 
{
ûû 
this
üü 
.
üü 
_len
üü 
=
üü 
this
üü  
.
üü  !
_line
üü! &
.
üü& '
Length
üü' -
;
üü- .
this
†† 
.
†† 
NextChar
†† 
(
†† 
)
†† 
;
††  
}
°° 
}
¢¢ 	
}
££ 
public
•• 

class
•• 
CsvDefinition
•• 
{
¶¶ 
public
ßß 
string
ßß 
Header
ßß 
{
ßß 
get
ßß "
;
ßß" #
set
ßß$ '
;
ßß' (
}
ßß) *
public
®® 
char
®® 
FieldSeparator
®® "
{
®®# $
get
®®% (
;
®®( )
set
®®* -
;
®®- .
}
®®/ 0
public
©© 
char
©© 
TextQualifier
©© !
{
©©" #
get
©©$ '
;
©©' (
set
©©) ,
;
©©, -
}
©©. /
public
™™ 
IEnumerable
™™ 
<
™™ 
String
™™ !
>
™™! "
Columns
™™# *
{
™™+ ,
get
™™- 0
;
™™0 1
set
™™2 5
;
™™5 6
}
™™7 8
public
´´ 
string
´´ 
	EndOfLine
´´ 
{
´´  !
get
´´" %
;
´´% &
set
´´' *
;
´´* +
}
´´, -
public
≠≠ 
CsvDefinition
≠≠ 
(
≠≠ 
)
≠≠ 
{
ÆÆ 	
if
ØØ 
(
ØØ 
CsvFile
ØØ 
.
ØØ "
DefaultCsvDefinition
ØØ ,
!=
ØØ- /
null
ØØ0 4
)
ØØ4 5
{
∞∞ 
FieldSeparator
±± 
=
±±  
CsvFile
±±! (
.
±±( )"
DefaultCsvDefinition
±±) =
.
±±= >
FieldSeparator
±±> L
;
±±L M
TextQualifier
≤≤ 
=
≤≤ 
CsvFile
≤≤  '
.
≤≤' ("
DefaultCsvDefinition
≤≤( <
.
≤≤< =
TextQualifier
≤≤= J
;
≤≤J K
	EndOfLine
≥≥ 
=
≥≥ 
CsvFile
≥≥ #
.
≥≥# $"
DefaultCsvDefinition
≥≥$ 8
.
≥≥8 9
	EndOfLine
≥≥9 B
;
≥≥B C
}
¥¥ 
}
µµ 	
}
∂∂ 
public
∏∏ 

class
∏∏ 
	CsvSource
∏∏ 
{
ππ 
public
∫∫ 
readonly
∫∫ 

TextReader
∫∫ "

TextReader
∫∫# -
;
∫∫- .
public
ºº 
static
ºº 
implicit
ºº 
operator
ºº '
	CsvSource
ºº( 1
(
ºº1 2
CsvFile
ºº2 9
csvFile
ºº: A
)
ººA B
{
ΩΩ 	
return
ææ 
new
ææ 
	CsvSource
ææ  
(
ææ  !
csvFile
ææ! (
)
ææ( )
;
ææ) *
}
øø 	
public
¡¡ 
static
¡¡ 
implicit
¡¡ 
operator
¡¡ '
	CsvSource
¡¡( 1
(
¡¡1 2
string
¡¡2 8
path
¡¡9 =
)
¡¡= >
{
¬¬ 	
return
√√ 
new
√√ 
	CsvSource
√√  
(
√√  !
path
√√! %
)
√√% &
;
√√& '
}
ƒƒ 	
public
∆∆ 
static
∆∆ 
implicit
∆∆ 
operator
∆∆ '
	CsvSource
∆∆( 1
(
∆∆1 2

TextReader
∆∆2 <

textReader
∆∆= G
)
∆∆G H
{
«« 	
return
»» 
new
»» 
	CsvSource
»»  
(
»»  !

textReader
»»! +
)
»»+ ,
;
»», -
}
…… 	
public
ÀÀ 
	CsvSource
ÀÀ 
(
ÀÀ 

TextReader
ÀÀ #

textReader
ÀÀ$ .
)
ÀÀ. /
{
ÃÃ 	
this
ÕÕ 
.
ÕÕ 

TextReader
ÕÕ 
=
ÕÕ 

textReader
ÕÕ (
;
ÕÕ( )
}
ŒŒ 	
public
–– 
	CsvSource
–– 
(
–– 
Stream
–– 
stream
––  &
)
––& '
{
—— 	
this
““ 
.
““ 

TextReader
““ 
=
““ 
new
““ !
StreamReader
““" .
(
““. /
stream
““/ 5
)
““5 6
;
““6 7
}
”” 	
public
’’ 
	CsvSource
’’ 
(
’’ 
string
’’ 
path
’’  $
)
’’$ %
{
÷÷ 	
this
◊◊ 
.
◊◊ 

TextReader
◊◊ 
=
◊◊ 
new
◊◊ !
StreamReader
◊◊" .
(
◊◊. /
path
◊◊/ 3
)
◊◊3 4
;
◊◊4 5
}
ÿÿ 	
public
⁄⁄ 
	CsvSource
⁄⁄ 
(
⁄⁄ 
CsvFile
⁄⁄  
csvFile
⁄⁄! (
)
⁄⁄( )
{
€€ 	
this
‹‹ 
.
‹‹ 

TextReader
‹‹ 
=
‹‹ 
new
‹‹ !
StreamReader
‹‹" .
(
‹‹. /
csvFile
‹‹/ 6
.
‹‹6 7

BaseStream
‹‹7 A
)
‹‹A B
;
‹‹B C
}
›› 	
}
ﬁﬁ 
public
‡‡ 

class
‡‡ 
CsvDestination
‡‡ 
{
·· 
private
‚‚ 
StreamWriter
‚‚ 
_streamWriter
‚‚ *
;
‚‚* +
public
‰‰ 
StreamWriter
‰‰ 
StreamWriter
‰‰ (
{
ÂÂ 	
get
ÊÊ 
{
ÊÊ 
return
ÊÊ 
_streamWriter
ÊÊ &
;
ÊÊ& '
}
ÊÊ( )
}
ÁÁ 	
public
ÈÈ 
static
ÈÈ 
implicit
ÈÈ 
operator
ÈÈ '
CsvDestination
ÈÈ( 6
(
ÈÈ6 7
string
ÈÈ7 =
path
ÈÈ> B
)
ÈÈB C
{
ÍÍ 	
return
ÎÎ 
new
ÎÎ 
CsvDestination
ÎÎ %
(
ÎÎ% &
path
ÎÎ& *
)
ÎÎ* +
;
ÎÎ+ ,
}
ÏÏ 	
private
ÌÌ 
CsvDestination
ÌÌ 
(
ÌÌ 
StreamWriter
ÌÌ +
streamWriter
ÌÌ, 8
)
ÌÌ8 9
{
ÓÓ 	
this
ÔÔ 
.
ÔÔ 
_streamWriter
ÔÔ 
=
ÔÔ  
streamWriter
ÔÔ! -
;
ÔÔ- .
}
 	
private
ÚÚ 
CsvDestination
ÚÚ 
(
ÚÚ 
Stream
ÚÚ %
stream
ÚÚ& ,
)
ÚÚ, -
{
ÛÛ 	
this
ÙÙ 
.
ÙÙ 
_streamWriter
ÙÙ 
=
ÙÙ  
new
ÙÙ! $
StreamWriter
ÙÙ% 1
(
ÙÙ1 2
stream
ÙÙ2 8
)
ÙÙ8 9
;
ÙÙ9 :
}
ıı 	
public
˜˜ 
CsvDestination
˜˜ 
(
˜˜ 
string
˜˜ $
fullName
˜˜% -
)
˜˜- .
{
¯¯ 	
FixCsvFileName
˘˘ 
(
˘˘ 
ref
˘˘ 
fullName
˘˘ '
)
˘˘' (
;
˘˘( )
this
˙˙ 
.
˙˙ 
_streamWriter
˙˙ 
=
˙˙  
new
˙˙! $
StreamWriter
˙˙% 1
(
˙˙1 2
fullName
˙˙2 :
)
˙˙: ;
;
˙˙; <
}
˚˚ 	
private
˝˝ 
static
˝˝ 
void
˝˝ 
FixCsvFileName
˝˝ *
(
˝˝* +
ref
˝˝+ .
string
˝˝/ 5
fullName
˝˝6 >
)
˝˝> ?
{
˛˛ 	
fullName
ˇˇ 
=
ˇˇ 
Path
ˇˇ 
.
ˇˇ 
GetFullPath
ˇˇ '
(
ˇˇ' (
fullName
ˇˇ( 0
)
ˇˇ0 1
;
ˇˇ1 2
var
ÄÄ 
path
ÄÄ 
=
ÄÄ 
Path
ÄÄ 
.
ÄÄ 
GetDirectoryName
ÄÄ ,
(
ÄÄ, -
fullName
ÄÄ- 5
)
ÄÄ5 6
;
ÄÄ6 7
if
ÅÅ 
(
ÅÅ 
path
ÅÅ 
!=
ÅÅ 
null
ÅÅ 
&&
ÅÅ 
!
ÅÅ  !
	Directory
ÅÅ! *
.
ÅÅ* +
Exists
ÅÅ+ 1
(
ÅÅ1 2
path
ÅÅ2 6
)
ÅÅ6 7
)
ÅÅ7 8
	Directory
ÇÇ 
.
ÇÇ 
CreateDirectory
ÇÇ )
(
ÇÇ) *
path
ÇÇ* .
)
ÇÇ. /
;
ÇÇ/ 0
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
String
ÉÉ 
.
ÉÉ 
Equals
ÉÉ 
(
ÉÉ 
Path
ÉÉ #
.
ÉÉ# $
GetExtension
ÉÉ$ 0
(
ÉÉ0 1
fullName
ÉÉ1 9
)
ÉÉ9 :
,
ÉÉ: ;
$str
ÉÉ< B
)
ÉÉB C
)
ÉÉC D
fullName
ÑÑ 
+=
ÑÑ 
$str
ÑÑ "
;
ÑÑ" #
}
ÖÖ 	
}
ÜÜ 
public
àà 

static
àà 
class
àà #
CsvFileLinqExtensions
àà -
{
ââ 
public
ää 
static
ää 
void
ää 
ToCsv
ää  
<
ää  !
T
ää! "
>
ää" #
(
ää# $
this
ää$ (
IEnumerable
ää) 4
<
ää4 5
T
ää5 6
>
ää6 7
source
ää8 >
,
ää> ?
CsvDestination
ää@ N
csvDestination
ääO ]
)
ää] ^
{
ãã 	
source
åå 
.
åå 
ToCsv
åå 
(
åå 
csvDestination
åå '
,
åå' (
null
åå) -
)
åå- .
;
åå. /
}
çç 	
public
èè 
static
èè 
void
èè 
ToCsv
èè  
<
èè  !
T
èè! "
>
èè" #
(
èè# $
this
èè$ (
IEnumerable
èè) 4
<
èè4 5
T
èè5 6
>
èè6 7
source
èè8 >
,
èè> ?
CsvDestination
èè@ N
csvDestination
èèO ]
,
èè] ^
CsvDefinition
èè_ l
csvDefinition
èèm z
)
èèz {
{
êê 	
using
ëë 
(
ëë 
var
ëë 
csvFile
ëë 
=
ëë  
new
ëë! $
CsvFile
ëë% ,
<
ëë, -
T
ëë- .
>
ëë. /
(
ëë/ 0
csvDestination
ëë0 >
,
ëë> ?
csvDefinition
ëë@ M
)
ëëM N
)
ëëN O
{
íí 
foreach
ìì 
(
ìì 
var
ìì 
record
ìì #
in
ìì$ &
source
ìì' -
)
ìì- .
{
îî 
csvFile
ïï 
.
ïï 
Append
ïï "
(
ïï" #
record
ïï# )
)
ïï) *
;
ïï* +
}
ññ 
}
óó 
}
òò 	
}
öö 
public
úú 

class
úú (
CsvIgnorePropertyAttribute
úú +
:
úú, -
	Attribute
úú. 7
{
ùù 
public
ûû 
override
ûû 
string
ûû 
ToString
ûû '
(
ûû' (
)
ûû( )
{
üü 	
return
†† 
$str
†† $
;
††$ %
}
°° 	
}
¢¢ 
}ßß ˇ
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\EmailChecker.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
EmailChecker 
{ 
private		 
static		 
bool		 
_invalid		 $
=		% &
false		' ,
;		, -
public 
static 
bool 
IsValidEmail '
(' (
string( .
strIn/ 4
)4 5
{ 	
_invalid 
= 
false 
; 
if 
( 
string 
. 
IsNullOrEmpty $
($ %
strIn% *
)* +
)+ ,
return 
false 
; 
try 
{ 
strIn 
= 
Regex 
. 
Replace %
(% &
strIn& +
,+ ,
$str- 8
,8 9
DomainMapper: F
,F G
RegexOptions& 2
.2 3
None3 7
,7 8
TimeSpan9 A
.A B
FromMillisecondsB R
(R S
$numS V
)V W
)W X
;X Y
} 
catch 
( &
RegexMatchTimeoutException -
)- .
{ 
return 
false 
; 
} 
try 
{ 
return 
Regex 
. 
IsMatch $
($ %
strIn% *
,* +
$str   y
+  z {
$str!! {
,!!{ |
RegexOptions"" "
.""" #

IgnoreCase""# -
,""- .
TimeSpan""/ 7
.""7 8
FromMilliseconds""8 H
(""H I
$num""I L
)""L M
)""M N
;""N O
}## 
catch$$ 
($$ &
RegexMatchTimeoutException$$ -
)$$- .
{%% 
return&& 
false&& 
;&& 
}'' 
}(( 	
private** 
static** 
string** 
DomainMapper** *
(*** +
Match**+ 0
match**1 6
)**6 7
{++ 	

IdnMapping-- 
idn-- 
=-- 
new--  

IdnMapping--! +
(--+ ,
)--, -
;--- .
string// 

domainName// 
=// 
match//  %
.//% &
Groups//& ,
[//, -
$num//- .
]//. /
./// 0
Value//0 5
;//5 6
try00 
{11 

domainName22 
=22 
idn22  
.22  !
GetAscii22! )
(22) *

domainName22* 4
)224 5
;225 6
}33 
catch44 
(44 
ArgumentException44 $
)44$ %
{55 
_invalid66 
=66 
true66 
;66  
}77 
return88 
match88 
.88 
Groups88 
[88  
$num88  !
]88! "
.88" #
Value88# (
+88) *

domainName88+ 5
;885 6
}99 	
}:: 
};; Ì
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\ExcelUtility.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
ExcelUtility 
{ 
public 
static 
int 
GetRow  
(  !
int! $

itemNumber% /
)/ 0
{ 	
int 
	rowNumber 
= 
$num 
; 
int 
firstStartingRow  
=! "
$num# $
;$ %
int		 
secondStartingRow		 !
=		" #
$num		$ &
;		& '
if 
( 

itemNumber 
<= 
$num  
)  !
	rowNumber 
= 

itemNumber &
+' (
firstStartingRow) 9
;9 :
if 
( 

itemNumber 
> 
$num 
&&  "

itemNumber# -
<. /
$num0 3
)3 4
	rowNumber 
= 

itemNumber &
+' (
firstStartingRow) 9
-: ;
$num< >
;> ?
if 
( 

itemNumber 
> 
$num  
&&! #

itemNumber$ .
<=/ 1
$num2 5
)5 6
	rowNumber 
= 

itemNumber &
-' (
$num) ,
+- .
secondStartingRow/ @
;@ A
if 
( 

itemNumber 
> 
$num  
)  !
	rowNumber 
= 

itemNumber &
-' (
$num) ,
+- .
secondStartingRow/ @
-A B
$numC E
;E F
return 
	rowNumber 
; 
} 	
public 
static 
string 
	GetColumn &
(& '
int' *

itemNumber+ 5
,5 6
string7 =

columnName> H
)H I
{ 	
string 
columnNumber 
=  !
string" (
.( )
Empty) .
;. /
if 
( 
( 

itemNumber 
<= 
$num !
)! "
||# %
(& '

itemNumber' 1
>2 3
$num4 7
&&8 :

itemNumber; E
<=F H
$numI L
)L M
)M N
{ 
columnNumber   
=   

columnName   )
.  ) *
Equals  * 0
(  0 1
$str  1 7
)  7 8
?  9 :
$str  ; >
:  ? @
(  A B

columnName  B L
.  L M
Equals  M S
(  S T
$str  T ^
)  ^ _
?  ` a
$str  b e
:  f g
$str  h k
)  k l
;  l m
}!! 
if## 
(## 
(## 

itemNumber## 
>## 
$num##  
&&##! #

itemNumber##$ .
<##/ 0
$num##1 4
)##4 5
||##6 8
(##9 :

itemNumber##: D
>##E F
$num##G J
)##J K
)##K L
{$$ 
columnNumber%% 
=%% 

columnName%% )
.%%) *
Equals%%* 0
(%%0 1
$str%%1 7
)%%7 8
?%%9 :
$str%%; >
:%%? @
(%%A B

columnName%%B L
.%%L M
Equals%%M S
(%%S T
$str%%T ^
)%%^ _
?%%` a
$str%%b e
:%%f g
$str%%h k
)%%k l
;%%l m
}&& 
return'' 
columnNumber'' 
;''  
}(( 	
})) 
}** ‘t
LE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\Helpers\FileManager.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
.		 
Async		 !
.		! "
Helpers		" )
{

 
public 

class 
FileManager 
{ 
static 
string 
_optOut 
= 
$str	  Ã
;
Ã Õ
static 
string 
_viewInBrowser $
=% &
$str	' ö
;
ö õ
static 
string 
_orderNumber "
;" #
static 
bool 
_isAddOptout  
;  !
static 
bool 
_isAddViewinBrowser '
;' (
static 
string 
_serverPrefix #
=$ %
$"& (
https://( 0
{0 1
S3FileManager1 >
.> ?
Bucket? E
}E F
.s3.amazonaws.com/F X
"X Y
;Y Z
public 
static 
HtmlProcessResult '
ProcessHtmlZip( 6
(6 7
string7 =

uploadPath> H
,H I
stringJ P
zipFilePathQ \
,\ ]
string^ d
orderNumbere p
,p q
boolr v
isAddOptout	w Ç
,
Ç É
bool
Ñ à 
isAddViewinBrowser
â õ
)
õ ú
{ 	
_orderNumber 
= 
orderNumber &
;& '
_isAddOptout 
= 
isAddOptout &
;& '
_isAddViewinBrowser 
=  !
isAddViewinBrowser" 4
;4 5
var 
	directory 
= 
$" 
{ 

uploadPath )
}) *
\\* ,
{, -
orderNumber- 8
}8 9
"9 :
;: ;
if 
( 
! 
	Directory 
. 
Exists !
(! "
	directory" +
)+ ,
), -
{ 
	Directory 
. 
CreateDirectory )
() *
	directory* 3
)3 4
;4 5
} 
ZipFile   
.   
ExtractToDirectory   &
(  & '
zipFilePath  ' 2
,  2 3
	directory  4 =
)  = >
;  > ?
var## 

imagesLive## 
=## 
string## #
.### $
Format##$ *
(##* +
$str##+ 7
,##7 8
orderNumber##9 D
)##D E
;##E F
string$$ 
htmlFileName$$ 
=$$  !
$"$$" $
{$$$ %
orderNumber$$% 0
}$$0 1
.htm$$1 5
"$$5 6
;$$6 7
string%% 
htmlFileKey%% 
=%%  
string%%! '
.%%' (
Format%%( .
(%%. /
$str%%/ <
,%%< =
orderNumber%%> I
)%%I J
;%%J K
string&& 
htmlFilePath&& 
=&&  !
$"&&" $
{&&$ %
	directory&&% .
}&&. /
\\&&/ 1
{&&1 2
htmlFileName&&2 >
}&&> ?
"&&? @
;&&@ A
string(( 
htmlFile(( 
=(( 
	Directory(( '
.((' (
EnumerateFiles((( 6
(((6 7
	directory((7 @
)((@ A
.((A B
FirstOrDefault((B P
(((P Q
x((Q R
=>((S U
x((V W
.((W X
EndsWith((X `
(((` a
$str((a f
)((f g
||((h j
x((k l
.((l m
EndsWith((m u
(((u v
$str((v |
)((| }
)((} ~
;((~ 
if)) 
()) 
string)) 
.)) 
IsNullOrEmpty)) #
())# $
htmlFile))$ ,
))), -
)))- .
throw** 
new** 
AdsException** &
(**& '
$str**' 7
)**7 8
;**8 9
UploadFileStatus,, 
status,, #
=,,$ %
ProcessHtml,,& 1
(,,1 2
htmlFile,,2 :
,,,: ;
htmlFilePath,,< H
),,H I
;,,I J
S3FileManager// 
.// 
CreateDirectory// )
(//) *
orderNumber//* 5
)//5 6
;//6 7
S3FileManager22 
.22 
Upload22  
(22  !
htmlFileKey22! ,
,22, -
htmlFilePath22. :
,22: ;
true22< @
)22@ A
;22A B
string33 
filePathLive33 
=33  !
$"33" $
{33$ %
_serverPrefix33% 2
}332 3
{333 4
htmlFileKey334 ?
}33? @
"33@ A
;33A B
S3FileManager66 
.66 
CreateDirectory66 )
(66) *

imagesLive66* 4
)664 5
;665 6
var99 
images99 
=99 
	Directory99 "
.99" # 
EnumerateDirectories99# 7
(997 8
	directory998 A
)99A B
.99B C
FirstOrDefault99C Q
(99Q R
)99R S
;99S T
if:: 
(:: 
images:: 
!=:: 
null:: 
):: 
foreach;; 
(;; 
var;; 
imgFile;;  
in;;! #
	Directory;;$ -
.;;- .
EnumerateFiles;;. <
(;;< =
images;;= C
);;C D
);;D E
{<< 
var== 
	imageLive== 
=== 
$"==  "
{==" #

imagesLive==# -
}==- .
/==. /
{==/ 0
new==0 3
FileInfo==4 <
(==< =
imgFile=== D
)==D E
.==E F
Name==F J
}==J K
"==K L
;==L M
S3FileManager>> 
.>> 
Upload>> $
(>>$ %
	imageLive>>% .
,>>. /
imgFile>>0 7
,>>7 8
true>>9 =
)>>= >
;>>> ?
}?? 
newBB 
DirectoryInfoBB 
(BB 
	directoryBB '
)BB' (
.BB( )
DeleteBB) /
(BB/ 0
trueBB0 4
)BB4 5
;BB5 6
returnDD 
newDD 
HtmlProcessResultDD (
(DD( )
)DD) *
{DD+ ,
StatusDD, 2
=DD3 4
statusDD5 ;
,DD; <
FilePathLiveDD= I
=DDJ K
filePathLiveDDL X
}DDX Y
;DDY Z
}EE 	
publicGG 
staticGG 
UploadFileStatusGG &
ProcessHtmlGG' 2
(GG2 3
stringGG3 9
htmlFileGG: B
,GGB C
stringGGD J
outputFilePathGGK Y
)GGY Z
{HH 	
stringII 

imagesPathII 
=II 
stringII  &
.II& '
FormatII' -
(II- .
$strII. >
,II> ?
_serverPrefixII@ M
,IIM N
_orderNumberIIO [
)II[ \
;II\ ]
HtmlDocumentKK 
docKK 
=KK 
newKK "
HtmlDocumentKK# /
(KK/ 0
)KK0 1
;KK1 2
docLL 
.LL 
LoadLL 
(LL 
htmlFileLL 
)LL 
;LL 
varMM 
allSrcsMM 
=MM 
docMM 
.MM 
DocumentNodeMM *
.MM* +
SelectNodesMM+ 6
(MM6 7
$strMM7 D
)MMD E
;MME F
boolNN 
alreadyHostedNN 
=NN  
falseNN! &
;NN& '
foreachOO 
(OO 
HtmlNodeOO 
nodeOO "
inOO# %
allSrcsOO& -
)OO- .
{PP 
varQQ 
srcQQ 
=QQ 
nodeQQ 
.QQ 

AttributesQQ )
[QQ) *
$strQQ* /
]QQ/ 0
.QQ0 1
ValueQQ1 6
;QQ6 7
ifSS 
(SS 
srcSS 
.SS 
ContainsSS  
(SS  !
$strSS! *
)SS* +
)SS+ ,
{TT 
alreadyHostedUU !
=UU" #
trueUU$ (
;UU( )
breakVV 
;VV 
;VV 
}WW 
elseXX 
{YY 
var\\ 
srcs\\ 
=\\ 
src\\ "
.\\" #
Split\\# (
(\\( )
$str\\) ,
.\\, -
ToCharArray\\- 8
(\\8 9
)\\9 :
)\\: ;
;\\; <
string]] 
imgFileName]] &
=]]' (
srcs]]) -
.]]- .
Length]]. 4
>]]5 6
$num]]7 8
?]]9 :
srcs]]; ?
[]]? @
$num]]@ A
]]]A B
:]]C D
string]]E K
.]]K L
Empty]]L Q
;]]Q R
src^^ 
=^^ 
$"^^ 
{^^ 

imagesPath^^ '
}^^' (
{^^( )
imgFileName^^) 4
}^^4 5
"^^5 6
;^^6 7
}__ 
node`` 
.`` 
SetAttributeValue`` &
(``& '
$str``' ,
,``, -
src``. 1
)``1 2
;``2 3
}aa 
HtmlNodecc 
bodycc 
=cc 
doccc 
.cc  
DocumentNodecc  ,
.cc, -
SelectSingleNodecc- =
(cc= >
$strcc> F
)ccF G
;ccG H
ifdd 
(dd 
_isAddViewinBrowserdd #
)dd# $
{ee 
HtmlNodeff 
newNodeff  
=ff! "
HtmlNodeff# +
.ff+ ,

CreateNodeff, 6
(ff6 7
_viewInBrowserff7 E
)ffE F
;ffF G
bodygg 
.gg 
PrependChildgg !
(gg! "
newNodegg" )
)gg) *
;gg* +
}hh 
ifii 
(ii 
_isAddOptoutii 
)ii 
{jj 
HtmlNodekk 
newNodekk  
=kk! "
HtmlNodekk# +
.kk+ ,

CreateNodekk, 6
(kk6 7
_optOutkk7 >
)kk> ?
;kk? @
bodyll 
.ll 
AppendChildll  
(ll  !
newNodell! (
)ll( )
;ll) *
}mm 
docoo 
.oo 
Saveoo 
(oo 
outputFilePathoo #
)oo# $
;oo$ %
returnqq 
alreadyHostedqq  
?qq! "
UploadFileStatusqq# 3
.qq3 4
HostedWithOutImagesqq4 G
:qqH I
UploadFileStatusqqK [
.qq[ \
HostedWithImagesqq\ l
;qql m
}rr 	
publictt 
statictt 
stringtt 
GetFilePathLivett ,
(tt, -
UploadFileTypett- ;
uploadFileTypett< J
,ttJ K
stringttL R
orderNumberttS ^
,tt^ _
stringtt` f
	extensionttg p
=ttq r
$strtts u
,ttu v
stringttw }
segmentNumber	tt~ ã
=
ttå ç
$str
tté ê
)
ttê ë
{uu 	
stringvv 
fileNamevv 
=vv 
$strvv  
;vv  !
switchww 
(ww 
uploadFileTypeww "
)ww" #
{xx 
caseyy 
UploadFileTypeyy '
.yy' (
ZipFileyy( /
:yy/ 0
fileNamezz  
=zz! "
stringzz# )
.zz) *
Formatzz* 0
(zz0 1
$strzz1 D
,zzD E
_serverPrefixzzF S
,zzS T
orderNumberzzU `
)zz` a
;zza b
break{{ 
;{{ 
case|| 
UploadFileType|| '
.||' (
TestSeedFile||( 4
:||4 5
fileName}}  
=}}! "
string}}# )
.}}) *
Format}}* 0
(}}0 1
$str}}1 E
,}}E F
_serverPrefix}}G T
,}}T U
orderNumber}}V a
)}}a b
;}}b c
break~~ 
;~~ 
case 
UploadFileType '
.' (
LiveSeedFile( 4
:4 5
fileName
ÄÄ  
=
ÄÄ! "
string
ÄÄ# )
.
ÄÄ) *
Format
ÄÄ* 0
(
ÄÄ0 1
$str
ÄÄ1 E
,
ÄÄE F
_serverPrefix
ÄÄG T
,
ÄÄT U
orderNumber
ÄÄV a
)
ÄÄa b
;
ÄÄb c
break
ÅÅ 
;
ÅÅ 
case
ÇÇ 
UploadFileType
ÇÇ '
.
ÇÇ' (
SuppressionFile
ÇÇ( 7
:
ÇÇ7 8
fileName
ÉÉ  
=
ÉÉ! "
string
ÉÉ# )
.
ÉÉ) *
Format
ÉÉ* 0
(
ÉÉ0 1
$str
ÉÉ1 E
,
ÉÉE F
_serverPrefix
ÉÉG T
,
ÉÉT U
orderNumber
ÉÉV a
)
ÉÉa b
;
ÉÉb c
break
ÑÑ 
;
ÑÑ 
case
ÖÖ 
UploadFileType
ÖÖ '
.
ÖÖ' (
BannersFile
ÖÖ( 3
:
ÖÖ3 4
fileName
ÜÜ $
=
ÜÜ% &
$"
ÜÜ' )
{
ÜÜ) *
_serverPrefix
ÜÜ* 7
}
ÜÜ7 8
{
ÜÜ8 9
orderNumber
ÜÜ9 D
}
ÜÜD E
/_banner
ÜÜE M
{
ÜÜM N
	extension
ÜÜN W
}
ÜÜW X
"
ÜÜX Y
;
ÜÜY Z
break
áá 
;
áá 
case
àà 
UploadFileType
àà '
.
àà' (
BannersLinksFile
àà( 8
:
àà8 9
fileName
ââ $
=
ââ% &
$"
ââ' )
{
ââ) *
_serverPrefix
ââ* 7
}
ââ7 8
{
ââ8 9
orderNumber
ââ9 D
}
ââD E
/_bannerlinks
ââE R
{
ââR S
	extension
ââS \
}
ââ\ ]
"
ââ] ^
;
ââ^ _
break
ää 
;
ää 
case
ãã 
UploadFileType
ãã '
.
ãã' (
MiscFile
ãã( 0
:
ãã0 1
fileName
åå  
=
åå! "
$"
åå# %
{
åå% &
_serverPrefix
åå& 3
}
åå3 4
{
åå4 5
orderNumber
åå5 @
}
åå@ A
/_misc
ååA G
{
ååG H
	extension
ååH Q
}
ååQ R
"
ååR S
;
ååS T
break
çç 
;
çç 
case
éé 
UploadFileType
éé '
.
éé' (
DataFile
éé( 0
:
éé0 1
fileName
èè  
=
èè! "
$"
èè# %
{
èè% &
_serverPrefix
èè& 3
}
èè3 4
{
èè4 5
orderNumber
èè5 @
}
èè@ A
/
èèA B
{
èèB C
segmentNumber
èèC P
}
èèP Q
data.csv
èèQ Y
"
èèY Z
;
èèZ [
break
êê 
;
êê 
}
ëë 
return
íí 
fileName
íí 
;
íí 
}
ìì 	
}
îî 
}ïï ∞d
OE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\Helpers\FileManagerFTP.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
.		 
Async		 !
.		! "
Helpers		" )
{

 
public 

class 
FileManagerFtp 
{ 
static 
string 
_optOut 
= 
$str	  Ã
;
Ã Õ
static 
string 
_viewInBrowser $
=% &
$str	' ö
;
ö õ
private 
static 
string 
_orderNumber *
;* +
private 
static 
bool 
_isAddOptout (
;( )
private 
static 
bool 
_isAddViewinBrowser /
;/ 0
public 
static 
HtmlProcessResult '
ProcessHtmlZip( 6
(6 7
string7 =

uploadPath> H
,H I
stringJ P
zipFilePathQ \
,\ ]
string^ d
orderNumbere p
,p q
boolr v
isAddOptout	w Ç
,
Ç É
bool
Ñ à 
isAddViewinBrowser
â õ
)
õ ú
{ 	
_orderNumber 
= 
orderNumber &
;& '
_isAddOptout 
= 
isAddOptout &
;& '
_isAddViewinBrowser 
=  !
isAddViewinBrowser" 4
;4 5
FileUploader 
uploader !
=" #
new$ '
FileUploader( 4
(4 5
)5 6
;6 7
var 
	directory 
= 
$" 
{ 

uploadPath )
}) *
\\* ,
{, -
orderNumber- 8
}8 9
temp9 =
"= >
;> ?
if 
( 
	Directory 
. 
Exists  
(  !
	directory! *
)* +
)+ ,
{ 
new 
DirectoryInfo !
(! "
	directory" +
)+ ,
., -
Delete- 3
(3 4
true4 8
)8 9
;9 :
} 
else   
{!! 
	Directory"" 
."" 
CreateDirectory"" )
("") *
	directory""* 3
)""3 4
;""4 5
}## 
ZipFile$$ 
.$$ 
ExtractToDirectory$$ &
($$& '
zipFilePath$$' 2
,$$2 3
	directory$$4 =
)$$= >
;$$> ?
string'' 
htmlFileName'' 
=''  !
$"''" $
{''$ %
orderNumber''% 0
}''0 1
.htm''1 5
"''5 6
;''6 7
string(( 
htmlFilePath(( 
=((  !
$"((" $
{(($ %
	directory((% .
}((. /
\\((/ 1
{((1 2
htmlFileName((2 >
}((> ?
"((? @
;((@ A
string** 
htmlFile** 
=** 
	Directory** '
.**' (
EnumerateFiles**( 6
(**6 7
	directory**7 @
)**@ A
.**A B
FirstOrDefault**B P
(**P Q
x**Q R
=>**S U
x**V W
.**W X
EndsWith**X `
(**` a
$str**a f
)**f g
||**h j
x**k l
.**l m
EndsWith**m u
(**u v
$str**v |
)**| }
)**} ~
;**~ 
if++ 
(++ 
string++ 
.++ 
IsNullOrEmpty++ #
(++# $
htmlFile++$ ,
)++, -
)++- .
throw,, 
new,, 
AdsException,, &
(,,& '
$str,,' 7
),,7 8
;,,8 9
UploadFileStatus.. 
status.. #
=..$ %
ProcessHtml..& 1
(..1 2
htmlFile..2 :
,..: ;
htmlFilePath..< H
)..H I
;..I J
uploader11 
.11 
CreateDirectory11 $
(11$ %
orderNumber11% 0
)110 1
;111 2
string44 
filePathLive44 
=44  !
uploader44" *
.44* +
Upload44+ 1
(441 2
orderNumber442 =
,44= >
htmlFileName44? K
,44K L
htmlFilePath44M Y
)44Y Z
;44Z [
var77 

imagesLive77 
=77 
$"77 
{77  
orderNumber77  +
}77+ ,
/77, -
{77- .
orderNumber77. 9
}779 :
img77: =
"77= >
;77> ?
uploader88 
.88 
CreateDirectory88 $
(88$ %

imagesLive88% /
)88/ 0
;880 1
var;; 
images;; 
=;; 
	Directory;; "
.;;" # 
EnumerateDirectories;;# 7
(;;7 8
	directory;;8 A
);;A B
.;;B C
FirstOrDefault;;C Q
(;;Q R
);;R S
;;;S T
if<< 
(<< 
images<< 
!=<< 
null<< 
)<< 
foreach== 
(== 
var== 
imgFile== $
in==% '
	Directory==( 1
.==1 2
EnumerateFiles==2 @
(==@ A
images==A G
)==G H
)==H I
{>> 
var?? 
file?? 
=?? 
new?? "
FileInfo??# +
(??+ ,
imgFile??, 3
)??3 4
;??4 5
uploader@@ 
.@@ 
Upload@@ #
(@@# $

imagesLive@@$ .
,@@. /
file@@0 4
.@@4 5
Name@@5 9
,@@9 :
imgFile@@; B
)@@B C
;@@C D
}AA 
newDD 
DirectoryInfoDD 
(DD 
	directoryDD '
)DD' (
.DD( )
DeleteDD) /
(DD/ 0
trueDD0 4
)DD4 5
;DD5 6
returnFF 
newFF 
HtmlProcessResultFF (
(FF( )
)FF) *
{FF+ ,
StatusFF, 2
=FF3 4
statusFF5 ;
,FF; <
FilePathLiveFF= I
=FFJ K
filePathLiveFFL X
}FFX Y
;FFY Z
}GG 	
publicII 
staticII 
UploadFileStatusII &
ProcessHtmlII' 2
(II2 3
stringII3 9
htmlFileII: B
,IIB C
stringIID J
outputFilePathIIK Y
)IIY Z
{JJ 	
stringKK 

imagesPathKK 
=KK 
stringKK  &
.KK& '
FormatKK' -
(KK- .
$strKK. ^
,KK^ _
_orderNumberKK` l
)KKl m
;KKm n
HtmlDocumentMM 
docMM 
=MM 
newMM "
HtmlDocumentMM# /
(MM/ 0
)MM0 1
;MM1 2
docNN 
.NN 
LoadNN 
(NN 
htmlFileNN 
)NN 
;NN 
varOO 
allSrcsOO 
=OO 
docOO 
.OO 
DocumentNodeOO *
.OO* +
SelectNodesOO+ 6
(OO6 7
$strOO7 D
)OOD E
;OOE F
boolPP 
alreadyHostedPP 
=PP  
falsePP! &
;PP& '
foreachQQ 
(QQ 
HtmlNodeQQ 
nodeQQ "
inQQ# %
allSrcsQQ& -
)QQ- .
{RR 
varSS 
srcSS 
=SS 
nodeSS 
.SS 

AttributesSS )
[SS) *
$strSS* /
]SS/ 0
.SS0 1
ValueSS1 6
;SS6 7
ifUU 
(UU 
srcUU 
.UU 
ContainsUU  
(UU  !
$strUU! *
)UU* +
)UU+ ,
{VV 
alreadyHostedWW !
=WW" #
trueWW$ (
;WW( )
breakXX 
;XX 
;XX 
}YY 
elseZZ 
{[[ 
var^^ 
srcs^^ 
=^^ 
src^^ "
.^^" #
Split^^# (
(^^( )
$str^^) ,
.^^, -
ToCharArray^^- 8
(^^8 9
)^^9 :
)^^: ;
;^^; <
string__ 
imgFileName__ &
=__' (
srcs__) -
.__- .
Length__. 4
>__5 6
$num__7 8
?__9 :
srcs__; ?
[__? @
$num__@ A
]__A B
:__C D
string__E K
.__K L
Empty__L Q
;__Q R
src`` 
=`` 
$"`` 
{`` 

imagesPath`` '
}``' (
{``( )
imgFileName``) 4
}``4 5
"``5 6
;``6 7
}aa 
nodebb 
.bb 
SetAttributeValuebb &
(bb& '
$strbb' ,
,bb, -
srcbb. 1
)bb1 2
;bb2 3
}cc 
HtmlNodeee 
bodyee 
=ee 
docee 
.ee  
DocumentNodeee  ,
.ee, -
SelectSingleNodeee- =
(ee= >
$stree> F
)eeF G
;eeG H
ifff 
(ff 
_isAddViewinBrowserff #
)ff# $
{gg 
HtmlNodehh 
newNodehh  
=hh! "
HtmlNodehh# +
.hh+ ,

CreateNodehh, 6
(hh6 7
_viewInBrowserhh7 E
)hhE F
;hhF G
bodyii 
.ii 
PrependChildii !
(ii! "
newNodeii" )
)ii) *
;ii* +
}jj 
ifkk 
(kk 
_isAddOptoutkk 
)kk 
{ll 
HtmlNodemm 
newNodemm  
=mm! "
HtmlNodemm# +
.mm+ ,

CreateNodemm, 6
(mm6 7
_optOutmm7 >
)mm> ?
;mm? @
bodynn 
.nn 
AppendChildnn  
(nn  !
newNodenn! (
)nn( )
;nn) *
}oo 
docqq 
.qq 
Saveqq 
(qq 
outputFilePathqq #
)qq# $
;qq$ %
returnss 
alreadyHostedss  
?ss! "
UploadFileStatusss# 3
.ss3 4
HostedWithOutImagesss4 G
:ssH I
UploadFileStatusssK [
.ss[ \
HostedWithImagesss\ l
;ssl m
}tt 	
publicvv 
staticvv 
stringvv 

UploadFilevv '
(vv' (
UploadFileTypevv( 6
uploadFileTypevv7 E
,vvE F
stringvvG M
filePathvvN V
,vvV W
stringvvX ^
orderNumbervv_ j
)vvj k
{ww 	
FileUploaderxx 
uploaderxx !
=xx" #
newxx$ '
FileUploaderxx( 4
(xx4 5
)xx5 6
;xx6 7
uploader{{ 
.{{ 
CreateDirectory{{ $
({{$ %
orderNumber{{% 0
){{0 1
;{{1 2
string}} 
fileName}} 
=}} 
$str}}  
;}}  !
switch~~ 
(~~ 
uploadFileType~~ "
)~~" #
{ 
case
ÄÄ 
UploadFileType
ÄÄ '
.
ÄÄ' (
ZipFile
ÄÄ( /
:
ÄÄ/ 0
fileName
ÅÅ  
=
ÅÅ! "
$"
ÅÅ# %
{
ÅÅ% &
orderNumber
ÅÅ& 1
}
ÅÅ1 2
zip.csv
ÅÅ2 9
"
ÅÅ9 :
;
ÅÅ: ;
break
ÇÇ 
;
ÇÇ 
case
ÉÉ 
UploadFileType
ÉÉ '
.
ÉÉ' (
TestSeedFile
ÉÉ( 4
:
ÉÉ4 5
fileName
ÑÑ  
=
ÑÑ! "
$"
ÑÑ# %
{
ÑÑ% &
orderNumber
ÑÑ& 1
}
ÑÑ1 2
test.csv
ÑÑ2 :
"
ÑÑ: ;
;
ÑÑ; <
break
ÖÖ 
;
ÖÖ 
case
ÜÜ 
UploadFileType
ÜÜ '
.
ÜÜ' (
LiveSeedFile
ÜÜ( 4
:
ÜÜ4 5
fileName
áá  
=
áá! "
$"
áá# %
{
áá% &
orderNumber
áá& 1
}
áá1 2
live.csv
áá2 :
"
áá: ;
;
áá; <
break
àà 
;
àà 
case
ââ 
UploadFileType
ââ '
.
ââ' (
SuppressionFile
ââ( 7
:
ââ7 8
fileName
ää  
=
ää! "
$"
ää# %
{
ää% &
orderNumber
ää& 1
}
ää1 2
supp.csv
ää2 :
"
ää: ;
;
ää; <
break
ãã 
;
ãã 
}
åå 
return
çç 
uploader
çç 
.
çç 
Upload
çç "
(
çç" #
orderNumber
çç# .
,
çç. /
fileName
çç0 8
,
çç8 9
filePath
çç: B
)
ççB C
;
ççC D
}
éé 	
}
èè 
}êê ÄÄ
FE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\FileProcessor.cs
	namespace

 	
ADSDataDirect


 
.

 
Web

 
.

 
Async

 !
{ 
public 

static 
class 
FileProcessor %
{ 
public 
static 
void  
ProcessNewOrderFiles /
(/ 0
WfpictContext0 =
db> @
,@ A
CampaignB J
campaignK S
)S T
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
campaign& .
.. /
Assets/ 5
.5 6
CreativeFiles6 C
)C D
)D E
{ 
string 
amazonFileKey $
=% &
string' -
.- .
Format. 4
(4 5
$str5 G
,G H
campaignI Q
.Q R
OrderNumberR ]
)] ^
;^ _
S3FileManager 
. 
Move "
(" #
campaign# +
.+ ,
Assets, 2
.2 3
CreativeFiles3 @
,@ A
amazonFileKeyB O
,O P
campaignQ Y
.Y Z
OrderNumberZ e
,e f
trueg k
)k l
;l m
campaign 
. 
Assets 
.  
CreativeFiles  -
=. /
amazonFileKey0 =
;= >
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
FileProcessing- ;
,; <
campaign= E
.E F
OrderNumberF Q
,Q R
$str -
+. /
amazonFileKey0 =
)= >
;> ?
} 
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
campaign& .
.. /
Assets/ 5
.5 6
ZipCodeFile6 A
)A B
)B C
{ 
string 
amazonFileKey $
=% &
string' -
.- .
Format. 4
(4 5
$str5 E
,E F
campaignG O
.O P
OrderNumberP [
)[ \
;\ ]
S3FileManager 
. 
Move "
(" #
campaign# +
.+ ,
Assets, 2
.2 3
ZipCodeFile3 >
,> ?
amazonFileKey@ M
,M N
campaignO W
.W X
OrderNumberX c
,c d
truee i
)i j
;j k
campaign 
. 
Assets 
.  
ZipCodeFile  +
=, -
amazonFileKey. ;
;; <
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
FileProcessing- ;
,; <
campaign= E
.E F
OrderNumberF Q
,Q R
$str +
+, -
amazonFileKey. ;
); <
;< =
} 
if   
(   
!   
string   
.   
IsNullOrEmpty   %
(  % &
campaign  & .
.  . /
Assets  / 5
.  5 6
TestSeedFile  6 B
)  B C
)  C D
{!! 
string"" 
amazonFileKey"" $
=""% &
string""' -
.""- .
Format"". 4
(""4 5
$str""5 F
,""F G
campaign""H P
.""P Q
OrderNumber""Q \
)""\ ]
;""] ^
S3FileManager## 
.## 
Move## "
(##" #
campaign### +
.##+ ,
Assets##, 2
.##2 3
TestSeedFile##3 ?
,##? @
amazonFileKey##A N
,##N O
campaign##P X
.##X Y
OrderNumber##Y d
,##d e
true##f j
)##j k
;##k l
campaign$$ 
.$$ 
Assets$$ 
.$$  
TestSeedFile$$  ,
=$$- .
amazonFileKey$$/ <
;$$< =
	LogHelper%% 
.%% 
AddLog%%  
(%%  !
db%%! #
,%%# $
LogType%%% ,
.%%, -
FileProcessing%%- ;
,%%; <
campaign%%= E
.%%E F
OrderNumber%%F Q
,%%Q R
$str&& ,
+&&- .
amazonFileKey&&/ <
)&&< =
;&&= >
}'' 
if(( 
((( 
!(( 
string(( 
.(( 
IsNullOrEmpty(( %
(((% &
campaign((& .
.((. /
Assets((/ 5
.((5 6
LiveSeedFile((6 B
)((B C
)((C D
{)) 
string** 
amazonFileKey** $
=**% &
string**' -
.**- .
Format**. 4
(**4 5
$str**5 F
,**F G
campaign**H P
.**P Q
OrderNumber**Q \
)**\ ]
;**] ^
S3FileManager++ 
.++ 
Move++ "
(++" #
campaign++# +
.+++ ,
Assets++, 2
.++2 3
LiveSeedFile++3 ?
,++? @
amazonFileKey++A N
,++N O
campaign++P X
.++X Y
OrderNumber++Y d
,++d e
true++f j
)++j k
;++k l
campaign,, 
.,, 
Assets,, 
.,,  
LiveSeedFile,,  ,
=,,- .
amazonFileKey,,/ <
;,,< =
	LogHelper-- 
.-- 
AddLog--  
(--  !
db--! #
,--# $
LogType--% ,
.--, -
FileProcessing--- ;
,--; <
campaign--= E
.--E F
OrderNumber--F Q
,--Q R
$str.. ,
+..- .
amazonFileKey../ <
)..< =
;..= >
}// 
if00 
(00 
!00 
string00 
.00 
IsNullOrEmpty00 %
(00% &
campaign00& .
.00. /
Assets00/ 5
.005 6
SuppressionFile006 E
)00E F
)00F G
{11 
string22 
amazonFileKey22 $
=22% &
string22' -
.22- .
Format22. 4
(224 5
$str225 F
,22F G
campaign22H P
.22P Q
OrderNumber22Q \
)22\ ]
;22] ^
S3FileManager33 
.33 
Move33 "
(33" #
campaign33# +
.33+ ,
Assets33, 2
.332 3
SuppressionFile333 B
,33B C
amazonFileKey33D Q
,33Q R
campaign33S [
.33[ \
OrderNumber33\ g
,33g h
true33i m
)33m n
;33n o
campaign44 
.44 
Assets44 
.44  
SuppressionFile44  /
=440 1
amazonFileKey442 ?
;44? @
	LogHelper55 
.55 
AddLog55  
(55  !
db55! #
,55# $
LogType55% ,
.55, -
FileProcessing55- ;
,55; <
campaign55= E
.55E F
OrderNumber55F Q
,55Q R
$str66 /
+660 1
amazonFileKey662 ?
)66? @
;66@ A
}77 
if88 
(88 
!88 
string88 
.88 
IsNullOrEmpty88 %
(88% &
campaign88& .
.88. /
Assets88/ 5
.885 6
BannersFile886 A
)88A B
)88B C
{99 
string:: 
amazonFileKey:: $
=::% &
string::' -
.::- .
Format::. 4
(::4 5
$str::5 H
,::H I
campaign::J R
.::R S
OrderNumber::S ^
,::^ _
Path;; 
.;; 
GetExtension;; %
(;;% &
campaign;;& .
.;;. /
Assets;;/ 5
.;;5 6
BannersFile;;6 A
);;A B
);;B C
;;;C D
S3FileManager<< 
.<< 
Move<< "
(<<" #
campaign<<# +
.<<+ ,
Assets<<, 2
.<<2 3
BannersFile<<3 >
,<<> ?
amazonFileKey<<@ M
,<<M N
campaign<<O W
.<<W X
OrderNumber<<X c
,<<c d
true<<e i
)<<i j
;<<j k
campaign== 
.== 
Assets== 
.==  
BannersFile==  +
===, -
amazonFileKey==. ;
;==; <
	LogHelper>> 
.>> 
AddLog>>  
(>>  !
db>>! #
,>># $
LogType>>% ,
.>>, -
FileProcessing>>- ;
,>>; <
campaign>>= E
.>>E F
OrderNumber>>F Q
,>>Q R
$str?? +
+??, -
amazonFileKey??. ;
)??; <
;??< =
}@@ 
ifAA 
(AA 
!AA 
stringAA 
.AA 
IsNullOrEmptyAA %
(AA% &
campaignAA& .
.AA. /
AssetsAA/ 5
.AA5 6
BannerLinksFileAA6 E
)AAE F
)AAF G
{BB 
stringCC 
amazonFileKeyCC $
=CC% &
stringCC' -
.CC- .
FormatCC. 4
(CC4 5
$strCC5 M
,CCM N
campaignCCO W
.CCW X
OrderNumberCCX c
,CCc d
PathDD 
.DD 
GetExtensionDD %
(DD% &
campaignDD& .
.DD. /
AssetsDD/ 5
.DD5 6
BannerLinksFileDD6 E
)DDE F
)DDF G
;DDG H
S3FileManagerEE 
.EE 
MoveEE "
(EE" #
campaignEE# +
.EE+ ,
AssetsEE, 2
.EE2 3
BannerLinksFileEE3 B
,EEB C
amazonFileKeyEED Q
,EEQ R
campaignEES [
.EE[ \
OrderNumberEE\ g
,EEg h
trueEEi m
)EEm n
;EEn o
campaignFF 
.FF 
AssetsFF 
.FF  
BannerLinksFileFF  /
=FF0 1
amazonFileKeyFF2 ?
;FF? @
	LogHelperGG 
.GG 
AddLogGG  
(GG  !
dbGG! #
,GG# $
LogTypeGG% ,
.GG, -
FileProcessingGG- ;
,GG; <
campaignGG= E
.GGE F
OrderNumberGGF Q
,GGQ R
$strHH /
+HH0 1
amazonFileKeyHH2 ?
)HH? @
;HH@ A
}II 
ifJJ 
(JJ 
!JJ 
stringJJ 
.JJ 
IsNullOrEmptyJJ %
(JJ% &
campaignJJ& .
.JJ. /
AssetsJJ/ 5
.JJ5 6
MiscFileJJ6 >
)JJ> ?
)JJ? @
{KK 
stringLL 
amazonFileKeyLL $
=LL% &
stringLL' -
.LL- .
FormatLL. 4
(LL4 5
$strLL5 F
,LLF G
campaignLLH P
.LLP Q
OrderNumberLLQ \
,LL\ ]
PathMM 
.MM 
GetExtensionMM %
(MM% &
campaignMM& .
.MM. /
AssetsMM/ 5
.MM5 6
MiscFileMM6 >
)MM> ?
)MM? @
;MM@ A
S3FileManagerNN 
.NN 
MoveNN "
(NN" #
campaignNN# +
.NN+ ,
AssetsNN, 2
.NN2 3
MiscFileNN3 ;
,NN; <
amazonFileKeyNN= J
,NNJ K
campaignNNL T
.NNT U
OrderNumberNNU `
,NN` a
trueNNb f
)NNf g
;NNg h
campaignOO 
.OO 
AssetsOO 
.OO  
MiscFileOO  (
=OO) *
amazonFileKeyOO+ 8
;OO8 9
	LogHelperPP 
.PP 
AddLogPP  
(PP  !
dbPP! #
,PP# $
LogTypePP% ,
.PP, -
FileProcessingPP- ;
,PP; <
campaignPP= E
.PPE F
OrderNumberPPF Q
,PPQ R
$strPPS g
+PPh i
amazonFileKeyPPj w
)PPw x
;PPx y
}QQ 
foreachSS 
(SS 
varSS 
segmentSS  
inSS! #
campaignSS$ ,
.SS, -
SegmentsSS- 5
)SS5 6
{TT 
ifUU 
(UU 
stringUU 
.UU 
IsNullOrEmptyUU '
(UU' (
segmentUU( /
.UU/ 0
CreativeFilesUU0 =
)UU= >
)UU> ?
continueUU@ H
;UUH I
stringVV 
amazonFileKeyVV $
=VV% &
$"VV' )
{VV) *
campaignVV* 2
.VV2 3
OrderNumberVV3 >
}VV> ?
/VV? @
{VV@ A
segmentVVA H
.VVH I
SegmentNumberVVI V
}VVV W
	_html.zipVVW `
"VV` a
;VVa b
S3FileManagerWW 
.WW 
MoveWW "
(WW" #
segmentWW# *
.WW* +
CreativeFilesWW+ 8
,WW8 9
amazonFileKeyWW: G
,WWG H
campaignWWI Q
.WWQ R
OrderNumberWWR ]
,WW] ^
trueWW_ c
)WWc d
;WWd e
segmentXX 
.XX 
CreativeFilesXX %
=XX& '
amazonFileKeyXX( 5
;XX5 6
	LogHelperYY 
.YY 
AddLogYY  
(YY  !
dbYY! #
,YY# $
LogTypeYY% ,
.YY, -
FileProcessingYY- ;
,YY; <
campaignYY= E
.YYE F
OrderNumberYYF Q
,YYQ R
$strZZ 
+ZZ  !
segmentZZ" )
.ZZ) *
SegmentNumberZZ* 7
+ZZ8 9
$strZZ: T
+ZZU V
amazonFileKeyZZW d
)ZZd e
;ZZe f
}[[ 
}\\ 	
public^^ 
static^^ 
void^^ "
ProcessAssetUpdateUrls^^ 1
(^^1 2
string^^2 8

uploadPath^^9 C
,^^C D
string^^E K
orderNumber^^L W
)^^W X
{__ 	
using`` 
(`` 
var`` 
db`` 
=`` 
new`` 
WfpictContext``  -
(``- .
)``. /
)``/ 0
{aa 
varbb 
campaignbb 
=bb 
dbbb !
.bb! "
	Campaignsbb" +
.bb+ ,
Includebb, 3
(bb3 4
xbb4 5
=>bb6 8
xbb9 :
.bb: ;
Assetsbb; A
)bbA B
.bbB C
FirstOrDefaultbbC Q
(bbQ R
xbbR S
=>bbT V
xbbW X
.bbX Y
OrderNumberbbY d
==bbe g
orderNumberbbh s
)bbs t
;bbt u
vardd 
	directorydd 
=dd 
$"dd  "
{dd" #

uploadPathdd# -
}dd- .
\\dd. 0
{dd0 1
campaigndd1 9
.dd9 :
OrderNumberdd: E
}ddE F
"ddF G
;ddG H
ifee 
(ee 
!ee 
	Directoryee 
.ee 
Existsee %
(ee% &
	directoryee& /
)ee/ 0
)ee0 1
	Directoryee2 ;
.ee; <
CreateDirectoryee< K
(eeK L
	directoryeeL U
)eeU V
;eeV W
tryhh 
{ii 
ifjj 
(jj 
!jj 
stringjj 
.jj  
IsNullOrEmptyjj  -
(jj- .
campaignjj. 6
.jj6 7
Assetsjj7 =
.jj= >
CreativeFilesjj> K
)jjK L
)jjL M
{kk 
stringll 
filePathll '
=ll( )
Pathll* .
.ll. /
Combinell/ 6
(ll6 7

uploadPathll7 A
,llA B
campaignllC K
.llK L
AssetsllL R
.llR S
CreativeFilesllS `
)ll` a
;lla b
S3FileManagermm %
.mm% &
Downloadmm& .
(mm. /
campaignmm/ 7
.mm7 8
Assetsmm8 >
.mm> ?
CreativeFilesmm? L
,mmL M
filePathmmN V
)mmV W
;mmW X
varnn 
resultnn "
=nn# $
FileManagernn% 0
.nn0 1
ProcessHtmlZipnn1 ?
(nn? @

uploadPathnn@ J
,nnJ K
filePathnnL T
,nnT U
campaignnnV ^
.nn^ _
OrderNumbernn_ j
,nnj k
campaignnnl t
.nnt u
IsAddOptOut	nnu Ä
,
nnÄ Å
campaign
nnÇ ä
.
nnä ã 
IsAddViewInBrowser
nnã ù
)
nnù û
;
nnû ü
campaignoo  
.oo  !
Assetsoo! '
.oo' (
CreativeUrloo( 3
=oo4 5
resultoo6 <
.oo< =
FilePathLiveoo= I
;ooI J
campaignpp  
.pp  !
Assetspp! '
.pp' (
CreativeStatuspp( 6
=pp7 8
(pp9 :
intpp: =
)pp= >
resultpp> D
.ppD E
StatusppE K
;ppK L
	LogHelperqq !
.qq! "
AddLogqq" (
(qq( )
dbqq) +
,qq+ ,
LogTypeqq- 4
.qq4 5
FileProcessingqq5 C
,qqC D
orderNumberqqE P
,qqP Q
$strqqR m
+qqn o
campaignqqp x
.qqx y
Assetsqqy 
.	qq Ä
CreativeUrl
qqÄ ã
+
qqå ç
$str
qqé ö
+
qqõ ú
System
qqù £
.
qq£ §
Enum
qq§ ®
.
qq® ©
GetName
qq© ∞
(
qq∞ ±
typeof
qq± ∑
(
qq∑ ∏
UploadFileStatus
qq∏ »
)
qq» …
,
qq…  
campaign
qqÀ ”
.
qq” ‘
Assets
qq‘ ⁄
.
qq⁄ €
CreativeStatus
qq€ È
)
qqÈ Í
)
qqÍ Î
;
qqÎ Ï
}rr 
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
campaignvv 
.vv 
Assetsvv #
.vv# $
CreativeStatusvv$ 2
=vv3 4
(vv5 6
intvv6 9
)vv9 :
UploadFileStatusvv: J
.vvJ K
FailedvvK Q
;vvQ R
	LogHelperww 
.ww 
AddErrorww &
(ww& '
dbww' )
,ww) *
LogTypeww+ 2
.ww2 3
FileProcessingww3 A
,wwA B
orderNumberwwC N
,wwN O
$strwwP s
+wwt u
exwwv x
.wwx y
Message	wwy Ä
+
wwÅ Ç
$str
wwÉ è
+
wwê ë
System
wwí ò
.
wwò ô
Enum
wwô ù
.
wwù û
GetName
wwû •
(
ww• ¶
typeof
ww¶ ¨
(
ww¨ ≠
UploadFileStatus
ww≠ Ω
)
wwΩ æ
,
wwæ ø
campaign
ww¿ »
.
ww» …
Assets
ww… œ
.
wwœ –
CreativeStatus
ww– ﬁ
)
wwﬁ ﬂ
)
wwﬂ ‡
;
ww‡ ·
}xx 
dbyy 
.yy 
SaveChangesyy 
(yy 
)yy  
;yy  !
if{{ 
({{ 
!{{ 
string{{ 
.{{ 
IsNullOrEmpty{{ )
({{) *
campaign{{* 2
.{{2 3
Assets{{3 9
.{{9 :
ZipCodeFile{{: E
){{E F
){{F G
{|| 
campaign~~ 
.~~ 
Assets~~ #
.~~# $

ZipCodeUrl~~$ .
=~~/ 0
FileManager~~1 <
.~~< =
GetFilePathLive~~= L
(~~L M
UploadFileType~~M [
.~~[ \
ZipFile~~\ c
,~~c d
campaign  
.  !
OrderNumber! ,
), -
;- .
campaign
ÄÄ 
.
ÄÄ 
Assets
ÄÄ #
.
ÄÄ# $
ZipCodeStatus
ÄÄ$ 1
=
ÄÄ2 3
(
ÄÄ4 5
int
ÄÄ5 8
)
ÄÄ8 9
UploadFileStatus
ÄÄ: J
.
ÄÄJ K
	Completed
ÄÄK T
;
ÄÄT U
	LogHelper
ÅÅ 
.
ÅÅ 
AddLog
ÅÅ $
(
ÅÅ$ %
db
ÅÅ% '
,
ÅÅ' (
LogType
ÅÅ) 0
.
ÅÅ0 1
FileProcessing
ÅÅ1 ?
,
ÅÅ? @
orderNumber
ÅÅA L
,
ÅÅL M
$str
ÇÇ 1
+
ÇÇ2 3
campaign
ÇÇ4 <
.
ÇÇ< =
Assets
ÇÇ= C
.
ÇÇC D

ZipCodeUrl
ÇÇD N
+
ÇÇO P
$str
ÇÇQ ]
+
ÇÇ^ _
System
ÉÉ 
.
ÉÉ 
Enum
ÉÉ #
.
ÉÉ# $
GetName
ÉÉ$ +
(
ÉÉ+ ,
typeof
ÉÉ, 2
(
ÉÉ2 3
UploadFileStatus
ÉÉ3 C
)
ÉÉC D
,
ÉÉD E
campaign
ÉÉF N
.
ÉÉN O
Assets
ÉÉO U
.
ÉÉU V
ZipCodeStatus
ÉÉV c
)
ÉÉc d
)
ÉÉd e
;
ÉÉe f
}
ÑÑ 
if
áá 
(
áá 
!
áá 
string
áá 
.
áá 
IsNullOrEmpty
áá )
(
áá) *
campaign
áá* 2
.
áá2 3
Assets
áá3 9
.
áá9 :
TestSeedFile
áá: F
)
ááF G
)
ááG H
{
àà 
campaign
ââ 
.
ââ 
Assets
ââ #
.
ââ# $
TestSeedUrl
ââ$ /
=
ââ0 1
FileManager
ââ2 =
.
ââ= >
GetFilePathLive
ââ> M
(
ââM N
UploadFileType
ââN \
.
ââ\ ]
TestSeedFile
ââ] i
,
ââi j
campaign
ää  
.
ää  !
OrderNumber
ää! ,
)
ää, -
;
ää- .
campaign
ãã 
.
ãã 
Assets
ãã #
.
ãã# $
TestSeedStatus
ãã$ 2
=
ãã3 4
(
ãã5 6
int
ãã6 9
)
ãã9 :
UploadFileStatus
ãã; K
.
ããK L
	Completed
ããL U
;
ããU V
	LogHelper
åå 
.
åå 
AddLog
åå $
(
åå$ %
db
åå% '
,
åå' (
LogType
åå) 0
.
åå0 1
FileProcessing
åå1 ?
,
åå? @
orderNumber
ååA L
,
ååL M
$str
çç 2
+
çç3 4
campaign
çç5 =
.
çç= >
Assets
çç> D
.
ççD E
TestSeedUrl
ççE P
+
ççQ R
$str
ççS _
+
çç` a
System
éé 
.
éé 
Enum
éé "
.
éé" #
GetName
éé# *
(
éé* +
typeof
éé+ 1
(
éé1 2
UploadFileStatus
éé2 B
)
ééB C
,
ééC D
campaign
ééE M
.
ééM N
Assets
ééN T
.
ééT U
TestSeedStatus
ééU c
)
ééc d
)
ééd e
;
éée f
}
èè 
if
íí 
(
íí 
!
íí 
string
íí 
.
íí 
IsNullOrEmpty
íí )
(
íí) *
campaign
íí* 2
.
íí2 3
Assets
íí3 9
.
íí9 :
LiveSeedFile
íí: F
)
ííF G
)
ííG H
{
ìì 
campaign
îî 
.
îî 
Assets
îî #
.
îî# $
LiveSeedUrl
îî$ /
=
îî0 1
FileManager
îî2 =
.
îî= >
GetFilePathLive
îî> M
(
îîM N
UploadFileType
îîN \
.
îî\ ]
LiveSeedFile
îî] i
,
îîi j
campaign
ïï  
.
ïï  !
OrderNumber
ïï! ,
)
ïï, -
;
ïï- .
campaign
ññ 
.
ññ 
Assets
ññ #
.
ññ# $
LiveSeedStatus
ññ$ 2
=
ññ3 4
(
ññ5 6
int
ññ6 9
)
ññ9 :
UploadFileStatus
ññ; K
.
ññK L
	Completed
ññL U
;
ññU V
	LogHelper
óó 
.
óó 
AddLog
óó $
(
óó$ %
db
óó% '
,
óó' (
LogType
óó) 0
.
óó0 1
FileProcessing
óó1 ?
,
óó? @
orderNumber
óóA L
,
óóL M
$str
òò 2
+
òò3 4
campaign
òò5 =
.
òò= >
Assets
òò> D
.
òòD E
LiveSeedUrl
òòE P
+
òòQ R
$str
òòS _
+
òò` a
System
ôô 
.
ôô 
Enum
ôô #
.
ôô# $
GetName
ôô$ +
(
ôô+ ,
typeof
ôô, 2
(
ôô2 3
UploadFileStatus
ôô3 C
)
ôôC D
,
ôôD E
campaign
ôôF N
.
ôôN O
Assets
ôôO U
.
ôôU V
LiveSeedStatus
ôôV d
)
ôôd e
)
ôôe f
;
ôôf g
}
öö 
if
ùù 
(
ùù 
!
ùù 
string
ùù 
.
ùù 
IsNullOrEmpty
ùù )
(
ùù) *
campaign
ùù* 2
.
ùù2 3
Assets
ùù3 9
.
ùù9 :
SuppressionFile
ùù: I
)
ùùI J
)
ùùJ K
{
ûû 
campaign
üü 
.
üü 
Assets
üü #
.
üü# $
SuppressionUrl
üü$ 2
=
üü3 4
FileManager
üü5 @
.
üü@ A
GetFilePathLive
üüA P
(
üüP Q
UploadFileType
üüQ _
.
üü_ `
SuppressionFile
üü` o
,
üüo p
campaign
††  
.
††  !
OrderNumber
††! ,
)
††, -
;
††- .
campaign
°° 
.
°° 
Assets
°° #
.
°°# $
SuppressionStatus
°°$ 5
=
°°6 7
(
°°8 9
int
°°9 <
)
°°< =
UploadFileStatus
°°> N
.
°°N O
	Completed
°°O X
;
°°X Y
	LogHelper
¢¢ 
.
¢¢ 
AddLog
¢¢ $
(
¢¢$ %
db
¢¢% '
,
¢¢' (
LogType
¢¢) 0
.
¢¢0 1
FileProcessing
¢¢1 ?
,
¢¢? @
orderNumber
¢¢A L
,
¢¢L M
$str
££ 5
+
££6 7
campaign
££8 @
.
££@ A
Assets
££A G
.
££G H
SuppressionUrl
££H V
+
££W X
$str
££Y e
+
££f g
System
§§ 
.
§§ 
Enum
§§ #
.
§§# $
GetName
§§$ +
(
§§+ ,
typeof
§§, 2
(
§§2 3
UploadFileStatus
§§3 C
)
§§C D
,
§§D E
campaign
§§F N
.
§§N O
Assets
§§O U
.
§§U V
SuppressionStatus
§§V g
)
§§g h
)
§§h i
;
§§i j
}
•• 
db
¶¶ 
.
¶¶ 
SaveChanges
¶¶ 
(
¶¶ 
)
¶¶  
;
¶¶  !
if
©© 
(
©© 
!
©© 
string
©© 
.
©© 
IsNullOrEmpty
©© )
(
©©) *
campaign
©©* 2
.
©©2 3
Assets
©©3 9
.
©©9 :
BannersFile
©©: E
)
©©E F
)
©©F G
{
™™ 
campaign
´´ 
.
´´ 
Assets
´´ #
.
´´# $

BannersUrl
´´$ .
=
´´/ 0
FileManager
´´1 <
.
´´< =
GetFilePathLive
´´= L
(
´´L M
UploadFileType
´´M [
.
´´[ \
BannersFile
´´\ g
,
´´g h
campaign
¨¨  
.
¨¨  !
OrderNumber
¨¨! ,
,
¨¨, -
Path
¨¨. 2
.
¨¨2 3
GetExtension
¨¨3 ?
(
¨¨? @
campaign
¨¨@ H
.
¨¨H I
Assets
¨¨I O
.
¨¨O P
BannersFile
¨¨P [
)
¨¨[ \
)
¨¨\ ]
;
¨¨] ^
campaign
≠≠ 
.
≠≠ 
Assets
≠≠ #
.
≠≠# $
BannersStatus
≠≠$ 1
=
≠≠2 3
(
≠≠4 5
int
≠≠5 8
)
≠≠8 9
UploadFileStatus
≠≠9 I
.
≠≠I J
	Completed
≠≠J S
;
≠≠S T
	LogHelper
ÆÆ 
.
ÆÆ 
AddLog
ÆÆ $
(
ÆÆ$ %
db
ÆÆ% '
,
ÆÆ' (
LogType
ÆÆ) 0
.
ÆÆ0 1
FileProcessing
ÆÆ1 ?
,
ÆÆ? @
orderNumber
ÆÆA L
,
ÆÆL M
$str
ØØ 1
+
ØØ2 3
campaign
ØØ4 <
.
ØØ< =
Assets
ØØ= C
.
ØØC D

BannersUrl
ØØD N
+
ØØO P
$str
ØØQ ]
+
ØØ^ _
System
∞∞ 
.
∞∞ 
Enum
∞∞ #
.
∞∞# $
GetName
∞∞$ +
(
∞∞+ ,
typeof
∞∞, 2
(
∞∞2 3
UploadFileStatus
∞∞3 C
)
∞∞C D
,
∞∞D E
campaign
∞∞F N
.
∞∞N O
Assets
∞∞O U
.
∞∞U V
BannersStatus
∞∞V c
)
∞∞c d
)
∞∞d e
;
∞∞e f
}
±± 
if
¥¥ 
(
¥¥ 
!
¥¥ 
string
¥¥ 
.
¥¥ 
IsNullOrEmpty
¥¥ )
(
¥¥) *
campaign
¥¥* 2
.
¥¥2 3
Assets
¥¥3 9
.
¥¥9 :
BannerLinksFile
¥¥: I
)
¥¥I J
)
¥¥J K
{
µµ 
campaign
∂∂ 
.
∂∂ 
Assets
∂∂ #
.
∂∂# $
BannerLinksUrl
∂∂$ 2
=
∂∂3 4
FileManager
∂∂5 @
.
∂∂@ A
GetFilePathLive
∂∂A P
(
∂∂P Q
UploadFileType
∂∂Q _
.
∂∂_ `
BannersLinksFile
∂∂` p
,
∂∂p q
campaign
∑∑ 
.
∑∑  
OrderNumber
∑∑  +
,
∑∑+ ,
Path
∑∑- 1
.
∑∑1 2
GetExtension
∑∑2 >
(
∑∑> ?
campaign
∑∑? G
.
∑∑G H
Assets
∑∑H N
.
∑∑N O
BannerLinksFile
∑∑O ^
)
∑∑^ _
)
∑∑_ `
;
∑∑` a
campaign
∏∏ 
.
∏∏ 
Assets
∏∏ #
.
∏∏# $
BannerLinksStatus
∏∏$ 5
=
∏∏6 7
(
∏∏8 9
int
∏∏9 <
)
∏∏< =
UploadFileStatus
∏∏= M
.
∏∏M N
	Completed
∏∏N W
;
∏∏W X
	LogHelper
ππ 
.
ππ 
AddLog
ππ $
(
ππ$ %
db
ππ% '
,
ππ' (
LogType
ππ) 0
.
ππ0 1
FileProcessing
ππ1 ?
,
ππ? @
orderNumber
ππA L
,
ππL M
$str
∫∫ 5
+
∫∫6 7
campaign
∫∫8 @
.
∫∫@ A
Assets
∫∫A G
.
∫∫G H
BannerLinksUrl
∫∫H V
+
∫∫W X
$str
∫∫Y e
+
∫∫f g
System
ªª 
.
ªª 
Enum
ªª #
.
ªª# $
GetName
ªª$ +
(
ªª+ ,
typeof
ªª, 2
(
ªª2 3
UploadFileStatus
ªª3 C
)
ªªC D
,
ªªD E
campaign
ªªF N
.
ªªN O
Assets
ªªO U
.
ªªU V
BannerLinksStatus
ªªV g
)
ªªg h
)
ªªh i
;
ªªi j
}
ºº 
if
øø 
(
øø 
!
øø 
string
øø 
.
øø 
IsNullOrEmpty
øø )
(
øø) *
campaign
øø* 2
.
øø2 3
Assets
øø3 9
.
øø9 :
MiscFile
øø: B
)
øøB C
)
øøC D
{
¿¿ 
campaign
¡¡ 
.
¡¡ 
Assets
¡¡ #
.
¡¡# $
MiscUrl
¡¡$ +
=
¡¡, -
FileManager
¡¡. 9
.
¡¡9 :
GetFilePathLive
¡¡: I
(
¡¡I J
UploadFileType
¡¡J X
.
¡¡X Y
MiscFile
¡¡Y a
,
¡¡a b
campaign
¬¬ 
.
¬¬  
OrderNumber
¬¬  +
,
¬¬+ ,
Path
¬¬- 1
.
¬¬1 2
GetExtension
¬¬2 >
(
¬¬> ?
campaign
¬¬? G
.
¬¬G H
Assets
¬¬H N
.
¬¬N O
MiscFile
¬¬O W
)
¬¬W X
)
¬¬X Y
;
¬¬Y Z
campaign
√√ 
.
√√ 
Assets
√√ #
.
√√# $

MiscStatus
√√$ .
=
√√/ 0
(
√√1 2
int
√√2 5
)
√√5 6
UploadFileStatus
√√6 F
.
√√F G
	Completed
√√G P
;
√√P Q
	LogHelper
ƒƒ 
.
ƒƒ 
AddLog
ƒƒ $
(
ƒƒ$ %
db
ƒƒ% '
,
ƒƒ' (
LogType
ƒƒ) 0
.
ƒƒ0 1
FileProcessing
ƒƒ1 ?
,
ƒƒ? @
orderNumber
ƒƒA L
,
ƒƒL M
$str
≈≈ .
+
≈≈/ 0
campaign
≈≈1 9
.
≈≈9 :
Assets
≈≈: @
.
≈≈@ A
MiscUrl
≈≈A H
+
≈≈I J
$str
≈≈K W
+
≈≈X Y
System
∆∆ 
.
∆∆ 
Enum
∆∆ #
.
∆∆# $
GetName
∆∆$ +
(
∆∆+ ,
typeof
∆∆, 2
(
∆∆2 3
UploadFileStatus
∆∆3 C
)
∆∆C D
,
∆∆D E
campaign
∆∆F N
.
∆∆N O
Assets
∆∆O U
.
∆∆U V

MiscStatus
∆∆V `
)
∆∆` a
)
∆∆a b
;
∆∆b c
}
«« 
}
»» 
}
…… 	
}
   
}ÀÀ à8
ME:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\Helpers\FileUploader.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Async !
.! "
Helpers" )
{ 
public 

class 
FileUploader 
{		 
private

 
string

 
_ftpUsername

 #
;

# $
private 
string 
_ftpPassword #
;# $
private 
string 
_baseUrl 
;  
private 
string 
_serverPrefix $
=% &
$str' L
;L M
public 
FileUploader 
( 
) 
{ 	
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 <
]< =
==> @
nullA E
)E F
throw 
new 
AdsException &
(& '
$str' A
)A B
;B C
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 >
]> ?
==@ B
nullC G
)G H
throw 
new 
AdsException &
(& '
$str' C
)C D
;D E
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 >
]> ?
==@ B
nullC G
)G H
throw 
new 
AdsException &
(& '
$str' C
)C D
;D E
var 
	ftpServer 
=  
ConfigurationManager 0
.0 1
AppSettings1 <
[< =
$str= H
]H I
;I J
_ftpUsername 
=  
ConfigurationManager /
./ 0
AppSettings0 ;
[; <
$str< I
]I J
;J K
_ftpPassword 
=  
ConfigurationManager /
./ 0
AppSettings0 ;
[; <
$str< I
]I J
;J K
_baseUrl 
= 
$" 
ftp:// 
{  
	ftpServer  )
}) *
/public_html/ep2/* ;
"; <
;< =
} 	
public 
bool 
DirectoryExists #
(# $
string$ *
directoryPath+ 8
)8 9
{ 	
bool   
directoryExists    
;    !
var!! 
request!! 
=!! 
(!! 
FtpWebRequest!! (
)!!( )

WebRequest!!) 3
.!!3 4
Create!!4 :
(!!: ;
directoryPath!!; H
+!!I J
$str!!K N
)!!N O
;!!O P
request"" 
."" 
Method"" 
="" 
WebRequestMethods"" .
."". /
Ftp""/ 2
.""2 3
ListDirectory""3 @
;""@ A
request## 
.## 
Credentials## 
=##  !
new##" %
NetworkCredential##& 7
(##7 8
_ftpUsername##8 D
,##D E
_ftpPassword##F R
)##R S
;##S T
try$$ 
{%% 
using&& 
(&& 
request&& 
.&& 
GetResponse&& *
(&&* +
)&&+ ,
)&&, -
{'' 
directoryExists(( #
=(($ %
true((& *
;((* +
})) 
}** 
catch++ 
(++ 
WebException++ 
ex++  "
)++" #
{,, 
directoryExists-- 
=--  !
false--" '
;--' (
}.. 
return// 
directoryExists// "
;//" #
}00 	
public22 
void22 
CreateDirectory22 #
(22# $
string22$ *
directoryName22+ 8
)228 9
{33 	
string44 
directoryPath44  
=44! "
_baseUrl44# +
+44, -
directoryName44. ;
;44; <
if66 
(66 
DirectoryExists66 
(66 
directoryPath66 ,
)66, -
)66- .
return66/ 5
;665 6

WebRequest88 
request88 
=88  

WebRequest88! +
.88+ ,
Create88, 2
(882 3
directoryPath883 @
)88@ A
;88A B
request99 
.99 
Method99 
=99 
WebRequestMethods99 .
.99. /
Ftp99/ 2
.992 3
MakeDirectory993 @
;99@ A
request:: 
.:: 
Credentials:: 
=::  !
new::" %
NetworkCredential::& 7
(::7 8
_ftpUsername::8 D
,::D E
_ftpPassword::F R
)::R S
;::S T
try;; 
{<< 
var== 
resp== 
=== 
(== 
FtpWebResponse== *
)==* +
request==, 3
.==3 4
GetResponse==4 ?
(==? @
)==@ A
;==A B
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
}BB 
}CC 	
publicEE 
stringEE 
UploadEE 
(EE 
stringEE #
directoryNameEE$ 1
,EE1 2
stringEE3 9
fileNameEE: B
,EEB C
stringEED J
filePathEEK S
)EES T
{FF 	
usingGG 
(GG 
	WebClientGG 
clientGG #
=GG$ %
newGG& )
	WebClientGG* 3
(GG3 4
)GG4 5
)GG5 6
{HH 
clientII 
.II 
CredentialsII "
=II# $
newII% (
NetworkCredentialII) :
(II: ;
_ftpUsernameII; G
,IIG H
_ftpPasswordIII U
)IIU V
;IIV W
stringJJ 
filePathFtpJJ "
=JJ# $
$"JJ% '
{JJ' (
_baseUrlJJ( 0
}JJ0 1
{JJ1 2
directoryNameJJ2 ?
}JJ? @
/JJ@ A
{JJA B
fileNameJJB J
}JJJ K
"JJK L
;JJL M
UriKK 
addressKK 
=KK 
newKK !
UriKK" %
(KK% &
filePathFtpKK& 1
)KK1 2
;KK2 3
clientLL 
.LL 

UploadFileLL !
(LL! "
addressLL" )
,LL) *
filePathLL+ 3
)LL3 4
;LL4 5
stringMM 
filePathLiveMM #
=MM$ %
$"MM& (
{MM( )
_serverPrefixMM) 6
}MM6 7
{MM7 8
directoryNameMM8 E
}MME F
/MMF G
{MMG H
fileNameMMH P
}MMP Q
"MMQ R
;MMR S
returnNN 
filePathLiveNN #
;NN# $
}OO 
}PP 	
}QQ 
}RR ¸N
FE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\ImageHelper.cs
	namespace		 	
ADSDataDirect		
 
.		 
Web		 
.		 
Helpers		 #
{

 
public 

class 
ImageHelper 
{ 
private 
string 
_url 
; 
private 
string 
	_filePath  
;  !
public 
ImageHelper 
( 
string !
url" %
,% &
string' -
filePath. 6
)6 7
{ 	
_url 
= 
url 
; 
	_filePath 
= 
filePath  
;  !
} 	
public 
void 
Capture 
( 
) 
{ 	
Thread 
thread 
= 
new 
Thread  &
(& '
delegate' /
(0 1
)1 2
{ 
using 
( 

WebBrowser !
browser" )
=* +
new, /

WebBrowser0 :
(: ;
); <
)< =
{ 
browser 
. 
ScrollBarsEnabled -
=. /
false0 5
;5 6
browser 
. 
AllowNavigation +
=, -
true. 2
;2 3
browser 
. "
ScriptErrorsSuppressed 2
=3 4
true5 9
;9 :
browser 
. 
Navigate $
($ %
_url% )
)) *
;* +
browser!! 
.!! 
DocumentCompleted!! -
+=!!. 0
new!!1 43
'WebBrowserDocumentCompletedEventHandler!!5 \
(!!\ ]
DocumentCompleted!!] n
)!!n o
;!!o p
while"" 
("" 
browser"" "
.""" #

ReadyState""# -
!="". 0 
WebBrowserReadyState""1 E
.""E F
Complete""F N
)""N O
{## 
System$$ 
.$$ 
Windows$$ &
.$$& '
Forms$$' ,
.$$, -
Application$$- 8
.$$8 9
DoEvents$$9 A
($$A B
)$$B C
;$$C D
}%% 
}&& 
}'' 
)'' 
;'' 
thread(( 
.(( 
SetApartmentState(( $
((($ %
ApartmentState((% 3
.((3 4
STA((4 7
)((7 8
;((8 9
thread)) 
.)) 
Start)) 
()) 
))) 
;)) 
thread** 
.** 
Join** 
(** 
)** 
;** 
}++ 	
private-- 
void-- 
DocumentCompleted-- &
(--& '
object--' -
sender--. 4
,--4 50
$WebBrowserDocumentCompletedEventArgs--6 Z
e--[ \
)--\ ]
{.. 	

WebBrowser// 
wb// 
=// 
sender// "
as//# %

WebBrowser//& 0
;//0 1
if00 
(00 
!00 
wb00 
.00 
Document00 
.00 
Title00 "
.00" #
Equals00# )
(00) *
$str00* >
)00> ?
)00? @
{11 
int22 
scrollWidth22 
=22  !
$num22" #
;22# $
int33 
scrollHeight33  
=33! "
$num33# $
;33$ %
scrollHeight55 
=55 
wb55 !
.55! "
Document55" *
.55* +
Body55+ /
.55/ 0
ScrollRectangle550 ?
.55? @
Height55@ F
;55F G
scrollWidth66 
=66 
wb66  
.66  !
Document66! )
.66) *
Body66* .
.66. /
ScrollRectangle66/ >
.66> ?
Width66? D
;66D E
wb77 
.77 
Size77 
=77 
new77 
Size77 "
(77" #
scrollWidth77# .
,77. /
scrollHeight770 <
)77< =
;77= >
Bitmap:: 
bitmap:: 
=:: 
new::  #
Bitmap::$ *
(::* +
wb::+ -
.::- .
Width::. 3
,::3 4
wb::5 7
.::7 8
Height::8 >
)::> ?
;::? @
for;; 
(;; 
int;; 
xcount;; 
=;;  !
$num;;" #
;;;# $
xcount;;% +
<;;, -
bitmap;;. 4
.;;4 5
Width;;5 :
;;;: ;
xcount;;< B
++;;B D
);;D E
for<< 
(<< 
int<< 
ycount<< #
=<<$ %
$num<<& '
;<<' (
ycount<<) /
<<<0 1
bitmap<<2 8
.<<8 9
Height<<9 ?
;<<? @
ycount<<A G
++<<G I
)<<I J
bitmap== 
.== 
SetPixel== '
(==' (
xcount==( .
,==. /
ycount==0 6
,==6 7
Color==8 =
.=== >
Black==> C
)==C D
;==D E
wb>> 
.>> 
DrawToBitmap>> 
(>>  
bitmap>>  &
,>>& '
new>>( +
	Rectangle>>, 5
(>>5 6
$num>>6 7
,>>7 8
$num>>9 :
,>>: ;
wb>>< >
.>>> ?
Width>>? D
,>>D E
wb>>F H
.>>H I
Height>>I O
)>>O P
)>>P Q
;>>Q R
bitmap?? 
.?? 
Save?? 
(?? 
	_filePath?? %
,??% &
ImageFormat??' 2
.??2 3
Png??3 6
)??6 7
;??7 8
}@@ 
}AA 	
publicBB 
staticBB 
stringBB 
GetCapturedImageBB -
(BB- .
stringBB. 4
urlBB5 8
,BB8 9
stringBB: @
filePathBBA I
)BBI J
{CC 	
tryDD 
{EE 
HttpWebRequestFF 
requestFF &
=FF' (
HttpWebRequestFF) 7
.FF7 8
CreateFF8 >
(FF> ?
urlFF? B
)FFB C
asFFD F
HttpWebRequestFFG U
;FFU V
BitmapGG 
bitmapGG 
;GG 
usingHH 
(HH 
StreamHH 
streamHH $
=HH% &
requestHH' .
.HH. /
GetResponseHH/ :
(HH: ;
)HH; <
.HH< =
GetResponseStreamHH= N
(HHN O
)HHO P
)HHP Q
{II 
bitmapJJ 
=JJ 
newJJ  
BitmapJJ! '
(JJ' (
streamJJ( .
)JJ. /
;JJ/ 0
bitmapKK 
.KK 
SaveKK 
(KK  
filePathKK  (
)KK( )
;KK) *
}LL 
}MM 
catchNN 
(NN 
	ExceptionNN 
exNN 
)NN  
{OO 
}QQ 
returnRR 
filePathRR 
;RR 
}SS 	
publicUU 
voidUU 
ResizeImageUU 
(UU  
stringUU  &
originalFileUU' 3
,UU3 4
stringUU5 ;
newFileUU< C
,UUC D
intUUE H
newWidthUUI Q
,UUQ R
intUUS V
	maxHeightUUW `
,UU` a
boolUUb f
onlyResizeIfWiderUUg x
)UUx y
{VV 	
SystemWW 
.WW 
DrawingWW 
.WW 
ImageWW  
fullsizeImageWW! .
=WW/ 0
SystemWW1 7
.WW7 8
DrawingWW8 ?
.WW? @
ImageWW@ E
.WWE F
FromFileWWF N
(WWN O
originalFileWWO [
)WW[ \
;WW\ ]
fullsizeImageZZ 
.ZZ 

RotateFlipZZ $
(ZZ$ %
SystemZZ% +
.ZZ+ ,
DrawingZZ, 3
.ZZ3 4
RotateFlipTypeZZ4 B
.ZZB C
Rotate180FlipNoneZZC T
)ZZT U
;ZZU V
fullsizeImage[[ 
.[[ 

RotateFlip[[ $
([[$ %
System[[% +
.[[+ ,
Drawing[[, 3
.[[3 4
RotateFlipType[[4 B
.[[B C
Rotate180FlipNone[[C T
)[[T U
;[[U V
if]] 
(]] 
onlyResizeIfWider]] !
&&]]" $
fullsizeImage]]% 2
.]]2 3
Width]]3 8
<=]]9 ;
newWidth]]< D
)]]D E
newWidth^^ 
=^^ 
fullsizeImage^^ (
.^^( )
Width^^) .
;^^. /
int`` 
	newHeight`` 
=`` 
fullsizeImage`` )
.``) *
Height``* 0
*``1 2
newWidth``3 ;
/``< =
fullsizeImage``> K
.``K L
Width``L Q
;``Q R
ifaa 
(aa 
	newHeightaa 
>aa 
	maxHeightaa %
)aa% &
{bb 
newWidthdd 
=dd 
fullsizeImagedd (
.dd( )
Widthdd) .
*dd/ 0
	maxHeightdd1 :
/dd; <
fullsizeImagedd= J
.ddJ K
HeightddK Q
;ddQ R
	newHeightee 
=ee 
	maxHeightee %
;ee% &
}ff 
Systemhh 
.hh 
Drawinghh 
.hh 
Imagehh  
newImagehh! )
=hh* +
fullsizeImagehh, 9
.hh9 :
GetThumbnailImagehh: K
(hhK L
newWidthhhL T
,hhT U
	newHeighthhV _
,hh_ `
nullhha e
,hhe f
IntPtrhhg m
.hhm n
Zerohhn r
)hhr s
;hhs t
fullsizeImagekk 
.kk 
Disposekk !
(kk! "
)kk" #
;kk# $
newImagenn 
.nn 
Savenn 
(nn 
newFilenn !
)nn! "
;nn" #
}oo 	
}pp 
}qq ê
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\KeyGenerator.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
KeyGenerator 
{ 
public 
static 
string 
GetUniqueKey )
() *
int* -
maxSize. 5
)5 6
{		 	
char

 
[

 
]

 
chars

 
=

 
new

 
char

 #
[

# $
$num

$ &
]

& '
;

' (
chars 
= 
$str :
.: ;
ToCharArray; F
(F G
)G H
;H I
byte 
[ 
] 
data 
= 
new 
byte "
[" #
$num# $
]$ %
;% &
using 
( $
RNGCryptoServiceProvider +
crypto, 2
=3 4
new5 8$
RNGCryptoServiceProvider9 Q
(Q R
)R S
)S T
{ 
crypto 
. 
GetNonZeroBytes &
(& '
data' +
)+ ,
;, -
data 
= 
new 
byte 
[  
maxSize  '
]' (
;( )
crypto 
. 
GetNonZeroBytes &
(& '
data' +
)+ ,
;, -
} 
StringBuilder 
result  
=! "
new# &
StringBuilder' 4
(4 5
maxSize5 <
)< =
;= >
foreach 
( 
byte 
b 
in 
data #
)# $
{ 
result 
. 
Append 
( 
chars #
[# $
b$ %
%& '
(( )
chars) .
.. /
Length/ 5
)5 6
]6 7
)7 8
;8 9
} 
return 
result 
. 
ToString "
(" #
)# $
;$ %
} 	
} 
} ÷
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\ListExtensions.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

static 
class 
ListExtensions &
{ 
public		 
static		 
DataSet		 
	ToDataSet		 '
<		' (
T		( )
>		) *
(		* +
this		+ /
IList		0 5
<		5 6
T		6 7
>		7 8
list		9 =
)		= >
{

 	
var 
ds 
= 
new 
DataSet  
(  !
)! "
;" #
ds 
. 
Tables 
. 
Add 
( 
list 
. 
ToDataTable *
(* +
)+ ,
), -
;- .
return 
ds 
; 
} 	
public 
static 
	DataTable 
ToDataTable  +
<+ ,
T, -
>- .
(. /
this/ 3
IList4 9
<9 :
T: ;
>; <
list= A
)A B
{ 	
Type 
elementType 
= 
typeof %
(% &
T& '
)' (
;( )
	DataTable 
t 
= 
new 
	DataTable '
(' (
)( )
;) *
foreach 
( 
var 
propInfo !
in" $
elementType% 0
.0 1
GetProperties1 >
(> ?
)? @
)@ A
{ 
Type 
colType 
= 
Nullable '
.' (
GetUnderlyingType( 9
(9 :
propInfo: B
.B C
PropertyTypeC O
)O P
??Q S
propInfoT \
.\ ]
PropertyType] i
;i j
t 
. 
Columns 
. 
Add 
( 
propInfo &
.& '
Name' +
,+ ,
colType- 4
)4 5
;5 6
} 
foreach 
( 
T 
item 
in 
list #
)# $
{ 
DataRow   
row   
=   
t   
.    
NewRow    &
(  & '
)  ' (
;  ( )
foreach"" 
("" 
var"" 
propInfo"" %
in""& (
elementType"") 4
.""4 5
GetProperties""5 B
(""B C
)""C D
)""D E
{## 
row$$ 
[$$ 
propInfo$$  
.$$  !
Name$$! %
]$$% &
=$$' (
propInfo$$) 1
.$$1 2
GetValue$$2 :
($$: ;
item$$; ?
,$$? @
null$$A E
)$$E F
??$$G I
DBNull$$J P
.$$P Q
Value$$Q V
;$$V W
}%% 
t'' 
.'' 
Rows'' 
.'' 
Add'' 
('' 
row'' 
)'' 
;''  
}(( 
return)) 
t)) 
;)) 
}** 	
}++ 
}-- ÷
DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\LogHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
	LogHelper 
{ 
public		 
static		 
void		 
AddLog		 !
(		! "
WfpictContext		" /
db		0 2
,		2 3
LogType		4 ;
logType		< C
,		C D
string		E K
orderNumber		L W
,		W X
string		Y _
message		` g
)		g h
{

 	
Add 
( 
db 
, 
logType 
, 
	LogStatus &
.& '
Success' .
,. /
orderNumber0 ;
,; <
message= D
)D E
;E F
} 	
public 
static 
void 
AddError #
(# $
WfpictContext$ 1
db2 4
,4 5
LogType6 =
logType> E
,E F
stringG M
orderNumberN Y
,Y Z
string[ a
messageb i
)i j
{ 	
Add 
( 
db 
, 
logType 
, 
	LogStatus &
.& '
Error' ,
,, -
orderNumber. 9
,9 :
message; B
)B C
;C D
} 	
private 
static 
void 
Add 
(  
WfpictContext  -
db. 0
,0 1
LogType2 9
logType: A
,A B
	LogStatusC L
	logStatusM V
,V W
stringX ^
orderNumber_ j
,j k
stringl r
messages z
)z {
{ 	
db 
. 

SystemLogs 
. 
Add 
( 
new !
	SystemLog" +
(+ ,
), -
{ 
Id 
= 
Guid 
. 
NewGuid !
(! "
)" #
,# $
	CreatedAt 
= 
DateTime $
.$ %
Now% (
,( )
LogType 
= 
( 
int 
) 
logType &
,& '
	LogStatus 
= 
( 
int  
)  !
	logStatus! *
,* +
OrderNumber 
= 
orderNumber )
,) *
Message 
= 
message !
} 
) 
; 
db 
. 
SaveChanges 
( 
) 
; 
} 	
}   
}!! ë
RE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\MultipleButtonAttribute.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
Method% +
,+ ,
AllowMultiple- :
=; <
false= B
,B C
	InheritedD M
=N O
trueP T
)T U
]U V
public 

class #
MultipleButtonAttribute (
:) *'
ActionNameSelectorAttribute+ F
{		 
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
Argument 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
override 
bool 
IsValidName (
(( )
ControllerContext) :
controllerContext; L
,L M
stringN T

actionNameU _
,_ `

MethodInfoa k

methodInfol v
)v w
{ 	
var 
isValidName 
= 
false #
;# $
var 
keyValue 
= 
$" 
{ 
Name "
}" #
:# $
{$ %
Argument% -
}- .
". /
;/ 0
var 
value 
= 
controllerContext )
.) *

Controller* 4
.4 5
ValueProvider5 B
.B C
GetValueC K
(K L
keyValueL T
)T U
;U V
if 
( 
value 
!= 
null 
) 
{ 
controllerContext !
.! "

Controller" ,
., -
ControllerContext- >
.> ?
	RouteData? H
.H I
ValuesI O
[O P
NameP T
]T U
=V W
ArgumentX `
;` a
isValidName 
= 
true "
;" #
} 
return 
isValidName 
; 
} 	
} 
} û
WE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Hangfire\HangfireAuthorizationFilter.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Hangfire $
{ 
public 

class '
HangfireAuthorizationFilter ,
:- .)
IDashboardAuthorizationFilter/ L
{ 
public 
bool 
	Authorize 
( 
DashboardContext .
context/ 6
)6 7
{		 	
var 
owinContext 
= 
new !
OwinContext" -
(- .
context. 5
.5 6
GetOwinEnvironment6 H
(H I
)I J
)J K
;K L
return 
owinContext 
. 
Authentication -
.- .
User. 2
.2 3
Identity3 ;
.; <
Name< @
==A C
$strD Q
;Q R
} 	
} 
} œÑ
LE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\ProData\ProDataApiManager.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
ProData #
{ 
public 

static 
class 
ProDataApiManager )
{ 
private 
static 
string 
_urlTracking *
=+ ,
$str- t
;t u
private 
static 
string 
_urlCreateOrder -
=. /
$str0 x
;x y
private 
static 
string 
_prodataAuth *
=+ ,
$str- O
;O P
public 
static 
readonly 
string %
Success& -
=. /
$str0 9
;9 :
public 
static 
readonly 
string %
Error& +
=, -
$str. 5
;5 6
static 
readonly 
Random 
Random %
=& '
new( +
Random, 2
(2 3
)3 4
;4 5
public 
static 
void 
Load 
(  
)  !
{ 	
string 
json 
= 
File 
. 
ReadAllText *
(* +
$"+ -
C:\\resp.txt- 9
"9 :
): ;
;; <
ProDataResponse 
m 
= 
JsonConvert  +
.+ ,
DeserializeObject, =
<= >
ProDataResponse> M
>M N
(N O
jsonO S
)S T
;T U
} 	
public 
static 
ProDataResponse %
Create& ,
(, -
Campaign- 5
campaign6 >
,> ?
CampaignSegment@ O
segmentP W
,W X
stringY _
whiteLabelDomain` p
)p q
{   	
ProDataRequest!! 
request!! "
=!!# $
new!!% (
ProDataRequest!!) 7
(!!7 8
)!!8 9
{"" 
Io## 
=## 
campaign## 
.## 
OrderNumber## )
,##) *
CampaignName$$ 
=$$ 
campaign$$ '
.$$' (
Approved$$( 0
.$$0 1
CampaignName$$1 =
,$$= >
IsRebroadcast%% 
=%% 
campaign%%  (
.%%( )
Approved%%) 1
.%%1 2
ReBroadCast%%2 =
?%%> ?
$str%%@ C
:%%D E
$str%%F I
,%%I J

WhiteLabel&& 
=&& 
whiteLabelDomain&& -
,&&- .
CreativeUrl'' 
='' 
campaign'' &
.''& '
Assets''' -
.''- .
CreativeUrl''. 9
,''9 :
Quantity(( 
=(( 
campaign(( #
.((# $
Approved(($ ,
.((, -
Quantity((- 5
,((5 6
GeoType)) 
=)) 
$str)) &
,))& '
GeoUrl** 
=** 
campaign** !
.**! "
Assets**" (
.**( )

ZipCodeUrl**) 3
,**3 4

CtrPercent++ 
=++ 
$num++ "
,++" #
Subject,, 
=,, 
campaign,, "
.,," #
Approved,,# +
.,,+ ,
SubjectLine,,, 7
,,,7 8
FromName-- 
=-- 
campaign-- #
.--# $
Approved--$ ,
.--, -
FromLine--- 5
,--5 6
	FromEmail.. 
=.. 
campaign.. $
...$ %
RepresentativeEmail..% 8
,..8 9

DeployDate// 
=// 
campaign// %
.//% &
Approved//& .
.//. /

DeployDate/// 9
?//9 :
.//: ;
ToString//; C
(//C D
StringConstants//D S
.//S T 
DateTimeFormatDashes//T h
)//h i
,//i j
}00 
;00 
if22 
(22 
campaign22 
.22 
Approved22 !
.22! "
IsOpenPixel22" -
)22- .
{33 
request44 
.44 
IsOpenPixel44 #
=44$ %
$str44& )
;44) *
request55 
.55 
OpenPercent55 #
=55$ %
(55& '
double55' -
)55- .
campaign55. 6
.556 7
Approved557 ?
.55? @
	OpenGoals55@ I
/55J K
campaign55L T
.55T U
Approved55U ]
.55] ^
Quantity55^ f
;55f g
request66 
.66 
	OpenPixel66 !
=66" #
campaign66$ ,
.66, -
Approved66- 5
.665 6
OpenPixelUrl666 B
;66B C
}77 
else88 
request99 
.99 
IsOpenPixel99 #
=99$ %
$str99& )
;99) *
if;; 
(;; 
!;; 
string;; 
.;; 
IsNullOrEmpty;; %
(;;% &
segment;;& -
?;;- .
.;;. /
SegmentDataFileUrl;;/ A
);;A B
);;B C
{<< 
request== 
.== 

IsDataFile== "
===# $
$str==% (
;==( )
request>> 
.>> 
DataFileUrl>> #
=>>$ %
segment>>& -
.>>- .
SegmentDataFileUrl>>. @
;>>@ A
request?? 
.?? $
DataFileReplacementParam?? 0
=??1 2
segment??3 :
.??: ;
SegmentNumber??; H
;??H I
request@@ 
.@@ %
DataFileReplacementColumn@@ 1
=@@2 3
$str@@4 7
;@@7 8
requestAA 
.AA 
DataFileUniqueIpAA (
=AA) *
$strAA+ .
;AA. /
}BB 
elseCC 
requestDD 
.DD 

IsDataFileDD "
=DD# $
$strDD% (
;DD( )
returnFF 
CreateFF 
(FF 
requestFF !
)FF! "
;FF" #
}GG 	
privateII 
staticII 
ProDataResponseII &
CreateII' -
(II- .
ProDataRequestII. <
requestII= D
)IID E
{JJ 	
usingKK 
(KK 

HttpClientKK 
clientKK $
=KK% &
newKK' *

HttpClientKK+ 5
(KK5 6
)KK6 7
)KK7 8
{LL 
clientMM 
.MM 
TimeoutMM 
=MM  
TimeSpanMM! )
.MM) *
FromMinutesMM* 5
(MM5 6
$numMM6 7
)MM7 8
;MM8 9
clientNN 
.NN !
DefaultRequestHeadersNN ,
.NN, -
AddNN- 0
(NN0 1
$strNN1 E
,NNE F
_prodataAuthNNG S
)NNS T
;NNT U
varOO 
httpContentOO 
=OO  !
newOO" %
StringContentOO& 3
(OO3 4
requestOO4 ;
.OO; <
ToJsonOO< B
(OOB C
)OOC D
,OOD E
EncodingOOF N
.OON O
UTF8OOO S
,OOS T
$strOOU g
)OOg h
;OOh i
usingPP 
(PP 
HttpResponseMessagePP *
responsePP+ 3
=PP4 5
clientPP6 <
.PP< =
	PostAsyncPP= F
(PPF G
_urlCreateOrderPPG V
,PPV W
httpContentPPX c
)PPc d
.PPd e
ResultPPe k
)PPk l
usingQQ 
(QQ 
HttpContentQQ "
contentQQ# *
=QQ+ ,
responseQQ- 5
.QQ5 6
ContentQQ6 =
)QQ= >
{RR 
stringSS 
responseContentSS *
=SS+ ,
contentSS- 4
.SS4 5
ReadAsStringAsyncSS5 F
(SSF G
)SSG H
.SSH I
ResultSSI O
;SSO P
ProDataResponseTT #
proDataResponseTT$ 3
;TT3 4
tryUU 
{VV 
proDataResponseWW '
=WW( )
JsonConvertWW* 5
.WW5 6
DeserializeObjectWW6 G
<WWG H
ProDataResponseWWH W
>WWW X
(WWX Y
responseContentWWY h
)WWh i
;WWi j
}XX 
catchYY 
(YY 
	ExceptionYY $
exYY% '
)YY' (
{ZZ 
throw[[ 
new[[ !
AdsException[[" .
([[. /
$str[[/ u
)[[u v
;[[v w
}\\ 
return^^ 
proDataResponse^^ *
;^^* +
}__ 
}`` 
}aa 	
privateee 
staticee 
ProDataResponseee &
Fetchee' ,
(ee, -
stringee- 3
orderNumberee4 ?
)ee? @
{ff 	
ifgg 
(gg  
ConfigurationManagergg $
.gg$ %
AppSettingsgg% 0
[gg0 1
$strgg1 9
]gg9 :
==gg; =
$strgg> E
)ggE F
{hh 
orderNumberii 
=ii 
$strii $
;ii$ %
}jj 
ProDataResponsell 
proDataResponsell +
=ll, -
nullll. 2
;ll2 3
stringmm 
urlmm 
=mm 
stringmm 
.mm  
Formatmm  &
(mm& '
_urlTrackingmm' 3
,mm3 4
orderNumbermm5 @
)mm@ A
;mmA B
usingnn 
(nn 

HttpClientnn 
clientnn $
=nn% &
newnn' *

HttpClientnn+ 5
(nn5 6
)nn6 7
)nn7 8
{oo 
clientpp 
.pp 
Timeoutpp 
=pp  
TimeSpanpp! )
.pp) *
FromMinutespp* 5
(pp5 6
$numpp6 7
)pp7 8
;pp8 9
clientqq 
.qq !
DefaultRequestHeadersqq ,
.qq, -
Addqq- 0
(qq0 1
$strqq1 E
,qqE F
_prodataAuthqqG S
)qqS T
;qqT U
usingrr 
(rr 
HttpResponseMessagerr *
responserr+ 3
=rr4 5
clientrr6 <
.rr< =
GetAsyncrr= E
(rrE F
urlrrF I
)rrI J
.rrJ K
ResultrrK Q
)rrQ R
usingss 
(ss 
HttpContentss "
contentss# *
=ss+ ,
responsess- 5
.ss5 6
Contentss6 =
)ss= >
{tt 
stringuu 
responseContentuu *
=uu+ ,
contentuu- 4
.uu4 5
ReadAsStringAsyncuu5 F
(uuF G
)uuG H
.uuH I
ResultuuI O
;uuO P
tryvv 
{ww 
proDataResponsexx '
=xx( )
JsonConvertxx* 5
.xx5 6
DeserializeObjectxx6 G
<xxG H
ProDataResponsexxH W
>xxW X
(xxX Y
responseContentxxY h
)xxh i
;xxi j
proDataResponseyy '
.yy' (
ResponseStatusyy( 6
=yy7 8!
ProDataResponseStatusyy9 N
.yyN O
FoundyyO T
.yyT U
ToStringyyU ]
(yy] ^
)yy^ _
;yy_ `
}zz 
catch{{ 
({{ 
	Exception{{ $
ex{{% '
){{' (
{|| 
if}} 
(}} 
ex}} 
.}} 
Message}} &
.}}& '
ToLowerInvariant}}' 7
(}}7 8
)}}8 9
.}}9 :
Contains}}: B
(}}B C
$str}}C P
)}}P Q
)}}Q R
{~~ 
proDataResponse +
=, -
new. 1
ProDataResponse2 A
(A B
)B C
{
ÄÄ 
ResponseStatus
ÅÅ  .
=
ÅÅ/ 0#
ProDataResponseStatus
ÅÅ1 F
.
ÅÅF G
NotFound
ÅÅG O
.
ÅÅO P
ToString
ÅÅP X
(
ÅÅX Y
)
ÅÅY Z
,
ÅÅZ [
ResponseMessage
ÇÇ  /
=
ÇÇ0 1
$str
ÇÇ2 M
}
ÉÉ 
;
ÉÉ 
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 
proDataResponse
áá +
=
áá, -
new
áá. 1
ProDataResponse
áá2 A
(
ááA B
)
ááB C
{
àà 
ResponseStatus
ââ  .
=
ââ/ 0#
ProDataResponseStatus
ââ1 F
.
ââF G
Error
ââG L
.
ââL M
ToString
ââM U
(
ââU V
)
ââV W
,
ââW X
ResponseMessage
ää  /
=
ää0 1
$str
ää2 x
}
ãã 
;
ãã 
}
åå 
}
éé 
return
êê 
proDataResponse
êê *
;
êê* +
}
ëë 
}
íí 
}
ìì 	
public
ïï 
static
ïï 
void
ïï $
FetchAndUpdateProDatas
ïï 1
(
ïï1 2
WfpictContext
ïï2 ?
db
ïï@ B
,
ïïB C
string
ïïD J
orderNumber
ïïK V
)
ïïV W
{
ññ 	
var
óó 
logs
óó 
=
óó 
db
óó 
.
óó 

SystemLogs
óó $
.
óó$ %
Where
óó% *
(
óó* +
x
óó+ ,
=>
óó- /
x
óó0 1
.
óó1 2
OrderNumber
óó2 =
==
óó> @
orderNumber
óóA L
&&
óóM O
x
óóP Q
.
óóQ R
LogType
óóR Y
==
óóZ \
(
óó] ^
int
óó^ a
)
óóa b
LogType
óób i
.
óói j
ProData
óój q
)
óóq r
;
óór s
foreach
òò 
(
òò 
var
òò 
log
òò 
in
òò 
logs
òò  $
)
òò$ %
{
ôô 
db
öö 
.
öö 

SystemLogs
öö 
.
öö 
Remove
öö $
(
öö$ %
log
öö% (
)
öö( )
;
öö) *
}
õõ 
db
úú 
.
úú 
SaveChanges
úú 
(
úú 
)
úú 
;
úú 
	LogHelper
ûû 
.
ûû 
AddLog
ûû 
(
ûû 
db
ûû 
,
ûû  
LogType
ûû! (
.
ûû( )
ProData
ûû) 0
,
ûû0 1
orderNumber
ûû2 =
,
ûû= >
$"
üü "
Starting refresh at 
üü &
{
üü& '
DateTime
üü' /
.
üü/ 0
Now
üü0 3
}
üü3 4
"
üü5 6
)
üü6 7
;
üü7 8
	LogHelper
†† 
.
†† 
AddLog
†† 
(
†† 
db
†† 
,
††  
LogType
††! (
.
††( )
ProData
††) 0
,
††0 1
orderNumber
††2 =
,
††= >
$"
††? A#
Deleting Old ProData 
††A V
"
††V W
)
††W X
;
††X Y
var
¢¢ 
campagin
¢¢ 
=
¢¢ 
db
¢¢ 
.
¢¢ 
	Campaigns
¢¢ '
.
¢¢' (
FirstOrDefault
¢¢( 6
(
¢¢6 7
x
¢¢7 8
=>
¢¢9 ;
x
¢¢< =
.
¢¢= >
OrderNumber
¢¢> I
==
¢¢J L
orderNumber
¢¢M X
)
¢¢X Y
;
¢¢Y Z
var
££ 
proDatas
££ 
=
££ 
db
££ 
.
££ 
ProDatas
££ &
.
££& '
Where
££' ,
(
££, -
x
££- .
=>
££/ 1
x
££2 3
.
££3 4

CampaignId
££4 >
==
££? A
campagin
££B J
.
££J K
Id
££K M
)
££M N
;
££N O
foreach
§§ 
(
§§ 
var
§§ 
proData
§§  
in
§§! #
proDatas
§§$ ,
)
§§, -
{
•• 
db
¶¶ 
.
¶¶ 
ProDatas
¶¶ 
.
¶¶ 
Remove
¶¶ "
(
¶¶" #
proData
¶¶# *
)
¶¶* +
;
¶¶+ ,
}
ßß 
db
®® 
.
®® 
SaveChanges
®® 
(
®® 
)
®® 
;
®® 
var
™™ 
data
™™ 
=
™™ 
Fetch
™™ 
(
™™ 
orderNumber
™™ (
)
™™( )
;
™™) *
if
´´ 
(
´´ 
data
´´ 
.
´´ 
Reports
´´ 
!=
´´ 
null
´´  $
&&
´´% '
data
´´( ,
.
´´, -
Reports
´´- 4
.
´´4 5
Report
´´5 ;
!=
´´< >
null
´´? C
)
´´C D
{
¨¨ 
var
≠≠ 
reports
≠≠ 
=
≠≠ 
data
≠≠ "
.
≠≠" #
Reports
≠≠# *
.
≠≠* +
Report
≠≠+ 1
;
≠≠1 2
	LogHelper
ÆÆ 
.
ÆÆ 
AddLog
ÆÆ  
(
ÆÆ  !
db
ÆÆ! #
,
ÆÆ# $
LogType
ÆÆ% ,
.
ÆÆ, -
ProData
ÆÆ- 4
,
ÆÆ4 5
orderNumber
ÆÆ6 A
,
ÆÆA B
$"
ÆÆC E
{
ÆÆE F
reports
ÆÆF M
.
ÆÆM N
Length
ÆÆN T
}
ÆÆT U,
 records fetched from ProData 
ÆÆU s
"
ÆÆs t
)
ÆÆt u
;
ÆÆu v
foreach
ØØ 
(
ØØ 
var
ØØ 
report
ØØ #
in
ØØ$ &
reports
ØØ' .
)
ØØ. /
{
∞∞ 
db
±± 
.
±± 
ProDatas
±± 
.
±±  
Add
±±  #
(
±±# $
new
±±$ '
Core
±±( ,
.
±±, -
Entities
±±- 5
.
±±5 6
ProData
±±6 =
(
±±= >
)
±±> ?
{
≤≤ 
Id
≥≥ 
=
≥≥ 
Guid
≥≥ !
.
≥≥! "
NewGuid
≥≥" )
(
≥≥) *
)
≥≥* +
,
≥≥+ ,
	CreatedAt
¥¥ !
=
¥¥" #
DateTime
¥¥$ ,
.
¥¥, -
Now
¥¥- 0
,
¥¥0 1

CampaignId
µµ "
=
µµ# $
campagin
µµ% -
.
µµ- .
Id
µµ. 0
,
µµ0 1
CampaignName
∂∂ $
=
∂∂% &
report
∂∂' -
.
∂∂- .
CampaignName
∂∂. :
,
∂∂: ;
Reportsite_URL
∑∑ &
=
∑∑' (
report
∑∑) /
.
∑∑/ 0
ReportsiteUrl
∑∑0 =
,
∑∑= >
Destination_URL
∏∏ '
=
∏∏( )
report
∏∏* 0
.
∏∏0 1
DestinationUrl
∏∏1 ?
,
∏∏? @
CampaignStartDate
ππ )
=
ππ* +
report
ππ, 2
.
ππ2 3
CampaignStartDate
ππ3 D
,
ππD E

ClickCount
∫∫ "
=
∫∫# $
long
∫∫% )
.
∫∫) *
Parse
∫∫* /
(
∫∫/ 0
report
∫∫0 6
.
∫∫6 7

ClickCount
∫∫7 A
)
∫∫A B
,
∫∫B C
	UniqueCnt
ªª !
=
ªª" #
report
ªª$ *
.
ªª* +
	UniqueCnt
ªª+ 4
,
ªª4 5
	MobileCnt
ºº !
=
ºº" #
report
ºº$ *
.
ºº* +
	MobileCnt
ºº+ 4
,
ºº4 5
ImpressionCnt
ΩΩ %
=
ΩΩ& '
report
ΩΩ( .
.
ΩΩ. /
ImpressionCnt
ΩΩ/ <
,
ΩΩ< =
IO
ææ 
=
ææ 
report
ææ #
.
ææ# $
Io
ææ$ &
}
øø 
)
øø 
;
øø 
}
¿¿ 
db
¡¡ 
.
¡¡ 
SaveChanges
¡¡ 
(
¡¡ 
)
¡¡  
;
¡¡  !
	LogHelper
¬¬ 
.
¬¬ 
AddLog
¬¬  
(
¬¬  !
db
¬¬! #
,
¬¬# $
LogType
¬¬% ,
.
¬¬, -
ProData
¬¬- 4
,
¬¬4 5
orderNumber
¬¬6 A
,
¬¬A B
$"
¬¬B D0
"Refresh completed successfully at 
¬¬D f
{
¬¬f g
DateTime
¬¬g o
.
¬¬o p
Now
¬¬p s
}
¬¬s t
"
¬¬u v
)
¬¬v w
;
¬¬w x
}
√√ 
else
ƒƒ 
{
≈≈ 
	LogHelper
∆∆ 
.
∆∆ 
AddLog
∆∆  
(
∆∆  !
db
∆∆! #
,
∆∆# $
LogType
∆∆% ,
.
∆∆, -
ProData
∆∆- 4
,
∆∆4 5
orderNumber
∆∆6 A
,
∆∆A B
$"
∆∆C E 
Prodata response. 
∆∆E W
{
∆∆W X
data
∆∆X \
.
∆∆\ ]
ToJson
∆∆] c
(
∆∆c d
)
∆∆d e
}
∆∆e f
"
∆∆g h
)
∆∆h i
;
∆∆i j
throw
«« 
new
«« 
AdsException
«« &
(
««& '
$str
««' m
)
««m n
;
««n o
}
»» 
}
   	
public
ÃÃ 
static
ÃÃ 
void
ÃÃ %
FetchAndUpdateTrackings
ÃÃ 2
(
ÃÃ2 3
WfpictContext
ÃÃ3 @
db
ÃÃA C
,
ÃÃC D
Campaign
ÃÃE M
campaign
ÃÃN V
)
ÃÃV W
{
ÕÕ 	
	LogHelper
ŒŒ 
.
ŒŒ 
AddLog
ŒŒ 
(
ŒŒ 
db
ŒŒ 
,
ŒŒ  
LogType
ŒŒ! (
.
ŒŒ( )
ProData
ŒŒ) 0
,
ŒŒ0 1
campaign
ŒŒ2 :
.
ŒŒ: ;
OrderNumber
ŒŒ; F
,
ŒŒF G
$"
ŒŒH J"
Starting refresh at 
ŒŒJ ^
{
ŒŒ^ _
DateTime
ŒŒ_ g
.
ŒŒg h
Now
ŒŒh k
}
ŒŒk l
"
ŒŒm n
)
ŒŒn o
;
ŒŒo p
var
—— 
data
—— 
=
—— 
Fetch
—— 
(
—— 
campaign
—— %
.
——% &
OrderNumber
——& 1
)
——1 2
;
——2 3
SaveProData
““ 
(
““ 
db
““ 
,
““ 
campaign
““ $
.
““$ %
Id
““% '
,
““' (
campaign
““) 1
.
““1 2
OrderNumber
““2 =
,
““= >
string
““? E
.
““E F
Empty
““F K
,
““K L
data
““M Q
)
““Q R
;
““R S
var
”” 
campaignTracking
””  
=
””! "
UpdateTracking
””# 1
(
””1 2
db
””2 4
,
””4 5
campaign
””6 >
,
””> ?
campaign
””@ H
.
””H I
OrderNumber
””I T
,
””T U
string
””V \
.
””\ ]
Empty
””] b
,
””b c
data
””d h
)
””h i
;
””i j
SaveNotification
‘‘ 
(
‘‘ 
db
‘‘ 
,
‘‘  
campaign
‘‘! )
.
‘‘) *
Id
‘‘* ,
,
‘‘, -
campaign
‘‘. 6
.
‘‘6 7
OrderNumber
‘‘7 B
,
‘‘B C
string
‘‘D J
.
‘‘J K
Empty
‘‘K P
,
‘‘P Q
data
‘‘R V
.
‘‘V W
ResponseStatus
‘‘W e
,
‘‘e f
campaignTracking
‘‘g w
)
‘‘w x
;
‘‘x y
if
◊◊ 
(
◊◊ 
campaign
◊◊ 
.
◊◊ 
ReBroadcasted
◊◊ &
)
◊◊& '
{
ÿÿ 
var
ŸŸ 
data1
ŸŸ 
=
ŸŸ 
Fetch
ŸŸ !
(
ŸŸ! "
campaign
ŸŸ" *
.
ŸŸ* +&
ReBroadcastedOrderNumber
ŸŸ+ C
)
ŸŸC D
;
ŸŸD E
SaveProData
⁄⁄ 
(
⁄⁄ 
db
⁄⁄ 
,
⁄⁄ 
campaign
⁄⁄  (
.
⁄⁄( )
Id
⁄⁄) +
,
⁄⁄+ ,
campaign
⁄⁄- 5
.
⁄⁄5 6&
ReBroadcastedOrderNumber
⁄⁄6 N
,
⁄⁄N O
string
⁄⁄P V
.
⁄⁄V W
Empty
⁄⁄W \
,
⁄⁄\ ]
data1
⁄⁄^ c
)
⁄⁄c d
;
⁄⁄d e
var
€€ 
campaignTracking1
€€ %
=
€€& '
UpdateTracking
€€( 6
(
€€6 7
db
€€7 9
,
€€9 :
campaign
€€; C
,
€€C D
campaign
€€E M
.
€€M N&
ReBroadcastedOrderNumber
€€N f
,
€€f g
string
€€h n
.
€€n o
Empty
€€o t
,
€€t u
data1
€€v {
)
€€{ |
;
€€| }
SaveNotification
‹‹  
(
‹‹  !
db
‹‹! #
,
‹‹# $
campaign
‹‹% -
.
‹‹- .
Id
‹‹. 0
,
‹‹0 1
campaign
‹‹2 :
.
‹‹: ;&
ReBroadcastedOrderNumber
‹‹; S
,
‹‹S T
string
‹‹U [
.
‹‹[ \
Empty
‹‹\ a
,
‹‹a b
data1
‹‹c h
.
‹‹h i
ResponseStatus
‹‹i w
,
‹‹w x 
campaignTracking1‹‹y ä
)‹‹ä ã
;‹‹ã å
}
›› 
foreach
‡‡ 
(
‡‡ 
var
‡‡ 
segment
‡‡  
in
‡‡! #
campaign
‡‡$ ,
.
‡‡, -
Segments
‡‡- 5
.
‡‡5 6
Where
‡‡6 ;
(
‡‡; <
x
‡‡< =
=>
‡‡> @
x
‡‡A B
.
‡‡B C
SegmentStatus
‡‡C P
==
‡‡Q S
(
‡‡T U
int
‡‡U X
)
‡‡X Y
SegmentStatus
‡‡Y f
.
‡‡f g

Monitoring
‡‡g q
)
‡‡q r
)
‡‡r s
{
·· 
if
‚‚ 
(
‚‚ 
segment
‚‚ 
.
‚‚ 
SegmentStatus
‚‚ )
!=
‚‚* ,
(
‚‚- .
int
‚‚. 1
)
‚‚1 2
SegmentStatus
‚‚3 @
.
‚‚@ A

Monitoring
‚‚A K
)
‚‚K L
continue
‚‚M U
;
‚‚U V
var
‰‰ 
data1
‰‰ 
=
‰‰ 
Fetch
‰‰ !
(
‰‰! "
segment
‰‰" )
.
‰‰) *
SegmentNumber
‰‰* 7
)
‰‰7 8
;
‰‰8 9
SaveProData
ÂÂ 
(
ÂÂ 
db
ÂÂ 
,
ÂÂ 
campaign
ÂÂ  (
.
ÂÂ( )
Id
ÂÂ) +
,
ÂÂ+ ,
campaign
ÂÂ- 5
.
ÂÂ5 6
OrderNumber
ÂÂ6 A
,
ÂÂA B
segment
ÂÂC J
.
ÂÂJ K
SegmentNumber
ÂÂK X
,
ÂÂX Y
data1
ÂÂZ _
)
ÂÂ_ `
;
ÂÂ` a
var
ÊÊ 
campaignTracking1
ÊÊ %
=
ÊÊ& '
UpdateTracking
ÊÊ( 6
(
ÊÊ6 7
db
ÊÊ7 9
,
ÊÊ9 :
campaign
ÊÊ; C
,
ÊÊC D
campaign
ÊÊE M
.
ÊÊM N
OrderNumber
ÊÊN Y
,
ÊÊY Z
segment
ÊÊ[ b
.
ÊÊb c
SegmentNumber
ÊÊc p
,
ÊÊp q
data1
ÊÊr w
)
ÊÊw x
;
ÊÊx y
SaveNotification
ÁÁ  
(
ÁÁ  !
db
ÁÁ! #
,
ÁÁ# $
campaign
ÁÁ% -
.
ÁÁ- .
Id
ÁÁ. 0
,
ÁÁ0 1
campaign
ÁÁ2 :
.
ÁÁ: ;
OrderNumber
ÁÁ; F
,
ÁÁF G
segment
ÁÁH O
.
ÁÁO P
SegmentNumber
ÁÁP ]
,
ÁÁ] ^
data
ÁÁ_ c
.
ÁÁc d
ResponseStatus
ÁÁd r
,
ÁÁr s 
campaignTracking1ÁÁt Ö
)ÁÁÖ Ü
;ÁÁÜ á
}
ËË 
}
ÈÈ 	
private
ÎÎ 
static
ÎÎ 
void
ÎÎ 
SaveProData
ÎÎ '
(
ÎÎ' (
WfpictContext
ÎÎ( 5
db
ÎÎ6 8
,
ÎÎ8 9
Guid
ÎÎ: >
?
ÎÎ> ?

campaignId
ÎÎ@ J
,
ÎÎJ K
string
ÎÎL R
orderNumber
ÎÎS ^
,
ÎÎ^ _
string
ÎÎ` f
segmentNumber
ÎÎg t
,
ÎÎt u
ProDataResponseÎÎv Ö
dataÎÎÜ ä
)ÎÎä ã
{
ÏÏ 	
	LogHelper
ÓÓ 
.
ÓÓ 
AddLog
ÓÓ 
(
ÓÓ 
db
ÓÓ 
,
ÓÓ  
LogType
ÓÓ! (
.
ÓÓ( )
ProData
ÓÓ) 0
,
ÓÓ0 1
orderNumber
ÓÓ2 =
,
ÓÓ= >
$"
ÓÓ? A#
Deleting Old ProData 
ÓÓA V
"
ÓÓV W
)
ÓÓW X
;
ÓÓX Y
var
ÔÔ 
proDatas
ÔÔ 
=
ÔÔ 
db
ÔÔ 
.
ÔÔ 
ProDatas
ÔÔ &
.
ÔÔ& '
Where
ÔÔ' ,
(
ÔÔ, -
x
ÔÔ- .
=>
ÔÔ/ 1
x
ÔÔ2 3
.
ÔÔ3 4

CampaignId
ÔÔ4 >
==
ÔÔ? A

campaignId
ÔÔB L
&&
ÔÔM O
x
ÔÔP Q
.
ÔÔQ R
OrderNumber
ÔÔR ]
==
ÔÔ^ `
orderNumber
ÔÔa l
&&
ÔÔm o
x
ÔÔp q
.
ÔÔq r
SegmentNumber
ÔÔr 
==ÔÔÄ Ç
segmentNumberÔÔÉ ê
)ÔÔê ë
;ÔÔë í
foreach
 
(
 
var
 
proData
  
in
! #
proDatas
$ ,
)
, -
{
ÒÒ 
db
ÚÚ 
.
ÚÚ 
ProDatas
ÚÚ 
.
ÚÚ 
Remove
ÚÚ "
(
ÚÚ" #
proData
ÚÚ# *
)
ÚÚ* +
;
ÚÚ+ ,
}
ÛÛ 
db
ÙÙ 
.
ÙÙ 
SaveChanges
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
if
˜˜ 
(
˜˜ 
data
˜˜ 
.
˜˜ 
Reports
˜˜ 
!=
˜˜ 
null
˜˜  $
&&
˜˜% '
data
˜˜( ,
.
˜˜, -
Reports
˜˜- 4
.
˜˜4 5
Report
˜˜5 ;
!=
˜˜< >
null
˜˜? C
)
˜˜C D
{
¯¯ 
var
˘˘ 
reports
˘˘ 
=
˘˘ 
data
˘˘ "
.
˘˘" #
Reports
˘˘# *
.
˘˘* +
Report
˘˘+ 1
;
˘˘1 2
	LogHelper
˙˙ 
.
˙˙ 
AddLog
˙˙  
(
˙˙  !
db
˙˙! #
,
˙˙# $
LogType
˙˙% ,
.
˙˙, -
ProData
˙˙- 4
,
˙˙4 5
orderNumber
˙˙6 A
,
˙˙A B
$"
˙˙C E
{
˙˙E F
reports
˙˙F M
.
˙˙M N
Length
˙˙N T
}
˙˙T U,
 records fetched from ProData 
˙˙U s
"
˙˙s t
)
˙˙t u
;
˙˙u v
foreach
˚˚ 
(
˚˚ 
var
˚˚ 
report
˚˚ #
in
˚˚$ &
reports
˚˚' .
)
˚˚. /
{
¸¸ 
db
˝˝ 
.
˝˝ 
ProDatas
˝˝ 
.
˝˝  
Add
˝˝  #
(
˝˝# $
new
˝˝$ '
Core
˝˝( ,
.
˝˝, -
Entities
˝˝- 5
.
˝˝5 6
ProData
˝˝6 =
(
˝˝= >
)
˝˝> ?
{
˛˛ 
Id
ˇˇ 
=
ˇˇ 
Guid
ˇˇ !
.
ˇˇ! "
NewGuid
ˇˇ" )
(
ˇˇ) *
)
ˇˇ* +
,
ˇˇ+ ,
	CreatedAt
ÄÄ !
=
ÄÄ" #
DateTime
ÄÄ$ ,
.
ÄÄ, -
Now
ÄÄ- 0
,
ÄÄ0 1

CampaignId
ÅÅ "
=
ÅÅ# $

campaignId
ÅÅ% /
,
ÅÅ/ 0
OrderNumber
ÇÇ #
=
ÇÇ$ %
orderNumber
ÇÇ& 1
,
ÇÇ1 2
SegmentNumber
ÉÉ %
=
ÉÉ& '
segmentNumber
ÉÉ( 5
,
ÉÉ5 6
CampaignName
ÖÖ $
=
ÖÖ% &
report
ÖÖ' -
.
ÖÖ- .
CampaignName
ÖÖ. :
,
ÖÖ: ;
Reportsite_URL
ÜÜ &
=
ÜÜ' (
report
ÜÜ) /
.
ÜÜ/ 0
ReportsiteUrl
ÜÜ0 =
,
ÜÜ= >
Destination_URL
áá '
=
áá( )
report
áá* 0
.
áá0 1
DestinationUrl
áá1 ?
,
áá? @
CampaignStartDate
àà )
=
àà* +
report
àà, 2
.
àà2 3
CampaignStartDate
àà3 D
,
ààD E

ClickCount
ââ "
=
ââ# $
long
ââ% )
.
ââ) *
Parse
ââ* /
(
ââ/ 0
report
ââ0 6
.
ââ6 7

ClickCount
ââ7 A
)
ââA B
,
ââB C
	UniqueCnt
ää !
=
ää" #
report
ää$ *
.
ää* +
	UniqueCnt
ää+ 4
,
ää4 5
	MobileCnt
ãã !
=
ãã" #
report
ãã$ *
.
ãã* +
	MobileCnt
ãã+ 4
,
ãã4 5
ImpressionCnt
åå %
=
åå& '
report
åå( .
.
åå. /
ImpressionCnt
åå/ <
,
åå< =
IO
çç 
=
çç 
report
çç #
.
çç# $
Io
çç$ &
}
éé 
)
éé 
;
éé 
}
èè 
db
êê 
.
êê 
SaveChanges
êê 
(
êê 
)
êê  
;
êê  !
	LogHelper
ëë 
.
ëë 
AddLog
ëë  
(
ëë  !
db
ëë! #
,
ëë# $
LogType
ëë% ,
.
ëë, -
ProData
ëë- 4
,
ëë4 5
orderNumber
ëë6 A
,
ëëA B
$"
ëëC E0
"Refresh completed successfully at 
ëëE g
{
ëëg h
DateTime
ëëh p
.
ëëp q
Now
ëëq t
}
ëët u
"
ëëv w
)
ëëw x
;
ëëx y
}
íí 
}
îî 	
private
ññ 
static
ññ 
CampaignTracking
ññ '
UpdateTracking
ññ( 6
(
ññ6 7
WfpictContext
ññ7 D
db
ññE G
,
ññG H
Campaign
ññI Q
campaign
ññR Z
,
ññZ [
string
ññ\ b
orderNumber
ññc n
,
ññn o
string
ññp v
segmentNumberññw Ñ
,ññÑ Ö
ProDataResponseññÜ ï
datañññ ö
)ññö õ
{
óó 	
var
òò 
campaignTracking
òò  
=
òò! "
campaign
òò# +
.
òò+ ,
	Trackings
òò, 5
.
òò5 6
FirstOrDefault
òò6 D
(
òòD E
x
òòE F
=>
òòG I
x
òòJ K
.
òòK L
OrderNumber
òòL W
==
òòX Z
orderNumber
òò[ f
&&
òòg i
x
òòj k
.
òòk l
SegmentNumber
òòl y
==
òòz |
segmentNumberòò} ä
)òòä ã
;òòã å
if
õõ 
(
õõ 
campaignTracking
õõ  
==
õõ! #
null
õõ$ (
)
õõ( )
{
úú 
string
ùù 
orderNumberRdp
ùù %
;
ùù% &
long
ûû 
quantity
ûû 
;
ûû 
if
üü 
(
üü 
campaign
üü 
.
üü 
ReBroadcasted
üü *
)
üü* +
{
†† 
orderNumberRdp
°° "
=
°°# $
campaign
°°% -
.
°°- .&
ReBroadcastedOrderNumber
°°. F
;
°°F G
quantity
¢¢ 
=
¢¢ 
campaign
¢¢ '
.
¢¢' (#
ReBroadcastedQuantity
¢¢( =
;
¢¢= >
}
££ 
else
§§ 
{
•• 
orderNumberRdp
¶¶ "
=
¶¶# $
campaign
¶¶% -
.
¶¶- .
OrderNumber
¶¶. 9
;
¶¶9 :
quantity
ßß 
=
ßß 
campaign
ßß '
.
ßß' (
Approved
ßß( 0
.
ßß0 1
Quantity
ßß1 9
;
ßß9 :
}
®® 
var
©© 

trackingId
©© 
=
©©  
Guid
©©! %
.
©©% &
NewGuid
©©& -
(
©©- .
)
©©. /
;
©©/ 0
campaignTracking
™™  
=
™™! "
new
™™# &
CampaignTracking
™™' 7
(
™™7 8
)
™™8 9
{
´´ 
Id
¨¨ 
=
¨¨ 

trackingId
¨¨ #
,
¨¨# $
	CreatedAt
≠≠ 
=
≠≠ 
DateTime
≠≠  (
.
≠≠( )
Now
≠≠) ,
,
≠≠, -

CampaignId
ÆÆ 
=
ÆÆ  
campaign
ÆÆ! )
.
ÆÆ) *
Id
ÆÆ* ,
,
ÆÆ, -
OrderNumber
ØØ 
=
ØØ  !
orderNumberRdp
ØØ" 0
,
ØØ0 1
SegmentNumber
∞∞ !
=
∞∞" #
string
∞∞$ *
.
∞∞* +
Empty
∞∞+ 0
,
∞∞0 1
Quantity
±± 
=
±± 
quantity
±± '
,
±±' (
DateSent
≤≤ 
=
≤≤ 
DateTime
≤≤ '
.
≤≤' (
Now
≤≤( +
,
≤≤+ ,!
IsCreatedThroughApi
≥≥ '
=
≥≥( )
false
≥≥* /
}
¥¥ 
;
¥¥ 
db
µµ 
.
µµ 
CampaignTrackings
µµ $
.
µµ$ %
Add
µµ% (
(
µµ( )
campaignTracking
µµ) 9
)
µµ9 :
;
µµ: ;
db
∂∂ 
.
∂∂ 
SaveChanges
∂∂ 
(
∂∂ 
)
∂∂  
;
∂∂  !
}
∑∑ 
if
ππ 
(
ππ 
campaignTracking
ππ  
?
ππ  !
.
ππ! "
DateSent
ππ" *
==
ππ+ -
null
ππ. 2
||
ππ3 5
data
ππ6 :
.
ππ: ;
Reports
ππ; B
?
ππB C
.
ππC D
Report
ππD J
==
ππK M
null
ππN R
||
ππS U
data
ππV Z
.
ππZ [
Reports
ππ[ b
.
ππb c
Report
ππc i
.
ππi j
Length
ππj p
==
ππq s
$num
ππt u
)
ππu v
return
ππw }
campaignTrackingππ~ é
;ππé è
var
ªª 
reports
ªª 
=
ªª 
data
ªª 
.
ªª 
Reports
ªª &
.
ªª& '
Report
ªª' -
;
ªª- .
var
ºº 
report
ºº 
=
ºº 
reports
ºº  
[
ºº  !
$num
ºº! "
]
ºº" #
;
ºº# $
DateTime
ΩΩ 
startDateTime
ΩΩ "
;
ΩΩ" #
DateTime
ææ 
.
ææ 
TryParse
ææ 
(
ææ 
report
ææ $
.
ææ$ %
CampaignStartDate
ææ% 6
,
ææ6 7
out
ææ8 ;
startDateTime
ææ< I
)
ææI J
;
ææJ K
campaignTracking
øø 
.
øø 
IoNumber
øø %
=
øø& '
report
øø( .
.
øø. /
Io
øø/ 1
;
øø1 2
campaignTracking
¿¿ 
.
¿¿ 
	StartDate
¿¿ &
=
¿¿' (
startDateTime
¿¿) 6
;
¿¿6 7
campaignTracking
¡¡ 
.
¡¡ 
Opened
¡¡ #
=
¡¡$ %
campaign
¡¡& .
.
¡¡. /
Approved
¡¡/ 7
.
¡¡7 8!
IsUseApiDataForOpen
¡¡8 K
?
¡¡L M
report
¡¡N T
.
¡¡T U
ImpressionCnt
¡¡U b
:
¡¡c d
API
¡¡e h
.
¡¡h i
Campaign
¡¡i q
.
¡¡q r
GetOpens
¡¡r z
(
¡¡z {
campaignTracking¡¡{ ã
.¡¡ã å
Quantity¡¡å î
,¡¡î ï
startDateTime¡¡ñ £
)¡¡£ §
;¡¡§ •
campaignTracking
¬¬ 
.
¬¬ 
Clicked
¬¬ $
=
¬¬% &
reports
¬¬' .
.
¬¬. /
Sum
¬¬/ 2
(
¬¬2 3
x
¬¬3 4
=>
¬¬5 7
long
¬¬8 <
.
¬¬< =
Parse
¬¬= B
(
¬¬B C
x
¬¬C D
.
¬¬D E

ClickCount
¬¬E O
)
¬¬O P
)
¬¬P Q
;
¬¬Q R
campaignTracking
√√ 
.
√√ 
Mobile
√√ #
=
√√$ %
reports
√√& -
.
√√- .
Sum
√√. 1
(
√√1 2
x
√√2 3
=>
√√4 6
x
√√7 8
.
√√8 9
	MobileCnt
√√9 B
)
√√B C
;
√√C D
campaignTracking
ƒƒ 
.
ƒƒ 
Desktop
ƒƒ $
=
ƒƒ% &
report
ƒƒ' -
.
ƒƒ- .
	UniqueCnt
ƒƒ. 7
;
ƒƒ7 8
campaignTracking
≈≈ 
.
≈≈ 
Unsub
≈≈ "
=
≈≈# $
Random
≈≈% +
.
≈≈+ ,
Next
≈≈, 0
(
≈≈0 1
$num
≈≈1 2
,
≈≈2 3
$num
≈≈4 7
)
≈≈7 8
;
≈≈8 9
campaignTracking
∆∆ 
.
∆∆ 
Forwards
∆∆ %
=
∆∆& '
Random
∆∆( .
.
∆∆. /
Next
∆∆/ 3
(
∆∆3 4
$num
∆∆4 5
,
∆∆5 6
$num
∆∆7 :
)
∆∆: ;
;
∆∆; <
campaignTracking
«« 
.
«« 
Bounce
«« #
=
««$ %
Random
««& ,
.
««, -
Next
««- 1
(
««1 2
$num
««2 3
,
««3 4
$num
««5 7
)
««7 8
;
««8 9
campaignTracking
»» 
.
»» 
Opt
»»  
=
»»! "
Random
»»# )
.
»») *
Next
»»* .
(
»». /
$num
»»/ 0
,
»»0 1
$num
»»2 4
)
»»4 5
;
»»5 6
campaignTracking
…… 
.
…… 
OpenedPercentage
…… -
=
……. /
campaignTracking
……0 @
.
……@ A
Quantity
……A I
==
……J L
$num
……M N
?
……O P
$num
……Q R
:
……S T
(
……U V
double
……V \
)
……\ ]
campaignTracking
……] m
.
……m n
Opened
……n t
/
……u v
campaignTracking……w á
.……á à
Quantity……à ê
;……ê ë
campaignTracking
   
.
   
ClickedPercentage
   .
=
  / 0
campaignTracking
  1 A
.
  A B
Quantity
  B J
==
  K M
$num
  N O
?
  P Q
$num
  R S
:
  T U
(
  V W
double
  W ]
)
  ] ^
campaignTracking
  ^ n
.
  n o
Clicked
  o v
/
  w x
campaignTracking  y â
.  â ä
Quantity  ä í
;  í ì
campaignTracking
ÀÀ 
.
ÀÀ 
UnsubPercentage
ÀÀ ,
=
ÀÀ- .
campaignTracking
ÀÀ/ ?
.
ÀÀ? @
Quantity
ÀÀ@ H
==
ÀÀI K
$num
ÀÀL M
?
ÀÀN O
$num
ÀÀP Q
:
ÀÀR S
(
ÀÀT U
double
ÀÀU [
)
ÀÀ[ \
campaignTracking
ÀÀ\ l
.
ÀÀl m
Unsub
ÀÀm r
/
ÀÀs t
campaignTrackingÀÀu Ö
.ÀÀÖ Ü
QuantityÀÀÜ é
;ÀÀé è
campaignTracking
ÃÃ 
.
ÃÃ #
ClickToOpenPercentage
ÃÃ 2
=
ÃÃ3 4
campaignTracking
ÃÃ5 E
.
ÃÃE F
Opened
ÃÃF L
==
ÃÃM O
$num
ÃÃP Q
?
ÃÃR S
$num
ÃÃT U
:
ÃÃV W
(
ÃÃX Y
double
ÃÃY _
)
ÃÃ_ `
campaignTracking
ÃÃ` p
.
ÃÃp q
Clicked
ÃÃq x
/
ÃÃy z
campaignTrackingÃÃ{ ã
.ÃÃã å
OpenedÃÃå í
;ÃÃí ì
campaignTracking
ÕÕ 
.
ÕÕ #
UnsubToOpenPercentage
ÕÕ 2
=
ÕÕ3 4
campaignTracking
ÕÕ5 E
.
ÕÕE F
Opened
ÕÕF L
==
ÕÕM O
$num
ÕÕP Q
?
ÕÕR S
$num
ÕÕT U
:
ÕÕV W
(
ÕÕX Y
double
ÕÕY _
)
ÕÕ_ `
campaignTracking
ÕÕ` p
.
ÕÕp q
Unsub
ÕÕq v
/
ÕÕw x
campaignTrackingÕÕy â
.ÕÕâ ä
OpenedÕÕä ê
;ÕÕê ë
db
ŒŒ 
.
ŒŒ 
SaveChanges
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
return
–– 
campaignTracking
–– #
;
––# $
}
—— 	
private
”” 
static
”” 
void
”” 
SaveNotification
”” ,
(
””, -
WfpictContext
””- :
db
””; =
,
””= >
Guid
””? C
?
””C D

campaignId
””E O
,
””O P
string
””Q W
orderNumber
””X c
,
””c d
string
””e k
segmentNumber
””l y
,
””y z
string””{ Å
responseStatus””Ç ê
,””ê ë 
CampaignTracking””í ¢ 
campaignTracking””£ ≥
)””≥ ¥
{
‘‘ 	
int
’’ 
?
’’ 
hoursPassed
’’ 
=
’’ 
DateTime
’’ '
.
’’' (
Now
’’( +
.
’’+ ,
Hour
’’, 0
-
’’1 2
campaignTracking
’’3 C
.
’’C D
DateSent
’’D L
?
’’L M
.
’’M N
Hour
’’N R
;
’’R S
bool
÷÷ 
problemFound
÷÷ 
=
÷÷ 
false
÷÷  %
;
÷÷% &
QcRule
◊◊ 
qcRule
◊◊ 
=
◊◊ 
QcRule
◊◊ "
.
◊◊" #%
NotStartedInFirst4Hours
◊◊# :
;
◊◊: ;
if
ŸŸ 
(
ŸŸ 
responseStatus
ŸŸ 
==
ŸŸ !#
ProDataResponseStatus
ŸŸ" 7
.
ŸŸ7 8
NotFound
ŸŸ8 @
.
ŸŸ@ A
ToString
ŸŸA I
(
ŸŸI J
)
ŸŸJ K
&&
ŸŸL N
hoursPassed
ŸŸO Z
>=
ŸŸ[ ]
$num
ŸŸ^ _
)
ŸŸ_ `
{
⁄⁄ 
problemFound
€€ 
=
€€ 
true
€€ #
;
€€# $
qcRule
‹‹ 
=
‹‹ 
QcRule
‹‹ 
.
‹‹  %
NotStartedInFirst4Hours
‹‹  7
;
‹‹7 8
}
›› 
if
‡‡ 
(
‡‡ 
campaignTracking
‡‡  
.
‡‡  !
OpenedPercentage
‡‡! 1
<
‡‡2 3
$num
‡‡4 8
&&
‡‡9 ;
hoursPassed
‡‡< G
>=
‡‡H J
$num
‡‡K M
)
‡‡M N
{
·· 
problemFound
‚‚ 
=
‚‚ 
true
‚‚ #
;
‚‚# $
qcRule
„„ 
=
„„ 
QcRule
„„ 
.
„„  &
NotHitOpenRate5In24Hours
„„  8
;
„„8 9
}
‰‰ 
if
ÁÁ 
(
ÁÁ 
campaignTracking
ÁÁ  
.
ÁÁ  !
OpenedPercentage
ÁÁ! 1
<
ÁÁ2 3
$num
ÁÁ4 8
&&
ÁÁ9 ;
hoursPassed
ÁÁ< G
>=
ÁÁH J
$num
ÁÁK M
)
ÁÁM N
{
ËË 
problemFound
ÈÈ 
=
ÈÈ 
true
ÈÈ #
;
ÈÈ# $
qcRule
ÍÍ 
=
ÍÍ 
QcRule
ÍÍ 
.
ÍÍ  '
NotHitOpenRate10In72Hours
ÍÍ  9
;
ÍÍ9 :
}
ÎÎ 
if
ÓÓ 
(
ÓÓ 
campaignTracking
ÓÓ  
.
ÓÓ  !
ClickedPercentage
ÓÓ! 2
<
ÓÓ3 4
$num
ÓÓ5 :
&&
ÓÓ; =
hoursPassed
ÓÓ> I
>=
ÓÓJ L
$num
ÓÓM O
)
ÓÓO P
{
ÔÔ 
problemFound
 
=
 
true
 #
;
# $
qcRule
ÒÒ 
=
ÒÒ 
QcRule
ÒÒ 
.
ÒÒ  )
NotHitClickRate750In24Hours
ÒÒ  ;
;
ÒÒ; <
}
ÚÚ 
if
ıı 
(
ıı 
campaignTracking
ıı  
.
ıı  !
ClickedPercentage
ıı! 2
<
ıı3 4
$num
ıı5 9
&&
ıı: <
hoursPassed
ıı= H
>=
ııI K
$num
ııL N
)
ııN O
{
ˆˆ 
problemFound
˜˜ 
=
˜˜ 
true
˜˜ #
;
˜˜# $
qcRule
¯¯ 
=
¯¯ 
QcRule
¯¯ 
.
¯¯  *
NotHitClickRate1500In72Hours
¯¯  <
;
¯¯< =
}
˘˘ 
if
˚˚ 
(
˚˚ 
!
˚˚ 
problemFound
˚˚ 
)
˚˚ 
return
˚˚ %
;
˚˚% &
var
˝˝ 
alreadyNoted
˝˝ 
=
˝˝ 
db
˝˝ !
.
˝˝! "
Notifications
˝˝" /
.
˛˛ 
FirstOrDefault
˛˛ 
(
˛˛  
x
˛˛  !
=>
˛˛" $
x
˛˛% &
.
˛˛& '

CampaignId
˛˛' 1
==
˛˛2 4

campaignId
˛˛5 ?
&&
˛˛@ B
x
˛˛C D
.
˛˛D E
OrderNumber
˛˛E P
==
˛˛Q S
orderNumber
˛˛T _
&&
˛˛` b
x
˛˛c d
.
˛˛d e
SegmentNumber
˛˛e r
==
˛˛s u
segmentNumber˛˛v É
&&
ˇˇ 
x
ˇˇ  !
.
ˇˇ! "
QcRule
ˇˇ" (
==
ˇˇ) +
(
ˇˇ, -
int
ˇˇ- 0
)
ˇˇ0 1
qcRule
ˇˇ1 7
&&
ˇˇ8 :
x
ˇˇ; <
.
ˇˇ< =
Status
ˇˇ= C
==
ˇˇD F
(
ˇˇG H
int
ˇˇH K
)
ˇˇK L 
NotificationStatus
ˇˇL ^
.
ˇˇ^ _
Found
ˇˇ_ d
)
ˇˇd e
;
ˇˇe f
if
ÅÅ 
(
ÅÅ 
alreadyNoted
ÅÅ 
==
ÅÅ 
null
ÅÅ  $
)
ÅÅ$ %
{
ÇÇ 
	LogHelper
ÉÉ 
.
ÉÉ 
AddLog
ÉÉ  
(
ÉÉ  !
db
ÉÉ! #
,
ÉÉ# $
LogType
ÉÉ% ,
.
ÉÉ, -
RulesProcessing
ÉÉ- <
,
ÉÉ< =
orderNumber
ÉÉ> I
,
ÉÉI J
$str
ÉÉK c
+
ÉÉd e
qcRule
ÉÉf l
)
ÉÉl m
;
ÉÉm n
db
ÑÑ 
.
ÑÑ 
Notifications
ÑÑ  
.
ÑÑ  !
Add
ÑÑ! $
(
ÑÑ$ %
new
ÑÑ% (
Notification
ÑÑ) 5
(
ÑÑ5 6
)
ÑÑ6 7
{
ÖÖ 
Id
ÜÜ 
=
ÜÜ 
Guid
ÜÜ 
.
ÜÜ 
NewGuid
ÜÜ %
(
ÜÜ% &
)
ÜÜ& '
,
ÜÜ' (
	CreatedAt
áá 
=
áá 
DateTime
áá  (
.
áá( )
Now
áá) ,
,
áá, -

CampaignId
àà 
=
àà  

campaignId
àà! +
,
àà+ ,
OrderNumber
ââ 
=
ââ  !
orderNumber
ââ" -
,
ââ- .
SegmentNumber
ää !
=
ää" #
segmentNumber
ää$ 1
,
ää1 2
Status
ãã 
=
ãã 
(
ãã 
int
ãã !
)
ãã! " 
NotificationStatus
ãã" 4
.
ãã4 5
Found
ãã5 :
,
ãã: ;
	CheckTime
åå 
=
åå 
DateTime
åå  (
.
åå( )
Now
åå) ,
,
åå, -
FoundAt
çç 
=
çç 
DateTime
çç &
.
çç& '
Now
çç' *
,
çç* +
QcRule
éé 
=
éé 
(
éé 
int
éé !
)
éé! "
qcRule
éé" (
}
èè 
)
èè 
;
èè 
db
êê 
.
êê 
SaveChanges
êê 
(
êê 
)
êê  
;
êê  !
}
ëë 
}
ìì 	
}
ïï 
}ññ ÚA
NE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\Helpers\S3FileManager.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Async !
.! "
Helpers" )
{ 
public 

class 
S3FileManager 
{		 
public

 
readonly

 
static

 
string

 %
Bucket

& ,
=

- .
$str

/ =
;

= >
public 
static 
void 
Upload !
(! "
string" (
fileKey) 0
,0 1
string2 8
localFilePath9 F
,F G
boolH L
ifMakePublicM Y
=Z [
true\ `
,` a
boolb f
	overWriteg p
=q r
falses x
)x y
{ 	
if 
( 
	overWrite 
) 
Delete !
(! "
fileKey" )
)) *
;* +
using 
( 
	IAmazonS3 
client #
=$ %
new& )
AmazonS3Client* 8
(8 9
RegionEndpoint9 G
.G H
USWest2H O
)O P
)P Q
{ 
PutObjectRequest  
request! (
=) *
new+ .
PutObjectRequest/ ?
(? @
)@ A
;A B
request 
. 

BucketName "
=# $
Bucket% +
;+ ,
request 
. 
Key 
= 
fileKey %
;% &
request 
. 
FilePath  
=! "
localFilePath# 0
;0 1
client 
. 
	PutObject  
(  !
request! (
)( )
;) *
} 
if 
( 
ifMakePublic 
) 

MakePublic 
( 
fileKey "
)" #
;# $
} 	
public 
static 
void 
Download #
(# $
string$ *
fileKey+ 2
,2 3
string4 :
localFilePath; H
)H I
{ 	
using 
( 
	IAmazonS3 
client #
=$ %
new& )
AmazonS3Client* 8
(8 9
RegionEndpoint9 G
.G H
USWest2H O
)O P
)P Q
{   
GetObjectRequest!!  
request!!! (
=!!) *
new!!+ .
GetObjectRequest!!/ ?
(!!? @
)!!@ A
;!!A B
request"" 
."" 

BucketName"" "
=""# $
Bucket""% +
;""+ ,
request## 
.## 
Key## 
=## 
fileKey## %
;##% &
GetObjectResponse$$ !
response$$" *
=$$+ ,
client$$- 3
.$$3 4
	GetObject$$4 =
($$= >
request$$> E
)$$E F
;$$F G
response%% 
.%% %
WriteResponseStreamToFile%% 2
(%%2 3
localFilePath%%3 @
)%%@ A
;%%A B
}&& 
}'' 	
public)) 
static)) 
void)) 
Delete)) !
())! "
string))" (
fileKey))) 0
)))0 1
{** 	
using++ 
(++ 
	IAmazonS3++ 
client++ #
=++$ %
new++& )
AmazonS3Client++* 8
(++8 9
RegionEndpoint++9 G
.++G H
USWest2++H O
)++O P
)++P Q
{,, 
DeleteObjectRequest-- #
request--$ +
=--, -
new--. 1
DeleteObjectRequest--2 E
(--E F
)--F G
;--G H
request.. 
... 

BucketName.. "
=..# $
Bucket..% +
;..+ ,
request// 
.// 
Key// 
=// 
fileKey// %
;//% &
client00 
.00 
DeleteObject00 #
(00# $
request00$ +
)00+ ,
;00, -
}11 
}22 	
public44 
static44 
void44 
CreateDirectory44 *
(44* +
string44+ 1

folderName442 <
)44< =
{55 	
using66 
(66 
	IAmazonS366 
client66 #
=66$ %
new66& )
AmazonS3Client66* 8
(668 9
RegionEndpoint669 G
.66G H
USWest266H O
)66O P
)66P Q
{77 
S3DirectoryInfo88 
destination88  +
=88, -
new88. 1
S3DirectoryInfo882 A
(88A B
client88B H
,88H I
Bucket88J P
,88P Q

folderName88R \
)88\ ]
;88] ^
if99 
(99 
!99 
destination99  
.99  !
Exists99! '
)99' (
destination99) 4
.994 5
Create995 ;
(99; <
)99< =
;99= >
}:: 
};; 	
public== 
static== 
void== 
Move== 
(==  
string==  &

oldFileKey==' 1
,==1 2
string==2 8

newFileKey==9 C
,==C D
string==E K

folderName==L V
,==V W
bool==X \
	overWrite==] f
===g h
false==i n
)==n o
{>> 	
if?? 
(?? 
string?? 
.?? 
IsNullOrEmpty?? #
(??# $

oldFileKey??$ .
)??. /
)??/ 0
return??1 7
;??7 8
ifAA 
(AA 
	overWriteAA 
)AA 
DeleteAA  
(AA  !

newFileKeyAA! +
)AA+ ,
;AA, -
usingCC 
(CC 
	IAmazonS3CC 
clientCC #
=CC$ %
newCC& )
AmazonS3ClientCC* 8
(CC8 9
RegionEndpointCC9 G
.CCG H
USWest2CCH O
)CCO P
)CCP Q
{DD 

S3FileInfoEE 
currentObjectEE (
=EE) *
newEE+ .

S3FileInfoEE/ 9
(EE9 :
clientEE: @
,EE@ A
BucketEEB H
,EEH I

oldFileKeyEEJ T
)EET U
;EEU V
S3DirectoryInfoFF 
destinationFF  +
=FF, -
newFF. 1
S3DirectoryInfoFF2 A
(FFA B
clientFFB H
,FFH I
BucketFFJ P
,FFP Q

folderNameFFR \
)FF\ ]
;FF] ^
ifGG 
(GG 
!GG 
destinationGG 
.GG  
ExistsGG  &
)GG& '
destinationGG( 3
.GG3 4
CreateGG4 :
(GG: ;
)GG; <
;GG< =

S3FileInfoHH 
movedObjectHH &
=HH' (
currentObjectHH) 6
.HH6 7
MoveToHH7 =
(HH= >
BucketHH> D
,HHD E

newFileKeyHHF P
)HHP Q
;HHQ R
}II 

MakePublicJJ 
(JJ 

newFileKeyJJ !
)JJ! "
;JJ" #
}KK 	
publicMM 
staticMM 
voidMM 

MakePublicMM %
(MM% &
stringMM& ,
fileKeyMM- 4
)MM4 5
{NN 	
usingOO 
(OO 
	IAmazonS3OO 
clientOO #
=OO$ %
newOO& )
AmazonS3ClientOO* 8
(OO8 9
RegionEndpointOO9 G
.OOG H
USWest2OOH O
)OOO P
)OOP Q
{PP 
PutACLRequestQQ 
requestQQ %
=QQ& '
newQQ( +
PutACLRequestQQ, 9
(QQ9 :
)QQ: ;
;QQ; <
requestRR 
.RR 

BucketNameRR "
=RR# $
BucketRR% +
;RR+ ,
requestSS 
.SS 
KeySS 
=SS 
fileKeySS %
;SS% &
requestTT 
.TT 
	CannedACLTT !
=TT" #
S3CannedACLTT$ /
.TT/ 0

PublicReadTT0 :
;TT: ;
clientUU 
.UU 
PutACLUU 
(UU 
requestUU %
)UU% &
;UU& '
}VV 
}WW 	
}XX 
}YY ò
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\NumberHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
NumberHelper 
{ 
private 
static 
int 
GetTotalFromRange ,
(, -
int- 0
firstNumber1 <
,< =
int> A
secondNumberB N
)N O
{ 	
if 
( 
firstNumber 
== 
$num  
||! #
secondNumber$ 0
==1 3
$num4 5
)5 6
return 
$num 
; 
return

 
secondNumber

 
-

  !
firstNumber

" -
+

. /
$num

0 1
;

1 2
} 	
public 
static 
int 
GetTotal "
(" #
int# &

firstStart' 1
,1 2
int3 6
firstEnd7 ?
,? @
intA D
secondStartE P
,P Q
intR U
	secondEndV _
,_ `
inta d

thirdStarte o
,o p
intq t
thirdEndu }
)} ~
{ 	
return 
GetTotalFromRange $
($ %

firstStart% /
,/ 0
firstEnd1 9
)9 :
+; <
GetTotalFromRange= N
(N O
secondStartO Z
,Z [
	secondEnd\ e
)e f
+g h
GetTotalFromRange $
($ %

thirdStart% /
,/ 0
thirdEnd1 9
)9 :
;: ;
} 	
} 
} ¶
HE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\QCRuleUtility.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

static 
class 
QcRuleUtility %
{ 
public 
static 
string 
	GetString &
(& '
int' *
qcRule+ 1
)1 2
{ 	
switch		 
(		 
qcRule		 
)		 
{

 
case 
( 
int 
) 
QcRule  
.  !#
NotStartedInFirst4Hours! 8
:8 9
return 
$str T
;T U
case 
( 
int 
) 
QcRule  
.  !$
NotHitOpenRate5In24Hours! 9
:9 :
return 
$str V
;V W
case 
( 
int 
) 
QcRule  
.  !%
NotHitOpenRate10In72Hours! :
:: ;
return 
$str W
;W X
case 
( 
int 
) 
QcRule  
.  !'
NotHitClickRate750In24Hours! <
:< =
return 
$str Y
;Y Z
case 
( 
int 
) 
QcRule  
.  !(
NotHitClickRate1500In72Hours! =
:= >
return 
$str Y
;Y Z
} 
return 
$str 
; 
} 	
} 
} £#
NE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\SortSearchExtension.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

static 
class 
SortSearchExtension +
{		 
public 
static 
IHtmlString !
SortIdentifier" 0
(0 1
this1 5

HtmlHelper6 @

htmlHelperA K
,K L
stringM S
	sortOrderT ]
,] ^
string_ e
fieldf k
)k l
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
	sortOrder% .
). /
||0 2
(3 4
	sortOrder4 =
.= >
Trim> B
(B C
)C D
!=E G
fieldH M
&&N P
	sortOrderQ Z
.Z [
Replace[ b
(b c
$strc j
,j k
$strl n
)n o
.o p
Trimp t
(t u
)u v
!=w y
fieldz 
)	 Ä
)
Ä Å
return
Ç à
null
â ç
;
ç é
string 
glyph 
= 
$str ;
;; <
if 
( 
	sortOrder 
. 
ToLower !
(! "
)" #
.# $
Contains$ ,
(, -
$str- 3
)3 4
)4 5
{ 
glyph 
= 
$str :
;: ;
} 
var 
span 
= 
new 

TagBuilder %
(% &
$str& ,
), -
;- .
span 
. 

Attributes 
[ 
$str #
]# $
=% &
glyph' ,
;, -
return 
MvcHtmlString  
.  !
Create! '
(' (
span( ,
., -
ToString- 5
(5 6
)6 7
)7 8
;8 9
} 	
public)) 
static))  
RouteValueDictionary)) *"
ToRouteValueDictionary))+ A
())A B
this))B F
NameValueCollection))G Z

collection))[ e
,))e f
string))g m
newKey))n t
,))t u
string))v |
newValue	))} Ö
)
))Ö Ü
{** 	
var++  
routeValueDictionary++ $
=++% &
new++' * 
RouteValueDictionary+++ ?
(++? @
)++@ A
;++A B
foreach,, 
(,, 
var,, 
key,, 
in,, 

collection,,  *
.,,* +
AllKeys,,+ 2
),,2 3
{-- 
if.. 
(.. 
key.. 
==.. 
null.. 
)..  
continue..! )
;..) *
if// 
(//  
routeValueDictionary// (
.//( )
ContainsKey//) 4
(//4 5
key//5 8
)//8 9
)//9 : 
routeValueDictionary00 (
.00( )
Remove00) /
(00/ 0
key000 3
)003 4
;004 5 
routeValueDictionary22 $
.22$ %
Add22% (
(22( )
key22) ,
,22, -

collection22. 8
[228 9
key229 <
]22< =
)22= >
;22> ?
}33 
if44 
(44 
string44 
.44 
IsNullOrEmpty44 $
(44$ %
newValue44% -
)44- .
)44. /
{55  
routeValueDictionary66 $
.66$ %
Remove66% +
(66+ ,
newKey66, 2
)662 3
;663 4
}77 
else88 
{99 
if:: 
(::  
routeValueDictionary:: (
.::( )
ContainsKey::) 4
(::4 5
newKey::5 ;
)::; <
)::< = 
routeValueDictionary;; (
.;;( )
Remove;;) /
(;;/ 0
newKey;;0 6
);;6 7
;;;7 8 
routeValueDictionary== $
.==$ %
Add==% (
(==( )
newKey==) /
,==/ 0
newValue==1 9
)==9 :
;==: ;
}>> 
return??  
routeValueDictionary?? '
;??' (
}@@ 	
}AA 
}BB ´
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\StringHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
StringHelper 
{ 
public		 
static		 
bool		 
Contains		 #
(		# $
string		$ *
source		+ 1
,		1 2
string		3 9
toCheck		: A
)		A B
{

 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
source% +
)+ ,
), -
return. 4
false5 :
;: ;
return 
source 
. 
ToLowerInvariant *
(* +
)+ ,
., -
Contains- 5
(5 6
toCheck6 =
.= >
ToLowerInvariant> N
(N O
)O P
)P Q
;Q R
} 	
public 
static 
string 
UrlSubstring )
() *
string* 0
source1 7
)7 8
{ 	
var 
parts 
= 
source 
. 
Split $
($ %
$str% )
.) *
ToCharArray* 5
(5 6
)6 7
)7 8
;8 9
return 
string 
. 
Join 
( 
$str "
," #
parts$ )
.) *
ToList* 0
(0 1
)1 2
.2 3
Skip3 7
(7 8
parts8 =
.= >
Length> D
-E F
$numG H
)H I
)I J
;J K
} 	
public 
static 
string 
Trim !
(! "
string" (
source) /
)/ 0
{ 	
var 
lineTrimmed 
= 
Regex #
.# $
Replace$ +
(+ ,
source, 2
,2 3
$str4 @
,@ A
$strB D
,D E
RegexOptions +
.+ ,
None, 0
,0 1
TimeSpan2 :
.: ;
FromSeconds; F
(F G
$numG J
)J K
)K L
;L M
return 
lineTrimmed 
. 
Trim #
(# $
)$ %
;% &
} 	
} 
} æ
EE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\Extensions.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

static 
class 

Extensions "
{		 
public

 
static

 
string

 
ToJson

 #
(

# $
this

$ (
object

) /
value

0 5
)

5 6
{ 	
return 
JsonConvert 
. 
SerializeObject .
(. /
value/ 4
,4 5

Formatting6 @
.@ A
IndentedA I
)I J
;J K
} 	
public 
static 
string 
ToCapitalized *
(* +
this+ /
string0 6
value7 <
)< =
{ 	
return 
CultureInfo 
. 
CurrentCulture -
.- .
TextInfo. 6
.6 7
ToTitleCase7 B
(B C
valueC H
.H I
ReplaceI P
(P Q
$strQ T
,T U
$strV X
)X Y
)Y Z
;Z [
} 	
public 
static 
bool 
Contains #
(# $
this$ (
string) /
source0 6
,6 7
string8 >
search? E
, 
StringComparison 
compare &
)& '
{ 	
return 
source 
. 
IndexOf !
(! "
search" (
,( )
compare* 1
)1 2
>=3 5
$num6 7
;7 8
} 	
static 
Regex 
_r 
= 
new 
Regex #
(# $
$str$ ,
,, -
RegexOptions. :
.: ;#
IgnorePatternWhitespace; R
)R S
;S T
public 
static 
string !
ToCapitalLetterString 2
(2 3
this3 7
string8 >
s? @
)@ A
{   	
return!! 
_r!! 
.!! 
Replace!! 
(!! 
s!! 
,!!  
$str!!! $
)!!$ %
;!!% &
}"" 	
public$$ 
static$$ 
string$$ 
ToSafeString$$ )
($$) *
this$$* .
Guid$$/ 3
?$$3 4
value$$5 :
)$$: ;
{%% 	
return&& 
value&& 
?&& 
.&& 
ToString&& "
(&&" #
)&&# $
??&&% '
string&&( .
.&&. /
Empty&&/ 4
;&&4 5
}'' 	
public)) 
static)) 
string)) 
ToSafeString)) )
())) *
this))* .
DateTime))/ 7
?))7 8
value))9 >
,))> ?
string))@ F
format))G M
)))M N
{** 	
return++ 
value++ 
?++ 
.++ 
ToString++ "
(++" #
format++# )
)++) *
??+++ -
string++. 4
.++4 5
Empty++5 :
;++: ;
},, 	
}-- 
}.. ú¢
LE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Async\Helpers\EmailHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Async !
.! "
Helpers" )
{ 
public 

static 
class 
EmailHelper #
{ 
private 
const 
string 
Footer #
=$ %
$str& `
;` a
public 
static 
void "
SendOrderEmailToClient 1
(1 2
Campaign2 :
campaign; C
,C D
WfpUserE L
loggedInUserM Y
)Y Z
{ 	
string 
subject 
= 
$" 
Order #  '
{' (
campaign( 0
.0 1
OrderNumber1 <
}< =
, Campaign Date = M
{M N
campaignN V
.V W
BroadcastDateW d
?d e
.e f
ToStringf n
(n o
$stro r
)r s
}s t
, QTY t z
{z {
campaign	{ É
.
É Ñ
Quantity
Ñ å
}
å ç 
 , Date Submitted 
ç ü
{
ü †
campaign
† ®
.
® ©
	CreatedAt
© ≤
:
≤ ≥
d
≥ ¥
}
¥ µ
"
µ ∂
;
∂ ∑
string 
body 
= 
$@" 
<br/><p>Dear  *
{* +
loggedInUser+ 7
.7 8
UserName8 @
.@ A!
ToCapitalLetterStringA V
(V W
)W X
.X Y
ToCapitalizedY f
(f g
)g h
}h i¨
ü</p><br/>We have recevied your order.<br/><br/>
                        <table border=""2"">
                        <tr><th align=""left"">Order #:</th><td>i @
{@ A
campaignA I
.I J
OrderNumberJ U
}U VW
K</td></tr>
                        <tr><th align=""left"">Status:</th><td>V ?
{? @
(@ A
CampaignStatusA O
)O P
campaignQ Y
.Y Z
StatusZ `
}` aY
M</td></tr>
                        <tr><th align=""left"">Username:</th><td>a A
{A B
loggedInUserB N
.N O
UserNameO W
}W X[
O</td></tr>
                        <tr><th align=""left"">User Email:</th><td>X C
{C D
loggedInUserD P
.P Q
EmailQ V
}V W^
R</td></tr>
                        <tr><th align=""left"">Campaign Name:</th><td>W F
{F G
campaignG O
.O P
CampaignNameP \
}\ ]_
S</td></tr>
                        <tr><th align=""left"">Broadcast Date:</th><td>] G
{G H
campaignH P
.P Q
BroadcastDateQ ^
.^ _
Value_ d
.d e
ToStringe m
(m n
$strn q
)q r
}r s\
P</td></tr>
                        <tr><th align=""left"">Rebroadcast:</th><td>s D
{D E
(E F
campaignF N
.N O
ReBroadCastO Z
?Z [
$str\ a
:a b
$strc g
)g h
}h ia
U</td></tr>
                        <tr><th align=""left"">Rebroadcast Date:</th><td>i I
{I J
(J K
campaignK S
.S T
ReBroadcastDateT c
.c d
HasValued l
?l m
campaignn v
.v w
ReBroadcastDate	w Ü
.
Ü á
ToString
á è
(
è ê
)
ê ë
:
ë í
$str
ì ï
)
ï ñ
}
ñ ó[
N</td></tr>
                        <tr><th align=""left"">From Line:</th><td>	 ó B
{  B C
campaign  C K
.  K L
FromLine  L T
}  T U]
Q</td></tr>
                        <tr><th align=""left"">Subject Line:</th><td> !U E
{!!E F
campaign!!F N
.!!N O
SubjectLine!!O Z
}!!Z [`
T</td></tr>
                        <tr><th align=""left"">Personalization:</th><td>!"[ H
{""H I
(""I J
campaign""J R
.""R S
IsPersonalization""S d
?""d e
$str""f k
:""k l
$str""m q
)""q r
}""r sZ
N</td></tr>
                        <tr><th align=""left"">Matchback:</th><td>"#s B
{##B C
(##C D
campaign##D L
.##L M
IsMatchback##M X
?##Y Z
$str##[ `
:##a b
$str##c g
)##g h
}##h i\
P</td></tr>
                        <tr><th align=""left"">Suppression:</th><td>#$i D
{$$D E
($$E F
campaign$$F N
.$$N O
IsSuppression$$O \
?$$\ ]
$str$$^ c
:$$c d
$str$$e i
)$$i j
}$$j k\
P</td></tr>
                        <tr><th align=""left"">White Label:</th><td>$%k D
{%%D E
campaign%%E M
.%%M N

WhiteLabel%%N X
}%%X YZ
N</td></tr>
                        <tr><th align=""left"">HTML File:</th><td>%&Y B
{&&B C
campaign&&C K
.&&K L
Assets&&L R
.&&R S
CreativeUrl&&S ^
}&&^ _Z
N</td></tr>
                        <tr><th align=""left"">Test Seed:</th><td>&'_ B
{''B C
campaign''C K
.''K L
Assets''L R
.''R S
TestSeedUrl''S ^
}''^ _\
P</td></tr>  
                        <tr><th align=""left"">Live Seed:</th><td>'(_ B
{((B C
campaign((C K
.((K L
Assets((L R
.((R S
LiveSeedUrl((S ^
}((^ _h
\</td></tr>   
                        <tr><th align=""left"">Special Instructions:</th><td>()_ M
{))M N
campaign))N V
.))V W
SpecialInstructions))W j
}))j kÄ
t</td></tr>                                     
                        <tr><th align=""left"">Start Time:</th><td>)*k C
{**C D
campaign**D L
.**L M
	CreatedAt**M V
.**V W

AddMinutes**W a
(**a b
$num**b c
)**c d
.**d e

AddSeconds**e o
(**o p
$num**p r
)**r s
}**s tS
G</td></tr>
                        <tr><th align=""left"">IP:</th><td>*+t ;
{++; <
campaign++< D
.++D E
IP++E G
}++G HX
L</td></tr>
                        <tr><th align=""left"">Browser:</th><td>+,H @
{,,@ A
campaign,,A I
.,,I J
Browser,,J Q
},,Q RS
G</td></tr>
                        <tr><th align=""left"">OS:</th><td>,-R ;
{--; <
campaign--< D
.--D E
OS--E G
}--G HY
M</td></tr>
                        <tr><th align=""left"">Referrer:</th><td>-.H A
{..A B
campaign..B J
...J K
Referrer..K S
}..S T~
r</td></tr>
                        </table></p> <p>We will soon contact you and update you about your order.</p> ./T f
{//f g
Footer//g m
}//m n
"//n o
;//o p
	SendEmail11 
(11 
loggedInUser11 "
.11" #
Email11# (
,11( )
subject11* 1
,111 2
body113 7
)117 8
;118 9
}22 	
public44 
static44 
void44 
SendOrderEmailToAds44 .
(44. /
Campaign44/ 7
campaign448 @
,44@ A
WfpUser44B I
loggedInUser44J V
,44V W
string44X ^
to44_ a
,44a b
string44c i
ccEmails44j r
)44r s
{55 	
string66 
subject66 
=66 
$"66 (
New Order Received, Order # 66 ;
{66; <
campaign66< D
.66D E
OrderNumber66E P
}66P Q
, Campaign Date 66Q a
{66a b
campaign66b j
.66j k
BroadcastDate66k x
?66x y
.66y z
ToString	66z Ç
(
66Ç É
$str
66É Ü
)
66Ü á
}
66á à
, QTY 
66à é
{
66é è
campaign
66è ó
.
66ó ò
Quantity
66ò †
}
66† ° 
 , Date Submitted 
66° ≥
{
66≥ ¥
campaign
66¥ º
.
66º Ω
	CreatedAt
66Ω ∆
:
66∆ «
d
66« »
}
66» …
"
66…  
;
66  À
string88 
body88 
=88 
$@"88 Â
ÿ<br/><p>Dear ADS team, <br/><br/> New Order has been entered into system. Order details is as below;</p>
                        <table border=""2"">
                        <tr><th align=""left"">Order #:</th><td>8: @
{::@ A
campaign::A I
.::I J
OrderNumber::J U
}::U VW
K</td></tr>
                        <tr><th align=""left"">Status:</th><td>:;V ?
{;;? @
(;;@ A
CampaignStatus;;A O
);;O P
campaign;;P X
.;;X Y
Status;;Y _
};;_ `Y
M</td></tr>
                        <tr><th align=""left"">Username:</th><td>;<` A
{<<A B
loggedInUser<<B N
.<<N O
UserName<<O W
.<<W X!
ToCapitalLetterString<<X m
(<<m n
)<<n o
.<<o p
ToCapitalized<<p }
(<<} ~
)<<~ 
}	<< Ä\
O</td></tr>
                        <tr><th align=""left"">User Email:</th><td>	<=Ä C
{==C D
loggedInUser==D P
.==P Q
Email==Q V
}==V W^
R</td></tr>
                        <tr><th align=""left"">Campaign Name:</th><td>=>W F
{>>F G
campaign>>G O
.>>O P
CampaignName>>P \
}>>\ ]_
S</td></tr>
                        <tr><th align=""left"">Broadcast Date:</th><td>>?] G
{??G H
campaign??H P
.??P Q
BroadcastDate??Q ^
.??^ _
Value??_ d
.??d e
ToString??e m
(??m n
$str??n q
)??q r
}??r s\
P</td></tr>
                        <tr><th align=""left"">Rebroadcast:</th><td>?@s D
{@@D E
(@@E F
campaign@@F N
.@@N O
ReBroadCast@@O Z
?@@[ \
$str@@] b
:@@c d
$str@@e i
)@@i j
}@@j ka
U</td></tr>
                        <tr><th align=""left"">Rebroadcast Date:</th><td>@Ak I
{AAI J
(AAJ K
campaignAAK S
.AAS T
ReBroadcastDateAAT c
.AAc d
HasValueAAd l
?AAm n
campaignAAo w
.AAw x
ReBroadcastDate	AAx á
.
AAá à
ToString
AAà ê
(
AAê ë
)
AAë í
:
AAì î
$str
AAï ó
)
AAó ò
}
AAò ô[
N</td></tr>
                        <tr><th align=""left"">From Line:</th><td>	ABô B
{BBB C
campaignBBC K
.BBK L
FromLineBBL T
}BBT U]
Q</td></tr>
                        <tr><th align=""left"">Subject Line:</th><td>BCU E
{CCE F
campaignCCF N
.CCN O
SubjectLineCCO Z
}CCZ [`
T</td></tr>
                        <tr><th align=""left"">Personalization:</th><td>CD[ H
{DDH I
(DDI J
campaignDDJ R
.DDR S
IsPersonalizationDDS d
?DDe f
$strDDg l
:DDm n
$strDDo s
)DDs t
}DDt uZ
N</td></tr>
                        <tr><th align=""left"">Matchback:</th><td>DEu B
{EEB C
(EEC D
campaignEED L
.EEL M
IsMatchbackEEM X
?EEY Z
$strEE[ `
:EEa b
$strEEc g
)EEg h
}EEh i\
P</td></tr>
                        <tr><th align=""left"">Suppression:</th><td>EFi D
{FFD E
(FFE F
campaignFFF N
.FFN O
IsSuppressionFFO \
?FF] ^
$strFF_ d
:FFe f
$strFFg k
)FFk l
}FFl m\
P</td></tr>
                        <tr><th align=""left"">White Label:</th><td>FGm D
{GGD E
campaignGGE M
.GGM N

WhiteLabelGGN X
}GGX YZ
N</td></tr>
                        <tr><th align=""left"">HTML File:</th><td>GHY B
{HHB C
campaignHHC K
.HHK L
AssetsHHL R
.HHR S
CreativeUrlHHS ^
}HH^ _Z
N</td></tr>
                        <tr><th align=""left"">Test Seed:</th><td>HI_ B
{IIB C
campaignIIC K
.IIK L
AssetsIIL R
.IIR S
TestSeedUrlIIS ^
}II^ _\
P</td></tr>  
                        <tr><th align=""left"">Live Seed:</th><td>IJ_ B
{JJB C
campaignJJC K
.JJK L
AssetsJJL R
.JJR S
LiveSeedUrlJJS ^
}JJ^ _h
\</td></tr>   
                        <tr><th align=""left"">Special Instructions:</th><td>JK_ M
{KKM N
campaignKKN V
.KKV W
SpecialInstructionsKKW j
}KKj kÄ
t</td></tr>                                     
                        <tr><th align=""left"">Start Time:</th><td>KLk C
{LLC D
campaignLLD L
.LLL M
	CreatedAtLLM V
.LLV W

AddMinutesLLW a
(LLa b
$numLLb c
)LLc d
.LLd e

AddSecondsLLe o
(LLo p
$numLLp r
)LLr s
}LLs tS
G</td></tr>
                        <tr><th align=""left"">IP:</th><td>LMt ;
{MM; <
campaignMM< D
.MMD E
IPMME G
}MMG HX
L</td></tr>
                        <tr><th align=""left"">Browser:</th><td>MNH @
{NN@ A
campaignNNA I
.NNI J
BrowserNNJ Q
}NNQ RS
G</td></tr>
                        <tr><th align=""left"">OS:</th><td>NOR ;
{OO; <
campaignOO< D
.OOD E
OSOOE G
}OOG HY
M</td></tr>
                        <tr><th align=""left"">Referrer:</th><td>OPH A
{PPA B
campaignPPB J
.PPJ K
ReferrerPPK S
}PPS T=
1</td></tr>
                        </table></p> PQT %
{QQ% &
FooterQQ& ,
}QQ, -
"QQ- .
;QQ. /
	SendEmailSS 
(SS 
toSS 
,SS 
subjectSS !
,SS! "
bodySS# '
,SS' (
ccEmailsSS) 1
)SS1 2
;SS2 3
}TT 	
publicVV 
staticVV 
voidVV  
SendApprovedToVendorVV /
(VV/ 0
VendorVV0 6
vendorVV7 =
,VV= >
CampaignVV? G
campaignVVH P
,VVP Q
CampaignSegmentVVR a
segmentVVb i
)VVi j
{WW 	
stringXX 
newOldXX 
=XX 
!XX 
campaignXX %
.XX% &
ReBroadcastedXX& 3
?XX4 5
$strXX6 ;
:XX< =
$strXX> C
;XXC D
stringYY 
orderNumberYY 
=YY  
campaignYY! )
.YY) *
OrderNumberYY* 5
;YY5 6
stringZZ 

deployDateZZ 
=ZZ 
campaignZZ  (
.ZZ( )
ApprovedZZ) 1
.ZZ1 2

DeployDateZZ2 <
?ZZ< =
.ZZ= >
ToStringZZ> F
(ZZF G
$strZZG J
)ZZJ K
;ZZK L
string[[ 

deployTime[[ 
=[[ 
campaign[[  (
.[[( )
Approved[[) 1
.[[1 2

DeployDate[[2 <
?[[< =
.[[= >
ToString[[> F
([[F G
$str[[G N
)[[N O
;[[O P
string\\ 
quantity\\ 
=\\ 
campaign\\ &
.\\& '
Approved\\' /
.\\/ 0
Quantity\\0 8
.\\8 9
ToString\\9 A
(\\A B
)\\B C
;\\C D
string^^ 
subject^^ 
;^^ 
string__ 
segmentsHtml__ 
=__  !
string__" (
.__( )
Empty__) .
;__. /
if`` 
(`` 
segment`` 
==`` 
null`` 
)``  
{aa 
subjectbb 
=bb 
$"bb 
{bb 
newOldbb #
}bb# $
 Order bb$ +
{bb+ ,
campaignbb, 4
.bb4 5
Approvedbb5 =
.bb= >
CampaignNamebb> J
}bbJ K

, Order # bbK U
{bbU V
campaignbbV ^
.bb^ _
OrderNumberbb_ j
}bbj k
"bbk l
;bbl m
}cc 
elsecc 
{dd 
subjectee 
=ee 
$"ee 
{ee 
newOldee #
}ee# $
 Order ee$ +
{ee+ ,
campaignee, 4
.ee4 5
Approvedee5 =
.ee= >
CampaignNameee> J
}eeJ K

, Order # eeK U
{eeU V
segmenteeV ]
.ee] ^
SegmentNumberee^ k
}eek l
"eel m
;eem n
segmentsHtmlff 
+=ff 
$@"ff  #i
]<table border=""1"">
                                <tr><th align=""left"">Segment</th><td>fg# G
{ggG H
segmentggH O
.ggO P
SegmentNumberggP ]
}gg] ^d
X</td></tr>
                                <tr><th align=""left"">Subject Line</th><td>gh^ L
{hhL M
segmenthhM T
.hhT U
SubjectLinehhU `
}hh` aa
U</td></tr>
                                <tr><th align=""left"">From Line</th><td>hia I
{iiI J
segmentiiJ Q
.iiQ R
FromLineiiR Z
}iiZ [c
W</td></tr>
                                <tr><th align=""left"">White Label</th><td>ij[ K
{jjK L
segmentjjL S
.jjS T

WhiteLabeljjT ^
}jj^ _g
[</td></tr>
                                <tr><th align=""left"">Deployment Date</th><td>jk_ O
{kkO P
segmentkkP W
.kkW X
DeploymentDatekkX f
}kkf ga
U</td></tr>
                                <tr><th align=""left"">Data File</th><td>klg I
{llI J
segmentllJ Q
.llQ R
SegmentDataFileUrlllR d
}lld ee
Y</td></tr>
                                <tr><th align=""left"">Total Records</th><td>lme M
{mmM N
NumberHelpermmN Z
.mmZ [
GetTotalmm[ c
(mmc d
segmentnn 
.nn 
FirstRangeStartnn +
,nn+ ,
segmentnn- 4
.nn4 5
FirstRangeEndnn5 B
,nnB C
segmentnnD K
.nnK L
SecondRangeStartnnL \
,nn\ ]
segmentnn^ e
.nne f
SecondRangeEndnnf t
,nnt u
segmentoo 
.oo 
ThirdRangeStartoo +
,oo+ ,
segmentoo- 4
.oo4 5
ThirdRangeEndoo5 B
)ooB C
}ooC D
</td></tr></table>ooD V
"ooV W
;ooW X
}pp 
stringrr 
bodyrr 
=rr 
$@"rr 
<br/><p>Dear rr *
{rr* +
vendorrr+ 1
.rr1 2
Namerr2 6
}rr6 7¬
µ</p><br/>
                    Please find below Order details<br/><br/>
                    <table border=""2"">
                    <tr><th align=""left""> Reference #:</th><td>ru7 A
{uuA B
campaignuuB J
.uuJ K
ApproveduuK S
.uuS T
ReferenceNumberuuT c
}uuc dT
H</td></tr>
                    <tr><th align=""left"">Order #:</th><td>uvd <
{vv< =
orderNumbervv= H
}vvH IZ
N</td></tr>
                    <tr><th align=""left"">Campaign Name:</th><td>vwI B
{wwB C
campaignwwC K
.wwK L
ApprovedwwL T
.wwT U
CampaignNamewwU a
}wwa bX
L</td></tr>
                    <tr><th align=""left"">Rebroadcast:</th><td>wxb @
{xx@ A
(xxA B
campaignxxB J
.xxJ K
ApprovedxxK S
.xxS T
ReBroadCastxxT _
?xx_ `
$strxxa f
:xxf g
$strxxh l
)xxl m
}xxm nÉ
w</td></tr>                                        
                    <tr><th align=""left"">Broadcast Date:</th><td>xyn C
{yyC D
campaignyyD L
.yyL M
ApprovedyyM U
.yyU V

DeployDateyyV `
.yy` a
Valueyya f
:yyf g
dyyg h
}yyh iV
J</td></tr>
                    <tr><th align=""left"">From Line:</th><td>yzi >
{zz> ?
campaignzz? G
.zzG H
ApprovedzzH P
.zzP Q
FromLinezzQ Y
}zzY ZY
M</td></tr>
                    <tr><th align=""left"">Subject Line:</th><td>z{Z A
{{{A B
campaign{{B J
.{{J K
Approved{{K S
.{{S T
SubjectLine{{T _
}{{_ `T
H</td></tr>
                    <tr><th align=""left"">Opt Out:</th><td>{|` <
{||< =
campaign||= E
.||E F
OptOut||F L
}||L MX
L</td></tr>
                    <tr><th align=""left"">White Label:</th><td>|}M @
{}}@ A
campaign}}A I
.}}I J
Approved}}J R
.}}R S

WhiteLabel}}S ]
}}}] ^Ñ
x</td></tr>                                        
                    <tr><th align=""left"">Personalization:</th><td>}~^ D
{~~D E
(~~E F
campaign~~F N
.~~N O
IsPersonalization~~O `
?~~` a
$str~~b g
:~~g h
$str~~i m
)~~m n
}~~n oY
M</td></tr>
                    <tr><th align=""left"">Creative URL:</th><td>~o A
{A B
campaignB J
.J K
AssetsK Q
.Q R
CreativeUrlR ]
}] ^V
I</td></tr>
                    <tr><th align=""left"">Quantity:</th><td>	Ä^ =
{
ÄÄ= >
quantity
ÄÄ> F
}
ÄÄF GV
H</td></tr>
                    <tr><th align=""left"">Geo (s):</th><td>
ÄÅG <
{
ÅÅ< =
campaign
ÅÅ= E
.
ÅÅE F
Approved
ÅÅF N
.
ÅÅN O

GeoDetails
ÅÅO Y
}
ÅÅY Z[
M</td></tr>
                    <tr><th align=""left"">Demographics:</th><td>
ÅÇZ A
{
ÇÇA B
campaign
ÇÇB J
.
ÇÇJ K
Approved
ÇÇK S
.
ÇÇS T
Demographics
ÇÇT `
}
ÇÇ` aZ
L</td></tr>
                    <tr><tr><th align=""left"">Zip URL:</th><td>
ÇÉa @
{
ÉÉ@ A
campaign
ÉÉA I
.
ÉÉI J
Assets
ÉÉJ P
.
ÉÉP Q

ZipCodeUrl
ÉÉQ [
}
ÉÉ[ \c
U</td></tr>
                    <tr><th align=""left"">Special Instructions:</th><td>
ÉÑ\ I
{
ÑÑI J
campaign
ÑÑJ R
.
ÑÑR S
Approved
ÑÑS [
.
ÑÑ[ \!
SpecialInstructions
ÑÑ\ o
}
ÑÑo pZ
L</td></tr>
                    <tr><th align=""left"">Deploy Date:</th><td>
ÑÖp @
{
ÖÖ@ A

deployDate
ÖÖA K
}
ÖÖK LZ
L</td></tr>
                    <tr><th align=""left"">Deploy Time:</th><td>
ÖÜL @
{
ÜÜ@ A

deployTime
ÜÜA K
}
ÜÜK L^
P</td></tr>
                    <tr><th align=""left"">ReportSite Link:</th><td>
ÜáL D
{
ááD E
campaign
ááE M
.
ááM N
Approved
ááN V
.
ááV W
ReportSiteLink
ááW e
}
ááe f\
N</td></tr>
                    <tr><th align=""left"">Link Breakout:</th><td>
áàf B
{
ààB C
campaign
ààC K
.
ààK L
Approved
ààL T
.
ààT U
LinkBreakout
ààU a
}
ààa b]
O</td></tr>
                    <tr><th align=""left"">Has Open Pixel:</th><td>
àâb C
{
ââC D
(
ââD E
campaign
ââE M
.
ââM N
Approved
ââN V
.
ââV W
IsOpenPixel
ââW b
?
ââb c
$str
ââd i
:
ââi j
$str
ââk o
)
ââo p
}
ââp q]
O</td></tr>
                    <tr><th align=""left"">Open Pixel URL:</th><td>
âäq C
{
ääC D
campaign
ääD L
.
ääL M
Approved
ääM U
.
ääU V
OpenPixelUrl
ääV b
}
ääb cY
K</td></tr>
                    <tr><th align=""left"">Open Goals:</th><td>
äãc ?
{
ãã? @
campaign
ãã@ H
.
ããH I
Approved
ããI Q
.
ããQ R
	OpenGoals
ããR [
}
ãã[ \Z
L</td></tr>
                    <tr><th align=""left"">Click Goals:</th><td>
ãå\ @
{
åå@ A
campaign
ååA I
.
ååI J
Approved
ååJ R
.
ååR S

ClickGoals
ååS ]
}
åå] ^[
M</td></tr>
                    <tr><th align=""left"">Segment Data:</th><td>
åç^ A
{
ççA B
segmentsHtml
ççB N
}
ççN OC
5</td></tr>
                    </table></p> <p></p> 
çéO )
{
éé) *
Footer
éé* 0
}
éé0 1
"
éé1 2
;
éé2 3
	SendEmail
èè 
(
èè 
vendor
èè 
.
èè 
Email
èè "
,
èè" #
subject
èè$ +
,
èè+ ,
body
èè- 1
,
èè1 2
vendor
èè3 9
.
èè9 :
CcEmails
èè: B
)
èèB C
;
èèC D
}
êê 	
public
íí 
static
íí 
void
íí '
SendNotificationsToVendor
íí 4
(
íí4 5
Vendor
íí5 ;
vendor
íí< B
,
ííB C
List
ííD H
<
ííH I
Campaign
ííI Q
>
ííQ R
	campaigns
ííS \
)
íí\ ]
{
ìì 	
string
îî 
subject
îî 
=
îî 
$str
îî <
;
îî< =
StringBuilder
ññ 
problems
ññ "
=
ññ# $
new
ññ% (
StringBuilder
ññ) 6
(
ññ6 7
$strññ7 Ç
)ññÇ É
;ññÉ Ñ
foreach
óó 
(
óó 
var
óó 
campaign
óó !
in
óó" $
	campaigns
óó% .
)
óó. /
{
òò 
foreach
ôô 
(
ôô 
var
ôô 
notification
ôô )
in
ôô* ,
campaign
ôô- 5
.
ôô5 6
Notifications
ôô6 C
)
ôôC D
{
öö 
problems
õõ 
.
õõ 
Append
õõ #
(
õõ# $
$"
õõ$ &
<tr><td>
õõ& .
{
õõ. /
campaign
õõ/ 7
.
õõ7 8
OrderNumber
õõ8 C
}
õõC D
	</td><td>
õõD M
{
õõM N
campaign
õõN V
.
õõV W
CampaignName
õõW c
}
õõc d
	</td><td>
õõd m
{
õõm n
notification
õõn z
.
õõz {
	CheckTimeõõ{ Ñ
}õõÑ Ö
	</td><td>õõÖ é
{õõé è
(õõè ê
QcRuleõõê ñ
)õõñ ó
notificationõõó £
.õõ£ §
QcRuleõõ§ ™
}õõ™ ´
	</td><td>õõ´ ¥
{õõ¥ µ
QcRuleUtilityõõµ ¬
.õõ¬ √
	GetStringõõ√ Ã
(õõÃ Õ
notificationõõÕ Ÿ
.õõŸ ⁄
QcRuleõõ⁄ ‡
)õõ‡ ·
}õõ· ‚

</td></tr>õõ‚ Ï
"õõÏ Ì
)õõÌ Ó
;õõÓ Ô
}
úú 
}
ùù 
problems
ûû 
.
ûû 
Append
ûû 
(
ûû 
$str
ûû &
)
ûû& '
;
ûû' (
string
üü 
body
üü 
=
üü 
$@"
üü 
<br/><p>Dear 
üü *
{
üü* +
vendor
üü+ 1
.
üü1 2
Name
üü2 6
}
üü6 7K
=</p><br/>There is problem with these orders<br/><br/></p> <p>
üü7 t
{
üüt u
problems
üüu }
}
üü} ~
</p> üü~ É
{üüÉ Ñ
FooterüüÑ ä
}üüä ã
"üüã å
;üüå ç
	SendEmail
†† 
(
†† 
vendor
†† 
.
†† 
Email
†† "
,
††" #
subject
††$ +
,
††+ ,
body
††- 1
,
††1 2
vendor
††3 9
.
††9 :
CcEmails
††: B
)
††B C
;
††C D
}
°° 	
public
££ 
static
££ 
void
££ 
SendErrorEmail
££ )
(
££) *
string
££* 0
to
££1 3
,
££3 4
	Exception
££5 >
ex
££? A
,
££A B
string
££C I
currentController
££J [
,
££[ \
string
££] c
currentAction
££d q
)
££q r
{
§§ 	
if
•• 
(
•• "
ConfigurationManager
•• $
.
••$ %
AppSettings
••% 0
[
••0 1
$str
••1 9
]
••9 :
==
••; =
$str
••> D
)
••D E
{
¶¶ 
string
ßß 
subject
ßß 
=
ßß  
$str
ßß! F
;
ßßF G
string
®® 
body
®® 
=
®® 
$@"
®® !f
X<p>ADSLive: An error has been occured.</p>
                            <p>Controller : 
®©! ,
{
©©, -
currentController
©©- >
}
©©> ?
</p><p>Action : 
©©? O
{
©©O P
currentAction
©©P ]
}
©©] ^C
5</p>
                            <p>Error Details : 
©™^ /
{
™™/ 0
ex
™™0 2
.
™™2 3!
GetExceptionMessage
™™3 F
(
™™F G
)
™™G H
}
™™H I
</p>
™™I M
"
™™M N
;
™™N O
	SendEmail
´´ 
(
´´ 
to
´´ 
,
´´ 
subject
´´ %
,
´´% &
body
´´' +
)
´´+ ,
;
´´, -
}
¨¨ 
}
≠≠ 	
public
ØØ 
static
ØØ 
async
ØØ 
Task
ØØ  
SendEmailAsync
ØØ! /
(
ØØ/ 0
string
ØØ0 6
to
ØØ7 9
,
ØØ9 :
string
ØØ; A
subject
ØØB I
,
ØØI J
string
ØØK Q
body
ØØR V
,
ØØV W
string
ØØX ^
ccEmails
ØØ_ g
=
ØØh i
$str
ØØj l
,
ØØl m
string
ØØn t
	bccEmails
ØØu ~
=ØØ Ä
$strØØÅ É
,ØØÉ Ñ
ListØØÖ â
<ØØä ã
stringØØå í
>ØØí ì
attachmentsØØî ü
=ØØ† °
nullØØ¢ ¶
)ØØ¶ ß
{
∞∞ 	
using
±± 
(
±± 
var
±± 

smtpClient
±± !
=
±±" #
new
±±$ '

SmtpClient
±±( 2
(
±±2 3
)
±±3 4
)
±±4 5
{
≤≤ 
var
≥≥ 
msg
≥≥ 
=
≥≥ 
CreateMessage
≥≥ '
(
≥≥' (
to
≥≥( *
,
≥≥* +
subject
≥≥, 3
,
≥≥3 4
body
≥≥5 9
,
≥≥9 :
ccEmails
≥≥; C
,
≥≥C D
	bccEmails
≥≥E N
,
≥≥N O
attachments
≥≥P [
)
≥≥[ \
;
≥≥\ ]
await
¥¥ 

smtpClient
¥¥  
.
¥¥  !
SendMailAsync
¥¥! .
(
¥¥. /
msg
¥¥/ 2
)
¥¥2 3
;
¥¥3 4
}
µµ 
}
∂∂ 	
public
∏∏ 
static
∏∏ 
void
∏∏ 
	SendEmail
∏∏ $
(
∏∏$ %
string
∏∏% +
to
∏∏, .
,
∏∏. /
string
∏∏0 6
subject
∏∏7 >
,
∏∏> ?
string
∏∏@ F
body
∏∏G K
,
∏∏K L
string
∏∏M S
ccEmails
∏∏T \
=
∏∏] ^
$str
∏∏_ a
,
∏∏a b
string
∏∏c i
	bccEmails
∏∏j s
=
∏∏t u
$str
∏∏v x
,
∏∏x y
List
∏∏z ~
<
∏∏~ 
string∏∏ Ö
>∏∏Ö Ü
attachments∏∏á í
=∏∏ì î
null∏∏ï ô
)∏∏ô ö
{
ππ 	
using
∫∫ 
(
∫∫ 
var
∫∫ 

smtpClient
∫∫ !
=
∫∫" #
new
∫∫$ '

SmtpClient
∫∫( 2
(
∫∫2 3
)
∫∫3 4
)
∫∫4 5
{
ªª 
var
ºº 
msg
ºº 
=
ºº 
CreateMessage
ºº '
(
ºº' (
to
ºº( *
,
ºº* +
subject
ºº, 3
,
ºº3 4
body
ºº5 9
,
ºº9 :
ccEmails
ºº; C
,
ººC D
	bccEmails
ººE N
,
ººN O
attachments
ººP [
)
ºº[ \
;
ºº\ ]

smtpClient
ΩΩ 
.
ΩΩ 
Send
ΩΩ 
(
ΩΩ  
msg
ΩΩ  #
)
ΩΩ# $
;
ΩΩ$ %
}
ææ 
}
øø 	
private
¡¡ 
static
¡¡ 
MailMessage
¡¡ "
CreateMessage
¡¡# 0
(
¡¡0 1
string
¡¡1 7
to
¡¡8 :
,
¡¡: ;
string
¡¡< B
subject
¡¡C J
,
¡¡J K
string
¡¡L R
body
¡¡S W
,
¡¡W X
string
¡¡Y _
ccEmails
¡¡` h
=
¡¡i j
$str
¡¡k m
,
¡¡m n
string
¡¡o u
	bccEmails
¡¡v 
=¡¡Ä Å
$str¡¡Ç Ñ
,¡¡Ñ Ö
List¡¡Ü ä
<¡¡ä ã
string¡¡ã ë
>¡¡ë í
attachments¡¡ì û
=¡¡ü †
null¡¡° •
)¡¡• ¶
{
¬¬ 	
MailMessage
√√ 
msg
√√ 
=
√√ 
new
√√ !
MailMessage
√√" -
(
√√- .
)
√√. /
;
√√/ 0
msg
ƒƒ 
.
ƒƒ 
To
ƒƒ 
.
ƒƒ 
Add
ƒƒ 
(
ƒƒ 
new
ƒƒ 
MailAddress
ƒƒ &
(
ƒƒ& '
to
ƒƒ' )
)
ƒƒ) *
)
ƒƒ* +
;
ƒƒ+ ,
if
≈≈ 
(
≈≈ 
!
≈≈ 
string
≈≈ 
.
≈≈ 
IsNullOrEmpty
≈≈ %
(
≈≈% &
ccEmails
≈≈& .
)
≈≈. /
)
≈≈/ 0
{
∆∆ 
foreach
«« 
(
«« 
var
«« 
ccEmail
«« $
in
««% '
ccEmails
««( 0
.
««0 1
Split
««1 6
(
««6 7
$str
««7 ;
.
««; <
ToCharArray
««< G
(
««G H
)
««H I
,
««I J 
StringSplitOptions
««K ]
.
««] ^ 
RemoveEmptyEntries
««^ p
)
««p q
)
««q r
{
»» 
msg
…… 
.
…… 
CC
…… 
.
…… 
Add
…… 
(
…… 
ccEmail
…… &
)
……& '
;
……' (
}
   
}
ÀÀ 
if
ÕÕ 
(
ÕÕ 
!
ÕÕ 
string
ÕÕ 
.
ÕÕ 
IsNullOrEmpty
ÕÕ %
(
ÕÕ% &
	bccEmails
ÕÕ& /
)
ÕÕ/ 0
)
ÕÕ0 1
{
ŒŒ 
foreach
œœ 
(
œœ 
var
œœ 
bccEmail
œœ %
in
œœ& (
	bccEmails
œœ) 2
.
œœ2 3
Split
œœ3 8
(
œœ8 9
$str
œœ9 =
.
œœ= >
ToCharArray
œœ> I
(
œœI J
)
œœJ K
,
œœK L 
StringSplitOptions
œœM _
.
œœ_ ` 
RemoveEmptyEntries
œœ` r
)
œœr s
)
œœs t
{
–– 
msg
—— 
.
—— 
Bcc
—— 
.
—— 
Add
—— 
(
——  
bccEmail
——  (
)
——( )
;
——) *
}
““ 
}
”” 
msg
’’ 
.
’’ 
Subject
’’ 
=
’’ 
subject
’’ !
;
’’! "
msg
÷÷ 
.
÷÷ 

IsBodyHtml
÷÷ 
=
÷÷ 
true
÷÷ !
;
÷÷! "
msg
◊◊ 
.
◊◊ 
Body
◊◊ 
=
◊◊ 
body
◊◊ 
;
◊◊ 
if
ÿÿ 
(
ÿÿ 
attachments
ÿÿ 
!=
ÿÿ 
null
ÿÿ #
)
ÿÿ# $
foreach
ŸŸ 
(
ŸŸ 
var
ŸŸ 

attachment
ŸŸ '
in
ŸŸ( *
attachments
ŸŸ+ 6
)
ŸŸ6 7
{
⁄⁄ 
msg
€€ 
.
€€ 
Attachments
€€ #
.
€€# $
Add
€€$ '
(
€€' (
new
€€( +
System
€€, 2
.
€€2 3
Net
€€3 6
.
€€6 7
Mail
€€7 ;
.
€€; <

Attachment
€€< F
(
€€F G

attachment
€€G Q
)
€€Q R
)
€€R S
;
€€S T
}
‹‹ 
return
›› 
msg
›› 
;
›› 
}
ﬁﬁ 	
}
ﬂﬂ 
}‡‡ ¸C
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\ExceptionHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

static 
class 
ExceptionHelper '
{ 
public 
static 
string 
GetExceptionMessage 0
(0 1
this1 5
	Exception6 ?
ex@ B
,B C
stringD J
customMessageK X
=Y Z
$str[ ]
)] ^
{ 	
var 
message 
= 
( 
customMessage (
!=) +
$str, .
). /
? 
customMessage 
+  !
$str" %
+& '
ex( *
.* +
GetBaseException+ ;
(; <
)< =
.= >
Message> E
: 
ex 
. 
GetBaseException %
(% &
)& '
.' (
Message( /
;/ 0
message 
+= 
$str #
+$ %
ex& (
.( )

StackTrace) 3
+3 4
$str5 =
;= >
if 
( 
ex 
is 
SqlException "
)" #
{ 
return 
$str 6
+7 8
message9 @
;@ A
} 
else 
if 
( 
ex 
is $
IndexOutOfRangeException 3
)3 4
{ 
return 
$str 1
+2 3
message4 ;
;; <
} 
else 
if 
( 
ex 
is '
DbEntityValidationException 6
)6 7
{   
var!! 
	exception!! 
=!! 
(!!  !'
DbEntityValidationException!!! <
)!!< =
ex!!= ?
;!!? @
var"" 
errorMessages"" !
=""" #
	exception""$ -
.""- ."
EntityValidationErrors"". D
.## 

SelectMany## 
(##  
x##  !
=>##" $
x##% &
.##& '
ValidationErrors##' 7
)##7 8
.$$ 
Select$$ 
($$ 
x$$ 
=>$$  
x$$! "
.$$" #
ErrorMessage$$# /
)$$/ 0
;$$0 1
var%% 
messages%% 
=%% 
errorMessages%% ,
.%%, -
	Aggregate%%- 6
(%%6 7
$str%%7 9
,%%9 :
(&& 
current&& 
,&& 
errorMessage&& *
)&&* +
=>&&, .
current&&/ 6
+&&7 8
(&&9 :
$str&&: @
+&&A B
errorMessage&&C O
+&&P Q
$str&&R Y
)&&Y Z
)&&Z [
;&&[ \
return'' 
message'' 
+''  
$str''! (
+'') *
messages''+ 3
;''3 4
}(( 
else)) 
if)) 
()) 
ex)) 
is)) +
EntityCommandExecutionException)) :
))): ;
{** 
return++ 
$str++ >
+++? @
message++A H
;++H I
},, 
else-- 
if-- 
(-- 
ex-- 
is-- 
SecurityException-- ,
)--, -
{.. 
return// 
$str// *
+//+ ,
message//- 4
;//4 5
}00 
else11 
if11 
(11 
ex11 
is11 
SystemException11 *
)11* +
{22 
return33 
message33 
;33 
}44 
else55 
if55 
(55 
ex55 
is55  
ApplicationException55 /
)55/ 0
{66 
return77 
message77 
;77 
}88 
else99 
{:: 
return;; 
message;; 
;;; 
}<< 
}== 	
public>> 
static>> 
void>> 
HandleException>> *
(>>* +
this>>+ /
	Exception>>0 9
ex>>: <
,>>< =
string>>> D
customMessage>>E R
=>>S T
$str>>U W
)>>W X
{?? 	
var@@ 
message@@ 
=@@ 
(@@ 
customMessage@@ (
!=@@) +
$str@@, .
)@@. /
?AA 
customMessageAA 
+AA  !
$strAA" %
+AA& '
exAA( *
.AA* +
GetBaseExceptionAA+ ;
(AA; <
)AA< =
.AA= >
MessageAA> E
:BB 
exBB 
.BB 
GetBaseExceptionBB %
(BB% &
)BB& '
.BB' (
MessageBB( /
;BB/ 0
ifCC 
(CC 
exCC 
isCC 
SqlExceptionCC "
)CC" #
{DD 
}FF 
elseGG 
ifGG 
(GG 
exGG 
isGG $
IndexOutOfRangeExceptionGG 3
)GG3 4
{HH 
}JJ 
elseKK 
ifKK 
(KK 
exKK 
isKK '
DbEntityValidationExceptionKK 6
)KK6 7
{LL 
varMM 
	exceptionMM 
=MM 
(MM  !'
DbEntityValidationExceptionMM! <
)MM< =
exMM= ?
;MM? @
varNN 
errorMessagesNN !
=NN" #
	exceptionNN$ -
.NN- ."
EntityValidationErrorsNN. D
.OO 

SelectManyOO 
(OO  
xOO  !
=>OO" $
xOO% &
.OO& '
ValidationErrorsOO' 7
)OO7 8
.PP 
SelectPP 
(PP 
xPP 
=>PP  
xPP! "
.PP" #
ErrorMessagePP# /
)PP/ 0
;PP0 1
varQQ 
messagesQQ 
=QQ 
errorMessagesQQ ,
.QQ, -
	AggregateQQ- 6
(QQ6 7
$strQQ7 9
,QQ9 :
(RR 
currentRR 
,RR 
errorMessageRR *
)RR* +
=>RR, .
currentRR/ 6
+RR7 8
(RR9 :
$strRR: @
+RRA B
errorMessageRRC O
+RRP Q
$strRRR Y
)RRY Z
)RRZ [
;RR[ \
}TT 
elseUU 
ifUU 
(UU 
exUU 
isUU +
EntityCommandExecutionExceptionUU :
)UU: ;
{VV 
}XX 
elseYY 
ifYY 
(YY 
exYY 
isYY 
SecurityExceptionYY ,
)YY, -
{ZZ 
}\\ 
else]] 
if]] 
(]] 
ex]] 
is]] 
SystemException]] *
)]]* +
{^^ 
}`` 
elseaa 
ifaa 
(aa 
exaa 
isaa  
ApplicationExceptionaa /
)aa/ 0
{bb 
}dd 
elseee 
{ff 
}hh 
}ii 	
}jj 
publicnn 

staticnn 
classnn %
ControllerExceptionHelpernn 1
{oo 
publicpp 
staticpp 
stringpp 
GetModelStateErrorspp 0
(pp0 1
thispp1 5
ICollectionpp6 A
<ppA B

ModelStateppB L
>ppL M
valuesppN T
)ppT U
{qq 	
varrr 
sbrr 
=rr 
newrr 
StringBuilderrr &
(rr& '
)rr' (
;rr( )
foreachss 
(ss 
varss 

modelStatess #
inss$ &
valuesss' -
)ss- .
{tt 
foreachuu 
(uu 
varuu 
erroruu "
inuu# %

modelStateuu& 0
.uu0 1
Errorsuu1 7
)uu7 8
{vv 
varww 
liww 
=ww 
newww  

TagBuilderww! +
(ww+ ,
$strww, 0
)ww0 1
;ww1 2
lixx 
.xx 
SetInnerTextxx #
(xx# $
errorxx$ )
.xx) *
ErrorMessagexx* 6
)xx6 7
;xx7 8
sbyy 
.yy 
Appendyy 
(yy 
liyy  
)yy  !
;yy! "
}zz 
}{{ 
return|| 
sb|| 
.|| 
ToString|| 
(|| 
)||  
;||  !
}}} 	
}~~ 
} ≠
EE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\FileHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 

FileHelper 
{ 
public 
static 
readonly 
string %&
UploadsSupplierListingPath& @
=A B
HttpContextC N
.N O
CurrentO V
.V W
ServerW ]
.] ^
MapPath^ e
(e f
$str	f É
)
É Ñ
;
Ñ Ö
public

 
static

 
string

 
GetImagePath

 )
(

) *
string

* 0
fileName

1 9
)

9 :
{ 	
return &
UploadsSupplierListingPath -
+- .
$str. 2
+2 3
fileName3 ;
+; <
$str< B
;B C
} 	
public 
static 
string 
GetValidFileName -
(- .
string. 4
fileName5 =
)= >
{ 	
string 
ret 
= 
Regex 
. 
Replace &
(& '
fileName' /
./ 0
Trim0 4
(4 5
)5 6
,6 7
$str8 J
,J K
$strL N
)N O
;O P
return 
ret 
. 
Replace 
( 
$str "
," #
string$ *
.* +
Empty+ 0
)0 1
;1 2
} 	
} 
}  
LE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\GatePassGenerator.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
GatePassGenerator "
{ 
public 
static 
string 

GetNewPass '
(' (
)( )
{		 	
byte

 
[

 
]

 
buffer

 
=

 
Guid

  
.

  !
NewGuid

! (
(

( )
)

) *
.

* +
ToByteArray

+ 6
(

6 7
)

7 8
;

8 9
var 

formNumber 
= 
BitConverter )
.) *
ToUInt32* 2
(2 3
buffer3 9
,9 :
$num; <
)< =
^> ?
BitConverter@ L
.L M
ToUInt32M U
(U V
bufferV \
,\ ]
$num^ _
)_ `
^a b
BitConverterc o
.o p
ToUInt32p x
(x y
buffery 
,	 Ä
$num
Å Ç
)
Ç É
^
Ñ Ö
BitConverter
Ü í
.
í ì
ToUInt32
ì õ
(
õ ú
buffer
ú ¢
,
¢ £
$num
§ ¶
)
¶ ß
;
ß ®
return 

formNumber 
. 
ToString &
(& '
$str' *
)* +
;+ ,
} 	
static 
Random 
_random 
= 
new  #
Random$ *
(* +
)+ ,
;, -
public 
static 
string 

GetNewPass '
(' (
int( +
digits, 2
)2 3
{ 	
byte 
[ 
] 
buffer 
= 
new 
byte  $
[$ %
digits% +
/, -
$num. /
]/ 0
;0 1
_random 
. 
	NextBytes 
( 
buffer $
)$ %
;% &
string 
result 
= 
string "
." #
Concat# )
() *
buffer* 0
.0 1
Select1 7
(7 8
x8 9
=>: <
x= >
.> ?
ToString? G
(G H
$strH L
)L M
)M N
.N O
ToArrayO V
(V W
)W X
)X Y
;Y Z
if 
( 
digits 
% 
$num 
== 
$num 
)  
return 
result 
; 
return 
result 
+ 
_random #
.# $
Next$ (
(( )
$num) +
)+ ,
., -
ToString- 5
(5 6
$str6 9
)9 :
;: ;
} 	
} 
} 
AE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Hubs\WFPICTHub.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Hubs  
{ 
[ 
HubName 
( 
$str 
) 
] 
public 

class 
	WfpictHub 
: 
Hub  
{ 
private		 
readonly		 
WfpictUpdater		 &
_wfpictUpdater		' 5
;		5 6
public 
	WfpictHub 
( 
) 
: 
this !
(! "
WfpictUpdater" /
./ 0
Instance0 8
)8 9
{ 	
} 	
public 
	WfpictHub 
( 
WfpictUpdater &
wfpictUpdater' 4
)4 5
{ 	
_wfpictUpdater 
= 
wfpictUpdater *
;* +
} 	
public 
void  
StartUpdatingClients (
(( )
)) *
{ 	
_wfpictUpdater 
.  
StartUpdatingClients /
(/ 0
)0 1
;1 2
} 	
public 
void 
StopUpdatingClients '
(' (
)( )
{ 	
_wfpictUpdater   
.   
StopUpdatingClients   .
(  . /
)  / 0
;  0 1
}!! 	
}"" 
}## ì,
EE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Hubs\WFPICTUpdater.cs
	namespace

 	
ADSDataDirect


 
.

 
Web

 
.

 
Hubs

  
{ 
public 

class 
WfpictUpdater 
{ 
private 
readonly 
static 
Lazy  $
<$ %
WfpictUpdater% 2
>2 3
	_instance4 =
=> ?
new 
Lazy 
< 
WfpictUpdater "
>" #
(# $
( 
) 
=> 
new 
WfpictUpdater '
(' (

GlobalHost 
. 
ConnectionManager 0
.0 1
GetHubContext1 >
<> ?
	WfpictHub? H
>H I
(I J
)J K
.K L
ClientsL S
)S T
)T U
;U V
private 
readonly 
object 
_lock  %
=& '
new( +
object, 2
(2 3
)3 4
;4 5
private 
readonly 
TimeSpan !
_updateInterval" 1
=2 3
TimeSpan4 <
.< =
FromSeconds= H
(H I
$numI K
)K L
;L M
private 
Timer 
_timer 
; 
private 
volatile 
bool 
_isUpdating )
;) *
private 
WfpictUpdater 
( !
IHubConnectionContext 3
<3 4
dynamic4 ;
>; <
clients= D
)D E
{ 	
Clients 
= 
clients 
; 
} 	
public 
static 
WfpictUpdater #
Instance$ ,
{   	
get!! 
{"" 
return## 
	_instance##  
.##  !
Value##! &
;##& '
}$$ 
}%% 	
private'' !
IHubConnectionContext'' %
<''% &
dynamic''& -
>''- .
Clients''/ 6
{(( 	
get)) 
;)) 
set** 
;** 
}++ 	
public-- 
void--  
StartUpdatingClients-- (
(--( )
)--) *
{.. 	
lock// 
(// 
_lock// 
)// 
{00 
_timer11 
=11 
new11 
Timer11 "
(11" #
UpdateClients11# 0
,110 1
null112 6
,116 7
_updateInterval118 G
,11G H
_updateInterval11I X
)11X Y
;11Y Z
}22 
}33 	
private55 
void55 
UpdateClients55 "
(55" #
object55# )
state55* /
)55/ 0
{66 	
lock77 
(77 
_lock77 
)77 
{88 
if99 
(99 
!99 
_isUpdating99  
)99  !
{:: 
_isUpdating;; 
=;;  !
true;;" &
;;;& '
using== 
(== 
var== 
db== !
===" #
new==$ '
WfpictContext==( 5
(==5 6
)==6 7
)==7 8
{>> 
var?? 
logs??  
=??! "
db??# %
.??% &

SystemLogs??& 0
.??0 1
OrderByDescending??1 B
(??B C
x??C D
=>??E G
x??H I
.??I J
	CreatedAt??J S
)??S T
.@@ 
Take@@ !
(@@! "
$num@@" %
)@@% &
.AA 
ToListAA #
(AA# $
)AA$ %
.BB 
SelectBB #
(BB# $
xBB$ %
=>BB& (
newBB) ,
SystemLogVmBB- 8
(BB8 9
)BB9 :
{CC 
	CreatedAtDD  )
=DD* +
xDD, -
.DD- .
	CreatedAtDD. 7
.DD7 8
ToStringDD8 @
(DD@ A
StringConstantsDDA P
.DDP Q 
DateTimeFormatDashesDDQ e
)DDe f
,DDf g
LogTypeEE  '
=EE( )
SystemEE* 0
.EE0 1
EnumEE1 5
.EE5 6
GetNameEE6 =
(EE= >
typeofEE> D
(EED E
LogTypeEEE L
)EEL M
,EEM N
(EEO P
LogTypeEEP W
)EEW X
xEEX Y
.EEY Z
LogTypeEEZ a
)EEa b
,EEb c
OrderNumberFF  +
=FF, -
xFF. /
.FF/ 0
OrderNumberFF0 ;
,FF; <
MessageGG  '
=GG( )
xGG* +
.GG+ ,
MessageGG, 3
}HH 
)HH 
.II 
ToListII #
(II# $
)II$ %
;II% &
ClientsJJ 
.JJ  
AllJJ  #
.JJ# $
refreshJJ$ +
(JJ+ ,
logsJJ, 0
)JJ0 1
;JJ1 2
}KK 
_isUpdatingLL 
=LL  !
falseLL" '
;LL' (
}MM 
}NN 
}OO 	
publicQQ 
voidQQ 
StopUpdatingClientsQQ '
(QQ' (
)QQ( )
{RR 	
lockSS 
(SS 
_lockSS 
)SS 
{TT 
ifUU 
(UU 
_timerUU 
!=UU 
nullUU "
)UU" #
{VV 
_timerWW 
.WW 
DisposeWW "
(WW" #
)WW# $
;WW$ %
}XX 
}YY 
}ZZ 	
}[[ 
}\\ ìù
?E:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\API\Campaign.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
API 
{ 
public 

class 
Campaign 
{ 
private		 
static		 
readonly		 
SortedDictionary		  0
<		0 1
int		1 4
,		4 5
KeyValuePair		6 B
<		B C
int		C F
,		F G
int		H K
>		K L
>		L M,
 HoursPercentageDictionaryDynamic		N n
=

 
new

 
SortedDictionary

 "
<

" #
int

# &
,

& '
KeyValuePair

( 4
<

4 5
int

5 8
,

8 9
int

: =
>

= >
>

> ?
(

? @
)

@ A
{ 	
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ -
,- .
$num/ 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ -
,- .
$num/ 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
} 	
;	 

public 
static 
double  
GetPercentageDynamic 1
(1 2
int2 5
hr6 8
)8 9
{ 	
var 
r 
= 
new 
Random 
( 
)  
;  !
double 
finalPercentage "
=# $
$num% (
;( )
if 
( 
hr 
>= 
$num 
) 
finalPercentage 
+=  "
r# $
.$ %
Next% )
() *,
 HoursPercentageDictionaryDynamic* J
[J K
$numK L
]L M
.M N
KeyN Q
,Q R,
 HoursPercentageDictionaryDynamicS s
[s t
$numt u
]u v
.v w
Valuew |
)| }
/~ 
$num
Ä á
;
á à
if 
( 
hr 
>= 
$num 
) 
finalPercentage   
+=    "
r  # $
.  $ %
Next  % )
(  ) *,
 HoursPercentageDictionaryDynamic  * J
[  J K
$num  K L
]  L M
.  M N
Key  N Q
,  Q R,
 HoursPercentageDictionaryDynamic  S s
[  s t
$num  t u
]  u v
.  v w
Value  w |
)  | }
/  ~ 
$num
  Ä á
;
  á à
if!! 
(!! 
hr!! 
>=!! 
$num!! 
)!! 
finalPercentage"" 
+=""  "
r""# $
.""$ %
Next""% )
("") *,
 HoursPercentageDictionaryDynamic""* J
[""J K
$num""K L
]""L M
.""M N
Key""N Q
,""Q R,
 HoursPercentageDictionaryDynamic""S s
[""s t
$num""t u
]""u v
.""v w
Value""w |
)""| }
/""~ 
$num
""Ä á
;
""á à
if## 
(## 
hr## 
>=## 
$num## 
)## 
finalPercentage$$ 
+=$$  "
r$$# $
.$$$ %
Next$$% )
($$) *,
 HoursPercentageDictionaryDynamic$$* J
[$$J K
$num$$K L
]$$L M
.$$M N
Key$$N Q
,$$Q R,
 HoursPercentageDictionaryDynamic$$S s
[$$s t
$num$$t u
]$$u v
.$$v w
Value$$w |
)$$| }
/$$~ 
$num
$$Ä á
;
$$á à
if%% 
(%% 
hr%% 
>=%% 
$num%% 
)%% 
finalPercentage&& 
+=&&  "
r&&# $
.&&$ %
Next&&% )
(&&) *,
 HoursPercentageDictionaryDynamic&&* J
[&&J K
$num&&K L
]&&L M
.&&M N
Key&&N Q
,&&Q R,
 HoursPercentageDictionaryDynamic&&S s
[&&s t
$num&&t u
]&&u v
.&&v w
Value&&w |
)&&| }
/&&~ 
$num
&&Ä á
;
&&á à
if'' 
('' 
hr'' 
>='' 
$num'' 
)'' 
finalPercentage(( 
+=((  "
r((# $
.(($ %
Next((% )
((() *,
 HoursPercentageDictionaryDynamic((* J
[((J K
$num((K M
]((M N
.((N O
Key((O R
,((R S,
 HoursPercentageDictionaryDynamic((T t
[((t u
$num((u w
]((w x
.((x y
Value((y ~
)((~ 
/
((Ä Å
$num
((Ç â
;
((â ä
if)) 
()) 
hr)) 
>=)) 
$num)) 
))) 
finalPercentage** 
+=**  "
r**# $
.**$ %
Next**% )
(**) *,
 HoursPercentageDictionaryDynamic*** J
[**J K
$num**K M
]**M N
.**N O
Key**O R
,**R S,
 HoursPercentageDictionaryDynamic**T t
[**t u
$num**u w
]**w x
.**x y
Value**y ~
)**~ 
/
**Ä Å
$num
**Ç â
;
**â ä
if++ 
(++ 
hr++ 
>=++ 
$num++ 
)++ 
finalPercentage,, 
+=,,  "
r,,# $
.,,$ %
Next,,% )
(,,) *,
 HoursPercentageDictionaryDynamic,,* J
[,,J K
$num,,K M
],,M N
.,,N O
Key,,O R
,,,R S,
 HoursPercentageDictionaryDynamic,,T t
[,,t u
$num,,u w
],,w x
.,,x y
Value,,y ~
),,~ 
/
,,Ä Å
$num
,,Ç â
;
,,â ä
if-- 
(-- 
hr-- 
>=-- 
$num-- 
)-- 
finalPercentage.. 
+=..  "
r..# $
...$ %
Next..% )
(..) *,
 HoursPercentageDictionaryDynamic..* J
[..J K
$num..K M
]..M N
...N O
Key..O R
,..R S,
 HoursPercentageDictionaryDynamic..T t
[..t u
$num..u w
]..w x
...x y
Value..y ~
)..~ 
/
..Ä Å
$num
..Ç â
;
..â ä
if// 
(// 
hr// 
>=// 
$num// 
)// 
finalPercentage00 
+=00  "
r00# $
.00$ %
Next00% )
(00) *,
 HoursPercentageDictionaryDynamic00* J
[00J K
$num00K M
]00M N
.00N O
Key00O R
,00R S,
 HoursPercentageDictionaryDynamic00T t
[00t u
$num00u w
]00w x
.00x y
Value00y ~
)00~ 
/
00Ä Å
$num
00Ç â
;
00â ä
if11 
(11 
hr11 
>=11 
$num11 
)11 
finalPercentage22 
+=22  "
r22# $
.22$ %
Next22% )
(22) *,
 HoursPercentageDictionaryDynamic22* J
[22J K
$num22K M
]22M N
.22N O
Key22O R
,22R S,
 HoursPercentageDictionaryDynamic22T t
[22t u
$num22u w
]22w x
.22x y
Value22y ~
)22~ 
/
22Ä Å
$num
22Ç â
;
22â ä
return33 
finalPercentage33 "
;33" #
}44 	
private66 
static66 
readonly66 
SortedDictionary66  0
<660 1
int661 4
,664 5
double666 <
>66< =%
HoursPercentageDictionary66> W
=66X Y
new66Z ]
SortedDictionary66^ n
<66n o
int66o r
,66r s
double66t z
>66z {
(66{ |
)66| }
{77 	
{88 
$num88 
,88 
$num88 
}88 
,88 
{88 
$num88 
,88 
$num88 $
}88$ %
,88% &
{88' (
$num88( )
,88) *
$num88+ 1
}881 2
,882 3
{884 5
$num885 7
,887 8
$num889 ?
}88? @
,88@ A
{88B C
$num88C E
,88E F
$num88G M
}88M N
,88N O
{88P Q
$num88Q S
,88S T
$num88U [
}88[ \
,88\ ]
{88^ _
$num88_ a
,88a b
$num88c i
}88i j
,88j k
{88l m
$num88m o
,88o p
$num88q w
}88w x
,88x y
{88z {
$num88{ }
,88} ~
$num	88 Ö
}
88Ö Ü
}99 	
;99	 

public?? 
static?? 
double?? 
GetPercentage?? *
(??* +
int??+ .
hr??/ 1
)??1 2
{@@ 	
ifAA 
(AA 
hrAA 
>=AA 
$numAA 
)AA 
returnAA  %
HoursPercentageDictionaryAA! :
[AA: ;
$numAA; =
]AA= >
;AA> ?
intCC 
actualHrCC 
=CC 
-CC 
$numCC 
;CC 
intDD 
[DD 
]DD 
hrsDD 
=DD %
HoursPercentageDictionaryDD 1
.DD1 2
KeysDD2 6
.DD6 7
ToArrayDD7 >
(DD> ?
)DD? @
;DD@ A
forEE 
(EE 
intEE 
iEE 
=EE 
$numEE 
;EE 
iEE 
<EE 
hrsEE "
.EE" #
LengthEE# )
;EE) *
iEE* +
++EE+ -
)EE- .
{FF 
ifGG 
(GG 
hrGG 
>=GG 
hrsGG 
[GG 
iGG 
]GG  
&&GG! #
hrGG$ &
<GG' (
hrsGG) ,
[GG, -
iGG- .
+GG/ 0
$numGG1 2
]GG2 3
)GG3 4
{HH 
actualHrII 
=II 
hrsII "
[II" #
iII# $
]II$ %
;II% &
breakJJ 
;JJ 
}KK 
}LL 
returnMM %
HoursPercentageDictionaryMM ,
[MM, -
actualHrMM- 5
]MM5 6
;MM6 7
}NN 	
publicPP 
staticPP 
intPP 
GetOpensPP "
(PP" #
longPP# '
quantityPP( 0
,PP0 1
DateTimePP2 :
startDateTimePP; H
)PPH I
{QQ 	
intRR 
	hrsPassedRR 
=RR 
(RR 
intRR  
)RR  !
MathRR! %
.RR% &
RoundRR& +
(RR+ ,
(RR, -
DateTimeRR- 5
.RR5 6
NowRR6 9
-RR: ;
startDateTimeRR< I
)RRI J
.RRJ K

TotalHoursRRK U
)RRU V
;RRV W
returnSS 
(SS 
intSS 
)SS 
MathSS 
.SS 
RoundSS #
(SS# $
quantitySS$ ,
*SS- . 
GetPercentageDynamicSS/ C
(SSC D
	hrsPassedSSD M
)SSM N
)SSN O
;SSO P
}TT 	
publicVV 
stringVV 
CampaignNameVV "
{VV# $
getVV% (
;VV( )
setVV* -
;VV- .
}VV/ 0
publicWW 
stringWW 
OrderNumberWW !
{WW" #
getWW$ '
;WW' (
setWW) ,
;WW, -
}WW. /
publicXX 
stringXX 
IoNumberXX 
{XX  
getXX! $
;XX$ %
setXX& )
;XX) *
}XX+ ,
publicYY 
stringYY 
	StartDateYY 
{YY  !
getYY" %
;YY% &
setYY' *
;YY* +
}YY, -
publicZZ 
stringZZ 

EmailsSentZZ  
{ZZ! "
getZZ# &
;ZZ& '
setZZ( +
;ZZ+ ,
}ZZ- .
public[[ 
string[[ 
EmailsOpened[[ "
{[[# $
get[[% (
;[[( )
set[[* -
;[[- .
}[[/ 0
public\\ 
string\\ 
EmailsClicked\\ #
{\\$ %
get\\& )
;\\) *
set\\+ .
;\\. /
}\\0 1
public^^ 
List^^ 
<^^ 
LinkBreakout^^  
>^^  !
LinkBreakout^^" .
{^^/ 0
get^^1 4
;^^4 5
set^^6 9
;^^9 :
}^^; <
public`` 
static`` 
Campaign`` 
FromCampaign`` +
(``+ ,
Core``, 0
.``0 1
Entities``1 9
.``9 :
Campaign``: B
campaign``C K
)``K L
{aa 	
longbb 
clickedbb 
=bb 
$numbb 
,bb 
openedbb $
=bb% &
$numbb' (
;bb( )
DateTimecc 
startDateTimecc "
=cc# $
DateTimecc% -
.cc- .
MinValuecc. 6
;cc6 7
stringdd 
ioNumberdd 
=dd 
$strdd "
;dd" #
ifee 
(ee 
campaignee 
.ee 
ProDatasee !
.ee! "
Countee" '
>ee( )
$numee* +
)ee+ ,
{ff 
clickedgg 
=gg 
campaigngg "
.gg" #
ProDatasgg# +
.gg+ ,
Sumgg, /
(gg/ 0
xgg0 1
=>gg2 4
xgg5 6
.gg6 7

ClickCountgg7 A
)ggA B
;ggB C
startDateTimehh 
=hh 
DateTimehh  (
.hh( )
Parsehh) .
(hh. /
campaignhh/ 7
.hh7 8
ProDatashh8 @
.hh@ A
FirstOrDefaulthhA O
(hhO P
)hhP Q
.hhQ R
CampaignStartDatehhR c
)hhc d
;hhd e
openedii 
=ii 
GetOpensii !
(ii! "
campaignii" *
.ii* +
Approvedii+ 3
.ii3 4
Quantityii4 <
,ii< =
startDateTimeii> K
)iiK L
;iiL M
}jj 
varkk 
modelkk 
=kk 
newkk 
Campaignkk $
(kk$ %
)kk% &
{ll 
CampaignNamemm 
=mm 
campaignmm '
.mm' (
Approvedmm( 0
.mm0 1
CampaignNamemm1 =
,mm= >
EmailsClickednn 
=nn 
clickednn  '
==nn( *
$numnn+ ,
?nn- .
$strnn/ 3
:nn4 5
clickednn6 =
.nn= >
ToStringnn> F
(nnF G
)nnG H
,nnH I
EmailsOpenedoo 
=oo 
openedoo %
==oo& (
$numoo) *
?oo+ ,
$stroo- 1
:oo2 3
openedoo4 :
.oo: ;
ToStringoo; C
(ooC D
)ooD E
,ooE F
IoNumberpp 
=pp 
campaignpp #
.pp# $
ProDataspp$ ,
.pp, -
FirstOrDefaultpp- ;
(pp; <
)pp< =
.pp= >
IOpp> @
,pp@ A
	StartDateqq 
=qq 
startDateTimeqq )
==qq* ,
DateTimeqq- 5
.qq5 6
MinValueqq6 >
?qq? @
$strqqA E
:qqF G
startDateTimeqqH U
.qqU V
ToStringqqV ^
(qq^ _
)qq_ `
,qq` a

EmailsSentrr 
=rr 
campaignrr %
.rr% &
Quantityrr& .
.rr. /
ToStringrr/ 7
(rr7 8
)rr8 9
,rr9 :
}ss 
;ss 
modeltt 
.tt 
LinkBreakouttt 
=tt  
newtt! $
Listtt% )
<tt) *
LinkBreakouttt* 6
>tt6 7
(tt7 8
)tt8 9
;tt9 :
foreachuu 
(uu 
varuu 
proDatauu  
inuu! #
campaignuu$ ,
.uu, -
ProDatasuu- 5
)uu5 6
{vv 
modelww 
.ww 
LinkBreakoutww "
.ww" #
Addww# &
(ww& '
newww' *
LinkBreakoutww+ 7
(ww7 8
)ww8 9
{xx 
Linkyy 
=yy 
proDatayy "
.yy" #
Destination_URLyy# 2
,yy2 3
Quantityzz 
=zz 
proDatazz &
.zz& '

ClickCountzz' 1
.zz1 2
ToStringzz2 :
(zz: ;
)zz; <
}{{ 
){{ 
;{{ 
}|| 
return}} 
model}} 
;}} 
}~~ 	
} 
public
ÅÅ 

class
ÅÅ 
LinkBreakout
ÅÅ 
{
ÇÇ 
public
ÉÉ 
string
ÉÉ 
Link
ÉÉ 
{
ÉÉ 
get
ÉÉ  
;
ÉÉ  !
set
ÉÉ" %
;
ÉÉ% &
}
ÉÉ' (
public
ÑÑ 
string
ÑÑ 
Quantity
ÑÑ 
{
ÑÑ  
get
ÑÑ! $
;
ÑÑ$ %
set
ÑÑ& )
;
ÑÑ) *
}
ÑÑ+ ,
}
ÖÖ 
}àà ã	
RE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignTrackingDetailVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class $
CampaignTrackingDetailVm )
:* +
CampaignTrackingVm, >
{ 
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Link 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 

ClickCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
UniqueCount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
MobileCount		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
} 
} ¶
KE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignSegmentVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
CampaignSegmentVm "
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
string		 
OrderNumber		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public 
string 
SegmentNumber #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DateTime 
? 
DeploymentDate '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
Quantity 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CreativeFiles #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
FirstRangeStart "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
FirstRangeEnd  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
SecondRangeStart #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
SecondRangeEnd !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
ThirdRangeStart "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
ThirdRangeEnd  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
SegmentDataFileUrl (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DateTime 
? 
DateFetched $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
UploadStatus 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
SegmentStatus  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
DateApproved %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
? 
DateComplete %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
}!! 
}"" ».
LE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignApprovedVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public		 

class		 
CampaignApprovedVm		 #
{

 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
Guid 
? 

CampaignId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
	CreatedAt !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
long 
ReferenceNumber #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ReBroadCast 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
ReBroadcastDate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 

DeployDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 

GeoDetails  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Demographics "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Range	 
( 
$num 
, 
int 
. 
MaxValue 
, 
ErrorMessage  ,
=- .
$str/ T
)T U
]U V
public 
long 
Quantity 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
SpecialInstructions )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
ReportSiteLink $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public   
string   
LinkBreakout   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
public## 
long## 
	OpenGoals## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
public$$ 
long$$ 

ClickGoals$$ 
{$$  
get$$! $
;$$$ %
set$$& )
;$$) *
}$$+ ,
public%% 
long%% 
DataFileQuantity%% $
{%%% &
get%%' *
;%%* +
set%%, /
;%%/ 0
}%%1 2
public&& 
string&& 
DataFileUrl&& !
{&&" #
get&&$ '
;&&' (
set&&) ,
;&&, -
}&&. /
public)) 
bool)) 
IsOpenPixel)) 
{))  !
get))" %
;))% &
set))' *
;))* +
})), -
public** 
string** 
OpenPixelUrl** "
{**# $
get**% (
;**( )
set*** -
;**- .
}**/ 0
public++ 
bool++ 
IsOmniOrder++ 
{++  !
get++" %
;++% &
set++' *
;++* +
}++, -
public,, 
DateTime,, 
?,, 
OmniDeployDate,, '
{,,( )
get,,* -
;,,- .
set,,/ 2
;,,2 3
},,4 5
public-- 
long-- 
Impressions-- 
{--  !
get--" %
;--% &
set--' *
;--* +
}--, -
public// 
bool// 
IsUseApiDataForOpen// '
{//( )
get//* -
;//- .
set/// 2
;//2 3
}//4 5
public11 
List11 
<11 
ChannelType11 
>11  
ChannelTypes11! -
{11. /
get110 3
;113 4
set115 8
;118 9
}11: ;
public33 
CampaignAsset33 
Assets33 #
{33$ %
get33& )
;33) *
set33+ .
;33. /
}330 1
public55 
ICollection55 
<55 
CampaignSegmentVm55 ,
>55, -
Segments55. 6
{557 8
get559 <
;55< =
set55> A
;55A B
}55C D
public77 
CampaignApprovedVm77 !
(77! "
)77" #
{88 	
Segments99 
=99 
new99 
HashSet99 "
<99" #
CampaignSegmentVm99# 4
>994 5
(995 6
)996 7
;997 8
}:: 	
};; 
}<< ÷.
KE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignTestingVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public		 

class		 
CampaignTestingVm		 "
{

 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
Guid 
? 

CampaignId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
	CreatedAt !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ReBroadCast 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
ReBroadcastDate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
IsTested 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
TestingTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
TestingUrgency !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 

DeployDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 

GeoDetails  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Demographics "
{# $
get% (
;( )
set* -
;- .
}/ 0
[   	
Range  	 
(   
$num   
,   
int   
.   
MaxValue   
,   
ErrorMessage    ,
=  - .
$str  / T
)  T U
]  U V
public!! 
long!! 
Quantity!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public"" 
string"" 
SpecialInstructions"" )
{""* +
get"", /
;""/ 0
set""1 4
;""4 5
}""6 7
public%% 
long%% 
	OpenGoals%% 
{%% 
get%%  #
;%%# $
set%%% (
;%%( )
}%%* +
public&& 
long&& 

ClickGoals&& 
{&&  
get&&! $
;&&$ %
set&&& )
;&&) *
}&&+ ,
public'' 
long'' 
DataFileQuantity'' $
{''% &
get''' *
;''* +
set'', /
;''/ 0
}''1 2
public(( 
string(( 
DataFileUrl(( !
{((" #
get(($ '
;((' (
set(() ,
;((, -
}((. /
public)) 
DateTime)) 
?)) 
DateFetched)) $
{))% &
get))' *
;))* +
set)), /
;))/ 0
}))1 2
public,, 
bool,, 
IsOpenPixel,, 
{,,  !
get,," %
;,,% &
set,,' *
;,,* +
},,, -
public-- 
string-- 
OpenPixelUrl-- "
{--# $
get--% (
;--( )
set--* -
;--- .
}--/ 0
public.. 
bool.. 
IsOmniOrder.. 
{..  !
get.." %
;..% &
set..' *
;..* +
}.., -
public// 
DateTime// 
?// 
OmniDeployDate// '
{//( )
get//* -
;//- .
set/// 2
;//2 3
}//4 5
public00 
long00 
Impressions00 
{00  !
get00" %
;00% &
set00' *
;00* +
}00, -
public11 
List11 
<11 
ChannelType11 
>11  
ChannelTypes11! -
{11. /
get110 3
;113 4
set115 8
;118 9
}11: ;
public33 
CampaignAsset33 
Assets33 #
{33$ %
get33& )
;33) *
set33+ .
;33. /
}330 1
public55 
ICollection55 
<55 
CampaignSegmentVm55 ,
>55, -
Segments55. 6
{557 8
get559 <
;55< =
set55> A
;55A B
}55C D
public77 
CampaignTestingVm77  
(77  !
)77! "
{88 	
Segments99 
=99 
new99 
HashSet99 "
<99" #
CampaignSegmentVm99# 4
>994 5
(995 6
)996 7
;997 8
}:: 	
};; 
}<<  N
DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{		 
public

 

sealed

 
class

 

CampaignVm

 "
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
] 
public 
DateTime 
? 
BroadcastDate &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DateTime 
? 

DeployDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
RepresentativeName (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
RepresentativeEmail )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
bool 
ReBroadCast 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
ReBroadcastDate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
long 
Price 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
TestingUrgency !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

GeoDetails  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Demographics "
{# $
get% (
;( )
set* -
;- .
}/ 0
[!! 	
Range!!	 
(!! 
$num!! 
,!! 
int!! 
.!! 
MaxValue!! 
,!! 
ErrorMessage!!  ,
=!!- .
$str!!/ T
)!!T U
]!!U V
public"" 
long"" 
Quantity"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public%% 
string%% 
FromLine%% 
{%%  
get%%! $
;%%$ %
set%%& )
;%%) *
}%%+ ,
public&& 
string&& 
SubjectLine&& !
{&&" #
get&&$ '
;&&' (
set&&) ,
;&&, -
}&&. /
public(( 
bool(( 
IsPersonalization(( %
{((& '
get((( +
;((+ ,
set((- 0
;((0 1
}((2 3
public)) 
bool)) 
IsMatchback)) 
{))  !
get))" %
;))% &
set))' *
;))* +
})), -
public** 
bool** 
IsSuppression** !
{**" #
get**$ '
;**' (
set**) ,
;**, -
}**. /
public++ 
string++ 

WhiteLabel++  
{++! "
get++# &
;++& '
set++( +
;+++ ,
}++- .
public,, 
string,, 
OptOut,, 
{,, 
get,, "
;,," #
set,,$ '
;,,' (
},,) *
public-- 
bool-- 
IsAddViewInBrowser-- &
{--' (
get--) ,
;--, -
set--. 1
;--1 2
}--3 4
public.. 
bool.. 
IsAddOptOut.. 
{..  !
get.." %
;..% &
set..' *
;..* +
}.., -
public// 
string// 
SpecialInstructions// )
{//* +
get//, /
;/// 0
set//1 4
;//4 5
}//6 7
public00 
string00 
Ip00 
{00 
get00 
;00 
set00  #
;00# $
}00% &
public11 
string11 
Browser11 
{11 
get11  #
;11# $
set11% (
;11( )
}11* +
public22 
string22 
Os22 
{22 
get22 
;22 
set22  #
;22# $
}22% &
public33 
string33 
Referrer33 
{33  
get33! $
;33$ %
set33& )
;33) *
}33+ ,
public55 
string55 
AssignedToCustomer55 (
{55) *
get55+ .
;55. /
set550 3
;553 4
}555 6
public88 
long88 
DataFileQuantity88 $
{88% &
get88' *
;88* +
set88, /
;88/ 0
}881 2
public;; 
bool;; 
IsOpenPixel;; 
{;;  !
get;;" %
;;;% &
set;;' *
;;;* +
};;, -
public<< 
string<< 
OpenPixelUrl<< "
{<<# $
get<<% (
;<<( )
set<<* -
;<<- .
}<</ 0
public== 
bool== 
IsOmniOrder== 
{==  !
get==" %
;==% &
set==' *
;==* +
}==, -
public>> 
DateTime>> 
?>> 
OmniDeployDate>> '
{>>( )
get>>* -
;>>- .
set>>/ 2
;>>2 3
}>>4 5
public?? 
long?? 
Impressions?? 
{??  !
get??" %
;??% &
set??' *
;??* +
}??, -
public@@ 
List@@ 
<@@ 
ChannelType@@ 
>@@  
ChannelTypes@@! -
{@@. /
get@@0 3
;@@3 4
set@@5 8
;@@8 9
}@@: ;
publicBB 
boolBB 
ReBroadcastedBB !
{BB" #
getBB$ '
;BB' (
setBB) ,
;BB, -
}BB. /
publicCC 
DateTimeCC 
?CC 
ReBroadcastedDateCC *
{CC+ ,
getCC- 0
;CC0 1
setCC2 5
;CC5 6
}CC7 8
publicDD 
longDD !
ReBroadcastedQuantityDD )
{DD* +
getDD, /
;DD/ 0
setDD1 4
;DD4 5
}DD6 7
publicEE 
stringEE $
ReBroadcastedOrderNumberEE .
{EE/ 0
getEE1 4
;EE4 5
setEE6 9
;EE9 :
}EE; <
publicGG 
GuidGG 
?GG 
AssetsIdGG 
{GG 
getGG  #
;GG# $
setGG% (
;GG( )
}GG* +
publicHH 
CampaignAssetHH 
AssetsHH #
{HH$ %
getHH& )
;HH) *
setHH+ .
;HH. /
}HH0 1
publicJJ 
GuidJJ 
?JJ 
	TestingIdJJ 
{JJ  
getJJ! $
;JJ$ %
setJJ& )
;JJ) *
}JJ+ ,
publicKK 
CampaignTestingKK 
TestingKK &
{KK' (
getKK) ,
;KK, -
setKK. 1
;KK1 2
}KK3 4
publicMM 
GuidMM 
?MM 

CreativeIdMM 
{MM  !
getMM" %
;MM% &
setMM' *
;MM* +
}MM, -
publicNN 
CampaignCreativeNN 
CreativeNN  (
{NN) *
getNN+ .
;NN. /
setNN0 3
;NN3 4
}NN5 6
publicPP 
GuidPP 
?PP 

ApprovedIdPP 
{PP  !
getPP" %
;PP% &
setPP' *
;PP* +
}PP, -
publicQQ 
CampaignApprovedQQ 
ApprovedQQ  (
{QQ) *
getQQ+ .
;QQ. /
setQQ0 3
;QQ3 4
}QQ5 6
publicSS 
ICollectionSS 
<SS 
CampaignSegmentVmSS ,
>SS, -
SegmentsSS. 6
{SS7 8
getSS9 <
;SS< =
setSS> A
;SSA B
}SSC D
publicXX 

CampaignVmXX 
(XX 
)XX 
{YY 	
SegmentsZZ 
=ZZ 
newZZ 
HashSetZZ "
<ZZ" #
CampaignSegmentVmZZ# 4
>ZZ4 5
(ZZ5 6
)ZZ6 7
;ZZ7 8
}^^ 	
public`` 
Campaign`` 

ToCampaign`` "
(``" #
)``# $
{aa 	
varbb 
cbb 
=bb 
newbb 
Campaignbb  
(bb  !
)bb! "
{cc 
Iddd 
=dd 
Iddd 
,dd 
OrderNumberee 
=ee 
OrderNumberee )
,ee) *
}ff 
;ff 
foreachgg 
(gg 
vargg 
	segmentVmgg "
ingg# %
Segmentsgg& .
)gg. /
{hh 
cii 
.ii 
Segmentsii 
.ii 
Addii 
(ii 

TinyMapperii )
.ii) *
Mapii* -
<ii- .
CampaignSegmentii. =
>ii= >
(ii> ?
	segmentVmii? H
)iiH I
)iiI J
;iiJ K
}jj 
returnkk 
ckk 
;kk 
}ll 	
}mm 
}oo π
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Helpers\CreativeHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
CreativeHelper 
{		 
public

 
static

 
List

 
<

 
SelectItemPair

 )
>

) *

ReadEmails

+ 5
(

5 6
string

6 <
filePath

= E
)

E F
{ 	
List 
< 
SelectItemPair 
>  
emails! '
=( )
new* -
List. 2
<2 3
SelectItemPair3 A
>A B
(B C
)C D
;D E
foreach 
( 
var 
line 
in  
File! %
.% &
ReadAllLines& 2
(2 3
filePath3 ;
); <
)< =
{ 
var 
trimmed 
= 
StringHelper *
.* +
Trim+ /
(/ 0
line0 4
)4 5
;5 6
if 
( 
string 
. 
IsNullOrEmpty (
(( )
trimmed) 0
)0 1
)1 2
continue3 ;
;; <
if 
( 
! 
EmailChecker  
.  !
IsValidEmail! -
(- .
trimmed. 5
)5 6
)6 7
continue8 @
;@ A
emails 
. 
Add 
( 
new 
SelectItemPair -
(- .
). /
{0 1
Selected2 :
=; <
true= A
,A B
TextC G
=H I
trimmedJ Q
,Q R
ValueS X
=Y Z
trimmed[ b
}c d
)d e
;e f
} 
return 
emails 
; 
} 	
public 
void 
Add 
( 
string 
filePath '
,' (
string) /
email0 5
)5 6
{ 	
File 
. 
AppendAllLines 
(  
filePath  (
,( )
new* -
string. 4
[4 5
]5 6
{7 8
email8 =
}= >
)> ?
;? @
} 	
public 
void 
Remove 
( 
string !
filePath" *
,* +
string, 2
email3 8
)8 9
{ 	
File 
. 
WriteAllLines 
( 
filePath '
,' (
File) -
.- .
ReadAllLines. :
(: ;
filePath; C
)C D
.D E
WhereE J
(J K
xK L
=>M O
StringHelperP \
.\ ]
Trim] a
(a b
xb c
)c d
!=e g
emailh m
)m n
)n o
;o p
}   	
}!! 
}"" Ö
DE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CreativeVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 

CreativeVm 
{ 
public		 
string		 
Id		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
string

 

CampaignId

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
TestSeedFile "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
LiveSeedFile "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
	AllowHtml	 
] 
public 
string 
	Creatives 
{  !
get" %
;% &
set' *
;* +
}, -
public 
List 
< 
SelectItemPair "
>" #

TestEmails$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
List 
< 
SelectItemPair "
>" #

LiveEmails$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string 
QuickTestEmails %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
MailChimpList #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
MailChimpCampaign '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
} 
} Úc
LE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignTrackingVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public		 

class		 
CampaignTrackingVm		 #
{

 
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 

TrackingId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	OrderDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Quantity 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	StartDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Opened 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Clicked 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Unsub 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Forwards 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
OpenedPercentage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
ClickedPercentage '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
UnsubPercentage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string !
ClickToOpenPercentage +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public   
string   !
UnsubToOpenPercentage   +
{  , -
get  . 1
;  1 2
set  3 6
;  6 7
}  8 9
public!! 
string!! 
Bounce!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public"" 
string"" 
Opt"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
public## 
string## 
Desktop## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
public$$ 
string$$ 
Mobile$$ 
{$$ 
get$$ "
;$$" #
set$$$ '
;$$' (
}$$) *
public&& 
List&& 
<&& $
CampaignTrackingDetailVm&& ,
>&&, -
PerLink&&. 5
{&&6 7
get&&8 ;
;&&; <
set&&= @
;&&@ A
}&&B C
public(( 
static(( 
CampaignTrackingVm(( ( 
FromCampaignTracking(() =
(((= >
Campaign((> F
campaign((G O
,((O P
CampaignTracking((Q a
campaignTracking((b r
)((r s
{)) 	
var** 
model** 
=** 
new** 
CampaignTrackingVm** .
{++ 

CampaignId,, 
=,, 
campaign,, %
.,,% &
Id,,& (
.,,( )
ToString,,) 1
(,,1 2
),,2 3
,,,3 4

TrackingId-- 
=-- 
campaignTracking-- -
.--- .
Id--. 0
.--0 1
ToString--1 9
(--9 :
)--: ;
,--; <
OrderNumber.. 
=.. 
string.. $
...$ %
IsNullOrEmpty..% 2
(..2 3
campaignTracking..3 C
...C D
SegmentNumber..D Q
)..Q R
?..S T
campaignTracking..U e
...e f
OrderNumber..f q
:..r s
campaignTracking	..t Ñ
.
..Ñ Ö
SegmentNumber
..Ö í
,
..í ì
CampaignName// 
=// 
campaign// '
.//' (
Approved//( 0
.//0 1
CampaignName//1 =
,//= >

WhiteLabel00 
=00 
campaign00 %
.00% &
Approved00& .
.00. /

WhiteLabel00/ 9
,009 :
SubjectLine11 
=11 
campaign11 &
.11& '
Approved11' /
.11/ 0
SubjectLine110 ;
,11; <
FromLine22 
=22 
campaign22 #
.22# $
Approved22$ ,
.22, -
FromLine22- 5
,225 6
	OrderDate33 
=33 
campaign33 $
.33$ %
	CreatedAt33% .
.33. /
ToString33/ 7
(337 8
StringConstants338 G
.33G H
DateFormatSlashes33H Y
)33Y Z
,33Z [
Status44 
=44 
(44 
(44 
CampaignStatus44 )
)44) *
campaign44* 2
.442 3
Status443 9
)449 :
.44: ;
ToString44; C
(44C D
)44D E
,44E F
Quantity66 
=66 
campaignTracking66 +
.66+ ,
Quantity66, 4
.664 5
ToString665 =
(66= >
)66> ?
,66? @
IoNumber77 
=77 
campaignTracking77 +
.77+ ,
IoNumber77, 4
,774 5
	StartDate88 
=88 
campaignTracking88 ,
.88, -
	StartDate88- 6
?886 7
.887 8
ToString888 @
(88@ A
StringConstants88A P
.88P Q
DateFormatSlashes88Q b
)88b c
,88c d
Opened99 
=99 
campaignTracking99 )
.99) *
Opened99* 0
==991 3
$num994 5
?996 7
$str998 <
:99= >
campaignTracking99? O
.99O P
Opened99P V
.99V W
ToString99W _
(99_ `
)99` a
,99a b
Clicked:: 
=:: 
campaignTracking:: *
.::* +
Clicked::+ 2
==::3 5
$num::6 7
?::8 9
$str::: >
:::? @
campaignTracking::A Q
.::Q R
Clicked::R Y
.::Y Z
ToString::Z b
(::b c
)::c d
,::d e
Unsub;; 
=;; 
campaignTracking;; (
.;;( )
Unsub;;) .
==;;/ 1
$num;;2 3
?;;4 5
$str;;6 :
:;;; <
campaignTracking;;= M
.;;M N
Unsub;;N S
.;;S T
ToString;;T \
(;;\ ]
);;] ^
,;;^ _
Forwards<< 
=<< 
campaignTracking<< +
.<<+ ,
Forwards<<, 4
==<<5 7
$num<<8 9
?<<: ;
$str<<< @
:<<A B
campaignTracking<<C S
.<<S T
Forwards<<T \
.<<\ ]
ToString<<] e
(<<e f
)<<f g
,<<g h
Mobile== 
=== 
campaignTracking== )
.==) *
Mobile==* 0
.==0 1
ToString==1 9
(==9 :
)==: ;
,==; <
Desktop>> 
=>> 
campaignTracking>> *
.>>* +
Desktop>>+ 2
.>>2 3
ToString>>3 ;
(>>; <
)>>< =
,>>= >
Bounce?? 
=?? 
campaignTracking?? )
.??) *
Bounce??* 0
.??0 1
ToString??1 9
(??9 :
)??: ;
,??; <
Opt@@ 
=@@ 
campaignTracking@@ &
.@@& '
Opt@@' *
.@@* +
ToString@@+ 3
(@@3 4
)@@4 5
,@@5 6
OpenedPercentageAA  
=AA! "
campaignTrackingAA# 3
.AA3 4
OpenedPercentageAA4 D
.AAD E
ToStringAAE M
(AAM N
$strAAN U
)AAU V
,AAV W
ClickedPercentageBB !
=BB" #
campaignTrackingBB$ 4
.BB4 5
ClickedPercentageBB5 F
.BBF G
ToStringBBG O
(BBO P
$strBBP W
)BBW X
,BBX Y
UnsubPercentageCC 
=CC  !
campaignTrackingCC" 2
.CC2 3
UnsubPercentageCC3 B
.CCB C
ToStringCCC K
(CCK L
$strCCL S
)CCS T
,CCT U!
ClickToOpenPercentageDD %
=DD& '
campaignTrackingDD( 8
.DD8 9!
ClickToOpenPercentageDD9 N
.DDN O
ToStringDDO W
(DDW X
$strDDX _
)DD_ `
,DD` a!
UnsubToOpenPercentageEE %
=EE& '
campaignTrackingEE( 8
.EE8 9!
UnsubToOpenPercentageEE9 N
.EEN O
ToStringEEO W
(EEW X
$strEEX _
)EE_ `
,EE` a
PerLinkGG 
=GG 
newGG 
ListGG "
<GG" #$
CampaignTrackingDetailVmGG# ;
>GG; <
(GG< =
)GG= >
}HH 
;HH 
varJJ 
proDatasJJ 
=JJ 
campaignJJ #
.JJ# $
ProDatasJJ$ ,
.KK 
WhereKK 
(KK 
xKK 
=>KK 
xKK 
.KK 
OrderNumberKK )
==KK* ,
campaignTrackingKK- =
.KK= >
OrderNumberKK> I
&&KKJ L
xKKM N
.KKN O
SegmentNumberKKO \
==KK] _
campaignTrackingKK` p
.KKp q
SegmentNumberKKq ~
)KK~ 
.LL 
OrderByLL 
(LL 
xLL 
=>LL 
ProDataHelperLL +
.LL+ ,
GetIndexLL, 4
(LL4 5
xLL5 6
.LL6 7
Reportsite_URLLL7 E
)LLE F
)LLF G
;LLG H
foreachNN 
(NN 
varNN 
proDataNN  
inNN! #
proDatasNN$ ,
)NN, -
{OO 
modelPP 
.PP 
PerLinkPP 
.PP 
AddPP !
(PP! "
newPP" %$
CampaignTrackingDetailVmPP& >
{QQ 
IoNumberRR 
=RR 
proDataRR &
.RR& '
IORR' )
,RR) *
OrderNumberSS 
=SS  !
proDataSS" )
.SS) *
Reportsite_URLSS* 8
,SS8 9
LinkTT 
=TT 
proDataTT "
.TT" #
Destination_URLTT# 2
,TT2 3

ClickCountUU 
=UU  
proDataUU! (
.UU( )

ClickCountUU) 3
.UU3 4
ToStringUU4 <
(UU< =
)UU= >
,UU> ?
UniqueCountVV 
=VV  !
proDataVV" )
.VV) *
	UniqueCntVV* 3
.VV3 4
ToStringVV4 <
(VV< =
)VV= >
,VV> ?
MobileCountWW 
=WW  !
proDataWW" )
.WW) *
	MobileCntWW* 3
.WW3 4
ToStringWW4 <
(WW< =
)WW= >
}XX 
)XX 
;XX 
}YY 
return[[ 
model[[ 
;[[ 
}\\ 	
}]] 
}^^ Ç
KE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\HtmlProcessResult.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
HtmlProcessResult "
{ 
public 
string 
FilePathLive "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
UploadFileStatus 
Status  &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
}		 
}

 ¬
IE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\ProData\ProDataRequest.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
ProData #
{ 
public 

class 
ProDataRequest 
{ 
public 
string 
Io 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
IsRebroadcast #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
string		 
CreativeUrl		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
long

 
Quantity

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
GeoType 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
GeoUrl 
{ 
get "
;" #
set$ '
;' (
}) *
public 
double 

CtrPercent  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Subject 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
FromName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	FromEmail 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

DeployDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
IsOpenPixel !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
double 
OpenPercent !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	OpenPixel 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

IsDataFile  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
DataFileUrl !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string $
DataFileReplacementParam .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string %
DataFileReplacementColumn /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
string 
DataFileUniqueIp &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} è!
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\ProData\ProDataResponse.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
ProData #
{ 
public 

class 
ProDataResponse  
{ 
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
Reports		 
Reports		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
string

 
	Timestamp

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
public 
List 
< 
string 
> 
ErrorFields '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
long #
QueuedPendingCampaignId +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
string 
ResponseStatus $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ResponseMessage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
ErrorMessage "
{ 	
get 
{ 
StringBuilder 
errorMessage *
=+ ,
new- 0
StringBuilder1 >
(> ?
Message? F
)F G
;G H
foreach 
( 
var 
field "
in# %
ErrorFields& 1
)1 2
{ 
errorMessage  
.  !
Append! '
(' (
$"( *
<br/>* /
{/ 0
field0 5
}5 6
"6 7
)7 8
;8 9
} 
return 
errorMessage #
.# $
ToString$ ,
(, -
)- .
;. /
} 
} 	
} 
public 

class 
Reports 
{   
public!! 
Report!! 
[!! 
]!! 
Report!! 
{!!  
get!!! $
;!!$ %
set!!& )
;!!) *
}!!+ ,
}"" 
public$$ 

class$$ 
Report$$ 
{%% 
public&& 
string&& 
Io&& 
{&& 
get&& 
;&& 
set&&  #
;&&# $
}&&% &
public'' 
string'' 
ReportsiteUrl'' #
{''$ %
get''& )
;'') *
set''+ .
;''. /
}''0 1
public(( 
string(( 
DestinationUrl(( $
{((% &
get((' *
;((* +
set((, /
;((/ 0
}((1 2
public)) 
string)) 
CampaignStartDate)) '
{))( )
get))* -
;))- .
set))/ 2
;))2 3
}))4 5
public** 
string** 

ClickCount**  
{**! "
get**# &
;**& '
set**( +
;**+ ,
}**- .
public++ 
string++ 
CampaignName++ "
{++# $
get++% (
;++( )
set++* -
;++- .
}++/ 0
public,, 
long,, 
	UniqueCnt,, 
{,, 
get,,  #
;,,# $
set,,% (
;,,( )
},,* +
public-- 
long-- 
	MobileCnt-- 
{-- 
get--  #
;--# $
set--% (
;--( )
}--* +
public.. 
long.. 
ImpressionCnt.. !
{.." #
get..$ '
;..' (
set..) ,
;.., -
}... /
}// 
}11 «
ME:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CompanyPermissionVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
CompanyPermissionVm $
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public		 
string		 

ClaimValue		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
	ClaimType

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 

RolesCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 

IsEditable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
IsDeletable 
{  !
get" %
;% &
set' *
;* +
}, -
public 
IEnumerable 
< 
SelectListItem )
>) *

ClaimTypes+ 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
} 
} Ë
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CompanyRoleVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
CompanyRoleVm 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public		 
string		 
Name		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
string

 
Description

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
bool 

IsEditable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
IsDeletable 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
InUsers 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Action 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
PermissionId "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
List 
< 
SelectItemPair "
>" #
Permissions$ /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ô
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CampaignSearchVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
CampaignSearchVm !
{ 
public 
string 
	SortOrder 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
Page 
{ 
get 
; 
set  #
;# $
}% &
public 
string 

SearchType  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
string		 
BasicString		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
BasicOrderNumber

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
public 
string 
BasicStatus !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
AdvancedStatus $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
AdvancedUser "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
IsTested 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
OrderedFrom !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	OrderedTo 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
BroadcastFrom #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
BroadcastTo !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
ClearSessionId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} ‰U
FE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\OfficeUserVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class .
"ExternalLoginConfirmationViewModel 3
{ 
[ 	
Required	 
] 
[		 	
Display			 
(		 
Name		 
=		 
$str		 
)		  
]		  !
public

 
string

 
Email

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
} 
public 

class &
ExternalLoginListViewModel +
{ 
public 
string 
	ReturnUrl 
{  !
get" %
;% &
set' *
;* +
}, -
} 
public 

class 
SendCodeViewModel "
{ 
public 
string 
SelectedProvider &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
ICollection 
< 
System !
.! "
Web" %
.% &
Mvc& )
.) *
SelectListItem* 8
>8 9
	Providers: C
{D E
getF I
;I J
setK N
;N O
}P Q
public 
string 
	ReturnUrl 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 

RememberMe 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public 

class 
VerifyCodeViewModel $
{ 
[ 	
Required	 
] 
public 
string 
Provider 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
[   	
Display  	 
(   
Name   
=   
$str   
)   
]    
public!! 
string!! 
Code!! 
{!! 
get!!  
;!!  !
set!!" %
;!!% &
}!!' (
public"" 
string"" 
	ReturnUrl"" 
{""  !
get""" %
;""% &
set""' *
;""* +
}"", -
[$$ 	
Display$$	 
($$ 
Name$$ 
=$$ 
$str$$ 0
)$$0 1
]$$1 2
public%% 
bool%% 
RememberBrowser%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public'' 
bool'' 

RememberMe'' 
{''  
get''! $
;''$ %
set''& )
;'') *
}''+ ,
}(( 
public** 

class** 
ForgotViewModel**  
{++ 
[,, 	
Required,,	 
],, 
[-- 	
Display--	 
(-- 
Name-- 
=-- 
$str-- 
)--  
]--  !
public.. 
string.. 
Email.. 
{.. 
get.. !
;..! "
set..# &
;..& '
}..( )
}// 
public11 

class11 
LoginViewModel11 
{22 
[33 	
Required33	 
(33 
ErrorMessage33 
=33  
$str33! 8
)338 9
]339 :
[44 	
Display44	 
(44 
Name44 
=44 
$str44 "
)44" #
]44# $
public66 
string66 
Username66 
{66  
get66! $
;66$ %
set66& )
;66) *
}66+ ,
[88 	
Required88	 
(88 
ErrorMessage88 
=88  
$str88  7
)887 8
]888 9
[99 	
DataType99	 
(99 
DataType99 
.99 
Password99 #
)99# $
]99$ %
[:: 	
Display::	 
(:: 
Name:: 
=:: 
$str:: "
)::" #
]::# $
public;; 
string;; 
Password;; 
{;;  
get;;! $
;;;$ %
set;;& )
;;;) *
};;+ ,
[== 	
Display==	 
(== 
Name== 
=== 
$str== &
)==& '
]==' (
public>> 
bool>> 

RememberMe>> 
{>>  
get>>! $
;>>$ %
set>>& )
;>>) *
}>>+ ,
}?? 
publicAA 

classAA 
RegisterViewModelAA "
{BB 
[CC 	
RequiredCC	 
]CC 
[DD 	
DisplayDD	 
(DD 
NameDD 
=DD 
$strDD %
)DD% &
]DD& '
publicEE 
stringEE 

WhiteLabelEE  
{EE! "
getEE# &
;EE& '
setEE( +
;EE+ ,
}EE- .
[GG 	
RequiredGG	 
]GG 
[HH 	
DisplayHH	 
(HH 
NameHH 
=HH 
$strHH #
)HH# $
]HH$ %
publicII 
stringII 
UserNameII 
{II  
getII! $
;II$ %
setII& )
;II) *
}II+ ,
[KK 	
RequiredKK	 
]KK 
[LL 	
DisplayLL	 
(LL 
NameLL 
=LL 
$strLL '
)LL' (
]LL( )
publicMM 
boolMM 
IsAdminUserMM 
{MM  !
getMM" %
;MM% &
setMM' *
;MM* +
}MM, -
[OO 	
RequiredOO	 
]OO 
[PP 	
DisplayPP	 
(PP 
NamePP 
=PP 
$strPP %
)PP% &
]PP& '
publicQQ 
boolQQ 
	IsUsesApiQQ 
{QQ 
getQQ  #
;QQ# $
setQQ% (
;QQ( )
}QQ* +
[SS 	
RequiredSS	 
]SS 
[TT 	
DisplayTT	 
(TT 
NameTT 
=TT 
$strTT 2
)TT2 3
]TT3 4
publicUU 
boolUU 
IsTestsCreativesUU $
{UU% &
getUU' *
;UU* +
setUU, /
;UU/ 0
}UU1 2
[WW 	
RequiredWW	 
]WW 
[XX 	
EmailAddressXX	 
]XX 
[YY 	
DisplayYY	 
(YY 
NameYY 
=YY 
$strYY 
)YY  
]YY  !
publicZZ 
stringZZ 
EmailZZ 
{ZZ 
getZZ !
;ZZ! "
setZZ# &
;ZZ& '
}ZZ( )
[\\ 	
Required\\	 
]\\ 
[]] 	
StringLength]]	 
(]] 
$num]] 
,]] 
ErrorMessage]] '
=]]( )
$str]]* Y
,]]Y Z
MinimumLength]][ h
=]]i j
$num]]k l
)]]l m
]]]m n
[^^ 	
DataType^^	 
(^^ 
DataType^^ 
.^^ 
Password^^ #
)^^# $
]^^$ %
[__ 	
Display__	 
(__ 
Name__ 
=__ 
$str__ "
)__" #
]__# $
public`` 
string`` 
Password`` 
{``  
get``! $
;``$ %
set``& )
;``) *
}``+ ,
[bb 	
DataTypebb	 
(bb 
DataTypebb 
.bb 
Passwordbb #
)bb# $
]bb$ %
[cc 	
Displaycc	 
(cc 
Namecc 
=cc 
$strcc *
)cc* +
]cc+ ,
[dd 	
Comparedd	 
(dd 
$strdd 
,dd 
ErrorMessagedd )
=dd* +
$strdd, b
)ddb c
]ddc d
publicee 
stringee 
ConfirmPasswordee %
{ee& '
getee( +
;ee+ ,
setee- 0
;ee0 1
}ee2 3
}ff 
publichh 

classhh "
ResetPasswordViewModelhh '
{ii 
[jj 	
Requiredjj	 
]jj 
[kk 	
EmailAddresskk	 
]kk 
[ll 	
Displayll	 
(ll 
Namell 
=ll 
$strll 
)ll  
]ll  !
publicmm 
stringmm 
Emailmm 
{mm 
getmm !
;mm! "
setmm# &
;mm& '
}mm( )
[oo 	
Requiredoo	 
]oo 
[pp 	
StringLengthpp	 
(pp 
$numpp 
,pp 
ErrorMessagepp '
=pp( )
$strpp* Y
,ppY Z
MinimumLengthpp[ h
=ppi j
$numppk l
)ppl m
]ppm n
[qq 	
DataTypeqq	 
(qq 
DataTypeqq 
.qq 
Passwordqq #
)qq# $
]qq$ %
[rr 	
Displayrr	 
(rr 
Namerr 
=rr 
$strrr "
)rr" #
]rr# $
publicss 
stringss 
Passwordss 
{ss  
getss! $
;ss$ %
setss& )
;ss) *
}ss+ ,
[uu 	
DataTypeuu	 
(uu 
DataTypeuu 
.uu 
Passworduu #
)uu# $
]uu$ %
[vv 	
Displayvv	 
(vv 
Namevv 
=vv 
$strvv *
)vv* +
]vv+ ,
[ww 	
Compareww	 
(ww 
$strww 
,ww 
ErrorMessageww )
=ww* +
$strww, b
)wwb c
]wwc d
publicxx 
stringxx 
ConfirmPasswordxx %
{xx& '
getxx( +
;xx+ ,
setxx- 0
;xx0 1
}xx2 3
publiczz 
stringzz 
Codezz 
{zz 
getzz  
;zz  !
setzz" %
;zz% &
}zz' (
}{{ 
public}} 

class}} #
ForgotPasswordViewModel}} (
{~~ 
[ 	
Required	 
] 
[
ÄÄ 	
EmailAddress
ÄÄ	 
]
ÄÄ 
[
ÅÅ 	
Display
ÅÅ	 
(
ÅÅ 
Name
ÅÅ 
=
ÅÅ 
$str
ÅÅ 
)
ÅÅ  
]
ÅÅ  !
public
ÇÇ 
string
ÇÇ 
Email
ÇÇ 
{
ÇÇ 
get
ÇÇ !
;
ÇÇ! "
set
ÇÇ# &
;
ÇÇ& '
}
ÇÇ( )
}
ÉÉ 
}ÑÑ „
HE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\CompanyUsersVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
CompanyUsersVm 
{ 
public		 
Guid		 
Id		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Action 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
OfficeId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
UnitId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

OfficeName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
UnitName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Role 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
SelectItemPair "
>" #
Roles$ )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
bool 
IsLocalUser 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} à
FE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\JsonResponse.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
JsonResponse 
{ 
public 
bool 
IsSucess 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
ErrorMessage "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
object 
Result 
{ 
get "
;" #
set$ '
;' (
}) *
} 
}		 ‹8
CE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\ManageVms.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
IndexViewModel 
{		 
public

 
bool

 
HasPassword

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
IList 
< 
UserLoginInfo "
>" #
Logins$ *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
PhoneNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
	TwoFactor 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
BrowserRemembered %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class !
ManageLoginsViewModel &
{ 
public 
IList 
< 
UserLoginInfo "
>" #
CurrentLogins$ 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 
IList 
< %
AuthenticationDescription .
>. /
OtherLogins0 ;
{< =
get> A
;A B
setC F
;F G
}H I
} 
public 

class 
FactorViewModel  
{ 
public 
string 
Purpose 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

class  
SetPasswordViewModel %
{ 
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage '
=( )
$str* Y
,Y Z
MinimumLength[ h
=i j
$numk l
)l m
]m n
[   	
DataType  	 
(   
DataType   
.   
Password   #
)  # $
]  $ %
[!! 	
Display!!	 
(!! 
Name!! 
=!! 
$str!! &
)!!& '
]!!' (
public"" 
string"" 
NewPassword"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
[$$ 	
DataType$$	 
($$ 
DataType$$ 
.$$ 
Password$$ #
)$$# $
]$$$ %
[%% 	
Display%%	 
(%% 
Name%% 
=%% 
$str%% .
)%%. /
]%%/ 0
[&& 	
Compare&&	 
(&& 
$str&& 
,&& 
ErrorMessage&&  ,
=&&- .
$str&&/ i
)&&i j
]&&j k
public'' 
string'' 
ConfirmPassword'' %
{''& '
get''( +
;''+ ,
set''- 0
;''0 1
}''2 3
}(( 
public** 

class** #
ChangePasswordViewModel** (
{++ 
[,, 	
Required,,	 
],, 
[-- 	
DataType--	 
(-- 
DataType-- 
.-- 
Password-- #
)--# $
]--$ %
[.. 	
Display..	 
(.. 
Name.. 
=.. 
$str.. *
)..* +
]..+ ,
public// 
string// 
OldPassword// !
{//" #
get//$ '
;//' (
set//) ,
;//, -
}//. /
[11 	
Required11	 
]11 
[22 	
StringLength22	 
(22 
$num22 
,22 
ErrorMessage22 '
=22( )
$str22* Y
,22Y Z
MinimumLength22[ h
=22i j
$num22k l
)22l m
]22m n
[33 	
DataType33	 
(33 
DataType33 
.33 
Password33 #
)33# $
]33$ %
[44 	
Display44	 
(44 
Name44 
=44 
$str44 &
)44& '
]44' (
public55 
string55 
NewPassword55 !
{55" #
get55$ '
;55' (
set55) ,
;55, -
}55. /
[77 	
DataType77	 
(77 
DataType77 
.77 
Password77 #
)77# $
]77$ %
[88 	
Display88	 
(88 
Name88 
=88 
$str88 .
)88. /
]88/ 0
[99 	
Compare99	 
(99 
$str99 
,99 
ErrorMessage99  ,
=99- .
$str99/ i
)99i j
]99j k
public:: 
string:: 
ConfirmPassword:: %
{::& '
get::( +
;::+ ,
set::- 0
;::0 1
}::2 3
};; 
public== 

class== #
AddPhoneNumberViewModel== (
{>> 
[?? 	
Required??	 
]?? 
[@@ 	
Phone@@	 
]@@ 
[AA 	
DisplayAA	 
(AA 
NameAA 
=AA 
$strAA &
)AA& '
]AA' (
publicBB 
stringBB 
NumberBB 
{BB 
getBB "
;BB" #
setBB$ '
;BB' (
}BB) *
}CC 
publicEE 

classEE &
VerifyPhoneNumberViewModelEE +
{FF 
[GG 	
RequiredGG	 
]GG 
[HH 	
DisplayHH	 
(HH 
NameHH 
=HH 
$strHH 
)HH 
]HH  
publicII 
stringII 
CodeII 
{II 
getII  
;II  !
setII" %
;II% &
}II' (
[KK 	
RequiredKK	 
]KK 
[LL 	
PhoneLL	 
]LL 
[MM 	
DisplayMM	 
(MM 
NameMM 
=MM 
$strMM &
)MM& '
]MM' (
publicNN 
stringNN 
PhoneNumberNN !
{NN" #
getNN$ '
;NN' (
setNN) ,
;NN, -
}NN. /
}OO 
publicQQ 

classQQ '
ConfigureTwoFactorViewModelQQ ,
{RR 
publicSS 
stringSS 
SelectedProviderSS &
{SS' (
getSS) ,
;SS, -
setSS. 1
;SS1 2
}SS3 4
publicTT 
ICollectionTT 
<TT 
SystemTT !
.TT! "
WebTT" %
.TT% &
MvcTT& )
.TT) *
SelectListItemTT* 8
>TT8 9
	ProvidersTT: C
{TTD E
getTTF I
;TTI J
setTTK N
;TTN O
}TTP Q
}UU 
}VV ç
EE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\SystemLogVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
SystemLogVm 
{ 
public 
string 
	CreatedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LogType 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
public

 
SystemLogVm

 
(

 
)

 
{ 	
} 	
} 
} ˆ
FE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\UploadFileVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
UploadFileVm 
{ 
public 
string 
FileName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
FileType 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
OrderNumber		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
SegmentNumber

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
public 
bool 
IsValid 
( 
string "
filePath# +
)+ ,
{ 	
bool 
isValid 
= 
true 
;  
switch 
( 
FileType 
) 
{ 
case 
$str )
:) *
int 
n 
; 
foreach 
( 
var  
line! %
in& (
File) -
.- .
ReadAllLines. :
(: ;
filePath; C
)C D
)D E
{ 
if 
( 
line  
.  !
Trim! %
(% &
)& '
.' (
Length( .
!=/ 1
$num2 3
||4 6
!7 8
int8 ;
.; <
TryParse< D
(D E
lineE I
.I J
TrimJ N
(N O
)O P
,P Q
outR U
nV W
)W X
)X Y
{ 
isValid #
=$ %
false& +
;+ ,
break !
;! "
} 
} 
break 
; 
} 
return 
isValid 
; 
} 	
}   
}!! è
GE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Models\UserProfileVm.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Models "
{ 
public 

class 
UserProfileVm 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
CcEmails

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
Status 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
Type 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
DateCreated !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
	IsUsesApi 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
ApiKey 
{ 
get "
;" #
set$ '
;' (
}) *
public 
bool 
IsTestsCreatives $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
CompanyName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CompanyLogo !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
ReportTemplate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} ı
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str .
). /
]/ 0
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[!! 
assembly!! 	
:!!	 

AssemblyVersion!! 
(!! 
$str!! $
)!!$ %
]!!% &
["" 
assembly"" 	
:""	 

AssemblyFileVersion"" 
("" 
$str"" (
)""( )
]"") *≤›
JE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Reports\TrackingReports.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Reports #
{ 
public 

static 
class 
TrackingReports '
{ 
public 
static 
void 
GenerateTemplate1 ,
(, -
CampaignTrackingVm- ?
model@ E
,E F
stringG M
templateFileN Z
,Z [
string\ b
logoFilePathc o
,o p
stringq w
imageFilePath	x Ö
,
Ö Ü
string
á ç

outputFile
é ò
)
ò ô
{ 	
File 
. 
Copy 
( 
templateFile "
," #

outputFile$ .
,. /
true0 4
)4 5
;5 6
byte 
[ 
] 
	byteArray 
= 
File #
.# $
ReadAllBytes$ 0
(0 1

outputFile1 ;
); <
;< =
using 
( 
MemoryStream 
stream  &
=' (
new) ,
MemoryStream- 9
(9 :
): ;
); <
{ 
stream 
. 
Write 
( 
	byteArray &
,& '
$num( )
,) *
	byteArray+ 4
.4 5
Length5 ;
); <
;< =
using 
( 
SpreadsheetDocument *
spreadSheet+ 6
=7 8
SpreadsheetDocument9 L
.L M
OpenM Q
(Q R
streamR X
,X Y
trueZ ^
)^ _
)_ `
{ 
IEnumerable   
<    
Sheet    %
>  % &
sheets  ' -
=  . /
spreadSheet  0 ;
.  ; <
WorkbookPart  < H
.  H I
Workbook  I Q
.!! 
GetFirstChild!! &
<!!& '
Sheets!!' -
>!!- .
(!!. /
)!!/ 0
.!!0 1
Elements!!1 9
<!!9 :
Sheet!!: ?
>!!? @
(!!@ A
)!!A B
."" 
Where"" 
("" 
s""  
=>""! #
s""$ %
.""% &
Name""& *
==""+ -
$str"". >
)""> ?
.## 
ToArray##  
(##  !
)##! "
;##" #
if%% 
(%% 
!%% 
sheets%% 
.%%  
Any%%  #
(%%# $
)%%$ %
)%%% &
{&& 
throw'' 
new'' !
AdsException''" .
(''. /
$str''/ :
)'': ;
;''; <
}(( 
string** 
relationshipId** )
=*** +
sheets**, 2
.**2 3
First**3 8
(**8 9
)**9 :
.**: ;
Id**; =
.**= >
Value**> C
;**C D
WorksheetPart++ !
worksheetPart++" /
=++0 1
(++2 3
WorksheetPart++3 @
)++@ A
spreadSheet++B M
.++M N
WorkbookPart++N Z
.++Z [
GetPartById++[ f
(++f g
relationshipId++g u
)++u v
;++v w
AddImage// 
(// 
worksheetPart// *
,//* +
logoFilePath//, 8
,//8 9
$num//: ;
,//; <
$num//= >
)//> ?
;//? @
AddImage00 
(00 
worksheetPart00 *
,00* +
logoFilePath00, 8
,008 9
$num00: <
,00< =
$num00> ?
)00? @
;00@ A
Cell22 
cell22 
=22 
GetCell22  '
(22' (
worksheetPart22( 5
.225 6
	Worksheet226 ?
,22? @
$str22A D
,22D E
$num22F G
)22G H
;22H I
cell33 
.33 
	CellValue33 "
=33# $
new33% (
	CellValue33) 2
(332 3
model333 8
.338 9
OrderNumber339 D
)33D E
;33E F
cell44 
.44 
DataType44 !
=44" #
new44$ '
	EnumValue44( 1
<441 2

CellValues442 <
>44< =
(44= >

CellValues44> H
.44H I
String44I O
)44O P
;44P Q
cell66 
=66 
GetCell66 "
(66" #
worksheetPart66# 0
.660 1
	Worksheet661 :
,66: ;
$str66< ?
,66? @
$num66A B
)66B C
;66C D
cell77 
.77 
	CellValue77 "
=77# $
new77% (
	CellValue77) 2
(772 3
model773 8
.778 9
	StartDate779 B
)77B C
;77C D
cell88 
.88 
DataType88 !
=88" #
new88$ '
	EnumValue88( 1
<881 2

CellValues882 <
>88< =
(88= >

CellValues88> H
.88H I
String88I O
)88O P
;88P Q
cell:: 
=:: 
GetCell:: "
(::" #
worksheetPart::# 0
.::0 1
	Worksheet::1 :
,::: ;
$str::< ?
,::? @
$num::A C
)::C D
;::D E
cell;; 
.;; 
	CellValue;; "
=;;# $
new;;% (
	CellValue;;) 2
(;;2 3
DateTime;;3 ;
.;;; <
Now;;< ?
.;;? @
ToString;;@ H
(;;H I
StringConstants;;I X
.;;X Y
DateFormatSlashes;;Y j
);;j k
);;k l
;;;l m
cell<< 
.<< 
DataType<< !
=<<" #
new<<$ '
	EnumValue<<( 1
<<<1 2

CellValues<<2 <
><<< =
(<<= >

CellValues<<> H
.<<H I
String<<I O
)<<O P
;<<P Q
cell>> 
=>> 
GetCell>> "
(>>" #
worksheetPart>># 0
.>>0 1
	Worksheet>>1 :
,>>: ;
$str>>< ?
,>>? @
$num>>A B
)>>B C
;>>C D
cell?? 
.?? 
	CellValue?? "
=??# $
new??% (
	CellValue??) 2
(??2 3
model??3 8
.??8 9
CampaignName??9 E
)??E F
;??F G
cell@@ 
.@@ 
DataType@@ !
=@@" #
new@@$ '
	EnumValue@@( 1
<@@1 2

CellValues@@2 <
>@@< =
(@@= >

CellValues@@> H
.@@H I
String@@I O
)@@O P
;@@P Q
cellCC 
=CC 
GetCellCC "
(CC" #
worksheetPartCC# 0
.CC0 1
	WorksheetCC1 :
,CC: ;
$strCC< ?
,CC? @
$numCCA C
)CCC D
;CCD E
cellDD 
.DD 
	CellValueDD "
=DD# $
newDD% (
	CellValueDD) 2
(DD2 3
modelDD3 8
.DD8 9
OpenedPercentageDD9 I
)DDI J
;DDJ K
cellEE 
.EE 
DataTypeEE !
=EE" #
newEE$ '
	EnumValueEE( 1
<EE1 2

CellValuesEE2 <
>EE< =
(EE= >

CellValuesEE> H
.EEH I
StringEEI O
)EEO P
;EEP Q
cellGG 
=GG 
GetCellGG "
(GG" #
worksheetPartGG# 0
.GG0 1
	WorksheetGG1 :
,GG: ;
$strGG< ?
,GG? @
$numGGA C
)GGC D
;GGD E
cellHH 
.HH 
	CellValueHH "
=HH# $
newHH% (
	CellValueHH) 2
(HH2 3
modelHH3 8
.HH8 9
QuantityHH9 A
)HHA B
;HHB C
cellII 
.II 
DataTypeII !
=II" #
newII$ '
	EnumValueII( 1
<II1 2

CellValuesII2 <
>II< =
(II= >

CellValuesII> H
.IIH I
StringIII O
)IIO P
;IIP Q
cellKK 
=KK 
GetCellKK "
(KK" #
worksheetPartKK# 0
.KK0 1
	WorksheetKK1 :
,KK: ;
$strKK< ?
,KK? @
$numKKA C
)KKC D
;KKD E
cellLL 
.LL 
	CellValueLL "
=LL# $
newLL% (
	CellValueLL) 2
(LL2 3
modelLL3 8
.LL8 9
OpenedLL9 ?
)LL? @
;LL@ A
cellMM 
.MM 
DataTypeMM !
=MM" #
newMM$ '
	EnumValueMM( 1
<MM1 2

CellValuesMM2 <
>MM< =
(MM= >

CellValuesMM> H
.MMH I
StringMMI O
)MMO P
;MMP Q
cellPP 
=PP 
GetCellPP "
(PP" #
worksheetPartPP# 0
.PP0 1
	WorksheetPP1 :
,PP: ;
$strPP< ?
,PP? @
$numPPA C
)PPC D
;PPD E
cellQQ 
.QQ 
	CellValueQQ "
=QQ# $
newQQ% (
	CellValueQQ) 2
(QQ2 3
modelQQ3 8
.QQ8 9
OpenedPercentageQQ9 I
)QQI J
;QQJ K
cellRR 
.RR 
DataTypeRR !
=RR" #
newRR$ '
	EnumValueRR( 1
<RR1 2

CellValuesRR2 <
>RR< =
(RR= >

CellValuesRR> H
.RRH I
StringRRI O
)RRO P
;RRP Q
cellTT 
=TT 
GetCellTT "
(TT" #
worksheetPartTT# 0
.TT0 1
	WorksheetTT1 :
,TT: ;
$strTT< ?
,TT? @
$numTTA C
)TTC D
;TTD E
cellUU 
.UU 
	CellValueUU "
=UU# $
newUU% (
	CellValueUU) 2
(UU2 3
modelUU3 8
.UU8 9
OpenedUU9 ?
)UU? @
;UU@ A
cellVV 
.VV 
DataTypeVV !
=VV" #
newVV$ '
	EnumValueVV( 1
<VV1 2

CellValuesVV2 <
>VV< =
(VV= >

CellValuesVV> H
.VVH I
StringVVI O
)VVO P
;VVP Q
cellYY 
=YY 
GetCellYY "
(YY" #
worksheetPartYY# 0
.YY0 1
	WorksheetYY1 :
,YY: ;
$strYY< ?
,YY? @
$numYYA C
)YYC D
;YYD E
cellZZ 
.ZZ 
	CellValueZZ "
=ZZ# $
newZZ% (
	CellValueZZ) 2
(ZZ2 3
modelZZ3 8
.ZZ8 9
ClickedZZ9 @
)ZZ@ A
;ZZA B
cell[[ 
.[[ 
DataType[[ !
=[[" #
new[[$ '
	EnumValue[[( 1
<[[1 2

CellValues[[2 <
>[[< =
([[= >

CellValues[[> H
.[[H I
String[[I O
)[[O P
;[[P Q
cell]] 
=]] 
GetCell]] "
(]]" #
worksheetPart]]# 0
.]]0 1
	Worksheet]]1 :
,]]: ;
$str]]< ?
,]]? @
$num]]A C
)]]C D
;]]D E
cell^^ 
.^^ 
	CellValue^^ "
=^^# $
new^^% (
	CellValue^^) 2
(^^2 3
model^^3 8
.^^8 9
ClickedPercentage^^9 J
)^^J K
;^^K L
cell__ 
.__ 
DataType__ !
=__" #
new__$ '
	EnumValue__( 1
<__1 2

CellValues__2 <
>__< =
(__= >

CellValues__> H
.__H I
String__I O
)__O P
;__P Q
cellaa 
=aa 
GetCellaa "
(aa" #
worksheetPartaa# 0
.aa0 1
	Worksheetaa1 :
,aa: ;
$straa< ?
,aa? @
$numaaA C
)aaC D
;aaD E
cellbb 
.bb 
	CellValuebb "
=bb# $
newbb% (
	CellValuebb) 2
(bb2 3
modelbb3 8
.bb8 9!
ClickToOpenPercentagebb9 N
)bbN O
;bbO P
cellcc 
.cc 
DataTypecc !
=cc" #
newcc$ '
	EnumValuecc( 1
<cc1 2

CellValuescc2 <
>cc< =
(cc= >

CellValuescc> H
.ccH I
StringccI O
)ccO P
;ccP Q
cellff 
=ff 
GetCellff "
(ff" #
worksheetPartff# 0
.ff0 1
	Worksheetff1 :
,ff: ;
$strff< ?
,ff? @
$numffA C
)ffC D
;ffD E
cellgg 
.gg 
	CellValuegg "
=gg# $
newgg% (
	CellValuegg) 2
(gg2 3
modelgg3 8
.gg8 9
Bouncegg9 ?
)gg? @
;gg@ A
cellhh 
.hh 
DataTypehh !
=hh" #
newhh$ '
	EnumValuehh( 1
<hh1 2

CellValueshh2 <
>hh< =
(hh= >

CellValueshh> H
.hhH I
StringhhI O
)hhO P
;hhP Q
celljj 
=jj 
GetCelljj "
(jj" #
worksheetPartjj# 0
.jj0 1
	Worksheetjj1 :
,jj: ;
$strjj< ?
,jj? @
$numjjA C
)jjC D
;jjD E
cellkk 
.kk 
	CellValuekk "
=kk# $
newkk% (
	CellValuekk) 2
(kk2 3
modelkk3 8
.kk8 9
Optkk9 <
)kk< =
;kk= >
cellll 
.ll 
DataTypell !
=ll" #
newll$ '
	EnumValuell( 1
<ll1 2

CellValuesll2 <
>ll< =
(ll= >

CellValuesll> H
.llH I
StringllI O
)llO P
;llP Q
celloo 
=oo 
GetCelloo "
(oo" #
worksheetPartoo# 0
.oo0 1
	Worksheetoo1 :
,oo: ;
$stroo< ?
,oo? @
$numooA C
)ooC D
;ooD E
cellpp 
.pp 
	CellValuepp "
=pp# $
newpp% (
	CellValuepp) 2
(pp2 3
modelpp3 8
.pp8 9
Desktoppp9 @
)pp@ A
;ppA B
cellqq 
.qq 
DataTypeqq !
=qq" #
newqq$ '
	EnumValueqq( 1
<qq1 2

CellValuesqq2 <
>qq< =
(qq= >

CellValuesqq> H
.qqH I
StringqqI O
)qqO P
;qqP Q
cellss 
=ss 
GetCellss "
(ss" #
worksheetPartss# 0
.ss0 1
	Worksheetss1 :
,ss: ;
$strss< ?
,ss? @
$numssA C
)ssC D
;ssD E
celltt 
.tt 
	CellValuett "
=tt# $
newtt% (
	CellValuett) 2
(tt2 3
modeltt3 8
.tt8 9
Mobilett9 ?
)tt? @
;tt@ A
celluu 
.uu 
DataTypeuu !
=uu" #
newuu$ '
	EnumValueuu( 1
<uu1 2

CellValuesuu2 <
>uu< =
(uu= >

CellValuesuu> H
.uuH I
StringuuI O
)uuO P
;uuP Q
cellxx 
=xx 
GetCellxx "
(xx" #
worksheetPartxx# 0
.xx0 1
	Worksheetxx1 :
,xx: ;
$strxx< ?
,xx? @
$numxxA C
)xxC D
;xxD E
cellyy 
.yy 
	CellValueyy "
=yy# $
newyy% (
	CellValueyy) 2
(yy2 3
modelyy3 8
.yy8 9
SubjectLineyy9 D
)yyD E
;yyE F
cellzz 
.zz 
DataTypezz !
=zz" #
newzz$ '
	EnumValuezz( 1
<zz1 2

CellValueszz2 <
>zz< =
(zz= >

CellValueszz> H
.zzH I
StringzzI O
)zzO P
;zzP Q
cell|| 
=|| 
GetCell|| "
(||" #
worksheetPart||# 0
.||0 1
	Worksheet||1 :
,||: ;
$str||< ?
,||? @
$num||A C
)||C D
;||D E
cell}} 
.}} 
	CellValue}} "
=}}# $
new}}% (
	CellValue}}) 2
(}}2 3
model}}3 8
.}}8 9
FromLine}}9 A
)}}A B
;}}B C
cell~~ 
.~~ 
DataType~~ !
=~~" #
new~~$ '
	EnumValue~~( 1
<~~1 2

CellValues~~2 <
>~~< =
(~~= >

CellValues~~> H
.~~H I
String~~I O
)~~O P
;~~P Q
if
ÑÑ 
(
ÑÑ 
File
ÑÑ 
.
ÑÑ 
Exists
ÑÑ #
(
ÑÑ# $
imageFilePath
ÑÑ$ 1
)
ÑÑ1 2
)
ÑÑ2 3
AddImage
ÖÖ  
(
ÖÖ  !
worksheetPart
ÖÖ! .
,
ÖÖ. /
imageFilePath
ÖÖ0 =
,
ÖÖ= >
$num
ÖÖ? A
,
ÖÖA B
$num
ÖÖC D
)
ÖÖD E
;
ÖÖE F
cell
áá 
=
áá 
GetCell
áá "
(
áá" #
worksheetPart
áá# 0
.
áá0 1
	Worksheet
áá1 :
,
áá: ;
$str
áá< ?
,
áá? @
$num
ááA C
)
ááC D
;
ááD E
cell
àà 
.
àà 
	CellValue
àà "
=
àà# $
new
àà% (
	CellValue
àà) 2
(
àà2 3
model
àà3 8
.
àà8 9
CampaignName
àà9 E
)
ààE F
;
ààF G
cell
ââ 
.
ââ 
DataType
ââ !
=
ââ" #
new
ââ$ '
	EnumValue
ââ( 1
<
ââ1 2

CellValues
ââ2 <
>
ââ< =
(
ââ= >

CellValues
ââ> H
.
ââH I
String
ââI O
)
ââO P
;
ââP Q
cell
ãã 
=
ãã 
GetCell
ãã "
(
ãã" #
worksheetPart
ãã# 0
.
ãã0 1
	Worksheet
ãã1 :
,
ãã: ;
$str
ãã< ?
,
ãã? @
$num
ããA C
)
ããC D
;
ããD E
cell
åå 
.
åå 
	CellValue
åå "
=
åå# $
new
åå% (
	CellValue
åå) 2
(
åå2 3
model
åå3 8
.
åå8 9
OrderNumber
åå9 D
)
ååD E
;
ååE F
cell
çç 
.
çç 
DataType
çç !
=
çç" #
new
çç$ '
	EnumValue
çç( 1
<
çç1 2

CellValues
çç2 <
>
çç< =
(
çç= >

CellValues
çç> H
.
ççH I
String
ççI O
)
ççO P
;
ççP Q
cell
èè 
=
èè 
GetCell
èè "
(
èè" #
worksheetPart
èè# 0
.
èè0 1
	Worksheet
èè1 :
,
èè: ;
$str
èè< ?
,
èè? @
$num
èèA C
)
èèC D
;
èèD E
cell
êê 
.
êê 
	CellValue
êê "
=
êê# $
new
êê% (
	CellValue
êê) 2
(
êê2 3
model
êê3 8
.
êê8 9
	StartDate
êê9 B
)
êêB C
;
êêC D
cell
ëë 
.
ëë 
DataType
ëë !
=
ëë" #
new
ëë$ '
	EnumValue
ëë( 1
<
ëë1 2

CellValues
ëë2 <
>
ëë< =
(
ëë= >

CellValues
ëë> H
.
ëëH I
String
ëëI O
)
ëëO P
;
ëëP Q
cell
ìì 
=
ìì 
GetCell
ìì "
(
ìì" #
worksheetPart
ìì# 0
.
ìì0 1
	Worksheet
ìì1 :
,
ìì: ;
$str
ìì< ?
,
ìì? @
$num
ììA C
)
ììC D
;
ììD E
cell
îî 
.
îî 
	CellValue
îî "
=
îî# $
new
îî% (
	CellValue
îî) 2
(
îî2 3
DateTime
îî3 ;
.
îî; <
Now
îî< ?
.
îî? @
ToString
îî@ H
(
îîH I
StringConstants
îîI X
.
îîX Y
DateFormatSlashes
îîY j
)
îîj k
)
îîk l
;
îîl m
cell
ïï 
.
ïï 
DataType
ïï !
=
ïï" #
new
ïï$ '
	EnumValue
ïï( 1
<
ïï1 2

CellValues
ïï2 <
>
ïï< =
(
ïï= >

CellValues
ïï> H
.
ïïH I
String
ïïI O
)
ïïO P
;
ïïP Q
uint
óó 
start
óó 
=
óó  
$num
óó! #
;
óó# $
foreach
òò 
(
òò 
var
òò  
vm
òò! #
in
òò$ &
model
òò' ,
.
òò, -
PerLink
òò- 4
)
òò4 5
{
ôô "
PopulateRowTemplate1
öö ,
(
öö, -
worksheetPart
öö- :
.
öö: ;
	Worksheet
öö; D
,
ööD E
vm
ööF H
,
ööH I
start
ööJ O
)
ööO P
;
ööP Q
start
õõ 
++
õõ 
;
õõ  
}
úú 
worksheetPart
†† !
.
††! "
	Worksheet
††" +
.
††+ ,
Save
††, 0
(
††0 1
)
††1 2
;
††2 3
spreadSheet
°° 
.
°°  
Close
°°  %
(
°°% &
)
°°& '
;
°°' (
}
¢¢ 
File
££ 
.
££ 
WriteAllBytes
££ "
(
££" #

outputFile
££# -
,
££- .
stream
££/ 5
.
££5 6
ToArray
££6 =
(
££= >
)
££> ?
)
££? @
;
££@ A
}
§§ 
}
•• 	
public
ßß 
static
ßß 
void
ßß 
GenerateTemplate2
ßß ,
(
ßß, - 
CampaignTrackingVm
ßß- ?
model
ßß@ E
,
ßßE F
string
ßßG M
templateFile
ßßN Z
,
ßßZ [
string
ßß\ b
logoFilePath
ßßc o
,
ßßo p
string
ßßq w
imageFilePathßßx Ö
,ßßÖ Ü
stringßßá ç

outputFileßßé ò
)ßßò ô
{
®® 	
File
©© 
.
©© 
Copy
©© 
(
©© 
templateFile
©© "
,
©©" #

outputFile
©©$ .
,
©©. /
true
©©0 4
)
©©4 5
;
©©5 6
byte
´´ 
[
´´ 
]
´´ 
	byteArray
´´ 
=
´´ 
File
´´ #
.
´´# $
ReadAllBytes
´´$ 0
(
´´0 1

outputFile
´´1 ;
)
´´; <
;
´´< =
using
¨¨ 
(
¨¨ 
MemoryStream
¨¨ 
stream
¨¨  &
=
¨¨' (
new
¨¨) ,
MemoryStream
¨¨- 9
(
¨¨9 :
)
¨¨: ;
)
¨¨; <
{
≠≠ 
stream
ÆÆ 
.
ÆÆ 
Write
ÆÆ 
(
ÆÆ 
	byteArray
ÆÆ &
,
ÆÆ& '
$num
ÆÆ( )
,
ÆÆ) *
	byteArray
ÆÆ+ 4
.
ÆÆ4 5
Length
ÆÆ5 ;
)
ÆÆ; <
;
ÆÆ< =
using
ØØ 
(
ØØ !
SpreadsheetDocument
ØØ *
spreadSheet
ØØ+ 6
=
ØØ7 8!
SpreadsheetDocument
ØØ9 L
.
ØØL M
Open
ØØM Q
(
ØØQ R
stream
ØØR X
,
ØØX Y
true
ØØZ ^
)
ØØ^ _
)
ØØ_ `
{
∞∞ 
IEnumerable
≤≤ 
<
≤≤  
Sheet
≤≤  %
>
≤≤% &
sheets
≤≤' -
=
≤≤. /
spreadSheet
≤≤0 ;
.
≤≤; <
WorkbookPart
≤≤< H
.
≤≤H I
Workbook
≤≤I Q
.
≥≥ 
GetFirstChild
≥≥ &
<
≥≥& '
Sheets
≥≥' -
>
≥≥- .
(
≥≥. /
)
≥≥/ 0
.
≥≥0 1
Elements
≥≥1 9
<
≥≥9 :
Sheet
≥≥: ?
>
≥≥? @
(
≥≥@ A
)
≥≥A B
.
¥¥ 
Where
¥¥ 
(
¥¥ 
s
¥¥  
=>
¥¥! #
s
¥¥$ %
.
¥¥% &
Name
¥¥& *
==
¥¥+ -
$str
¥¥. >
)
¥¥> ?
.
µµ 
ToArray
µµ  
(
µµ  !
)
µµ! "
;
µµ" #
if
∑∑ 
(
∑∑ 
!
∑∑ 
sheets
∑∑ 
.
∑∑  
Any
∑∑  #
(
∑∑# $
)
∑∑$ %
)
∑∑% &
{
∏∏ 
throw
ππ 
new
ππ !
AdsException
ππ" .
(
ππ. /
$str
ππ/ :
)
ππ: ;
;
ππ; <
}
∫∫ 
string
ºº 
relationshipId
ºº )
=
ºº* +
sheets
ºº, 2
.
ºº2 3
First
ºº3 8
(
ºº8 9
)
ºº9 :
.
ºº: ;
Id
ºº; =
.
ºº= >
Value
ºº> C
;
ººC D
WorksheetPart
ΩΩ !
worksheetPart
ΩΩ" /
=
ΩΩ0 1
(
ΩΩ2 3
WorksheetPart
ΩΩ3 @
)
ΩΩ@ A
spreadSheet
ΩΩA L
.
ΩΩL M
WorkbookPart
ΩΩM Y
.
ΩΩY Z
GetPartById
ΩΩZ e
(
ΩΩe f
relationshipId
ΩΩf t
)
ΩΩt u
;
ΩΩu v
AddImage
¡¡ 
(
¡¡ 
worksheetPart
¡¡ *
,
¡¡* +
logoFilePath
¡¡, 8
,
¡¡8 9
$num
¡¡: ;
,
¡¡; <
$num
¡¡= >
)
¡¡> ?
;
¡¡? @
Cell
√√ 
cell
√√ 
=
√√ 
GetCell
√√  '
(
√√' (
worksheetPart
√√( 5
.
√√5 6
	Worksheet
√√6 ?
,
√√? @
$str
√√A D
,
√√D E
$num
√√F G
)
√√G H
;
√√H I
cell
ƒƒ 
.
ƒƒ 
	CellValue
ƒƒ "
=
ƒƒ# $
new
ƒƒ% (
	CellValue
ƒƒ) 2
(
ƒƒ2 3
model
ƒƒ3 8
.
ƒƒ8 9
	StartDate
ƒƒ9 B
)
ƒƒB C
;
ƒƒC D
cell
≈≈ 
.
≈≈ 
DataType
≈≈ !
=
≈≈" #
new
≈≈$ '
	EnumValue
≈≈( 1
<
≈≈1 2

CellValues
≈≈2 <
>
≈≈< =
(
≈≈= >

CellValues
≈≈> H
.
≈≈H I
String
≈≈I O
)
≈≈O P
;
≈≈P Q
cell
«« 
=
«« 
GetCell
«« "
(
««" #
worksheetPart
««# 0
.
««0 1
	Worksheet
««1 :
,
««: ;
$str
««< ?
,
««? @
$num
««A B
)
««B C
;
««C D
cell
»» 
.
»» 
	CellValue
»» "
=
»»# $
new
»»% (
	CellValue
»») 2
(
»»2 3
model
»»3 8
.
»»8 9
SubjectLine
»»9 D
)
»»D E
;
»»E F
cell
…… 
.
…… 
DataType
…… !
=
……" #
new
……$ '
	EnumValue
……( 1
<
……1 2

CellValues
……2 <
>
……< =
(
……= >

CellValues
……> H
.
……H I
String
……I O
)
……O P
;
……P Q
cell
ÀÀ 
=
ÀÀ 
GetCell
ÀÀ "
(
ÀÀ" #
worksheetPart
ÀÀ# 0
.
ÀÀ0 1
	Worksheet
ÀÀ1 :
,
ÀÀ: ;
$str
ÀÀ< ?
,
ÀÀ? @
$num
ÀÀA C
)
ÀÀC D
;
ÀÀD E
cell
ÃÃ 
.
ÃÃ 
	CellValue
ÃÃ "
=
ÃÃ# $
new
ÃÃ% (
	CellValue
ÃÃ) 2
(
ÃÃ2 3
model
ÃÃ3 8
.
ÃÃ8 9
FromLine
ÃÃ9 A
)
ÃÃA B
;
ÃÃB C
cell
ÕÕ 
.
ÕÕ 
DataType
ÕÕ !
=
ÕÕ" #
new
ÕÕ$ '
	EnumValue
ÕÕ( 1
<
ÕÕ1 2

CellValues
ÕÕ2 <
>
ÕÕ< =
(
ÕÕ= >

CellValues
ÕÕ> H
.
ÕÕH I
String
ÕÕI O
)
ÕÕO P
;
ÕÕP Q
cell
œœ 
=
œœ 
GetCell
œœ "
(
œœ" #
worksheetPart
œœ# 0
.
œœ0 1
	Worksheet
œœ1 :
,
œœ: ;
$str
œœ< ?
,
œœ? @
$num
œœA C
)
œœC D
;
œœD E
cell
–– 
.
–– 
	CellValue
–– "
=
––# $
new
––% (
	CellValue
––) 2
(
––2 3
model
––3 8
.
––8 9

WhiteLabel
––9 C
)
––C D
;
––D E
cell
—— 
.
—— 
DataType
—— !
=
——" #
new
——$ '
	EnumValue
——( 1
<
——1 2

CellValues
——2 <
>
——< =
(
——= >

CellValues
——> H
.
——H I
String
——I O
)
——O P
;
——P Q
cell
”” 
=
”” 
GetCell
”” "
(
””" #
worksheetPart
””# 0
.
””0 1
	Worksheet
””1 :
,
””: ;
$str
””< ?
,
””? @
$num
””A C
)
””C D
;
””D E
cell
‘‘ 
.
‘‘ 
	CellValue
‘‘ "
=
‘‘# $
new
‘‘% (
	CellValue
‘‘) 2
(
‘‘2 3
model
‘‘3 8
.
‘‘8 9
OrderNumber
‘‘9 D
)
‘‘D E
;
‘‘E F
cell
’’ 
.
’’ 
DataType
’’ !
=
’’" #
new
’’$ '
	EnumValue
’’( 1
<
’’1 2

CellValues
’’2 <
>
’’< =
(
’’= >

CellValues
’’> H
.
’’H I
String
’’I O
)
’’O P
;
’’P Q
cell
◊◊ 
=
◊◊ 
GetCell
◊◊ "
(
◊◊" #
worksheetPart
◊◊# 0
.
◊◊0 1
	Worksheet
◊◊1 :
,
◊◊: ;
$str
◊◊< ?
,
◊◊? @
$num
◊◊A C
)
◊◊C D
;
◊◊D E
cell
ÿÿ 
.
ÿÿ 
	CellValue
ÿÿ "
=
ÿÿ# $
new
ÿÿ% (
	CellValue
ÿÿ) 2
(
ÿÿ2 3
model
ÿÿ3 8
.
ÿÿ8 9
CampaignName
ÿÿ9 E
)
ÿÿE F
;
ÿÿF G
cell
ŸŸ 
.
ŸŸ 
DataType
ŸŸ !
=
ŸŸ" #
new
ŸŸ$ '
	EnumValue
ŸŸ( 1
<
ŸŸ1 2

CellValues
ŸŸ2 <
>
ŸŸ< =
(
ŸŸ= >

CellValues
ŸŸ> H
.
ŸŸH I
String
ŸŸI O
)
ŸŸO P
;
ŸŸP Q
cell
‹‹ 
=
‹‹ 
GetCell
‹‹ "
(
‹‹" #
worksheetPart
‹‹# 0
.
‹‹0 1
	Worksheet
‹‹1 :
,
‹‹: ;
$str
‹‹< ?
,
‹‹? @
$num
‹‹A B
)
‹‹B C
;
‹‹C D
cell
›› 
.
›› 
	CellValue
›› "
=
››# $
new
››% (
	CellValue
››) 2
(
››2 3
model
››3 8
.
››8 9
Quantity
››9 A
)
››A B
;
››B C
cell
ﬁﬁ 
.
ﬁﬁ 
DataType
ﬁﬁ !
=
ﬁﬁ" #
new
ﬁﬁ$ '
	EnumValue
ﬁﬁ( 1
<
ﬁﬁ1 2

CellValues
ﬁﬁ2 <
>
ﬁﬁ< =
(
ﬁﬁ= >

CellValues
ﬁﬁ> H
.
ﬁﬁH I
String
ﬁﬁI O
)
ﬁﬁO P
;
ﬁﬁP Q
cell
‡‡ 
=
‡‡ 
GetCell
‡‡ "
(
‡‡" #
worksheetPart
‡‡# 0
.
‡‡0 1
	Worksheet
‡‡1 :
,
‡‡: ;
$str
‡‡< ?
,
‡‡? @
$num
‡‡A B
)
‡‡B C
;
‡‡C D
cell
·· 
.
·· 
	CellValue
·· "
=
··# $
new
··% (
	CellValue
··) 2
(
··2 3
model
··3 8
.
··8 9
OpenedPercentage
··9 I
)
··I J
;
··J K
cell
‚‚ 
.
‚‚ 
DataType
‚‚ !
=
‚‚" #
new
‚‚$ '
	EnumValue
‚‚( 1
<
‚‚1 2

CellValues
‚‚2 <
>
‚‚< =
(
‚‚= >

CellValues
‚‚> H
.
‚‚H I
String
‚‚I O
)
‚‚O P
;
‚‚P Q
cell
‰‰ 
=
‰‰ 
GetCell
‰‰ "
(
‰‰" #
worksheetPart
‰‰# 0
.
‰‰0 1
	Worksheet
‰‰1 :
,
‰‰: ;
$str
‰‰< ?
,
‰‰? @
$num
‰‰A C
)
‰‰C D
;
‰‰D E
cell
ÂÂ 
.
ÂÂ 
	CellValue
ÂÂ "
=
ÂÂ# $
new
ÂÂ% (
	CellValue
ÂÂ) 2
(
ÂÂ2 3
model
ÂÂ3 8
.
ÂÂ8 9
ClickedPercentage
ÂÂ9 J
)
ÂÂJ K
;
ÂÂK L
cell
ÊÊ 
.
ÊÊ 
DataType
ÊÊ !
=
ÊÊ" #
new
ÊÊ$ '
	EnumValue
ÊÊ( 1
<
ÊÊ1 2

CellValues
ÊÊ2 <
>
ÊÊ< =
(
ÊÊ= >

CellValues
ÊÊ> H
.
ÊÊH I
String
ÊÊI O
)
ÊÊO P
;
ÊÊP Q
cell
ËË 
=
ËË 
GetCell
ËË "
(
ËË" #
worksheetPart
ËË# 0
.
ËË0 1
	Worksheet
ËË1 :
,
ËË: ;
$str
ËË< ?
,
ËË? @
$num
ËËA C
)
ËËC D
;
ËËD E
cell
ÈÈ 
.
ÈÈ 
	CellValue
ÈÈ "
=
ÈÈ# $
new
ÈÈ% (
	CellValue
ÈÈ) 2
(
ÈÈ2 3
model
ÈÈ3 8
.
ÈÈ8 9#
UnsubToOpenPercentage
ÈÈ9 N
)
ÈÈN O
;
ÈÈO P
cell
ÍÍ 
.
ÍÍ 
DataType
ÍÍ !
=
ÍÍ" #
new
ÍÍ$ '
	EnumValue
ÍÍ( 1
<
ÍÍ1 2

CellValues
ÍÍ2 <
>
ÍÍ< =
(
ÍÍ= >

CellValues
ÍÍ> H
.
ÍÍH I
String
ÍÍI O
)
ÍÍO P
;
ÍÍP Q
cell
ÌÌ 
=
ÌÌ 
GetCell
ÌÌ "
(
ÌÌ" #
worksheetPart
ÌÌ# 0
.
ÌÌ0 1
	Worksheet
ÌÌ1 :
,
ÌÌ: ;
$str
ÌÌ< ?
,
ÌÌ? @
$num
ÌÌA C
)
ÌÌC D
;
ÌÌD E
cell
ÓÓ 
.
ÓÓ 
	CellValue
ÓÓ "
=
ÓÓ# $
new
ÓÓ% (
	CellValue
ÓÓ) 2
(
ÓÓ2 3
model
ÓÓ3 8
.
ÓÓ8 9
Quantity
ÓÓ9 A
)
ÓÓA B
;
ÓÓB C
cell
ÔÔ 
.
ÔÔ 
DataType
ÔÔ !
=
ÔÔ" #
new
ÔÔ$ '
	EnumValue
ÔÔ( 1
<
ÔÔ1 2

CellValues
ÔÔ2 <
>
ÔÔ< =
(
ÔÔ= >

CellValues
ÔÔ> H
.
ÔÔH I
String
ÔÔI O
)
ÔÔO P
;
ÔÔP Q
cell
ÒÒ 
=
ÒÒ 
GetCell
ÒÒ "
(
ÒÒ" #
worksheetPart
ÒÒ# 0
.
ÒÒ0 1
	Worksheet
ÒÒ1 :
,
ÒÒ: ;
$str
ÒÒ< ?
,
ÒÒ? @
$num
ÒÒA C
)
ÒÒC D
;
ÒÒD E
cell
ÚÚ 
.
ÚÚ 
	CellValue
ÚÚ "
=
ÚÚ# $
new
ÚÚ% (
	CellValue
ÚÚ) 2
(
ÚÚ2 3
model
ÚÚ3 8
.
ÚÚ8 9
OpenedPercentage
ÚÚ9 I
)
ÚÚI J
;
ÚÚJ K
cell
ÛÛ 
.
ÛÛ 
DataType
ÛÛ !
=
ÛÛ" #
new
ÛÛ$ '
	EnumValue
ÛÛ( 1
<
ÛÛ1 2

CellValues
ÛÛ2 <
>
ÛÛ< =
(
ÛÛ= >

CellValues
ÛÛ> H
.
ÛÛH I
String
ÛÛI O
)
ÛÛO P
;
ÛÛP Q
cell
ıı 
=
ıı 
GetCell
ıı "
(
ıı" #
worksheetPart
ıı# 0
.
ıı0 1
	Worksheet
ıı1 :
,
ıı: ;
$str
ıı< ?
,
ıı? @
$num
ııA C
)
ııC D
;
ııD E
cell
ˆˆ 
.
ˆˆ 
	CellValue
ˆˆ "
=
ˆˆ# $
new
ˆˆ% (
	CellValue
ˆˆ) 2
(
ˆˆ2 3
model
ˆˆ3 8
.
ˆˆ8 9
Opened
ˆˆ9 ?
)
ˆˆ? @
;
ˆˆ@ A
cell
˜˜ 
.
˜˜ 
DataType
˜˜ !
=
˜˜" #
new
˜˜$ '
	EnumValue
˜˜( 1
<
˜˜1 2

CellValues
˜˜2 <
>
˜˜< =
(
˜˜= >

CellValues
˜˜> H
.
˜˜H I
String
˜˜I O
)
˜˜O P
;
˜˜P Q
cell
˘˘ 
=
˘˘ 
GetCell
˘˘ "
(
˘˘" #
worksheetPart
˘˘# 0
.
˘˘0 1
	Worksheet
˘˘1 :
,
˘˘: ;
$str
˘˘< ?
,
˘˘? @
$num
˘˘A C
)
˘˘C D
;
˘˘D E
cell
˙˙ 
.
˙˙ 
	CellValue
˙˙ "
=
˙˙# $
new
˙˙% (
	CellValue
˙˙) 2
(
˙˙2 3
model
˙˙3 8
.
˙˙8 9
ClickedPercentage
˙˙9 J
)
˙˙J K
;
˙˙K L
cell
˚˚ 
.
˚˚ 
DataType
˚˚ !
=
˚˚" #
new
˚˚$ '
	EnumValue
˚˚( 1
<
˚˚1 2

CellValues
˚˚2 <
>
˚˚< =
(
˚˚= >

CellValues
˚˚> H
.
˚˚H I
String
˚˚I O
)
˚˚O P
;
˚˚P Q
cell
˝˝ 
=
˝˝ 
GetCell
˝˝ "
(
˝˝" #
worksheetPart
˝˝# 0
.
˝˝0 1
	Worksheet
˝˝1 :
,
˝˝: ;
$str
˝˝< ?
,
˝˝? @
$num
˝˝A C
)
˝˝C D
;
˝˝D E
cell
˛˛ 
.
˛˛ 
	CellValue
˛˛ "
=
˛˛# $
new
˛˛% (
	CellValue
˛˛) 2
(
˛˛2 3
model
˛˛3 8
.
˛˛8 9
Clicked
˛˛9 @
)
˛˛@ A
;
˛˛A B
cell
ˇˇ 
.
ˇˇ 
DataType
ˇˇ !
=
ˇˇ" #
new
ˇˇ$ '
	EnumValue
ˇˇ( 1
<
ˇˇ1 2

CellValues
ˇˇ2 <
>
ˇˇ< =
(
ˇˇ= >

CellValues
ˇˇ> H
.
ˇˇH I
String
ˇˇI O
)
ˇˇO P
;
ˇˇP Q
cell
ÅÅ 
=
ÅÅ 
GetCell
ÅÅ "
(
ÅÅ" #
worksheetPart
ÅÅ# 0
.
ÅÅ0 1
	Worksheet
ÅÅ1 :
,
ÅÅ: ;
$str
ÅÅ< ?
,
ÅÅ? @
$num
ÅÅA C
)
ÅÅC D
;
ÅÅD E
cell
ÇÇ 
.
ÇÇ 
	CellValue
ÇÇ "
=
ÇÇ# $
new
ÇÇ% (
	CellValue
ÇÇ) 2
(
ÇÇ2 3
model
ÇÇ3 8
.
ÇÇ8 9#
ClickToOpenPercentage
ÇÇ9 N
)
ÇÇN O
;
ÇÇO P
cell
ÉÉ 
.
ÉÉ 
DataType
ÉÉ !
=
ÉÉ" #
new
ÉÉ$ '
	EnumValue
ÉÉ( 1
<
ÉÉ1 2

CellValues
ÉÉ2 <
>
ÉÉ< =
(
ÉÉ= >

CellValues
ÉÉ> H
.
ÉÉH I
String
ÉÉI O
)
ÉÉO P
;
ÉÉP Q
cell
ÖÖ 
=
ÖÖ 
GetCell
ÖÖ "
(
ÖÖ" #
worksheetPart
ÖÖ# 0
.
ÖÖ0 1
	Worksheet
ÖÖ1 :
,
ÖÖ: ;
$str
ÖÖ< ?
,
ÖÖ? @
$num
ÖÖA C
)
ÖÖC D
;
ÖÖD E
cell
ÜÜ 
.
ÜÜ 
	CellValue
ÜÜ "
=
ÜÜ# $
new
ÜÜ% (
	CellValue
ÜÜ) 2
(
ÜÜ2 3
$str
ÜÜ3 @
+
ÜÜA B
model
ÜÜC H
.
ÜÜH I
Forwards
ÜÜI Q
)
ÜÜQ R
;
ÜÜR S
cell
áá 
.
áá 
DataType
áá !
=
áá" #
new
áá$ '
	EnumValue
áá( 1
<
áá1 2

CellValues
áá2 <
>
áá< =
(
áá= >

CellValues
áá> H
.
ááH I
String
ááI O
)
ááO P
;
ááP Q
cell
ââ 
=
ââ 
GetCell
ââ "
(
ââ" #
worksheetPart
ââ# 0
.
ââ0 1
	Worksheet
ââ1 :
,
ââ: ;
$str
ââ< ?
,
ââ? @
$num
ââA C
)
ââC D
;
ââD E
cell
ää 
.
ää 
	CellValue
ää "
=
ää# $
new
ää% (
	CellValue
ää) 2
(
ää2 3
model
ää3 8
.
ää8 9
UnsubPercentage
ää9 H
)
ääH I
;
ääI J
cell
ãã 
.
ãã 
DataType
ãã !
=
ãã" #
new
ãã$ '
	EnumValue
ãã( 1
<
ãã1 2

CellValues
ãã2 <
>
ãã< =
(
ãã= >

CellValues
ãã> H
.
ããH I
String
ããI O
)
ããO P
;
ããP Q
cell
çç 
=
çç 
GetCell
çç "
(
çç" #
worksheetPart
çç# 0
.
çç0 1
	Worksheet
çç1 :
,
çç: ;
$str
çç< ?
,
çç? @
$num
ççA C
)
ççC D
;
ççD E
cell
éé 
.
éé 
	CellValue
éé "
=
éé# $
new
éé% (
	CellValue
éé) 2
(
éé2 3
model
éé3 8
.
éé8 9
Unsub
éé9 >
)
éé> ?
;
éé? @
cell
èè 
.
èè 
DataType
èè !
=
èè" #
new
èè$ '
	EnumValue
èè( 1
<
èè1 2

CellValues
èè2 <
>
èè< =
(
èè= >

CellValues
èè> H
.
èèH I
String
èèI O
)
èèO P
;
èèP Q
cell
ëë 
=
ëë 
GetCell
ëë "
(
ëë" #
worksheetPart
ëë# 0
.
ëë0 1
	Worksheet
ëë1 :
,
ëë: ;
$str
ëë< ?
,
ëë? @
$num
ëëA C
)
ëëC D
;
ëëD E
cell
íí 
.
íí 
	CellValue
íí "
=
íí# $
new
íí% (
	CellValue
íí) 2
(
íí2 3
model
íí3 8
.
íí8 9#
UnsubToOpenPercentage
íí9 N
)
ííN O
;
ííO P
cell
ìì 
.
ìì 
DataType
ìì !
=
ìì" #
new
ìì$ '
	EnumValue
ìì( 1
<
ìì1 2

CellValues
ìì2 <
>
ìì< =
(
ìì= >

CellValues
ìì> H
.
ììH I
String
ììI O
)
ììO P
;
ììP Q
uint
ôô 
start
ôô 
=
ôô  
$num
ôô! #
;
ôô# $
foreach
öö 
(
öö 
var
öö  
vm
öö! #
in
öö$ &
model
öö' ,
.
öö, -
PerLink
öö- 4
)
öö4 5
{
õõ "
PopulateRowTemplate2
úú ,
(
úú, -
worksheetPart
úú- :
.
úú: ;
	Worksheet
úú; D
,
úúD E
vm
úúF H
,
úúH I
start
úúJ O
)
úúO P
;
úúP Q
start
ùù 
++
ùù 
;
ùù  
}
ûû 
worksheetPart
¢¢ !
.
¢¢! "
	Worksheet
¢¢" +
.
¢¢+ ,
Save
¢¢, 0
(
¢¢0 1
)
¢¢1 2
;
¢¢2 3
spreadSheet
££ 
.
££  
Close
££  %
(
££% &
)
££& '
;
££' (
}
§§ 
File
•• 
.
•• 
WriteAllBytes
•• "
(
••" #

outputFile
••# -
,
••- .
stream
••/ 5
.
••5 6
ToArray
••6 =
(
••= >
)
••> ?
)
••? @
;
••@ A
}
¶¶ 
}
ßß 	
private
©© 
static
©© 
void
©© "
PopulateRowTemplate1
©© 0
(
©©0 1
	Worksheet
©©1 :
	worksheet
©©; D
,
©©D E&
CampaignTrackingDetailVm
©©F ^
row
©©_ b
,
©©b c
uint
©©d h
	rowNumber
©©i r
)
©©r s
{
™™ 	
Cell
´´ 
cell
´´ 
=
´´ 
GetCell
´´ 
(
´´  
	worksheet
´´  )
,
´´) *
$str
´´+ .
,
´´. /
	rowNumber
´´0 9
)
´´9 :
;
´´: ;
cell
¨¨ 
.
¨¨ 
	CellValue
¨¨ 
=
¨¨ 
new
¨¨  
	CellValue
¨¨! *
(
¨¨* +
row
¨¨+ .
.
¨¨. /
Link
¨¨/ 3
)
¨¨3 4
;
¨¨4 5
cell
≠≠ 
.
≠≠ 
DataType
≠≠ 
=
≠≠ 
new
≠≠ 
	EnumValue
≠≠  )
<
≠≠) *

CellValues
≠≠* 4
>
≠≠4 5
(
≠≠5 6

CellValues
≠≠6 @
.
≠≠@ A
String
≠≠A G
)
≠≠G H
;
≠≠H I
cell
ØØ 
=
ØØ 
GetCell
ØØ 
(
ØØ 
	worksheet
ØØ $
,
ØØ$ %
$str
ØØ& )
,
ØØ) *
	rowNumber
ØØ+ 4
)
ØØ4 5
;
ØØ5 6
cell
∞∞ 
.
∞∞ 
	CellValue
∞∞ 
=
∞∞ 
new
∞∞  
	CellValue
∞∞! *
(
∞∞* +
row
∞∞+ .
.
∞∞. /

ClickCount
∞∞/ 9
)
∞∞9 :
;
∞∞: ;
cell
±± 
.
±± 
DataType
±± 
=
±± 
new
±± 
	EnumValue
±±  )
<
±±) *

CellValues
±±* 4
>
±±4 5
(
±±5 6

CellValues
±±6 @
.
±±@ A
String
±±A G
)
±±G H
;
±±H I
cell
≥≥ 
=
≥≥ 
GetCell
≥≥ 
(
≥≥ 
	worksheet
≥≥ $
,
≥≥$ %
$str
≥≥& )
,
≥≥) *
	rowNumber
≥≥+ 4
)
≥≥4 5
;
≥≥5 6
cell
¥¥ 
.
¥¥ 
	CellValue
¥¥ 
=
¥¥ 
new
¥¥  
	CellValue
¥¥! *
(
¥¥* +
row
¥¥+ .
.
¥¥. /
UniqueCount
¥¥/ :
)
¥¥: ;
;
¥¥; <
cell
µµ 
.
µµ 
DataType
µµ 
=
µµ 
new
µµ 
	EnumValue
µµ  )
<
µµ) *

CellValues
µµ* 4
>
µµ4 5
(
µµ5 6

CellValues
µµ6 @
.
µµ@ A
String
µµA G
)
µµG H
;
µµH I
cell
∑∑ 
=
∑∑ 
GetCell
∑∑ 
(
∑∑ 
	worksheet
∑∑ $
,
∑∑$ %
$str
∑∑& )
,
∑∑) *
	rowNumber
∑∑+ 4
)
∑∑4 5
;
∑∑5 6
cell
∏∏ 
.
∏∏ 
	CellValue
∏∏ 
=
∏∏ 
new
∏∏  
	CellValue
∏∏! *
(
∏∏* +
row
∏∏+ .
.
∏∏. /
MobileCount
∏∏/ :
)
∏∏: ;
;
∏∏; <
cell
ππ 
.
ππ 
DataType
ππ 
=
ππ 
new
ππ 
	EnumValue
ππ  )
<
ππ) *

CellValues
ππ* 4
>
ππ4 5
(
ππ5 6

CellValues
ππ6 @
.
ππ@ A
String
ππA G
)
ππG H
;
ππH I
}
∫∫ 	
private
ºº 
static
ºº 
void
ºº "
PopulateRowTemplate2
ºº 0
(
ºº0 1
	Worksheet
ºº1 :
	worksheet
ºº; D
,
ººD E&
CampaignTrackingDetailVm
ººF ^
row
ºº_ b
,
ººb c
uint
ººd h
	rowNumber
ººi r
)
ººr s
{
ΩΩ 	
Cell
ææ 
cell
ææ 
=
ææ 
GetCell
ææ 
(
ææ  
	worksheet
ææ  )
,
ææ) *
$str
ææ+ .
,
ææ. /
	rowNumber
ææ0 9
)
ææ9 :
;
ææ: ;
cell
øø 
.
øø 
	CellValue
øø 
=
øø 
new
øø  
	CellValue
øø! *
(
øø* +
row
øø+ .
.
øø. /
Link
øø/ 3
)
øø3 4
;
øø4 5
cell
¿¿ 
.
¿¿ 
DataType
¿¿ 
=
¿¿ 
new
¿¿ 
	EnumValue
¿¿  )
<
¿¿) *

CellValues
¿¿* 4
>
¿¿4 5
(
¿¿5 6

CellValues
¿¿6 @
.
¿¿@ A
String
¿¿A G
)
¿¿G H
;
¿¿H I
cell
¬¬ 
=
¬¬ 
GetCell
¬¬ 
(
¬¬ 
	worksheet
¬¬ $
,
¬¬$ %
$str
¬¬& )
,
¬¬) *
	rowNumber
¬¬+ 4
)
¬¬4 5
;
¬¬5 6
cell
√√ 
.
√√ 
	CellValue
√√ 
=
√√ 
new
√√  
	CellValue
√√! *
(
√√* +
row
√√+ .
.
√√. /

ClickCount
√√/ 9
)
√√9 :
;
√√: ;
cell
ƒƒ 
.
ƒƒ 
DataType
ƒƒ 
=
ƒƒ 
new
ƒƒ 
	EnumValue
ƒƒ  )
<
ƒƒ) *

CellValues
ƒƒ* 4
>
ƒƒ4 5
(
ƒƒ5 6

CellValues
ƒƒ6 @
.
ƒƒ@ A
String
ƒƒA G
)
ƒƒG H
;
ƒƒH I
}
≈≈ 	
private
«« 
static
«« 
Cell
«« 
GetCell
«« #
(
««# $
	Worksheet
««$ -
	worksheet
««. 7
,
««7 8
string
««9 ?

columnName
««@ J
,
««J K
uint
««L P
rowIndex
««Q Y
)
««Y Z
{
»» 	
Row
…… 
row
…… 
=
…… 
GetRow
…… 
(
…… 
	worksheet
…… &
,
……& '
rowIndex
……( 0
)
……0 1
;
……1 2
if
ÀÀ 
(
ÀÀ 
row
ÀÀ 
!=
ÀÀ 
null
ÀÀ 
)
ÀÀ 
return
ÃÃ 
row
ÃÃ 
.
ÃÃ 
Elements
ÃÃ #
<
ÃÃ# $
Cell
ÃÃ$ (
>
ÃÃ( )
(
ÃÃ) *
)
ÃÃ* +
.
ÃÃ+ ,
FirstOrDefault
ÃÃ, :
(
ÃÃ: ;
c
ÃÃ; <
=>
ÃÃ= ?
string
ÃÃ@ F
.
ÃÃF G
Compare
ÃÃG N
(
ÃÃN O
c
ÃÃO P
.
ÃÃP Q
CellReference
ÃÃQ ^
.
ÃÃ^ _
Value
ÃÃ_ d
,
ÃÃd e

columnName
ÃÃf p
+
ÃÃq r
rowIndex
ÃÃs {
,
ÃÃ{ |
trueÃÃ} Å
)ÃÃÅ Ç
==ÃÃÉ Ö
$numÃÃÜ á
)ÃÃá à
;ÃÃà â
var
ŒŒ 
firstRow
ŒŒ 
=
ŒŒ 
GetRow
ŒŒ !
(
ŒŒ! "
	worksheet
ŒŒ" +
,
ŒŒ+ ,
$num
ŒŒ- /
)
ŒŒ/ 0
;
ŒŒ0 1
var
œœ 
lastRow
œœ 
=
œœ 
GetRow
œœ  
(
œœ  !
	worksheet
œœ! *
,
œœ* +
$num
œœ, .
)
œœ. /
;
œœ/ 0
var
”” 
newRow
”” 
=
”” 
	InsertRow
”” "
(
””" #
rowIndex
””# +
,
””+ ,
	worksheet
””- 6
.
””6 7
WorksheetPart
””7 D
,
””D E
null
””F J
,
””J K
true
””L P
)
””P Q
;
””Q R
return
’’ 
newRow
’’ 
.
’’ 
Elements
’’ "
<
’’" #
Cell
’’# '
>
’’' (
(
’’( )
)
’’) *
.
’’* +
FirstOrDefault
’’+ 9
(
’’9 :
c
’’: ;
=>
’’< >
string
’’? E
.
’’E F
Compare
’’F M
(
’’M N
c
’’N O
.
’’O P
CellReference
’’P ]
.
’’] ^
Value
’’^ c
,
’’c d

columnName
’’e o
+
’’p q
rowIndex
’’r z
,
’’z {
true’’| Ä
)’’Ä Å
==’’Ç Ñ
$num’’Ö Ü
)’’Ü á
;’’á à
}
◊◊ 	
private
ŸŸ 
static
ŸŸ 
Row
ŸŸ 
	CreateRow
ŸŸ $
(
ŸŸ$ %
Row
ŸŸ% (
firstRow
ŸŸ) 1
,
ŸŸ1 2
Row
ŸŸ3 6
lastRow
ŸŸ7 >
,
ŸŸ> ?
uint
ŸŸ@ D
newRowIndex
ŸŸE P
,
ŸŸP Q
	SheetData
ŸŸR [
	sheetData
ŸŸ\ e
)
ŸŸe f
{
⁄⁄ 	
var
€€ 
newRow
€€ 
=
€€ 
(
€€ 
Row
€€ 
)
€€ 
firstRow
€€ &
.
€€& '
	CloneNode
€€' 0
(
€€0 1
true
€€1 5
)
€€5 6
;
€€6 7
foreach
‹‹ 
(
‹‹ 
Cell
‹‹ 
cell
‹‹ 
in
‹‹ !
newRow
‹‹" (
.
‹‹( )
Elements
‹‹) 1
<
‹‹1 2
Cell
‹‹2 6
>
‹‹6 7
(
‹‹7 8
)
‹‹8 9
)
‹‹9 :
{
›› 
string
ﬁﬁ 
cellReference
ﬁﬁ $
=
ﬁﬁ% &
cell
ﬁﬁ' +
.
ﬁﬁ+ ,
CellReference
ﬁﬁ, 9
.
ﬁﬁ9 :
Value
ﬁﬁ: ?
;
ﬁﬁ? @
cell
ﬂﬂ 
.
ﬂﬂ 
CellReference
ﬂﬂ "
=
ﬂﬂ# $
new
ﬂﬂ% (
StringValue
ﬂﬂ) 4
(
ﬂﬂ4 5
cellReference
ﬂﬂ5 B
.
ﬂﬂB C
Replace
ﬂﬂC J
(
ﬂﬂJ K
firstRow
ﬂﬂK S
.
ﬂﬂS T
RowIndex
ﬂﬂT \
.
ﬂﬂ\ ]
Value
ﬂﬂ] b
.
ﬂﬂb c
ToString
ﬂﬂc k
(
ﬂﬂk l
)
ﬂﬂl m
,
ﬂﬂm n
newRowIndex
ﬂﬂo z
.
ﬂﬂz {
ToStringﬂﬂ{ É
(ﬂﬂÉ Ñ
)ﬂﬂÑ Ö
)ﬂﬂÖ Ü
)ﬂﬂÜ á
;ﬂﬂá à
}
‡‡ 
newRow
·· 
.
·· 
RowIndex
·· 
=
·· 
new
·· !
UInt32Value
··" -
(
··- .
newRowIndex
··. 9
)
··9 :
;
··: ;
	sheetData
„„ 
.
„„ 
InsertAfter
„„ !
(
„„! "
newRow
„„" (
,
„„( )
lastRow
„„* 1
)
„„1 2
;
„„2 3
return
‰‰ 
newRow
‰‰ 
;
‰‰ 
}
ÂÂ 	
private
ËË 
static
ËË 
Row
ËË 
GetRow
ËË !
(
ËË! "
	Worksheet
ËË" +
	worksheet
ËË, 5
,
ËË5 6
uint
ËË7 ;
rowIndex
ËË< D
)
ËËD E
{
ÈÈ 	
return
ÍÍ 
	worksheet
ÍÍ 
.
ÍÍ 
GetFirstChild
ÍÍ *
<
ÍÍ* +
	SheetData
ÍÍ+ 4
>
ÍÍ4 5
(
ÍÍ5 6
)
ÍÍ6 7
.
ÍÍ7 8
Elements
ÍÍ8 @
<
ÍÍ@ A
Row
ÍÍA D
>
ÍÍD E
(
ÍÍE F
)
ÍÍF G
.
ÍÍG H
FirstOrDefault
ÍÍH V
(
ÍÍV W
r
ÍÍW X
=>
ÍÍY [
r
ÍÍ\ ]
.
ÍÍ] ^
RowIndex
ÍÍ^ f
==
ÍÍg i
rowIndex
ÍÍj r
)
ÍÍr s
;
ÍÍs t
}
ÎÎ 	
public
˘˘ 
static
˘˘ 
Row
˘˘ 
	InsertRow
˘˘ #
(
˘˘# $
uint
˘˘$ (
rowIndex
˘˘) 1
,
˘˘1 2
WorksheetPart
˘˘3 @
worksheetPart
˘˘A N
,
˘˘N O
Row
˘˘P S
	insertRow
˘˘T ]
,
˘˘] ^
bool
˘˘_ c
isNewLastRow
˘˘d p
=
˘˘q r
false
˘˘s x
)
˘˘x y
{
˙˙ 	
	Worksheet
˚˚ 
	worksheet
˚˚ 
=
˚˚  !
worksheetPart
˚˚" /
.
˚˚/ 0
	Worksheet
˚˚0 9
;
˚˚9 :
	SheetData
¸¸ 
	sheetData
¸¸ 
=
¸¸  !
	worksheet
¸¸" +
.
¸¸+ ,
GetFirstChild
¸¸, 9
<
¸¸9 :
	SheetData
¸¸: C
>
¸¸C D
(
¸¸D E
)
¸¸E F
;
¸¸F G
Row
˛˛ 
retRow
˛˛ 
=
˛˛ 
!
˛˛ 
isNewLastRow
˛˛ &
?
˛˛' (
	sheetData
˛˛) 2
.
˛˛2 3
Elements
˛˛3 ;
<
˛˛; <
Row
˛˛< ?
>
˛˛? @
(
˛˛@ A
)
˛˛A B
.
˛˛B C
FirstOrDefault
˛˛C Q
(
˛˛Q R
r
˛˛R S
=>
˛˛T V
r
˛˛W X
.
˛˛X Y
RowIndex
˛˛Y a
==
˛˛b d
rowIndex
˛˛e m
)
˛˛m n
:
˛˛o p
null
˛˛q u
;
˛˛u v
if
ÅÅ 
(
ÅÅ 
retRow
ÅÅ 
!=
ÅÅ 
null
ÅÅ 
)
ÅÅ 
{
ÇÇ 
if
ÑÑ 
(
ÑÑ 
	insertRow
ÑÑ 
!=
ÑÑ  
null
ÑÑ! %
)
ÑÑ% &
{
ÖÖ 
UpdateRowIndexes
ÜÜ $
(
ÜÜ$ %
worksheetPart
ÜÜ% 2
,
ÜÜ2 3
rowIndex
ÜÜ4 <
,
ÜÜ< =
false
ÜÜ> C
)
ÜÜC D
;
ÜÜD E(
UpdateMergedCellReferences
áá .
(
áá. /
worksheetPart
áá/ <
,
áá< =
rowIndex
áá> F
,
ááF G
false
ááH M
)
ááM N
;
ááN O'
UpdateHyperlinkReferences
àà -
(
àà- .
worksheetPart
àà. ;
,
àà; <
rowIndex
àà= E
,
ààE F
false
ààG L
)
ààL M
;
ààM N
retRow
ãã 
=
ãã 
	sheetData
ãã &
.
ãã& '
InsertBefore
ãã' 3
(
ãã3 4
	insertRow
ãã4 =
,
ãã= >
retRow
ãã? E
)
ããE F
;
ããF G
string
çç 
curIndex
çç #
=
çç$ %
retRow
çç& ,
.
çç, -
RowIndex
çç- 5
.
çç5 6
ToString
çç6 >
(
çç> ?
)
çç? @
;
çç@ A
string
éé 
newIndex
éé #
=
éé$ %
rowIndex
éé& .
.
éé. /
ToString
éé/ 7
(
éé7 8
)
éé8 9
;
éé9 :
foreach
êê 
(
êê 
Cell
êê !
cell
êê" &
in
êê' )
retRow
êê* 0
.
êê0 1
Elements
êê1 9
<
êê9 :
Cell
êê: >
>
êê> ?
(
êê? @
)
êê@ A
)
êêA B
{
ëë 
cell
ìì 
.
ìì 
CellReference
ìì *
=
ìì+ ,
new
ìì- 0
StringValue
ìì1 <
(
ìì< =
cell
ìì= A
.
ììA B
CellReference
ììB O
.
ììO P
Value
ììP U
.
ììU V
Replace
ììV ]
(
ìì] ^
curIndex
ìì^ f
,
ììf g
newIndex
ììh p
)
ììp q
)
ììq r
;
ììr s
}
îî 
retRow
óó 
.
óó 
RowIndex
óó #
=
óó$ %
rowIndex
óó& .
;
óó. /
}
òò 
}
ôô 
else
öö 
{
õõ 
Row
ûû 
refRow
ûû 
=
ûû 
!
ûû 
isNewLastRow
ûû *
?
ûû+ ,
	sheetData
ûû- 6
.
ûû6 7
Elements
ûû7 ?
<
ûû? @
Row
ûû@ C
>
ûûC D
(
ûûD E
)
ûûE F
.
ûûF G
FirstOrDefault
ûûG U
(
ûûU V
row
ûûV Y
=>
ûûZ \
row
ûû] `
.
ûû` a
RowIndex
ûûa i
>
ûûj k
rowIndex
ûûl t
)
ûût u
:
ûûv w
null
ûûx |
;
ûû| }
retRow
°° 
=
°° 
	insertRow
°° "
??
°°# %
new
°°& )
Row
°°* -
(
°°- .
)
°°. /
{
°°0 1
RowIndex
°°2 :
=
°°; <
rowIndex
°°= E
}
°°F G
;
°°G H
IEnumerable
££ 
<
££ 
Cell
££  
>
££  !

cellsInRow
££" ,
=
££- .
retRow
££/ 5
.
££5 6
Elements
££6 >
<
££> ?
Cell
££? C
>
££C D
(
££D E
)
££E F
;
££F G
if
•• 
(
•• 

cellsInRow
•• 
.
•• 
Any
•• "
(
••" #
)
••# $
)
••$ %
{
¶¶ 
string
ßß 
curIndex
ßß #
=
ßß$ %
retRow
ßß& ,
.
ßß, -
RowIndex
ßß- 5
.
ßß5 6
ToString
ßß6 >
(
ßß> ?
)
ßß? @
;
ßß@ A
string
®® 
newIndex
®® #
=
®®$ %
rowIndex
®®& .
.
®®. /
ToString
®®/ 7
(
®®7 8
)
®®8 9
;
®®9 :
foreach
™™ 
(
™™ 
Cell
™™ !
cell
™™" &
in
™™' )

cellsInRow
™™* 4
)
™™4 5
{
´´ 
cell
≠≠ 
.
≠≠ 
CellReference
≠≠ *
=
≠≠+ ,
new
≠≠- 0
StringValue
≠≠1 <
(
≠≠< =
cell
≠≠= A
.
≠≠A B
CellReference
≠≠B O
.
≠≠O P
Value
≠≠P U
.
≠≠U V
Replace
≠≠V ]
(
≠≠] ^
curIndex
≠≠^ f
,
≠≠f g
newIndex
≠≠h p
)
≠≠p q
)
≠≠q r
;
≠≠r s
}
ÆÆ 
retRow
±± 
.
±± 
RowIndex
±± #
=
±±$ %
rowIndex
±±& .
;
±±. /
}
≤≤ 
	sheetData
¥¥ 
.
¥¥ 
InsertBefore
¥¥ &
(
¥¥& '
retRow
¥¥' -
,
¥¥- .
refRow
¥¥/ 5
)
¥¥5 6
;
¥¥6 7
}
µµ 
return
∑∑ 
retRow
∑∑ 
;
∑∑ 
}
∏∏ 	
private
¡¡ 
static
¡¡ 
void
¡¡ 
UpdateRowIndexes
¡¡ ,
(
¡¡, -
WorksheetPart
¡¡- :
worksheetPart
¡¡; H
,
¡¡H I
uint
¡¡J N
rowIndex
¡¡O W
,
¡¡W X
bool
¡¡Y ]
isDeletedRow
¡¡^ j
)
¡¡j k
{
¬¬ 	
IEnumerable
ƒƒ 
<
ƒƒ 
Row
ƒƒ 
>
ƒƒ 
rows
ƒƒ !
=
ƒƒ" #
worksheetPart
ƒƒ$ 1
.
ƒƒ1 2
	Worksheet
ƒƒ2 ;
.
ƒƒ; <
Descendants
ƒƒ< G
<
ƒƒG H
Row
ƒƒH K
>
ƒƒK L
(
ƒƒL M
)
ƒƒM N
.
ƒƒN O
Where
ƒƒO T
(
ƒƒT U
r
ƒƒU V
=>
ƒƒW Y
r
ƒƒZ [
.
ƒƒ[ \
RowIndex
ƒƒ\ d
.
ƒƒd e
Value
ƒƒe j
>=
ƒƒk m
rowIndex
ƒƒn v
)
ƒƒv w
;
ƒƒw x
foreach
∆∆ 
(
∆∆ 
Row
∆∆ 
row
∆∆ 
in
∆∆ 
rows
∆∆  $
)
∆∆$ %
{
«« 
uint
»» 
newIndex
»» 
=
»» 
(
»»  !
isDeletedRow
»»! -
?
»». /
row
»»0 3
.
»»3 4
RowIndex
»»4 <
-
»»= >
$num
»»? @
:
»»A B
row
»»C F
.
»»F G
RowIndex
»»G O
+
»»P Q
$num
»»R S
)
»»S T
;
»»T U
string
…… 
curRowIndex
…… "
=
……# $
row
……% (
.
……( )
RowIndex
……) 1
.
……1 2
ToString
……2 :
(
……: ;
)
……; <
;
……< =
string
   
newRowIndex
   "
=
  # $
newIndex
  % -
.
  - .
ToString
  . 6
(
  6 7
)
  7 8
;
  8 9
foreach
ÃÃ 
(
ÃÃ 
Cell
ÃÃ 
cell
ÃÃ "
in
ÃÃ# %
row
ÃÃ& )
.
ÃÃ) *
Elements
ÃÃ* 2
<
ÃÃ2 3
Cell
ÃÃ3 7
>
ÃÃ7 8
(
ÃÃ8 9
)
ÃÃ9 :
)
ÃÃ: ;
{
ÕÕ 
cell
œœ 
.
œœ 
CellReference
œœ &
=
œœ' (
new
œœ) ,
StringValue
œœ- 8
(
œœ8 9
cell
œœ9 =
.
œœ= >
CellReference
œœ> K
.
œœK L
Value
œœL Q
.
œœQ R
Replace
œœR Y
(
œœY Z
curRowIndex
œœZ e
,
œœe f
newRowIndex
œœg r
)
œœr s
)
œœs t
;
œœt u
}
–– 
row
”” 
.
”” 
RowIndex
”” 
=
”” 
newIndex
”” '
;
””' (
}
‘‘ 
}
’’ 	
private
ﬂﬂ 
static
ﬂﬂ 
void
ﬂﬂ (
UpdateMergedCellReferences
ﬂﬂ 6
(
ﬂﬂ6 7
WorksheetPart
ﬂﬂ7 D
worksheetPart
ﬂﬂE R
,
ﬂﬂR S
uint
ﬂﬂT X
rowIndex
ﬂﬂY a
,
ﬂﬂa b
bool
ﬂﬂc g
isDeletedRow
ﬂﬂh t
)
ﬂﬂt u
{
‡‡ 	
if
·· 
(
·· 
worksheetPart
·· 
.
·· 
	Worksheet
·· '
.
··' (
Elements
··( 0
<
··0 1

MergeCells
··1 ;
>
··; <
(
··< =
)
··= >
.
··> ?
Count
··? D
(
··D E
)
··E F
>
··G H
$num
··I J
)
··J K
{
‚‚ 

MergeCells
„„ 

mergeCells
„„ %
=
„„& '
worksheetPart
„„( 5
.
„„5 6
	Worksheet
„„6 ?
.
„„? @
Elements
„„@ H
<
„„H I

MergeCells
„„I S
>
„„S T
(
„„T U
)
„„U V
.
„„V W
FirstOrDefault
„„W e
(
„„e f
)
„„f g
;
„„g h
if
ÂÂ 
(
ÂÂ 

mergeCells
ÂÂ 
!=
ÂÂ !
null
ÂÂ" &
)
ÂÂ& '
{
ÊÊ 
List
ËË 
<
ËË 
	MergeCell
ËË "
>
ËË" #
mergeCellsList
ËË$ 2
=
ËË3 4

mergeCells
ËË5 ?
.
ËË? @
Elements
ËË@ H
<
ËËH I
	MergeCell
ËËI R
>
ËËR S
(
ËËS T
)
ËËT U
.
ËËU V
Where
ËËV [
(
ËË[ \
r
ËË\ ]
=>
ËË^ `
r
ËËa b
.
ËËb c
	Reference
ËËc l
.
ËËl m
HasValue
ËËm u
)
ËËu v
.
ÈÈU V
Where
ÈÈV [
(
ÈÈ[ \
r
ÈÈ\ ]
=>
ÈÈ^ `
GetRowIndex
ÈÈa l
(
ÈÈl m
r
ÈÈm n
.
ÈÈn o
	Reference
ÈÈo x
.
ÈÈx y
Value
ÈÈy ~
.
ÈÈ~ 
SplitÈÈ Ñ
(ÈÈÑ Ö
$charÈÈÖ à
)ÈÈà â
.ÈÈâ ä
	ElementAtÈÈä ì
(ÈÈì î
$numÈÈî ï
)ÈÈï ñ
)ÈÈñ ó
>=ÈÈò ö
rowIndexÈÈõ £
||ÈÈ§ ¶
GetRowIndex
ÍÍa l
(
ÍÍl m
r
ÍÍm n
.
ÍÍn o
	Reference
ÍÍo x
.
ÍÍx y
Value
ÍÍy ~
.
ÍÍ~ 
SplitÍÍ Ñ
(ÍÍÑ Ö
$charÍÍÖ à
)ÍÍà â
.ÍÍâ ä
	ElementAtÍÍä ì
(ÍÍì î
$numÍÍî ï
)ÍÍï ñ
)ÍÍñ ó
>=ÍÍò ö
rowIndexÍÍõ £
)ÍÍ£ §
.ÍÍ§ •
ToListÍÍ• ´
(ÍÍ´ ¨
)ÍÍ¨ ≠
;ÍÍ≠ Æ
if
ÌÌ 
(
ÌÌ 
isDeletedRow
ÌÌ $
)
ÌÌ$ %
{
ÓÓ 
List
ÔÔ 
<
ÔÔ 
	MergeCell
ÔÔ &
>
ÔÔ& ' 
mergeCellsToDelete
ÔÔ( :
=
ÔÔ; <
mergeCellsList
ÔÔ= K
.
ÔÔK L
Where
ÔÔL Q
(
ÔÔQ R
r
ÔÔR S
=>
ÔÔT V
GetRowIndex
ÔÔW b
(
ÔÔb c
r
ÔÔc d
.
ÔÔd e
	Reference
ÔÔe n
.
ÔÔn o
Value
ÔÔo t
.
ÔÔt u
Split
ÔÔu z
(
ÔÔz {
$char
ÔÔ{ ~
)
ÔÔ~ 
.ÔÔ Ä
	ElementAtÔÔÄ â
(ÔÔâ ä
$numÔÔä ã
)ÔÔã å
)ÔÔå ç
==ÔÔé ê
rowIndexÔÔë ô
||ÔÔö ú
GetRowIndex
W b
(
b c
r
c d
.
d e
	Reference
e n
.
n o
Value
o t
.
t u
Split
u z
(
z {
$char
{ ~
)
~ 
. Ä
	ElementAtÄ â
(â ä
$numä ã
)ã å
)å ç
==é ê
rowIndexë ô
)ô ö
.ö õ
ToListõ °
(° ¢
)¢ £
;£ §
foreach
ÛÛ 
(
ÛÛ  !
	MergeCell
ÛÛ! *
cellToDelete
ÛÛ+ 7
in
ÛÛ8 : 
mergeCellsToDelete
ÛÛ; M
)
ÛÛM N
{
ÙÙ 
cellToDelete
ıı (
.
ıı( )
Remove
ıı) /
(
ıı/ 0
)
ıı0 1
;
ıı1 2
}
ˆˆ 
mergeCellsList
˘˘ &
=
˘˘' (

mergeCells
˘˘) 3
.
˘˘3 4
Elements
˘˘4 <
<
˘˘< =
	MergeCell
˘˘= F
>
˘˘F G
(
˘˘G H
)
˘˘H I
.
˘˘I J
Where
˘˘J O
(
˘˘O P
r
˘˘P Q
=>
˘˘R T
r
˘˘U V
.
˘˘V W
	Reference
˘˘W `
.
˘˘` a
HasValue
˘˘a i
)
˘˘i j
.
˙˙I J
Where
˙˙J O
(
˙˙O P
r
˙˙P Q
=>
˙˙R T
GetRowIndex
˙˙U `
(
˙˙` a
r
˙˙a b
.
˙˙b c
	Reference
˙˙c l
.
˙˙l m
Value
˙˙m r
.
˙˙r s
Split
˙˙s x
(
˙˙x y
$char
˙˙y |
)
˙˙| }
.
˙˙} ~
	ElementAt˙˙~ á
(˙˙á à
$num˙˙à â
)˙˙â ä
)˙˙ä ã
>˙˙å ç
rowIndex˙˙é ñ
||˙˙ó ô
GetRowIndex
˚˚U `
(
˚˚` a
r
˚˚a b
.
˚˚b c
	Reference
˚˚c l
.
˚˚l m
Value
˚˚m r
.
˚˚r s
Split
˚˚s x
(
˚˚x y
$char
˚˚y |
)
˚˚| }
.
˚˚} ~
	ElementAt˚˚~ á
(˚˚á à
$num˚˚à â
)˚˚â ä
)˚˚ä ã
>˚˚å ç
rowIndex˚˚é ñ
)˚˚ñ ó
.˚˚ó ò
ToList˚˚ò û
(˚˚û ü
)˚˚ü †
;˚˚† °
}
¸¸ 
foreach
ˇˇ 
(
ˇˇ 
	MergeCell
ˇˇ &
	mergeCell
ˇˇ' 0
in
ˇˇ1 3
mergeCellsList
ˇˇ4 B
)
ˇˇB C
{
ÄÄ 
string
ÅÅ 
[
ÅÅ 
]
ÅÅ  
cellReference
ÅÅ! .
=
ÅÅ/ 0
	mergeCell
ÅÅ1 :
.
ÅÅ: ;
	Reference
ÅÅ; D
.
ÅÅD E
Value
ÅÅE J
.
ÅÅJ K
Split
ÅÅK P
(
ÅÅP Q
$char
ÅÅQ T
)
ÅÅT U
;
ÅÅU V
if
ÉÉ 
(
ÉÉ 
GetRowIndex
ÉÉ '
(
ÉÉ' (
cellReference
ÉÉ( 5
.
ÉÉ5 6
	ElementAt
ÉÉ6 ?
(
ÉÉ? @
$num
ÉÉ@ A
)
ÉÉA B
)
ÉÉB C
>=
ÉÉD F
rowIndex
ÉÉG O
)
ÉÉO P
{
ÑÑ 
string
ÖÖ "

columnName
ÖÖ# -
=
ÖÖ. /
GetColumnName
ÖÖ0 =
(
ÖÖ= >
cellReference
ÖÖ> K
.
ÖÖK L
	ElementAt
ÖÖL U
(
ÖÖU V
$num
ÖÖV W
)
ÖÖW X
)
ÖÖX Y
;
ÖÖY Z
cellReference
ÜÜ )
[
ÜÜ) *
$num
ÜÜ* +
]
ÜÜ+ ,
=
ÜÜ- .
isDeletedRow
ÜÜ/ ;
?
ÜÜ< =

columnName
ÜÜ> H
+
ÜÜI J
(
ÜÜK L
GetRowIndex
ÜÜL W
(
ÜÜW X
cellReference
ÜÜX e
.
ÜÜe f
	ElementAt
ÜÜf o
(
ÜÜo p
$num
ÜÜp q
)
ÜÜq r
)
ÜÜr s
-
ÜÜt u
$num
ÜÜv w
)
ÜÜw x
.
ÜÜx y
ToStringÜÜy Å
(ÜÜÅ Ç
)ÜÜÇ É
:ÜÜÑ Ö&
IncrementCellReferenceÜÜÜ ú
(ÜÜú ù
cellReferenceÜÜù ™
.ÜÜ™ ´
	ElementAtÜÜ´ ¥
(ÜÜ¥ µ
$numÜÜµ ∂
)ÜÜ∂ ∑
,ÜÜ∑ ∏%
CellReferencePartEnumÜÜπ Œ
.ÜÜŒ œ
RowÜÜœ “
)ÜÜ“ ”
;ÜÜ” ‘
}
áá 
if
ââ 
(
ââ 
GetRowIndex
ââ '
(
ââ' (
cellReference
ââ( 5
.
ââ5 6
	ElementAt
ââ6 ?
(
ââ? @
$num
ââ@ A
)
ââA B
)
ââB C
>=
ââD F
rowIndex
ââG O
)
ââO P
{
ää 
string
ãã "

columnName
ãã# -
=
ãã. /
GetColumnName
ãã0 =
(
ãã= >
cellReference
ãã> K
.
ããK L
	ElementAt
ããL U
(
ããU V
$num
ããV W
)
ããW X
)
ããX Y
;
ããY Z
cellReference
åå )
[
åå) *
$num
åå* +
]
åå+ ,
=
åå- .
isDeletedRow
åå/ ;
?
åå< =

columnName
åå> H
+
ååI J
(
ååK L
GetRowIndex
ååL W
(
ååW X
cellReference
ååX e
.
ååe f
	ElementAt
ååf o
(
ååo p
$num
ååp q
)
ååq r
)
åår s
-
ååt u
$num
ååv w
)
ååw x
.
ååx y
ToStringååy Å
(ååÅ Ç
)ååÇ É
:ååÑ Ö&
IncrementCellReferenceååÜ ú
(ååú ù
cellReferenceååù ™
.åå™ ´
	ElementAtåå´ ¥
(åå¥ µ
$numååµ ∂
)åå∂ ∑
,åå∑ ∏%
CellReferencePartEnumååπ Œ
.ååŒ œ
Rowååœ “
)åå“ ”
;åå” ‘
}
çç 
	mergeCell
èè !
.
èè! "
	Reference
èè" +
=
èè, -
new
èè. 1
StringValue
èè2 =
(
èè= >
cellReference
èè> K
[
èèK L
$num
èèL M
]
èèM N
+
èèO P
$str
èèQ T
+
èèU V
cellReference
èèW d
[
èèd e
$num
èèe f
]
èèf g
)
èèg h
;
èèh i
}
êê 
}
ëë 
}
íí 
}
ìì 	
private
õõ 
static
õõ 
void
õõ '
UpdateHyperlinkReferences
õõ 5
(
õõ5 6
WorksheetPart
õõ6 C
worksheetPart
õõD Q
,
õõQ R
uint
õõS W
rowIndex
õõX `
,
õõ` a
bool
õõb f
isDeletedRow
õõg s
)
õõs t
{
úú 	

Hyperlinks
ùù 

hyperlinks
ùù !
=
ùù" #
worksheetPart
ùù$ 1
.
ùù1 2
	Worksheet
ùù2 ;
.
ùù; <
Elements
ùù< D
<
ùùD E

Hyperlinks
ùùE O
>
ùùO P
(
ùùP Q
)
ùùQ R
.
ùùR S
FirstOrDefault
ùùS a
(
ùùa b
)
ùùb c
;
ùùc d
if
üü 
(
üü 

hyperlinks
üü 
!=
üü 
null
üü "
)
üü" #
{
†† 
Match
°° $
hyperlinkRowIndexMatch
°° ,
;
°°, -
uint
¢¢ 
hyperlinkRowIndex
¢¢ &
;
¢¢& '
foreach
§§ 
(
§§ 
	Hyperlink
§§ "
	hyperlink
§§# ,
in
§§- /

hyperlinks
§§0 :
.
§§: ;
Elements
§§; C
<
§§C D
	Hyperlink
§§D M
>
§§M N
(
§§N O
)
§§O P
)
§§P Q
{
•• $
hyperlinkRowIndexMatch
¶¶ *
=
¶¶+ ,
Regex
¶¶- 2
.
¶¶2 3
Match
¶¶3 8
(
¶¶8 9
	hyperlink
¶¶9 B
.
¶¶B C
	Reference
¶¶C L
.
¶¶L M
Value
¶¶M R
,
¶¶R S
$str
¶¶T \
)
¶¶\ ]
;
¶¶] ^
if
ßß 
(
ßß $
hyperlinkRowIndexMatch
ßß .
.
ßß. /
Success
ßß/ 6
&&
ßß7 9
uint
ßß: >
.
ßß> ?
TryParse
ßß? G
(
ßßG H$
hyperlinkRowIndexMatch
ßßH ^
.
ßß^ _
Value
ßß_ d
,
ßßd e
out
ßßf i
hyperlinkRowIndex
ßßj {
)
ßß{ |
&&
ßß} !
hyperlinkRowIndexßßÄ ë
>=ßßí î
rowIndexßßï ù
)ßßù û
{
®® 
if
™™ 
(
™™ 
isDeletedRow
™™ (
)
™™( )
{
´´ 
if
≠≠ 
(
≠≠  
hyperlinkRowIndex
≠≠  1
==
≠≠2 4
rowIndex
≠≠5 =
)
≠≠= >
{
ÆÆ 
	hyperlink
ØØ  )
.
ØØ) *
Remove
ØØ* 0
(
ØØ0 1
)
ØØ1 2
;
ØØ2 3
}
∞∞ 
else
≤≤  
{
≥≥ 
	hyperlink
¥¥  )
.
¥¥) *
	Reference
¥¥* 3
.
¥¥3 4
Value
¥¥4 9
=
¥¥: ;
	hyperlink
¥¥< E
.
¥¥E F
	Reference
¥¥F O
.
¥¥O P
Value
¥¥P U
.
¥¥U V
Replace
¥¥V ]
(
¥¥] ^$
hyperlinkRowIndexMatch
¥¥^ t
.
¥¥t u
Value
¥¥u z
,
¥¥z {
(
¥¥| } 
hyperlinkRowIndex¥¥} é
-¥¥è ê
$num¥¥ë í
)¥¥í ì
.¥¥ì î
ToString¥¥î ú
(¥¥ú ù
)¥¥ù û
)¥¥û ü
;¥¥ü †
}
∂∂ 
}
∑∑ 
else
ππ 
{
∫∫ 
	hyperlink
ªª %
.
ªª% &
	Reference
ªª& /
.
ªª/ 0
Value
ªª0 5
=
ªª6 7
	hyperlink
ªª8 A
.
ªªA B
	Reference
ªªB K
.
ªªK L
Value
ªªL Q
.
ªªQ R
Replace
ªªR Y
(
ªªY Z$
hyperlinkRowIndexMatch
ªªZ p
.
ªªp q
Value
ªªq v
,
ªªv w
(
ªªx y 
hyperlinkRowIndexªªy ä
+ªªã å
$numªªç é
)ªªé è
.ªªè ê
ToStringªªê ò
(ªªò ô
)ªªô ö
)ªªö õ
;ªªõ ú
}
ºº 
}
ΩΩ 
}
ææ 
if
¡¡ 
(
¡¡ 

hyperlinks
¡¡ 
.
¡¡ 
Elements
¡¡ '
<
¡¡' (
	Hyperlink
¡¡( 1
>
¡¡1 2
(
¡¡2 3
)
¡¡3 4
.
¡¡4 5
Count
¡¡5 :
(
¡¡: ;
)
¡¡; <
==
¡¡= ?
$num
¡¡@ A
)
¡¡A B
{
¬¬ 

hyperlinks
√√ 
.
√√ 
Remove
√√ %
(
√√% &
)
√√& '
;
√√' (
}
ƒƒ 
}
≈≈ 
}
∆∆ 	
public
ÕÕ 
static
ÕÕ 
uint
ÕÕ 
GetRowIndex
ÕÕ &
(
ÕÕ& '
string
ÕÕ' -
cellReference
ÕÕ. ;
)
ÕÕ; <
{
ŒŒ 	
Regex
–– 
regex
–– 
=
–– 
new
–– 
Regex
–– #
(
––# $
$str
––$ *
)
––* +
;
––+ ,
Match
—— 
match
—— 
=
—— 
regex
—— 
.
——  
Match
——  %
(
——% &
cellReference
——& 3
)
——3 4
;
——4 5
return
”” 
uint
”” 
.
”” 
Parse
”” 
(
”” 
match
”” #
.
””# $
Value
””$ )
)
””) *
;
””* +
}
‘‘ 	
public
›› 
static
›› 
string
›› $
IncrementCellReference
›› 3
(
››3 4
string
››4 :
	reference
››; D
,
››D E#
CellReferencePartEnum
››F [
cellRefPart
››\ g
)
››g h
{
ﬁﬁ 	
string
ﬂﬂ 
newReference
ﬂﬂ 
=
ﬂﬂ  !
	reference
ﬂﬂ" +
;
ﬂﬂ+ ,
if
·· 
(
·· 
cellRefPart
·· 
!=
·· #
CellReferencePartEnum
·· 4
.
··4 5
None
··5 9
&&
··: <
!
··= >
String
··> D
.
··D E
IsNullOrEmpty
··E R
(
··R S
	reference
··S \
)
··\ ]
)
··] ^
{
‚‚ 
string
„„ 
[
„„ 
]
„„ 
parts
„„ 
=
„„  
Regex
„„! &
.
„„& '
Split
„„' ,
(
„„, -
	reference
„„- 6
,
„„6 7
$str
„„8 B
)
„„B C
;
„„C D
if
ÂÂ 
(
ÂÂ 
cellRefPart
ÂÂ 
==
ÂÂ  "#
CellReferencePartEnum
ÂÂ# 8
.
ÂÂ8 9
Column
ÂÂ9 ?
||
ÂÂ@ B
cellRefPart
ÂÂC N
==
ÂÂO Q#
CellReferencePartEnum
ÂÂR g
.
ÂÂg h
Both
ÂÂh l
)
ÂÂl m
{
ÊÊ 
List
ÁÁ 
<
ÁÁ 
char
ÁÁ 
>
ÁÁ 
col
ÁÁ "
=
ÁÁ# $
parts
ÁÁ% *
[
ÁÁ* +
$num
ÁÁ+ ,
]
ÁÁ, -
.
ÁÁ- .
ToCharArray
ÁÁ. 9
(
ÁÁ9 :
)
ÁÁ: ;
.
ÁÁ; <
ToList
ÁÁ< B
(
ÁÁB C
)
ÁÁC D
;
ÁÁD E
bool
ËË 
needsIncrement
ËË '
=
ËË( )
true
ËË* .
;
ËË. /
int
ÈÈ 
index
ÈÈ 
=
ÈÈ 
col
ÈÈ  #
.
ÈÈ# $
Count
ÈÈ$ )
-
ÈÈ* +
$num
ÈÈ, -
;
ÈÈ- .
do
ÎÎ 
{
ÏÏ 
col
ÓÓ 
[
ÓÓ 
index
ÓÓ !
]
ÓÓ! "
=
ÓÓ# $
_letters
ÓÓ% -
[
ÓÓ- .
_letters
ÓÓ. 6
.
ÓÓ6 7
IndexOf
ÓÓ7 >
(
ÓÓ> ?
col
ÓÓ? B
[
ÓÓB C
index
ÓÓC H
]
ÓÓH I
)
ÓÓI J
+
ÓÓK L
$num
ÓÓM N
]
ÓÓN O
;
ÓÓO P
if
ÒÒ 
(
ÒÒ 
col
ÒÒ 
[
ÒÒ  
index
ÒÒ  %
]
ÒÒ% &
==
ÒÒ' )
_letters
ÒÒ* 2
[
ÒÒ2 3
_letters
ÒÒ3 ;
.
ÒÒ; <
Count
ÒÒ< A
-
ÒÒB C
$num
ÒÒD E
]
ÒÒE F
)
ÒÒF G
{
ÚÚ 
col
ÛÛ 
[
ÛÛ  
index
ÛÛ  %
]
ÛÛ% &
=
ÛÛ' (
_letters
ÛÛ) 1
[
ÛÛ1 2
$num
ÛÛ2 3
]
ÛÛ3 4
;
ÛÛ4 5
}
ÙÙ 
else
ıı 
{
ˆˆ 
needsIncrement
˜˜ *
=
˜˜+ ,
false
˜˜- 2
;
˜˜2 3
}
¯¯ 
}
˙˙ 
while
˙˙ 
(
˙˙ 
needsIncrement
˙˙ +
&&
˙˙, .
--
˙˙/ 1
index
˙˙1 6
>=
˙˙7 9
$num
˙˙: ;
)
˙˙; <
;
˙˙< =
if
˝˝ 
(
˝˝ 
needsIncrement
˝˝ &
)
˝˝& '
{
˛˛ 
col
ˇˇ 
.
ˇˇ 
Add
ˇˇ 
(
ˇˇ  
_letters
ˇˇ  (
[
ˇˇ( )
$num
ˇˇ) *
]
ˇˇ* +
)
ˇˇ+ ,
;
ˇˇ, -
}
ÄÄ 
parts
ÇÇ 
[
ÇÇ 
$num
ÇÇ 
]
ÇÇ 
=
ÇÇ 
new
ÇÇ "
String
ÇÇ# )
(
ÇÇ) *
col
ÇÇ* -
.
ÇÇ- .
ToArray
ÇÇ. 5
(
ÇÇ5 6
)
ÇÇ6 7
)
ÇÇ7 8
;
ÇÇ8 9
}
ÉÉ 
if
ÖÖ 
(
ÖÖ 
cellRefPart
ÖÖ 
==
ÖÖ  "#
CellReferencePartEnum
ÖÖ# 8
.
ÖÖ8 9
Row
ÖÖ9 <
||
ÖÖ= ?
cellRefPart
ÖÖ@ K
==
ÖÖL N#
CellReferencePartEnum
ÖÖO d
.
ÖÖd e
Both
ÖÖe i
)
ÖÖi j
{
ÜÜ 
parts
àà 
[
àà 
$num
àà 
]
àà 
=
àà 
(
àà  
int
àà  #
.
àà# $
Parse
àà$ )
(
àà) *
parts
àà* /
[
àà/ 0
$num
àà0 1
]
àà1 2
)
àà2 3
+
àà4 5
$num
àà6 7
)
àà7 8
.
àà8 9
ToString
àà9 A
(
ààA B
)
ààB C
;
ààC D
}
ââ 
newReference
ãã 
=
ãã 
parts
ãã $
[
ãã$ %
$num
ãã% &
]
ãã& '
+
ãã( )
parts
ãã* /
[
ãã/ 0
$num
ãã0 1
]
ãã1 2
;
ãã2 3
}
åå 
return
éé 
newReference
éé 
;
éé  
}
èè 	
private
ññ 
static
ññ 
string
ññ 
GetColumnName
ññ +
(
ññ+ ,
string
ññ, 2
cellName
ññ3 ;
)
ññ; <
{
óó 	
Regex
ôô 
regex
ôô 
=
ôô 
new
ôô 
Regex
ôô #
(
ôô# $
$str
ôô$ /
)
ôô/ 0
;
ôô0 1
Match
öö 
match
öö 
=
öö 
regex
öö 
.
öö  
Match
öö  %
(
öö% &
cellName
öö& .
)
öö. /
;
öö/ 0
return
úú 
match
úú 
.
úú 
Value
úú 
;
úú 
}
ùù 	
public
ûû 
enum
ûû #
CellReferencePartEnum
ûû )
{
üü 	
None
†† 
,
†† 
Column
°° 
,
°° 
Row
¢¢ 
,
¢¢ 
Both
££ 
}
§§ 	
private
•• 
static
•• 
List
•• 
<
•• 
char
••  
>
••  !
_letters
••" *
=
••+ ,
new
••- 0
List
••1 5
<
••5 6
char
••6 :
>
••: ;
(
••; <
)
••< =
{
••> ?
$char
••@ C
,
••C D
$char
••E H
,
••H I
$char
••J M
,
••M N
$char
••O R
,
••R S
$char
••T W
,
••W X
$char
••Y \
,
••\ ]
$char
••^ a
,
••a b
$char
••c f
,
••f g
$char
••h k
,
••k l
$char
••m p
,
••p q
$char
••r u
,
••u v
$char
••w z
,
••z {
$char
••| 
,•• Ä
$char••Å Ñ
,••Ñ Ö
$char••Ü â
,••â ä
$char••ã é
,••é è
$char••ê ì
,••ì î
$char••ï ò
,••ò ô
$char••ö ù
,••ù û
$char••ü ¢
,••¢ £
$char••§ ß
,••ß ®
$char••© ¨
,••¨ ≠
$char••Æ ±
,••± ≤
$char••≥ ∂
,••∂ ∑
$char••∏ ª
,••ª º
$char••Ω ¿
,••¿ ¡
$char••¬ ≈
}••∆ «
;••« »
private
™™ 
static
™™ 
void
™™ 
AddImage
™™ $
(
™™$ %
WorksheetPart
™™% 2
worksheetPart
™™3 @
,
™™@ A
string
™™B H
imageFilePath
™™I V
,
™™V W
int
™™X [
	rowNumber
™™\ e
,
™™e f
int
™™g j
	colNumber
™™k t
)
™™t u
{
´´ 	
Bitmap
¨¨ 
bm
¨¨ 
=
¨¨ 
new
¨¨ 
Bitmap
¨¨ "
(
¨¨" #
imageFilePath
¨¨# 0
)
¨¨0 1
;
¨¨1 2
DocumentFormat
≠≠ 
.
≠≠ 
OpenXml
≠≠ "
.
≠≠" #
Drawing
≠≠# *
.
≠≠* +
Extents
≠≠+ 2
extents
≠≠3 :
=
≠≠; <
new
≠≠= @
DocumentFormat
≠≠A O
.
≠≠O P
OpenXml
≠≠P W
.
≠≠W X
Drawing
≠≠X _
.
≠≠_ `
Extents
≠≠` g
(
≠≠g h
)
≠≠h i
;
≠≠i j
var
ÆÆ 
	extentsCx
ÆÆ 
=
ÆÆ 
(
ÆÆ 
long
ÆÆ !
)
ÆÆ! "
bm
ÆÆ" $
.
ÆÆ$ %
Width
ÆÆ% *
*
ÆÆ+ ,
(
ÆÆ- .
long
ÆÆ. 2
)
ÆÆ2 3
(
ÆÆ3 4
(
ÆÆ4 5
float
ÆÆ5 :
)
ÆÆ: ;
$num
ÆÆ; A
/
ÆÆB C
bm
ÆÆD F
.
ÆÆF G"
HorizontalResolution
ÆÆG [
)
ÆÆ[ \
;
ÆÆ\ ]
var
ØØ 
	extentsCy
ØØ 
=
ØØ 
(
ØØ 
long
ØØ !
)
ØØ! "
bm
ØØ" $
.
ØØ$ %
Height
ØØ% +
*
ØØ, -
(
ØØ. /
long
ØØ/ 3
)
ØØ3 4
(
ØØ4 5
(
ØØ5 6
float
ØØ6 ;
)
ØØ; <
$num
ØØ< B
/
ØØC D
bm
ØØE G
.
ØØG H 
VerticalResolution
ØØH Z
)
ØØZ [
;
ØØ[ \
bm
∞∞ 
.
∞∞ 
Dispose
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
var
≤≤ 
	colOffset
≤≤ 
=
≤≤ 
$num
≤≤ 
;
≤≤ 
var
≥≥ 
	rowOffset
≥≥ 
=
≥≥ 
$num
≥≥ 
;
≥≥ 
var
∑∑ 
drawingsPart
∑∑ 
=
∑∑ 
worksheetPart
∑∑ ,
.
∑∑, -
DrawingsPart
∑∑- 9
;
∑∑9 :
var
∏∏ 
worksheetDrawing
∏∏  
=
∏∏! "
drawingsPart
∏∏# /
.
∏∏/ 0
WorksheetDrawing
∏∏0 @
;
∏∏@ A
var
∫∫ 
	imagePart
∫∫ 
=
∫∫ 
drawingsPart
∫∫ (
.
∫∫( )
AddImagePart
∫∫) 5
(
∫∫5 6
ImagePartType
∫∫6 C
.
∫∫C D
Jpeg
∫∫D H
)
∫∫H I
;
∫∫I J
using
ºº 
(
ºº 
var
ºº 
stream
ºº 
=
ºº 
new
ºº  #

FileStream
ºº$ .
(
ºº. /
imageFilePath
ºº/ <
,
ºº< =
FileMode
ºº> F
.
ººF G
Open
ººG K
)
ººK L
)
ººL M
{
ΩΩ 
	imagePart
ææ 
.
ææ 
FeedData
ææ "
(
ææ" #
stream
ææ# )
)
ææ) *
;
ææ* +
}
øø 
var
¡¡ 
nvps
¡¡ 
=
¡¡ 
worksheetDrawing
¡¡ '
.
¡¡' (
Descendants
¡¡( 3
<
¡¡3 4
Xdr
¡¡4 7
.
¡¡7 8(
NonVisualDrawingProperties
¡¡8 R
>
¡¡R S
(
¡¡S T
)
¡¡T U
;
¡¡U V
var
¬¬ 
nvpId
¬¬ 
=
¬¬ 
nvps
¬¬ 
.
¬¬ 
Count
¬¬ "
(
¬¬" #
)
¬¬# $
>
¬¬% &
$num
¬¬' (
?
¬¬) *
(
√√ 
UInt32Value
√√ 
)
√√ 
worksheetDrawing
√√ -
.
√√- .
Descendants
√√. 9
<
√√9 :
Xdr
√√: =
.
√√= >(
NonVisualDrawingProperties
√√> X
>
√√X Y
(
√√Y Z
)
√√Z [
.
√√[ \
Max
√√\ _
(
√√_ `
p
√√` a
=>
√√b d
p
√√e f
.
√√f g
Id
√√g i
.
√√i j
Value
√√j o
)
√√o p
+
√√q r
$num
√√s t
:
√√u v
$num
ƒƒ 
;
ƒƒ 
var
∆∆ 
oneCellAnchor
∆∆ 
=
∆∆ 
new
∆∆  #
Xdr
∆∆$ '
.
∆∆' (
OneCellAnchor
∆∆( 5
(
∆∆5 6
new
«« 
Xdr
«« 
.
«« 

FromMarker
«« "
{
»» 
ColumnId
…… 
=
…… 
new
…… "
Xdr
……# &
.
……& '
ColumnId
……' /
(
……/ 0
(
……0 1
	colNumber
……1 :
-
……; <
$num
……= >
)
……> ?
.
……? @
ToString
……@ H
(
……H I
)
……I J
)
……J K
,
……K L
RowId
   
=
   
new
   
Xdr
    #
.
  # $
RowId
  $ )
(
  ) *
(
  * +
	rowNumber
  + 4
-
  5 6
$num
  7 8
)
  8 9
.
  9 :
ToString
  : B
(
  B C
)
  C D
)
  D E
,
  E F
ColumnOffset
ÀÀ  
=
ÀÀ! "
new
ÀÀ# &
Xdr
ÀÀ' *
.
ÀÀ* +
ColumnOffset
ÀÀ+ 7
(
ÀÀ7 8
	colOffset
ÀÀ8 A
.
ÀÀA B
ToString
ÀÀB J
(
ÀÀJ K
)
ÀÀK L
)
ÀÀL M
,
ÀÀM N
	RowOffset
ÃÃ 
=
ÃÃ 
new
ÃÃ  #
Xdr
ÃÃ$ '
.
ÃÃ' (
	RowOffset
ÃÃ( 1
(
ÃÃ1 2
	rowOffset
ÃÃ2 ;
.
ÃÃ; <
ToString
ÃÃ< D
(
ÃÃD E
)
ÃÃE F
)
ÃÃF G
}
ÕÕ 
,
ÕÕ 
new
ŒŒ 
Xdr
ŒŒ 
.
ŒŒ 
Extent
ŒŒ 
{
ŒŒ  
Cx
ŒŒ! #
=
ŒŒ$ %
	extentsCx
ŒŒ& /
,
ŒŒ/ 0
Cy
ŒŒ1 3
=
ŒŒ4 5
	extentsCy
ŒŒ6 ?
}
ŒŒ@ A
,
ŒŒA B
new
œœ 
Xdr
œœ 
.
œœ 
Picture
œœ 
(
œœ  
new
–– 
Xdr
–– 
.
–– (
NonVisualPictureProperties
–– 6
(
––6 7
new
—— 
Xdr
—— 
.
——  (
NonVisualDrawingProperties
——  :
{
——; <
Id
——= ?
=
——@ A
nvpId
——B G
,
——G H
Name
——I M
=
——N O
$str
——P Z
+
——[ \
nvpId
——] b
,
——b c
Description
——d o
=
——p q
imageFilePath
——r 
}——Ä Å
,——Å Ç
new
““ 
Xdr
““ 
.
““  /
!NonVisualPictureDrawingProperties
““  A
(
““A B
new
““B E
A
““F G
.
““G H
PictureLocks
““H T
{
““U V
NoChangeAspect
““W e
=
““f g
true
““h l
}
““m n
)
““n o
)
”” 
,
”” 
new
‘‘ 
Xdr
‘‘ 
.
‘‘ 
BlipFill
‘‘ $
(
‘‘$ %
new
’’ 
A
’’ 
.
’’ 
Blip
’’ "
{
’’# $
Embed
’’% *
=
’’+ ,
drawingsPart
’’- 9
.
’’9 :
GetIdOfPart
’’: E
(
’’E F
	imagePart
’’F O
)
’’O P
,
’’P Q
CompressionState
’’R b
=
’’c d
A
’’e f
.
’’f g#
BlipCompressionValues
’’g |
.
’’| }
Print’’} Ç
}’’É Ñ
,’’Ñ Ö
new
÷÷ 
A
÷÷ 
.
÷÷ 
Stretch
÷÷ %
(
÷÷% &
new
÷÷& )
A
÷÷* +
.
÷÷+ ,
FillRectangle
÷÷, 9
(
÷÷9 :
)
÷÷: ;
)
÷÷; <
)
◊◊ 
,
◊◊ 
new
ÿÿ 
Xdr
ÿÿ 
.
ÿÿ 
ShapeProperties
ÿÿ +
(
ÿÿ+ ,
new
ŸŸ 
A
ŸŸ 
.
ŸŸ 
Transform2D
ŸŸ )
(
ŸŸ) *
new
⁄⁄ 
A
⁄⁄  !
.
⁄⁄! "
Offset
⁄⁄" (
{
⁄⁄) *
X
⁄⁄+ ,
=
⁄⁄- .
$num
⁄⁄/ 0
,
⁄⁄0 1
Y
⁄⁄2 3
=
⁄⁄4 5
$num
⁄⁄6 7
}
⁄⁄8 9
,
⁄⁄9 :
new
€€ 
A
€€  !
.
€€! "
Extents
€€" )
{
€€* +
Cx
€€, .
=
€€/ 0
	extentsCx
€€1 :
,
€€: ;
Cy
€€< >
=
€€? @
	extentsCy
€€A J
}
€€K L
)
‹‹ 
,
‹‹ 
new
›› 
A
›› 
.
›› 
PresetGeometry
›› ,
{
››- .
Preset
››/ 5
=
››6 7
A
››8 9
.
››9 :
ShapeTypeValues
››: I
.
››I J
	Rectangle
››J S
}
››T U
)
ﬁﬁ 
)
ﬂﬂ 
,
ﬂﬂ 
new
‡‡ 
Xdr
‡‡ 
.
‡‡ 

ClientData
‡‡ "
(
‡‡" #
)
‡‡# $
)
·· 
;
·· 
worksheetDrawing
‚‚ 
.
‚‚ 
Append
‚‚ #
(
‚‚# $
oneCellAnchor
‚‚$ 1
)
‚‚1 2
;
‚‚2 3
}
ÇÇ 	
}
ÑÑ 
}ÖÖ ñ
FE:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Reports\ReportModel.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Reports #
{ 
public 

sealed 
class 
ReportModel #
{ 
public 
DataSet 
DataSet 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 

Dictionary		 
<		 
string		  
,		  !
object		" (
>		( )

Parameters		* 4
{		5 6
get		7 :
;		: ;
set		< ?
;		? @
}		A B
public 
ReportModel 
( 
) 
{ 	

Parameters 
= 
new 

Dictionary '
<' (
string( .
,. /
object0 6
>6 7
(7 8
)8 9
;9 :
} 	
} 
} ·
:E:\NET_PROJECTS\ADSDataDirect\ADSDataDirect.Web\Startup.cs
[ 
assembly 	
:	 

OwinStartup 
( 
typeof 
( 
Startup %
)% &
)& '
]' (
	namespace 	
ADSDataDirect
 
. 
Web 
{ 
public 

partial 
class 
Startup  
{ 
public 
void 
Configuration !
(! "
IAppBuilder" -
app. 1
)1 2
{ 	
CultureInfo 
. '
DefaultThreadCurrentCulture 3
=4 5
CultureInfo6 A
.A B
GetCultureInfoB P
(P Q
$strQ X
)X Y
;Y Z
CultureInfo 
. )
DefaultThreadCurrentUICulture 5
=6 7
CultureInfo8 C
.C D
GetCultureInfoD R
(R S
$strS Z
)Z [
;[ \
ConfigureAuth 
( 
app 
) 
;  
SetupInitialSettings  
(  !
)! "
;" #
app 
.  
UseHangfireDashboard $
($ %
$"% '
	/hangfire' 0
"0 1
,1 2
new3 6
DashboardOptions7 G
{ 
Authorization 
= 
new  #
[# $
]$ %
{ 
new   '
HangfireAuthorizationFilter   3
(  3 4
)  4 5
}"" 
}## 
)## 
;## 
app$$ 
.$$ 
UseHangfireServer$$ !
($$! "
)$$" #
;$$# $
app&& 
.&& 

MapSignalR&& 
(&& 
)&& 
;&& 
WfpictUpdater(( 
.(( 
Instance(( "
.((" # 
StartUpdatingClients((# 7
(((7 8
)((8 9
;((9 :
RecurringJob++ 
.++ 
AddOrUpdate++ $
(++$ %
$str++% >
,++> ?
(++@ A
)++A B
=>++C E"
NotificationsProcessor++F \
.++\ ]#
FetchAndCheckForQcRules++] t
(++t u
)++u v
,++v w
Cron++x |
.++| }
HourInterval	++} â
(
++â ä
$num
++ä ã
)
++ã å
)
++å ç
;
++ç é
RecurringJob-- 
.-- 
AddOrUpdate-- $
(--$ %
$str--% =
,--= >
(--? @
)--@ A
=>--B D"
NotificationsProcessor--E [
.--[ \"
SendNotificationEmails--\ r
(--r s
)--s t
,--t u
$str	--v á
)
--á à
;
--à â
}00 	
private22 
void22  
SetupInitialSettings22 )
(22) *
)22* +
{33 	
using44 
(44 
WfpictContext44  
ctx44! $
=44% &
new44' *
WfpictContext44+ 8
(448 9
)449 :
)44: ;
{55 
var66 
userManager66 
=66  !
new66" %
UserManager66& 1
<661 2
WfpUser662 9
>669 :
(66: ;
new66; >
	UserStore66? H
<66H I
WfpUser66I P
>66P Q
(66Q R
ctx66R U
)66U V
)66V W
;66W X
userManager77 
.77 

FindByName77 &
(77& '
$str77' .
)77. /
;77/ 0
}88 
}99 	
}:: 
};; 