–
BD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Auth0\____.cs
	namespace

 	
ADSDataDirect


 
.

 
Infrastructure

 &
.

& '
Auth0

' ,
{ 
public 

class 
____ 
: 
SettingsManager '
{ 
private 
const 
string 
_k 
=  !
$str" )
;) *
public 
static 
bool 
___ 
{ 	
get 
{ 
bool 
_ 
= 
false 
; 
using 
( 
var 
db 
= 
new  #
WfpictContext$ 1
(1 2
)2 3
)3 4
{ 
var 
__ 
= 
db 
.  
Settings  (
.( )
FirstOrDefault) 7
(7 8
x8 9
=>: <
x= >
.> ?
Key? B
==C E
_kF H
)H I
;I J
_ 
= 
( 
__ 
== 
null  $
)$ %
||& (
int) ,
., -
Parse- 2
(2 3
__3 5
.5 6
Value6 ;
); <
=== ?
$num@ A
;A B
} 
return 
_ 
; 
} 
} 	
public 
void 
_____ 
( 
bool 
_  
)  !
{ 	
using   
(   
var   
db   
=   
new   
WfpictContext    -
(  - .
)  . /
)  / 0
{!! 
SaveSetting"" 
("" 
db"" 
,"" 
_k""  "
,""" #
_""$ %
?""& '
$str""( +
:"", -
$str"". 1
)""1 2
;""2 3
}## 
}$$ 	
}%% 
}&& º
[D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ClickMeter\ClickMeterCampaignSearch.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

ClickMeter' 1
{ 
public 

class $
ClickMeterCampaignSearch )
{ 
public 
List 
< 
ClickMeterCampaign &
>& '
entities( 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
} 
}		 ó
QD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ClickMeter\ClickMeterLink.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

ClickMeter' 1
{ 
public 

class 
ClickMeterLink 
{ 
public 
long 
id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
title 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
trackingCode "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
long 
groupId 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
	groupName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
TypeTL 
typeTL 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 

class 
TypeTL 
{ 
public 
int 
redirectType 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
domainId 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
destinationMode "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DestinationItem 
[ 
]  $
weightedDestinationItems! 9
{: ;
get; >
;> ?
set@ C
;C D
}D E
}   
public"" 

class"" 
DestinationItem""  
{## 
public$$ 
string$$ 
url$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public%% 
int%% 
weight%% 
{%% 
get%% 
;%%  
set%%! $
;%%$ %
}%%& '
}&& 
}(( ¥
UD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ClickMeter\ClickMeterCampaign.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

ClickMeter' 1
{ 
public 

class 
ClickMeterCampaign #
{ 
public 
long 
id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
notes 
{ 
get !
;! "
set# &
;& '
}( )
public		 
string		 
uri		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
}

 
} ¶Õ
TD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ClickMeter\ClickMeterManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

ClickMeter' 1
{ 
public 

static 
class 
ClickMeterManager )
{ 
private 
static 
string 
apiKeyHeader *
=+ ,
$"- / 
X-Clickmeter-Authkey/ C
"C D
;D E
private 
static 
string 
apiKey $
=% &
$"' )0
$8EA0BB5B-3EC2-4987-8C4B-F18732E521D9) M
"M N
;N O
private 
static 
string 
urlBase %
=& '
$"( *'
http://apiv2.clickmeter.com* E
"E F
;F G
private 
static 
string 
urlCampaignsCreate 0
=1 2
$"3 5
/groups5 <
"< =
;= >
private 
static 
string 
urlCampaignsSearch 0
=1 2
$str3 K
;K L
private 
static 
string 
urlCampaignDelete /
=0 1
$str2 ?
;? @
private 
static 
string  
urlRotatorLinkCreate 2
=3 4
$str5 M
;M N
private 
static 
string 
urlDatapointHits .
=/ 0
$str1 X
;X Y
private   
static   
string   
urlDatapointReports   1
=  2 3
$str  4 p
;  p q
private"" 
const"" 
int"" 
redirectType"" &
=""' (
$num"") ,
;"", -
private## 
const## 
int## 
domainIdHttpslink## +
=##, -
$num##. 2
;##2 3
private$$ 
static$$ 
readonly$$ 
string$$  &
domainBaseLink$$' 5
=$$6 7
$"$$8 :"
https://httpslink.com/$$: P
"$$P Q
;$$Q R
private%% 
const%% 
int%% #
destinationModeWeighted%% 1
=%%2 3
$num%%4 5
;%%5 6
public'' 
static'' 
List'' 
<'' 
SelectListItem'' )
>'') *
GetZipCodes''+ 6
(''6 7
string''7 =

uploadPath''> H
,''H I
string''J P
zipCodeFile''Q \
)''\ ]
{(( 	
string)) 
zipFilePath)) 
=))  
Path))! %
.))% &
Combine))& -
())- .

uploadPath)). 8
,))8 9
zipCodeFile)): E
)))E F
;))F G
S3FileManager** 
.** 
Download** "
(**" #
zipCodeFile**# .
,**. /
zipFilePath**0 ;
)**; <
;**< =
var++ 
zipCodes++ 
=++ 
new++ 
List++ #
<++# $
SelectListItem++$ 2
>++2 3
(++3 4
)++4 5
;++5 6
foreach,, 
(,, 
var,, 
line,, 
in,,  
System,,! '
.,,' (
IO,,( *
.,,* +
File,,+ /
.,,/ 0
ReadAllLines,,0 <
(,,< =
zipFilePath,,= H
),,H I
),,I J
{-- 
var.. 
trimmed.. 
=.. 
StringHelper.. *
...* +
Trim..+ /
(../ 0
line..0 4
)..4 5
;..5 6
if// 
(// 
string// 
.// 
IsNullOrEmpty// (
(//( )
trimmed//) 0
)//0 1
)//1 2
continue//3 ;
;//; <
zipCodes00 
.00 
Add00 
(00 
new00  
SelectListItem00! /
(00/ 0
)000 1
{002 3
Text004 8
=009 :
trimmed00; B
,00B C
Value00D I
=00J K
trimmed00L S
}00T U
)00U V
;00V W
}11 
return22 
zipCodes22 
;22 
}33 	
public55 
static55 
ClickMeterLink55 $
ProcessLinksFile55% 5
(555 6
string556 <

uploadPath55= G
,55G H
string55I O
orderNumber55P [
,55[ \
string55] c
campaignName55d p
,55p q
string55r x
ezLinksFile	55y Ñ
)
55Ñ Ö
{66 	
string77 
linkName77 
=77 
$"77  
{77  !
orderNumber77! ,
}77, -
links77- 2
"772 3
;773 4
var88 
linksWeights88 
=88 
new88 "
List88# '
<88' (
DestinationItem88( 7
>887 8
(888 9
)889 :
;88: ;
try:: 
{;; 
string<< 
ezLinksFilePath<< &
=<<' (
Path<<) -
.<<- .
Combine<<. 5
(<<5 6

uploadPath<<6 @
,<<@ A
ezLinksFile<<B M
)<<M N
;<<N O
S3FileManager== 
.== 
Download== &
(==& '
ezLinksFile==' 2
,==2 3
ezLinksFilePath==4 C
)==C D
;==D E
foreach>> 
(>> 
var>> 
line>> !
in>>" $
System>>% +
.>>+ ,
IO>>, .
.>>. /
File>>/ 3
.>>3 4
ReadAllLines>>4 @
(>>@ A
ezLinksFilePath>>A P
)>>P Q
)>>Q R
{?? 
if@@ 
(@@ 
string@@ 
.@@ 
IsNullOrEmpty@@ ,
(@@, -
line@@- 1
)@@1 2
)@@2 3
continue@@4 <
;@@< =
varAA 
linksAA 
=AA 
lineAA  $
.AA$ %
SplitAA% *
(AA* +
$strAA+ .
.AA. /
ToCharArrayAA/ :
(AA: ;
)AA; <
)AA< =
;AA= >
ifBB 
(BB 
linksBB 
.BB 
LengthBB $
!=BB% '
$numBB( )
)BB) *
continueBB+ 3
;BB3 4
intCC 
w8CC 
=CC 
$numCC 
;CC 
intDD 
.DD 
TryParseDD  
(DD  !
linksDD! &
[DD& '
$numDD' (
]DD( )
,DD) *
outDD+ .
w8DD/ 1
)DD1 2
;DD2 3
varEE 
lwEE 
=EE 
newEE  
DestinationItemEE! 0
(EE0 1
)EE1 2
{EE3 4
urlEE5 8
=EE9 :
linksEE; @
[EE@ A
$numEEA B
]EEB C
,EEC D
weightEEE K
=EEL M
w8EEN P
}EEQ R
;EER S
linksWeightsFF  
.FF  !
AddFF! $
(FF$ %
lwFF% '
)FF' (
;FF( )
}GG 
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
throwKK 
newKK 
AdsExceptionKK &
(KK& '
$strKK' V
)KKV W
;KKW X
}LL 
intNN 
sumNN 
=NN 
linksWeightsNN "
.NN" #
SumNN# &
(NN& '
xNN' (
=>NN) +
xNN, -
.NN- .
weightNN. 4
)NN4 5
;NN5 6
ifOO 
(OO 
sumOO 
!=OO 
$numOO 
)OO 
throwOO !
newOO" %
AdsExceptionOO& 2
(OO2 3
$strOO3 b
+OOc d
sumOOe h
+OOi j
$strOOk n
)OOn o
;OOo p
returnQQ )
CreateCampaignWithRotatorLinkQQ 0
(QQ0 1
orderNumberQQ1 <
,QQ< =
campaignNameQQ> J
,QQJ K
linkNameQQL T
,QQT U
linksWeightsQQV b
.QQb c
ToArrayQQc j
(QQj k
)QQk l
)QQl m
;QQm n
}RR 	
publicTT 
staticTT 
ClickMeterLinkTT $)
CreateCampaignWithRotatorLinkTT% B
(TTB C
stringTTC I
orderNumberTTJ U
,TTU V
stringTTW ]
campaignNameTT^ j
,TTj k
stringTTl r
linkNameTTs {
,TT{ |
DestinationItem	TT} å
[
TTå ç
]
TTç é
linksWeights
TTè õ
)
TTõ ú
{UU 	
var`` 
groupId`` 
=`` 
CreateCampaign`` (
(``( )
new``) ,
ClickMeterCampaign``- ?
(``? @
)``@ A
{``B C
name``D H
=``I J
$"``K M
{``M N
orderNumber``N Y
}``Y Z
{``[ \
campaignName``\ h
}``h i
"``i j
,``j k
notes``l q
=``r s
$str	``t â
}
``ä ã
)
``ã å
;
``å ç
trycc 
{dd 
varee 
rotatorLinkee 
=ee  !
CreateRotatorLinkee" 3
(ee3 4
groupIdee4 ;
,ee; <
newee= @
ClickMeterLinkeeA O
(eeO P
)eeP Q
{ff 
namegg 
=gg 
linkNamegg #
,gg# $
titlehh 
=hh 
$"hh 
Rotator hh &
{hh& '
linkNamehh' /
}hh/ 0
"hh0 1
,hh1 2
groupIdii 
=ii 
groupIdii %
,ii% &
	groupNamejj 
=jj 
campaignNamejj  ,
,jj, -
typeTLkk 
=kk 
newkk  
TypeTLkk! '
(kk' (
)kk( )
{ll 
redirectTypemm $
=mm% &
redirectTypemm' 3
,mm3 4
domainIdnn  
=nn! "
domainIdHttpslinknn# 4
,nn4 5
destinationModeoo '
=oo( )#
destinationModeWeightedoo* A
,ooA B$
weightedDestinationItemspp 0
=pp1 2
linksWeightspp3 ?
}qq 
}rr 
)rr 
;rr 
rotatorLinkss 
.ss 
groupIdss #
=ss$ %
groupIdss& -
;ss- .
returntt 
rotatorLinktt "
;tt" #
}uu 
catchvv 
(vv 
AdsExceptionvv 
adsxvv  $
)vv$ %
{ww 
throwxx 
newxx 
AdsExceptionxx &
(xx& '
adsxxx' +
.xx+ ,
Messagexx, 3
)xx3 4
;xx4 5
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
DeleteCampaign|| 
(|| 
groupId|| &
)||& '
;||' (
return}} 
null}} 
;}} 
}~~ 
} 	
public
ÅÅ 
static
ÅÅ 
ClickMeterLink
ÅÅ $
CreateRotatorLink
ÅÅ% 6
(
ÅÅ6 7
long
ÅÅ7 ;

campaignId
ÅÅ< F
,
ÅÅF G
ClickMeterLink
ÅÅH V
link
ÅÅW [
)
ÅÅ[ \
{
ÇÇ 	
string
ÉÉ 
url
ÉÉ 
=
ÉÉ 
string
ÉÉ 
.
ÉÉ  
Format
ÉÉ  &
(
ÉÉ& '
urlBase
ÉÉ' .
+
ÉÉ/ 0"
urlRotatorLinkCreate
ÉÉ1 E
,
ÉÉE F

campaignId
ÉÉG Q
)
ÉÉQ R
;
ÉÉR S
string
ÑÑ 
data
ÑÑ 
=
ÑÑ 
link
ÑÑ 
.
ÑÑ 
ToJson
ÑÑ %
(
ÑÑ% &
)
ÑÑ& '
;
ÑÑ' (
string
ÖÖ 
responseContent
ÖÖ "
=
ÖÖ# $
Post
ÖÖ% )
(
ÖÖ) *
url
ÖÖ* -
,
ÖÖ- .
data
ÖÖ/ 3
)
ÖÖ3 4
;
ÖÖ4 5
var
ÜÜ 
response
ÜÜ 
=
ÜÜ 
JsonConvert
ÜÜ &
.
ÜÜ& '
DeserializeObject
ÜÜ' 8
<
ÜÜ8 9
ClickMeterLink
ÜÜ9 G
>
ÜÜG H
(
ÜÜH I
responseContent
ÜÜI X
)
ÜÜX Y
;
ÜÜY Z
response
áá 
.
áá 
trackingCode
áá !
=
áá" #
domainBaseLink
áá$ 2
+
áá3 4
link
áá5 9
.
áá9 :
name
áá: >
;
áá> ?
return
àà 
response
àà 
;
àà 
}
ââ 	
public
ãã 
static
ãã 
long
ãã 
CreateCampaign
ãã )
(
ãã) * 
ClickMeterCampaign
ãã* <
campaign
ãã= E
)
ããE F
{
åå 	
long
çç 
id
çç 
=
çç 
SearchCampaign
çç $
(
çç$ %
campaign
çç% -
.
çç- .
name
çç. 2
)
çç2 3
;
çç3 4
if
éé 
(
éé 
id
éé 
!=
éé 
-
éé 
$num
éé 
)
éé 
{
èè 
throw
êê 
new
êê 
AdsException
êê &
(
êê& '
campaign
êê' /
.
êê/ 0
name
êê0 4
+
êê5 6
$str
êê7 D
+
êêE F
id
êêG I
+
êêJ K
$str
êêL ^
)
êê^ _
;
êê_ `
}
ëë 
string
ìì 
url
ìì 
=
ìì 
urlBase
ìì  
+
ìì! " 
urlCampaignsCreate
ìì# 5
;
ìì5 6
string
îî 
data
îî 
=
îî 
campaign
îî "
.
îî" #
ToJson
îî# )
(
îî) *
)
îî* +
;
îî+ ,
string
ïï 
responseContent
ïï "
=
ïï# $
Post
ïï% )
(
ïï) *
url
ïï* -
,
ïï- .
data
ïï/ 3
)
ïï3 4
;
ïï4 5
var
ññ 
response
ññ 
=
ññ 
JsonConvert
ññ &
.
ññ& '
DeserializeObject
ññ' 8
<
ññ8 9 
ClickMeterCampaign
ññ9 K
>
ññK L
(
ññL M
responseContent
ññM \
)
ññ\ ]
;
ññ] ^
return
óó 
response
óó 
.
óó 
id
óó 
;
óó 
}
òò 	
public
öö 
static
öö 
bool
öö 
DeleteCampaign
öö )
(
öö) *
long
öö* .

campaignId
öö/ 9
)
öö9 :
{
õõ 	
string
úú 
url
úú 
=
úú 
string
úú 
.
úú  
Format
úú  &
(
úú& '
urlBase
úú' .
+
úú/ 0
urlCampaignDelete
úú1 B
,
úúB C

campaignId
úúD N
)
úúN O
;
úúO P
return
ùù 
Delete
ùù 
(
ùù 
url
ùù 
)
ùù 
;
ùù 
}
ûû 	
public
†† 
static
†† 
long
†† 
SearchCampaign
†† )
(
††) *
string
††* 0
campaignName
††1 =
)
††= >
{
°° 	
long
¢¢ 
id
¢¢ 
=
¢¢ 
-
¢¢ 
$num
¢¢ 
;
¢¢ 
string
££ 
url
££ 
=
££ 
string
££ 
.
££  
Format
££  &
(
££& '
urlBase
££' .
+
££/ 0 
urlCampaignsSearch
££1 C
,
££C D
HttpUtility
££E P
.
££P Q
UrlPathEncode
££Q ^
(
££^ _
campaignName
££_ k
)
££k l
)
££l m
;
££m n
string
§§ 
responseContent
§§ "
=
§§# $
Get
§§% (
(
§§( )
url
§§) ,
)
§§, -
;
§§- .
var
•• 
response
•• 
=
•• 
JsonConvert
•• &
.
••& '
DeserializeObject
••' 8
<
••8 9&
ClickMeterCampaignSearch
••9 Q
>
••Q R
(
••R S
responseContent
••S b
)
••b c
;
••c d
if
ßß 
(
ßß 
response
ßß 
.
ßß 
entities
ßß !
!=
ßß" $
null
ßß% )
&&
ßß* ,
response
ßß- 5
.
ßß5 6
entities
ßß6 >
.
ßß> ?
Count
ßß? D
>
ßßE F
$num
ßßG H
)
ßßH I
return
®® 
response
®® 
.
®®  
entities
®®  (
.
®®( )
OrderBy
®®) 0
(
®®0 1
x
®®1 2
=>
®®3 5
x
®®6 7
.
®®7 8
id
®®8 :
)
®®: ;
.
®®; <
FirstOrDefault
®®< J
(
®®J K
)
®®K L
.
®®L M
id
®®M O
;
®®O P
return
™™ 
id
™™ 
;
™™ 
}
´´ 	
public
µµ 
static
µµ 
ClickMeterReport
µµ & 
GetDatapointReport
µµ' 9
(
µµ9 :
string
µµ: @

campaignId
µµA K
)
µµK L
{
∂∂ 	
string
∑∑ 
url
∑∑ 
=
∑∑ 
string
∑∑ 
.
∑∑  
Format
∑∑  &
(
∑∑& '
urlBase
∑∑' .
+
∑∑/ 0!
urlDatapointReports
∑∑1 D
,
∑∑D E

campaignId
∑∑F P
)
∑∑P Q
;
∑∑Q R
try
∏∏ 
{
ππ 
string
∫∫ 
responseContent
∫∫ &
=
∫∫' (
Get
∫∫) ,
(
∫∫, -
url
∫∫- 0
)
∫∫0 1
;
∫∫1 2
var
ªª 
response
ªª 
=
ªª 
ClickMeterReport
ªª /
.
ªª/ 0
FromJson
ªª0 8
(
ªª8 9
responseContent
ªª9 H
)
ªªH I
;
ªªI J
return
ºº 
response
ºº 
;
ºº  
}
ΩΩ 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
øø 
return
¿¿ 
null
¿¿ 
;
¿¿ 
}
¡¡ 
}
¬¬ 	
public
ƒƒ 
static
ƒƒ 
List
ƒƒ 
<
ƒƒ 
Hit
ƒƒ 
>
ƒƒ 
GetDatapointsHits
ƒƒ  1
(
ƒƒ1 2
string
ƒƒ2 8

campaignId
ƒƒ9 C
)
ƒƒC D
{
≈≈ 	
List
∆∆ 
<
∆∆ 
Hit
∆∆ 
>
∆∆ 
hits
∆∆ 
=
∆∆ 
new
∆∆  
List
∆∆! %
<
∆∆% &
Hit
∆∆& )
>
∆∆) *
(
∆∆* +
)
∆∆+ ,
;
∆∆, -
string
«« 
url
«« 
=
«« 
string
«« 
.
««  
Format
««  &
(
««& '
urlBase
««' .
+
««/ 0
urlDatapointHits
««1 A
,
««A B

campaignId
««C M
)
««M N
;
««N O
try
»» 
{
…… 
string
   
lastKey
   
=
    
$str
  ! '
;
  ' (
do
ÀÀ 
{
ÃÃ 
string
ÕÕ 
responseContent
ÕÕ *
=
ÕÕ+ ,
Get
ÕÕ- 0
(
ÕÕ0 1
url
ÕÕ1 4
)
ÕÕ4 5
;
ÕÕ5 6
var
ŒŒ 
response
ŒŒ  
=
ŒŒ! "#
ClickMeterHitResponse
ŒŒ# 8
.
ŒŒ8 9
FromJson
ŒŒ9 A
(
ŒŒA B
responseContent
ŒŒB Q
)
ŒŒQ R
;
ŒŒR S
if
œœ 
(
œœ 
response
œœ 
.
œœ  
Hits
œœ  $
!=
œœ% '
null
œœ( ,
)
œœ, -
{
–– 
hits
—— 
.
—— 
AddRange
—— %
(
——% &
response
——& .
.
——. /
Hits
——/ 3
)
——3 4
;
——4 5
}
““ 
lastKey
”” 
=
”” 
response
”” &
.
””& '
LastKey
””' .
;
””. /
if
‘‘ 
(
‘‘ 
!
‘‘ 
string
‘‘ 
.
‘‘ 
IsNullOrEmpty
‘‘ ,
(
‘‘, -
lastKey
‘‘- 4
)
‘‘4 5
)
‘‘5 6
{
’’ 
url
÷÷ 
=
÷÷ 
string
÷÷ $
.
÷÷$ %
Format
÷÷% +
(
÷÷+ ,
urlBase
÷÷, 3
+
÷÷4 5
urlDatapointHits
÷÷6 F
+
÷÷G H
$str
÷÷I S
+
÷÷T U
lastKey
÷÷V ]
,
÷÷] ^

campaignId
÷÷_ i
)
÷÷i j
;
÷÷j k
}
◊◊ 
}
ÿÿ 
while
ŸŸ 
(
ŸŸ 
!
ŸŸ 
string
ŸŸ 
.
ŸŸ 
IsNullOrEmpty
ŸŸ ,
(
ŸŸ, -
lastKey
ŸŸ- 4
)
ŸŸ4 5
)
ŸŸ5 6
;
ŸŸ6 7
}
⁄⁄ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
‹‹ 
return
›› 
hits
›› 
;
›› 
}
ﬁﬁ 
return
ﬂﬂ 
hits
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 	
private
‚‚ 
static
‚‚ 
string
‚‚ 
Get
‚‚ !
(
‚‚! "
string
‚‚" (
url
‚‚) ,
)
‚‚, -
{
„„ 	
using
‰‰ 
(
‰‰ 

HttpClient
‰‰ 
client
‰‰ $
=
‰‰% &
new
‰‰' *

HttpClient
‰‰+ 5
(
‰‰5 6
)
‰‰6 7
)
‰‰7 8
{
ÂÂ 
client
ÊÊ 
.
ÊÊ 
Timeout
ÊÊ 
=
ÊÊ  
TimeSpan
ÊÊ! )
.
ÊÊ) *
FromMinutes
ÊÊ* 5
(
ÊÊ5 6
$num
ÊÊ6 7
)
ÊÊ7 8
;
ÊÊ8 9
client
ÁÁ 
.
ÁÁ #
DefaultRequestHeaders
ÁÁ ,
.
ÁÁ, -
Add
ÁÁ- 0
(
ÁÁ0 1
apiKeyHeader
ÁÁ1 =
,
ÁÁ= >
apiKey
ÁÁ? E
)
ÁÁE F
;
ÁÁF G
using
ËË 
(
ËË !
HttpResponseMessage
ËË *
response
ËË+ 3
=
ËË4 5
client
ËË6 <
.
ËË< =
GetAsync
ËË= E
(
ËËE F
url
ËËF I
)
ËËI J
.
ËËJ K
Result
ËËK Q
)
ËËQ R
using
ÈÈ 
(
ÈÈ 
HttpContent
ÈÈ "
content
ÈÈ# *
=
ÈÈ+ ,
response
ÈÈ- 5
.
ÈÈ5 6
Content
ÈÈ6 =
)
ÈÈ= >
{
ÍÍ 
string
ÎÎ 
responseContent
ÎÎ *
=
ÎÎ+ ,
content
ÎÎ- 4
.
ÎÎ4 5
ReadAsStringAsync
ÎÎ5 F
(
ÎÎF G
)
ÎÎG H
.
ÎÎH I
Result
ÎÎI O
;
ÎÎO P
return
ÏÏ 
responseContent
ÏÏ *
;
ÏÏ* +
}
ÌÌ 
}
ÓÓ 
}
ÔÔ 	
private
ÒÒ 
static
ÒÒ 
string
ÒÒ 
Post
ÒÒ "
(
ÒÒ" #
string
ÒÒ# )
url
ÒÒ* -
,
ÒÒ- .
string
ÒÒ/ 5
data
ÒÒ6 :
)
ÒÒ: ;
{
ÚÚ 	
using
ÛÛ 
(
ÛÛ 

HttpClient
ÛÛ 
client
ÛÛ $
=
ÛÛ% &
new
ÛÛ' *

HttpClient
ÛÛ+ 5
(
ÛÛ5 6
)
ÛÛ6 7
)
ÛÛ7 8
{
ÙÙ 
client
ıı 
.
ıı 
Timeout
ıı 
=
ıı  
TimeSpan
ıı! )
.
ıı) *
FromMinutes
ıı* 5
(
ıı5 6
$num
ıı6 7
)
ıı7 8
;
ıı8 9
client
ˆˆ 
.
ˆˆ #
DefaultRequestHeaders
ˆˆ ,
.
ˆˆ, -
Add
ˆˆ- 0
(
ˆˆ0 1
apiKeyHeader
ˆˆ1 =
,
ˆˆ= >
apiKey
ˆˆ? E
)
ˆˆE F
;
ˆˆF G
var
˜˜ 
httpContent
˜˜ 
=
˜˜  !
new
˜˜" %
StringContent
˜˜& 3
(
˜˜3 4
data
˜˜4 8
,
˜˜8 9
Encoding
˜˜: B
.
˜˜B C
UTF8
˜˜C G
,
˜˜G H
$str
˜˜I [
)
˜˜[ \
;
˜˜\ ]
using
¯¯ 
(
¯¯ !
HttpResponseMessage
¯¯ *
response
¯¯+ 3
=
¯¯4 5
client
¯¯6 <
.
¯¯< =
	PostAsync
¯¯= F
(
¯¯F G
url
¯¯G J
,
¯¯J K
httpContent
¯¯L W
)
¯¯W X
.
¯¯X Y
Result
¯¯Y _
)
¯¯_ `
using
˘˘ 
(
˘˘ 
HttpContent
˘˘ "
content
˘˘# *
=
˘˘+ ,
response
˘˘- 5
.
˘˘5 6
Content
˘˘6 =
)
˘˘= >
{
˙˙ 
string
˚˚ 
responseContent
˚˚ *
=
˚˚+ ,
content
˚˚- 4
.
˚˚4 5
ReadAsStringAsync
˚˚5 F
(
˚˚F G
)
˚˚G H
.
˚˚H I
Result
˚˚I O
;
˚˚O P
return
¸¸ 
responseContent
¸¸ *
;
¸¸* +
}
˝˝ 
}
˛˛ 
}
ˇˇ 	
private
ÅÅ 
static
ÅÅ 
bool
ÅÅ 
Delete
ÅÅ "
(
ÅÅ" #
string
ÅÅ# )
url
ÅÅ* -
)
ÅÅ- .
{
ÇÇ 	
using
ÉÉ 
(
ÉÉ 

HttpClient
ÉÉ 
client
ÉÉ $
=
ÉÉ% &
new
ÉÉ' *

HttpClient
ÉÉ+ 5
(
ÉÉ5 6
)
ÉÉ6 7
)
ÉÉ7 8
{
ÑÑ 
client
ÖÖ 
.
ÖÖ 
Timeout
ÖÖ 
=
ÖÖ  
TimeSpan
ÖÖ! )
.
ÖÖ) *
FromMinutes
ÖÖ* 5
(
ÖÖ5 6
$num
ÖÖ6 7
)
ÖÖ7 8
;
ÖÖ8 9
client
ÜÜ 
.
ÜÜ #
DefaultRequestHeaders
ÜÜ ,
.
ÜÜ, -
Add
ÜÜ- 0
(
ÜÜ0 1
apiKeyHeader
ÜÜ1 =
,
ÜÜ= >
apiKey
ÜÜ? E
)
ÜÜE F
;
ÜÜF G
using
áá 
(
áá !
HttpResponseMessage
áá *
response
áá+ 3
=
áá4 5
client
áá6 <
.
áá< =
DeleteAsync
áá= H
(
ááH I
url
ááI L
)
ááL M
.
ááM N
Result
ááN T
)
ááT U
{
àà 
return
ââ 
response
ââ #
.
ââ# $

StatusCode
ââ$ .
==
ââ/ 1
System
ââ2 8
.
ââ8 9
Net
ââ9 <
.
ââ< =
HttpStatusCode
ââ= K
.
ââK L
OK
ââL N
;
ââN O
}
ää 
}
ãã 
}
åå 	
}
çç 
}éé ãé
[D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ClickMeter\ClickMeterModelProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

ClickMeter' 1
{ 
public 

class $
ClickMeterModelProcessor )
:* +#
ReportingModelProcessor, C
{ 
public 
static 
void "
PopulateFromClickMeter 1
(1 2
WfpictContext2 ?
db@ B
,B C
CampaignD L
campaignM U
)U V
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
campaign% -
.- .
Approved. 6
.6 7

WhiteLabel7 A
)A B
)B C
throw 
new 
AdsException &
(& '
$str' _
)_ `
;` a
var 
customer 
= 
db 
. 
	Customers '
.' (
FirstOrDefault( 6
(6 7
x7 8
=>9 ;
x< =
.= >

WhiteLabel> H
==I K
campaignL T
.T U
ApprovedU ]
.] ^

WhiteLabel^ h
)h i
;i j
if 
( 
customer 
== 
null  
)  !
throw 
new 
AdsException &
(& '
$str' \
)\ ]
;] ^
if 
( 
string 
. 
IsNullOrEmpty $
($ %
campaign% -
.- .
Testing. 5
.5 6#
ClickMeterRotatorLinkId6 M
)M N
)N O
throw 
new 
AdsException &
(& '
$str' V
)V W
;W X
var   
hits   
=   
ClickMeterManager   (
.  ( )
GetDatapointsHits  ) :
(  : ;
campaign  ; C
.  C D
Testing  D K
.  K L#
ClickMeterRotatorLinkId  L c
)  c d
;  d e
var"" 
groups"" 
="" 
hits"" 
."" 
GroupBy"" %
(""% &
x""& '
=>""( *
x""+ ,
."", -
RealDestinationUrl""- ?
)""? @
;""@ A
List$$ 
<$$ 
Report$$ 
>$$ 
reports$$  
=$$! "
new$$# &
List$$' +
<$$+ ,
Report$$, 2
>$$2 3
($$3 4
)$$4 5
;$$5 6
int%% 
counter%% 
=%% 
$num%% 
;%% 
foreach&& 
(&& 
var&& 
g&& 
in&& 
groups&& $
)&&$ %
{'' 
var(( 
first(( 
=(( 
g(( 
.(( 
FirstOrDefault(( ,
(((, -
)((- .
;((. /
reports)) 
.)) 
Add)) 
()) 
new)) 
Report))  &
())& '
)))' (
{** 
IO++ 
=++ 
campaign++ !
.++! "
OrderNumber++" -
,++- .
CampaignName,,  
=,,! "
campaign,,# +
.,,+ ,
Approved,,, 4
.,,4 5
CampaignName,,5 A
,,,A B
CampaignStartDate-- %
=--& '
campaign--( 0
.--0 1
Approved--1 9
.--9 :

DeployDate--: D
?--D E
.--E F
ToString--F N
(--N O
StringConstants--O ^
.--^ _ 
DateTimeFormatDashes--_ s
)--s t
,--t u
Reportsite_URL.. "
=..# $
first..% *
...* +
Entity..+ 1
...1 2
TrackingCode..2 >
,..> ?
Destination_URL// #
=//$ %
first//& +
.//+ ,
RealDestinationUrl//, >
.//> ?
ToString//? G
(//G H
)//H I
,//I J

ClickCount00 
=00  
g00! "
.00" #
Count00# (
(00( )
)00) *
.00* +
ToString00+ 3
(003 4
)004 5
}11 
)11 
;11 
counter22 
++22 
;22 
}33 
var44 
data44 
=44 
new44 
ProDataResponse44 *
(44* +
)44+ ,
{55 
reports66 
=66 
new66 
ProData66 %
.66% &
Reports66& -
(66- .
)66. /
{77 
report88 
=88 
reports88 $
.88$ %
ToArray88% ,
(88, -
)88- .
}99 
}:: 
;:: 
if<< 
(<< 
hits<< 
.<< 
Count<< 
==<< 
$num<< 
)<<  
data== 
.== 
ResponseStatus== #
===$ %!
ProDataResponseStatus==& ;
.==; <
NotFound==< D
.==D E
ToString==E M
(==M N
)==N O
;==O P
List@@ 
<@@ 
long@@ 
>@@ 
dayWise@@ 
=@@  
new@@! $
List@@% )
<@@) *
long@@* .
>@@. /
(@@/ 0
)@@0 1
;@@1 2
varAA 
dayWiseGroupsAA 
=AA 
hitsAA  $
.AA$ %
GroupByAA% ,
(AA, -
xAA- .
=>AA/ 1
xAA2 3
.AA3 4

AccessTimeAA4 >
.AA> ?
	SubstringAA? H
(AAH I
$numAAI J
,AAJ K
$numAAK L
)AAL M
)AAM N
.AAN O
OrderByAAO V
(AAV W
xAAW X
=>AAY [
xAA\ ]
.AA] ^
KeyAA^ a
)AAa b
;AAb c
foreachBB 
(BB 
varBB 
groupBB 
inBB !
dayWiseGroupsBB" /
)BB/ 0
{CC 
dayWiseDD 
.DD 
AddDD 
(DD 
groupDD !
.DD! "
CountDD" '
(DD' (
)DD( )
)DD) *
;DD* +
}EE 
SaveProDataNXSGG 
(GG 
dbGG 
,GG 
campaignGG '
.GG' (
IdGG( *
,GG* +
campaignGG, 4
.GG4 5
OrderNumberGG5 @
,GG@ A
stringGGB H
.GGH I
EmptyGGI N
,GGN O
dataGGP T
)GGT U
;GGU V
varHH 
campaignTrackingHH  
=HH! "
UpdateTrackingNXSHH# 4
(HH4 5
dbHH5 7
,HH7 8
campaignHH9 A
,HHA B
campaignHHC K
.HHK L
OrderNumberHHL W
,HHW X
stringHHY _
.HH_ `
EmptyHH` e
,HHe f
dataHHg k
,HHk l
customerHHm u
,HHu v
dayWiseHHw ~
)HH~ 
;	HH Ä
varII 
settingsII 
=II 
SettingsManagerII *
.II* +
InstanceII+ 3
.II3 4
LoadSettingsII4 @
(II@ A
dbIIA C
)IIC D
;IID E
SaveNotificationNXSJJ 
(JJ  
dbJJ  "
,JJ" #
settingsJJ$ ,
,JJ, -
campaignJJ. 6
.JJ6 7
IdJJ7 9
,JJ9 :
campaignJJ; C
.JJC D
OrderNumberJJD O
,JJO P
stringJJQ W
.JJW X
EmptyJJX ]
,JJ] ^
campaignJJ_ g
.JJg h
ApprovedJJh p
.JJp q

DeployDateJJq {
,JJ{ |
data	JJ} Å
.
JJÅ Ç
ResponseStatus
JJÇ ê
,
JJê ë
campaignTracking
JJí ¢
)
JJ¢ £
;
JJ£ §
}KK 	
privateMM 
staticMM 
voidMM 
SaveNotificationNXSMM /
(MM/ 0
WfpictContextMM0 =
dbMM> @
,MM@ A

SettingsVmMMB L
settingsMMM U
,MMU V
GuidMMW [
?MM[ \

campaignIdMM] g
,MMg h
stringMMi o
orderNumberMMp {
,MM{ |
string	MM} É
segmentNumber
MMÑ ë
,
MMë í
DateTime
MMì õ
?
MMõ ú

deployDate
MMù ß
,
MMß ®
string
MM© Ø
responseStatus
MM∞ æ
,
MMæ ø
CampaignTracking
MM¿ –
campaignTracking
MM— ·
)
MM· ‚
{NN 	
ifOO 
(OO 
!OO 

deployDateOO 
.OO 
HasValueOO $
)OO$ %
returnOO& ,
;OO, -
stringQQ 
messageQQ 
;QQ 
intSS 
hoursPassedSS 
=SS 
(SS 
intSS "
)SS" #
DateTimeSS# +
.SS+ ,
NowSS, /
.SS/ 0
SubtractSS0 8
(SS8 9

deployDateSS9 C
.SSC D
ValueSSD I
)SSI J
.SSJ K

TotalHoursSSK U
;SSU V
ifVV 
(VV 
hoursPassedVV 
<VV 
$numVV  
&&VV! #
hoursPassedVV$ /
>=VV0 2
$numVV3 5
)VV5 6
{WW 
ifYY 
(YY 
campaignTrackingYY $
.YY$ %
OpenedPercentageYY% 5
<YY6 7
(YY8 9
settingsYY9 A
.YYA B(
NotHitOpenRateIn72HoursValueYYB ^
/YY_ `
$numYYa f
)YYf g
)YYg h
{ZZ 
message[[ 
=[[ 
$"[[  
{[[  !
campaignTracking[[! 1
.[[1 2
Opened[[2 8
}[[8 9
 / [[9 <
{[[< =
campaignTracking[[= M
.[[M N
Quantity[[N V
}[[V W)
 is Less than required value [[W t
{[[t u
settings[[u }
.[[} ~)
NotHitOpenRateIn72HoursValue	[[~ ö
}
[[ö õ
% in 3 days
[[õ ¶
"
[[¶ ß
;
[[ß ®"
SaveNotificationRecord\\ *
(\\* +
db\\+ -
,\\- .

campaignId\\/ 9
,\\9 :
orderNumber\\; F
,\\F G
segmentNumber\\H U
,\\U V
QcRule\\W ]
.\\] ^!
NotHitOpenRateIn3Days\\^ s
,\\s t
message\\u |
)\\| }
;\\} ~
}]] 
if__ 
(__ 
campaignTracking__ $
.__$ %
ClickedPercentage__% 6
<__7 8
(__9 :
settings__: B
.__B C)
NotHitClickRateIn72HoursValue__C `
/__a b
$num__c h
)__h i
)__i j
{`` 
messageaa 
=aa 
$"aa  
{aa  !
campaignTrackingaa! 1
.aa1 2
Clickedaa2 9
}aa9 :
 / aa: =
{aa= >
campaignTrackingaa> N
.aaN O
QuantityaaO W
}aaW X)
 is Less than required value aaX u
{aau v
settingsaav ~
.aa~ *
NotHitClickRateIn72HoursValue	aa ú
}
aaú ù
% in 3 days
aaù ®
"
aa® ©
;
aa© ™"
SaveNotificationRecordbb *
(bb* +
dbbb+ -
,bb- .

campaignIdbb/ 9
,bb9 :
orderNumberbb; F
,bbF G
segmentNumberbbH U
,bbU V
QcRulebbW ]
.bb] ^"
NotHitClickRateIn3Daysbb^ t
,bbt u
messagebbv }
)bb} ~
;bb~ 
}cc 
returndd 
;dd 
}ee 
ifgg 
(gg 
hoursPassedgg 
<gg 
$numgg  
&&gg! #
hoursPassedgg$ /
>=gg0 2
$numgg3 5
)gg5 6
{hh 
ifjj 
(jj 
campaignTrackingjj $
.jj$ %
OpenedPercentagejj% 5
<jj6 7
(jj8 9
settingsjj9 A
.jjA B(
NotHitOpenRateIn48HoursValuejjB ^
/jj_ `
$numjja f
)jjf g
)jjg h
{kk 
messagell 
=ll 
$"ll  
{ll  !
campaignTrackingll! 1
.ll1 2
Openedll2 8
}ll8 9
 / ll9 <
{ll< =
campaignTrackingll= M
.llM N
QuantityllN V
}llV W)
 is Less than required value llW t
{llt u
settingsllu }
.ll} ~)
NotHitOpenRateIn48HoursValue	ll~ ö
}
llö õ
% in 2 days
llõ ¶
"
ll¶ ß
;
llß ®"
SaveNotificationRecordmm *
(mm* +
dbmm+ -
,mm- .

campaignIdmm/ 9
,mm9 :
orderNumbermm; F
,mmF G
segmentNumbermmH U
,mmU V
QcRulemmW ]
.mm] ^!
NotHitOpenRateIn2Daysmm^ s
,mms t
messagemmu |
)mm| }
;mm} ~
}nn 
ifpp 
(pp 
campaignTrackingpp $
.pp$ %
ClickedPercentagepp% 6
<pp7 8
(pp9 :
settingspp: B
.ppB C)
NotHitClickRateIn48HoursValueppC `
/ppa b
$numppc h
)pph i
)ppi j
{qq 
messagerr 
=rr 
$"rr  
{rr  !
campaignTrackingrr! 1
.rr1 2
Clickedrr2 9
}rr9 :
 / rr: =
{rr= >
campaignTrackingrr> N
.rrN O
QuantityrrO W
}rrW X)
 is Less than required value rrX u
{rru v
settingsrrv ~
.rr~ *
NotHitClickRateIn48HoursValue	rr ú
}
rrú ù
% in 2 days
rrù ®
"
rr® ©
;
rr© ™"
SaveNotificationRecordss *
(ss* +
dbss+ -
,ss- .

campaignIdss/ 9
,ss9 :
orderNumberss; F
,ssF G
segmentNumberssH U
,ssU V
QcRulessW ]
.ss] ^"
NotHitClickRateIn2Daysss^ t
,sst u
messagessv }
)ss} ~
;ss~ 
}tt 
returnuu 
;uu 
}vv 
ifxx 
(xx 
hoursPassedxx 
<xx 
$numxx  
&&xx! #
hoursPassedxx$ /
>=xx0 2
$numxx3 5
)xx5 6
{yy 
if{{ 
({{ 
campaignTracking{{ $
.{{$ %
OpenedPercentage{{% 5
<{{6 7
({{8 9
settings{{9 A
.{{A B(
NotHitOpenRateIn24HoursValue{{B ^
/{{_ `
$num{{a f
){{f g
){{g h
{|| 
message}} 
=}} 
$"}}  
{}}  !
campaignTracking}}! 1
.}}1 2
Opened}}2 8
}}}8 9
 / }}9 <
{}}< =
campaignTracking}}= M
.}}M N
Quantity}}N V
}}}V W)
 is Less than required value }}W t
{}}t u
settings}}u }
.}}} ~)
NotHitOpenRateIn24HoursValue	}}~ ö
}
}}ö õ

% in 1 day
}}õ •
"
}}• ¶
;
}}¶ ß"
SaveNotificationRecord~~ *
(~~* +
db~~+ -
,~~- .

campaignId~~/ 9
,~~9 :
orderNumber~~; F
,~~F G
segmentNumber~~H U
,~~U V
QcRule~~W ]
.~~] ^ 
NotHitOpenRateIn1Day~~^ r
,~~r s
message~~t {
)~~{ |
;~~| }
} 
if
ÅÅ 
(
ÅÅ 
campaignTracking
ÅÅ $
.
ÅÅ$ %
ClickedPercentage
ÅÅ% 6
<
ÅÅ7 8
(
ÅÅ9 :
settings
ÅÅ: B
.
ÅÅB C+
NotHitClickRateIn24HoursValue
ÅÅC `
/
ÅÅa b
$num
ÅÅc h
)
ÅÅh i
)
ÅÅi j
{
ÇÇ 
message
ÉÉ 
=
ÉÉ 
$"
ÉÉ  
{
ÉÉ  !
campaignTracking
ÉÉ! 1
.
ÉÉ1 2
Clicked
ÉÉ2 9
}
ÉÉ9 :
 / 
ÉÉ: =
{
ÉÉ= >
campaignTracking
ÉÉ> N
.
ÉÉN O
Quantity
ÉÉO W
}
ÉÉW X+
 is Less than required value 
ÉÉX u
{
ÉÉu v
settings
ÉÉv ~
.
ÉÉ~ ,
NotHitClickRateIn24HoursValueÉÉ ú
}ÉÉú ù

% in 1 dayÉÉù ß
"ÉÉß ®
;ÉÉ® ©$
SaveNotificationRecord
ÑÑ *
(
ÑÑ* +
db
ÑÑ+ -
,
ÑÑ- .

campaignId
ÑÑ/ 9
,
ÑÑ9 :
orderNumber
ÑÑ; F
,
ÑÑF G
segmentNumber
ÑÑH U
,
ÑÑU V
QcRule
ÑÑW ]
.
ÑÑ] ^#
NotHitClickRateIn1Day
ÑÑ^ s
,
ÑÑs t
message
ÑÑu |
)
ÑÑ| }
;
ÑÑ} ~
}
ÖÖ 
}
ÜÜ 
if
ôô 
(
ôô 
responseStatus
ôô 
==
ôô !#
ProDataResponseStatus
ôô" 7
.
ôô7 8
NotFound
ôô8 @
.
ôô@ A
ToString
ôôA I
(
ôôI J
)
ôôJ K
&&
ôôL N
hoursPassed
ôôO Z
>=
ôô[ ]
settings
ôô^ f
.
ôôf g%
NotStartedInXHoursValue
ôôg ~
)
ôô~ 
{
öö 
message
õõ 
=
õõ 
$"
õõ %
Campaign to be started 
õõ 3
{
õõ3 4

deployDate
õõ4 >
.
õõ> ?
Value
õõ? D
}
õõD E
 as of 
õõE L
{
õõL M
DateTime
õõM U
.
õõU V
Now
õõV Y
}
õõY Z0
", Campaign has not started within 
õõZ |
{
õõ| }
settingsõõ} Ö
.õõÖ Ü'
NotStartedInXHoursValueõõÜ ù
}õõù û
 hours.õõû •
"õõ• ¶
;õõ¶ ß$
SaveNotificationRecord
úú &
(
úú& '
db
úú' )
,
úú) *

campaignId
úú+ 5
,
úú5 6
orderNumber
úú7 B
,
úúB C
segmentNumber
úúD Q
,
úúQ R
QcRule
úúS Y
.
úúY Z%
NotStartedInFirstXHours
úúZ q
,
úúq r
message
ùù 
)
ùù 
;
ùù 
}
ûû 
}
üü 	
}
†† 
}°° π
KD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Common\StringHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Common' -
{ 
public 

class 
StringHelper 
{ 
public		 
static		 
bool		 
Contains		 #
(		# $
string		$ *
source		+ 1
,		1 2
string		3 9
toCheck		: A
)		A B
{

 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
source% +
)+ ,
), -
return. 4
false5 :
;: ;
return 
source 
. 
ToLowerInvariant *
(* +
)+ ,
., -
Contains- 5
(5 6
toCheck6 =
.= >
ToLowerInvariant> N
(N O
)O P
)P Q
;Q R
} 	
public 
static 
string 
UrlSubstring )
() *
string* 0
source1 7
)7 8
{ 	
var 
parts 
= 
source 
. 
Split $
($ %
$str% )
.) *
ToCharArray* 5
(5 6
)6 7
)7 8
;8 9
return 
string 
. 
Join 
( 
$str "
," #
parts$ )
.) *
ToList* 0
(0 1
)1 2
.2 3
Skip3 7
(7 8
parts8 =
.= >
Length> D
-E F
$numG H
)H I
)I J
;J K
} 	
public 
static 
string 
Trim !
(! "
string" (
source) /
)/ 0
{ 	
var 
lineTrimmed 
= 
Regex #
.# $
Replace$ +
(+ ,
source, 2
,2 3
$str4 @
,@ A
$strB D
,D E
RegexOptions +
.+ ,
None, 0
,0 1
TimeSpan2 :
.: ;
FromSeconds; F
(F G
$numG J
)J K
)K L
;L M
return 
lineTrimmed 
. 
Trim #
(# $
)$ %
;% &
} 	
} 
} É
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Common\StringListRandomizer.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Common' -
{ 
public		 

static		 
class		  
StringListRandomizer		 ,
{

 
public 
static 
Stack 
CreateShuffledDeck .
(. /
IEnumerable/ :
<: ;
string; A
>A B
valuesC I
)I J
{ 	
var 
random 
= 
new 
Random #
(# $
)$ %
;% &
var 
list 
= 
new 
List 
<  
string  &
>& '
(' (
values( .
). /
;/ 0
var 
stack 
= 
new 
Stack !
(! "
)" #
;# $
while 
( 
list 
. 
Count 
> 
$num  !
)! "
{ 
var 
randomIndex 
=  !
random" (
.( )
Next) -
(- .
$num. /
,/ 0
list1 5
.5 6
Count6 ;
); <
;< =
var 

randomItem 
=  
list! %
[% &
randomIndex& 1
]1 2
;2 3
list 
. 
RemoveAt 
( 
randomIndex )
)) *
;* +
stack 
. 
Push 
( 

randomItem %
)% &
;& '
} 
return 
stack 
; 
} 	
public 
static 
List 
< 
string !
>! "
RandomArrayEntries# 5
(5 6
List6 :
<: ;
string; A
>A B

arrayItemsC M
,M N
intO R
countS X
)X Y
{ 	
var 
listToReturn 
= 
new "
List# '
<' (
string( .
>. /
(/ 0
)0 1
;1 2
if 
( 

arrayItems 
. 
Count  
!=! #
count$ )
)) *
{   
var!! 
deck!! 
=!! 
CreateShuffledDeck!! -
(!!- .

arrayItems!!. 8
)!!8 9
;!!9 :
for"" 
("" 
var"" 
i"" 
="" 
$num"" 
;"" 
i""  !
<""" #
count""$ )
;"") *
i""+ ,
++"", .
)"". /
{## 
var$$ 
item$$ 
=$$ 
($$  
string$$  &
)$$& '
deck$$' +
.$$+ ,
Pop$$, /
($$/ 0
)$$0 1
;$$1 2
listToReturn%%  
.%%  !
Add%%! $
(%%$ %
item%%% )
)%%) *
;%%* +
}&& 
return'' 
listToReturn'' #
;''# $
}(( 
return)) 

arrayItems)) 
;)) 
}** 	
}++ 
},, Õ
PD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Creatives\CreativeHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	Creatives' 0
{		 
public

 

class

 
CreativeHelper

 
{ 
public 
static 
List 
< 
SelectItemPair )
>) *

ReadEmails+ 5
(5 6
string6 <
filePath= E
)E F
{ 	
List 
< 
SelectItemPair 
>  
emails! '
=( )
new* -
List. 2
<2 3
SelectItemPair3 A
>A B
(B C
)C D
;D E
foreach 
( 
var 
line 
in  
File! %
.% &
ReadAllLines& 2
(2 3
filePath3 ;
); <
)< =
{ 
var 
trimmed 
= 
StringHelper *
.* +
Trim+ /
(/ 0
line0 4
)4 5
;5 6
if 
( 
string 
. 
IsNullOrEmpty (
(( )
trimmed) 0
)0 1
)1 2
continue3 ;
;; <
if 
( 
! 
EmailChecker  
.  !
IsValidEmail! -
(- .
trimmed. 5
)5 6
)6 7
continue8 @
;@ A
emails 
. 
Add 
( 
new 
SelectItemPair -
(- .
). /
{0 1
Selected2 :
=; <
true= A
,A B
TextC G
=H I
trimmedJ Q
,Q R
ValueS X
=Y Z
trimmed[ b
}c d
)d e
;e f
} 
return 
emails 
; 
} 	
public 
void 
Add 
( 
string 
filePath '
,' (
string) /
email0 5
)5 6
{ 	
File 
. 
AppendAllLines 
(  
filePath  (
,( )
new* -
string. 4
[4 5
]5 6
{7 8
email8 =
}= >
)> ?
;? @
} 	
public 
void 
Remove 
( 
string !
filePath" *
,* +
string, 2
email3 8
)8 9
{   	
File!! 
.!! 
WriteAllLines!! 
(!! 
filePath!! '
,!!' (
File!!) -
.!!- .
ReadAllLines!!. :
(!!: ;
filePath!!; C
)!!C D
.!!D E
Where!!E J
(!!J K
x!!K L
=>!!M O
StringHelper!!P \
.!!\ ]
Trim!!] a
(!!a b
x!!b c
)!!c d
!=!!e g
email!!h m
)!!m n
)!!n o
;!!o p
}"" 	
}## 
}$$ ˝;
TD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataFiles\SegmentDataManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	DataFiles' 0
{		 
public

 

static

 
class

 
SegmentDataManager

 *
{ 
public 
static 
readonly 
string %
CustomerCode& 2
=3 4
$str5 E
;E F
public 
static 
List 
< 
SegmentResponse *
>* +
FetchSegmentsData, =
(= >
WfpictContext> K
dbL N
,N O
SegmentParametersP a

parametersb l
)l m
{ 	
List 
< 
SegmentResponse  
>  !
data" &
=' (
new) ,
List- 1
<1 2
SegmentResponse2 A
>A B
(B C
)C D
;D E
string 
connectionString #
=$ %#
WebConfigurationManager& =
.= >
ConnectionStrings> O
[O P
$strP d
]d e
.e f
ConnectionStringf v
;v w
using 
( 
SqlConnection  

connection! +
=, -
new. 1
SqlConnection2 ?
(? @
connectionString@ P
)P Q
)Q R
{ 
using 
( 

SqlCommand !
command" )
=* +
new, /

SqlCommand0 :
(: ;
$str; T
,T U

connectionV `
)` a
)a b
{ 
command 
. 
CommandType '
=( )
CommandType* 5
.5 6
StoredProcedure6 E
;E F
command 
. 
CommandTimeout *
=+ ,
$num- 0
;0 1
command 
. 

Parameters &
.& '
Add' *
(* +
$str+ :
,: ;
	SqlDbType< E
.E F
BigIntF L
)L M
.M N
ValueN S
=T U

parametersV `
.` a
DataQuantitya m
;m n
command 
. 

Parameters &
.& '
Add' *
(* +
$str+ :
,: ;
	SqlDbType< E
.E F
VarCharF M
)M N
.N O
ValueO T
=U V

parametersW a
.a b
CustomerCodeb n
;n o
SqlParameter  
	parameter! *
=+ ,
command- 4
.4 5

Parameters5 ?
. 
AddWithValue +
(+ ,
$str, 3
,3 4

parameters5 ?
.? @
Zips@ D
)D E
;E F
	parameter 
. 
	SqlDbType '
=( )
	SqlDbType* 3
.3 4

Structured4 >
;> ?
	parameter 
. 
TypeName &
=' (
$str) =
;= >

connection   
.   
Open   #
(  # $
)  $ %
;  % &
SqlDataReader!! !
reader!!" (
=!!) *
command!!+ 2
.!!2 3
ExecuteReader!!3 @
(!!@ A
)!!A B
;!!B C
try"" 
{## 
long$$ 
index$$ "
=$$# $
$num$$% &
;$$& '
while%% 
(%% 
reader%% %
.%%% &
Read%%& *
(%%* +
)%%+ ,
)%%, -
{&& 
var'' 
segmentData''  +
='', -
new''. 1
SegmentResponse''2 A
{(( 
Index))  %
=))& '
index))( -
,))- .
Dealership_ID**  -
=**. /

parameters**0 :
.**: ;
OrderNumber**; F
}++ 
;++ 
segmentData-- '
.--' (
SalesMasterId--( 5
=--6 7
reader--8 >
.--> ?
GetInt32--? G
(--G H
$num--H I
)--I J
;--J K
segmentData.. '
...' (
	FirstName..( 1
=..2 3
reader..4 :
[..: ;
$str..; F
]..F G
as..H J
string..K Q
;..Q R
if00 
(00  
reader00  &
[00& '
$str00' 1
]001 2
!=003 5
DBNull006 <
.00< =
Value00= B
)00B C
segmentData11  +
.11+ ,
LastName11, 4
=115 6
reader117 =
[11= >
$str11> H
]11H I
as11J L
string11M S
;11S T
if33 
(33  
reader33  &
[33& '
$str33' 0
]330 1
!=332 4
DBNull335 ;
.33; <
Value33< A
)33A B
segmentData44  +
.44+ ,
Address44, 3
=444 5
reader446 <
[44< =
$str44= F
]44F G
as44H J
string44K Q
;44Q R
if66 
(66  
reader66  &
[66& '
$str66' -
]66- .
!=66/ 1
DBNull662 8
.668 9
Value669 >
)66> ?
segmentData77  +
.77+ ,
City77, 0
=771 2
reader773 9
[779 :
$str77: @
]77@ A
as77B D
string77E K
;77K L
if99 
(99  
reader99  &
[99& '
$str99' .
]99. /
!=990 2
DBNull993 9
.999 :
Value99: ?
)99? @
segmentData::  +
.::+ ,
State::, 1
=::2 3
reader::4 :
[::: ;
$str::; B
]::B C
as::D F
string::G M
;::M N
if<< 
(<<  
reader<<  &
[<<& '
$str<<' ,
]<<, -
!=<<. 0
DBNull<<1 7
.<<7 8
Value<<8 =
)<<= >
segmentData==  +
.==+ ,
Zip==, /
===0 1
reader==2 8
[==8 9
$str==9 >
]==> ?
as==@ B
string==C I
;==I J
if?? 
(??  
reader??  &
[??& '
$str??' ,
]??, -
!=??. 0
DBNull??1 7
.??7 8
Value??8 =
)??= >
segmentData@@  +
.@@+ ,
Apt@@, /
=@@0 1
reader@@2 8
[@@8 9
$str@@9 >
]@@> ?
as@@@ B
string@@C I
;@@I J
ifBB 
(BB  
readerBB  &
[BB& '
$strBB' -
]BB- .
!=BB/ 1
DBNullBB2 8
.BB8 9
ValueBB9 >
)BB> ?
segmentDataCC  +
.CC+ ,
Zip4CC, 0
=CC1 2
readerCC3 9
.CC9 :
GetInt16CC: B
(CCB C
$numCCC D
)CCD E
;CCE F
dataEE  
.EE  !
AddEE! $
(EE$ %
segmentDataEE% 0
)EE0 1
;EE1 2
indexGG !
++GG! #
;GG# $
}HH 
}II 
finallyJJ 
{KK 
readerMM 
.MM 
CloseMM $
(MM$ %
)MM% &
;MM& '
}NN 
}OO 
}PP 
returnQQ 
dataQQ 
;QQ 
}RR 	
}SS 
}TT ∆
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataFiles\SegmentParameters.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	DataFiles' 0
{ 
public 

class 
SegmentParameters "
{ 
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
long		 
DataQuantity		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
CustomerCode

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 
List 
< 
string 
> 
ZipCodes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
	DataTable 
Zips 
{ 	
get 
{ 
return 
CreateDataTable (
(( )
ZipCodes) 1
)1 2
;2 3
}4 5
} 	
private 
static 
	DataTable  
CreateDataTable! 0
(0 1
IEnumerable1 <
<< =
string= C
>C D
idsE H
)H I
{ 	
	DataTable 
table 
= 
new !
	DataTable" +
(+ ,
), -
;- .
table 
. 
Columns 
. 
Add 
( 
$str '
,' (
typeof) /
(/ 0
string0 6
)6 7
)7 8
;8 9
foreach 
( 
string 
id 
in !
ids" %
)% &
{ 
table 
. 
Rows 
. 
Add 
( 
id !
)! "
;" #
} 
return 
table 
; 
} 	
} 
} ø
QD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataFiles\SegmentResponse.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	DataFiles' 0
{ 
public 

class 
SegmentResponse  
{ 
public 
long 
Index 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
SalesMasterId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
Address		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
string

 
City

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
State 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Zip 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Apt 
{ 
get 
;  
set! $
;$ %
}& '
public 
short 
Zip4 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Dealership_ID #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
URL 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
OpenURL 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
	BannerURL 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} Ô
RD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataFiles\SegmentResponse1.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	DataFiles' 0
{ 
public 

class 
SegmentResponse1 !
{ 
public 
int 
Index 
{ 
get 
; 
set  #
;# $
}% &
public 
int 
SalesMasterId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
Address		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
string

 
City

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
State 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Zip 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Apt 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
Zip4 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
Dealership_ID #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} ˘L
ZD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataReports\CustomerOrdersStatusVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DataReports' 2
{		 
public

 

class

 "
CustomerOrdersStatusVm

 '
{ 
public 
string 
Report_Sent !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Report_Needed #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

Invoice_No  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Invoice_Date "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
NXS_IO_Number #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
Campaign_Type #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
Campaign_Name #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 

Order_Date  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Broadcast_Date $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
Deployment_Time_EST )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
Broadcast_QTY #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
	Geography 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Demographics "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
	From_Line 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Subject_Line "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string  
Special_Instructions *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 

Supression  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
RTG_URL 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 

Design_Fee  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   
string   
Report_Format   #
{  $ %
get  & )
;  ) *
set  + .
;  . /
}  0 1
static"" 
readonly"" 
System"" 
."" 
Random"" %
Random""& ,
=""- .
new""/ 2
System""3 9
.""9 :
Random"": @
(""@ A
)""A B
;""B C
public$$ 
static$$ "
CustomerOrdersStatusVm$$ ,
FromCampaign$$- 9
($$9 :
Campaign$$: B
campaign$$C K
)$$K L
{%% 	
string&& 
orderNumberRdp&& !
=&&" #
campaign&&$ ,
.&&, -
ReBroadcasted&&- :
?&&; <
campaign&&= E
.&&E F$
ReBroadcastedOrderNumber&&F ^
:&&_ `
campaign&&a i
.&&i j
OrderNumber&&j u
;&&u v
string'' 
['' 
]'' 
campaignTypes'' "
=''# $
{''% &
$str''' 7
,''7 8
$str''9 B
,''B C
$str''D U
,''U V
$str''W l
}''m n
;''n o
int(( 
ct(( 
=(( 
Random(( 
.(( 
Next((  
(((  !
$num((! "
,((" #
$num(($ %
)((% &
;((& '
string)) 
[)) 
])) 
reportFormats)) "
=))# $
{))% &
$str))' 1
,))1 2
$str))3 ;
})); <
;))< =
int** 
ct2** 
=** 
Random** 
.** 
Next** !
(**! "
$num**" #
,**# $
$num**% &
)**& '
;**' (
string++ 
status++ 
=++ 
(++ 
campaign++ %
.++% &
Status++& ,
==++- /
(++0 1
int++1 4
)++4 5
CampaignStatus++5 C
.++C D

Monitoring++D N
)++N O
?++P Q
$str++R h
:++i j
(,, 
campaign,, 
.,, 
Status,, $
==,,% '
(,,( )
int,,) ,
),,, -
CampaignStatus,,- ;
.,,; <
Invoiced,,< D
),,D E
?,,F G
$str,,H R
:,,S T
System,,U [
.,,[ \
Enum,,\ `
.,,` a
GetName,,a h
(,,h i
typeof,,i o
(,,o p
CampaignStatus,,p ~
),,~ 
,	,, Ä
campaign
,,Å â
.
,,â ä
Status
,,ä ê
)
,,ê ë
;
,,ë í
var.. 
ordersStatus.. 
=.. 
new.. ""
CustomerOrdersStatusVm..# 9
{// 
Report_Sent00 
=00  !
$str00" '
,00' (
Report_Needed11 !
=11" #
$str11$ )
,11) *
Status22 
=22 
status22 #
,22# $

Invoice_No33 
=33  
$str33! '
,33' (
Invoice_Date44  
=44! "
System44# )
.44) *
DateTime44* 2
.442 3
Now443 6
.446 7
ToString447 ?
(44? @
StringConstants44@ O
.44O P
DateFormatSlashes44P a
)44a b
,44b c
NXS_IO_Number55 !
=55" #
orderNumberRdp55$ 2
,552 3
Campaign_Type66 !
=66" #
campaignTypes66$ 1
[661 2
ct662 4
]664 5
,665 6
Campaign_Name77 !
=77" #
campaign77$ ,
.77, -
Approved77- 5
.775 6
CampaignName776 B
,77B C

Order_Date88 
=88  
campaign88! )
.88) *
	CreatedAt88* 3
.883 4
ToString884 <
(88< =
StringConstants88= L
.88L M
DateFormatSlashes88M ^
)88^ _
,88_ `
Broadcast_Date99 "
=99# $
campaign99% -
.99- .
Approved99. 6
.996 7

DeployDate997 A
?99A B
.99B C
ToString99C K
(99K L
StringConstants99L [
.99[ \
DateFormatSlashes99\ m
)99m n
,99n o
Deployment_Time_EST:: '
=::( )
campaign::* 2
.::2 3
Approved::3 ;
.::; <

DeployDate::< F
?::F G
.::G H
ToString::H P
(::P Q
StringConstants::Q `
.::` a

TimeFormat::a k
)::k l
,::l m
Broadcast_QTY;; !
=;;" #
campaign;;$ ,
.;;, -
Approved;;- 5
.;;5 6
Quantity;;6 >
.;;> ?
ToString;;? G
(;;G H
);;H I
,;;I J
	Geography<< 
=<< 
campaign<<  (
.<<( )
Approved<<) 1
.<<1 2

GeoDetails<<2 <
,<<< =
Demographics==  
===! "
campaign==# +
.==+ ,
Approved==, 4
.==4 5
Demographics==5 A
,==A B
	From_Line>> 
=>> 
campaign>>  (
.>>( )
Approved>>) 1
.>>1 2
FromLine>>2 :
,>>: ;
Subject_Line??  
=??! "
campaign??# +
.??+ ,
Approved??, 4
.??4 5
SubjectLine??5 @
,??@ A 
Special_Instructions@@ (
=@@) *
campaign@@+ 3
.@@3 4
Approved@@4 <
.@@< =
SpecialInstructions@@= P
,@@P Q

SupressionAA 
=AA  
stringAA! '
.AA' (
IsNullOrEmptyAA( 5
(AA5 6
campaignAA6 >
.AA> ?
AssetsAA? E
.AAE F
SuppressionFileAAF U
)AAU V
?AAW X
$strAAY ^
:AA_ `
$strAAa e
,AAe f
RTG_URLBB 
=BB 
campaignBB &
.BB& '
ReferrerBB' /
,BB/ 0

Design_FeeCC 
=CC  
$strCC! &
,CC& '
Report_FormatDD !
=DD" #
reportFormatsDD$ 1
[DD1 2
ct2DD2 5
]DD5 6
}EE 
;EE 
returnFF 
ordersStatusFF 
;FF  
}GG 	
}HH 
}II ¯(
_D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataReports\CustomerOrdersStatusReports.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DataReports' 2
{ 
public 

static 
class '
CustomerOrdersStatusReports 3
{ 
public 
static 
void 
Generate #
(# $
System$ *
.* +
Web+ .
.. /
HttpResponseBase/ ?
Response@ H
,H I
stringJ P

whiteLabelQ [
,[ \
List] a
<a b
Campaignb j
>j k
	campaignsl u
)u v
{ 	
ExcelPackage 
excel 
=  
new! $
ExcelPackage% 1
(1 2
)2 3
;3 4
var 
	workSheet 
= 
excel !
.! "
Workbook" *
.* +

Worksheets+ 5
.5 6
Add6 9
(9 :

whiteLabel: D
)D E
;E F
List 
< "
CustomerOrdersStatusVm '
>' (
customerOrders) 7
=8 9
new: =
List> B
<B C"
CustomerOrdersStatusVmC Y
>Y Z
(Z [
)[ \
;\ ]
foreach 
( 
var 
campaign !
in" $
	campaigns% .
). /
{ 
customerOrders 
. 
Add "
(" #"
CustomerOrdersStatusVm# 9
.9 :
FromCampaign: F
(F G
campaignG O
)O P
)P Q
;Q R
} 
	workSheet 
. 
Cells 
[ 
$num 
, 
$num  
]  !
.! "
LoadFromCollection" 4
(4 5
customerOrders5 C
,C D
trueE I
)I J
;J K
var 
headerRowComplete !
=" #
	workSheet$ -
.- .
Row. 1
(1 2
$num2 3
)3 4
;4 5
headerRowComplete   
.   
Style   #
.  # $
Font  $ (
.  ( )
Size  ) -
=  . /
$num  0 2
;  2 3
headerRowComplete!! 
.!! 
Style!! #
.!!# $
Font!!$ (
.!!( )
Bold!!) -
=!!. /
true!!0 4
;!!4 5
int## 
Row## 
=## 
$num## 
;## 
foreach$$ 
($$ 
var$$ 
campaign$$ !
in$$" $
	campaigns$$% .
)$$. /
{%% 
var&& 
rowComplete&& 
=&&  !
	workSheet&&" +
.&&+ ,
Row&&, /
(&&/ 0
Row&&0 3
)&&3 4
;&&4 5
rowComplete'' 
.'' 
Style'' !
.''! "
Fill''" &
.''& '
PatternType''' 2
=''3 4
ExcelFillStyle''5 C
.''C D
Solid''D I
;''I J
if)) 
()) 
campaign)) 
.)) 
Status)) #
==))$ &
())' (
int))( +
)))+ ,
CampaignStatus)), :
.)): ;

Monitoring)); E
)))E F
rowComplete** 
.**  
Style**  %
.**% &
Fill**& *
.*** +
BackgroundColor**+ :
.**: ;
SetColor**; C
(**C D
Color**D I
.**I J

DarkOrange**J T
)**T U
;**U V
else++ 
rowComplete,, 
.,,  
Style,,  %
.,,% &
Fill,,& *
.,,* +
BackgroundColor,,+ :
.,,: ;
SetColor,,; C
(,,C D
Color,,D I
.,,I J
MediumPurple,,J V
),,V W
;,,W X
Row-- 
++-- 
;-- 
}.. 
using00 
(00 
var00 
memoryStream00 #
=00$ %
new00& )
MemoryStream00* 6
(006 7
)007 8
)008 9
{11 
Response22 
.22 
ContentType22 $
=22% &
$str22' j
;22j k
Response33 
.33 
	AddHeader33 "
(33" #
$str33# 8
,338 9
$str33: R
+33R S

whiteLabel33T ^
+33_ `
$str33` s
)33s t
;33t u
excel44 
.44 
SaveAs44 
(44 
memoryStream44 )
)44) *
;44* +
memoryStream55 
.55 
WriteTo55 $
(55$ %
Response55% -
.55- .
OutputStream55. :
)55: ;
;55; <
Response66 
.66 
Flush66 
(66 
)66  
;66  !
Response77 
.77 
End77 
(77 
)77 
;77 
}88 
}99 	
}:: 
};; »|
OD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Db\CampaignMonitoringVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Db' )
{ 
public		 

class		  
CampaignMonitoringVm		 %
{

 
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 

TrackingId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Quantity 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
ClicksNeeded "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
AMPM 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
	StartDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
ClickMeterLink $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 

Day1Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Day1 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Day1Rule 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

Day2Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Day2 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Day2Rule 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

Day3Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Day3 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Day3Rule 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

Day4Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Day4 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 

Day5Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   
string   
Day5   
{   
get    
;    !
set  " %
;  % &
}  ' (
public!! 
string!! 

Day6Clicks!!  
{!!! "
get!!# &
;!!& '
set!!( +
;!!+ ,
}!!- .
public"" 
string"" 
Day6"" 
{"" 
get""  
;""  !
set""" %
;""% &
}""' (
public## 
string## 

Day7Clicks##  
{##! "
get### &
;##& '
set##( +
;##+ ,
}##- .
public$$ 
string$$ 
Day7$$ 
{$$ 
get$$  
;$$  !
set$$" %
;$$% &
}$$' (
public%% 
string%% 
Total%% 
{%% 
get%% !
;%%! "
set%%# &
;%%& '
}%%( )
public&& 
string&& 
Day7PlusClicks&& $
{&&% &
get&&' *
;&&* +
set&&, /
;&&/ 0
}&&1 2
public'' 
string'' 
CampaignFill'' "
{''# $
get''% (
;''( )
set''* -
;''- .
}''/ 0
public)) 
static))  
CampaignMonitoringVm)) * 
FromCampaignTracking))+ ?
())? @
Campaign))@ H
campaign))I Q
,))Q R
CampaignTracking))S c
campaignTracking))d t
)))t u
{** 	
long++ 
Needed++ 
=++ 
campaignTracking++ *
.++* +
Quantity+++ 3
<=++4 6
$num++7 :
?++; <
campaignTracking++= M
.++M N
Quantity++N V
:++W X
(++Y Z
long++Z ^
)++^ _
(++_ `
campaignTracking++` p
.++p q
Quantity++q y
*++z {
$num++| }
/++~ 
$num
++Ä Ö
)
++Ö Ü
;
++Ü á
long,, 
Total,, 
=,, 
campaignTracking,, )
.,,) *

Day1Clicks,,* 4
+,,5 6
campaignTracking,,7 G
.,,G H

Day2Clicks,,H R
+,,S T
campaignTracking,,U e
.,,e f

Day3Clicks,,f p
+,,q r
campaignTracking	,,s É
.
,,É Ñ

Day4Clicks
,,Ñ é
+
,,è ê
campaignTracking
,,ë °
.
,,° ¢

Day5Clicks
,,¢ ¨
+
,,≠ Æ
campaignTracking
,,Ø ø
.
,,ø ¿

Day6Clicks
,,¿  
+
,,À Ã
campaignTracking
,,Õ ›
.
,,› ﬁ

Day7Clicks
,,ﬁ Ë
;
,,Ë È
double-- 
CampaignFill-- 
=--  !
(--! "
double--" (
)--( )
Total--) .
/--/ 0
Needed--1 7
;--7 8
var.. 
model.. 
=.. 
new..  
CampaignMonitoringVm.. 0
{// 

CampaignId00 
=00 
campaign00 %
.00% &
Id00& (
.00( )
ToString00) 1
(001 2
)002 3
,003 4

TrackingId11 
=11 
campaignTracking11 -
.11- .
Id11. 0
.110 1
ToString111 9
(119 :
)11: ;
,11; <
OrderNumber22 
=22 
string22 $
.22$ %
IsNullOrEmpty22% 2
(222 3
campaignTracking223 C
.22C D
SegmentNumber22D Q
)22Q R
?22S T
campaignTracking22U e
.22e f
OrderNumber22f q
:22r s
campaignTracking	22t Ñ
.
22Ñ Ö
SegmentNumber
22Ö í
,
22í ì
CampaignName33 
=33 
campaign33 '
.33' (
Approved33( 0
.330 1
CampaignName331 =
,33= >
Quantity44 
=44 
string44 !
.44! "
Format44" (
(44( )
$str44) 1
,441 2
campaignTracking443 C
.44C D
Quantity44D L
)44L M
,44M N
ClicksNeeded55 
=55 
string55 %
.55% &
Format55& ,
(55, -
$str55- 5
,555 6
Needed557 =
)55= >
,55> ?
	StartDate66 
=66 
campaignTracking66 ,
.66, -
	StartDate66- 6
?666 7
.667 8
ToString668 @
(66@ A
StringConstants66A P
.66P Q
DateFormatSlashes66Q b
)66b c
,66c d
AMPM77 
=77 
campaignTracking77 '
.77' (
	StartDate77( 1
?771 2
.772 3
ToString773 ;
(77; <
StringConstants77< K
.77K L
TimeFormatAMPM77L Z
)77Z [
,77[ \
ClickMeterLink88 
=88  
campaign88! )
.88) *
Testing88* 1
.881 2!
ClickMeterRotatorLink882 G
,88G H
Day199 
=99 
campaignTracking99 '
.99' (
	StartDate99( 1
?991 2
.992 3
ToString993 ;
(99; <
StringConstants99< K
.99K L
DateFormatSlashes99L ]
)99] ^
,99^ _
Day2:: 
=:: 
campaignTracking:: '
.::' (
	StartDate::( 1
?::1 2
.::2 3
AddDays::3 :
(::: ;
$num::; <
)::< =
.::= >
ToString::> F
(::F G
StringConstants::G V
.::V W
DateFormatSlashes::W h
)::h i
,::i j
Day3;; 
=;; 
campaignTracking;; '
.;;' (
	StartDate;;( 1
?;;1 2
.;;2 3
AddDays;;3 :
(;;: ;
$num;;; <
);;< =
.;;= >
ToString;;> F
(;;F G
StringConstants;;G V
.;;V W
DateFormatSlashes;;W h
);;h i
,;;i j
Day4<< 
=<< 
campaignTracking<< '
.<<' (
	StartDate<<( 1
?<<1 2
.<<2 3
AddDays<<3 :
(<<: ;
$num<<; <
)<<< =
.<<= >
ToString<<> F
(<<F G
StringConstants<<G V
.<<V W
DateFormatSlashes<<W h
)<<h i
,<<i j
Day5== 
=== 
campaignTracking== '
.==' (
	StartDate==( 1
?==1 2
.==2 3
AddDays==3 :
(==: ;
$num==; <
)==< =
.=== >
ToString==> F
(==F G
StringConstants==G V
.==V W
DateFormatSlashes==W h
)==h i
,==i j
Day6>> 
=>> 
campaignTracking>> '
.>>' (
	StartDate>>( 1
?>>1 2
.>>2 3
AddDays>>3 :
(>>: ;
$num>>; <
)>>< =
.>>= >
ToString>>> F
(>>F G
StringConstants>>G V
.>>V W
DateFormatSlashes>>W h
)>>h i
,>>i j
Day7?? 
=?? 
campaignTracking?? '
.??' (
	StartDate??( 1
???1 2
.??2 3
AddDays??3 :
(??: ;
$num??; <
)??< =
.??= >
ToString??> F
(??F G
StringConstants??G V
.??V W
DateFormatSlashes??W h
)??h i
,??i j

Day1Clicks@@ 
=@@ 
string@@ #
.@@# $
Format@@$ *
(@@* +
$str@@+ 3
,@@3 4
campaignTracking@@5 E
.@@E F

Day1Clicks@@F P
)@@P Q
,@@Q R

Day2ClicksAA 
=AA 
stringAA #
.AA# $
FormatAA$ *
(AA* +
$strAA+ 3
,AA3 4
campaignTrackingAA5 E
.AAE F

Day2ClicksAAF P
)AAP Q
,AAQ R

Day3ClicksBB 
=BB 
stringBB #
.BB# $
FormatBB$ *
(BB* +
$strBB+ 3
,BB3 4
campaignTrackingBB5 E
.BBE F

Day3ClicksBBF P
)BBP Q
,BBQ R

Day4ClicksCC 
=CC 
stringCC #
.CC# $
FormatCC$ *
(CC* +
$strCC+ 3
,CC3 4
campaignTrackingCC5 E
.CCE F

Day4ClicksCCF P
)CCP Q
,CCQ R

Day5ClicksDD 
=DD 
stringDD #
.DD# $
FormatDD$ *
(DD* +
$strDD+ 3
,DD3 4
campaignTrackingDD5 E
.DDE F

Day5ClicksDDF P
)DDP Q
,DDQ R

Day6ClicksEE 
=EE 
stringEE #
.EE# $
FormatEE$ *
(EE* +
$strEE+ 3
,EE3 4
campaignTrackingEE5 E
.EEE F

Day6ClicksEEF P
)EEP Q
,EEQ R

Day7ClicksFF 
=FF 
stringFF #
.FF# $
FormatFF$ *
(FF* +
$strFF+ 3
,FF3 4
campaignTrackingFF5 E
.FFE F

Day7ClicksFFF P
)FFP Q
,FFQ R
Day7PlusClicksGG 
=GG  
stringGG! '
.GG' (
FormatGG( .
(GG. /
$strGG/ 7
,GG7 8
campaignTrackingGG9 I
.GGI J
Day7PlusClicksGGJ X
)GGX Y
,GGY Z
TotalHH 
=HH 
stringHH 
.HH 
FormatHH %
(HH% &
$strHH& .
,HH. /
TotalHH0 5
)HH5 6
,HH6 7
CampaignFillII 
=II 
CampaignFillII +
.II+ ,
ToStringII, 4
(II4 5
$strII5 <
)II< =
}JJ 
;JJ 
modelKK 
.KK 
Day1RuleKK 
=KK 
stringKK #
.KK# $
JoinKK$ (
(KK( )
$strKK) 0
,KK0 1
campaignKK2 :
.KK: ;
NotificationsKK; H
.LL 
WhereLL 
(LL 
xLL 
=>LL 
xLL 
.LL 
QcRuleLL $
<=LL% '
(LL( )
intLL) ,
)LL, -
QcRuleLL- 3
.LL3 4!
NotHitClickRateIn1DayLL4 I
)LLI J
.LLJ K
SelectLLK Q
(LLQ R
xLLR S
=>LLT V
xLLW X
.LLX Y
MessageLLY `
)LL` a
)LLa b
;LLb c
modelNN 
.NN 
Day2RuleNN 
=NN 
stringNN #
.NN# $
JoinNN$ (
(NN( )
$strNN) 0
,NN0 1
campaignNN2 :
.NN: ;
NotificationsNN; H
.OO 
WhereOO 
(OO 
xOO 
=>OO 
xOO 
.OO 
QcRuleOO $
==OO% '
(OO( )
intOO) ,
)OO, -
QcRuleOO- 3
.OO3 4"
NotHitClickRateIn2DaysOO4 J
||OOK M
xOON O
.OOO P
QcRuleOOP V
==OOW Y
(OOZ [
intOO[ ^
)OO^ _
QcRuleOO_ e
.OOe f!
NotHitOpenRateIn2DaysOOf {
)OO{ |
.OO| }
Select	OO} É
(
OOÉ Ñ
x
OOÑ Ö
=>
OOÜ à
x
OOâ ä
.
OOä ã
Message
OOã í
)
OOí ì
)
OOì î
;
OOî ï
modelQQ 
.QQ 
Day3RuleQQ 
=QQ 
stringQQ #
.QQ# $
JoinQQ$ (
(QQ( )
$strQQ) 0
,QQ0 1
campaignQQ2 :
.QQ: ;
NotificationsQQ; H
.RR 
WhereRR 
(RR 
xRR 
=>RR 
xRR 
.RR 
QcRuleRR $
==RR% '
(RR( )
intRR) ,
)RR, -
QcRuleRR- 3
.RR3 4"
NotHitClickRateIn3DaysRR4 J
||RRK M
xRRN O
.RRO P
QcRuleRRP V
==RRW Y
(RRZ [
intRR[ ^
)RR^ _
QcRuleRR_ e
.RRe f!
NotHitOpenRateIn3DaysRRf {
)RR{ |
.RR| }
Select	RR} É
(
RRÉ Ñ
x
RRÑ Ö
=>
RRÜ à
x
RRâ ä
.
RRä ã
Message
RRã í
)
RRí ì
)
RRì î
;
RRî ï
returnTT 
modelTT 
;TT 
}UU 	
}VV 
}WW ´
GD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Pdf\ExcelKiller.cs
	namespace

 	
ADSDataDirect


 
.

 
Infrastructure

 &
.

& '
Pdf

' *
{ 
public 

class 
ExcelKiller 
{ 
public 
static 
void 
Kill 
(  
ServerLogger  ,
logger- 3
)3 4
{ 	
try 
{ 
Impersonate 
objImpersonate *
=+ ,
new- 0
Impersonate1 <
(< = 
ConfigurationManager (
.( )
AppSettings) 4
[4 5
$str5 A
]A B
,B C 
ConfigurationManager (
.( )
AppSettings) 4
[4 5
$str5 ?
]? @
,@ A 
ConfigurationManager (
.( )
AppSettings) 4
[4 5
$str5 ?
]? @
)@ A
;A B
bool 
impersonateValid %
;% &
if 
(  
ConfigurationManager (
.( )
AppSettings) 4
[4 5
$str5 =
]= >
==? A
$strB I
)I J
{K L
impersonateValid $
=% &
true' +
;+ ,
} 
else 
{ 
impersonateValid $
=% &
objImpersonate' 5
.5 6 
impersonateValidUser6 J
(J K
)K L
;L M
} 
if 
( 
impersonateValid $
)$ %
{ 
Process   
[   
]   
excelProcesses   ,
=  - .
Process  / 6
.  6 7
GetProcessesByName  7 I
(  I J
$str  J Q
)  Q R
;  R S
logger!! 
.!! 
log!! 
(!! 
$str!! ,
+!!- .
excelProcesses!!/ =
.!!= >
Length!!> D
)!!D E
;!!E F
foreach"" 
("" 
Process"" $
p""% &
in""' )
excelProcesses""* 8
)""8 9
{## 
p$$ 
.$$ 
Kill$$ 
($$ 
)$$  
;$$  !
logger%% 
.%% 
log%% "
(%%" #
$str%%# ,
)%%, -
;%%- .
if&& 
(&& 
string&& "
.&&" #
IsNullOrEmpty&&# 0
(&&0 1
p&&1 2
.&&2 3
MainWindowTitle&&3 B
)&&B C
)&&C D
{'' 
})) 
}** 
}++ 
else,, 
{-- 
throw.. 
new.. 
AdsException.. *
(..* +
$str..+ >
)..> ?
;..? @
}// 
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 
logger33 
.33 
log33 
(33 
$str33 4
+335 6
Environment44 
.44  
NewLine44  '
+44( )
ex55 
.55 
Message55 
+55  
Environment66 
.66  
NewLine66  '
+66( )
ex77 
.77 

StackTrace77 !
)77! "
;77" #
}88 
}99 	
}:: 
};; ç
MD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\EZanga\EZangaCampaign.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
EZanga' -
{ 
public 

class 
EZangaCampaign 
{ 
public 
long 
id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
notes 
{ 
get !
;! "
set# &
;& '
}( )
} 
}		 ˜.
LD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\EZanga\EZangaManager.cs
	namespace		 	
ADSDataDirect		
 
.		 
Infrastructure		 &
.		& '
EZanga		' -
{

 
public 

class 
EZangaManager 
{ 
private 
static 
string 
urlBase %
=& '
$"( *(
https://adpad-api.ezanga.com* F
"F G
;G H
private 
static 
string 
urlCampaignCreate /
=0 1
$"2 4
/groups4 ;
"; <
;< =
private 
static 
string 
urlLinkCreate +
=, -
$str. F
;F G
private 
static 
string 
apiKeyHeader *
=+ ,
$"- / 
X-Clickmeter-Authkey/ C
"C D
;D E
private 
static 
string 
userName &
=' (
$") +2
&jsilver@nextstepdigitaladvertising.com+ Q
"Q R
;R S
private 
static 
string 
apiKey $
=% &
$"' ),
 94006e26114d9479a9328c19f7c87f9c) I
"I J
;J K
public 
static 
long 
CreateCampaign )
() *
EZangaCampaign* 8
campaign9 A
)A B
{ 	
string 
url 
= 
urlBase  
+! "
urlCampaignCreate# 4
;4 5
string 
data 
= 
campaign "
." #
ToJson# )
() *
)* +
;+ ,
try 
{ 
string 
responseContent &
=' (
Post) -
(- .
url. 1
,1 2
data3 7
)7 8
;8 9
var 
response 
= 
JsonConvert *
.* +
DeserializeObject+ <
<< =
EZangaCampaign= K
>K L
(L M
responseContentM \
)\ ]
;] ^
return 
response 
.  
id  "
;" #
} 
catch 
( 
	Exception 
ex 
)  
{ 
return   
-   
$num   
;   
}!! 
}"" 	
private$$ 
string$$ 
Get$$ 
($$ 
string$$ !
url$$" %
)$$% &
{%% 	
using&& 
(&& 

HttpClient&& 
client&& $
=&&% &
new&&' *

HttpClient&&+ 5
(&&5 6
)&&6 7
)&&7 8
{'' 
client(( 
.(( 
Timeout(( 
=((  
TimeSpan((! )
.(() *
FromMinutes((* 5
(((5 6
$num((6 7
)((7 8
;((8 9
client)) 
.)) !
DefaultRequestHeaders)) ,
.)), -
Add))- 0
())0 1
apiKeyHeader))1 =
,))= >
apiKey))? E
)))E F
;))F G
using** 
(** 
HttpResponseMessage** *
response**+ 3
=**4 5
client**6 <
.**< =
GetAsync**= E
(**E F
url**F I
)**I J
.**J K
Result**K Q
)**Q R
using++ 
(++ 
HttpContent++ "
content++# *
=+++ ,
response++- 5
.++5 6
Content++6 =
)++= >
{,, 
string-- 
responseContent-- *
=--+ ,
content--- 4
.--4 5
ReadAsStringAsync--5 F
(--F G
)--G H
.--H I
Result--I O
;--O P
return.. 
responseContent.. *
;..* +
}// 
}00 
}11 	
private33 
static33 
string33 
Post33 "
(33" #
string33# )
url33* -
,33- .
string33/ 5
data336 :
)33: ;
{44 	
using55 
(55 

HttpClient55 
client55 $
=55% &
new55' *

HttpClient55+ 5
(555 6
)556 7
)557 8
{66 
client77 
.77 
Timeout77 
=77  
TimeSpan77! )
.77) *
FromMinutes77* 5
(775 6
$num776 7
)777 8
;778 9
client88 
.88 !
DefaultRequestHeaders88 ,
.88, -
Add88- 0
(880 1
apiKeyHeader881 =
,88= >
apiKey88? E
)88E F
;88F G
var99 
httpContent99 
=99  !
new99" %
StringContent99& 3
(993 4
data994 8
,998 9
Encoding99: B
.99B C
UTF899C G
,99G H
$str99I [
)99[ \
;99\ ]
using:: 
(:: 
HttpResponseMessage:: *
response::+ 3
=::4 5
client::6 <
.::< =
	PostAsync::= F
(::F G
url::G J
,::J K
httpContent::L W
)::W X
.::X Y
Result::Y _
)::_ `
using;; 
(;; 
HttpContent;; "
content;;# *
=;;+ ,
response;;- 5
.;;5 6
Content;;6 =
);;= >
{<< 
string== 
responseContent== *
===+ ,
content==- 4
.==4 5
ReadAsStringAsync==5 F
(==F G
)==G H
.==H I
Result==I O
;==O P
return>> 
responseContent>> *
;>>* +
}?? 
}@@ 
}AA 	
}BB 
}CC Ù	
HD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Log\ServerLogger.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Log' *
{		 
public

 

class

 
ServerLogger

 
{ 
readonly 
string 
LogPath 
=  !
HttpContext" -
.- .
Current. 5
.5 6
Server6 <
.< =
MapPath= D
(D E
$"E G!
~/logs/ExcelToPDF.txtG \
"\ ]
)] ^
;^ _
public 
void 
log 
( 
string 
message &
)& '
{ 	
System 
. 
IO 
. 
File 
. 
AppendAllText (
(( )
LogPath) 0
,0 1
Environment 
. 
NewLine #
+$ %
DateTime 
. 
Now 
. 
ToString %
(% &
)& '
+( )
$str 
+ 
message 
) 
; 
} 	
} 
} Å
ZD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Notifications\NotificationRecorder.cs
	namespace

 	
ADSDataDirect


 
.

 
Infrastructure

 &
.

& '
Notifications

' 4
{ 
public 

class  
NotificationRecorder %
{ 
public 
static 
void "
SaveNotificationRecord 1
(1 2
WfpictContext2 ?
db@ B
,B C
Guid 
? 

campaignId 
, 
string $
orderNumber% 0
,0 1
string2 8
segmentNumber9 F
,F G
QcRule 
qcRule 
, 
string !
message" )
)) *
{ 	
var 
alreadyNoted 
= 
db !
.! "
Notifications" /
. 
FirstOrDefault 
(  
x  !
=>" $
x% &
.& '

CampaignId' 1
==2 4

campaignId5 ?
&&@ B
xC D
.D E
OrderNumberE P
==Q S
orderNumberT _
&&` b
xc d
.d e
SegmentNumbere r
==s u
segmentNumber	v É
&&% '
x( )
.) *
QcRule* 0
==1 3
(4 5
int5 8
)8 9
qcRule9 ?
&&@ B
xC D
.D E
StatusE K
==L N
(O P
intP S
)S T
NotificationStatusT f
.f g
Foundg l
)l m
;m n
if 
( 
alreadyNoted 
!= 
null  $
)$ %
return& ,
;, -
	LogHelper 
. 
AddLog 
( 
db 
,  
LogType! (
.( )
RulesProcessing) 8
,8 9
orderNumber: E
,E F
$"G I"
Problem found. QCRule I _
{_ `
qcRule` f
}f g
 , Message g r
{r s
messages z
}z {
"{ |
)| }
;} ~
db 
. 
Notifications 
. 
Add  
(  !
new! $
Notification% 1
(1 2
)2 3
{ 
Id 
= 
Guid 
. 
NewGuid !
(! "
)" #
,# $
	CreatedAt 
= 
DateTime $
.$ %
Now% (
,( )

CampaignId 
= 

campaignId '
,' (
OrderNumber 
= 
orderNumber )
,) *
SegmentNumber   
=   
segmentNumber    -
,  - .
Status!! 
=!! 
(!! 
int!! 
)!! 
NotificationStatus!! 0
.!!0 1
Found!!1 6
,!!6 7
Message"" 
="" 
message"" !
,""! "
	CheckTime## 
=## 
DateTime## $
.##$ %
Now##% (
,##( )
FoundAt$$ 
=$$ 
DateTime$$ "
.$$" #
Now$$# &
,$$& '
QcRule%% 
=%% 
(%% 
int%% 
)%% 
qcRule%% $
}&& 
)&& 
;&& 
db'' 
.'' 
SaveChanges'' 
('' 
)'' 
;'' 
}(( 	
})) 
}** ¸4
GD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Pdf\Impersonate.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Pdf' *
{		 
public 

class 
Impersonate 
{ 
public 
const 
int %
LOGON32_LOGON_INTERACTIVE 2
=3 4
$num5 6
;6 7
public 
const 
int $
LOGON32_PROVIDER_DEFAULT 1
=2 3
$num4 5
;5 6'
WindowsImpersonationContext # 
impersonationContext$ 8
;8 9
public 
string 

domainName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
userName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
userPassword "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
Impersonate 
( 
) 
{ 	
}"" 	
public## 
Impersonate## 
(## 
string## !

domainName##" ,
,##, -
string##. 4
userName##5 =
,##= >
string##? E
userPassword##F R
)##R S
{$$ 	
this%% 
.%% 

domainName%% 
=%% 

domainName%% (
;%%( )
this&& 
.&& 
userName&& 
=&& 
userName&& $
;&&$ %
this'' 
.'' 
userPassword'' 
='' 
userPassword''  ,
;'', -
}(( 	
[++ 	
	DllImport++	 
(++ 
$str++ !
)++! "
]++" #
public,, 
static,, 
extern,, 
int,,  

LogonUserA,,! +
(,,+ ,
String,,, 2
lpszUserName,,3 ?
,,,? @
String-- 

lpszDomain-- 
,-- 
String.. 
lpszPassword.. 
,..  
int// 
dwLogonType// 
,// 
int00 
dwLogonProvider00 
,00  
ref11 
IntPtr11 
phToken11 
)11 
;11  
[33 	
	DllImport33	 
(33 
$str33 !
,33! "
CharSet33# *
=33+ ,
CharSet33- 4
.334 5
Auto335 9
,339 :
SetLastError33; G
=33H I
true33J N
)33N O
]33O P
public44 
static44 
extern44 
int44  
DuplicateToken44! /
(44/ 0
IntPtr440 6
hToken447 =
,44= >
int55 
impersonationLevel55 "
,55" #
ref66 
IntPtr66 
	hNewToken66  
)66  !
;66! "
[88 	
	DllImport88	 
(88 
$str88 !
,88! "
CharSet88# *
=88+ ,
CharSet88- 4
.884 5
Auto885 9
,889 :
SetLastError88; G
=88H I
true88J N
)88N O
]88O P
public99 
static99 
extern99 
bool99 !
RevertToSelf99" .
(99. /
)99/ 0
;990 1
[;; 	
	DllImport;;	 
(;; 
$str;; !
,;;! "
CharSet;;# *
=;;+ ,
CharSet;;- 4
.;;4 5
Auto;;5 9
);;9 :
];;: ;
public<< 
static<< 
extern<< 
bool<< !
CloseHandle<<" -
(<<- .
IntPtr<<. 4
handle<<5 ;
)<<; <
;<<< =
public== 
bool==  
impersonateValidUser== (
(==( )
)==) *
{>> 	
WindowsIdentity?? 
tempWindowsIdentity?? /
;??/ 0
IntPtr@@ 
token@@ 
=@@ 
IntPtr@@ !
.@@! "
Zero@@" &
;@@& '
IntPtrAA 
tokenDuplicateAA !
=AA" #
IntPtrAA$ *
.AA* +
ZeroAA+ /
;AA/ 0
ifCC 
(CC 
RevertToSelfCC 
(CC 
)CC 
)CC 
{DD 
ifEE 
(EE 

LogonUserAEE 
(EE 
thisEE #
.EE# $
userNameEE$ ,
,EE, -
thisEE. 2
.EE2 3

domainNameEE3 =
,EE= >
thisEE? C
.EEC D
userPasswordEED P
,EEP Q%
LOGON32_LOGON_INTERACTIVEEER k
,EEk l$
LOGON32_PROVIDER_DEFAULTFF ,
,FF, -
refFF. 1
tokenFF2 7
)FF7 8
!=FF9 ;
$numFF< =
)FF= >
{GG 
ifHH 
(HH 
DuplicateTokenHH &
(HH& '
tokenHH' ,
,HH, -
$numHH. /
,HH/ 0
refHH1 4
tokenDuplicateHH5 C
)HHC D
!=HHE G
$numHHH I
)HHI J
{II 
tempWindowsIdentityJJ +
=JJ, -
newJJ. 1
WindowsIdentityJJ2 A
(JJA B
tokenDuplicateJJB P
)JJP Q
;JJQ R 
impersonationContextKK ,
=KK- .
tempWindowsIdentityKK/ B
.KKB C
ImpersonateKKC N
(KKN O
)KKO P
;KKP Q
ifLL 
(LL  
impersonationContextLL 0
!=LL1 3
nullLL4 8
)LL8 9
{MM 
CloseHandleNN '
(NN' (
tokenNN( -
)NN- .
;NN. /
CloseHandleOO '
(OO' (
tokenDuplicateOO( 6
)OO6 7
;OO7 8
returnPP "
truePP# '
;PP' (
}QQ 
}RR 
}SS 
}TT 
ifUU 
(UU 
tokenUU 
!=UU 
IntPtrUU 
.UU  
ZeroUU  $
)UU$ %
CloseHandleVV 
(VV 
tokenVV !
)VV! "
;VV" #
ifWW 
(WW 
tokenDuplicateWW 
!=WW !
IntPtrWW" (
.WW( )
ZeroWW) -
)WW- .
CloseHandleXX 
(XX 
tokenDuplicateXX *
)XX* +
;XX+ ,
returnYY 
falseYY 
;YY 
}ZZ 	
public\\ 
void\\ 
undoImpersonation\\ %
(\\% &
)\\& '
{]] 	 
impersonationContext^^  
.^^  !
Undo^^! %
(^^% &
)^^& '
;^^' (
}__ 	
}aa 
}bb Ø
BD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Pdf\Introp.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Pdf' *
{ 
public 

class 
Introp 
{ 
public 
static 
void 
Generate #
(# $
string$ *
source+ 1
,1 2
string3 9
destination: E
)E F
{ 	
Application 
xlApp 
= 
new  #
Application$ /
(/ 0
)0 1
;1 2
xlApp 
. 
Visible 
= 
false !
;! "
xlApp 
. 
UserControl 
= 
false  %
;% &
	Workbooks 
xlWorkbooks !
=" #
xlApp$ )
.) *
	Workbooks* 3
;3 4
Workbook 

xlWorkbook 
=  !
xlWorkbooks" -
.- .
Open. 2
(2 3
source3 9
)9 :
;: ;

xlWorkbook 
. 
ExportAsFixedFormat *
(* +
XlFixedFormatType+ <
.< =
	xlTypePDF= F
,F G
destinationH S
)S T
;T U

xlWorkbook 
. 
Close 
( 
false "
)" #
;# $
xlWorkbooks 
. 
Close 
( 
) 
;  
xlApp 
. 
Quit 
( 
) 
; 
Marshal 
. !
FinalReleaseComObject )
() *

xlWorkbook* 4
)4 5
;5 6
Marshal   
.   !
FinalReleaseComObject   )
(  ) *
xlWorkbooks  * 5
)  5 6
;  6 7
Marshal!! 
.!! !
FinalReleaseComObject!! )
(!!) *
xlApp!!* /
)!!/ 0
;!!0 1
GC## 
.## 
Collect## 
(## 
)## 
;## 
GC$$ 
.$$ $
WaitForPendingFinalizers$$ '
($$' (
)$$( )
;$$) *
ExcelKiller&& 
.&& 
Kill&& 
(&& 
new&&  
Log&&! $
.&&$ %
ServerLogger&&% 1
(&&1 2
)&&2 3
)&&3 4
;&&4 5
}'' 	
}(( 
})) ã!
HD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Pdf\PdfOrganizer.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Pdf' *
{ 
public 

static 
class 
PdfOrganizer $
{ 
public 
static 
void 
SelectPages &
(& '
string' -
inputPdf. 6
,6 7
string8 >
pageSelection? L
,L M
stringN T
	outputPdfU ^
)^ _
{ 	
using 
( 
	PdfReader 
reader #
=$ %
new& )
	PdfReader* 3
(3 4
inputPdf4 <
)< =
)= >
{ 
reader 
. 
SelectPages "
(" #
pageSelection# 0
)0 1
;1 2
using 
( 

PdfStamper !
stamper" )
=* +
new, /

PdfStamper0 :
(: ;
reader; A
,A B
FileC G
.G H
CreateH N
(N O
	outputPdfO X
)X Y
)Y Z
)Z [
{ 
stamper 
. 
Close !
(! "
)" #
;# $
} 
} 
} 	
public 
static 
void 
RemovePagesFromPdf -
(- .
string. 4

sourceFile5 ?
,? @
stringA G
destinationFileH W
,W X
paramsY _
int` c
[c d
]d e
pagesToKeepf q
)q r
{ 	
	PdfReader!! 
r!! 
=!! 
new!! 
	PdfReader!! '
(!!' (

sourceFile!!( 2
)!!2 3
;!!3 4
using$$ 
($$ 

FileStream$$ 
fs$$  
=$$! "
new$$# &

FileStream$$' 1
($$1 2
destinationFile$$2 A
,$$A B
FileMode$$C K
.$$K L
Create$$L R
,$$R S

FileAccess$$T ^
.$$^ _
Write$$_ d
,$$d e
	FileShare$$f o
.$$o p
None$$p t
)$$t u
)$$u v
{%% 
using&& 
(&& 
Document&& 
doc&&  #
=&&$ %
new&&& )
Document&&* 2
(&&2 3
)&&3 4
)&&4 5
{'' 
using(( 
((( 
	PdfWriter(( $
w((% &
=((' (
	PdfWriter(() 2
.((2 3
GetInstance((3 >
(((> ?
doc((? B
,((B C
fs((D F
)((F G
)((G H
{)) 
doc++ 
.++ 
Open++  
(++  !
)++! "
;++" #
doc,, 
.,, 
SetPageSize,, '
(,,' (

iTextSharp,,( 2
.,,2 3
text,,3 7
.,,7 8
PageSize,,8 @
.,,@ A
A5,,A C
.,,C D
Rotate,,D J
(,,J K
),,K L
),,L M
;,,M N
w.. 
... 
	PageEmpty.. #
=..$ %
false..& +
;..+ ,
for22 
(22 
int22 
page22  $
=22% &
$num22' (
;22( )
page22* .
<=22/ 1
r222 3
.223 4
NumberOfPages224 A
;22A B
page22C G
++22G I
)22I J
{33 
doc55 
.55  
NewPage55  '
(55' (
)55( )
;55) *
w77 
.77 
DirectContent77 +
.77+ ,
AddTemplate77, 7
(777 8
w778 9
.779 :
GetImportedPage77: I
(77I J
r77J K
,77K L
page77M Q
)77Q R
,77R S
$num77T U
,77U V
$num77W X
)77X Y
;77Y Z
}88 
doc:: 
.:: 
Close:: !
(::! "
)::" #
;::# $
};; 
}<< 
}== 
}>> 	
}?? 
}@@ ã£
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ReportingModel\ClickModeler.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ReportingModel' 5
{		 
public

 

static

 
class

 
ClickModeler

 $
{ 
private 
static 
double 
[ 
] 
	spreadOf3  )
=* +
new, /
double0 6
[6 7
]7 8
{9 :
$num; F
,F G
$numH S
,S T
$numU Z
}[ \
;\ ]
private 
static 
double 
[ 
] 
	spreadOf5  )
=* +
new, /
double0 6
[6 7
]7 8
{9 :
$num; F
,F G
$numH S
,S T
$numU `
,` a
$numb m
,m n
$numo z
}{ |
;| }
static 
readonly 
Random 
Random %
=& '
new( +
Random, 2
(2 3
)3 4
;4 5
private 
static 
double 
GetSectionSpread .
(. /
int/ 2
spreadOf3 ;
,; <
int= @
whichOfA H
)H I
{ 	
if 
( 
whichOf 
> 
$num 
) 
whichOf $
=% &
$num' (
;( )
whichOf 
= 
whichOf 
- 
$num  !
;! "
return 
spreadOf 
== 
$num  
?! "
	spreadOf3# ,
[, -
whichOf- 4
]4 5
:6 7
	spreadOf58 A
[A B
whichOfB I
]I J
;J K
} 	
public 
static 
List 
< 

ClickModel %
>% &
GenerateClicks' 5
(5 6
List6 :
<: ;
string; A
>A B
linksC H
,H I
longJ N
clickCountTotalO ^
,^ _
List` d
<d e
OpenModelKeyworde u
>u v
keywordsw 
)	 Ä
{ 	
int 
numberOfLinks 
= 
links  %
.% &
Count& +
;+ ,
int 
numberInEachGroup !
=" #
numberOfLinks$ 1
<2 3
$num4 5
?6 7
$num8 9
:: ;
(< =
numberOfLinks= J
/K L
$numM N
)N O
;O P
int 
numberOfUpperGroups #
=$ %
numberOfLinks& 3
/4 5
numberInEachGroup6 G
;G H
int  
numberOfBottomGroups $
=% &
(' (
numberInEachGroup( 9
*: ;
numberOfUpperGroups< O
>P Q
numberOfLinksR _
)_ `
?a b
( 
numberOfLinks 
-  
numberInEachGroup! 2
*3 4
(5 6
numberOfUpperGroups6 I
-J K
$numL M
)M N
)N O
:P Q
( 
numberOfLinks 
-  
numberInEachGroup! 2
*3 4
numberOfUpperGroups5 H
)H I
;I J
List!! 
<!! 

ClickModel!! 
>!! 
clicks!! #
=!!$ %
new!!& )
List!!* .
<!!. /

ClickModel!!/ 9
>!!9 :
(!!: ;
)!!; <
;!!< =
int"" 
previousWhichOf3""  
=""! "
$num""# $
;""$ %
int## 
previousWhichOf5##  
=##! "
$num### $
;##$ %
for$$ 
($$ 
int$$ 
index$$ 
=$$ 
$num$$ 
;$$ 
index$$  %
<$$& '
numberOfLinks$$( 5
;$$5 6
index$$7 <
++$$< >
)$$> ?
{%% 

ClickModel&& 
click&&  
=&&! "
new&&# &

ClickModel&&' 1
(&&1 2
)&&2 3
{'' 
Index(( 
=(( 
index(( !
+((" #
$num(($ %
,((% &
Link)) 
=)) 
links))  
[))  !
index))! &
]))& '
}** 
;** 
click++ 
.++ 
GroupNumber++ !
=++" #
(++$ %
int++% (
)++( )
Math++) -
.++- .
Ceiling++. 5
(++5 6
(++6 7
double++7 =
)++= >
(++> ?
(++? @
index++@ E
)++E F
/++G H
numberInEachGroup++I Z
)++Z [
)++[ \
+++] ^
$num++_ `
;++` a
click,, 
.,, 
WhichOf3,, 
=,,  
click,,! &
.,,& '
GroupNumber,,' 2
>,,3 4
$num,,5 6
?,,7 8
$num,,9 :
:,,; <
click,,= B
.,,B C
GroupNumber,,C N
;,,N O
click-- 
.-- 
WhichOf5-- 
=--  
(--! "
previousWhichOf3--" 2
!=--3 5
click--6 ;
.--; <
WhichOf3--< D
)--D E
?--F G
$num--H I
:--J K
(--L M
previousWhichOf5--M ]
+--^ _
$num--` a
)--a b
;--b c
previousWhichOf3..  
=..! "
click..# (
...( )
WhichOf3..) 1
;..1 2
previousWhichOf5//  
=//! "
click//# (
.//( )
WhichOf5//) 1
;//1 2
click11 
.11 
Distribution311 #
=11$ %
GetSectionSpread11& 6
(116 7
$num117 8
,118 9
click11: ?
.11? @
WhichOf311@ H
)11H I
;11I J
click22 
.22 
Distribution522 #
=22$ %
GetSectionSpread22& 6
(226 7
$num227 8
,228 9
click22: ?
.22? @
WhichOf522@ H
)22H I
;22I J
click33 
.33 
Distribution5Half33 '
=33( )
(33* +
click33+ 0
.330 1
Distribution5331 >
/33? @
$num33A D
)33D E
;33E F
click44 
.44 
Distribution3544 $
=44% &
click44' ,
.44, -
Distribution344- :
*44; <
click44= B
.44B C
Distribution544C P
;44P Q
click55 
.55 
RandomOutOf10K55 $
=55% &
Random55' -
.55- .
Next55. 2
(552 3
(553 4
int554 7
)557 8
(558 9
click559 >
.55> ?
Distribution3555? M
*55N O
$num55P U
)55U V
,55V W
(55X Y
int55Y \
)55\ ]
(55] ^
click55^ c
.55c d
Distribution3555d r
*55s t
(55u v
$num55v w
+55x y
click55z 
.	55 Ä
Distribution5Half
55Ä ë
)
55ë í
*
55ì î
$num
55ï ö
)
55ö õ
)
55õ ú
;
55ú ù
clicks77 
.77 
Add77 
(77 
click77  
)77  !
;77! "
}88 
int99 
sumOfRandoms99 
=99 
clicks99 %
.99% &
Sum99& )
(99) *
x99* +
=>99, .
x99/ 0
.990 1
RandomOutOf10K991 ?
)99? @
;99@ A
clicks:: 
.:: 
ForEach:: 
(:: 
x:: 
=>:: 
x::  !
.::! "
ClickPercentage::" 1
=::2 3
(::4 5
double::5 ;
)::; <
x::< =
.::= >
RandomOutOf10K::> L
/::M N
sumOfRandoms::O [
)::[ \
;::\ ]
foreach== 
(== 
var== 
click== 
in== !
clicks==" (
)==( )
{>> 
double?? 
overRidePercentage?? )
=??* +
-??, -
$num??- .
;??. /
foreachAA 
(AA 
varAA 
kAA 
inAA !
keywordsAA" *
)AA* +
{BB 
ifCC 
(CC 
clickCC 
.CC 
LinkCC "
.CC" #
ContainsCC# +
(CC+ ,
kCC, -
.CC- .
KeywordCC. 5
)CC5 6
)CC6 7
{DD 
overRidePercentageEE *
=EE+ ,
kEE- .
.EE. /
RulePercentageEE/ =
/EE> ?
$numEE@ E
;EEE F
breakFF 
;FF 
}GG 
}HH 
ifII 
(II 
overRidePercentageII &
!=II' )
-II* +
$numII+ ,
)II, -
{JJ 
clickKK 
.KK 
ClickPercentageKK )
=KK* +
overRidePercentageKK, >
;KK> ?
}LL 
}MM 
clicksOO 
.OO 
ForEachOO 
(OO 
xOO 
=>OO 
xOO  !
.OO! "
ClicksOO" (
=OO) *
(OO+ ,
intOO, /
)OO/ 0
MathOO0 4
.OO4 5
CeilingOO5 <
(OO< =
xOO= >
.OO> ?
ClickPercentageOO? N
*OOP Q
clickCountTotalOOR a
)OOa b
)OOb c
;OOc d
returnQQ 
clicksQQ 
;QQ 
}RR 	
publicTT 
staticTT 
ListTT 
<TT 

ClickModelTT %
>TT% &"
GenerateClicksOutof100TT' =
(TT= >
ListTT> B
<TTB C
stringTTC I
>TTI J
linksTTK P
,TTP Q
longTTR V
clickCountTotalTTW f
,TTf g
ListTTh l
<TTl m
OpenModelKeywordTTm }
>TT} ~
keywords	TT á
)
TTá à
{UU 	
ListVV 
<VV 

ClickModelVV 
>VV 
clicksVV #
=VV$ %
newVV& )
ListVV* .
<VV. /

ClickModelVV/ 9
>VV9 :
(VV: ;
)VV; <
;VV< =
floatYY 
totalPercentageYY !
=YY" #
$numYY$ (
;YY( )
intZZ 
toOverRideCountZZ 
=ZZ  !
$numZZ" #
;ZZ# $
foreach[[ 
([[ 
var[[ 
l[[ 
in[[ 
links[[ #
)[[# $
{\\ 
foreach]] 
(]] 
var]] 
k]] 
in]] !
keywords]]" *
)]]* +
{^^ 
if__ 
(__ 
l__ 
.__ 
Contains__ "
(__" #
k__# $
.__$ %
Keyword__% ,
)__, -
)__- .
{`` 
totalPercentageaa '
=aa( )
totalPercentageaa* 9
-aa: ;
kaa< =
.aa= >
RulePercentageaa> L
;aaL M
toOverRideCountbb '
++bb' )
;bb) *
}cc 
}dd 
}ee 
intgg 
remainingPercentagegg #
=gg$ %
$numgg& )
;gg) *
inthh 
nonSocialLinkshh 
=hh  
linkshh! &
.hh& '
Counthh' ,
-hh- .
toOverRideCounthh/ >
;hh> ?
Listii 
<ii 
intii 
>ii 
numbersii 
;ii 
ifjj 
(jj 
nonSocialLinksjj 
==jj !
$numjj" #
)jj# $
numberskk 
=kk 
newkk 
Listkk "
<kk" #
intkk# &
>kk& '
(kk' (
)kk( )
{kk* +
$numkk, /
}kk0 1
;kk1 2
elsell 
ifll 
(ll 
nonSocialLinksll #
==ll$ &
$numll' (
)ll( )
{mm 
varoo 
num1oo 
=oo 
(oo 
intoo 
)oo  
(oo  !
Randomoo! '
.oo' (
Nextoo( ,
(oo, -
$numoo- 2
,oo2 3
$numoo4 9
)oo9 :
/oo; <
$numoo= C
)ooC D
;ooD E
numberspp 
=pp 
newpp 
Listpp "
<pp" #
intpp# &
>pp& '
(pp' (
)pp( )
{pp* +
num1pp, 0
,pp0 1
$numpp2 5
-pp6 7
num1pp8 <
}pp= >
;pp> ?
}qq 
elserr 
ifrr 
(rr 
nonSocialLinksrr #
==rr$ &
$numrr' (
)rr( )
{ss 
varuu 
num1uu 
=uu 
(uu 
intuu 
)uu  
(uu  !
Randomuu! '
.uu' (
Nextuu( ,
(uu, -
$numuu- 2
,uu2 3
$numuu4 9
)uu9 :
/uu; <
$numuu= C
)uuC D
;uuD E
varvv 
num2vv 
=vv 
(vv 
intvv 
)vv  
(vv  !
Randomvv! '
.vv' (
Nextvv( ,
(vv, -
$numvv- 2
,vv2 3
$numvv4 9
)vv9 :
/vv; <
$numvv= C
)vvC D
;vvD E
numbersww 
=ww 
newww 
Listww "
<ww" #
intww# &
>ww& '
(ww' (
)ww( )
{ww* +
num1ww, 0
,ww0 1
num2ww2 6
,ww6 7
$numww8 ;
-ww< =
num1ww> B
-wwC D
num2wwE I
}wwJ K
;wwK L
}xx 
elseyy 
numberszz 
=zz 

Randomizerzz $
.zz$ %

GetNumberszz% /
(zz/ 0
nonSocialLinkszz0 >
,zz> ?
remainingPercentagezz@ S
)zzS T
.zzT U
AsEnumerablezzU a
(zza b
)zzb c
.zzc d
OrderByDescendingzzd u
(zzu v
xzzv w
=>zzx z
xzz{ |
)zz| }
.zz} ~
ToList	zz~ Ñ
(
zzÑ Ö
)
zzÖ Ü
;
zzÜ á
int{{ 
index{{ 
={{ 
$num{{ 
;{{ 
foreach|| 
(|| 
var|| 
l|| 
in|| 
links|| #
)||# $
{}} 
var~~ 
m~~ 
=~~ 
new~~ 

ClickModel~~ &
(~~& '
)~~' (
{ 
Link
ÄÄ 
=
ÄÄ 
l
ÄÄ 
,
ÄÄ 
}
ÅÅ 
;
ÅÅ 
float
ÉÉ  
overRidePercentage
ÉÉ (
=
ÉÉ) *
-
ÉÉ+ ,
$num
ÉÉ, .
;
ÉÉ. /
foreach
ÖÖ 
(
ÖÖ 
var
ÖÖ 
k
ÖÖ 
in
ÖÖ !
keywords
ÖÖ" *
)
ÖÖ* +
{
ÜÜ 
if
áá 
(
áá 
l
áá 
.
áá 
Contains
áá "
(
áá" #
k
áá# $
.
áá$ %
Keyword
áá% ,
)
áá, -
)
áá- .
{
àà  
overRidePercentage
ââ *
=
ââ+ ,
k
ââ- .
.
ââ. /
RulePercentage
ââ/ =
;
ââ= >
break
ää 
;
ää 
}
ãã 
}
åå 
if
çç 
(
çç  
overRidePercentage
çç &
!=
çç' )
-
çç* +
$num
çç+ ,
)
çç, -
{
éé 
m
èè 
.
èè 
ClickPercentage
èè %
=
èè& ' 
overRidePercentage
èè( :
;
èè: ;
}
êê 
else
ëë 
{
íí 
m
ìì 
.
ìì 
ClickPercentage
ìì %
=
ìì& '
numbers
ìì( /
[
ìì/ 0
index
ìì0 5
]
ìì5 6
;
ìì6 7
index
îî 
++
îî 
;
îî 
}
ïï 
m
ññ 
.
ññ 
Clicks
ññ 
=
ññ 
(
ññ 
int
ññ 
)
ññ  
(
ññ  !
m
ññ! "
.
ññ" #
ClickPercentage
ññ# 2
/
ññ3 4
$num
ññ5 :
*
ññ; <
(
ññ= >
double
ññ> D
)
ññD E
clickCountTotal
ññE T
)
ññT U
;
ññU V
clicks
óó 
.
óó 
Add
óó 
(
óó 
m
óó 
)
óó 
;
óó 
}
òò 
return
öö 
clicks
öö 
;
öö 
}
õõ 	
public
ùù 
static
ùù 
List
ùù 
<
ùù 

ClickModel
ùù %
>
ùù% &.
 GenerateClicksStartFrom12Percent
ùù' G
(
ùùG H
List
ùùH L
<
ùùL M
string
ùùM S
>
ùùS T
links
ùùU Z
,
ùùZ [
long
ùù\ `
clickCountTotal
ùùa p
,
ùùp q
List
ùùr v
<
ùùv w
OpenModelKeywordùùw á
>ùùá à
keywordsùùâ ë
)ùùë í
{
ûû 	
double
üü 
firstPercentage
üü "
=
üü# $
(
üü% &
double
üü& ,
)
üü, -
(
üü- .
Random
üü. 4
.
üü4 5
Next
üü5 9
(
üü9 :
$num
üü: @
,
üü@ A
$num
üüB H
)
üüH I
)
üüI J
;
üüJ K
double
†† 

percentage
†† 
=
†† 
firstPercentage
††  /
;
††/ 0
List
°° 
<
°° 

ClickModel
°° 
>
°° 
clicks
°° #
=
°°$ %
new
°°& )
List
°°* .
<
°°. /

ClickModel
°°/ 9
>
°°9 :
(
°°: ;
)
°°; <
;
°°< =
foreach
¢¢ 
(
¢¢ 
var
¢¢ 
l
¢¢ 
in
¢¢ 
links
¢¢ #
)
¢¢# $
{
££ 
var
§§ 
m
§§ 
=
§§ 
new
§§ 

ClickModel
§§ &
(
§§& '
)
§§' (
{
•• 
Link
¶¶ 
=
¶¶ 
l
¶¶ 
,
¶¶ 
}
ßß 
;
ßß 
float
©©  
overRidePercentage
©© (
=
©©) *
-
©©+ ,
$num
©©, .
;
©©. /
foreach
´´ 
(
´´ 
var
´´ 
k
´´ 
in
´´ !
keywords
´´" *
)
´´* +
{
¨¨ 
if
≠≠ 
(
≠≠ 
l
≠≠ 
.
≠≠ 
Contains
≠≠ "
(
≠≠" #
k
≠≠# $
.
≠≠$ %
Keyword
≠≠% ,
)
≠≠, -
)
≠≠- .
{
ÆÆ  
overRidePercentage
ØØ *
=
ØØ+ ,
k
ØØ- .
.
ØØ. /
RulePercentage
ØØ/ =
;
ØØ= >
break
∞∞ 
;
∞∞ 
}
±± 
}
≤≤ 
if
≥≥ 
(
≥≥  
overRidePercentage
≥≥ &
!=
≥≥' )
-
≥≥* +
$num
≥≥+ ,
)
≥≥, -
{
¥¥ 
m
µµ 
.
µµ 
ClickPercentage
µµ %
=
µµ& ' 
overRidePercentage
µµ( :
;
µµ: ;
}
∂∂ 
else
∑∑ 
{
∏∏ 
m
ππ 
.
ππ 
ClickPercentage
ππ %
=
ππ& '

percentage
ππ( 2
/
ππ3 4
$num
ππ5 <
;
ππ< =

percentage
ªª 
=
ªª  
firstPercentage
ªª! 0
-
ªª1 2
(
ªª3 4
Random
ªª4 :
.
ªª: ;
Next
ªª; ?
(
ªª? @
$num
ªª@ D
,
ªªD E
(
ªªF G
int
ªªG J
)
ªªJ K
firstPercentage
ªªK Z
)
ªªZ [
)
ªª[ \
;
ªª\ ]
}
ºº 
m
ΩΩ 
.
ΩΩ 
Clicks
ΩΩ 
=
ΩΩ 
(
ΩΩ 
int
ΩΩ 
)
ΩΩ  
(
ΩΩ  !
m
ΩΩ! "
.
ΩΩ" #
ClickPercentage
ΩΩ# 2
/
ΩΩ3 4
$num
ΩΩ5 :
*
ΩΩ; <
(
ΩΩ= >
double
ΩΩ> D
)
ΩΩD E
clickCountTotal
ΩΩE T
)
ΩΩT U
;
ΩΩU V
clicks
ææ 
.
ææ 
Add
ææ 
(
ææ 
m
ææ 
)
ææ 
;
ææ 
}
øø 
return
¡¡ 
clicks
¡¡ 
;
¡¡ 
}
¬¬ 	
}
√√ 
}ƒƒ º2
QD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ReportingModel\Randomizer.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ReportingModel' 5
{ 
public 

class 

Randomizer 
{ 
public 
static 
void 
Test 
(  
)  !
{ 	
int		 
count		 
=		 
$num		 
;		 
int

 
[

 
]

 
numbers

 
=

 

GetNumbers

 &
(

& '
count

' ,
,

, -
$num

. 1
)

1 2
;

2 3
for 
( 
int 
index 
= 
$num 
; 
index  %
<& '
count( -
;- .
index/ 4
++4 6
)6 7
{ 
Console 
. 
Write 
( 
numbers %
[% &
index& +
]+ ,
), -
;- .
if 
( 
( 
index 
+ 
$num 
) 
%  !
$num" $
==% '
$num( )
)) *
Console 
. 
	WriteLine %
(% &
$str& (
)( )
;) *
else 
if 
( 
index 
!= !
count" '
-( )
$num* +
)+ ,
Console 
. 
Write !
(! "
$str" %
)% &
;& '
} 
Console 
. 
ReadKey 
( 
) 
; 
} 	
public 
static 
int 
[ 
] 

GetNumbers &
(& '
int' *
count+ 0
,0 1
int2 5
total6 ;
); <
{ 	
const 
int 

LOWERBOUND  
=! "
$num# $
;$ %
const 
int 

UPPERBOUND  
=! "
$num# %
;% &
int 
[ 
] 
result 
= 
new 
int "
[" #
count# (
]( )
;) *
int 

currentsum 
= 
$num 
; 
int 
low 
, 
high 
, 
calc 
;  
if 
( 
( 

UPPERBOUND 
* 
count #
)# $
<% &
total' ,
||- /
(   

LOWERBOUND   
*   
count   #
)  # $
>  % &
total  ' ,
||  - /

UPPERBOUND!! 
<!! 

LOWERBOUND!! '
)!!' (
throw"" 
new"" 
	Exception"" #
(""# $
$str""$ 3
)""3 4
;""4 5
Random$$ 
rnd$$ 
=$$ 
new$$ 
Random$$ #
($$# $
)$$$ %
;$$% &
for&& 
(&& 
int&& 
index&& 
=&& 
$num&& 
;&& 
index&&  %
<&&& '
count&&( -
;&&- .
index&&/ 4
++&&4 6
)&&6 7
{'' 
calc(( 
=(( 
((( 
total(( 
-(( 

currentsum((  *
)((* +
-((, -
(((. /

UPPERBOUND((/ 9
*((: ;
(((< =
count((= B
-((C D
$num((E F
-((G H
index((I N
)((N O
)((O P
;((P Q
low)) 
=)) 
calc)) 
<)) 

LOWERBOUND)) '
?))( )

LOWERBOUND))* 4
:))5 6
calc))7 ;
;)); <
calc** 
=** 
(** 
total** 
-** 

currentsum**  *
)*** +
-**, -
(**. /

LOWERBOUND**/ 9
***: ;
(**< =
count**= B
-**C D
$num**E F
-**G H
index**I N
)**N O
)**O P
;**P Q
high++ 
=++ 
calc++ 
>++ 

UPPERBOUND++ (
?++) *

UPPERBOUND+++ 5
:++6 7
calc++8 <
;++< =
result-- 
[-- 
index-- 
]-- 
=-- 
rnd--  #
.--# $
Next--$ (
(--( )
low--) ,
,--, -
high--. 2
+--3 4
$num--5 6
)--6 7
;--7 8

currentsum// 
+=// 
result// $
[//$ %
index//% *
]//* +
;//+ ,
}00 
int44 
shuffleCount44 
=44 
rnd44 "
.44" #
Next44# '
(44' (
count44( -
*44. /
$num440 1
,441 2
count443 8
*449 :
$num44; =
)44= >
;44> ?
while55 
(55 
shuffleCount55 
--55 !
>55" #
$num55$ %
)55% &
swap66 
(66 
ref66 
result66 
[66  
rnd66  #
.66# $
Next66$ (
(66( )
$num66) *
,66* +
count66, 1
)661 2
]662 3
,663 4
ref665 8
result669 ?
[66? @
rnd66@ C
.66C D
Next66D H
(66H I
$num66I J
,66J K
count66L Q
)66Q R
]66R S
)66S T
;66T U
return88 
result88 
;88 
}99 	
private;; 
static;; 
void;; 
swap;;  
(;;  !
ref;;! $
int;;% (
item1;;) .
,;;. /
ref;;0 3
int;;4 7
item2;;8 =
);;= >
{<< 	
int== 
temp== 
=== 
item1== 
;== 
item1>> 
=>> 
item2>> 
;>> 
item2?? 
=?? 
temp?? 
;?? 
}@@ 	
}AA 
}BB ÿ
^D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\TemplateReportDetailVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
public 

class "
TemplateReportDetailVm '
{ 
public 
string 
Link 
{ 
get  
;  !
set" %
;% &
}' (
public 
long 

ClickCount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
long 
UniqueCount 
{  !
get" %
;% &
set' *
;* +
}, -
public 
long 
MobileCount 
{  !
get" %
;% &
set' *
;* +
}, -
}

 
} çF
MD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Pdf\TemplateReportPdf.cs
	namespace

 	
ADSDataDirect


 
.

 
Infrastructure

 &
.

& '
TemplateReports

' 6
{ 
public 

class 
TemplateReportPdf "
{ 
readonly 
string 
DownloadPath $
=% &
HttpContext' 2
.2 3
Current3 :
.: ;
Server; A
.A B
MapPathB I
(I J
$"J L
~/DownloadsL W
"W X
)X Y
;Y Z
readonly 
string 
BootstrapPath %
=& '
HttpContext( 3
.3 4
Current4 ;
.; <
Server< B
.B C
MapPathC J
(J K
$"K M#
~/css/bootstrap.min.cssM d
"d e
)e f
;f g
public 
void 
Generate 
( 
CampaignTrackingVm /
model0 5
,5 6
string7 =
outputFilePath> L
,L M
stringN T
companyLogoU `
,` a
stringb h
screenshotFilePathi {
){ |
{ 	
string 

ImagesPath 
= 
HttpContext  +
.+ ,
Current, 3
.3 4
Server4 :
.: ;
MapPath; B
(B C
$"C E
~/imagesE M
"M N
)N O
;O P
string 
LogoFilePath 
=  !
string" (
.( )
IsNullOrEmpty) 6
(6 7
companyLogo7 B
)B C
? 
$" 
{ 

ImagesPath '
}' (
\\logoResized.png( 9
"9 :
:; <
$"= ?
{? @

ImagesPath@ J
}J K
\\K M
{M N
companyLogoN Y
}Y Z
"Z [
;[ \
StringBuilder 
html 
=  
new! $
StringBuilder% 2
(2 3
)3 4
;4 5
html 
. 
AppendFormat 
( 
$strt 
,tt 
BootstrapPathtt +
)tt+ ,
;tt, -
htmlvv 
.vv 
AppendFormatvv 
(vv 
$str	vé #
,
éé# $
DateTime
éé% -
.
éé- .
Now
éé. 1
.
éé1 2
ToString
éé2 :
(
éé: ;
StringConstants
éé; J
.
ééJ K
DateFormatSlashes
ééK \
)
éé\ ]
,
éé] ^
LogoFilePath
éé_ k
,
éék l
model
èè "
.
èè" #
Quantity
èè# +
,
èè+ ,
model
èè- 2
.
èè2 3
OpenedPercentage
èè3 C
,
èèC D
model
èèD I
.
èèI J
	StartDate
èèJ S
,
èèS T
model
èèU Z
.
èèZ [
ClickedPercentage
èè[ l
)
èèl m
;
èèm n
html
ëë 
.
ëë 
AppendFormat
ëë 
(
ëë 
$str
ë≠ #
,
≠≠# $
model
≠≠% *
.
≠≠* +
SubjectLine
≠≠+ 6
,
≠≠6 7
model
≠≠8 =
.
≠≠= >#
ClickToOpenPercentage
≠≠> S
,
≠≠S T
model
ÆÆ "
.
ÆÆ" #
FromLine
ÆÆ# +
,
ÆÆ+ ,
model
ÆÆ- 2
.
ÆÆ2 3

WhiteLabel
ÆÆ3 =
,
ÆÆ= >
model
ÆÆ? D
.
ÆÆD E
IoNumber
ÆÆE M
,
ÆÆM N
model
ÆÆO T
.
ÆÆT U
CampaignName
ÆÆU a
)
ÆÆa b
;
ÆÆb c
html
∞∞ 
.
∞∞ 
AppendFormat
∞∞ 
(
∞∞ 
$str
∞Ë #
,
ËË# $
model
ÈÈ "
.
ÈÈ" #$
RetargetingImpressions
ÈÈ# 9
,
ÈÈ9 :
model
ÈÈ; @
.
ÈÈ@ A
RetargetingClicks
ÈÈA R
,
ÈÈR S
model
ÍÍ "
.
ÍÍ" #
Quantity
ÍÍ# +
,
ÍÍ+ ,
model
ÍÍ- 2
.
ÍÍ2 3
Opened
ÍÍ3 9
,
ÍÍ9 :
model
ÍÍ; @
.
ÍÍ@ A
Desktop
ÍÍA H
,
ÍÍH I
model
ÍÍJ O
.
ÍÍO P
Mobile
ÍÍP V
,
ÍÍV W
model
ÎÎ "
.
ÎÎ" #
Clicked
ÎÎ# *
,
ÎÎ* +
model
ÎÎ, 1
.
ÎÎ1 2
ClickedPercentage
ÎÎ2 C
,
ÎÎC D
model
ÎÎE J
.
ÎÎJ K#
ClickToOpenPercentage
ÎÎK `
,
ÎÎ` a
model
ÏÏ "
.
ÏÏ" #
Bounce
ÏÏ# )
,
ÏÏ) *
model
ÏÏ+ 0
.
ÏÏ0 1
Opt
ÏÏ1 4
)
ÌÌ 
;
ÌÌ 
foreach
ÔÔ 
(
ÔÔ 
var
ÔÔ 
item
ÔÔ 
in
ÔÔ  
model
ÔÔ! &
.
ÔÔ& '
PerLink
ÔÔ' .
)
ÔÔ. /
{
 
html
ÒÒ 
.
ÒÒ 
AppendFormat
ÒÒ !
(
ÒÒ! "
$str
Òı" #
,
ıı# $
item
ıı% )
.
ıı) *
Link
ıı* .
,
ıı. /
item
ıı0 4
.
ıı4 5

ClickCount
ıı5 ?
)
ıı? @
;
ıı@ A
}
ˆˆ 
html
¯¯ 
.
¯¯ 
AppendFormat
¯¯ 
(
¯¯ 
$str
¯â 
,
ââ 	 
screenshotFilePath
ââ
 
)
ââ 
;
ââ 
string
ãã 

htmlString
ãã 
=
ãã 
html
ãã  $
.
ãã$ %
ToString
ãã% -
(
ãã- .
)
ãã. /
;
ãã/ 0
	HtmlToPdf
çç 
(
çç 

htmlString
çç  
,
çç  !
outputFilePath
çç" 0
,
çç0 1
true
çç2 6
)
çç6 7
;
çç7 8
}
èè 	
public
ëë 
void
ëë 
	HtmlToPdf
ëë 
(
ëë 
string
ëë $
html
ëë% )
,
ëë) *
string
ëë+ 1
filePath
ëë2 :
,
ëë: ;
bool
ëë< @
isLandscape
ëëA L
)
ëëL M
{
íí 	
try
ìì 
{
îî 
var
ïï 
	htmlToPdf
ïï 
=
ïï 
new
ïï  #
NReco
ïï$ )
.
ïï) *
PdfGenerator
ïï* 6
.
ïï6 7 
HtmlToPdfConverter
ïï7 I
(
ïïI J
)
ïïJ K
{
ññ 
Quiet
óó 
=
óó 
false
óó !
,
óó! "
}
òò 
;
òò 
	htmlToPdf
öö 
.
öö 
CustomWkHtmlArgs
öö *
=
öö+ ,
$str
öö- S
;
ööS T
if
õõ 
(
õõ 
isLandscape
õõ 
)
õõ 
	htmlToPdf
úú 
.
úú 
CustomWkHtmlArgs
úú .
+=
úú/ 1
$str
úú2 B
;
úúB C
	htmlToPdf
ûû 
.
ûû 
LogReceived
ûû %
+=
ûû& (#
HtmlToPdf_LogReceived
ûû) >
;
ûû> ?
var
üü 
pdfBytes
üü 
=
üü 
	htmlToPdf
üü (
.
üü( )
GeneratePdf
üü) 4
(
üü4 5
html
üü5 9
)
üü9 :
;
üü: ;
using
°° 
(
°° 
var
°° 

fileStream
°° %
=
°°& '
System
°°( .
.
°°. /
IO
°°/ 1
.
°°1 2
File
°°2 6
.
°°6 7
Create
°°7 =
(
°°= >
filePath
°°> F
)
°°F G
)
°°G H
{
¢¢ 

fileStream
££ 
.
££ 
Write
££ $
(
££$ %
pdfBytes
££% -
,
££- .
$num
££/ 0
,
££0 1
pdfBytes
££2 :
.
££: ;
Length
££; A
)
££A B
;
££B C
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
ßß 
throw
®® 
ex
®® 
;
®® 
}
©© 
}
™™ 	
private
¨¨ 
void
¨¨ #
HtmlToPdf_LogReceived
¨¨ *
(
¨¨* +
object
¨¨+ 1
sender
¨¨2 8
,
¨¨8 9
System
¨¨: @
.
¨¨@ A
Diagnostics
¨¨A L
.
¨¨L M#
DataReceivedEventArgs
¨¨M b
e
¨¨c d
)
¨¨d e
{
≠≠ 	
string
ÆÆ 

PDFLogPath
ÆÆ 
=
ÆÆ 
DownloadPath
ÆÆ  ,
+
ÆÆ- .
$str
ÆÆ/ >
;
ÆÆ> ?
try
ØØ 
{
ØØ 
System
∞∞ 
.
∞∞ 
IO
∞∞ 
.
∞∞ 
File
∞∞ 
.
∞∞ 
AppendAllText
∞∞ ,
(
∞∞, -

PDFLogPath
∞∞- 7
,
∞∞7 8
e
∞∞9 :
.
∞∞: ;
Data
∞∞; ?
)
∞∞? @
;
∞∞@ A
}
±± 
catch
≤≤ 
{
≥≥ 
}
µµ 
}
∂∂ 	
}
∑∑ 
}∏∏ õ
XD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\TemplateReportVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
public		 

class		 
TemplateReportVm		 !
{

 
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 

TrackingId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Quantity 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	OrderDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
DateSent 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	SentOrder 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 
IsCreatedThroughApi '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
QueuedCampaignId &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	StartDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Deployed 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Opened 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Clicked 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Unsub 
{ 
get !
;! "
set# &
;& '
}( )
public   
string   
Forwards   
{    
get  ! $
;  $ %
set  & )
;  ) *
}  + ,
public!! 
string!! 
DeliveryPercentage!! (
{!!) *
get!!+ .
;!!. /
set!!0 3
;!!3 4
}!!5 6
public"" 
string"" 
OpenedPercentage"" &
{""' (
get"") ,
;"", -
set"". 1
;""1 2
}""3 4
public## 
string## 
ClickedPercentage## '
{##( )
get##* -
;##- .
set##/ 2
;##2 3
}##4 5
public$$ 
string$$ 
UnsubPercentage$$ %
{$$& '
get$$( +
;$$+ ,
set$$- 0
;$$0 1
}$$2 3
public%% 
string%% !
ClickToOpenPercentage%% +
{%%, -
get%%. 1
;%%1 2
set%%3 6
;%%6 7
}%%8 9
public&& 
string&& !
UnsubToOpenPercentage&& +
{&&, -
get&&. 1
;&&1 2
set&&3 6
;&&6 7
}&&8 9
public'' 
string'' 
Bounce'' 
{'' 
get'' "
;''" #
set''$ '
;''' (
}'') *
public(( 
string(( 
Opt(( 
{(( 
get(( 
;((  
set((! $
;(($ %
}((& '
public)) 
string)) 
Desktop)) 
{)) 
get))  #
;))# $
set))% (
;))( )
}))* +
public** 
string** 
Mobile** 
{** 
get** "
;**" #
set**$ '
;**' (
}**) *
public,, 
bool,, 
IsRetargeting,, !
{,," #
get,,$ '
;,,' (
set,,) ,
;,,, -
},,. /
public-- 
string-- "
RetargetingImpressions-- ,
{--- .
get--/ 2
;--2 3
set--4 7
;--7 8
}--9 :
public.. 
string.. 
RetargetingClicks.. '
{..( )
get..* -
;..- .
set../ 2
;..2 3
}..4 5
public00 
List00 
<00 "
TemplateReportDetailVm00 *
>00* +
PerLink00, 3
{004 5
get006 9
;009 :
set00; >
;00> ?
}00@ A
public11 
List11 
<11 
CampaignSegmentVm11 %
>11% &
Segments11' /
{110 1
get112 5
;115 6
set117 :
;11: ;
}11< =
public33 
static33 
TemplateReportVm33 & 
FromCampaignTracking33' ;
(33; <
Campaign33< D
campaign33E M
,33M N
CampaignTracking33O _
campaignTracking33` p
)33p q
{44 	
var55 
model55 
=55 
new55 
TemplateReportVm55 ,
{66 

CampaignId77 
=77 
campaign77 %
.77% &
Id77& (
.77( )
ToString77) 1
(771 2
)772 3
,773 4

TrackingId88 
=88 
campaignTracking88 -
.88- .
Id88. 0
.880 1
ToString881 9
(889 :
)88: ;
,88; <
OrderNumber99 
=99 
string99 $
.99$ %
IsNullOrEmpty99% 2
(992 3
campaignTracking993 C
.99C D
SegmentNumber99D Q
)99Q R
?99S T
campaignTracking99U e
.99e f
OrderNumber99f q
:99r s
campaignTracking	99t Ñ
.
99Ñ Ö
SegmentNumber
99Ö í
,
99í ì
CampaignName:: 
=:: 
campaign:: '
.::' (
Approved::( 0
.::0 1
CampaignName::1 =
,::= >

WhiteLabel;; 
=;; 
campaign;; %
.;;% &
Approved;;& .
.;;. /

WhiteLabel;;/ 9
,;;9 :
SubjectLine<< 
=<< 
campaign<< &
.<<& '
Approved<<' /
.<</ 0
SubjectLine<<0 ;
,<<; <
FromLine== 
=== 
campaign== #
.==# $
Approved==$ ,
.==, -
FromLine==- 5
,==5 6
Quantity>> 
=>> 
campaignTracking>> +
.>>+ ,
Quantity>>, 4
.>>4 5
ToString>>5 =
(>>= >
)>>> ?
,>>? @
Status?? 
=?? 
(?? 
(?? 
CampaignStatus?? )
)??) *
campaign??* 2
.??2 3
Status??3 9
)??9 :
.??: ;
ToString??; C
(??C D
)??D E
,??E F
	OrderDate@@ 
=@@ 
campaign@@ $
.@@$ %
	CreatedAt@@% .
.@@. /
ToString@@/ 7
(@@7 8
StringConstants@@8 G
.@@G H
DateFormatSlashes@@H Y
)@@Y Z
,@@Z [
DateSentAA 
=AA 
campaignTrackingAA +
.AA+ ,
	CreatedAtAA, 5
.AA5 6
ToStringAA6 >
(AA> ?
StringConstantsAA? N
.AAN O
DateFormatSlashesAAO `
)AA` a
,AAa b
	SentOrderBB 
=BB 
campaignTrackingBB ,
.BB, -
	SentOrderBB- 6
,BB6 7
IsCreatedThroughApiCC #
=CC$ %
campaignTrackingCC& 6
.CC6 7
IsCreatedThroughApiCC7 J
,CCJ K
QueuedCampaignIdDD  
=DD! "
campaignTrackingDD# 3
.DD3 4
QueuedCampaignIdDD4 D
,DDD E
IoNumberFF 
=FF 
campaignTrackingFF +
.FF+ ,
IoNumberFF, 4
,FF4 5
	StartDateGG 
=GG 
campaignTrackingGG ,
.GG, -
	StartDateGG- 6
?GG6 7
.GG7 8
ToStringGG8 @
(GG@ A
StringConstantsGGA P
.GGP Q
DateFormatSlashesGGQ b
)GGb c
,GGc d
DeployedHH 
=HH 
campaignTrackingHH +
.HH+ ,
DeployedHH, 4
.HH4 5
ToStringHH5 =
(HH= >
)HH> ?
,HH? @
OpenedII 
=II 
campaignTrackingII )
.II) *
OpenedII* 0
.II0 1
ToStringII1 9
(II9 :
)II: ;
,II; <
ClickedJJ 
=JJ 
campaignTrackingJJ *
.JJ* +
ClickedJJ+ 2
.JJ2 3
ToStringJJ3 ;
(JJ; <
)JJ< =
,JJ= >
UnsubKK 
=KK 
campaignTrackingKK (
.KK( )
UnsubKK) .
.KK. /
ToStringKK/ 7
(KK7 8
)KK8 9
,KK9 :
ForwardsLL 
=LL 
campaignTrackingLL +
.LL+ ,
ForwardsLL, 4
.LL4 5
ToStringLL5 =
(LL= >
)LL> ?
,LL? @
BounceMM 
=MM 
campaignTrackingMM )
.MM) *
BounceMM* 0
.MM0 1
ToStringMM1 9
(MM9 :
)MM: ;
,MM; <
OptNN 
=NN 
campaignTrackingNN &
.NN& '
OptNN' *
.NN* +
ToStringNN+ 3
(NN3 4
)NN4 5
,NN5 6
DesktopOO 
=OO 
campaignTrackingOO *
.OO* +
DesktopOO+ 2
.OO2 3
ToStringOO3 ;
(OO; <
)OO< =
,OO= >
MobilePP 
=PP 
campaignTrackingPP )
.PP) *
MobilePP* 0
.PP0 1
ToStringPP1 9
(PP9 :
)PP: ;
,PP; <
IsRetargetingQQ 
=QQ 
campaignQQ  (
.QQ( )
ApprovedQQ) 1
.QQ1 2
ReBroadCastQQ2 =
,QQ= >"
RetargetingImpressionsRR &
=RR' (
campaignTrackingRR) 9
.RR9 :"
RetargetingImpressionsRR: P
.RRP Q
ToStringRRQ Y
(RRY Z
)RRZ [
,RR[ \
RetargetingClicksSS !
=SS" #
campaignTrackingSS$ 4
.SS4 5
RetargetingClicksSS5 F
.SSF G
ToStringSSG O
(SSO P
)SSP Q
,SSQ R
DeliveryPercentageUU "
=UU# $
campaignTrackingUU% 5
.UU5 6
DeliveryPercentageUU6 H
.UUH I
ToStringUUI Q
(UUQ R
$strUUR Z
)UUZ [
,UU[ \
OpenedPercentageVV  
=VV! "
campaignTrackingVV# 3
.VV3 4
OpenedPercentageVV4 D
.VVD E
ToStringVVE M
(VVM N
$strVVN V
)VVV W
,VVW X
ClickedPercentageWW !
=WW" #
campaignTrackingWW$ 4
.WW4 5
ClickedPercentageWW5 F
.WWF G
ToStringWWG O
(WWO P
$strWWP X
)WWX Y
,WWY Z
UnsubPercentageXX 
=XX  !
campaignTrackingXX" 2
.XX2 3
UnsubPercentageXX3 B
.XXB C
ToStringXXC K
(XXK L
$strXXL T
)XXT U
,XXU V!
ClickToOpenPercentageYY %
=YY& '
campaignTrackingYY( 8
.YY8 9!
ClickToOpenPercentageYY9 N
.YYN O
ToStringYYO W
(YYW X
$strYYX `
)YY` a
,YYa b!
UnsubToOpenPercentageZZ %
=ZZ& '
campaignTrackingZZ( 8
.ZZ8 9!
UnsubToOpenPercentageZZ9 N
.ZZN O
ToStringZZO W
(ZZW X
$strZZX `
)ZZ` a
,ZZa b
Segments[[ 
=[[ 
new[[ 
List[[ #
<[[# $
CampaignSegmentVm[[$ 5
>[[5 6
([[6 7
)[[7 8
,[[8 9
PerLink\\ 
=\\ 
new\\ 
List\\ "
<\\" #"
TemplateReportDetailVm\\# 9
>\\9 :
(\\: ;
)\\; <
}]] 
;]] 
model__ 
.__ 
Segments__ 
=__ 
campaign__ %
.__% &
Segments__& .
.__. /
Where__/ 4
(__4 5
x__5 6
=>__7 9
!__: ;
string__; A
.__A B
IsNullOrEmpty__B O
(__O P
x__P Q
.__Q R
SegmentDataFileUrl__R d
)__d e
)__e f
.`` 
Select`` #
(``# $
x``$ %
=>``& (
new``) ,
CampaignSegmentVm``- >
(``> ?
)``? @
{aa 
SegmentNumberbb  -
=bb. /
xbb0 1
.bb1 2
SegmentNumberbb2 ?
,bb? @
SegmentDataFileUrlcc  2
=cc3 4
xcc5 6
.cc6 7
SegmentDataFileUrlcc7 I
}dd 
)dd 
.dd 
OrderBydd &
(dd& '
xdd' (
=>dd) +
xdd, -
.dd- .
SegmentNumberdd. ;
)dd; <
.dd< =
ToListdd= C
(ddC D
)ddD E
;ddE F
varee 
proDatasee 
=ee 
campaignee #
.ee# $
ProDatasee$ ,
.ff 
Whereff 
(ff 
xff 
=>ff 
xff 
.ff 
OrderNumberff )
==ff* ,
campaignTrackingff- =
.ff= >
OrderNumberff> I
&&ffJ L
xffM N
.ffN O
SegmentNumberffO \
==ff] _
campaignTrackingff` p
.ffp q
SegmentNumberffq ~
)ff~ 
.gg 
OrderByDescendinggg "
(gg" #
xgg# $
=>gg% '
xgg( )
.gg) *

ClickCountgg* 4
)gg4 5
;gg5 6
foreachkk 
(kk 
varkk 
proDatakk  
inkk! #
proDataskk$ ,
)kk, -
{ll 
modelmm 
.mm 
PerLinkmm 
.mm 
Addmm !
(mm! "
newmm" %"
TemplateReportDetailVmmm& <
(mm< =
)mm= >
{nn 
Linkoo 
=oo 
proDataoo "
.oo" #
Destination_URLoo# 2
,oo2 3

ClickCountpp 
=pp  
proDatapp! (
.pp( )

ClickCountpp) 3
,pp3 4
UniqueCountqq 
=qq  !
proDataqq" )
.qq) *
	UniqueCntqq* 3
,qq3 4
MobileCountrr 
=rr  !
proDatarr" )
.rr) *
	MobileCntrr* 3
}ss 
)ss 
;ss 
}tt 
returnvv 
modelvv 
;vv 
}ww 	
}xx 
}yy °
KD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Emails\EmailChecker.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Emails' -
{ 
public 

static 
class 
EmailChecker $
{ 
private		 
static		 
bool		 
_invalid		 $
=		% &
false		' ,
;		, -
public 
static 
bool 
IsValidEmail '
(' (
string( .
strIn/ 4
)4 5
{ 	
_invalid 
= 
false 
; 
if 
( 
string 
. 
IsNullOrEmpty $
($ %
strIn% *
)* +
)+ ,
return 
false 
; 
try 
{ 
strIn 
= 
Regex 
. 
Replace %
(% &
strIn& +
,+ ,
$str- 8
,8 9
DomainMapper: F
,F G
RegexOptions& 2
.2 3
None3 7
,7 8
TimeSpan9 A
.A B
FromMillisecondsB R
(R S
$numS V
)V W
)W X
;X Y
} 
catch 
( &
RegexMatchTimeoutException -
)- .
{ 
return 
false 
; 
} 
try 
{ 
return 
Regex 
. 
IsMatch $
($ %
strIn% *
,* +
$str   y
+  z {
$str!! {
,!!{ |
RegexOptions"" "
.""" #

IgnoreCase""# -
,""- .
TimeSpan""/ 7
.""7 8
FromMilliseconds""8 H
(""H I
$num""I L
)""L M
)""M N
;""N O
}## 
catch$$ 
($$ &
RegexMatchTimeoutException$$ -
)$$- .
{%% 
return&& 
false&& 
;&& 
}'' 
}(( 	
private** 
static** 
string** 
DomainMapper** *
(*** +
Match**+ 0
match**1 6
)**6 7
{++ 	

IdnMapping-- 
idn-- 
=-- 
new--  

IdnMapping--! +
(--+ ,
)--, -
;--- .
string// 

domainName// 
=// 
match//  %
.//% &
Groups//& ,
[//, -
$num//- .
]//. /
./// 0
Value//0 5
;//5 6
try00 
{11 

domainName22 
=22 
idn22  
.22  !
GetAscii22! )
(22) *

domainName22* 4
)224 5
;225 6
}33 
catch44 
(44 
ArgumentException44 $
)44$ %
{55 
_invalid66 
=66 
true66 
;66  
}77 
return88 
match88 
.88 
Groups88 
[88  
$num88  !
]88! "
.88" #
Value88# (
+88) *

domainName88+ 5
;885 6
}99 	
}:: 
};; «b
ID:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Excel\ExcelHelper.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

static 
class 
ExcelHelper #
{ 
public 
static 
Cell 
GetCell "
(" #
	Worksheet# ,
	worksheet- 6
,6 7
string8 >

columnName? I
,I J
uintK O
rowIndexP X
)X Y
{ 	
Row 
row 
= 
GetRow 
( 
	worksheet &
,& '
rowIndex( 0
)0 1
;1 2
if 
( 
row 
!= 
null 
) 
return 
row 
. 
Elements #
<# $
Cell$ (
>( )
() *
)* +
.+ ,
FirstOrDefault, :
(: ;
c; <
=>= ?
string@ F
.F G
CompareG N
(N O
cO P
.P Q
CellReferenceQ ^
.^ _
Value_ d
,d e

columnNamef p
+q r
rowIndexs {
,{ |
true	} Å
)
Å Ç
==
É Ö
$num
Ü á
)
á à
;
à â
var 
newRow 
= 
ExcelHelper_Old (
.( )
	InsertRow) 2
(2 3
rowIndex3 ;
,; <
	worksheet= F
.F G
WorksheetPartG T
,T U
nullV Z
,Z [
false\ a
)a b
;b c
return 
newRow 
. 
Elements "
<" #
Cell# '
>' (
(( )
)) *
.* +
FirstOrDefault+ 9
(9 :
c: ;
=>< >
string? E
.E F
CompareF M
(M N
cN O
.O P
CellReferenceP ]
.] ^
Value^ c
,c d

columnNamee o
+p q
rowIndexr z
,z {
true	| Ä
)
Ä Å
==
Ç Ñ
$num
Ö Ü
)
Ü á
;
á à
} 	
public 
static 
void 

DeleteRows %
(% &
uint& *
rowIndex+ 3
,3 4
int5 8
count9 >
,> ?
	SheetData@ I
	sheetDataJ S
)S T
{ 	
foreach 
( 
var 
row 
in 
	sheetData  )
.) *
Elements* 2
<2 3
Row3 6
>6 7
(7 8
)8 9
.9 :
Where: ?
(? @
r@ A
=>B D
rE F
.F G
RowIndexG O
.O P
ValueP U
>=V X
rowIndexY a
&&b d
re f
.f g
RowIndexg o
.o p
Valuep u
<=v x
rowIndex	y Å
+
Ç É
count
Ñ â
)
â ä
.
ä ã
ToList
ã ë
(
ë í
)
í ì
)
ì î
{   
row!! 
.!! 
Remove!! 
(!! 
)!! 
;!! 
}"" 
}## 	
public%% 
static%% 
Row%% 
GetRow%%  
(%%  !
	Worksheet%%! *
	worksheet%%+ 4
,%%4 5
uint%%6 :
rowIndex%%; C
)%%C D
{&& 	
return'' 
	worksheet'' 
.'' 
GetFirstChild'' *
<''* +
	SheetData''+ 4
>''4 5
(''5 6
)''6 7
.''7 8
Elements''8 @
<''@ A
Row''A D
>''D E
(''E F
)''F G
.''G H
FirstOrDefault''H V
(''V W
r''W X
=>''Y [
r''\ ]
.''] ^
RowIndex''^ f
==''g i
rowIndex''j r
)''r s
;''s t
}(( 	
public** 
static** 
void** 
AddImage** #
(**# $
WorksheetPart**$ 1
worksheetPart**2 ?
,**? @
string**A G
imageFilePath**H U
,**U V
int**W Z
	rowNumber**[ d
,**d e
int**f i
	colNumber**j s
)**s t
{++ 	
Bitmap,, 
bm,, 
=,, 
new,, 
Bitmap,, "
(,," #
imageFilePath,,# 0
),,0 1
;,,1 2
DocumentFormat-- 
.-- 
OpenXml-- "
.--" #
Drawing--# *
.--* +
Extents--+ 2
extents--3 :
=--; <
new--= @
DocumentFormat--A O
.--O P
OpenXml--P W
.--W X
Drawing--X _
.--_ `
Extents--` g
(--g h
)--h i
;--i j
var.. 
	extentsCx.. 
=.. 
(.. 
long.. !
)..! "
bm.." $
...$ %
Width..% *
*..+ ,
(..- .
long... 2
)..2 3
(..3 4
(..4 5
float..5 :
)..: ;
$num..; A
/..B C
bm..D F
...F G 
HorizontalResolution..G [
)..[ \
;..\ ]
var// 
	extentsCy// 
=// 
(// 
long// !
)//! "
bm//" $
.//$ %
Height//% +
*//, -
(//. /
long/// 3
)//3 4
(//4 5
(//5 6
float//6 ;
)//; <
$num//< B
///C D
bm//E G
.//G H
VerticalResolution//H Z
)//Z [
;//[ \
bm00 
.00 
Dispose00 
(00 
)00 
;00 
var22 
	colOffset22 
=22 
$num22 
;22 
var33 
	rowOffset33 
=33 
$num33 
;33 
var77 
drawingsPart77 
=77 
worksheetPart77 ,
.77, -
DrawingsPart77- 9
;779 :
var88 
worksheetDrawing88  
=88! "
drawingsPart88# /
.88/ 0
WorksheetDrawing880 @
;88@ A
var:: 
	imagePart:: 
=:: 
drawingsPart:: (
.::( )
AddImagePart::) 5
(::5 6
ImagePartType::6 C
.::C D
Jpeg::D H
)::H I
;::I J
using<< 
(<< 
var<< 
stream<< 
=<< 
new<<  #

FileStream<<$ .
(<<. /
imageFilePath<</ <
,<<< =
FileMode<<> F
.<<F G
Open<<G K
)<<K L
)<<L M
{== 
	imagePart>> 
.>> 
FeedData>> "
(>>" #
stream>># )
)>>) *
;>>* +
}?? 
varAA 
nvpsAA 
=AA 
worksheetDrawingAA '
.AA' (
DescendantsAA( 3
<AA3 4
XdrAA4 7
.AA7 8&
NonVisualDrawingPropertiesAA8 R
>AAR S
(AAS T
)AAT U
;AAU V
varBB 
nvpIdBB 
=BB 
nvpsBB 
.BB 
CountBB "
(BB" #
)BB# $
>BB% &
$numBB' (
?BB) *
(CC 
UInt32ValueCC 
)CC 
worksheetDrawingCC -
.CC- .
DescendantsCC. 9
<CC9 :
XdrCC: =
.CC= >&
NonVisualDrawingPropertiesCC> X
>CCX Y
(CCY Z
)CCZ [
.CC[ \
MaxCC\ _
(CC_ `
pCC` a
=>CCb d
pCCe f
.CCf g
IdCCg i
.CCi j
ValueCCj o
)CCo p
+CCq r
$numCCs t
:CCu v
$numDD 
;DD 
varFF 
oneCellAnchorFF 
=FF 
newFF  #
XdrFF$ '
.FF' (
OneCellAnchorFF( 5
(FF5 6
newGG 
XdrGG 
.GG 

FromMarkerGG "
{HH 
ColumnIdII 
=II 
newII "
XdrII# &
.II& '
ColumnIdII' /
(II/ 0
(II0 1
	colNumberII1 :
-II; <
$numII= >
)II> ?
.II? @
ToStringII@ H
(IIH I
)III J
)IIJ K
,IIK L
RowIdJJ 
=JJ 
newJJ 
XdrJJ  #
.JJ# $
RowIdJJ$ )
(JJ) *
(JJ* +
	rowNumberJJ+ 4
-JJ5 6
$numJJ7 8
)JJ8 9
.JJ9 :
ToStringJJ: B
(JJB C
)JJC D
)JJD E
,JJE F
ColumnOffsetKK  
=KK! "
newKK# &
XdrKK' *
.KK* +
ColumnOffsetKK+ 7
(KK7 8
	colOffsetKK8 A
.KKA B
ToStringKKB J
(KKJ K
)KKK L
)KKL M
,KKM N
	RowOffsetLL 
=LL 
newLL  #
XdrLL$ '
.LL' (
	RowOffsetLL( 1
(LL1 2
	rowOffsetLL2 ;
.LL; <
ToStringLL< D
(LLD E
)LLE F
)LLF G
}MM 
,MM 
newNN 
XdrNN 
.NN 
ExtentNN 
{NN  
CxNN! #
=NN$ %
	extentsCxNN& /
,NN/ 0
CyNN1 3
=NN4 5
	extentsCyNN6 ?
}NN@ A
,NNA B
newOO 
XdrOO 
.OO 
PictureOO 
(OO  
newPP 
XdrPP 
.PP &
NonVisualPicturePropertiesPP 6
(PP6 7
newQQ 
XdrQQ 
.QQ  &
NonVisualDrawingPropertiesQQ  :
{QQ; <
IdQQ= ?
=QQ@ A
nvpIdQQB G
,QQG H
NameQQI M
=QQN O
$strQQP Z
+QQ[ \
nvpIdQQ] b
,QQb c
DescriptionQQd o
=QQp q
imageFilePathQQr 
}
QQÄ Å
,
QQÅ Ç
newRR 
XdrRR 
.RR  -
!NonVisualPictureDrawingPropertiesRR  A
(RRA B
newRRB E
ARRF G
.RRG H
PictureLocksRRH T
{RRU V
NoChangeAspectRRW e
=RRf g
trueRRh l
}RRm n
)RRn o
)SS 
,SS 
newTT 
XdrTT 
.TT 
BlipFillTT $
(TT$ %
newUU 
AUU 
.UU 
BlipUU "
{UU# $
EmbedUU% *
=UU+ ,
drawingsPartUU- 9
.UU9 :
GetIdOfPartUU: E
(UUE F
	imagePartUUF O
)UUO P
,UUP Q
CompressionStateUUR b
=UUc d
AUUe f
.UUf g!
BlipCompressionValuesUUg |
.UU| }
Print	UU} Ç
}
UUÉ Ñ
,
UUÑ Ö
newVV 
AVV 
.VV 
StretchVV %
(VV% &
newVV& )
AVV* +
.VV+ ,
FillRectangleVV, 9
(VV9 :
)VV: ;
)VV; <
)WW 
,WW 
newXX 
XdrXX 
.XX 
ShapePropertiesXX +
(XX+ ,
newYY 
AYY 
.YY 
Transform2DYY )
(YY) *
newZZ 
AZZ  !
.ZZ! "
OffsetZZ" (
{ZZ) *
XZZ+ ,
=ZZ- .
$numZZ/ 0
,ZZ0 1
YZZ2 3
=ZZ4 5
$numZZ6 7
}ZZ8 9
,ZZ9 :
new[[ 
A[[  !
.[[! "
Extents[[" )
{[[* +
Cx[[, .
=[[/ 0
	extentsCx[[1 :
,[[: ;
Cy[[< >
=[[? @
	extentsCy[[A J
}[[K L
)\\ 
,\\ 
new]] 
A]] 
.]] 
PresetGeometry]] ,
{]]- .
Preset]]/ 5
=]]6 7
A]]8 9
.]]9 :
ShapeTypeValues]]: I
.]]I J
	Rectangle]]J S
}]]T U
)^^ 
)__ 
,__ 
new`` 
Xdr`` 
.`` 

ClientData`` "
(``" #
)``# $
)aa 
;aa 
worksheetDrawingbb 
.bb 
Appendbb #
(bb# $
oneCellAnchorbb$ 1
)bb1 2
;bb2 3
}
ÇÇ 	
}
ÑÑ 
}ÖÖ æÔ
MD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Excel\ExcelHelper_Old.cs
	namespace

 	
ADSDataDirect


 
.

 
Web

 
.

 
Helpers

 #
{ 
public 

static 
class 
ExcelHelper_Old '
{ 
public 
static 
Row 
	InsertRow #
(# $
uint$ (
rowIndex) 1
,1 2
WorksheetPart3 @
worksheetPartA N
,N O
RowP S
	insertRowT ]
,] ^
bool_ c
isNewLastRowd p
=q r
falses x
)x y
{ 	
	Worksheet 
	worksheet 
=  !
worksheetPart" /
./ 0
	Worksheet0 9
;9 :
	SheetData 
	sheetData 
=  !
	worksheet" +
.+ ,
GetFirstChild, 9
<9 :
	SheetData: C
>C D
(D E
)E F
;F G
Row 
retRow 
= 
! 
isNewLastRow &
?' (
	sheetData) 2
.2 3
Elements3 ;
<; <
Row< ?
>? @
(@ A
)A B
.B C
FirstOrDefaultC Q
(Q R
rR S
=>T V
rW X
.X Y
RowIndexY a
==b d
rowIndexe m
)m n
:o p
nullq u
;u v
if!! 
(!! 
retRow!! 
!=!! 
null!! 
)!! 
{"" 
if$$ 
($$ 
	insertRow$$ 
!=$$  
null$$! %
)$$% &
{%% 
UpdateRowIndexes&& $
(&&$ %
worksheetPart&&% 2
,&&2 3
rowIndex&&4 <
,&&< =
false&&> C
)&&C D
;&&D E&
UpdateMergedCellReferences'' .
(''. /
worksheetPart''/ <
,''< =
rowIndex''> F
,''F G
false''H M
)''M N
;''N O%
UpdateHyperlinkReferences(( -
(((- .
worksheetPart((. ;
,((; <
rowIndex((= E
,((E F
false((G L
)((L M
;((M N
retRow++ 
=++ 
	sheetData++ &
.++& '
InsertBefore++' 3
(++3 4
	insertRow++4 =
,++= >
retRow++? E
)++E F
;++F G
string-- 
curIndex-- #
=--$ %
retRow--& ,
.--, -
RowIndex--- 5
.--5 6
ToString--6 >
(--> ?
)--? @
;--@ A
string.. 
newIndex.. #
=..$ %
rowIndex..& .
.... /
ToString../ 7
(..7 8
)..8 9
;..9 :
foreach00 
(00 
Cell00 !
cell00" &
in00' )
retRow00* 0
.000 1
Elements001 9
<009 :
Cell00: >
>00> ?
(00? @
)00@ A
)00A B
{11 
cell33 
.33 
CellReference33 *
=33+ ,
new33- 0
StringValue331 <
(33< =
cell33= A
.33A B
CellReference33B O
.33O P
Value33P U
.33U V
Replace33V ]
(33] ^
curIndex33^ f
,33f g
newIndex33h p
)33p q
)33q r
;33r s
}44 
retRow77 
.77 
RowIndex77 #
=77$ %
rowIndex77& .
;77. /
}88 
}99 
else:: 
{;; 
Row>> 
refRow>> 
=>> 
!>> 
isNewLastRow>> *
?>>+ ,
	sheetData>>- 6
.>>6 7
Elements>>7 ?
<>>? @
Row>>@ C
>>>C D
(>>D E
)>>E F
.>>F G
FirstOrDefault>>G U
(>>U V
row>>V Y
=>>>Z \
row>>] `
.>>` a
RowIndex>>a i
>>>j k
rowIndex>>l t
)>>t u
:>>v w
null>>x |
;>>| }
retRowAA 
=AA 
	insertRowAA "
??AA# %
newAA& )
RowAA* -
(AA- .
)AA. /
{AA0 1
RowIndexAA2 :
=AA; <
rowIndexAA= E
}AAF G
;AAG H
IEnumerableCC 
<CC 
CellCC  
>CC  !

cellsInRowCC" ,
=CC- .
retRowCC/ 5
.CC5 6
ElementsCC6 >
<CC> ?
CellCC? C
>CCC D
(CCD E
)CCE F
;CCF G
ifEE 
(EE 

cellsInRowEE 
.EE 
AnyEE "
(EE" #
)EE# $
)EE$ %
{FF 
stringGG 
curIndexGG #
=GG$ %
retRowGG& ,
.GG, -
RowIndexGG- 5
.GG5 6
ToStringGG6 >
(GG> ?
)GG? @
;GG@ A
stringHH 
newIndexHH #
=HH$ %
rowIndexHH& .
.HH. /
ToStringHH/ 7
(HH7 8
)HH8 9
;HH9 :
foreachJJ 
(JJ 
CellJJ !
cellJJ" &
inJJ' )

cellsInRowJJ* 4
)JJ4 5
{KK 
cellMM 
.MM 
CellReferenceMM *
=MM+ ,
newMM- 0
StringValueMM1 <
(MM< =
cellMM= A
.MMA B
CellReferenceMMB O
.MMO P
ValueMMP U
.MMU V
ReplaceMMV ]
(MM] ^
curIndexMM^ f
,MMf g
newIndexMMh p
)MMp q
)MMq r
;MMr s
}NN 
retRowQQ 
.QQ 
RowIndexQQ #
=QQ$ %
rowIndexQQ& .
;QQ. /
}RR 
	sheetDataTT 
.TT 
InsertBeforeTT &
(TT& '
retRowTT' -
,TT- .
refRowTT/ 5
)TT5 6
;TT6 7
}UU 
returnWW 
retRowWW 
;WW 
}XX 	
privateaa 
staticaa 
voidaa 
UpdateRowIndexesaa ,
(aa, -
WorksheetPartaa- :
worksheetPartaa; H
,aaH I
uintaaJ N
rowIndexaaO W
,aaW X
boolaaY ]
isDeletedRowaa^ j
)aaj k
{bb 	
IEnumerabledd 
<dd 
Rowdd 
>dd 
rowsdd !
=dd" #
worksheetPartdd$ 1
.dd1 2
	Worksheetdd2 ;
.dd; <
Descendantsdd< G
<ddG H
RowddH K
>ddK L
(ddL M
)ddM N
.ddN O
WhereddO T
(ddT U
rddU V
=>ddW Y
rddZ [
.dd[ \
RowIndexdd\ d
.ddd e
Valuedde j
>=ddk m
rowIndexddn v
)ddv w
;ddw x
foreachff 
(ff 
Rowff 
rowff 
inff 
rowsff  $
)ff$ %
{gg 
uinthh 
newIndexhh 
=hh 
(hh  !
isDeletedRowhh! -
?hh. /
rowhh0 3
.hh3 4
RowIndexhh4 <
-hh= >
$numhh? @
:hhA B
rowhhC F
.hhF G
RowIndexhhG O
+hhP Q
$numhhR S
)hhS T
;hhT U
stringii 
curRowIndexii "
=ii# $
rowii% (
.ii( )
RowIndexii) 1
.ii1 2
ToStringii2 :
(ii: ;
)ii; <
;ii< =
stringjj 
newRowIndexjj "
=jj# $
newIndexjj% -
.jj- .
ToStringjj. 6
(jj6 7
)jj7 8
;jj8 9
foreachll 
(ll 
Cellll 
cellll "
inll# %
rowll& )
.ll) *
Elementsll* 2
<ll2 3
Cellll3 7
>ll7 8
(ll8 9
)ll9 :
)ll: ;
{mm 
celloo 
.oo 
CellReferenceoo &
=oo' (
newoo) ,
StringValueoo- 8
(oo8 9
celloo9 =
.oo= >
CellReferenceoo> K
.ooK L
ValueooL Q
.ooQ R
ReplaceooR Y
(ooY Z
curRowIndexooZ e
,ooe f
newRowIndexoog r
)oor s
)oos t
;oot u
}pp 
rowss 
.ss 
RowIndexss 
=ss 
newIndexss '
;ss' (
}tt 
}uu 	
private 
static 
void &
UpdateMergedCellReferences 6
(6 7
WorksheetPart7 D
worksheetPartE R
,R S
uintT X
rowIndexY a
,a b
boolc g
isDeletedRowh t
)t u
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 
worksheetPart
ÅÅ 
.
ÅÅ 
	Worksheet
ÅÅ '
.
ÅÅ' (
Elements
ÅÅ( 0
<
ÅÅ0 1

MergeCells
ÅÅ1 ;
>
ÅÅ; <
(
ÅÅ< =
)
ÅÅ= >
.
ÅÅ> ?
Count
ÅÅ? D
(
ÅÅD E
)
ÅÅE F
>
ÅÅG H
$num
ÅÅI J
)
ÅÅJ K
{
ÇÇ 

MergeCells
ÉÉ 

mergeCells
ÉÉ %
=
ÉÉ& '
worksheetPart
ÉÉ( 5
.
ÉÉ5 6
	Worksheet
ÉÉ6 ?
.
ÉÉ? @
Elements
ÉÉ@ H
<
ÉÉH I

MergeCells
ÉÉI S
>
ÉÉS T
(
ÉÉT U
)
ÉÉU V
.
ÉÉV W
FirstOrDefault
ÉÉW e
(
ÉÉe f
)
ÉÉf g
;
ÉÉg h
if
ÖÖ 
(
ÖÖ 

mergeCells
ÖÖ 
!=
ÖÖ !
null
ÖÖ" &
)
ÖÖ& '
{
ÜÜ 
List
àà 
<
àà 
	MergeCell
àà "
>
àà" #
mergeCellsList
àà$ 2
=
àà3 4

mergeCells
àà5 ?
.
àà? @
Elements
àà@ H
<
ààH I
	MergeCell
ààI R
>
ààR S
(
ààS T
)
ààT U
.
ààU V
Where
ààV [
(
àà[ \
r
àà\ ]
=>
àà^ `
r
ààa b
.
ààb c
	Reference
ààc l
.
ààl m
HasValue
ààm u
)
ààu v
.
ââU V
Where
ââV [
(
ââ[ \
r
ââ\ ]
=>
ââ^ `
GetRowIndex
ââa l
(
ââl m
r
ââm n
.
âân o
	Reference
ââo x
.
ââx y
Value
âây ~
.
ââ~ 
Splitââ Ñ
(ââÑ Ö
$charââÖ à
)ââà â
.âââ ä
	ElementAtââä ì
(ââì î
$numââî ï
)ââï ñ
)ââñ ó
>=ââò ö
rowIndexââõ £
||ââ§ ¶
GetRowIndex
ääa l
(
ääl m
r
ääm n
.
ään o
	Reference
ääo x
.
ääx y
Value
ääy ~
.
ää~ 
Splitää Ñ
(ääÑ Ö
$charääÖ à
)ääà â
.ääâ ä
	ElementAtäää ì
(ääì î
$numääî ï
)ääï ñ
)ääñ ó
>=ääò ö
rowIndexääõ £
)ää£ §
.ää§ •
ToListää• ´
(ää´ ¨
)ää¨ ≠
;ää≠ Æ
if
çç 
(
çç 
isDeletedRow
çç $
)
çç$ %
{
éé 
List
èè 
<
èè 
	MergeCell
èè &
>
èè& ' 
mergeCellsToDelete
èè( :
=
èè; <
mergeCellsList
èè= K
.
èèK L
Where
èèL Q
(
èèQ R
r
èèR S
=>
èèT V
GetRowIndex
èèW b
(
èèb c
r
èèc d
.
èèd e
	Reference
èèe n
.
èèn o
Value
èèo t
.
èèt u
Split
èèu z
(
èèz {
$char
èè{ ~
)
èè~ 
.èè Ä
	ElementAtèèÄ â
(èèâ ä
$numèèä ã
)èèã å
)èèå ç
==èèé ê
rowIndexèèë ô
||èèö ú
GetRowIndex
êêW b
(
êêb c
r
êêc d
.
êêd e
	Reference
êêe n
.
êên o
Value
êêo t
.
êêt u
Split
êêu z
(
êêz {
$char
êê{ ~
)
êê~ 
.êê Ä
	ElementAtêêÄ â
(êêâ ä
$numêêä ã
)êêã å
)êêå ç
==êêé ê
rowIndexêêë ô
)êêô ö
.êêö õ
ToListêêõ °
(êê° ¢
)êê¢ £
;êê£ §
foreach
ìì 
(
ìì  !
	MergeCell
ìì! *
cellToDelete
ìì+ 7
in
ìì8 : 
mergeCellsToDelete
ìì; M
)
ììM N
{
îî 
cellToDelete
ïï (
.
ïï( )
Remove
ïï) /
(
ïï/ 0
)
ïï0 1
;
ïï1 2
}
ññ 
mergeCellsList
ôô &
=
ôô' (

mergeCells
ôô) 3
.
ôô3 4
Elements
ôô4 <
<
ôô< =
	MergeCell
ôô= F
>
ôôF G
(
ôôG H
)
ôôH I
.
ôôI J
Where
ôôJ O
(
ôôO P
r
ôôP Q
=>
ôôR T
r
ôôU V
.
ôôV W
	Reference
ôôW `
.
ôô` a
HasValue
ôôa i
)
ôôi j
.
ööI J
Where
ööJ O
(
ööO P
r
ööP Q
=>
ööR T
GetRowIndex
ööU `
(
öö` a
r
ööa b
.
ööb c
	Reference
ööc l
.
ööl m
Value
ööm r
.
öör s
Split
öös x
(
ööx y
$char
ööy |
)
öö| }
.
öö} ~
	ElementAtöö~ á
(ööá à
$numööà â
)ööâ ä
)ööä ã
>ööå ç
rowIndexööé ñ
||ööó ô
GetRowIndex
õõU `
(
õõ` a
r
õõa b
.
õõb c
	Reference
õõc l
.
õõl m
Value
õõm r
.
õõr s
Split
õõs x
(
õõx y
$char
õõy |
)
õõ| }
.
õõ} ~
	ElementAtõõ~ á
(õõá à
$numõõà â
)õõâ ä
)õõä ã
>õõå ç
rowIndexõõé ñ
)õõñ ó
.õõó ò
ToListõõò û
(õõû ü
)õõü †
;õõ† °
}
úú 
foreach
üü 
(
üü 
	MergeCell
üü &
	mergeCell
üü' 0
in
üü1 3
mergeCellsList
üü4 B
)
üüB C
{
†† 
string
°° 
[
°° 
]
°°  
cellReference
°°! .
=
°°/ 0
	mergeCell
°°1 :
.
°°: ;
	Reference
°°; D
.
°°D E
Value
°°E J
.
°°J K
Split
°°K P
(
°°P Q
$char
°°Q T
)
°°T U
;
°°U V
if
££ 
(
££ 
GetRowIndex
££ '
(
££' (
cellReference
££( 5
.
££5 6
	ElementAt
££6 ?
(
££? @
$num
££@ A
)
££A B
)
££B C
>=
££D F
rowIndex
££G O
)
££O P
{
§§ 
string
•• "

columnName
••# -
=
••. /
GetColumnName
••0 =
(
••= >
cellReference
••> K
.
••K L
	ElementAt
••L U
(
••U V
$num
••V W
)
••W X
)
••X Y
;
••Y Z
cellReference
¶¶ )
[
¶¶) *
$num
¶¶* +
]
¶¶+ ,
=
¶¶- .
isDeletedRow
¶¶/ ;
?
¶¶< =

columnName
¶¶> H
+
¶¶I J
(
¶¶K L
GetRowIndex
¶¶L W
(
¶¶W X
cellReference
¶¶X e
.
¶¶e f
	ElementAt
¶¶f o
(
¶¶o p
$num
¶¶p q
)
¶¶q r
)
¶¶r s
-
¶¶t u
$num
¶¶v w
)
¶¶w x
.
¶¶x y
ToString¶¶y Å
(¶¶Å Ç
)¶¶Ç É
:¶¶Ñ Ö&
IncrementCellReference¶¶Ü ú
(¶¶ú ù
cellReference¶¶ù ™
.¶¶™ ´
	ElementAt¶¶´ ¥
(¶¶¥ µ
$num¶¶µ ∂
)¶¶∂ ∑
,¶¶∑ ∏%
CellReferencePartEnum¶¶π Œ
.¶¶Œ œ
Row¶¶œ “
)¶¶“ ”
;¶¶” ‘
}
ßß 
if
©© 
(
©© 
GetRowIndex
©© '
(
©©' (
cellReference
©©( 5
.
©©5 6
	ElementAt
©©6 ?
(
©©? @
$num
©©@ A
)
©©A B
)
©©B C
>=
©©D F
rowIndex
©©G O
)
©©O P
{
™™ 
string
´´ "

columnName
´´# -
=
´´. /
GetColumnName
´´0 =
(
´´= >
cellReference
´´> K
.
´´K L
	ElementAt
´´L U
(
´´U V
$num
´´V W
)
´´W X
)
´´X Y
;
´´Y Z
cellReference
¨¨ )
[
¨¨) *
$num
¨¨* +
]
¨¨+ ,
=
¨¨- .
isDeletedRow
¨¨/ ;
?
¨¨< =

columnName
¨¨> H
+
¨¨I J
(
¨¨K L
GetRowIndex
¨¨L W
(
¨¨W X
cellReference
¨¨X e
.
¨¨e f
	ElementAt
¨¨f o
(
¨¨o p
$num
¨¨p q
)
¨¨q r
)
¨¨r s
-
¨¨t u
$num
¨¨v w
)
¨¨w x
.
¨¨x y
ToString¨¨y Å
(¨¨Å Ç
)¨¨Ç É
:¨¨Ñ Ö&
IncrementCellReference¨¨Ü ú
(¨¨ú ù
cellReference¨¨ù ™
.¨¨™ ´
	ElementAt¨¨´ ¥
(¨¨¥ µ
$num¨¨µ ∂
)¨¨∂ ∑
,¨¨∑ ∏%
CellReferencePartEnum¨¨π Œ
.¨¨Œ œ
Row¨¨œ “
)¨¨“ ”
;¨¨” ‘
}
≠≠ 
	mergeCell
ØØ !
.
ØØ! "
	Reference
ØØ" +
=
ØØ, -
new
ØØ. 1
StringValue
ØØ2 =
(
ØØ= >
cellReference
ØØ> K
[
ØØK L
$num
ØØL M
]
ØØM N
+
ØØO P
$str
ØØQ T
+
ØØU V
cellReference
ØØW d
[
ØØd e
$num
ØØe f
]
ØØf g
)
ØØg h
;
ØØh i
}
∞∞ 
}
±± 
}
≤≤ 
}
≥≥ 	
private
ªª 
static
ªª 
void
ªª '
UpdateHyperlinkReferences
ªª 5
(
ªª5 6
WorksheetPart
ªª6 C
worksheetPart
ªªD Q
,
ªªQ R
uint
ªªS W
rowIndex
ªªX `
,
ªª` a
bool
ªªb f
isDeletedRow
ªªg s
)
ªªs t
{
ºº 	

Hyperlinks
ΩΩ 

hyperlinks
ΩΩ !
=
ΩΩ" #
worksheetPart
ΩΩ$ 1
.
ΩΩ1 2
	Worksheet
ΩΩ2 ;
.
ΩΩ; <
Elements
ΩΩ< D
<
ΩΩD E

Hyperlinks
ΩΩE O
>
ΩΩO P
(
ΩΩP Q
)
ΩΩQ R
.
ΩΩR S
FirstOrDefault
ΩΩS a
(
ΩΩa b
)
ΩΩb c
;
ΩΩc d
if
øø 
(
øø 

hyperlinks
øø 
!=
øø 
null
øø "
)
øø" #
{
¿¿ 
Match
¡¡ $
hyperlinkRowIndexMatch
¡¡ ,
;
¡¡, -
uint
¬¬ 
hyperlinkRowIndex
¬¬ &
;
¬¬& '
foreach
ƒƒ 
(
ƒƒ 
	Hyperlink
ƒƒ "
	hyperlink
ƒƒ# ,
in
ƒƒ- /

hyperlinks
ƒƒ0 :
.
ƒƒ: ;
Elements
ƒƒ; C
<
ƒƒC D
	Hyperlink
ƒƒD M
>
ƒƒM N
(
ƒƒN O
)
ƒƒO P
)
ƒƒP Q
{
≈≈ $
hyperlinkRowIndexMatch
∆∆ *
=
∆∆+ ,
Regex
∆∆- 2
.
∆∆2 3
Match
∆∆3 8
(
∆∆8 9
	hyperlink
∆∆9 B
.
∆∆B C
	Reference
∆∆C L
.
∆∆L M
Value
∆∆M R
,
∆∆R S
$str
∆∆T \
)
∆∆\ ]
;
∆∆] ^
if
«« 
(
«« $
hyperlinkRowIndexMatch
«« .
.
««. /
Success
««/ 6
&&
««7 9
uint
««: >
.
««> ?
TryParse
««? G
(
««G H$
hyperlinkRowIndexMatch
««H ^
.
««^ _
Value
««_ d
,
««d e
out
««f i
hyperlinkRowIndex
««j {
)
««{ |
&&
««} !
hyperlinkRowIndex««Ä ë
>=««í î
rowIndex««ï ù
)««ù û
{
»» 
if
   
(
   
isDeletedRow
   (
)
  ( )
{
ÀÀ 
if
ÕÕ 
(
ÕÕ  
hyperlinkRowIndex
ÕÕ  1
==
ÕÕ2 4
rowIndex
ÕÕ5 =
)
ÕÕ= >
{
ŒŒ 
	hyperlink
œœ  )
.
œœ) *
Remove
œœ* 0
(
œœ0 1
)
œœ1 2
;
œœ2 3
}
–– 
else
““  
{
”” 
	hyperlink
‘‘  )
.
‘‘) *
	Reference
‘‘* 3
.
‘‘3 4
Value
‘‘4 9
=
‘‘: ;
	hyperlink
‘‘< E
.
‘‘E F
	Reference
‘‘F O
.
‘‘O P
Value
‘‘P U
.
‘‘U V
Replace
‘‘V ]
(
‘‘] ^$
hyperlinkRowIndexMatch
‘‘^ t
.
‘‘t u
Value
‘‘u z
,
‘‘z {
(
‘‘| } 
hyperlinkRowIndex‘‘} é
-‘‘è ê
$num‘‘ë í
)‘‘í ì
.‘‘ì î
ToString‘‘î ú
(‘‘ú ù
)‘‘ù û
)‘‘û ü
;‘‘ü †
}
÷÷ 
}
◊◊ 
else
ŸŸ 
{
⁄⁄ 
	hyperlink
€€ %
.
€€% &
	Reference
€€& /
.
€€/ 0
Value
€€0 5
=
€€6 7
	hyperlink
€€8 A
.
€€A B
	Reference
€€B K
.
€€K L
Value
€€L Q
.
€€Q R
Replace
€€R Y
(
€€Y Z$
hyperlinkRowIndexMatch
€€Z p
.
€€p q
Value
€€q v
,
€€v w
(
€€x y 
hyperlinkRowIndex€€y ä
+€€ã å
$num€€ç é
)€€é è
.€€è ê
ToString€€ê ò
(€€ò ô
)€€ô ö
)€€ö õ
;€€õ ú
}
‹‹ 
}
›› 
}
ﬁﬁ 
if
·· 
(
·· 

hyperlinks
·· 
.
·· 
Elements
·· '
<
··' (
	Hyperlink
··( 1
>
··1 2
(
··2 3
)
··3 4
.
··4 5
Count
··5 :
(
··: ;
)
··; <
==
··= ?
$num
··@ A
)
··A B
{
‚‚ 

hyperlinks
„„ 
.
„„ 
Remove
„„ %
(
„„% &
)
„„& '
;
„„' (
}
‰‰ 
}
ÂÂ 
}
ÊÊ 	
public
ÌÌ 
static
ÌÌ 
uint
ÌÌ 
GetRowIndex
ÌÌ &
(
ÌÌ& '
string
ÌÌ' -
cellReference
ÌÌ. ;
)
ÌÌ; <
{
ÓÓ 	
Regex
 
regex
 
=
 
new
 
Regex
 #
(
# $
$str
$ *
)
* +
;
+ ,
Match
ÒÒ 
match
ÒÒ 
=
ÒÒ 
regex
ÒÒ 
.
ÒÒ  
Match
ÒÒ  %
(
ÒÒ% &
cellReference
ÒÒ& 3
)
ÒÒ3 4
;
ÒÒ4 5
return
ÛÛ 
uint
ÛÛ 
.
ÛÛ 
Parse
ÛÛ 
(
ÛÛ 
match
ÛÛ #
.
ÛÛ# $
Value
ÛÛ$ )
)
ÛÛ) *
;
ÛÛ* +
}
ÙÙ 	
public
˝˝ 
static
˝˝ 
string
˝˝ $
IncrementCellReference
˝˝ 3
(
˝˝3 4
string
˝˝4 :
	reference
˝˝; D
,
˝˝D E#
CellReferencePartEnum
˝˝F [
cellRefPart
˝˝\ g
)
˝˝g h
{
˛˛ 	
string
ˇˇ 
newReference
ˇˇ 
=
ˇˇ  !
	reference
ˇˇ" +
;
ˇˇ+ ,
if
ÅÅ 
(
ÅÅ 
cellRefPart
ÅÅ 
!=
ÅÅ #
CellReferencePartEnum
ÅÅ 4
.
ÅÅ4 5
None
ÅÅ5 9
&&
ÅÅ: <
!
ÅÅ= >
String
ÅÅ> D
.
ÅÅD E
IsNullOrEmpty
ÅÅE R
(
ÅÅR S
	reference
ÅÅS \
)
ÅÅ\ ]
)
ÅÅ] ^
{
ÇÇ 
string
ÉÉ 
[
ÉÉ 
]
ÉÉ 
parts
ÉÉ 
=
ÉÉ  
Regex
ÉÉ! &
.
ÉÉ& '
Split
ÉÉ' ,
(
ÉÉ, -
	reference
ÉÉ- 6
,
ÉÉ6 7
$str
ÉÉ8 B
)
ÉÉB C
;
ÉÉC D
if
ÖÖ 
(
ÖÖ 
cellRefPart
ÖÖ 
==
ÖÖ  "#
CellReferencePartEnum
ÖÖ# 8
.
ÖÖ8 9
Column
ÖÖ9 ?
||
ÖÖ@ B
cellRefPart
ÖÖC N
==
ÖÖO Q#
CellReferencePartEnum
ÖÖR g
.
ÖÖg h
Both
ÖÖh l
)
ÖÖl m
{
ÜÜ 
List
áá 
<
áá 
char
áá 
>
áá 
col
áá "
=
áá# $
parts
áá% *
[
áá* +
$num
áá+ ,
]
áá, -
.
áá- .
ToCharArray
áá. 9
(
áá9 :
)
áá: ;
.
áá; <
ToList
áá< B
(
ááB C
)
ááC D
;
ááD E
bool
àà 
needsIncrement
àà '
=
àà( )
true
àà* .
;
àà. /
int
ââ 
index
ââ 
=
ââ 
col
ââ  #
.
ââ# $
Count
ââ$ )
-
ââ* +
$num
ââ, -
;
ââ- .
do
ãã 
{
åå 
col
éé 
[
éé 
index
éé !
]
éé! "
=
éé# $
_letters
éé% -
[
éé- .
_letters
éé. 6
.
éé6 7
IndexOf
éé7 >
(
éé> ?
col
éé? B
[
ééB C
index
ééC H
]
ééH I
)
ééI J
+
ééK L
$num
ééM N
]
ééN O
;
ééO P
if
ëë 
(
ëë 
col
ëë 
[
ëë  
index
ëë  %
]
ëë% &
==
ëë' )
_letters
ëë* 2
[
ëë2 3
_letters
ëë3 ;
.
ëë; <
Count
ëë< A
-
ëëB C
$num
ëëD E
]
ëëE F
)
ëëF G
{
íí 
col
ìì 
[
ìì  
index
ìì  %
]
ìì% &
=
ìì' (
_letters
ìì) 1
[
ìì1 2
$num
ìì2 3
]
ìì3 4
;
ìì4 5
}
îî 
else
ïï 
{
ññ 
needsIncrement
óó *
=
óó+ ,
false
óó- 2
;
óó2 3
}
òò 
}
öö 
while
öö 
(
öö 
needsIncrement
öö +
&&
öö, .
--
öö/ 1
index
öö1 6
>=
öö7 9
$num
öö: ;
)
öö; <
;
öö< =
if
ùù 
(
ùù 
needsIncrement
ùù &
)
ùù& '
{
ûû 
col
üü 
.
üü 
Add
üü 
(
üü  
_letters
üü  (
[
üü( )
$num
üü) *
]
üü* +
)
üü+ ,
;
üü, -
}
†† 
parts
¢¢ 
[
¢¢ 
$num
¢¢ 
]
¢¢ 
=
¢¢ 
new
¢¢ "
String
¢¢# )
(
¢¢) *
col
¢¢* -
.
¢¢- .
ToArray
¢¢. 5
(
¢¢5 6
)
¢¢6 7
)
¢¢7 8
;
¢¢8 9
}
££ 
if
•• 
(
•• 
cellRefPart
•• 
==
••  "#
CellReferencePartEnum
••# 8
.
••8 9
Row
••9 <
||
••= ?
cellRefPart
••@ K
==
••L N#
CellReferencePartEnum
••O d
.
••d e
Both
••e i
)
••i j
{
¶¶ 
parts
®® 
[
®® 
$num
®® 
]
®® 
=
®® 
(
®®  
int
®®  #
.
®®# $
Parse
®®$ )
(
®®) *
parts
®®* /
[
®®/ 0
$num
®®0 1
]
®®1 2
)
®®2 3
+
®®4 5
$num
®®6 7
)
®®7 8
.
®®8 9
ToString
®®9 A
(
®®A B
)
®®B C
;
®®C D
}
©© 
newReference
´´ 
=
´´ 
parts
´´ $
[
´´$ %
$num
´´% &
]
´´& '
+
´´( )
parts
´´* /
[
´´/ 0
$num
´´0 1
]
´´1 2
;
´´2 3
}
¨¨ 
return
ÆÆ 
newReference
ÆÆ 
;
ÆÆ  
}
ØØ 	
private
∂∂ 
static
∂∂ 
string
∂∂ 
GetColumnName
∂∂ +
(
∂∂+ ,
string
∂∂, 2
cellName
∂∂3 ;
)
∂∂; <
{
∑∑ 	
Regex
ππ 
regex
ππ 
=
ππ 
new
ππ 
Regex
ππ #
(
ππ# $
$str
ππ$ /
)
ππ/ 0
;
ππ0 1
Match
∫∫ 
match
∫∫ 
=
∫∫ 
regex
∫∫ 
.
∫∫  
Match
∫∫  %
(
∫∫% &
cellName
∫∫& .
)
∫∫. /
;
∫∫/ 0
return
ºº 
match
ºº 
.
ºº 
Value
ºº 
;
ºº 
}
ΩΩ 	
public
ææ 
enum
ææ #
CellReferencePartEnum
ææ )
{
øø 	
None
¿¿ 
,
¿¿ 
Column
¡¡ 
,
¡¡ 
Row
¬¬ 
,
¬¬ 
Both
√√ 
}
ƒƒ 	
private
≈≈ 
static
≈≈ 
List
≈≈ 
<
≈≈ 
char
≈≈  
>
≈≈  !
_letters
≈≈" *
=
≈≈+ ,
new
≈≈- 0
List
≈≈1 5
<
≈≈5 6
char
≈≈6 :
>
≈≈: ;
(
≈≈; <
)
≈≈< =
{
≈≈> ?
$char
≈≈@ C
,
≈≈C D
$char
≈≈E H
,
≈≈H I
$char
≈≈J M
,
≈≈M N
$char
≈≈O R
,
≈≈R S
$char
≈≈T W
,
≈≈W X
$char
≈≈Y \
,
≈≈\ ]
$char
≈≈^ a
,
≈≈a b
$char
≈≈c f
,
≈≈f g
$char
≈≈h k
,
≈≈k l
$char
≈≈m p
,
≈≈p q
$char
≈≈r u
,
≈≈u v
$char
≈≈w z
,
≈≈z {
$char
≈≈| 
,≈≈ Ä
$char≈≈Å Ñ
,≈≈Ñ Ö
$char≈≈Ü â
,≈≈â ä
$char≈≈ã é
,≈≈é è
$char≈≈ê ì
,≈≈ì î
$char≈≈ï ò
,≈≈ò ô
$char≈≈ö ù
,≈≈ù û
$char≈≈ü ¢
,≈≈¢ £
$char≈≈§ ß
,≈≈ß ®
$char≈≈© ¨
,≈≈¨ ≠
$char≈≈Æ ±
,≈≈± ≤
$char≈≈≥ ∂
,≈≈∂ ∑
$char≈≈∏ ª
,≈≈ª º
$char≈≈Ω ¿
,≈≈¿ ¡
$char≈≈¬ ≈
}≈≈∆ «
;≈≈« »
}
«« 
}»» 
JD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Excel\ExcelUtility.cs
	namespace 	
ADSDataDirect
 
. 
Web 
. 
Helpers #
{ 
public 

class 
ExcelUtility 
{ 
public 
static 
int 
GetRow  
(  !
int! $

itemNumber% /
)/ 0
{ 	
int 
	rowNumber 
= 
$num 
; 
int 
firstStartingRow  
=! "
$num# $
;$ %
int		 
secondStartingRow		 !
=		" #
$num		$ &
;		& '
if 
( 

itemNumber 
<= 
$num  
)  !
	rowNumber 
= 

itemNumber &
+' (
firstStartingRow) 9
;9 :
if 
( 

itemNumber 
> 
$num 
&&  "

itemNumber# -
<. /
$num0 3
)3 4
	rowNumber 
= 

itemNumber &
+' (
firstStartingRow) 9
-: ;
$num< >
;> ?
if 
( 

itemNumber 
> 
$num  
&&! #

itemNumber$ .
<=/ 1
$num2 5
)5 6
	rowNumber 
= 

itemNumber &
-' (
$num) ,
+- .
secondStartingRow/ @
;@ A
if 
( 

itemNumber 
> 
$num  
)  !
	rowNumber 
= 

itemNumber &
-' (
$num) ,
+- .
secondStartingRow/ @
-A B
$numC E
;E F
return 
	rowNumber 
; 
} 	
public 
static 
string 
	GetColumn &
(& '
int' *

itemNumber+ 5
,5 6
string7 =

columnName> H
)H I
{ 	
string 
columnNumber 
=  !
string" (
.( )
Empty) .
;. /
if 
( 
( 

itemNumber 
<= 
$num !
)! "
||# %
(& '

itemNumber' 1
>2 3
$num4 7
&&8 :

itemNumber; E
<=F H
$numI L
)L M
)M N
{ 
columnNumber   
=   

columnName   )
.  ) *
Equals  * 0
(  0 1
$str  1 7
)  7 8
?  9 :
$str  ; >
:  ? @
(  A B

columnName  B L
.  L M
Equals  M S
(  S T
$str  T ^
)  ^ _
?  ` a
$str  b e
:  f g
$str  h k
)  k l
;  l m
}!! 
if## 
(## 
(## 

itemNumber## 
>## 
$num##  
&&##! #

itemNumber##$ .
<##/ 0
$num##1 4
)##4 5
||##6 8
(##9 :

itemNumber##: D
>##E F
$num##G J
)##J K
)##K L
{$$ 
columnNumber%% 
=%% 

columnName%% )
.%%) *
Equals%%* 0
(%%0 1
$str%%1 7
)%%7 8
?%%9 :
$str%%; >
:%%? @
(%%A B

columnName%%B L
.%%L M
Equals%%M S
(%%S T
$str%%T ^
)%%^ _
?%%` a
$str%%b e
:%%f g
$str%%h k
)%%k l
;%%l m
}&& 
return'' 
columnNumber'' 
;''  
}(( 	
})) 
}** È'
ZD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataReports\MetricReportsGenerator.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DataReports' 2
{ 
public 

static 
class "
MetricReportsGenerator .
{ 
public 
static 
void 
Generate #
(# $
System$ *
.* +
Web+ .
.. /
HttpResponseBase/ ?
Response@ H
,H I
CampaignJ R
campaignS [
,[ \
CampaignTracking] m
campaignTrackingn ~
)~ 
{ 	
var 
metric 
= $
CampaignTrackingMetricVm 1
.1 2 
FromCampaignTracking2 F
(F G
campaignG O
,O P
campaignTrackingQ a
)a b
;b c
var 
urls 
= *
CampaignTrackingMetricDetailVm 5
.5 6 
FromCampaignTracking6 J
(J K
campaignK S
,S T
campaignTrackingU e
)e f
;f g
ExcelPackage 
excel 
=  
new! $
ExcelPackage% 1
(1 2
)2 3
;3 4
var 
	workSheet 
= 
excel !
.! "
Workbook" *
.* +

Worksheets+ 5
.5 6
Add6 9
(9 :
$str: I
)I J
;J K
	workSheet 
. 
Cells 
[ 
$num 
, 
$num  
]  !
.! "
LoadFromCollection" 4
(4 5
metric5 ;
,; <
true= A
)A B
;B C
	workSheet 
. 
Cells 
[ 
$num 
, 
$num  
]  !
.! "
Style" '
.' (
Numberformat( 4
.4 5
Format5 ;
=< =
$str> E
;E F
	workSheet 
. 
Cells 
[ 
$num 
, 
$num !
]! "
." #
Style# (
.( )
Numberformat) 5
.5 6
Format6 <
== >
$str? F
;F G
	workSheet 
. 
Cells 
[ 
$num 
, 
$num !
]! "
." #
Style# (
.( )
Numberformat) 5
.5 6
Format6 <
== >
$str? F
;F G
var 

workSheet2 
= 
excel "
." #
Workbook# +
.+ ,

Worksheets, 6
.6 7
Add7 :
(: ;
$str; G
)G H
;H I

workSheet2 
. 
Cells 
[ 
$num 
, 
$num  !
]! "
." #
LoadFromCollection# 5
(5 6
urls6 :
,: ;
true< @
)@ A
;A B
using 
( 
var 
memoryStream #
=$ %
new& )
MemoryStream* 6
(6 7
)7 8
)8 9
{ 
string   
orderNumber   "
=  # $
campaign  % -
.  - .
ReBroadcasted  . ;
?  < =
$"  > @
{  @ A
campaign  A I
.  I J$
ReBroadcastedOrderNumber  J b
}  b c
"  c d
:  e f
$"  g i
{  i j
campaign  j r
.  r s
OrderNumber  s ~
}  ~ 
"	   Ä
;
  Ä Å
string!! 
fileName!! 
=!!  !
$"!!" $
{!!$ %
orderNumber!!% 0
}!!0 1
report.xlsx!!1 <
"!!< =
;!!= >
Response"" 
."" 
ContentType"" $
=""% &
$str""' j
;""j k
Response## 
.## 
	AddHeader## "
(##" #
$"### %
content-disposition##% 8
"##8 9
,##9 :
$"##; ="
attachment;  filename=##= S
{##S T
fileName##T \
}##\ ]
"##] ^
)##^ _
;##_ `
excel$$ 
.$$ 
SaveAs$$ 
($$ 
memoryStream$$ )
)$$) *
;$$* +
memoryStream%% 
.%% 
WriteTo%% $
(%%$ %
Response%%% -
.%%- .
OutputStream%%. :
)%%: ;
;%%; <
Response&& 
.&& 
Flush&& 
(&& 
)&&  
;&&  !
Response'' 
.'' 
End'' 
('' 
)'' 
;'' 
}(( 
})) 	
}** 
}++ Ç
OD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Exceptions\AdsException.cs
	namespace 	
ADSDataDirect
 
{ 
[ 
Serializable 
] 
public 

class 
AdsException 
: 
	Exception  )
{ 
public		 
AdsException		 
(		 
)		 
:

 	
base


 
(

 
)

 
{

 
}

 
public 
AdsException 
( 
string "
message# *
)* +
: 	
base
 
( 
message 
) 
{ 
} 
public 
AdsException 
( 
string "
format# )
,) *
params+ 1
object2 8
[8 9
]9 :
args; ?
)? @
: 	
base
 
( 
string 
. 
Format 
( 
format #
,# $
args% )
)) *
)* +
{, -
}. /
public 
AdsException 
( 
string "
message# *
,* +
	Exception, 5
innerException6 D
)D E
: 	
base
 
( 
message 
, 
innerException &
)& '
{( )
}* +
public 
AdsException 
( 
string "
format# )
,) *
	Exception+ 4
innerException5 C
,C D
paramsE K
objectL R
[R S
]S T
argsU Y
)Y Z
: 	
base
 
( 
string 
. 
Format 
( 
format #
,# $
args% )
)) *
,* +
innerException, :
): ;
{< =
}> ?
	protected 
AdsException 
( 
SerializationInfo 0
info1 5
,5 6
StreamingContext7 G
contextH O
)O P
: 	
base
 
( 
info 
, 
context 
) 
{ 
}  !
} 
} ê©
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Campaigns\CampaignProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	Campaigns' 0
{ 
public 

static 
class 
CampaignProcessor )
{ 
public 
static 
void 
ProcessNewOrder *
(* +
string+ 1
orderNumber2 =
,= >
string? E
userNameF N
)N O
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
var 
campaign 
= 
db !
.! "
	Campaigns" +
.+ ,
Include, 3
(3 4
x4 5
=>6 8
x9 :
.: ;
Assets; A
)A B
.B C
IncludeC J
(J K
xK L
=>M O
xP Q
.Q R
SegmentsR Z
)Z [
.! "
FirstOrDefault" 0
(0 1
x1 2
=>3 5
x6 7
.7 8
OrderNumber8 C
==D F
orderNumberG R
)R S
;S T
var 
user 
= 
db 
. 
Users #
.# $
FirstOrDefault$ 2
(2 3
x3 4
=>5 7
x8 9
.9 :
UserName: B
==C E
userNameF N
)N O
;O P
FileProcessor 
.  
ProcessNewOrderFiles 2
(2 3
db3 5
,5 6
campaign7 ?
)? @
;@ A
EmailHelper 
. "
SendOrderEmailToClient 2
(2 3
campaign3 ;
,; <
user= A
)A B
;B C
var 
ads 
= 
db 
. 
Vendors $
.$ %
FirstOrDefault% 3
(3 4
x4 5
=>6 8
x9 :
.: ;
Name; ?
.? @
Contains@ H
(H I
$strI N
)N O
)O P
;P Q
if 
( 
ads 
!= 
null 
)  
{ 
EmailHelper 
.  
SendOrderEmailToAds  3
(3 4
campaign4 <
,< =
user> B
,B C
adsD G
.G H
EmailH M
,M N
adsO R
.R S
CcEmailsS [
)[ \
;\ ]
} 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
Orders- 3
,3 4
campaign5 =
.= >
OrderNumber> I
,I J
$strK W
+X Y
campaignZ b
.b c
CampaignNamec o
+p q
$str	r ¢
+
£ §
campaign
• ≠
.
≠ Æ 
RepresentativeName
Æ ¿
)
¿ ¡
;
¡ ¬
}   
}!! 	
public## 
static## 
void## 
SendToVendor## '
(##' (
OrderVia##( 0
orderVia##1 9
,##9 :
Guid##; ?
?##? @
vendorId##A I
,##I J
string##K Q
orderNumber##R ]
,##] ^
string##_ e
[##e f
]##f g
segmentsSelected##h x
,##x y
string	##z Ä
whiteLabelDomain
##Å ë
)
##ë í
{$$ 	
using%% 
(%% 
var%% 
db%% 
=%% 
new%% 
WfpictContext%%  -
(%%- .
)%%. /
)%%/ 0
{&& 
Campaign'' 
campaign'' !
=''" #
db''$ &
.''& '
	Campaigns''' 0
.(( 
Include(( 
((( 
x(( 
=>(( !
x((" #
.((# $
Assets(($ *
)((* +
.)) 
Include)) 
()) 
x)) 
=>)) !
x))" #
.))# $
Segments))$ ,
))), -
.** 
Include** 
(** 
x** 
=>** !
x**" #
.**# $
Testing**$ +
)**+ ,
.++ 
Include++ 
(++ 
x++ 
=>++ !
x++" #
.++# $
Approved++$ ,
)++, -
.,, 
Include,, 
(,, 
x,, 
=>,, !
x,," #
.,,# $
	Trackings,,$ -
),,- .
.-- 
FirstOrDefault-- #
(--# $
x--$ %
=>--& (
x--) *
.--* +
OrderNumber--+ 6
==--7 9
orderNumber--: E
)--E F
;--F G
var// 
vendor// 
=// 
db// 
.//  
Vendors//  '
.//' (
FirstOrDefault//( 6
(//6 7
x//7 8
=>//9 ;
x//< =
.//= >
Id//> @
==//A C
vendorId//D L
)//L M
;//M N
if11 
(11 
segmentsSelected11 $
==11% '
null11( ,
)11, -
{22 
SendToVendorSingle33 &
(33& '
orderVia33' /
,33/ 0
db331 3
,333 4
campaign335 =
,33= >
vendor33? E
,33E F
whiteLabelDomain33G W
)33W X
;33X Y
}44 
else55 
{66 
SendToVendorMulti77 %
(77% &
orderVia77& .
,77. /
db770 2
,772 3
campaign774 <
,77< =
vendor77> D
,77D E
segmentsSelected77F V
,77V W
whiteLabelDomain77X h
)77h i
;77i j
}88 
var;; #
ifSomeSegmentsRemaining;; +
=;;, -
db;;. 0
.;;0 1
CampaignSegments;;1 A
.<< 
Where<< $
(<<$ %
c<<% &
=><<' )
c<<* +
.<<+ ,

CampaignId<<, 6
==<<7 9
campaign<<: B
.<<B C
Id<<C E
)<<E F
.== 
Any== "
(==" #
x==# $
=>==% '
x==( )
.==) *
SegmentStatus==* 7
====8 :
(==; <
int==< ?
)==? @
SegmentStatus==@ M
.==M N
	Generated==N W
||==X Z
x==[ \
.==\ ]
SegmentStatus==] j
====k m
(==n o
int==o r
)==r s
SegmentStatus	==s Ä
.
==Ä Å
Approved
==Å â
)
==â ä
;
==ä ã
if>> 
(>> 
!>> #
ifSomeSegmentsRemaining>> ,
)>>, -
{?? 
campaign@@ 
.@@ 
Status@@ #
=@@$ %
(@@& '
int@@' *
)@@* +
CampaignStatus@@+ 9
.@@9 :

Monitoring@@: D
;@@D E
dbAA 
.AA 
SaveChangesAA "
(AA" #
)AA# $
;AA$ %
}BB 
}DD 
}EE 	
privateGG 
staticGG 
voidGG 
SendToVendorMultiGG -
(GG- .
OrderViaGG. 6
orderViaGG7 ?
,GG? @
WfpictContextGGA N
dbGGO Q
,GGQ R
CampaignGGS [
campaignGG\ d
,GGd e
VendorGGf l
vendorGGm s
,GGs t
stringGGu {
[GG{ |
]GG| }
segmentsSelected	GG~ é
,
GGé è
string
GGê ñ
whiteLabelDomain
GGó ß
)
GGß ®
{HH 	
varII 
segmentsII 
=II 
dbII 
.II 
CampaignSegmentsII .
.JJ# $
WhereJJ$ )
(JJ) *
cJJ* +
=>JJ, .
cJJ/ 0
.JJ0 1

CampaignIdJJ1 ;
==JJ< >
campaignJJ? G
.JJG H
IdJJH J
&&JJK M
segmentsSelectedJJN ^
.JJ^ _
ContainsJJ_ g
(JJg h
cJJh i
.JJi j
SegmentNumberJJj w
)JJw x
)JJx y
.KK# $
ToListKK$ *
(KK* +
)KK+ ,
;KK, -
foreachLL 
(LL 
varLL 
segmentLL  
inLL! #
segmentsLL$ ,
)LL, -
{MM 
stringNN 
	sentOrderNN  
,NN  !
queuedCampaignIdNN" 2
=NN3 4
nullNN5 9
;NN9 :
switchOO 
(OO 
orderViaOO  
)OO  !
{PP 
caseQQ 
OrderViaQQ !
.QQ! "
EmailQQ" '
:QQ' (
	sentOrderRR !
=RR" #
EmailHelperRR$ /
.RR/ 0 
SendApprovedToVendorRR0 D
(RRD E
vendorRRE K
,RRK L
campaignRRM U
,RRU V
segmentRRW ^
)RR^ _
;RR_ `
breakSS 
;SS 
caseTT 
OrderViaTT !
.TT! "
ApiTT" %
:TT% &
varUU 
responseUU $
=UU% &
ProDataApiManagerUU' 8
.UU8 9
CreateUU9 ?
(UU? @
campaignUU@ H
,UUH I
segmentUUJ Q
,UUQ R
whiteLabelDomainUUS c
)UUc d
;UUd e
ifVV 
(VV 
responseVV $
.VV$ %
statusVV% +
!=VV, .
ProDataApiManagerVV/ @
.VV@ A
SuccessVVA H
)VVH I
{WW 
throwXX !
newXX" %
AdsExceptionXX& 2
(XX2 3
responseXX3 ;
.XX; <
ErrorMessageXX< H
)XXH I
;XXI J
}YY 
	sentOrderZZ !
=ZZ" #
responseZZ$ ,
.ZZ, -
RequestMessageZZ- ;
;ZZ; <
queuedCampaignId[[ (
=[[) *
response[[+ 3
.[[3 4&
queued_pending_campaign_id[[4 N
.[[N O
ToString[[O W
([[W X
)[[X Y
;[[Y Z
break\\ 
;\\ 
default]] 
:]] 
throw^^ 
new^^ !
AdsException^^" .
(^^. /
$str^^/ b
)^^b c
;^^c d
}__ 
segmentaa 
.aa 
SegmentStatusaa %
=aa& '
(aa( )
intaa) ,
)aa, -
SegmentStatusaa- :
.aa: ;

Monitoringaa; E
;aaE F
varcc 
campaignTrackingcc $
=cc% &
dbdd 
.dd 
CampaignTrackingsdd (
.dd( )
FirstOrDefaultdd) 7
(dd7 8
xdd8 9
=>dd: <
xdd= >
.dd> ?

CampaignIddd? I
==ddJ L
campaignddM U
.ddU V
IdddV X
&&ddY [
xdd\ ]
.dd] ^
SegmentNumberdd^ k
==ddl n
segmentddo v
.ddv w
SegmentNumber	ddw Ñ
)
ddÑ Ö
;
ddÖ Ü
ifff 
(ff 
campaignTrackingff $
==ff% '
nullff( ,
)ff, -
{gg 
varhh 

trackingIdhh "
=hh# $
Guidhh% )
.hh) *
NewGuidhh* 1
(hh1 2
)hh2 3
;hh3 4
varii 
trackingii  
=ii! "
newii# &
CampaignTrackingii' 7
(ii7 8
)ii8 9
{jj 
Idkk 
=kk 

trackingIdkk '
,kk' (
	CreatedAtll !
=ll" #
DateTimell$ ,
.ll, -
Nowll- 0
,ll0 1

CampaignIdmm "
=mm# $
campaignmm% -
.mm- .
Idmm. 0
,mm0 1
OrderNumbernn #
=nn$ %
campaignnn& .
.nn. /
OrderNumbernn/ :
,nn: ;
SegmentNumberoo %
=oo& '
segmentoo( /
.oo/ 0
SegmentNumberoo0 =
,oo= >
Quantitypp  
=pp! "
segmentpp# *
.pp* +
Quantitypp+ 3
,pp3 4
DateSentqq  
=qq! "
DateTimeqq# +
.qq+ ,
Nowqq, /
,qq/ 0
	SentOrderrr !
=rr" #
	sentOrderrr$ -
,rr- .
IsCreatedThroughApiss +
=ss, -
orderViass. 6
==ss7 9
OrderViass: B
.ssB C
ApissC F
,ssF G
QueuedCampaignIdtt (
=tt) *
queuedCampaignIdtt+ ;
}uu 
;uu 
dbvv 
.vv 
CampaignTrackingsvv (
.vv( )
Addvv) ,
(vv, -
trackingvv- 5
)vv5 6
;vv6 7
dbww 
.ww 
SaveChangesww "
(ww" #
)ww# $
;ww$ %
}xx 
elseyy 
{zz 
campaignTracking{{ $
.{{$ %
Quantity{{% -
={{. /
segment{{0 7
.{{7 8
Quantity{{8 @
;{{@ A
campaignTracking|| $
.||$ %
DateSent||% -
=||. /
DateTime||0 8
.||8 9
Now||9 <
;||< =
campaignTracking}} $
.}}$ %
	SentOrder}}% .
=}}/ 0
	sentOrder}}1 :
;}}: ;
campaignTracking~~ $
.~~$ %
IsCreatedThroughApi~~% 8
=~~9 :
orderVia~~; C
==~~D F
OrderVia~~G O
.~~O P
Api~~P S
;~~S T
campaignTracking $
.$ %
QueuedCampaignId% 5
=6 7
queuedCampaignId8 H
;H I
}
ÄÄ 
	LogHelper
ÇÇ 
.
ÇÇ 
AddLog
ÇÇ  
(
ÇÇ  !
db
ÇÇ! #
,
ÇÇ# $
LogType
ÇÇ% ,
.
ÇÇ, -
Vendor
ÇÇ- 3
,
ÇÇ3 4
campaign
ÇÇ5 =
.
ÇÇ= >
OrderNumber
ÇÇ> I
,
ÇÇI J
$"
ÇÇK M
Multi 
ÇÇM S
{
ÇÇS T
segment
ÇÇT [
.
ÇÇ[ \
SegmentNumber
ÇÇ\ i
}
ÇÇi j5
& has been sent to vendor successfully.ÇÇj ê
"ÇÇê ë
)ÇÇë í
;ÇÇí ì
}
ÉÉ 
}
ÑÑ 	
private
ÜÜ 
static
ÜÜ 
void
ÜÜ  
SendToVendorSingle
ÜÜ .
(
ÜÜ. /
OrderVia
ÜÜ/ 7
orderVia
ÜÜ8 @
,
ÜÜ@ A
WfpictContext
ÜÜB O
db
ÜÜP R
,
ÜÜR S
Campaign
ÜÜT \
campaign
ÜÜ] e
,
ÜÜe f
Vendor
ÜÜg m
vendor
ÜÜn t
,
ÜÜt u
string
ÜÜv |
whiteLabelDomainÜÜ} ç
)ÜÜç é
{
áá 	
string
àà 
	sentOrder
àà 
,
àà 
queuedCampaignId
àà .
=
àà/ 0
null
àà1 5
;
àà5 6
switch
ââ 
(
ââ 
orderVia
ââ 
)
ââ 
{
ää 
case
ãã 
OrderVia
ãã 
.
ãã 
Email
ãã #
:
ãã# $
	sentOrder
åå 
=
åå 
EmailHelper
åå  +
.
åå+ ,"
SendApprovedToVendor
åå, @
(
åå@ A
vendor
ååA G
,
ååG H
campaign
ååI Q
,
ååQ R
null
ååS W
)
ååW X
;
ååX Y
break
çç 
;
çç 
case
éé 
OrderVia
éé 
.
éé 
Api
éé !
:
éé! "
var
èè 
response
èè  
=
èè! "
ProDataApiManager
èè# 4
.
èè4 5
Create
èè5 ;
(
èè; <
campaign
èè< D
,
èèD E
null
èèF J
,
èèJ K
whiteLabelDomain
èèL \
)
èè\ ]
;
èè] ^
if
êê 
(
êê 
response
êê  
.
êê  !
status
êê! '
!=
êê( *
ProDataApiManager
êê+ <
.
êê< =
Success
êê= D
)
êêD E
{
ëë 
throw
íí 
new
íí !
AdsException
íí" .
(
íí. /
response
íí/ 7
.
íí7 8
ErrorMessage
íí8 D
)
ííD E
;
ííE F
}
ìì 
	sentOrder
îî 
=
îî 
response
îî  (
.
îî( )
RequestMessage
îî) 7
;
îî7 8
queuedCampaignId
ïï $
=
ïï% &
response
ïï' /
.
ïï/ 0(
queued_pending_campaign_id
ïï0 J
.
ïïJ K
ToString
ïïK S
(
ïïS T
)
ïïT U
;
ïïU V
break
ññ 
;
ññ 
default
óó 
:
óó 
throw
òò 
new
òò 
AdsException
òò *
(
òò* +
$str
òò+ \
)
òò\ ]
;
òò] ^
}
ôô 
string
õõ 
orderNumberRdp
õõ !
=
õõ" #
campaign
õõ$ ,
.
õõ, -
ReBroadcasted
õõ- :
?
õõ; <
campaign
õõ= E
.
õõE F&
ReBroadcastedOrderNumber
õõF ^
:
õõ_ `
campaign
õõa i
.
õõi j
OrderNumber
õõj u
;
õõu v
long
úú 
quantity
úú 
=
úú 
campaign
úú $
.
úú$ %
ReBroadcasted
úú% 2
?
úú3 4
campaign
úú5 =
.
úú= >#
ReBroadcastedQuantity
úú> S
:
úúT U
campaign
úúV ^
.
úú^ _
Approved
úú_ g
.
úúg h
Quantity
úúh p
;
úúp q
var
ûû 
campaignTracking
ûû  
=
ûû! "
db
üü 
.
üü 
CampaignTrackings
üü '
.
üü' (
FirstOrDefault
üü( 6
(
üü6 7
x
üü7 8
=>
üü9 ;
x
üü< =
.
üü= >

CampaignId
üü> H
==
üüI K
campaign
üüL T
.
üüT U
Id
üüU W
&&
üüX Z
x
üü[ \
.
üü\ ]
OrderNumber
üü] h
==
üüi k
orderNumberRdp
üül z
&&
üü{ }
stringüü~ Ñ
.üüÑ Ö
IsNullOrEmptyüüÖ í
(üüí ì
xüüì î
.üüî ï
SegmentNumberüüï ¢
)üü¢ £
)üü£ §
;üü§ •
if
°° 
(
°° 
campaignTracking
°°  
==
°°! #
null
°°$ (
)
°°( )
{
¢¢ 
var
££ 

trackingId
££ 
=
££  
Guid
££! %
.
££% &
NewGuid
££& -
(
££- .
)
££. /
;
££/ 0
var
§§ 
tracking
§§ 
=
§§ 
new
§§ "
CampaignTracking
§§# 3
(
§§3 4
)
§§4 5
{
•• 
Id
¶¶ 
=
¶¶ 

trackingId
¶¶ #
,
¶¶# $
	CreatedAt
ßß 
=
ßß 
DateTime
ßß  (
.
ßß( )
Now
ßß) ,
,
ßß, -

CampaignId
®® 
=
®®  
campaign
®®! )
.
®®) *
Id
®®* ,
,
®®, -
OrderNumber
©© 
=
©©  !
orderNumberRdp
©©" 0
,
©©0 1
SegmentNumber
™™ !
=
™™" #
string
™™$ *
.
™™* +
Empty
™™+ 0
,
™™0 1
Quantity
´´ 
=
´´ 
quantity
´´ '
,
´´' (
DateSent
¨¨ 
=
¨¨ 
DateTime
¨¨ '
.
¨¨' (
Now
¨¨( +
,
¨¨+ ,
	SentOrder
≠≠ 
=
≠≠ 
	sentOrder
≠≠  )
,
≠≠) *!
IsCreatedThroughApi
ÆÆ '
=
ÆÆ( )
orderVia
ÆÆ* 2
==
ÆÆ3 5
OrderVia
ÆÆ6 >
.
ÆÆ> ?
Api
ÆÆ? B
,
ÆÆB C
QueuedCampaignId
ØØ $
=
ØØ% &
queuedCampaignId
ØØ' 7
}
∞∞ 
;
∞∞ 
db
±± 
.
±± 
CampaignTrackings
±± $
.
±±$ %
Add
±±% (
(
±±( )
tracking
±±) 1
)
±±1 2
;
±±2 3
}
≤≤ 
else
≤≤ 
{
≥≥ 
campaignTracking
¥¥  
.
¥¥  !
Quantity
¥¥! )
=
¥¥* +
quantity
¥¥, 4
;
¥¥4 5
campaignTracking
µµ  
.
µµ  !
DateSent
µµ! )
=
µµ* +
DateTime
µµ, 4
.
µµ4 5
Now
µµ5 8
;
µµ8 9
campaignTracking
∂∂  
.
∂∂  !
	SentOrder
∂∂! *
=
∂∂+ ,
	sentOrder
∂∂- 6
;
∂∂6 7
campaignTracking
∑∑  
.
∑∑  !!
IsCreatedThroughApi
∑∑! 4
=
∑∑5 6
orderVia
∑∑7 ?
==
∑∑@ B
OrderVia
∑∑C K
.
∑∑K L
Api
∑∑L O
;
∑∑O P
campaignTracking
∏∏  
.
∏∏  !
QueuedCampaignId
∏∏! 1
=
∏∏2 3
queuedCampaignId
∏∏4 D
;
∏∏D E
}
ππ 
db
∫∫ 
.
∫∫ 
SaveChanges
∫∫ 
(
∫∫ 
)
∫∫ 
;
∫∫ 
	LogHelper
ºº 
.
ºº 
AddLog
ºº 
(
ºº 
db
ºº 
,
ºº  
LogType
ºº! (
.
ºº( )
Vendor
ºº) /
,
ºº/ 0
campaign
ºº1 9
.
ºº9 :
OrderNumber
ºº: E
,
ººE F
!
ººG H
campaign
ººH P
.
ººP Q
ReBroadcasted
ººQ ^
?
ΩΩ 
$str
ΩΩ C
:
ææ 
$str
ææ J
)
ææJ K
;
ææK L
}
øø 	
}
¿¿ 
}¡¡ ‰≥
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataFiles\DataFileProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	DataFiles' 0
{ 
public 

static 
class 
DataFileProcessor )
{ 
public 
static 
void 
FetchSqlDataFile +
(+ ,
string, 2

uploadPath3 =
,= >
bool? C
isNxsD I
,I J
GuidK O

campaignIdP Z
,Z [
string\ b
orderNumberc n
,n o
string 
zipCodeFile 
, 
long  $
dataQuantity% 1
)1 2
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
DataProcessing- ;
,; <
orderNumber= H
,H I
$"J L1
%SQL Data files processing started at L q
{q r
DateTimer z
.z {
Now{ ~
}~ 
"	 Ä
)
Ä Å
;
Å Ç
try 
{ 
List 
< 
string 
>  
list! %
=& '
ProcessZipFile( 6
(6 7
db7 9
,9 :

uploadPath; E
,E F
zipCodeFileG R
,R S
orderNumberT _
)_ `
;` a
try 
{ 
var   
data    
=  ! "
SegmentDataManager  # 5
.  5 6
FetchSegmentsData  6 G
(  G H
db  H J
,  J K
new  L O
SegmentParameters  P a
{!! 
OrderNumber"" '
=""( )
orderNumber""* 5
,""5 6
DataQuantity## (
=##) *
dataQuantity##+ 7
,##7 8
CustomerCode$$ (
=$$) *
SegmentDataManager$$+ =
.$$= >
CustomerCode$$> J
,$$J K
ZipCodes%% $
=%%% &
list%%' +
}&& 
)&& 
;&& 
	LogHelper(( !
.((! "
AddLog((" (
(((( )
db(() +
,((+ ,
LogType((- 4
.((4 5
DataProcessing((5 C
,((C D
orderNumber((E P
,((P Q
$"((R T
{((T U
data((U Y
.((Y Z
Count((Z _
}((_ `*
 records feteched sucessfully.((` ~
"((~ 
)	(( Ä
;
((Ä Å"
WriteAndUploadDataFile++ .
(++. /
data++/ 3
,++3 4
db++5 7
,++7 8

uploadPath++9 C
,++C D
orderNumber++E P
,++P Q

campaignId++R \
)++\ ]
;++] ^
if-- 
(-- 
isNxs-- !
)--! "
{.. (
WriteAndUploadDataFileOpener00 8
(008 9
data009 =
,00= >
db00? A
,00A B

uploadPath00C M
,00M N
orderNumber00O Z
,00Z [

campaignId00\ f
)00f g
;00g h
}11 
Campaign44  
campaign44! )
=44* +
db55 
.55 
	Campaigns55 (
.55( )
Include55) 0
(550 1
x551 2
=>553 5
x556 7
.557 8
Segments558 @
)55@ A
.55A B
FirstOrDefault55B P
(55P Q
x55Q R
=>55S U
x55V W
.55W X
OrderNumber55X c
==55d f
orderNumber55g r
)55r s
;55s t
foreach77 
(77  !
var77! $
segment77% ,
in77- /
campaign770 8
.778 9
Segments779 A
.77A B
OrderBy77B I
(77I J
x77J K
=>77L N
x77O P
.77P Q
SegmentNumber77Q ^
)77^ _
)77_ `
{88 )
WriteAndUploadSegmentDataFile99 9
(999 :
data99: >
,99> ?
db99@ B
,99B C
segment99D K
,99K L

uploadPath99M W
,99W X
orderNumber99Y d
,99d e

campaignId99f p
)99p q
;99q r
}:: 
db;; 
.;; 
SaveChanges;; &
(;;& '
);;' (
;;;( )
	LogHelper== !
.==! "
AddLog==" (
(==( )
db==) +
,==+ ,
LogType==- 4
.==4 5
DataProcessing==5 C
,==C D
orderNumber==E P
,==P Q
$"==R T4
(SQL Data files generated sucessfully at ==T |
{==| }
DateTime	==} Ö
.
==Ö Ü
Now
==Ü â
}
==â ä
"
==ä ã
)
==ã å
;
==å ç
}>> 
catch?? 
(?? 
	Exception?? $
ex??% '
)??' (
{@@ 
	LogHelperAA !
.AA! "
AddErrorAA" *
(AA* +
dbAA+ -
,AA- .
LogTypeAA/ 6
.AA6 7
DataProcessingAA7 E
,AAE F
orderNumberAAG R
,AAR S
$strAAT z
+AA{ |
exAA} 
.	AA Ä
Message
AAÄ á
)
AAá à
;
AAà â
}BB 
}DD 
catchEE 
(EE 
	ExceptionEE  
exEE! #
)EE# $
{FF 
	LogHelperGG 
.GG 
AddErrorGG &
(GG& '
dbGG' )
,GG) *
LogTypeGG+ 2
.GG2 3
DataProcessingGG3 A
,GGA B
orderNumberGGC N
,GGN O
$strGGP c
+GGd e
zipCodeFileGGf q
+GGr s
$strGGt w
+GGx y
exGGz |
.GG| }
Message	GG} Ñ
)
GGÑ Ö
;
GGÖ Ü
}HH 
}II 
}JJ 	
privateLL 
staticLL 
voidLL (
WriteAndUploadDataFileOpenerLL 8
(LL8 9
ListLL9 =
<LL= >
SegmentResponseLL> M
>LLM N
dataLLO S
,LLS T
WfpictContextLLU b
dbLLc e
,LLe f
stringLLg m

uploadPathLLn x
,LLx y
string	LLz Ä
orderNumber
LLÅ å
,
LLå ç
Guid
LLé í

campaignId
LLì ù
)
LLù û
{MM 	
stringNN 
fileNameNN 
=NN 
$"NN  
{NN  !
orderNumberNN! ,
}NN, -
\\NN- /
{NN/ 0
orderNumberNN0 ;
}NN; <

opener.csvNN< F
"NNF G
;NNG H
varOO 
filePathOO 
=OO 
$"OO 
{OO 

uploadPathOO (
}OO( )
\\OO) +
{OO+ ,
fileNameOO, 4
}OO4 5
"OO5 6
;OO6 7
dataPP 
.PP 
ToCsvPP 
(PP 
filePathPP 
,PP  
newPP! $
CsvDefinitionPP% 2
(PP2 3
)PP3 4
{QQ 
	EndOfLineRR 
=RR 
$strRR "
,RR" #
FieldSeparatorSS 
=SS  
$charSS! $
,SS$ %
TextQualifierTT 
=TT 
$charTT  #
,TT# $
ColumnsUU 
=UU 
newVV 
ListVV 
<VV 
stringVV #
>VV# $
{WW 
$strXX( 7
,XX7 8
$strYY( 3
,YY3 4
$strZZ( 2
,ZZ2 3
$str[[( 1
,[[1 2
$str\\( .
,\\. /
$str]]( /
,]]/ 0
$str^^( -
,^^- .
$str__( .
,__. /
$str``( -
}aa 
}bb 
)bb 
;bb 
stringcc 
amazonFileKeycc  
=cc! "
$"cc# %
{cc% &
orderNumbercc& 1
}cc1 2
/cc2 3
{cc3 4
orderNumbercc4 ?
}cc? @

opener.csvcc@ J
"ccJ K
;ccK L
S3FileManagerdd 
.dd 
Uploaddd  
(dd  !
amazonFileKeydd! .
,dd. /
filePathdd0 8
,dd8 9
truedd: >
)dd> ?
;dd? @
varff 
campaignTestingff 
=ff  !
dbff" $
.ff$ %
CampaignsTestingff% 5
.ff5 6
FirstOrDefaultff6 D
(ffD E
xffE F
=>ffG I
xffJ K
.ffK L

CampaignIdffL V
==ffW Y

campaignIdffZ d
)ffd e
;ffe f
ifgg 
(gg 
campaignTestinggg 
!=gg  "
nullgg# '
)gg' (
{hh 
campaignTestingii 
.ii  
DataFileUrlOpenerii  1
=ii2 3
FileManagerii4 ?
.ii? @
GetFilePathLiveii@ O
(iiO P
UploadFileTypeiiP ^
.ii^ _
DataFileOpenerii_ m
,iim n
orderNumberjj 
,jj  
stringjj! '
.jj' (
Emptyjj( -
,jj- .
stringjj/ 5
.jj5 6
Emptyjj6 ;
)jj; <
;jj< =
}kk 
dbll 
.ll 
SaveChangesll 
(ll 
)ll 
;ll 
	LogHelpernn 
.nn 
AddLognn 
(nn 
dbnn 
,nn  
LogTypenn! (
.nn( )
DataProcessingnn) 7
,nn7 8
orderNumbernn9 D
,nnD E
fileNameoo 
+oo 
$stroo \
)oo\ ]
;oo] ^
}qq 	
privatess 
staticss 
voidss )
WriteAndUploadSegmentDataFiless 9
(ss9 :
Listss: >
<ss> ?
SegmentResponsess? N
>ssN O
datassP T
,ssT U
WfpictContextssV c
dbssd f
,ssf g
CampaignSegmentssh w
segmentssx 
,	ss Ä
string
ssÅ á

uploadPath
ssà í
,
ssí ì
string
ssî ö
orderNumber
ssõ ¶
,
ss¶ ß
Guid
ss® ¨

campaignId
ss≠ ∑
)
ss∑ ∏
{tt 	
stringuu 
	fileName1uu 
=uu 
$"uu !
{uu! "
orderNumberuu" -
}uu- .
\\uu. 0
{uu0 1
segmentuu1 8
.uu8 9
SegmentNumberuu9 F
}uuF G
data.csvuuG O
"uuO P
;uuP Q
varvv 
	filePath1vv 
=vv 
$"vv 
{vv 

uploadPathvv )
}vv) *
\\vv* ,
{vv, -
	fileName1vv- 6
}vv6 7
"vv7 8
;vv8 9
varww 
data1ww 
=ww 
dataxx 
.xx 
Wherexx 
(xx 
xxx 
=>xx 
xxx  !
.xx! "
Indexxx" '
>=xx( *
segmentxx+ 2
.xx2 3
FirstRangeStartxx3 B
&&xxC E
xxxF G
.xxG H
IndexxxH M
<=xxN P
segmentxxQ X
.xxX Y
FirstRangeEndxxY f
)xxf g
.xxg h
ToListxxh n
(xxn o
)xxo p
;xxp q
varyy 
data2yy 
=yy 
datazz 
.zz 
Wherezz 
(zz 
xzz 
=>zz 
xzz  !
.zz! "
Indexzz" '
>=zz( *
segmentzz+ 2
.zz2 3
SecondRangeStartzz3 C
&&zzD F
xzzG H
.zzH I
IndexzzI N
<=zzO Q
segmentzzR Y
.zzY Z
SecondRangeEndzzZ h
)zzh i
.{{ 
ToList{{ 
({{ 
){{ 
;{{ 
var|| 
data3|| 
=|| 
data}} 
.}} 
Where}} 
(}} 
x}} 
=>}} 
x}}  !
.}}! "
Index}}" '
>=}}( *
segment}}+ 2
.}}2 3
ThirdRangeStart}}3 B
&&}}C E
x}}F G
.}}G H
Index}}H M
<=}}N P
segment}}Q X
.}}X Y
ThirdRangeEnd}}Y f
)}}f g
.}}g h
ToList}}h n
(}}n o
)}}o p
;}}p q
data2~~ 
.~~ 
AddRange~~ 
(~~ 
data3~~  
)~~  !
;~~! "
data1 
. 
AddRange 
( 
data2  
)  !
;! "
data1
ÄÄ 
=
ÄÄ 
data1
ÄÄ 
.
ÄÄ 
OrderBy
ÄÄ !
(
ÄÄ! "
x
ÄÄ" #
=>
ÄÄ$ &
x
ÄÄ' (
.
ÄÄ( )
Index
ÄÄ) .
)
ÄÄ. /
.
ÄÄ/ 0
ToList
ÄÄ0 6
(
ÄÄ6 7
)
ÄÄ7 8
;
ÄÄ8 9
data1
ÅÅ 
.
ÅÅ 
ToCsv
ÅÅ 
(
ÅÅ 
	filePath1
ÅÅ !
,
ÅÅ! "
new
ÅÅ# &
CsvDefinition
ÅÅ' 4
(
ÅÅ4 5
)
ÅÅ5 6
{
ÇÇ 
	EndOfLine
ÉÉ 
=
ÉÉ 
$str
ÉÉ "
,
ÉÉ" #
FieldSeparator
ÑÑ 
=
ÑÑ  
$char
ÑÑ! $
,
ÑÑ$ %
TextQualifier
ÖÖ 
=
ÖÖ 
$char
ÖÖ  #
,
ÖÖ# $
Columns
ÜÜ 
=
ÜÜ 
new
áá 
List
áá 
<
áá 
string
áá #
>
áá# $
{
àà 
$str
ââ( 7
,
ââ7 8
$str
ää( 3
,
ää3 4
$str
ãã( 2
,
ãã2 3
$str
åå( 1
,
åå1 2
$str
çç( .
,
çç. /
$str
éé( /
,
éé/ 0
$str
èè( -
,
èè- .
$str
êê( .
,
êê. /
$str
ëë( -
,
ëë- .
$str
íí( 7
,
íí7 8
$str
ìì( /
,
ìì/ 0
}
îî 
}
ïï 
)
ïï 
;
ïï 
string
ññ 
amazonFileKey1
ññ !
=
ññ" #
$"
ññ$ &
{
ññ& '
orderNumber
ññ' 2
}
ññ2 3
/
ññ3 4
{
ññ4 5
segment
ññ5 <
.
ññ< =
SegmentNumber
ññ= J
}
ññJ K
data.csv
ññK S
"
ññS T
;
ññT U
S3FileManager
óó 
.
óó 
Upload
óó  
(
óó  !
amazonFileKey1
óó! /
,
óó/ 0
	filePath1
óó1 :
,
óó: ;
true
óó< @
)
óó@ A
;
óóA B
segment
ôô 
.
ôô  
SegmentDataFileUrl
ôô &
=
ôô' (
FileManager
ôô) 4
.
ôô4 5
GetFilePathLive
ôô5 D
(
ôôD E
UploadFileType
ôôE S
.
ôôS T
DataFile
ôôT \
,
ôô\ ]
orderNumber
öö 
,
öö 
string
öö #
.
öö# $
Empty
öö$ )
,
öö) *
segment
öö+ 2
.
öö2 3
SegmentNumber
öö3 @
)
öö@ A
;
ööA B
segment
õõ 
.
õõ 
DateFetched
õõ 
=
õõ  !
DateTime
õõ" *
.
õõ* +
Now
õõ+ .
;
õõ. /
segment
úú 
.
úú 
UploadStatus
úú  
=
úú! "
(
úú# $
int
úú$ '
)
úú' (
UploadFileStatus
úú( 8
.
úú8 9
	Completed
úú9 B
;
úúB C
segment
ùù 
.
ùù 
SegmentStatus
ùù !
=
ùù" #
(
ùù$ %
int
ùù% (
)
ùù( )
SegmentStatus
ùù) 6
.
ùù6 7
	Generated
ùù7 @
;
ùù@ A
	LogHelper
üü 
.
üü 
AddLog
üü 
(
üü 
db
üü 
,
üü  
LogType
üü! (
.
üü( )
DataProcessing
üü) 7
,
üü7 8
orderNumber
üü9 D
,
üüD E
	fileName1
†† 
+
†† 
$str
†† V
)
††V W
;
††W X
}
¢¢ 	
private
§§ 
static
§§ 
void
§§ $
WriteAndUploadDataFile
§§ 2
(
§§2 3
List
§§3 7
<
§§7 8
SegmentResponse
§§8 G
>
§§G H
data
§§I M
,
§§M N
WfpictContext
§§O \
db
§§] _
,
§§_ `
string
§§a g

uploadPath
§§h r
,
§§r s
string
•• 
orderNumber
•• 
,
•• 
Guid
••  $

campaignId
••% /
)
••/ 0
{
¶¶ 	
string
ßß 
fileName
ßß 
=
ßß 
$"
ßß  
{
ßß  !
orderNumber
ßß! ,
}
ßß, -
\\
ßß- /
{
ßß/ 0
orderNumber
ßß0 ;
}
ßß; <
data.csv
ßß< D
"
ßßD E
;
ßßE F
var
®® 
filePath
®® 
=
®® 
$"
®® 
{
®® 

uploadPath
®® (
}
®®( )
\\
®®) +
{
®®+ ,
fileName
®®, 4
}
®®4 5
"
®®5 6
;
®®6 7
data
©© 
.
©© 
Sort
©© 
(
©© 
(
©© 
x
©© 
,
©© 
y
©© 
)
©© 
=>
©© 
x
©©  !
.
©©! "
Index
©©" '
.
©©' (
	CompareTo
©©( 1
(
©©1 2
y
©©2 3
.
©©3 4
Index
©©4 9
)
©©9 :
)
©©: ;
;
©©; <
data
™™ 
.
™™ 
ToCsv
™™ 
(
™™ 
filePath
™™ 
,
™™  
new
™™! $
CsvDefinition
™™% 2
(
™™2 3
)
™™3 4
{
´´ 
	EndOfLine
¨¨ 
=
¨¨ 
$str
¨¨ "
,
¨¨" #
FieldSeparator
≠≠ 
=
≠≠  
$char
≠≠! $
,
≠≠$ %
TextQualifier
ÆÆ 
=
ÆÆ 
$char
ÆÆ  #
,
ÆÆ# $
Columns
ØØ 
=
ØØ 
new
∞∞ 
List
∞∞ 
<
∞∞ 
string
∞∞ #
>
∞∞# $
{
±± 
$str
≤≤ '
,
≤≤' (
$str
≥≥ #
,
≥≥# $
$str
¥¥ "
,
¥¥" #
$str
µµ !
,
µµ! "
$str
∂∂ 
,
∂∂ 
$str
∑∑ 
,
∑∑  
$str
∏∏ 
,
∏∏ 
$str
ππ 
,
ππ 
$str
∫∫ 
,
∫∫ 
$str
ªª '
,
ªª' (
$str
ºº 
,
ºº  
}
ΩΩ 
}
ææ 
)
ææ 
;
ææ 
string
øø 
amazonFileKey
øø  
=
øø! "
$"
øø# %
{
øø% &
orderNumber
øø& 1
}
øø1 2
/
øø2 3
{
øø3 4
orderNumber
øø4 ?
}
øø? @
data.csv
øø@ H
"
øøH I
;
øøI J
S3FileManager
¿¿ 
.
¿¿ 
Upload
¿¿  
(
¿¿  !
amazonFileKey
¿¿! .
,
¿¿. /
filePath
¿¿0 8
,
¿¿8 9
true
¿¿: >
)
¿¿> ?
;
¿¿? @
	LogHelper
¡¡ 
.
¡¡ 
AddLog
¡¡ 
(
¡¡ 
db
¡¡ 
,
¡¡  
LogType
¡¡! (
.
¡¡( )
DataProcessing
¡¡) 7
,
¡¡7 8
orderNumber
¡¡9 D
,
¡¡D E
$"
¡¡F H
{
¡¡H I
fileName
¡¡I Q
}
¡¡Q RG
8 data file generated and uploaded to Amazon sucessfully.¡¡R ä
"¡¡ä ã
)¡¡ã å
;¡¡å ç
var
√√ 
campaignTesting
√√ 
=
√√  !
db
√√" $
.
√√$ %
CampaignsTesting
√√% 5
.
√√5 6
FirstOrDefault
√√6 D
(
√√D E
x
√√E F
=>
√√G I
x
√√J K
.
√√K L

CampaignId
√√L V
==
√√W Y

campaignId
√√Z d
)
√√d e
;
√√e f
if
ƒƒ 
(
ƒƒ 
campaignTesting
ƒƒ 
!=
ƒƒ  "
null
ƒƒ# '
)
ƒƒ' (
{
≈≈ 
campaignTesting
∆∆ 
.
∆∆  
DataFileUrl
∆∆  +
=
∆∆, -
amazonFileKey
∆∆. ;
;
∆∆; <
campaignTesting
«« 
.
««  
DateFetched
««  +
=
««, -
DateTime
««. 6
.
««6 7
Now
««7 :
;
««: ;
}
»» 
db
…… 
.
…… 
SaveChanges
…… 
(
…… 
)
…… 
;
…… 
}
   	
private
ÃÃ 
static
ÃÃ 
List
ÃÃ 
<
ÃÃ 
string
ÃÃ "
>
ÃÃ" #
ProcessZipFile
ÃÃ$ 2
(
ÃÃ2 3
WfpictContext
ÃÃ3 @
db
ÃÃA C
,
ÃÃC D
string
ÃÃE K

uploadPath
ÃÃL V
,
ÃÃV W
string
ÃÃX ^
zipCodeFile
ÃÃ_ j
,
ÃÃj k
string
ÃÃl r
orderNumber
ÃÃs ~
)
ÃÃ~ 
{
ÕÕ 	
string
ŒŒ 
zipFilePath
ŒŒ 
=
ŒŒ  
Path
ŒŒ! %
.
ŒŒ% &
Combine
ŒŒ& -
(
ŒŒ- .

uploadPath
ŒŒ. 8
,
ŒŒ8 9
zipCodeFile
ŒŒ: E
)
ŒŒE F
;
ŒŒF G
S3FileManager
œœ 
.
œœ 
Download
œœ "
(
œœ" #
zipCodeFile
œœ# .
,
œœ. /
zipFilePath
œœ0 ;
)
œœ; <
;
œœ< =
var
–– 
list
–– 
=
–– 
new
–– 
List
–– 
<
––  
string
––  &
>
––& '
(
––' (
)
––( )
;
––) *
foreach
—— 
(
—— 
var
—— 
line
—— 
in
——  
File
——! %
.
——% &
ReadAllLines
——& 2
(
——2 3
zipFilePath
——3 >
)
——> ?
)
——? @
{
““ 
var
”” 
trimmed
”” 
=
”” 
StringHelper
”” *
.
””* +
Trim
””+ /
(
””/ 0
line
””0 4
)
””4 5
;
””5 6
if
‘‘ 
(
‘‘ 
string
‘‘ 
.
‘‘ 
IsNullOrEmpty
‘‘ (
(
‘‘( )
trimmed
‘‘) 0
)
‘‘0 1
)
‘‘1 2
continue
‘‘3 ;
;
‘‘; <
list
’’ 
.
’’ 
Add
’’ 
(
’’ 
trimmed
’’  
)
’’  !
;
’’! "
}
÷÷ 
	LogHelper
◊◊ 
.
◊◊ 
AddLog
◊◊ 
(
◊◊ 
db
◊◊ 
,
◊◊  
LogType
◊◊! (
.
◊◊( )
DataProcessing
◊◊) 7
,
◊◊7 8
orderNumber
◊◊9 D
,
◊◊D E
$"
◊◊F H
ZipCodeFile 
◊◊H T
{
◊◊T U
zipCodeFile
◊◊U `
}
◊◊` a%
 processed sucessfully.
◊◊a x
"
◊◊x y
)
◊◊y z
;
◊◊z {
return
ÿÿ 
list
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
}
⁄⁄ 
}€€ ¢Ä
OD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Campaigns\FileProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	Campaigns' 0
{ 
public 

static 
class 
FileProcessor %
{ 
public 
static 
void  
ProcessNewOrderFiles /
(/ 0
WfpictContext0 =
db> @
,@ A
CampaignB J
campaignK S
)S T
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
campaign& .
.. /
Assets/ 5
.5 6
CreativeFiles6 C
)C D
)D E
{ 
string 
amazonFileKey $
=% &
string' -
.- .
Format. 4
(4 5
$str5 G
,G H
campaignI Q
.Q R
OrderNumberR ]
)] ^
;^ _
S3FileManager 
. 
Move "
(" #
campaign# +
.+ ,
Assets, 2
.2 3
CreativeFiles3 @
,@ A
amazonFileKeyB O
,O P
campaignQ Y
.Y Z
OrderNumberZ e
,e f
trueg k
)k l
;l m
campaign 
. 
Assets 
.  
CreativeFiles  -
=. /
amazonFileKey0 =
;= >
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
FileProcessing- ;
,; <
campaign= E
.E F
OrderNumberF Q
,Q R
$str -
+. /
amazonFileKey0 =
)= >
;> ?
} 
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
campaign& .
.. /
Assets/ 5
.5 6
ZipCodeFile6 A
)A B
)B C
{ 
string 
amazonFileKey $
=% &
string' -
.- .
Format. 4
(4 5
$str5 E
,E F
campaignG O
.O P
OrderNumberP [
)[ \
;\ ]
S3FileManager 
. 
Move "
(" #
campaign# +
.+ ,
Assets, 2
.2 3
ZipCodeFile3 >
,> ?
amazonFileKey@ M
,M N
campaignO W
.W X
OrderNumberX c
,c d
truee i
)i j
;j k
campaign 
. 
Assets 
.  
ZipCodeFile  +
=, -
amazonFileKey. ;
;; <
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
FileProcessing- ;
,; <
campaign= E
.E F
OrderNumberF Q
,Q R
$str +
+, -
amazonFileKey. ;
); <
;< =
}   
if!! 
(!! 
!!! 
string!! 
.!! 
IsNullOrEmpty!! %
(!!% &
campaign!!& .
.!!. /
Assets!!/ 5
.!!5 6
TestSeedFile!!6 B
)!!B C
)!!C D
{"" 
string## 
amazonFileKey## $
=##% &
string##' -
.##- .
Format##. 4
(##4 5
$str##5 F
,##F G
campaign##H P
.##P Q
OrderNumber##Q \
)##\ ]
;##] ^
S3FileManager$$ 
.$$ 
Move$$ "
($$" #
campaign$$# +
.$$+ ,
Assets$$, 2
.$$2 3
TestSeedFile$$3 ?
,$$? @
amazonFileKey$$A N
,$$N O
campaign$$P X
.$$X Y
OrderNumber$$Y d
,$$d e
true$$f j
)$$j k
;$$k l
campaign%% 
.%% 
Assets%% 
.%%  
TestSeedFile%%  ,
=%%- .
amazonFileKey%%/ <
;%%< =
	LogHelper&& 
.&& 
AddLog&&  
(&&  !
db&&! #
,&&# $
LogType&&% ,
.&&, -
FileProcessing&&- ;
,&&; <
campaign&&= E
.&&E F
OrderNumber&&F Q
,&&Q R
$str'' ,
+''- .
amazonFileKey''/ <
)''< =
;''= >
}(( 
if)) 
()) 
!)) 
string)) 
.)) 
IsNullOrEmpty)) %
())% &
campaign))& .
.)). /
Assets))/ 5
.))5 6
LiveSeedFile))6 B
)))B C
)))C D
{** 
string++ 
amazonFileKey++ $
=++% &
string++' -
.++- .
Format++. 4
(++4 5
$str++5 F
,++F G
campaign++H P
.++P Q
OrderNumber++Q \
)++\ ]
;++] ^
S3FileManager,, 
.,, 
Move,, "
(,," #
campaign,,# +
.,,+ ,
Assets,,, 2
.,,2 3
LiveSeedFile,,3 ?
,,,? @
amazonFileKey,,A N
,,,N O
campaign,,P X
.,,X Y
OrderNumber,,Y d
,,,d e
true,,f j
),,j k
;,,k l
campaign-- 
.-- 
Assets-- 
.--  
LiveSeedFile--  ,
=--- .
amazonFileKey--/ <
;--< =
	LogHelper.. 
... 
AddLog..  
(..  !
db..! #
,..# $
LogType..% ,
..., -
FileProcessing..- ;
,..; <
campaign..= E
...E F
OrderNumber..F Q
,..Q R
$str// ,
+//- .
amazonFileKey/// <
)//< =
;//= >
}00 
if11 
(11 
!11 
string11 
.11 
IsNullOrEmpty11 %
(11% &
campaign11& .
.11. /
Assets11/ 5
.115 6
SuppressionFile116 E
)11E F
)11F G
{22 
string33 
amazonFileKey33 $
=33% &
string33' -
.33- .
Format33. 4
(334 5
$str335 F
,33F G
campaign33H P
.33P Q
OrderNumber33Q \
)33\ ]
;33] ^
S3FileManager44 
.44 
Move44 "
(44" #
campaign44# +
.44+ ,
Assets44, 2
.442 3
SuppressionFile443 B
,44B C
amazonFileKey44D Q
,44Q R
campaign44S [
.44[ \
OrderNumber44\ g
,44g h
true44i m
)44m n
;44n o
campaign55 
.55 
Assets55 
.55  
SuppressionFile55  /
=550 1
amazonFileKey552 ?
;55? @
	LogHelper66 
.66 
AddLog66  
(66  !
db66! #
,66# $
LogType66% ,
.66, -
FileProcessing66- ;
,66; <
campaign66= E
.66E F
OrderNumber66F Q
,66Q R
$str77 /
+770 1
amazonFileKey772 ?
)77? @
;77@ A
}88 
if99 
(99 
!99 
string99 
.99 
IsNullOrEmpty99 %
(99% &
campaign99& .
.99. /
Assets99/ 5
.995 6
BannersFile996 A
)99A B
)99B C
{:: 
string;; 
amazonFileKey;; $
=;;% &
string;;' -
.;;- .
Format;;. 4
(;;4 5
$str;;5 H
,;;H I
campaign;;J R
.;;R S
OrderNumber;;S ^
,;;^ _
Path<< 
.<< 
GetExtension<< %
(<<% &
campaign<<& .
.<<. /
Assets<</ 5
.<<5 6
BannersFile<<6 A
)<<A B
)<<B C
;<<C D
S3FileManager== 
.== 
Move== "
(==" #
campaign==# +
.==+ ,
Assets==, 2
.==2 3
BannersFile==3 >
,==> ?
amazonFileKey==@ M
,==M N
campaign==O W
.==W X
OrderNumber==X c
,==c d
true==e i
)==i j
;==j k
campaign>> 
.>> 
Assets>> 
.>>  
BannersFile>>  +
=>>, -
amazonFileKey>>. ;
;>>; <
	LogHelper?? 
.?? 
AddLog??  
(??  !
db??! #
,??# $
LogType??% ,
.??, -
FileProcessing??- ;
,??; <
campaign??= E
.??E F
OrderNumber??F Q
,??Q R
$str@@ +
+@@, -
amazonFileKey@@. ;
)@@; <
;@@< =
}AA 
ifBB 
(BB 
!BB 
stringBB 
.BB 
IsNullOrEmptyBB %
(BB% &
campaignBB& .
.BB. /
AssetsBB/ 5
.BB5 6
BannerLinksFileBB6 E
)BBE F
)BBF G
{CC 
stringDD 
amazonFileKeyDD $
=DD% &
stringDD' -
.DD- .
FormatDD. 4
(DD4 5
$strDD5 M
,DDM N
campaignDDO W
.DDW X
OrderNumberDDX c
,DDc d
PathEE 
.EE 
GetExtensionEE %
(EE% &
campaignEE& .
.EE. /
AssetsEE/ 5
.EE5 6
BannerLinksFileEE6 E
)EEE F
)EEF G
;EEG H
S3FileManagerFF 
.FF 
MoveFF "
(FF" #
campaignFF# +
.FF+ ,
AssetsFF, 2
.FF2 3
BannerLinksFileFF3 B
,FFB C
amazonFileKeyFFD Q
,FFQ R
campaignFFS [
.FF[ \
OrderNumberFF\ g
,FFg h
trueFFi m
)FFm n
;FFn o
campaignGG 
.GG 
AssetsGG 
.GG  
BannerLinksFileGG  /
=GG0 1
amazonFileKeyGG2 ?
;GG? @
	LogHelperHH 
.HH 
AddLogHH  
(HH  !
dbHH! #
,HH# $
LogTypeHH% ,
.HH, -
FileProcessingHH- ;
,HH; <
campaignHH= E
.HHE F
OrderNumberHHF Q
,HHQ R
$strII /
+II0 1
amazonFileKeyII2 ?
)II? @
;II@ A
}JJ 
ifKK 
(KK 
!KK 
stringKK 
.KK 
IsNullOrEmptyKK %
(KK% &
campaignKK& .
.KK. /
AssetsKK/ 5
.KK5 6
MiscFileKK6 >
)KK> ?
)KK? @
{LL 
stringMM 
amazonFileKeyMM $
=MM% &
stringMM' -
.MM- .
FormatMM. 4
(MM4 5
$strMM5 F
,MMF G
campaignMMH P
.MMP Q
OrderNumberMMQ \
,MM\ ]
PathNN 
.NN 
GetExtensionNN %
(NN% &
campaignNN& .
.NN. /
AssetsNN/ 5
.NN5 6
MiscFileNN6 >
)NN> ?
)NN? @
;NN@ A
S3FileManagerOO 
.OO 
MoveOO "
(OO" #
campaignOO# +
.OO+ ,
AssetsOO, 2
.OO2 3
MiscFileOO3 ;
,OO; <
amazonFileKeyOO= J
,OOJ K
campaignOOL T
.OOT U
OrderNumberOOU `
,OO` a
trueOOb f
)OOf g
;OOg h
campaignPP 
.PP 
AssetsPP 
.PP  
MiscFilePP  (
=PP) *
amazonFileKeyPP+ 8
;PP8 9
	LogHelperQQ 
.QQ 
AddLogQQ  
(QQ  !
dbQQ! #
,QQ# $
LogTypeQQ% ,
.QQ, -
FileProcessingQQ- ;
,QQ; <
campaignQQ= E
.QQE F
OrderNumberQQF Q
,QQQ R
$strQQS g
+QQh i
amazonFileKeyQQj w
)QQw x
;QQx y
}RR 
foreachTT 
(TT 
varTT 
segmentTT  
inTT! #
campaignTT$ ,
.TT, -
SegmentsTT- 5
)TT5 6
{UU 
ifVV 
(VV 
stringVV 
.VV 
IsNullOrEmptyVV '
(VV' (
segmentVV( /
.VV/ 0
CreativeFilesVV0 =
)VV= >
)VV> ?
continueVV@ H
;VVH I
stringWW 
amazonFileKeyWW $
=WW% &
$"WW' )
{WW) *
campaignWW* 2
.WW2 3
OrderNumberWW3 >
}WW> ?
/WW? @
{WW@ A
segmentWWA H
.WWH I
SegmentNumberWWI V
}WWV W
	_html.zipWWW `
"WW` a
;WWa b
S3FileManagerXX 
.XX 
MoveXX "
(XX" #
segmentXX# *
.XX* +
CreativeFilesXX+ 8
,XX8 9
amazonFileKeyXX: G
,XXG H
campaignXXI Q
.XXQ R
OrderNumberXXR ]
,XX] ^
trueXX_ c
)XXc d
;XXd e
segmentYY 
.YY 
CreativeFilesYY %
=YY& '
amazonFileKeyYY( 5
;YY5 6
	LogHelperZZ 
.ZZ 
AddLogZZ  
(ZZ  !
dbZZ! #
,ZZ# $
LogTypeZZ% ,
.ZZ, -
FileProcessingZZ- ;
,ZZ; <
campaignZZ= E
.ZZE F
OrderNumberZZF Q
,ZZQ R
$str[[ 
+[[  !
segment[[" )
.[[) *
SegmentNumber[[* 7
+[[8 9
$str[[: T
+[[U V
amazonFileKey[[W d
)[[d e
;[[e f
}\\ 
}]] 	
public__ 
static__ 
void__ "
ProcessAssetUpdateUrls__ 1
(__1 2
string__2 8

uploadPath__9 C
,__C D
string__E K
orderNumber__L W
)__W X
{`` 	
usingaa 
(aa 
varaa 
dbaa 
=aa 
newaa 
WfpictContextaa  -
(aa- .
)aa. /
)aa/ 0
{bb 
varcc 
campaigncc 
=cc 
dbcc !
.cc! "
	Campaignscc" +
.cc+ ,
Includecc, 3
(cc3 4
xcc4 5
=>cc6 8
xcc9 :
.cc: ;
Assetscc; A
)ccA B
.ccB C
FirstOrDefaultccC Q
(ccQ R
xccR S
=>ccT V
xccW X
.ccX Y
OrderNumberccY d
==cce g
orderNumbercch s
)ccs t
;cct u
varee 
	directoryee 
=ee 
$"ee  "
{ee" #

uploadPathee# -
}ee- .
\\ee. 0
{ee0 1
campaignee1 9
.ee9 :
OrderNumberee: E
}eeE F
"eeF G
;eeG H
ifff 
(ff 
!ff 
	Directoryff 
.ff 
Existsff %
(ff% &
	directoryff& /
)ff/ 0
)ff0 1
	Directoryff2 ;
.ff; <
CreateDirectoryff< K
(ffK L
	directoryffL U
)ffU V
;ffV W
tryii 
{jj 
ifkk 
(kk 
!kk 
stringkk 
.kk  
IsNullOrEmptykk  -
(kk- .
campaignkk. 6
.kk6 7
Assetskk7 =
.kk= >
CreativeFileskk> K
)kkK L
)kkL M
{ll 
stringmm 
filePathmm '
=mm( )
Pathmm* .
.mm. /
Combinemm/ 6
(mm6 7

uploadPathmm7 A
,mmA B
campaignmmC K
.mmK L
AssetsmmL R
.mmR S
CreativeFilesmmS `
)mm` a
;mma b
S3FileManagernn %
.nn% &
Downloadnn& .
(nn. /
campaignnn/ 7
.nn7 8
Assetsnn8 >
.nn> ?
CreativeFilesnn? L
,nnL M
filePathnnN V
)nnV W
;nnW X
varoo 
resultoo "
=oo# $
FileManageroo% 0
.oo0 1
ProcessHtmlZipoo1 ?
(oo? @

uploadPathoo@ J
,ooJ K
filePathooL T
,ooT U
campaignooV ^
.oo^ _
OrderNumberoo_ j
,ooj k
campaignool t
.oot u
IsAddOptOut	oou Ä
,
ooÄ Å
campaign
ooÇ ä
.
ooä ã 
IsAddViewInBrowser
ooã ù
)
ooù û
;
ooû ü
campaignpp  
.pp  !
Assetspp! '
.pp' (
CreativeUrlpp( 3
=pp4 5
resultpp6 <
.pp< =
FilePathLivepp= I
;ppI J
campaignqq  
.qq  !
Assetsqq! '
.qq' (
CreativeStatusqq( 6
=qq7 8
(qq9 :
intqq: =
)qq= >
resultqq> D
.qqD E
StatusqqE K
;qqK L
	LogHelperrr !
.rr! "
AddLogrr" (
(rr( )
dbrr) +
,rr+ ,
LogTyperr- 4
.rr4 5
FileProcessingrr5 C
,rrC D
orderNumberrrE P
,rrP Q
$strrrR m
+rrn o
campaignrrp x
.rrx y
Assetsrry 
.	rr Ä
CreativeUrl
rrÄ ã
+
rrå ç
$str
rré ö
+
rrõ ú
System
rrù £
.
rr£ §
Enum
rr§ ®
.
rr® ©
GetName
rr© ∞
(
rr∞ ±
typeof
rr± ∑
(
rr∑ ∏
UploadFileStatus
rr∏ »
)
rr» …
,
rr…  
campaign
rrÀ ”
.
rr” ‘
Assets
rr‘ ⁄
.
rr⁄ €
CreativeStatus
rr€ È
)
rrÈ Í
)
rrÍ Î
;
rrÎ Ï
}ss 
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
campaignww 
.ww 
Assetsww #
.ww# $
CreativeStatusww$ 2
=ww3 4
(ww5 6
intww6 9
)ww9 :
UploadFileStatusww: J
.wwJ K
FailedwwK Q
;wwQ R
	LogHelperxx 
.xx 
AddErrorxx &
(xx& '
dbxx' )
,xx) *
LogTypexx+ 2
.xx2 3
FileProcessingxx3 A
,xxA B
orderNumberxxC N
,xxN O
$strxxP s
+xxt u
exxxv x
.xxx y
Message	xxy Ä
+
xxÅ Ç
$str
xxÉ è
+
xxê ë
System
xxí ò
.
xxò ô
Enum
xxô ù
.
xxù û
GetName
xxû •
(
xx• ¶
typeof
xx¶ ¨
(
xx¨ ≠
UploadFileStatus
xx≠ Ω
)
xxΩ æ
,
xxæ ø
campaign
xx¿ »
.
xx» …
Assets
xx… œ
.
xxœ –
CreativeStatus
xx– ﬁ
)
xxﬁ ﬂ
)
xxﬂ ‡
;
xx‡ ·
}yy 
dbzz 
.zz 
SaveChangeszz 
(zz 
)zz  
;zz  !
if|| 
(|| 
!|| 
string|| 
.|| 
IsNullOrEmpty|| )
(||) *
campaign||* 2
.||2 3
Assets||3 9
.||9 :
ZipCodeFile||: E
)||E F
)||F G
{}} 
campaign 
. 
Assets #
.# $

ZipCodeUrl$ .
=/ 0
FileManager1 <
.< =
GetFilePathLive= L
(L M
UploadFileTypeM [
.[ \
ZipFile\ c
,c d
campaign
ÄÄ  
.
ÄÄ  !
OrderNumber
ÄÄ! ,
)
ÄÄ, -
;
ÄÄ- .
campaign
ÅÅ 
.
ÅÅ 
Assets
ÅÅ #
.
ÅÅ# $
ZipCodeStatus
ÅÅ$ 1
=
ÅÅ2 3
(
ÅÅ4 5
int
ÅÅ5 8
)
ÅÅ8 9
UploadFileStatus
ÅÅ: J
.
ÅÅJ K
	Completed
ÅÅK T
;
ÅÅT U
	LogHelper
ÇÇ 
.
ÇÇ 
AddLog
ÇÇ $
(
ÇÇ$ %
db
ÇÇ% '
,
ÇÇ' (
LogType
ÇÇ) 0
.
ÇÇ0 1
FileProcessing
ÇÇ1 ?
,
ÇÇ? @
orderNumber
ÇÇA L
,
ÇÇL M
$str
ÉÉ 1
+
ÉÉ2 3
campaign
ÉÉ4 <
.
ÉÉ< =
Assets
ÉÉ= C
.
ÉÉC D

ZipCodeUrl
ÉÉD N
+
ÉÉO P
$str
ÉÉQ ]
+
ÉÉ^ _
System
ÑÑ 
.
ÑÑ 
Enum
ÑÑ #
.
ÑÑ# $
GetName
ÑÑ$ +
(
ÑÑ+ ,
typeof
ÑÑ, 2
(
ÑÑ2 3
UploadFileStatus
ÑÑ3 C
)
ÑÑC D
,
ÑÑD E
campaign
ÑÑF N
.
ÑÑN O
Assets
ÑÑO U
.
ÑÑU V
ZipCodeStatus
ÑÑV c
)
ÑÑc d
)
ÑÑd e
;
ÑÑe f
}
ÖÖ 
if
àà 
(
àà 
!
àà 
string
àà 
.
àà 
IsNullOrEmpty
àà )
(
àà) *
campaign
àà* 2
.
àà2 3
Assets
àà3 9
.
àà9 :
TestSeedFile
àà: F
)
ààF G
)
ààG H
{
ââ 
campaign
ää 
.
ää 
Assets
ää #
.
ää# $
TestSeedUrl
ää$ /
=
ää0 1
FileManager
ää2 =
.
ää= >
GetFilePathLive
ää> M
(
ääM N
UploadFileType
ääN \
.
ää\ ]
TestSeedFile
ää] i
,
ääi j
campaign
ãã  
.
ãã  !
OrderNumber
ãã! ,
)
ãã, -
;
ãã- .
campaign
åå 
.
åå 
Assets
åå #
.
åå# $
TestSeedStatus
åå$ 2
=
åå3 4
(
åå5 6
int
åå6 9
)
åå9 :
UploadFileStatus
åå; K
.
ååK L
	Completed
ååL U
;
ååU V
	LogHelper
çç 
.
çç 
AddLog
çç $
(
çç$ %
db
çç% '
,
çç' (
LogType
çç) 0
.
çç0 1
FileProcessing
çç1 ?
,
çç? @
orderNumber
ççA L
,
ççL M
$str
éé 2
+
éé3 4
campaign
éé5 =
.
éé= >
Assets
éé> D
.
ééD E
TestSeedUrl
ééE P
+
ééQ R
$str
ééS _
+
éé` a
System
èè 
.
èè 
Enum
èè "
.
èè" #
GetName
èè# *
(
èè* +
typeof
èè+ 1
(
èè1 2
UploadFileStatus
èè2 B
)
èèB C
,
èèC D
campaign
èèE M
.
èèM N
Assets
èèN T
.
èèT U
TestSeedStatus
èèU c
)
èèc d
)
èèd e
;
èèe f
}
êê 
if
ìì 
(
ìì 
!
ìì 
string
ìì 
.
ìì 
IsNullOrEmpty
ìì )
(
ìì) *
campaign
ìì* 2
.
ìì2 3
Assets
ìì3 9
.
ìì9 :
LiveSeedFile
ìì: F
)
ììF G
)
ììG H
{
îî 
campaign
ïï 
.
ïï 
Assets
ïï #
.
ïï# $
LiveSeedUrl
ïï$ /
=
ïï0 1
FileManager
ïï2 =
.
ïï= >
GetFilePathLive
ïï> M
(
ïïM N
UploadFileType
ïïN \
.
ïï\ ]
LiveSeedFile
ïï] i
,
ïïi j
campaign
ññ  
.
ññ  !
OrderNumber
ññ! ,
)
ññ, -
;
ññ- .
campaign
óó 
.
óó 
Assets
óó #
.
óó# $
LiveSeedStatus
óó$ 2
=
óó3 4
(
óó5 6
int
óó6 9
)
óó9 :
UploadFileStatus
óó; K
.
óóK L
	Completed
óóL U
;
óóU V
	LogHelper
òò 
.
òò 
AddLog
òò $
(
òò$ %
db
òò% '
,
òò' (
LogType
òò) 0
.
òò0 1
FileProcessing
òò1 ?
,
òò? @
orderNumber
òòA L
,
òòL M
$str
ôô 2
+
ôô3 4
campaign
ôô5 =
.
ôô= >
Assets
ôô> D
.
ôôD E
LiveSeedUrl
ôôE P
+
ôôQ R
$str
ôôS _
+
ôô` a
System
öö 
.
öö 
Enum
öö #
.
öö# $
GetName
öö$ +
(
öö+ ,
typeof
öö, 2
(
öö2 3
UploadFileStatus
öö3 C
)
ööC D
,
ööD E
campaign
ööF N
.
ööN O
Assets
ööO U
.
ööU V
LiveSeedStatus
ööV d
)
ööd e
)
ööe f
;
ööf g
}
õõ 
if
ûû 
(
ûû 
!
ûû 
string
ûû 
.
ûû 
IsNullOrEmpty
ûû )
(
ûû) *
campaign
ûû* 2
.
ûû2 3
Assets
ûû3 9
.
ûû9 :
SuppressionFile
ûû: I
)
ûûI J
)
ûûJ K
{
üü 
campaign
†† 
.
†† 
Assets
†† #
.
††# $
SuppressionUrl
††$ 2
=
††3 4
FileManager
††5 @
.
††@ A
GetFilePathLive
††A P
(
††P Q
UploadFileType
††Q _
.
††_ `
SuppressionFile
††` o
,
††o p
campaign
°°  
.
°°  !
OrderNumber
°°! ,
)
°°, -
;
°°- .
campaign
¢¢ 
.
¢¢ 
Assets
¢¢ #
.
¢¢# $
SuppressionStatus
¢¢$ 5
=
¢¢6 7
(
¢¢8 9
int
¢¢9 <
)
¢¢< =
UploadFileStatus
¢¢> N
.
¢¢N O
	Completed
¢¢O X
;
¢¢X Y
	LogHelper
££ 
.
££ 
AddLog
££ $
(
££$ %
db
££% '
,
££' (
LogType
££) 0
.
££0 1
FileProcessing
££1 ?
,
££? @
orderNumber
££A L
,
££L M
$str
§§ 5
+
§§6 7
campaign
§§8 @
.
§§@ A
Assets
§§A G
.
§§G H
SuppressionUrl
§§H V
+
§§W X
$str
§§Y e
+
§§f g
System
•• 
.
•• 
Enum
•• #
.
••# $
GetName
••$ +
(
••+ ,
typeof
••, 2
(
••2 3
UploadFileStatus
••3 C
)
••C D
,
••D E
campaign
••F N
.
••N O
Assets
••O U
.
••U V
SuppressionStatus
••V g
)
••g h
)
••h i
;
••i j
}
¶¶ 
db
ßß 
.
ßß 
SaveChanges
ßß 
(
ßß 
)
ßß  
;
ßß  !
if
™™ 
(
™™ 
!
™™ 
string
™™ 
.
™™ 
IsNullOrEmpty
™™ )
(
™™) *
campaign
™™* 2
.
™™2 3
Assets
™™3 9
.
™™9 :
BannersFile
™™: E
)
™™E F
)
™™F G
{
´´ 
campaign
¨¨ 
.
¨¨ 
Assets
¨¨ #
.
¨¨# $

BannersUrl
¨¨$ .
=
¨¨/ 0
FileManager
¨¨1 <
.
¨¨< =
GetFilePathLive
¨¨= L
(
¨¨L M
UploadFileType
¨¨M [
.
¨¨[ \
BannersFile
¨¨\ g
,
¨¨g h
campaign
≠≠  
.
≠≠  !
OrderNumber
≠≠! ,
,
≠≠, -
Path
≠≠. 2
.
≠≠2 3
GetExtension
≠≠3 ?
(
≠≠? @
campaign
≠≠@ H
.
≠≠H I
Assets
≠≠I O
.
≠≠O P
BannersFile
≠≠P [
)
≠≠[ \
)
≠≠\ ]
;
≠≠] ^
campaign
ÆÆ 
.
ÆÆ 
Assets
ÆÆ #
.
ÆÆ# $
BannersStatus
ÆÆ$ 1
=
ÆÆ2 3
(
ÆÆ4 5
int
ÆÆ5 8
)
ÆÆ8 9
UploadFileStatus
ÆÆ9 I
.
ÆÆI J
	Completed
ÆÆJ S
;
ÆÆS T
	LogHelper
ØØ 
.
ØØ 
AddLog
ØØ $
(
ØØ$ %
db
ØØ% '
,
ØØ' (
LogType
ØØ) 0
.
ØØ0 1
FileProcessing
ØØ1 ?
,
ØØ? @
orderNumber
ØØA L
,
ØØL M
$str
∞∞ 1
+
∞∞2 3
campaign
∞∞4 <
.
∞∞< =
Assets
∞∞= C
.
∞∞C D

BannersUrl
∞∞D N
+
∞∞O P
$str
∞∞Q ]
+
∞∞^ _
System
±± 
.
±± 
Enum
±± #
.
±±# $
GetName
±±$ +
(
±±+ ,
typeof
±±, 2
(
±±2 3
UploadFileStatus
±±3 C
)
±±C D
,
±±D E
campaign
±±F N
.
±±N O
Assets
±±O U
.
±±U V
BannersStatus
±±V c
)
±±c d
)
±±d e
;
±±e f
}
≤≤ 
if
µµ 
(
µµ 
!
µµ 
string
µµ 
.
µµ 
IsNullOrEmpty
µµ )
(
µµ) *
campaign
µµ* 2
.
µµ2 3
Assets
µµ3 9
.
µµ9 :
BannerLinksFile
µµ: I
)
µµI J
)
µµJ K
{
∂∂ 
campaign
∑∑ 
.
∑∑ 
Assets
∑∑ #
.
∑∑# $
BannerLinksUrl
∑∑$ 2
=
∑∑3 4
FileManager
∑∑5 @
.
∑∑@ A
GetFilePathLive
∑∑A P
(
∑∑P Q
UploadFileType
∑∑Q _
.
∑∑_ `
BannersLinksFile
∑∑` p
,
∑∑p q
campaign
∏∏ 
.
∏∏  
OrderNumber
∏∏  +
,
∏∏+ ,
Path
∏∏- 1
.
∏∏1 2
GetExtension
∏∏2 >
(
∏∏> ?
campaign
∏∏? G
.
∏∏G H
Assets
∏∏H N
.
∏∏N O
BannerLinksFile
∏∏O ^
)
∏∏^ _
)
∏∏_ `
;
∏∏` a
campaign
ππ 
.
ππ 
Assets
ππ #
.
ππ# $
BannerLinksStatus
ππ$ 5
=
ππ6 7
(
ππ8 9
int
ππ9 <
)
ππ< =
UploadFileStatus
ππ= M
.
ππM N
	Completed
ππN W
;
ππW X
	LogHelper
∫∫ 
.
∫∫ 
AddLog
∫∫ $
(
∫∫$ %
db
∫∫% '
,
∫∫' (
LogType
∫∫) 0
.
∫∫0 1
FileProcessing
∫∫1 ?
,
∫∫? @
orderNumber
∫∫A L
,
∫∫L M
$str
ªª 5
+
ªª6 7
campaign
ªª8 @
.
ªª@ A
Assets
ªªA G
.
ªªG H
BannerLinksUrl
ªªH V
+
ªªW X
$str
ªªY e
+
ªªf g
System
ºº 
.
ºº 
Enum
ºº #
.
ºº# $
GetName
ºº$ +
(
ºº+ ,
typeof
ºº, 2
(
ºº2 3
UploadFileStatus
ºº3 C
)
ººC D
,
ººD E
campaign
ººF N
.
ººN O
Assets
ººO U
.
ººU V
BannerLinksStatus
ººV g
)
ººg h
)
ººh i
;
ººi j
}
ΩΩ 
if
¿¿ 
(
¿¿ 
!
¿¿ 
string
¿¿ 
.
¿¿ 
IsNullOrEmpty
¿¿ )
(
¿¿) *
campaign
¿¿* 2
.
¿¿2 3
Assets
¿¿3 9
.
¿¿9 :
MiscFile
¿¿: B
)
¿¿B C
)
¿¿C D
{
¡¡ 
campaign
¬¬ 
.
¬¬ 
Assets
¬¬ #
.
¬¬# $
MiscUrl
¬¬$ +
=
¬¬, -
FileManager
¬¬. 9
.
¬¬9 :
GetFilePathLive
¬¬: I
(
¬¬I J
UploadFileType
¬¬J X
.
¬¬X Y
MiscFile
¬¬Y a
,
¬¬a b
campaign
√√ 
.
√√  
OrderNumber
√√  +
,
√√+ ,
Path
√√- 1
.
√√1 2
GetExtension
√√2 >
(
√√> ?
campaign
√√? G
.
√√G H
Assets
√√H N
.
√√N O
MiscFile
√√O W
)
√√W X
)
√√X Y
;
√√Y Z
campaign
ƒƒ 
.
ƒƒ 
Assets
ƒƒ #
.
ƒƒ# $

MiscStatus
ƒƒ$ .
=
ƒƒ/ 0
(
ƒƒ1 2
int
ƒƒ2 5
)
ƒƒ5 6
UploadFileStatus
ƒƒ6 F
.
ƒƒF G
	Completed
ƒƒG P
;
ƒƒP Q
	LogHelper
≈≈ 
.
≈≈ 
AddLog
≈≈ $
(
≈≈$ %
db
≈≈% '
,
≈≈' (
LogType
≈≈) 0
.
≈≈0 1
FileProcessing
≈≈1 ?
,
≈≈? @
orderNumber
≈≈A L
,
≈≈L M
$str
∆∆ .
+
∆∆/ 0
campaign
∆∆1 9
.
∆∆9 :
Assets
∆∆: @
.
∆∆@ A
MiscUrl
∆∆A H
+
∆∆I J
$str
∆∆K W
+
∆∆X Y
System
«« 
.
«« 
Enum
«« #
.
««# $
GetName
««$ +
(
««+ ,
typeof
««, 2
(
««2 3
UploadFileStatus
««3 C
)
««C D
,
««D E
campaign
««F N
.
««N O
Assets
««O U
.
««U V

MiscStatus
««V `
)
««` a
)
««a b
;
««b c
}
»» 
}
…… 
}
   	
}
ÀÀ 
}ÃÃ ˚‚
JD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Emails\EmailHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Emails' -
{ 
public 

static 
class 
EmailHelper #
{ 
private 
static 
readonly 
string  &

clientCode' 1
=2 3
System4 :
.: ;
Configuration; H
.H I 
ConfigurationManagerI ]
.] ^
AppSettings^ i
[i j
$strj v
]v w
;w x
private 
static 
readonly 
string  &

clientName' 1
=2 3
System4 :
.: ;
Configuration; H
.H I 
ConfigurationManagerI ]
.] ^
AppSettings^ i
[i j
$strj v
]v w
;w x
private 
static 
readonly 
string  &
clientAppURL' 3
=4 5
System6 <
.< =
Configuration= J
.J K 
ConfigurationManagerK _
._ `
AppSettings` k
[k l
$strl z
]z {
;{ |
readonly 
static 
string 
Footer %
=& '
$"( *$
<br/><br/>Thanks<br/><b>* B
{B C

clientNameC M
}M N
	</b><br/>N W
{W X
clientAppURLX d
}d e
"e f
;f g
public 
static 
void "
SendOrderEmailToClient 1
(1 2
Campaign2 :
campaign; C
,C D
WfpUserE L
loggedInUserM Y
)Y Z
{ 	
string 
subject 
= 
$" 
Order #  '
{' (
campaign( 0
.0 1
OrderNumber1 <
}< =
, Campaign Date = M
{M N
campaignN V
.V W
BroadcastDateW d
?d e
.e f
ToStringf n
(n o
$stro r
)r s
}s t
, QTY t z
{z {
campaign	{ É
.
É Ñ
Quantity
Ñ å
}
å ç 
 , Date Submitted 
ç ü
{
ü †
campaign
† ®
.
® ©
	CreatedAt
© ≤
:
≤ ≥
d
≥ ¥
}
¥ µ
"
µ ∂
;
∂ ∑
string 
body 
= 
$@" 
<br/><p>Dear  *
{* +
loggedInUser+ 7
.7 8
UserName8 @
.@ A!
ToCapitalLetterStringA V
(V W
)W X
.X Y
ToCapitalizedY f
(f g
)g h
}h i¨
ü</p><br/>We have recevied your order.<br/><br/>
                        <table border=""2"">
                        <tr><th align=""left"">Order #:</th><td>i @
{@ A
campaignA I
.I J
OrderNumberJ U
}U VW
K</td></tr>
                        <tr><th align=""left"">Status:</th><td>V ?
{? @
(@ A
CampaignStatusA O
)O P
campaignQ Y
.Y Z
StatusZ `
}` aY
M</td></tr>
                        <tr><th align=""left"">Username:</th><td> a A
{  A B
loggedInUser  B N
.  N O
UserName  O W
}  W X[
O</td></tr>
                        <tr><th align=""left"">User Email:</th><td> !X C
{!!C D
loggedInUser!!D P
.!!P Q
Email!!Q V
}!!V W^
R</td></tr>
                        <tr><th align=""left"">Campaign Name:</th><td>!"W F
{""F G
campaign""G O
.""O P
CampaignName""P \
}""\ ]_
S</td></tr>
                        <tr><th align=""left"">Broadcast Date:</th><td>"#] G
{##G H
campaign##H P
.##P Q
BroadcastDate##Q ^
.##^ _
Value##_ d
.##d e
ToString##e m
(##m n
$str##n q
)##q r
}##r s\
P</td></tr>
                        <tr><th align=""left"">Rebroadcast:</th><td>#$s D
{$$D E
($$E F
campaign$$F N
.$$N O
ReBroadCast$$O Z
?$$Z [
$str$$\ a
:$$a b
$str$$c g
)$$g h
}$$h ia
U</td></tr>
                        <tr><th align=""left"">Rebroadcast Date:</th><td>$%i I
{%%I J
(%%J K
campaign%%K S
.%%S T
ReBroadcastDate%%T c
.%%c d
HasValue%%d l
?%%l m
campaign%%n v
.%%v w
ReBroadcastDate	%%w Ü
.
%%Ü á
ToString
%%á è
(
%%è ê
)
%%ê ë
:
%%ë í
$str
%%ì ï
)
%%ï ñ
}
%%ñ ó[
N</td></tr>
                        <tr><th align=""left"">From Line:</th><td>	%&ó B
{&&B C
campaign&&C K
.&&K L
FromLine&&L T
}&&T U]
Q</td></tr>
                        <tr><th align=""left"">Subject Line:</th><td>&'U E
{''E F
campaign''F N
.''N O
SubjectLine''O Z
}''Z [`
T</td></tr>
                        <tr><th align=""left"">Personalization:</th><td>'([ H
{((H I
(((I J
campaign((J R
.((R S
IsPersonalization((S d
?((d e
$str((f k
:((k l
$str((m q
)((q r
}((r sZ
N</td></tr>
                        <tr><th align=""left"">Matchback:</th><td>()s B
{))B C
())C D
campaign))D L
.))L M
IsMatchback))M X
?))Y Z
$str))[ `
:))a b
$str))c g
)))g h
}))h i\
P</td></tr>
                        <tr><th align=""left"">Suppression:</th><td>)*i D
{**D E
(**E F
campaign**F N
.**N O
IsSuppression**O \
?**\ ]
$str**^ c
:**c d
$str**e i
)**i j
}**j k\
P</td></tr>
                        <tr><th align=""left"">White Label:</th><td>*+k D
{++D E
campaign++E M
.++M N

WhiteLabel++N X
}++X YZ
N</td></tr>
                        <tr><th align=""left"">HTML File:</th><td>+,Y B
{,,B C
campaign,,C K
.,,K L
Assets,,L R
.,,R S
CreativeUrl,,S ^
},,^ _Z
N</td></tr>
                        <tr><th align=""left"">Test Seed:</th><td>,-_ B
{--B C
campaign--C K
.--K L
Assets--L R
.--R S
TestSeedUrl--S ^
}--^ _\
P</td></tr>  
                        <tr><th align=""left"">Live Seed:</th><td>-._ B
{..B C
campaign..C K
...K L
Assets..L R
...R S
LiveSeedUrl..S ^
}..^ _h
\</td></tr>   
                        <tr><th align=""left"">Special Instructions:</th><td>./_ M
{//M N
campaign//N V
.//V W
SpecialInstructions//W j
}//j kÄ
t</td></tr>                                     
                        <tr><th align=""left"">Start Time:</th><td>/0k C
{00C D
campaign00D L
.00L M
	CreatedAt00M V
.00V W

AddMinutes00W a
(00a b
$num00b c
)00c d
.00d e

AddSeconds00e o
(00o p
$num00p r
)00r s
}00s tS
G</td></tr>
                        <tr><th align=""left"">IP:</th><td>01t ;
{11; <
campaign11< D
.11D E
IP11E G
}11G HX
L</td></tr>
                        <tr><th align=""left"">Browser:</th><td>12H @
{22@ A
campaign22A I
.22I J
Browser22J Q
}22Q RS
G</td></tr>
                        <tr><th align=""left"">OS:</th><td>23R ;
{33; <
campaign33< D
.33D E
OS33E G
}33G HY
M</td></tr>
                        <tr><th align=""left"">Referrer:</th><td>34H A
{44A B
campaign44B J
.44J K
Referrer44K S
}44S T~
r</td></tr>
                        </table></p> <p>We will soon contact you and update you about your order.</p> 45T f
{55f g
Footer55g m
}55m n
"55n o
;55o p
	SendEmail77 
(77 
loggedInUser77 "
.77" #
Email77# (
,77( )
subject77* 1
,771 2
body773 7
)777 8
;778 9
}88 	
public:: 
static:: 
void:: 
SendOrderEmailToAds:: .
(::. /
Campaign::/ 7
campaign::8 @
,::@ A
WfpUser::B I
loggedInUser::J V
,::V W
string::X ^
to::_ a
,::a b
string::c i
ccEmails::j r
)::r s
{;; 	
string<< 
subject<< 
=<< 
$"<< (
New Order Received, Order # << ;
{<<; <
campaign<<< D
.<<D E
OrderNumber<<E P
}<<P Q
, Campaign Date <<Q a
{<<a b
campaign<<b j
.<<j k
BroadcastDate<<k x
?<<x y
.<<y z
ToString	<<z Ç
(
<<Ç É
$str
<<É Ü
)
<<Ü á
}
<<á à
, QTY 
<<à é
{
<<é è
campaign
<<è ó
.
<<ó ò
Quantity
<<ò †
}
<<† ° 
 , Date Submitted 
<<° ≥
{
<<≥ ¥
campaign
<<¥ º
.
<<º Ω
	CreatedAt
<<Ω ∆
:
<<∆ «
d
<<« »
}
<<» …
"
<<…  
;
<<  À
string>> 
body>> 
=>> 
$@">> ·
‘<br/><p>Dear team, <br/><br/> New Order has been entered into system. Order details is as below;</p>
                        <table border=""2"">
                        <tr><th align=""left"">Order #:</th><td>>@ @
{@@@ A
campaign@@A I
.@@I J
OrderNumber@@J U
}@@U VW
K</td></tr>
                        <tr><th align=""left"">Status:</th><td>@AV ?
{AA? @
(AA@ A
CampaignStatusAAA O
)AAO P
campaignAAP X
.AAX Y
StatusAAY _
}AA_ `Y
M</td></tr>
                        <tr><th align=""left"">Username:</th><td>AB` A
{BBA B
loggedInUserBBB N
.BBN O
UserNameBBO W
.BBW X!
ToCapitalLetterStringBBX m
(BBm n
)BBn o
.BBo p
ToCapitalizedBBp }
(BB} ~
)BB~ 
}	BB Ä\
O</td></tr>
                        <tr><th align=""left"">User Email:</th><td>	BCÄ C
{CCC D
loggedInUserCCD P
.CCP Q
EmailCCQ V
}CCV W^
R</td></tr>
                        <tr><th align=""left"">Campaign Name:</th><td>CDW F
{DDF G
campaignDDG O
.DDO P
CampaignNameDDP \
}DD\ ]_
S</td></tr>
                        <tr><th align=""left"">Broadcast Date:</th><td>DE] G
{EEG H
campaignEEH P
.EEP Q
BroadcastDateEEQ ^
.EE^ _
ValueEE_ d
.EEd e
ToStringEEe m
(EEm n
$strEEn q
)EEq r
}EEr s\
P</td></tr>
                        <tr><th align=""left"">Rebroadcast:</th><td>EFs D
{FFD E
(FFE F
campaignFFF N
.FFN O
ReBroadCastFFO Z
?FF[ \
$strFF] b
:FFc d
$strFFe i
)FFi j
}FFj ka
U</td></tr>
                        <tr><th align=""left"">Rebroadcast Date:</th><td>FGk I
{GGI J
(GGJ K
campaignGGK S
.GGS T
ReBroadcastDateGGT c
.GGc d
HasValueGGd l
?GGm n
campaignGGo w
.GGw x
ReBroadcastDate	GGx á
.
GGá à
ToString
GGà ê
(
GGê ë
)
GGë í
:
GGì î
$str
GGï ó
)
GGó ò
}
GGò ô[
N</td></tr>
                        <tr><th align=""left"">From Line:</th><td>	GHô B
{HHB C
campaignHHC K
.HHK L
FromLineHHL T
}HHT U]
Q</td></tr>
                        <tr><th align=""left"">Subject Line:</th><td>HIU E
{IIE F
campaignIIF N
.IIN O
SubjectLineIIO Z
}IIZ [`
T</td></tr>
                        <tr><th align=""left"">Personalization:</th><td>IJ[ H
{JJH I
(JJI J
campaignJJJ R
.JJR S
IsPersonalizationJJS d
?JJe f
$strJJg l
:JJm n
$strJJo s
)JJs t
}JJt uZ
N</td></tr>
                        <tr><th align=""left"">Matchback:</th><td>JKu B
{KKB C
(KKC D
campaignKKD L
.KKL M
IsMatchbackKKM X
?KKY Z
$strKK[ `
:KKa b
$strKKc g
)KKg h
}KKh i\
P</td></tr>
                        <tr><th align=""left"">Suppression:</th><td>KLi D
{LLD E
(LLE F
campaignLLF N
.LLN O
IsSuppressionLLO \
?LL] ^
$strLL_ d
:LLe f
$strLLg k
)LLk l
}LLl m\
P</td></tr>
                        <tr><th align=""left"">White Label:</th><td>LMm D
{MMD E
campaignMME M
.MMM N

WhiteLabelMMN X
}MMX YZ
N</td></tr>
                        <tr><th align=""left"">HTML File:</th><td>MNY B
{NNB C
campaignNNC K
.NNK L
AssetsNNL R
.NNR S
CreativeUrlNNS ^
}NN^ _Z
N</td></tr>
                        <tr><th align=""left"">Test Seed:</th><td>NO_ B
{OOB C
campaignOOC K
.OOK L
AssetsOOL R
.OOR S
TestSeedUrlOOS ^
}OO^ _\
P</td></tr>  
                        <tr><th align=""left"">Live Seed:</th><td>OP_ B
{PPB C
campaignPPC K
.PPK L
AssetsPPL R
.PPR S
LiveSeedUrlPPS ^
}PP^ _h
\</td></tr>   
                        <tr><th align=""left"">Special Instructions:</th><td>PQ_ M
{QQM N
campaignQQN V
.QQV W
SpecialInstructionsQQW j
}QQj kÄ
t</td></tr>                                     
                        <tr><th align=""left"">Start Time:</th><td>QRk C
{RRC D
campaignRRD L
.RRL M
	CreatedAtRRM V
.RRV W

AddMinutesRRW a
(RRa b
$numRRb c
)RRc d
.RRd e

AddSecondsRRe o
(RRo p
$numRRp r
)RRr s
}RRs tS
G</td></tr>
                        <tr><th align=""left"">IP:</th><td>RSt ;
{SS; <
campaignSS< D
.SSD E
IPSSE G
}SSG HX
L</td></tr>
                        <tr><th align=""left"">Browser:</th><td>STH @
{TT@ A
campaignTTA I
.TTI J
BrowserTTJ Q
}TTQ RS
G</td></tr>
                        <tr><th align=""left"">OS:</th><td>TUR ;
{UU; <
campaignUU< D
.UUD E
OSUUE G
}UUG HY
M</td></tr>
                        <tr><th align=""left"">Referrer:</th><td>UVH A
{VVA B
campaignVVB J
.VVJ K
ReferrerVVK S
}VVS T=
1</td></tr>
                        </table></p> VWT %
{WW% &
FooterWW& ,
}WW, -
"WW- .
;WW. /
	SendEmailYY 
(YY 
toYY 
,YY 
subjectYY !
,YY! "
bodyYY# '
,YY' (
ccEmailsYY) 1
)YY1 2
;YY2 3
}ZZ 	
public\\ 
static\\ 
string\\  
SendApprovedToVendor\\ 1
(\\1 2
Vendor\\2 8
vendor\\9 ?
,\\? @
Campaign\\A I
campaign\\J R
,\\R S
CampaignSegment\\T c
segment\\d k
)\\k l
{]] 	
string^^ 
newOld^^ 
=^^ 
campaign^^ $
.^^$ %
ReBroadcasted^^% 2
?^^3 4
$str^^5 :
:^^; <
$str^^= B
;^^B C
string__ 

deployDate__ 
=__ 
campaign__  (
.__( )
ReBroadcasted__) 6
?__7 8
campaign__9 A
.__A B
ReBroadcastedDate__B S
?__S T
.__T U
ToString__U ]
(__] ^
$str__^ a
)__a b
:__c d
campaign__e m
.__m n
Approved__n v
.__v w

DeployDate	__w Å
?
__Å Ç
.
__Ç É
ToString
__É ã
(
__ã å
$str
__å è
)
__è ê
;
__ê ë
string`` 

deployTime`` 
=`` 
campaign``  (
.``( )
ReBroadcasted``) 6
?``7 8
campaign``9 A
.``A B
ReBroadcastedDate``B S
?``S T
.``T U
ToString``U ]
(``] ^
$str``^ e
)``e f
:``g h
campaign``i q
.``q r
Approved``r z
.``z {

DeployDate	``{ Ö
?
``Ö Ü
.
``Ü á
ToString
``á è
(
``è ê
$str
``ê ó
)
``ó ò
;
``ò ô
stringaa 
quantityaa 
=aa 
campaignaa &
.aa& '
ReBroadcastedaa' 4
?aa5 6
campaignaa7 ?
.aa? @!
ReBroadcastedQuantityaa@ U
.aaU V
ToStringaaV ^
(aa^ _
)aa_ `
:aaa b
campaignaac k
.aak l
Approvedaal t
.aat u
Quantityaau }
.aa} ~
ToString	aa~ Ü
(
aaÜ á
)
aaá à
;
aaà â
stringcc 
orderNumbercc 
;cc 
stringdd 
subjectdd 
;dd 
stringee 
segmentsHtmlee 
=ee  !
stringee" (
.ee( )
Emptyee) .
;ee. /
ifff 
(ff 
segmentff 
==ff 
nullff 
)ff  
{gg 
orderNumberii 
=ii 
campaignii &
.ii& '
ReBroadcastedii' 4
?ii5 6
$"ii7 9
{ii9 :

clientCodeii: D
}iiD E
{iiE F
campaigniiF N
.iiN O$
ReBroadcastedOrderNumberiiO g
}iig h
"iih i
:iij k
$"iil n
{iin o

clientCodeiio y
}iiy z
{iiz {
campaign	ii{ É
.
iiÉ Ñ
OrderNumber
iiÑ è
}
iiè ê
"
iiê ë
;
iië í
subjectjj 
=jj 
$"jj 
{jj 
newOldjj #
}jj# $
 Order jj$ +
{jj+ ,
campaignjj, 4
.jj4 5
Approvedjj5 =
.jj= >
CampaignNamejj> J
}jjJ K

, Order # jjK U
{jjU V
orderNumberjjV a
}jja b
"jjb c
;jjc d
}kk 
elsekk 
{ll 
orderNumbermm 
=mm 
$"mm  
{mm  !

clientCodemm! +
}mm+ ,
{mm, -
segmentmm- 4
.mm4 5
SegmentNumbermm5 B
}mmB C
"mmC D
;mmD E
subjectnn 
=nn 
$"nn 
{nn 
newOldnn #
}nn# $
 Order nn$ +
{nn+ ,
campaignnn, 4
.nn4 5
Approvednn5 =
.nn= >
CampaignNamenn> J
}nnJ K

, Order # nnK U
{nnU V
orderNumbernnV a
}nna b
"nnb c
;nnc d
segmentsHtmlpp 
+=pp 
$@"pp  #i
]<table border=""1"">
                                <tr><th align=""left"">Segment</th><td>pq# G
{qqG H
segmentqqH O
.qqO P
SegmentNumberqqP ]
}qq] ^d
X</td></tr>
                                <tr><th align=""left"">Subject Line</th><td>qr^ L
{rrL M
segmentrrM T
.rrT U
SubjectLinerrU `
}rr` aa
U</td></tr>
                                <tr><th align=""left"">From Line</th><td>rsa I
{ssI J
segmentssJ Q
.ssQ R
FromLinessR Z
}ssZ [c
W</td></tr>
                                <tr><th align=""left"">White Label</th><td>st[ K
{ttK L
segmentttL S
.ttS T

WhiteLabelttT ^
}tt^ _g
[</td></tr>
                                <tr><th align=""left"">Deployment Date</th><td>tu_ O
{uuO P
segmentuuP W
.uuW X
DeploymentDateuuX f
}uuf ge
Y</td></tr>
                                <tr><th align=""left"">Total Records</th><td>uvg M
{vvM N
NumberHelpervvN Z
.vvZ [
GetTotalvv[ c
(vvc d
segmentww 
.ww 
FirstRangeStartww +
,ww+ ,
segmentww- 4
.ww4 5
FirstRangeEndww5 B
,wwB C
segmentwwD K
.wwK L
SecondRangeStartwwL \
,ww\ ]
segmentww^ e
.wwe f
SecondRangeEndwwf t
,wwt u
segmentxx 
.xx 
ThirdRangeStartxx +
,xx+ ,
segmentxx- 4
.xx4 5
ThirdRangeEndxx5 B
)xxB C
}xxC D
</td></tr></table>xxD V
"xxV W
;xxW X
}yy 
string{{ 
body{{ 
={{ 
$@"{{ 
<br/><p>Dear {{ *
{{{* +
vendor{{+ 1
.{{1 2
Name{{2 6
}{{6 7¬
µ</p><br/>
                    Please find below Order details<br/><br/>
                    <table border=""2"">
                    <tr><th align=""left""> Reference #:</th><td>{~7 A
{~~A B
campaign~~B J
.~~J K
Approved~~K S
.~~S T
ReferenceNumber~~T c
}~~c dT
H</td></tr>
                    <tr><th align=""left"">Order #:</th><td>~d <
{< =
orderNumber= H
}H I[
N</td></tr>
                    <tr><th align=""left"">Campaign Name:</th><td>	ÄI B
{
ÄÄB C
campaign
ÄÄC K
.
ÄÄK L
Approved
ÄÄL T
.
ÄÄT U
CampaignName
ÄÄU a
}
ÄÄa bZ
L</td></tr>
                    <tr><th align=""left"">Rebroadcast:</th><td>
ÄÅb @
{
ÅÅ@ A
(
ÅÅA B
campaign
ÅÅB J
.
ÅÅJ K
Approved
ÅÅK S
.
ÅÅS T
ReBroadCast
ÅÅT _
?
ÅÅ_ `
$str
ÅÅa f
:
ÅÅf g
$str
ÅÅh l
)
ÅÅl m
}
ÅÅm nÖ
w</td></tr>                                        
                    <tr><th align=""left"">Broadcast Date:</th><td>
ÅÇn C
{
ÇÇC D
campaign
ÇÇD L
.
ÇÇL M
Approved
ÇÇM U
.
ÇÇU V

DeployDate
ÇÇV `
.
ÇÇ` a
Value
ÇÇa f
:
ÇÇf g
d
ÇÇg h
}
ÇÇh iX
J</td></tr>
                    <tr><th align=""left"">From Line:</th><td>
ÇÉi >
{
ÉÉ> ?
campaign
ÉÉ? G
.
ÉÉG H
Approved
ÉÉH P
.
ÉÉP Q
FromLine
ÉÉQ Y
}
ÉÉY Z[
M</td></tr>
                    <tr><th align=""left"">Subject Line:</th><td>
ÉÑZ A
{
ÑÑA B
campaign
ÑÑB J
.
ÑÑJ K
Approved
ÑÑK S
.
ÑÑS T
SubjectLine
ÑÑT _
}
ÑÑ_ `V
H</td></tr>
                    <tr><th align=""left"">Opt Out:</th><td>
ÑÖ` <
{
ÖÖ< =
campaign
ÖÖ= E
.
ÖÖE F
OptOut
ÖÖF L
}
ÖÖL MZ
L</td></tr>
                    <tr><th align=""left"">White Label:</th><td>
ÖÜM @
{
ÜÜ@ A
campaign
ÜÜA I
.
ÜÜI J
Approved
ÜÜJ R
.
ÜÜR S

WhiteLabel
ÜÜS ]
}
ÜÜ] ^Ü
x</td></tr>                                        
                    <tr><th align=""left"">Personalization:</th><td>
Üá^ D
{
ááD E
(
ááE F
campaign
ááF N
.
ááN O
IsPersonalization
ááO `
?
áá` a
$str
ááb g
:
áág h
$str
áái m
)
áám n
}
áán o[
M</td></tr>
                    <tr><th align=""left"">Creative URL:</th><td>
áào A
{
ààA B
campaign
ààB J
.
ààJ K
Assets
ààK Q
.
ààQ R
CreativeUrl
ààR ]
}
àà] ^W
I</td></tr>
                    <tr><th align=""left"">Quantity:</th><td>
àâ^ =
{
ââ= >
quantity
ââ> F
}
ââF GV
H</td></tr>
                    <tr><th align=""left"">Geo (s):</th><td>
âäG <
{
ää< =
campaign
ää= E
.
ääE F
Approved
ääF N
.
ääN O

GeoDetails
ääO Y
}
ääY Z[
M</td></tr>
                    <tr><th align=""left"">Demographics:</th><td>
äãZ A
{
ããA B
campaign
ããB J
.
ããJ K
Approved
ããK S
.
ããS T
Demographics
ããT `
}
ãã` aZ
L</td></tr>
                    <tr><tr><th align=""left"">Zip URL:</th><td>
ãåa @
{
åå@ A
campaign
ååA I
.
ååI J
Assets
ååJ P
.
ååP Q

ZipCodeUrl
ååQ [
}
åå[ \c
U</td></tr>
                    <tr><th align=""left"">Special Instructions:</th><td>
åç\ I
{
ççI J
campaign
ççJ R
.
ççR S
Approved
ççS [
.
çç[ \!
SpecialInstructions
çç\ o
}
çço pZ
L</td></tr>
                    <tr><th align=""left"">Deploy Date:</th><td>
çép @
{
éé@ A

deployDate
ééA K
}
ééK LZ
L</td></tr>
                    <tr><th align=""left"">Deploy Time:</th><td>
éèL @
{
èè@ A

deployTime
èèA K
}
èèK L\
N</td></tr>
                    <tr><th align=""left"">Data Breakout:</th><td>
èêL B
{
êêB C
campaign
êêC K
.
êêK L
Testing
êêL S
.
êêS T
DataFileUrl
êêT _
}
êê_ `]
O</td></tr>
                    <tr><th align=""left"">Has Open Pixel:</th><td>
êë` C
{
ëëC D
(
ëëD E
campaign
ëëE M
.
ëëM N
Approved
ëëN V
.
ëëV W
IsOpenPixel
ëëW b
?
ëëb c
$str
ëëd i
:
ëëi j
$str
ëëk o
)
ëëo p
}
ëëp q]
O</td></tr>
                    <tr><th align=""left"">Open Pixel URL:</th><td>
ëíq C
{
ííC D
campaign
ííD L
.
ííL M
Approved
ííM U
.
ííU V
OpenPixelUrl
ííV b
}
ííb c[
M</td></tr>
                    <tr><th align=""left"">Omni Channel:</th><td>
íìc A
{
ììA B
(
ììB C
campaign
ììC K
.
ììK L
Approved
ììL T
.
ììT U
IsOmniOrder
ììU `
?
ìì` a
$str
ììb e
:
ììf g
$str
ììh k
)
ììk l
}
ììl mY
K</td></tr>
                    <tr><th align=""left"">Banner URL:</th><td>
ìîm ?
{
îî? @
campaign
îî@ H
.
îîH I
Approved
îîI Q
.
îîQ R
	BannerUrl
îîR [
}
îî[ \Y
K</td></tr>
                    <tr><th align=""left"">Open Goals:</th><td>
îï\ ?
{
ïï? @
campaign
ïï@ H
.
ïïH I
Approved
ïïI Q
.
ïïQ R
	OpenGoals
ïïR [
}
ïï[ \Z
L</td></tr>
                    <tr><th align=""left"">Click Goals:</th><td>
ïñ\ @
{
ññ@ A
campaign
ññA I
.
ññI J
Approved
ññJ R
.
ññR S

ClickGoals
ññS ]
}
ññ] ^[
M</td></tr>
                    <tr><th align=""left"">Segment Data:</th><td>
ñó^ A
{
óóA B
segmentsHtml
óóB N
}
óóN OC
5</td></tr>
                    </table></p> <p></p> 
óòO )
{
òò) *
Footer
òò* 0
}
òò0 1
"
òò1 2
;
òò2 3
	SendEmail
öö 
(
öö 
vendor
öö 
.
öö 
Email
öö "
,
öö" #
subject
öö$ +
,
öö+ ,
body
öö- 1
,
öö1 2
vendor
öö3 9
.
öö9 :
CcEmails
öö: B
)
ööB C
;
ööC D
return
õõ 
body
õõ 
;
õõ 
}
úú 	
public
ûû 
static
ûû 
void
ûû '
SendNotificationsToVendor
ûû 4
(
ûû4 5
Vendor
ûû5 ;
vendor
ûû< B
,
ûûB C
List
ûûD H
<
ûûH I
Campaign
ûûI Q
>
ûûQ R
	campaigns
ûûS \
)
ûû\ ]
{
üü 	
string
†† 
subject
†† 
=
†† 
$"
†† 
{
††  

clientCode
††  *
}
††* +
 Campaign Issues
††+ ;
"
††; <
;
††< =
StringBuilder
¢¢ 
problems
¢¢ "
=
¢¢# $
new
¢¢% (
StringBuilder
¢¢) 6
(
¢¢6 7
$str
¢¶7 [
)
¶¶[ \
;
¶¶\ ]
foreach
®® 
(
®® 
var
®® 
campaign
®® !
in
®®" $
	campaigns
®®% .
)
®®. /
{
©© 
var
™™ 
campaignTracking
™™ $
=
™™% &
campaign
™™' /
.
™™/ 0
	Trackings
™™0 9
.
™™9 :
FirstOrDefault
™™: H
(
™™H I
)
™™I J
;
™™J K
long
´´ 
Needed
´´ 
=
´´ 
campaignTracking
´´ .
.
´´. /
Quantity
´´/ 7
<=
´´8 :
$num
´´; >
?
´´? @
campaignTracking
´´A Q
.
´´Q R
Quantity
´´R Z
:
´´[ \
(
´´] ^
long
´´^ b
)
´´b c
(
´´c d
campaignTracking
´´d t
.
´´t u
Quantity
´´u }
*
´´~ 
$num´´Ä Å
/´´Ç É
$num´´Ñ â
)´´â ä
;´´ä ã
long
¨¨ 
Total
¨¨ 
=
¨¨ 
campaignTracking
¨¨ -
.
¨¨- .

Day1Clicks
¨¨. 8
+
¨¨9 :
campaignTracking
¨¨; K
.
¨¨K L

Day2Clicks
¨¨L V
+
¨¨W X
campaignTracking
¨¨Y i
.
¨¨i j

Day3Clicks
¨¨j t
+
¨¨u v
campaignTracking¨¨w á
.¨¨á à

Day4Clicks¨¨à í
+¨¨ì î 
campaignTracking¨¨ï •
.¨¨• ¶

Day5Clicks¨¨¶ ∞
+¨¨± ≤ 
campaignTracking¨¨≥ √
.¨¨√ ƒ

Day6Clicks¨¨ƒ Œ
+¨¨œ – 
campaignTracking¨¨— ·
.¨¨· ‚

Day7Clicks¨¨‚ Ï
;¨¨Ï Ì
double
≠≠ 
CampaignFill
≠≠ #
=
≠≠$ %
(
≠≠& '
double
≠≠' -
)
≠≠- .
Total
≠≠. 3
/
≠≠4 5
Needed
≠≠6 <
;
≠≠< =
foreach
ØØ 
(
ØØ 
var
ØØ 
notification
ØØ )
in
ØØ* ,
campaign
ØØ- 5
.
ØØ5 6
Notifications
ØØ6 C
)
ØØC D
{
∞∞ 
problems
±± 
.
±± 
Append
±± #
(
±±# $
$@"
±±$ ',
<tr>
                    <td>
±≤' 
{
≤≤ 
campaign
≤≤ !
.
≤≤! "
OrderNumber
≤≤" -
}
≤≤- .
	</td><td>
≤≤. 7
{
≤≤7 8
campaign
≤≤8 @
.
≤≤@ A
CampaignName
≤≤A M
}
≤≤M N
	</td><td>
≤≤N W
{
≤≤W X
notification
≤≤X d
.
≤≤d e
	CheckTime
≤≤e n
}
≤≤n o-
</td>
                    <td>
≤≥o 
{
≥≥ 
campaignTracking
≥≥ )
.
≥≥) *
Quantity
≥≥* 2
}
≥≥2 3
	</td><td>
≥≥3 <
{
≥≥< =
Needed
≥≥= C
}
≥≥C D

</td> <td>
≥≥D N
{
≥≥N O
campaignTracking
≥≥O _
.
≥≥_ `
	StartDate
≥≥` i
?
≥≥i j
.
≥≥j k
ToString
≥≥k s
(
≥≥s t
StringConstants≥≥t É
.≥≥É Ñ!
DateFormatSlashes≥≥Ñ ï
)≥≥ï ñ
}≥≥ñ ó/
  </td>
                    <td>≥¥ó 
{
¥¥ 
campaign
¥¥ !
.
¥¥! "
Testing
¥¥" )
.
¥¥) *#
ClickMeterRotatorLink
¥¥* ?
}
¥¥? @
	</td><td>
¥¥@ I
{
¥¥I J
string
¥¥J P
.
¥¥P Q
Format
¥¥Q W
(
¥¥W X
$str
¥¥X `
,
¥¥` a
Total
¥¥b g
)
¥¥g h
}
¥¥h i

</td> <td>
¥¥i s
{
¥¥s t
CampaignFill¥¥t Ä
.¥¥Ä Å
ToString¥¥Å â
(¥¥â ä
$str¥¥ä ë
)¥¥ë í
}¥¥í ì.
</td>
                    <td>¥µì 
{
µµ 
(
µµ 
QcRule
µµ  
)
µµ  !
notification
µµ! -
.
µµ- .
QcRule
µµ. 4
}
µµ4 5
	</td><td>
µµ5 >
{
µµ> ?
notification
µµ? K
.
µµK L
Message
µµL S
}
µµS T>
0</td>
                                    </tr>
µ∂T )
"
∂∂) *
)
∂∂* +
;
∂∂+ ,
}
∑∑ 
}
∏∏ 
problems
ππ 
.
ππ 
Append
ππ 
(
ππ 
$str
ππ &
)
ππ& '
;
ππ' (
string
∫∫ 
body
∫∫ 
=
∫∫ 
$@"
∫∫ 
<br/><p>Dear 
∫∫ *
{
∫∫* +
vendor
∫∫+ 1
.
∫∫1 2
Name
∫∫2 6
}
∫∫6 7K
=</p><br/>There is problem with these orders<br/><br/></p> <p>
∫∫7 t
{
∫∫t u
problems
∫∫u }
}
∫∫} ~
</p> ∫∫~ É
{∫∫É Ñ
Footer∫∫Ñ ä
}∫∫ä ã
"∫∫ã å
;∫∫å ç
	SendEmail
ªª 
(
ªª 
vendor
ªª 
.
ªª 
Email
ªª "
,
ªª" #
subject
ªª$ +
,
ªª+ ,
body
ªª- 1
,
ªª1 2
vendor
ªª3 9
.
ªª9 :
CcEmails
ªª: B
)
ªªB C
;
ªªC D
}
ºº 	
public
ææ 
static
ææ 
void
ææ 
SendErrorEmail
ææ )
(
ææ) *
string
ææ* 0
to
ææ1 3
,
ææ3 4
	Exception
ææ5 >
ex
ææ? A
,
ææA B
string
ææC I
currentController
ææJ [
,
ææ[ \
string
ææ] c
currentAction
ææd q
)
ææq r
{
øø 	
if
¿¿ 
(
¿¿ "
ConfigurationManager
¿¿ $
.
¿¿$ %
AppSettings
¿¿% 0
[
¿¿0 1
$str
¿¿1 9
]
¿¿9 :
==
¿¿; =
$str
¿¿> D
)
¿¿D E
{
¡¡ 
string
¬¬ 
subject
¬¬ 
=
¬¬  
$"
¬¬! #
{
¬¬# $

clientCode
¬¬$ .
}
¬¬. /.
 Live: An error has been occured.
¬¬/ O
"
¬¬O P
;
¬¬P Q
string
√√ 
body
√√ 
=
√√ 
$@"
√√ !
<p>
√√! $
{
√√$ %

clientCode
√√% /
}
√√/ 0`
RLive: An error has been occured.</p>
                            <p>Controller : 
√ƒ0 ,
{
ƒƒ, -
currentController
ƒƒ- >
}
ƒƒ> ?
</p><p>Action : 
ƒƒ? O
{
ƒƒO P
currentAction
ƒƒP ]
}
ƒƒ] ^C
5</p>
                            <p>Error Details : 
ƒ≈^ /
{
≈≈/ 0
ex
≈≈0 2
.
≈≈2 3!
GetExceptionMessage
≈≈3 F
(
≈≈F G
)
≈≈G H
}
≈≈H I
</p>
≈≈I M
"
≈≈M N
;
≈≈N O
	SendEmail
∆∆ 
(
∆∆ 
to
∆∆ 
,
∆∆ 
subject
∆∆ %
,
∆∆% &
body
∆∆' +
)
∆∆+ ,
;
∆∆, -
}
«« 
}
»» 	
public
   
static
   
void
    
SendTrackingReport
   -
(
  - .
string
  . 4
to
  5 7
,
  7 8
string
  9 ?
orderNumber
  @ K
,
  K L
List
  M Q
<
  Q R
string
  R X
>
  X Y
attachments
  Z e
)
  e f
{
ÀÀ 	
string
ÃÃ 
	timestamp
ÃÃ 
=
ÃÃ 
DateTime
ÃÃ '
.
ÃÃ' (
Now
ÃÃ( +
.
ÃÃ+ ,
ToString
ÃÃ, 4
(
ÃÃ4 5
StringConstants
ÃÃ5 D
.
ÃÃD E#
DateTimeFormatSlashes
ÃÃE Z
)
ÃÃZ [
;
ÃÃ[ \
string
ÕÕ 
subject
ÕÕ 
=
ÕÕ 
$"
ÕÕ 
IO# 
ÕÕ #
{
ÕÕ# $
orderNumber
ÕÕ$ /
}
ÕÕ/ 0
 Tracking report
ÕÕ0 @
"
ÕÕ@ A
;
ÕÕA B
string
ŒŒ 
body
ŒŒ 
=
ŒŒ 
$@"
ŒŒ ?
1<p>Please find attached tracking report for IO # 
ŒŒ N
{
ŒŒN O
orderNumber
ŒŒO Z
}
ŒŒZ [
 as of 
ŒŒ[ b
{
ŒŒb c
	timestamp
ŒŒc l
}
ŒŒl m
</p>
ŒŒm q
"
ŒŒq r
;
ŒŒr s
	SendEmail
œœ 
(
œœ 
to
œœ 
,
œœ 
subject
œœ !
,
œœ! "
body
œœ# '
,
œœ' (
$str
œœ) +
,
œœ+ ,
$str
œœ- /
,
œœ/ 0
attachments
œœ1 <
)
œœ< =
;
œœ= >
}
–– 	
public
““ 
static
““ 
async
““ 
Task
““  
SendEmailAsync
““! /
(
““/ 0
string
““0 6
to
““7 9
,
““9 :
string
““; A
subject
““B I
,
““I J
string
““K Q
body
““R V
,
““V W
string
““X ^
ccEmails
““_ g
=
““h i
$str
““j l
,
““l m
string
““n t
	bccEmails
““u ~
=““ Ä
$str““Å É
,““É Ñ
List““Ö â
<““ä ã
string““å í
>““í ì
attachments““î ü
=““† °
null““¢ ¶
)““¶ ß
{
”” 	
using
‘‘ 
(
‘‘ 
var
‘‘ 

smtpClient
‘‘ !
=
‘‘" #
new
‘‘$ '

SmtpClient
‘‘( 2
(
‘‘2 3
)
‘‘3 4
)
‘‘4 5
{
’’ 
var
÷÷ 
msg
÷÷ 
=
÷÷ 
CreateMessage
÷÷ '
(
÷÷' (
to
÷÷( *
,
÷÷* +
subject
÷÷, 3
,
÷÷3 4
body
÷÷5 9
,
÷÷9 :
ccEmails
÷÷; C
,
÷÷C D
	bccEmails
÷÷E N
,
÷÷N O
attachments
÷÷P [
)
÷÷[ \
;
÷÷\ ]
await
◊◊ 

smtpClient
◊◊  
.
◊◊  !
SendMailAsync
◊◊! .
(
◊◊. /
msg
◊◊/ 2
)
◊◊2 3
;
◊◊3 4
}
ÿÿ 
}
ŸŸ 	
public
€€ 
static
€€ 
void
€€ 
	SendEmail
€€ $
(
€€$ %
string
€€% +
to
€€, .
,
€€. /
string
€€0 6
subject
€€7 >
,
€€> ?
string
€€@ F
body
€€G K
,
€€K L
string
€€M S
ccEmails
€€T \
=
€€] ^
$str
€€_ a
,
€€a b
string
€€c i
	bccEmails
€€j s
=
€€t u
$str
€€v x
,
€€x y
List
€€z ~
<
€€~ 
string€€ Ö
>€€Ö Ü
attachments€€á í
=€€ì î
null€€ï ô
)€€ô ö
{
‹‹ 	
using
›› 
(
›› 
var
›› 

smtpClient
›› !
=
››" #
new
››$ '

SmtpClient
››( 2
(
››2 3
)
››3 4
)
››4 5
{
ﬁﬁ 
var
ﬂﬂ 
msg
ﬂﬂ 
=
ﬂﬂ 
CreateMessage
ﬂﬂ '
(
ﬂﬂ' (
to
ﬂﬂ( *
,
ﬂﬂ* +
subject
ﬂﬂ, 3
,
ﬂﬂ3 4
body
ﬂﬂ5 9
,
ﬂﬂ9 :
ccEmails
ﬂﬂ; C
,
ﬂﬂC D
	bccEmails
ﬂﬂE N
,
ﬂﬂN O
attachments
ﬂﬂP [
)
ﬂﬂ[ \
;
ﬂﬂ\ ]

smtpClient
‡‡ 
.
‡‡ 
Send
‡‡ 
(
‡‡  
msg
‡‡  #
)
‡‡# $
;
‡‡$ %
}
·· 
}
‚‚ 	
private
‰‰ 
static
‰‰ 
MailMessage
‰‰ "
CreateMessage
‰‰# 0
(
‰‰0 1
string
‰‰1 7
toEmails
‰‰8 @
,
‰‰@ A
string
‰‰B H
subject
‰‰I P
,
‰‰P Q
string
‰‰R X
body
‰‰Y ]
,
‰‰] ^
string
‰‰_ e
ccEmails
‰‰f n
=
‰‰o p
$str
‰‰q s
,
‰‰s t
string
‰‰u {
	bccEmails‰‰| Ö
=‰‰Ü á
$str‰‰à ä
,‰‰ä ã
List‰‰å ê
<‰‰ê ë
string‰‰ë ó
>‰‰ó ò
attachments‰‰ô §
=‰‰• ¶
null‰‰ß ´
)‰‰´ ¨
{
ÂÂ 	
MailMessage
ÊÊ 
msg
ÊÊ 
=
ÊÊ 
new
ÊÊ !
MailMessage
ÊÊ" -
(
ÊÊ- .
)
ÊÊ. /
;
ÊÊ/ 0
foreach
ÁÁ 
(
ÁÁ 
var
ÁÁ 
toEmail
ÁÁ  
in
ÁÁ! #
toEmails
ÁÁ$ ,
.
ÁÁ, -
Split
ÁÁ- 2
(
ÁÁ2 3
new
ÁÁ3 6
[
ÁÁ6 7
]
ÁÁ7 8
{
ÁÁ9 :
$str
ÁÁ; >
,
ÁÁ> ?
$str
ÁÁ@ C
}
ÁÁD E
,
ÁÁE F 
StringSplitOptions
ÁÁG Y
.
ÁÁY Z 
RemoveEmptyEntries
ÁÁZ l
)
ÁÁl m
)
ÁÁm n
{
ËË 
msg
ÈÈ 
.
ÈÈ 
To
ÈÈ 
.
ÈÈ 
Add
ÈÈ 
(
ÈÈ 
toEmail
ÈÈ "
.
ÈÈ" #
Trim
ÈÈ# '
(
ÈÈ' (
)
ÈÈ( )
)
ÈÈ) *
;
ÈÈ* +
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
!
ÏÏ 
string
ÏÏ 
.
ÏÏ 
IsNullOrEmpty
ÏÏ %
(
ÏÏ% &
ccEmails
ÏÏ& .
)
ÏÏ. /
)
ÏÏ/ 0
{
ÌÌ 
foreach
ÓÓ 
(
ÓÓ 
var
ÓÓ 
ccEmail
ÓÓ $
in
ÓÓ% '
ccEmails
ÓÓ( 0
.
ÓÓ0 1
Split
ÓÓ1 6
(
ÓÓ6 7
new
ÓÓ7 :
[
ÓÓ: ;
]
ÓÓ; <
{
ÓÓ= >
$str
ÓÓ? B
,
ÓÓB C
$str
ÓÓD G
}
ÓÓH I
,
ÓÓI J 
StringSplitOptions
ÓÓK ]
.
ÓÓ] ^ 
RemoveEmptyEntries
ÓÓ^ p
)
ÓÓp q
)
ÓÓq r
{
ÔÔ 
msg
 
.
 
CC
 
.
 
Add
 
(
 
ccEmail
 &
.
& '
Trim
' +
(
+ ,
)
, -
)
- .
;
. /
}
ÒÒ 
}
ÚÚ 
if
ÙÙ 
(
ÙÙ 
!
ÙÙ 
string
ÙÙ 
.
ÙÙ 
IsNullOrEmpty
ÙÙ %
(
ÙÙ% &
	bccEmails
ÙÙ& /
)
ÙÙ/ 0
)
ÙÙ0 1
{
ıı 
foreach
ˆˆ 
(
ˆˆ 
var
ˆˆ 
bccEmail
ˆˆ %
in
ˆˆ& (
	bccEmails
ˆˆ) 2
.
ˆˆ2 3
Split
ˆˆ3 8
(
ˆˆ8 9
new
ˆˆ9 <
[
ˆˆ< =
]
ˆˆ= >
{
ˆˆ? @
$str
ˆˆA D
,
ˆˆD E
$str
ˆˆF I
}
ˆˆJ K
,
ˆˆK L 
StringSplitOptions
ˆˆM _
.
ˆˆ_ ` 
RemoveEmptyEntries
ˆˆ` r
)
ˆˆr s
)
ˆˆs t
{
˜˜ 
msg
¯¯ 
.
¯¯ 
Bcc
¯¯ 
.
¯¯ 
Add
¯¯ 
(
¯¯  
bccEmail
¯¯  (
.
¯¯( )
Trim
¯¯) -
(
¯¯- .
)
¯¯. /
)
¯¯/ 0
;
¯¯0 1
}
˘˘ 
}
˙˙ 
msg
¸¸ 
.
¸¸ 
Subject
¸¸ 
=
¸¸ 
subject
¸¸ !
;
¸¸! "
msg
˝˝ 
.
˝˝ 

IsBodyHtml
˝˝ 
=
˝˝ 
true
˝˝ !
;
˝˝! "
msg
˛˛ 
.
˛˛ 
Body
˛˛ 
=
˛˛ 
body
˛˛ 
;
˛˛ 
if
ˇˇ 
(
ˇˇ 
attachments
ˇˇ 
!=
ˇˇ 
null
ˇˇ #
)
ˇˇ# $
foreach
ÄÄ 
(
ÄÄ 
var
ÄÄ 

attachment
ÄÄ '
in
ÄÄ( *
attachments
ÄÄ+ 6
)
ÄÄ6 7
{
ÅÅ 
msg
ÇÇ 
.
ÇÇ 
Attachments
ÇÇ #
.
ÇÇ# $
Add
ÇÇ$ '
(
ÇÇ' (
new
ÇÇ( +
System
ÇÇ, 2
.
ÇÇ2 3
Net
ÇÇ3 6
.
ÇÇ6 7
Mail
ÇÇ7 ;
.
ÇÇ; <

Attachment
ÇÇ< F
(
ÇÇF G

attachment
ÇÇG Q
)
ÇÇQ R
)
ÇÇR S
;
ÇÇS T
}
ÉÉ 
return
ÑÑ 
msg
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
}
ÜÜ 
}áá ä
PD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\FileManagment\FileHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
FileManagment' 4
{ 
public 

class 

FileHelper 
{ 
public 
static 
string 
GetValidFileName -
(- .
string. 4
fileName5 =
)= >
{		 	
string 
ret 
= 
Regex 
. 
Replace &
(& '
fileName' /
./ 0
Trim0 4
(4 5
)5 6
,6 7
$str8 J
,J K
$strL N
)N O
;O P
return 
ret 
. 
Replace 
( 
$str "
," #
string$ *
.* +
Empty+ 0
)0 1
;1 2
} 	
} 
} ‡y
QD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\FileManagment\FileManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
FileManagment' 4
{		 
public

 

static

 
class

 
FileManager

 #
{ 
static 
string 
_optOut 
= 
$str	  Ã
;
Ã Õ
static 
string 
_viewInBrowser $
=% &
$str	' ö
;
ö õ
static 
string 
_orderNumber "
;" #
static 
bool 
_isAddOptout  
;  !
static 
bool 
_isAddViewinBrowser '
;' (
public 
static 
HtmlProcessResult '
ProcessHtmlZip( 6
(6 7
string7 =

uploadPath> H
,H I
stringJ P
zipFilePathQ \
,\ ]
string^ d
orderNumbere p
,p q
boolr v
isAddOptout	w Ç
,
Ç É
bool
Ñ à 
isAddViewinBrowser
â õ
)
õ ú
{ 	
_orderNumber 
= 
orderNumber &
;& '
_isAddOptout 
= 
isAddOptout &
;& '
_isAddViewinBrowser 
=  !
isAddViewinBrowser" 4
;4 5
var 
	directory 
= 
$" 
{ 

uploadPath )
}) *
\\* ,
{, -
orderNumber- 8
}8 9
"9 :
;: ;
if 
( 
! 
	Directory 
. 
Exists !
(! "
	directory" +
)+ ,
), -
{ 
	Directory 
. 
CreateDirectory )
() *
	directory* 3
)3 4
;4 5
} 
ZipFile 
. 
ExtractToDirectory &
(& '
zipFilePath' 2
,2 3
	directory4 =
)= >
;> ?
var!! 

imagesLive!! 
=!! 
string!! #
.!!# $
Format!!$ *
(!!* +
$str!!+ 7
,!!7 8
orderNumber!!9 D
)!!D E
;!!E F
string"" 
htmlFileName"" 
=""  !
$"""" $
{""$ %
orderNumber""% 0
}""0 1
.htm""1 5
"""5 6
;""6 7
string## 
htmlFileKey## 
=##  
string##! '
.##' (
Format##( .
(##. /
$str##/ <
,##< =
orderNumber##> I
)##I J
;##J K
string$$ 
htmlFilePath$$ 
=$$  !
$"$$" $
{$$$ %
	directory$$% .
}$$. /
\\$$/ 1
{$$1 2
htmlFileName$$2 >
}$$> ?
"$$? @
;$$@ A
string&& 
htmlFile&& 
=&& 
	Directory&& '
.&&' (
EnumerateFiles&&( 6
(&&6 7
	directory&&7 @
)&&@ A
.&&A B
FirstOrDefault&&B P
(&&P Q
x&&Q R
=>&&S U
x&&V W
.&&W X
EndsWith&&X `
(&&` a
$str&&a f
)&&f g
||&&h j
x&&k l
.&&l m
EndsWith&&m u
(&&u v
$str&&v |
)&&| }
)&&} ~
;&&~ 
if'' 
('' 
string'' 
.'' 
IsNullOrEmpty'' #
(''# $
htmlFile''$ ,
)'', -
)''- .
throw(( 
new(( 
AdsException(( &
(((& '
$str((' 7
)((7 8
;((8 9
UploadFileStatus** 
status** #
=**$ %
ProcessHtml**& 1
(**1 2
htmlFile**2 :
,**: ;
htmlFilePath**< H
)**H I
;**I J
S3FileManager-- 
.-- 
CreateDirectory-- )
(--) *
orderNumber--* 5
)--5 6
;--6 7
S3FileManager00 
.00 
Upload00  
(00  !
htmlFileKey00! ,
,00, -
htmlFilePath00. :
,00: ;
true00< @
)00@ A
;00A B
string11 
filePathLive11 
=11  !
$"11" $
{11$ %
S3FileManager11% 2
.112 3
ServerPrefix113 ?
}11? @
{11@ A
htmlFileKey11A L
}11L M
"11M N
;11N O
S3FileManager44 
.44 
CreateDirectory44 )
(44) *

imagesLive44* 4
)444 5
;445 6
var77 
images77 
=77 
	Directory77 "
.77" # 
EnumerateDirectories77# 7
(777 8
	directory778 A
)77A B
.77B C
FirstOrDefault77C Q
(77Q R
)77R S
;77S T
if88 
(88 
images88 
!=88 
null88 
)88 
foreach99 
(99 
var99 
imgFile99  
in99! #
	Directory99$ -
.99- .
EnumerateFiles99. <
(99< =
images99= C
)99C D
)99D E
{:: 
var;; 
	imageLive;; 
=;; 
$";;  "
{;;" #

imagesLive;;# -
};;- .
/;;. /
{;;/ 0
new;;0 3
FileInfo;;4 <
(;;< =
imgFile;;= D
);;D E
.;;E F
Name;;F J
};;J K
";;K L
;;;L M
S3FileManager<< 
.<< 
Upload<< $
(<<$ %
	imageLive<<% .
,<<. /
imgFile<<0 7
,<<7 8
true<<9 =
)<<= >
;<<> ?
}== 
new@@ 
DirectoryInfo@@ 
(@@ 
	directory@@ '
)@@' (
.@@( )
Delete@@) /
(@@/ 0
true@@0 4
)@@4 5
;@@5 6
returnBB 
newBB 
HtmlProcessResultBB (
(BB( )
)BB) *
{BB+ ,
StatusBB, 2
=BB3 4
statusBB5 ;
,BB; <
FilePathLiveBB= I
=BBJ K
filePathLiveBBL X
}BBX Y
;BBY Z
}CC 	
publicEE 
staticEE 
UploadFileStatusEE &
ProcessHtmlEE' 2
(EE2 3
stringEE3 9
htmlFileEE: B
,EEB C
stringEED J
outputFilePathEEK Y
)EEY Z
{FF 	
stringGG 

imagesPathGG 
=GG 
stringGG  &
.GG& '
FormatGG' -
(GG- .
$strGG. >
,GG> ?
S3FileManagerGG@ M
.GGM N
ServerPrefixGGN Z
,GGZ [
_orderNumberGG\ h
)GGh i
;GGi j
HtmlDocumentII 
docII 
=II 
newII "
HtmlDocumentII# /
(II/ 0
)II0 1
;II1 2
docJJ 
.JJ 
LoadJJ 
(JJ 
htmlFileJJ 
)JJ 
;JJ 
varKK 
allSrcsKK 
=KK 
docKK 
.KK 
DocumentNodeKK *
.KK* +
SelectNodesKK+ 6
(KK6 7
$strKK7 D
)KKD E
;KKE F
boolLL 
alreadyHostedLL 
=LL  
falseLL! &
;LL& '
foreachMM 
(MM 
HtmlNodeMM 
nodeMM "
inMM# %
allSrcsMM& -
)MM- .
{NN 
varOO 
srcOO 
=OO 
nodeOO 
.OO 

AttributesOO )
[OO) *
$strOO* /
]OO/ 0
.OO0 1
ValueOO1 6
;OO6 7
ifQQ 
(QQ 
srcQQ 
.QQ 
ContainsQQ  
(QQ  !
$strQQ! *
)QQ* +
)QQ+ ,
{RR 
alreadyHostedSS !
=SS" #
trueSS$ (
;SS( )
breakTT 
;TT 
;TT 
}UU 
elseVV 
{WW 
varZZ 
srcsZZ 
=ZZ 
srcZZ "
.ZZ" #
SplitZZ# (
(ZZ( )
$strZZ) ,
.ZZ, -
ToCharArrayZZ- 8
(ZZ8 9
)ZZ9 :
)ZZ: ;
;ZZ; <
string[[ 
imgFileName[[ &
=[[' (
srcs[[) -
.[[- .
Length[[. 4
>[[5 6
$num[[7 8
?[[9 :
srcs[[; ?
[[[? @
$num[[@ A
][[A B
:[[C D
string[[E K
.[[K L
Empty[[L Q
;[[Q R
src\\ 
=\\ 
$"\\ 
{\\ 

imagesPath\\ '
}\\' (
{\\( )
imgFileName\\) 4
}\\4 5
"\\5 6
;\\6 7
}]] 
node^^ 
.^^ 
SetAttributeValue^^ &
(^^& '
$str^^' ,
,^^, -
src^^. 1
)^^1 2
;^^2 3
}__ 
HtmlNodeaa 
bodyaa 
=aa 
docaa 
.aa  
DocumentNodeaa  ,
.aa, -
SelectSingleNodeaa- =
(aa= >
$straa> F
)aaF G
;aaG H
ifbb 
(bb 
_isAddViewinBrowserbb #
)bb# $
{cc 
HtmlNodedd 
newNodedd  
=dd! "
HtmlNodedd# +
.dd+ ,

CreateNodedd, 6
(dd6 7
_viewInBrowserdd7 E
)ddE F
;ddF G
bodyee 
.ee 
PrependChildee !
(ee! "
newNodeee" )
)ee) *
;ee* +
}ff 
ifgg 
(gg 
_isAddOptoutgg 
)gg 
{hh 
HtmlNodeii 
newNodeii  
=ii! "
HtmlNodeii# +
.ii+ ,

CreateNodeii, 6
(ii6 7
_optOutii7 >
)ii> ?
;ii? @
bodyjj 
.jj 
AppendChildjj  
(jj  !
newNodejj! (
)jj( )
;jj) *
}kk 
docmm 
.mm 
Savemm 
(mm 
outputFilePathmm #
)mm# $
;mm$ %
returnoo 
alreadyHostedoo  
?oo! "
UploadFileStatusoo# 3
.oo3 4
HostedWithOutImagesoo4 G
:ooH I
UploadFileStatusooK [
.oo[ \
HostedWithImagesoo\ l
;ool m
}pp 	
publicrr 
staticrr 
stringrr 
GetFilePathLiverr ,
(rr, -
UploadFileTyperr- ;
uploadFileTyperr< J
,rrJ K
stringrrL R
orderNumberrrS ^
,rr^ _
stringrr` f
	extensionrrg p
=rrq r
$strrrs u
,rru v
stringrrw }
segmentNumber	rr~ ã
=
rrå ç
$str
rré ê
)
rrê ë
{ss 	
stringtt 
fileNamett 
=tt 
$strtt  
;tt  !
switchuu 
(uu 
uploadFileTypeuu "
)uu" #
{vv 
caseww 
UploadFileTypeww '
.ww' (
ZipFileww( /
:ww/ 0
fileNamexx  
=xx! "
stringxx# )
.xx) *
Formatxx* 0
(xx0 1
$strxx1 D
,xxD E
S3FileManagerxxF S
.xxS T
ServerPrefixxxT `
,xx` a
orderNumberxxb m
)xxm n
;xxn o
breakyy 
;yy 
casezz 
UploadFileTypezz '
.zz' (
TestSeedFilezz( 4
:zz4 5
fileName{{  
={{! "
string{{# )
.{{) *
Format{{* 0
({{0 1
$str{{1 E
,{{E F
S3FileManager{{G T
.{{T U
ServerPrefix{{U a
,{{a b
orderNumber{{c n
){{n o
;{{o p
break|| 
;|| 
case}} 
UploadFileType}} '
.}}' (
LiveSeedFile}}( 4
:}}4 5
fileName~~  
=~~! "
string~~# )
.~~) *
Format~~* 0
(~~0 1
$str~~1 E
,~~E F
S3FileManager~~G T
.~~T U
ServerPrefix~~U a
,~~a b
orderNumber~~c n
)~~n o
;~~o p
break 
; 
case
ÄÄ 
UploadFileType
ÄÄ '
.
ÄÄ' (
SuppressionFile
ÄÄ( 7
:
ÄÄ7 8
fileName
ÅÅ  
=
ÅÅ! "
string
ÅÅ# )
.
ÅÅ) *
Format
ÅÅ* 0
(
ÅÅ0 1
$str
ÅÅ1 E
,
ÅÅE F
S3FileManager
ÅÅG T
.
ÅÅT U
ServerPrefix
ÅÅU a
,
ÅÅa b
orderNumber
ÅÅc n
)
ÅÅn o
;
ÅÅo p
break
ÇÇ 
;
ÇÇ 
case
ÉÉ 
UploadFileType
ÉÉ '
.
ÉÉ' (
BannersFile
ÉÉ( 3
:
ÉÉ3 4
fileName
ÑÑ $
=
ÑÑ% &
$"
ÑÑ' )
{
ÑÑ) *
S3FileManager
ÑÑ* 7
.
ÑÑ7 8
ServerPrefix
ÑÑ8 D
}
ÑÑD E
{
ÑÑE F
orderNumber
ÑÑF Q
}
ÑÑQ R
/_banner
ÑÑR Z
{
ÑÑZ [
	extension
ÑÑ[ d
}
ÑÑd e
"
ÑÑe f
;
ÑÑf g
break
ÖÖ 
;
ÖÖ 
case
ÜÜ 
UploadFileType
ÜÜ '
.
ÜÜ' (
BannersLinksFile
ÜÜ( 8
:
ÜÜ8 9
fileName
áá $
=
áá% &
$"
áá' )
{
áá) *
S3FileManager
áá* 7
.
áá7 8
ServerPrefix
áá8 D
}
ááD E
{
ááE F
orderNumber
ááF Q
}
ááQ R
/_bannerlinks
ááR _
{
áá_ `
	extension
áá` i
}
áái j
"
ááj k
;
áák l
break
àà 
;
àà 
case
ââ 
UploadFileType
ââ '
.
ââ' (
MiscFile
ââ( 0
:
ââ0 1
fileName
ää  
=
ää! "
$"
ää# %
{
ää% &
S3FileManager
ää& 3
.
ää3 4
ServerPrefix
ää4 @
}
ää@ A
{
ääA B
orderNumber
ääB M
}
ääM N
/_misc
ääN T
{
ääT U
	extension
ääU ^
}
ää^ _
"
ää_ `
;
ää` a
break
ãã 
;
ãã 
case
åå 
UploadFileType
åå '
.
åå' (
DataFile
åå( 0
:
åå0 1
fileName
çç  
=
çç! "
$"
çç# %
{
çç% &
S3FileManager
çç& 3
.
çç3 4
ServerPrefix
çç4 @
}
çç@ A
{
ççA B
orderNumber
ççB M
}
ççM N
/
ççN O
{
ççO P
segmentNumber
ççP ]
}
çç] ^
data.csv
çç^ f
"
ççf g
;
ççg h
break
éé 
;
éé 
case
èè 
UploadFileType
èè '
.
èè' (
DataFileOpener
èè( 6
:
èè6 7
fileName
êê  
=
êê! "
$"
êê# %
{
êê% &
S3FileManager
êê& 3
.
êê3 4
ServerPrefix
êê4 @
}
êê@ A
{
êêA B
orderNumber
êêB M
}
êêM N
/
êêN O
{
êêO P
orderNumber
êêP [
}
êê[ \

opener.csv
êê\ f
"
êêf g
;
êêg h
break
ëë 
;
ëë 
}
íí 
return
ìì 
fileName
ìì 
;
ìì 
}
îî 	
}
ïï 
}ññ àd
TD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\FileManagment\FileManagerFTP.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
FileManagment' 4
{ 
public		 

class		 
FileManagerFtp		 
{

 
static 
string 
_optOut 
= 
$str	  Ã
;
Ã Õ
static 
string 
_viewInBrowser $
=% &
$str	' ö
;
ö õ
private 
static 
string 
_orderNumber *
;* +
private 
static 
bool 
_isAddOptout (
;( )
private 
static 
bool 
_isAddViewinBrowser /
;/ 0
public 
static 
HtmlProcessResult '
ProcessHtmlZip( 6
(6 7
string7 =

uploadPath> H
,H I
stringJ P
zipFilePathQ \
,\ ]
string^ d
orderNumbere p
,p q
boolr v
isAddOptout	w Ç
,
Ç É
bool
Ñ à 
isAddViewinBrowser
â õ
)
õ ú
{ 	
_orderNumber 
= 
orderNumber &
;& '
_isAddOptout 
= 
isAddOptout &
;& '
_isAddViewinBrowser 
=  !
isAddViewinBrowser" 4
;4 5
FileUploader 
uploader !
=" #
new$ '
FileUploader( 4
(4 5
)5 6
;6 7
var 
	directory 
= 
$" 
{ 

uploadPath )
}) *
\\* ,
{, -
orderNumber- 8
}8 9
temp9 =
"= >
;> ?
if 
( 
	Directory 
. 
Exists  
(  !
	directory! *
)* +
)+ ,
{ 
new 
DirectoryInfo !
(! "
	directory" +
)+ ,
., -
Delete- 3
(3 4
true4 8
)8 9
;9 :
} 
else 
{ 
	Directory   
.   
CreateDirectory   )
(  ) *
	directory  * 3
)  3 4
;  4 5
}!! 
ZipFile"" 
."" 
ExtractToDirectory"" &
(""& '
zipFilePath""' 2
,""2 3
	directory""4 =
)""= >
;""> ?
string%% 
htmlFileName%% 
=%%  !
$"%%" $
{%%$ %
orderNumber%%% 0
}%%0 1
.htm%%1 5
"%%5 6
;%%6 7
string&& 
htmlFilePath&& 
=&&  !
$"&&" $
{&&$ %
	directory&&% .
}&&. /
\\&&/ 1
{&&1 2
htmlFileName&&2 >
}&&> ?
"&&? @
;&&@ A
string(( 
htmlFile(( 
=(( 
	Directory(( '
.((' (
EnumerateFiles((( 6
(((6 7
	directory((7 @
)((@ A
.((A B
FirstOrDefault((B P
(((P Q
x((Q R
=>((S U
x((V W
.((W X
EndsWith((X `
(((` a
$str((a f
)((f g
||((h j
x((k l
.((l m
EndsWith((m u
(((u v
$str((v |
)((| }
)((} ~
;((~ 
if)) 
()) 
string)) 
.)) 
IsNullOrEmpty)) #
())# $
htmlFile))$ ,
))), -
)))- .
throw** 
new** 
AdsException** &
(**& '
$str**' 7
)**7 8
;**8 9
UploadFileStatus,, 
status,, #
=,,$ %
ProcessHtml,,& 1
(,,1 2
htmlFile,,2 :
,,,: ;
htmlFilePath,,< H
),,H I
;,,I J
uploader// 
.// 
CreateDirectory// $
(//$ %
orderNumber//% 0
)//0 1
;//1 2
string22 
filePathLive22 
=22  !
uploader22" *
.22* +
Upload22+ 1
(221 2
orderNumber222 =
,22= >
htmlFileName22? K
,22K L
htmlFilePath22M Y
)22Y Z
;22Z [
var55 

imagesLive55 
=55 
$"55 
{55  
orderNumber55  +
}55+ ,
/55, -
{55- .
orderNumber55. 9
}559 :
img55: =
"55= >
;55> ?
uploader66 
.66 
CreateDirectory66 $
(66$ %

imagesLive66% /
)66/ 0
;660 1
var99 
images99 
=99 
	Directory99 "
.99" # 
EnumerateDirectories99# 7
(997 8
	directory998 A
)99A B
.99B C
FirstOrDefault99C Q
(99Q R
)99R S
;99S T
if:: 
(:: 
images:: 
!=:: 
null:: 
):: 
foreach;; 
(;; 
var;; 
imgFile;; $
in;;% '
	Directory;;( 1
.;;1 2
EnumerateFiles;;2 @
(;;@ A
images;;A G
);;G H
);;H I
{<< 
var== 
file== 
=== 
new== "
FileInfo==# +
(==+ ,
imgFile==, 3
)==3 4
;==4 5
uploader>> 
.>> 
Upload>> #
(>># $

imagesLive>>$ .
,>>. /
file>>0 4
.>>4 5
Name>>5 9
,>>9 :
imgFile>>; B
)>>B C
;>>C D
}?? 
newBB 
DirectoryInfoBB 
(BB 
	directoryBB '
)BB' (
.BB( )
DeleteBB) /
(BB/ 0
trueBB0 4
)BB4 5
;BB5 6
returnDD 
newDD 
HtmlProcessResultDD (
(DD( )
)DD) *
{DD+ ,
StatusDD, 2
=DD3 4
statusDD5 ;
,DD; <
FilePathLiveDD= I
=DDJ K
filePathLiveDDL X
}DDX Y
;DDY Z
}EE 	
publicGG 
staticGG 
UploadFileStatusGG &
ProcessHtmlGG' 2
(GG2 3
stringGG3 9
htmlFileGG: B
,GGB C
stringGGD J
outputFilePathGGK Y
)GGY Z
{HH 	
stringII 

imagesPathII 
=II 
stringII  &
.II& '
FormatII' -
(II- .
$strII. ^
,II^ _
_orderNumberII` l
)IIl m
;IIm n
HtmlDocumentKK 
docKK 
=KK 
newKK "
HtmlDocumentKK# /
(KK/ 0
)KK0 1
;KK1 2
docLL 
.LL 
LoadLL 
(LL 
htmlFileLL 
)LL 
;LL 
varMM 
allSrcsMM 
=MM 
docMM 
.MM 
DocumentNodeMM *
.MM* +
SelectNodesMM+ 6
(MM6 7
$strMM7 D
)MMD E
;MME F
boolNN 
alreadyHostedNN 
=NN  
falseNN! &
;NN& '
foreachOO 
(OO 
HtmlNodeOO 
nodeOO "
inOO# %
allSrcsOO& -
)OO- .
{PP 
varQQ 
srcQQ 
=QQ 
nodeQQ 
.QQ 

AttributesQQ )
[QQ) *
$strQQ* /
]QQ/ 0
.QQ0 1
ValueQQ1 6
;QQ6 7
ifSS 
(SS 
srcSS 
.SS 
ContainsSS  
(SS  !
$strSS! *
)SS* +
)SS+ ,
{TT 
alreadyHostedUU !
=UU" #
trueUU$ (
;UU( )
breakVV 
;VV 
;VV 
}WW 
elseXX 
{YY 
var\\ 
srcs\\ 
=\\ 
src\\ "
.\\" #
Split\\# (
(\\( )
$str\\) ,
.\\, -
ToCharArray\\- 8
(\\8 9
)\\9 :
)\\: ;
;\\; <
string]] 
imgFileName]] &
=]]' (
srcs]]) -
.]]- .
Length]]. 4
>]]5 6
$num]]7 8
?]]9 :
srcs]]; ?
[]]? @
$num]]@ A
]]]A B
:]]C D
string]]E K
.]]K L
Empty]]L Q
;]]Q R
src^^ 
=^^ 
$"^^ 
{^^ 

imagesPath^^ '
}^^' (
{^^( )
imgFileName^^) 4
}^^4 5
"^^5 6
;^^6 7
}__ 
node`` 
.`` 
SetAttributeValue`` &
(``& '
$str``' ,
,``, -
src``. 1
)``1 2
;``2 3
}aa 
HtmlNodecc 
bodycc 
=cc 
doccc 
.cc  
DocumentNodecc  ,
.cc, -
SelectSingleNodecc- =
(cc= >
$strcc> F
)ccF G
;ccG H
ifdd 
(dd 
_isAddViewinBrowserdd #
)dd# $
{ee 
HtmlNodeff 
newNodeff  
=ff! "
HtmlNodeff# +
.ff+ ,

CreateNodeff, 6
(ff6 7
_viewInBrowserff7 E
)ffE F
;ffF G
bodygg 
.gg 
PrependChildgg !
(gg! "
newNodegg" )
)gg) *
;gg* +
}hh 
ifii 
(ii 
_isAddOptoutii 
)ii 
{jj 
HtmlNodekk 
newNodekk  
=kk! "
HtmlNodekk# +
.kk+ ,

CreateNodekk, 6
(kk6 7
_optOutkk7 >
)kk> ?
;kk? @
bodyll 
.ll 
AppendChildll  
(ll  !
newNodell! (
)ll( )
;ll) *
}mm 
docoo 
.oo 
Saveoo 
(oo 
outputFilePathoo #
)oo# $
;oo$ %
returnqq 
alreadyHostedqq  
?qq! "
UploadFileStatusqq# 3
.qq3 4
HostedWithOutImagesqq4 G
:qqH I
UploadFileStatusqqK [
.qq[ \
HostedWithImagesqq\ l
;qql m
}rr 	
publictt 
statictt 
stringtt 

UploadFilett '
(tt' (
UploadFileTypett( 6
uploadFileTypett7 E
,ttE F
stringttG M
filePathttN V
,ttV W
stringttX ^
orderNumbertt_ j
)ttj k
{uu 	
FileUploadervv 
uploadervv !
=vv" #
newvv$ '
FileUploadervv( 4
(vv4 5
)vv5 6
;vv6 7
uploaderyy 
.yy 
CreateDirectoryyy $
(yy$ %
orderNumberyy% 0
)yy0 1
;yy1 2
string{{ 
fileName{{ 
={{ 
$str{{  
;{{  !
switch|| 
(|| 
uploadFileType|| "
)||" #
{}} 
case~~ 
UploadFileType~~ '
.~~' (
ZipFile~~( /
:~~/ 0
fileName  
=! "
$"# %
{% &
orderNumber& 1
}1 2
zip.csv2 9
"9 :
;: ;
break
ÄÄ 
;
ÄÄ 
case
ÅÅ 
UploadFileType
ÅÅ '
.
ÅÅ' (
TestSeedFile
ÅÅ( 4
:
ÅÅ4 5
fileName
ÇÇ  
=
ÇÇ! "
$"
ÇÇ# %
{
ÇÇ% &
orderNumber
ÇÇ& 1
}
ÇÇ1 2
test.csv
ÇÇ2 :
"
ÇÇ: ;
;
ÇÇ; <
break
ÉÉ 
;
ÉÉ 
case
ÑÑ 
UploadFileType
ÑÑ '
.
ÑÑ' (
LiveSeedFile
ÑÑ( 4
:
ÑÑ4 5
fileName
ÖÖ  
=
ÖÖ! "
$"
ÖÖ# %
{
ÖÖ% &
orderNumber
ÖÖ& 1
}
ÖÖ1 2
live.csv
ÖÖ2 :
"
ÖÖ: ;
;
ÖÖ; <
break
ÜÜ 
;
ÜÜ 
case
áá 
UploadFileType
áá '
.
áá' (
SuppressionFile
áá( 7
:
áá7 8
fileName
àà  
=
àà! "
$"
àà# %
{
àà% &
orderNumber
àà& 1
}
àà1 2
supp.csv
àà2 :
"
àà: ;
;
àà; <
break
ââ 
;
ââ 
}
ää 
return
ãã 
uploader
ãã 
.
ãã 
Upload
ãã "
(
ãã" #
orderNumber
ãã# .
,
ãã. /
fileName
ãã0 8
,
ãã8 9
filePath
ãã: B
)
ããB C
;
ããC D
}
åå 	
}
çç 
}éé ‘8
RD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\FileManagment\FileUploader.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
FileManagment' 4
{ 
public 

class 
FileUploader 
{ 
private		 
readonly		 
string		 
_ftpUsername		  ,
;		, -
private

 
readonly

 
string

 
_ftpPassword

  ,
;

, -
private 
readonly 
string 
_baseUrl  (
;( )
private 
readonly 
string 
_serverPrefix  -
=. /
$str0 U
;U V
public 
FileUploader 
( 
) 
{ 	
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 <
]< =
==> @
nullA E
)E F
throw 
new 
AdsException &
(& '
$str' A
)A B
;B C
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 >
]> ?
==@ B
nullC G
)G H
throw 
new 
AdsException &
(& '
$str' C
)C D
;D E
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 >
]> ?
==@ B
nullC G
)G H
throw 
new 
AdsException &
(& '
$str' C
)C D
;D E
var 
	ftpServer 
=  
ConfigurationManager 0
.0 1
AppSettings1 <
[< =
$str= H
]H I
;I J
_ftpUsername 
=  
ConfigurationManager /
./ 0
AppSettings0 ;
[; <
$str< I
]I J
;J K
_ftpPassword 
=  
ConfigurationManager /
./ 0
AppSettings0 ;
[; <
$str< I
]I J
;J K
_baseUrl 
= 
$" 
ftp:// 
{  
	ftpServer  )
}) *
/public_html/ep2/* ;
"; <
;< =
} 	
public 
bool 
DirectoryExists #
(# $
string$ *
directoryPath+ 8
)8 9
{ 	
bool 
directoryExists  
;  !
var   
request   
=   
(   
FtpWebRequest   (
)  ( )

WebRequest  ) 3
.  3 4
Create  4 :
(  : ;
directoryPath  ; H
+  I J
$str  K N
)  N O
;  O P
request!! 
.!! 
Method!! 
=!! 
WebRequestMethods!! .
.!!. /
Ftp!!/ 2
.!!2 3
ListDirectory!!3 @
;!!@ A
request"" 
."" 
Credentials"" 
=""  !
new""" %
NetworkCredential""& 7
(""7 8
_ftpUsername""8 D
,""D E
_ftpPassword""F R
)""R S
;""S T
try## 
{$$ 
using%% 
(%% 
request%% 
.%% 
GetResponse%% *
(%%* +
)%%+ ,
)%%, -
{&& 
directoryExists'' #
=''$ %
true''& *
;''* +
}(( 
})) 
catch** 
(** 
WebException** 
ex**  "
)**" #
{++ 
directoryExists,, 
=,,  !
false,," '
;,,' (
}-- 
return.. 
directoryExists.. "
;.." #
}// 	
public11 
void11 
CreateDirectory11 #
(11# $
string11$ *
directoryName11+ 8
)118 9
{22 	
string33 
directoryPath33  
=33! "
_baseUrl33# +
+33, -
directoryName33. ;
;33; <
if55 
(55 
DirectoryExists55 
(55 
directoryPath55 ,
)55, -
)55- .
return55/ 5
;555 6

WebRequest77 
request77 
=77  

WebRequest77! +
.77+ ,
Create77, 2
(772 3
directoryPath773 @
)77@ A
;77A B
request88 
.88 
Method88 
=88 
WebRequestMethods88 .
.88. /
Ftp88/ 2
.882 3
MakeDirectory883 @
;88@ A
request99 
.99 
Credentials99 
=99  !
new99" %
NetworkCredential99& 7
(997 8
_ftpUsername998 D
,99D E
_ftpPassword99F R
)99R S
;99S T
try:: 
{;; 
var<< 
resp<< 
=<< 
(<< 
FtpWebResponse<< *
)<<* +
request<<, 3
.<<3 4
GetResponse<<4 ?
(<<? @
)<<@ A
;<<A B
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
{?? 
}AA 
}BB 	
publicDD 
stringDD 
UploadDD 
(DD 
stringDD #
directoryNameDD$ 1
,DD1 2
stringDD3 9
fileNameDD: B
,DDB C
stringDDD J
filePathDDK S
)DDS T
{EE 	
usingFF 
(FF 
	WebClientFF 
clientFF #
=FF$ %
newFF& )
	WebClientFF* 3
(FF3 4
)FF4 5
)FF5 6
{GG 
clientHH 
.HH 
CredentialsHH "
=HH# $
newHH% (
NetworkCredentialHH) :
(HH: ;
_ftpUsernameHH; G
,HHG H
_ftpPasswordHHI U
)HHU V
;HHV W
stringII 
filePathFtpII "
=II# $
$"II% '
{II' (
_baseUrlII( 0
}II0 1
{II1 2
directoryNameII2 ?
}II? @
/II@ A
{IIA B
fileNameIIB J
}IIJ K
"IIK L
;IIL M
UriJJ 
addressJJ 
=JJ 
newJJ !
UriJJ" %
(JJ% &
filePathFtpJJ& 1
)JJ1 2
;JJ2 3
clientKK 
.KK 

UploadFileKK !
(KK! "
addressKK" )
,KK) *
filePathKK+ 3
)KK3 4
;KK4 5
stringLL 
filePathLiveLL #
=LL$ %
$"LL& (
{LL( )
_serverPrefixLL) 6
}LL6 7
{LL7 8
directoryNameLL8 E
}LLE F
/LLF G
{LLG H
fileNameLLH P
}LLP Q
"LLQ R
;LLR S
returnMM 
filePathLiveMM #
;MM# $
}NN 
}OO 	
}PP 
}QQ †
WD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\FileManagment\HtmlProcessResult.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
FileManagment' 4
{ 
public 

class 
HtmlProcessResult "
{ 
public 
string 
FilePathLive "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
UploadFileStatus 
Status  &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
}		 
}

 Ç9
ID:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Image\ImageHelper.cs
	namespace		 	
ADSDataDirect		
 
.		 
Infrastructure		 &
.		& '
Image		' ,
{

 
public 

class 
ImageHelper 
{ 
private 
readonly 
string 
_url  $
;$ %
private 
readonly 
string 
	_filePath  )
;) *
public 
ImageHelper 
( 
string !
url" %
,% &
string' -
filePath. 6
)6 7
{ 	
_url 
= 
url 
; 
	_filePath 
= 
filePath  
;  !
} 	
public 
void 
Capture 
( 
) 
{ 	
Thread 
thread 
= 
new 
Thread  &
(& '
delegate' /
(0 1
)1 2
{ 
using 
( 

WebBrowser !
browser" )
=* +
new, /

WebBrowser0 :
(: ;
); <
)< =
{ 
browser 
. 
ScrollBarsEnabled -
=. /
false0 5
;5 6
browser 
. 
AllowNavigation +
=, -
true. 2
;2 3
browser 
. "
ScriptErrorsSuppressed 2
=3 4
true5 9
;9 :
browser 
. 
Navigate $
($ %
_url% )
)) *
;* +
browser!! 
.!! 
DocumentCompleted!! -
+=!!. 0
new!!1 43
'WebBrowserDocumentCompletedEventHandler!!5 \
(!!\ ]
DocumentCompleted!!] n
)!!n o
;!!o p
while"" 
("" 
browser"" "
.""" #

ReadyState""# -
!="". 0 
WebBrowserReadyState""1 E
.""E F
Complete""F N
)""N O
{## 
System$$ 
.$$ 
Windows$$ &
.$$& '
Forms$$' ,
.$$, -
Application$$- 8
.$$8 9
DoEvents$$9 A
($$A B
)$$B C
;$$C D
}%% 
}&& 
}'' 
)'' 
;'' 
thread(( 
.(( 
SetApartmentState(( $
((($ %
ApartmentState((% 3
.((3 4
STA((4 7
)((7 8
;((8 9
thread)) 
.)) 
Start)) 
()) 
))) 
;)) 
thread** 
.** 
Join** 
(** 
)** 
;** 
}++ 	
private-- 
void-- 
DocumentCompleted-- &
(--& '
object--' -
sender--. 4
,--4 50
$WebBrowserDocumentCompletedEventArgs--6 Z
e--[ \
)--\ ]
{.. 	

WebBrowser// 
wb// 
=// 
sender// "
as//# %

WebBrowser//& 0
;//0 1
if00 
(00 
!00 
wb00 
.00 
Document00 
.00 
Title00 "
.00" #
Equals00# )
(00) *
$str00* >
)00> ?
)00? @
{11 
int22 
scrollWidth22 
=22  !
$num22" #
;22# $
int33 
scrollHeight33  
=33! "
$num33# $
;33$ %
scrollHeight55 
=55 
wb55 !
.55! "
Document55" *
.55* +
Body55+ /
.55/ 0
ScrollRectangle550 ?
.55? @
Height55@ F
;55F G
scrollWidth66 
=66 
wb66  
.66  !
Document66! )
.66) *
Body66* .
.66. /
ScrollRectangle66/ >
.66> ?
Width66? D
;66D E
wb77 
.77 
Size77 
=77 
new77 
Size77 "
(77" #
scrollWidth77# .
,77. /
scrollHeight770 <
)77< =
;77= >
Bitmap:: 
bitmap:: 
=:: 
new::  #
Bitmap::$ *
(::* +
wb::+ -
.::- .
Width::. 3
,::3 4
wb::5 7
.::7 8
Height::8 >
)::> ?
;::? @
for;; 
(;; 
int;; 
xcount;; 
=;;  !
$num;;" #
;;;# $
xcount;;% +
<;;, -
bitmap;;. 4
.;;4 5
Width;;5 :
;;;: ;
xcount;;< B
++;;B D
);;D E
for<< 
(<< 
int<< 
ycount<< #
=<<$ %
$num<<& '
;<<' (
ycount<<) /
<<<0 1
bitmap<<2 8
.<<8 9
Height<<9 ?
;<<? @
ycount<<A G
++<<G I
)<<I J
bitmap== 
.== 
SetPixel== '
(==' (
xcount==( .
,==. /
ycount==0 6
,==6 7
Color==8 =
.=== >
Black==> C
)==C D
;==D E
wb>> 
.>> 
DrawToBitmap>> 
(>>  
bitmap>>  &
,>>& '
new>>( +
	Rectangle>>, 5
(>>5 6
$num>>6 7
,>>7 8
$num>>9 :
,>>: ;
wb>>< >
.>>> ?
Width>>? D
,>>D E
wb>>F H
.>>H I
Height>>I O
)>>O P
)>>P Q
;>>Q R
bitmap?? 
.?? 
Save?? 
(?? 
	_filePath?? %
,??% &
ImageFormat??' 2
.??2 3
Png??3 6
)??6 7
;??7 8
}@@ 
}AA 	
publicBB 
staticBB 
stringBB 
GetCapturedImageBB -
(BB- .
stringBB. 4
urlBB5 8
,BB8 9
stringBB: @
filePathBBA I
)BBI J
{CC 	
tryDD 
{EE 
HttpWebRequestFF 
requestFF &
=FF' (
HttpWebRequestFF) 7
.FF7 8
CreateFF8 >
(FF> ?
urlFF? B
)FFB C
asFFD F
HttpWebRequestFFG U
;FFU V
BitmapGG 
bitmapGG 
;GG 
usingHH 
(HH 
StreamHH 
streamHH $
=HH% &
requestHH' .
.HH. /
GetResponseHH/ :
(HH: ;
)HH; <
.HH< =
GetResponseStreamHH= N
(HHN O
)HHO P
)HHP Q
{II 
bitmapJJ 
=JJ 
newJJ  
BitmapJJ! '
(JJ' (
streamJJ( .
)JJ. /
;JJ/ 0
bitmapKK 
.KK 
SaveKK 
(KK  
filePathKK  (
)KK( )
;KK) *
}LL 
}MM 
catchNN 
(NN 
	ExceptionNN 
exNN 
)NN  
{OO 
}QQ 
returnRR 
filePathRR 
;RR 
}SS 	
}TT 
}UU ó
JD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Image\ImageResizer.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Image' ,
{ 
public 

static 
class 
ImageResizer $
{ 
public 
static 
void 
Resize !
(! "
string" (
originalFile) 5
,5 6
string7 =
newFile> E
,E F
intG J
newWidthK S
,S T
intU X
	maxHeightY b
,b c
boold h
onlyResizeIfWideri z
)z {
{ 	
System		 
.		 
Drawing		 
.		 
Image		  
fullsizeImage		! .
=		/ 0
System		1 7
.		7 8
Drawing		8 ?
.		? @
Image		@ E
.		E F
FromFile		F N
(		N O
originalFile		O [
)		[ \
;		\ ]
fullsizeImage 
. 

RotateFlip $
($ %
System% +
.+ ,
Drawing, 3
.3 4
RotateFlipType4 B
.B C
Rotate180FlipNoneC T
)T U
;U V
fullsizeImage 
. 

RotateFlip $
($ %
System% +
.+ ,
Drawing, 3
.3 4
RotateFlipType4 B
.B C
Rotate180FlipNoneC T
)T U
;U V
if 
( 
onlyResizeIfWider !
&&" $
fullsizeImage% 2
.2 3
Width3 8
<=9 ;
newWidth< D
)D E
newWidth 
= 
fullsizeImage (
.( )
Width) .
;. /
int 
	newHeight 
= 
fullsizeImage )
.) *
Height* 0
*1 2
newWidth3 ;
/< =
fullsizeImage> K
.K L
WidthL Q
;Q R
if 
( 
	newHeight 
> 
	maxHeight %
)% &
{ 
newWidth 
= 
fullsizeImage (
.( )
Width) .
*/ 0
	maxHeight1 :
/; <
fullsizeImage= J
.J K
HeightK Q
;Q R
	newHeight 
= 
	maxHeight %
;% &
} 
System 
. 
Drawing 
. 
Image  
newImage! )
=* +
fullsizeImage, 9
.9 :
GetThumbnailImage: K
(K L
newWidthL T
,T U
	newHeightV _
,_ `
nulla e
,e f
IntPtrg m
.m n
Zeron r
)r s
;s t
fullsizeImage 
. 
Dispose !
(! "
)" #
;# $
newImage   
.   
Save   
(   
newFile   !
)  ! "
;  " #
}!! 	
}"" 
}## ≤
MD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\MailChimps\CreativeVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

MailChimps' 1
{ 
public 

partial 
class 

CreativeVm #
{ 
public		 
string		 
Id		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
string

 

CampaignId

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
TestSeedFile "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
LiveSeedFile "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
	AllowHtml	 
] 
public 
string 
	Creatives 
{  !
get" %
;% &
set' *
;* +
}, -
public 
List 
< 
SelectItemPair "
>" #

TestEmails$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
List 
< 
SelectItemPair "
>" #

LiveEmails$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string 
QuickTestEmails %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
MailChimpList #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
MailChimpCampaign '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
} 
} ä,
bD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataReports\CampaignTrackingMetricDetailVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DataReports' 2
{ 
public		 

class		 *
CampaignTrackingMetricDetailVm		 /
{

 
public 
string 
Deployment_Date %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
int 
SFD_ID 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
	Client_ID 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Campaign_Name #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
	From_Line 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Subject_Line "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
URLS 
{ 
get  
;  !
set" %
;% &
}' (
public 
long 
Total_Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
Unique_Clicks !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
long 
Mobile_Clicks !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
ID 
{ 
get 
; 
set  
;  !
}" #
public 
static *
CampaignTrackingMetricDetailVm 4
[4 5
]5 6 
FromCampaignTracking7 K
(K L
CampaignL T
campaignU ]
,] ^
CampaignTracking_ o
campaignTracking	p Ä
)
Ä Å
{ 	
var 
urls 
= 
new 
List 
<  *
CampaignTrackingMetricDetailVm  >
>> ?
(? @
)@ A
;A B
var 
proDatas 
= 
campaign #
.# $
ProDatas$ ,
. 
Where 
( 
x 
=> 
x 
. 
OrderNumber )
==* ,
campaignTracking- =
.= >
OrderNumber> I
&&J L
xM N
.N O
SegmentNumberO \
==] _
campaignTracking` p
.p q
SegmentNumberq ~
)~ 
. 
OrderByDescending "
(" #
x# $
=>% '
x( )
.) *

ClickCount* 4
)4 5
;5 6
int 
index 
= 
$num 
; 
foreach   
(   
var   
proData    
in  ! #
proDatas  $ ,
)  , -
{!! 
var"" 
model"" 
="" 
new"" *
CampaignTrackingMetricDetailVm""  >
{## 
SFD_ID$$ 
=$$ 
campaign$$ %
.$$% &
Assets$$& ,
.$$, -
SFDClientId$$- 8
,$$8 9
	Client_ID%% 
=%% 

SfidLookup%%  *
.%%* +
GetCampaignName%%+ :
(%%: ;
campaign%%; C
.%%C D
Assets%%D J
.%%J K
SFDClientId%%K V
)%%V W
,%%W X
Campaign_Name&& !
=&&" #
campaign&&$ ,
.&&, -
Approved&&- 5
.&&5 6
CampaignName&&6 B
,&&B C
	From_Line'' 
='' 
campaign''  (
.''( )
Approved'') 1
.''1 2
FromLine''2 :
,'': ;
Subject_Line((  
=((! "
campaign((# +
.((+ ,
Approved((, 4
.((4 5
SubjectLine((5 @
,((@ A
Deployment_Date)) #
=))$ %
campaign))& .
.)). /
Approved))/ 7
.))7 8

DeployDate))8 B
?))B C
.))C D
ToString))D L
())L M
StringConstants))M \
.))\ ]
DateFormatSlashes))] n
)))n o
,))o p
URLS++ 
=++ 
proData++ "
.++" #
Destination_URL++# 2
,++2 3
Total_Clicks,,  
=,,! "
proData,,# *
.,,* +

ClickCount,,+ 5
,,,5 6
Unique_Clicks-- !
=--" #
proData--$ +
.--+ ,
	UniqueCnt--, 5
,--5 6
Mobile_Clicks.. !
=.." #
proData..$ +
...+ ,
	MobileCnt.., 5
,..5 6
ID// 
=// 
index// 
++//  
}00 
;00 
urls22 
.22 
Add22 
(22 
model22 
)22 
;22  
}33 
return44 
urls44 
.44 
ToArray44 
(44  
)44  !
;44! "
}55 	
}66 
}77 ∂.
\D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DataReports\CampaignTrackingMetricVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DataReports' 2
{		 
public

 

class

 $
CampaignTrackingMetricVm

 )
{ 
public 
int 
SFD_ID 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
	Client_ID 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Campaign_Name #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
	From_Line 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Subject_Line "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Deployment_Date %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
long 
	Delivered 
{ 
get  #
;# $
set% (
;( )
}* +
public 
double 
	Open_Rate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
long 
Total_Opens 
{  !
get" %
;% &
set' *
;* +
}, -
public 
long 
Total_Clicks  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
double 
Click_Percentage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
double 
HTML_CTR 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
long 
Desktop 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Mobile 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
	Image_URL 
{  !
get" %
;% &
set' *
;* +
}, -
public 
static $
CampaignTrackingMetricVm .
[. /
]/ 0 
FromCampaignTracking1 E
(E F
CampaignF N
campaignO W
,W X
CampaignTrackingY i
campaignTrackingj z
)z {
{ 	
string 
filePathLive 
=  !
$"" $
{$ %
S3FileManager% 2
.2 3
ServerPrefix3 ?
}? @
{@ A
campaignA I
.I J
AssetsJ P
.P Q
OpenModelImageFileQ c
}c d
"d e
;e f
var   
metrics   
=   
new   $
CampaignTrackingMetricVm   6
[  6 7
$num  7 8
]  8 9
{!! 
new"" $
CampaignTrackingMetricVm"" ,
{## 
SFD_ID$$ 
=$$ 
campaign$$ %
.$$% &
Assets$$& ,
.$$, -
SFDClientId$$- 8
,$$8 9
	Client_ID%% 
=%% 

SfidLookup%%  *
.%%* +
GetCampaignName%%+ :
(%%: ;
campaign%%; C
.%%C D
Assets%%D J
.%%J K
SFDClientId%%K V
)%%V W
,%%W X
Campaign_Name&& !
=&&" #
campaign&&$ ,
.&&, -
Approved&&- 5
.&&5 6
CampaignName&&6 B
,&&B C
	From_Line'' 
='' 
campaign''  (
.''( )
Approved'') 1
.''1 2
FromLine''2 :
,'': ;
Subject_Line((  
=((! "
campaign((# +
.((+ ,
Approved((, 4
.((4 5
SubjectLine((5 @
,((@ A
Deployment_Date)) #
=))$ %
campaign))& .
.)). /
Approved))/ 7
.))7 8

DeployDate))8 B
?))B C
.))C D
ToString))D L
())L M
StringConstants))M \
.))\ ]
DateFormatSlashes))] n
)))n o
,))o p
	Delivered** 
=** 
campaignTracking**  0
.**0 1
Quantity**1 9
,**9 :
	Open_Rate++ 
=++ 
campaignTracking++  0
.++0 1
OpenedPercentage++1 A
,++A B
Total_Opens,, 
=,,  !
campaignTracking,," 2
.,,2 3
Opened,,3 9
,,,9 :
Total_Clicks--  
=--! "
campaignTracking--# 3
.--3 4
Clicked--4 ;
,--; <
Click_Percentage.. $
=..% &
campaignTracking..' 7
...7 8
ClickedPercentage..8 I
,..I J
HTML_CTR// 
=// 
campaignTracking// /
./// 0!
ClickToOpenPercentage//0 E
,//E F
Mobile00 
=00 
campaignTracking00 -
.00- .
Mobile00. 4
,004 5
Desktop11 
=11 
campaignTracking11 .
.11. /
Desktop11/ 6
,116 7
	Image_URL22 
=22 
filePathLive22  ,
}33 
}44 
;44 
return55 
metrics55 
;55 
}66 	
}77 
}88 ∑$
ZD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\BaseTrackingReport.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
public 

class 
BaseTrackingReport #
:$ %
ITrackingReport& 5
{ 
	protected		 
string		 
CustomerName		 %
{		& '
get		( +
;		+ ,
set		- 0
;		0 1
}		2 3
	protected

 
string

 

ImagesPath

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
	protected 
string 
Template !
{" #
get$ '
;' (
set) ,
;, -
}. /
	protected 
string 
TemplateFile %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
	protected 
int 
	LogoWidth 
{  !
get" %
;% &
set' *
;* +
}, -
	protected 
int 

LogoHeight  
{! "
get# &
;& '
set( +
;+ ,
}- .
	protected 
string 
LogoFilePath %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
	protected 
string 
LogoResized $
{% &
get' *
;* +
set, /
;/ 0
}1 2
	protected 
string 
ScreenshotFilePath +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
BaseTrackingReport !
(! "
string" (
reportTemplate) 7
,7 8
string9 ?
customerName@ L
,L M
stringN T
companyLogoU `
,` a
stringb h
screenshotFilePathi {
){ |
{ 	
Template 
= 
reportTemplate %
;% &
TemplateFile 
= 
HttpContext &
.& '
Current' .
.. /
Server/ 5
.5 6
MapPath6 =
(= >
$"> @
~/Templates/@ L
{L M
reportTemplateM [
}[ \
.xlsx\ a
"a b
)b c
;c d
CustomerName 
= 
customerName '
;' (

ImagesPath 
= 
HttpContext $
.$ %
Current% ,
., -
Server- 3
.3 4
MapPath4 ;
(; <
$"< >
~/images> F
"F G
)G H
;H I
LogoFilePath 
= 
string !
.! "
IsNullOrEmpty" /
(/ 0
CustomerName0 <
)< =
||> @
stringA G
.G H
IsNullOrEmptyH U
(U V
companyLogoV a
)a b
? 
$" 
{ 

ImagesPath '
}' (
\\logo1.png( 3
"3 4
:5 6
$"7 9
{9 :

ImagesPath: D
}D E
\\E G
{G H
companyLogoH S
}S T
"T U
;U V
LogoResized 
= 
$" 
{ 

ImagesPath '
}' (
\\logoResized.png( 9
"9 :
;: ;
ScreenshotFilePath 
=  
screenshotFilePath! 3
;3 4
} 	
public 
virtual 
void 
Generate $
($ %
TemplateReportVm% 5
model6 ;
,; <
string= C
outputFilePathD R
)R S
{   	
throw!! 
new!! #
NotImplementedException!! -
(!!- .
)!!. /
;!!/ 0
}"" 	
public$$ 
virtual$$ 
void$$ 
PopulateRowTemplate$$ /
($$/ 0
	Worksheet$$0 9
	worksheet$$: C
,$$C D"
TemplateReportDetailVm$$E [
row$$\ _
,$$_ `
uint$$a e
	rowNumber$$f o
)$$o p
{%% 	
throw&& 
new&& #
NotImplementedException&& -
(&&- .
)&&. /
;&&/ 0
}'' 	
}(( 
})) Æ
LD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Db\CampaignSegmentVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Db' )
{ 
public 

class 
CampaignSegmentVm "
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
string		 
OrderNumber		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public 
string 
SegmentNumber #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DateTime 
? 
DeploymentDate '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
Quantity 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CreativeFiles #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
FirstRangeStart "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
FirstRangeEnd  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
SecondRangeStart #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
SecondRangeEnd !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
ThirdRangeStart "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
ThirdRangeEnd  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
SegmentDataFileUrl (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DateTime 
? 
DateFetched $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
UploadStatus 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
SegmentStatus  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
DateApproved %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
? 
DateComplete %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
}!! 
}"" ì	
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Db\CampaignTrackingDetailVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Db' )
{ 
public 

class $
CampaignTrackingDetailVm )
:* +
CampaignTrackingVm, >
{ 
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Link 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 

ClickCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
UniqueCount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
MobileCount		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
} 
} æã
MD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Db\CampaignTrackingVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Db' )
{ 
public		 

class		 
CampaignTrackingVm		 #
{

 
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 

TrackingId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Quantity 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	OrderDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
DateSent 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	SentOrder 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 
IsCreatedThroughApi '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
QueuedCampaignId &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	StartDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Deployed 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Opened 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Clicked 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Unsub 
{ 
get !
;! "
set# &
;& '
}( )
public   
string   
Forwards   
{    
get  ! $
;  $ %
set  & )
;  ) *
}  + ,
public!! 
string!! 
DeliveryPercentage!! (
{!!) *
get!!+ .
;!!. /
set!!0 3
;!!3 4
}!!5 6
public"" 
string"" 
OpenedPercentage"" &
{""' (
get"") ,
;"", -
set"". 1
;""1 2
}""3 4
public## 
string## 
ClickedPercentage## '
{##( )
get##* -
;##- .
set##/ 2
;##2 3
}##4 5
public$$ 
string$$ 
UnsubPercentage$$ %
{$$& '
get$$( +
;$$+ ,
set$$- 0
;$$0 1
}$$2 3
public%% 
string%% !
ClickToOpenPercentage%% +
{%%, -
get%%. 1
;%%1 2
set%%3 6
;%%6 7
}%%8 9
public&& 
string&& !
UnsubToOpenPercentage&& +
{&&, -
get&&. 1
;&&1 2
set&&3 6
;&&6 7
}&&8 9
public'' 
string'' 
Bounce'' 
{'' 
get'' "
;''" #
set''$ '
;''' (
}'') *
public(( 
string(( 
Opt(( 
{(( 
get(( 
;((  
set((! $
;(($ %
}((& '
public)) 
string)) 
Desktop)) 
{)) 
get))  #
;))# $
set))% (
;))( )
}))* +
public** 
string** 
Mobile** 
{** 
get** "
;**" #
set**$ '
;**' (
}**) *
public++ 
string++ "
RetargetingImpressions++ ,
{++- .
get++/ 2
;++2 3
set++4 7
;++7 8
}++9 :
public,, 
string,, 
RetargetingClicks,, '
{,,( )
get,,* -
;,,- .
set,,/ 2
;,,2 3
},,4 5
public.. 
List.. 
<.. $
CampaignTrackingDetailVm.. ,
>.., -
PerLink... 5
{..6 7
get..8 ;
;..; <
set..= @
;..@ A
}..B C
public// 
List// 
<// 
CampaignSegmentVm// %
>//% &
Segments//' /
{//0 1
get//2 5
;//5 6
set//7 :
;//: ;
}//< =
public11 
static11 
CampaignTrackingVm11 ( 
FromCampaignTracking11) =
(11= >
Campaign11> F
campaign11G O
,11O P
CampaignTracking11Q a
campaignTracking11b r
)11r s
{22 	
var33 
model33 
=33 
new33 
CampaignTrackingVm33 .
{44 

CampaignId55 
=55 
campaign55 %
.55% &
Id55& (
.55( )
ToString55) 1
(551 2
)552 3
,553 4

TrackingId66 
=66 
campaignTracking66 -
.66- .
Id66. 0
.660 1
ToString661 9
(669 :
)66: ;
,66; <
OrderNumber77 
=77 
string77 $
.77$ %
IsNullOrEmpty77% 2
(772 3
campaignTracking773 C
.77C D
SegmentNumber77D Q
)77Q R
?77S T
campaignTracking77U e
.77e f
OrderNumber77f q
:77r s
campaignTracking	77t Ñ
.
77Ñ Ö
SegmentNumber
77Ö í
,
77í ì
CampaignName88 
=88 
campaign88 '
.88' (
Approved88( 0
.880 1
CampaignName881 =
,88= >

WhiteLabel99 
=99 
campaign99 %
.99% &
Approved99& .
.99. /

WhiteLabel99/ 9
,999 :
SubjectLine:: 
=:: 
campaign:: &
.::& '
Approved::' /
.::/ 0
SubjectLine::0 ;
,::; <
FromLine;; 
=;; 
campaign;; #
.;;# $
Approved;;$ ,
.;;, -
FromLine;;- 5
,;;5 6
Quantity<< 
=<< 
string<< !
.<<! "
Format<<" (
(<<( )
$str<<) 1
,<<1 2
campaignTracking<<3 C
.<<C D
Quantity<<D L
)<<L M
,<<M N
Status== 
=== 
(== 
(== 
CampaignStatus== )
)==) *
campaign==* 2
.==2 3
Status==3 9
)==9 :
.==: ;
ToString==; C
(==C D
)==D E
,==E F
	OrderDate>> 
=>> 
campaign>> $
.>>$ %
	CreatedAt>>% .
.>>. /
ToString>>/ 7
(>>7 8
StringConstants>>8 G
.>>G H
DateFormatSlashes>>H Y
)>>Y Z
,>>Z [
DateSent?? 
=?? 
campaignTracking?? +
.??+ ,
	CreatedAt??, 5
.??5 6
ToString??6 >
(??> ?
StringConstants??? N
.??N O
DateFormatSlashes??O `
)??` a
,??a b
	SentOrder@@ 
=@@ 
campaignTracking@@ ,
.@@, -
	SentOrder@@- 6
,@@6 7
IsCreatedThroughApiAA #
=AA$ %
campaignTrackingAA& 6
.AA6 7
IsCreatedThroughApiAA7 J
,AAJ K
QueuedCampaignIdBB  
=BB! "
campaignTrackingBB# 3
.BB3 4
QueuedCampaignIdBB4 D
,BBD E
IoNumberDD 
=DD 
campaignTrackingDD +
.DD+ ,
IoNumberDD, 4
,DD4 5
	StartDateEE 
=EE 
campaignTrackingEE ,
.EE, -
	StartDateEE- 6
?EE6 7
.EE7 8
ToStringEE8 @
(EE@ A
StringConstantsEEA P
.EEP Q
DateFormatSlashesEEQ b
)EEb c
,EEc d
DeployedFF 
=FF 
campaignTrackingFF +
.FF+ ,
DeployedFF, 4
==FF5 7
$numFF8 9
?FF: ;
$strFF< @
:FFA B
stringFFC I
.FFI J
FormatFFJ P
(FFP Q
$strFFQ Y
,FFY Z
campaignTrackingFF[ k
.FFk l
DeployedFFl t
)FFt u
,FFu v
OpenedGG 
=GG 
campaignTrackingGG )
.GG) *
OpenedGG* 0
==GG1 3
$numGG4 5
?GG6 7
$strGG8 <
:GG= >
stringGG? E
.GGE F
FormatGGF L
(GGL M
$strGGM U
,GGU V
campaignTrackingGGW g
.GGg h
OpenedGGh n
)GGn o
,GGo p
ClickedHH 
=HH 
campaignTrackingHH *
.HH* +
ClickedHH+ 2
==HH3 5
$numHH6 7
?HH8 9
$strHH: >
:HH? @
stringHHA G
.HHG H
FormatHHH N
(HHN O
$strHHO W
,HHW X
campaignTrackingHHY i
.HHi j
ClickedHHj q
)HHq r
,HHr s
UnsubII 
=II 
campaignTrackingII (
.II( )
UnsubII) .
==II/ 1
$numII2 3
?II4 5
$strII6 :
:II; <
stringII= C
.IIC D
FormatIID J
(IIJ K
$strIIK S
,IIS T
campaignTrackingIIU e
.IIe f
UnsubIIf k
)IIk l
,IIl m
ForwardsJJ 
=JJ 
campaignTrackingJJ +
.JJ+ ,
ForwardsJJ, 4
==JJ5 7
$numJJ8 9
?JJ: ;
$strJJ< @
:JJA B
stringJJC I
.JJI J
FormatJJJ P
(JJP Q
$strJJQ Y
,JJY Z
campaignTrackingJJ[ k
.JJk l
ForwardsJJl t
)JJt u
,JJu v
BounceKK 
=KK 
stringKK 
.KK  
FormatKK  &
(KK& '
$strKK' /
,KK/ 0
campaignTrackingKK1 A
.KKA B
BounceKKB H
)KKH I
,KKI J
OptLL 
=LL 
stringLL 
.LL 
FormatLL #
(LL# $
$strLL$ ,
,LL, -
campaignTrackingLL. >
.LL> ?
OptLL? B
)LLB C
,LLC D
DesktopMM 
=MM 
stringMM  
.MM  !
FormatMM! '
(MM' (
$strMM( 0
,MM0 1
campaignTrackingMM2 B
.MMB C
DesktopMMC J
)MMJ K
,MMK L
MobileNN 
=NN 
stringNN 
.NN  
FormatNN  &
(NN& '
$strNN' /
,NN/ 0
campaignTrackingNN1 A
.NNA B
MobileNNB H
)NNH I
,NNI J"
RetargetingImpressionsOO &
=OO' (
stringOO) /
.OO/ 0
FormatOO0 6
(OO6 7
$strOO7 ?
,OO? @
campaignTrackingOOA Q
.OOQ R"
RetargetingImpressionsOOR h
)OOh i
,OOi j
RetargetingClicksPP !
=PP" #
stringPP$ *
.PP* +
FormatPP+ 1
(PP1 2
$strPP2 :
,PP: ;
campaignTrackingPP< L
.PPL M
RetargetingClicksPPM ^
)PP^ _
,PP_ `
DeliveryPercentageRR "
=RR# $
campaignTrackingRR% 5
.RR5 6
DeliveryPercentageRR6 H
.RRH I
ToStringRRI Q
(RRQ R
$strRRR Y
)RRY Z
,RRZ [
OpenedPercentageSS  
=SS! "
campaignTrackingSS# 3
.SS3 4
OpenedPercentageSS4 D
.SSD E
ToStringSSE M
(SSM N
$strSSN U
)SSU V
,SSV W
ClickedPercentageTT !
=TT" #
campaignTrackingTT$ 4
.TT4 5
ClickedPercentageTT5 F
.TTF G
ToStringTTG O
(TTO P
$strTTP W
)TTW X
,TTX Y
UnsubPercentageUU 
=UU  !
campaignTrackingUU" 2
.UU2 3
UnsubPercentageUU3 B
.UUB C
ToStringUUC K
(UUK L
$strUUL S
)UUS T
,UUT U!
ClickToOpenPercentageVV %
=VV& '
campaignTrackingVV( 8
.VV8 9!
ClickToOpenPercentageVV9 N
.VVN O
ToStringVVO W
(VVW X
$strVVX _
)VV_ `
,VV` a!
UnsubToOpenPercentageWW %
=WW& '
campaignTrackingWW( 8
.WW8 9!
UnsubToOpenPercentageWW9 N
.WWN O
ToStringWWO W
(WWW X
$strWWX _
)WW_ `
,WW` a
SegmentsXX 
=XX 
newXX 
ListXX #
<XX# $
CampaignSegmentVmXX$ 5
>XX5 6
(XX6 7
)XX7 8
,XX8 9
PerLinkYY 
=YY 
newYY 
ListYY "
<YY" #$
CampaignTrackingDetailVmYY# ;
>YY; <
(YY< =
)YY= >
}ZZ 
;ZZ 
model\\ 
.\\ 
Segments\\ 
=\\ 
campaign\\ %
.\\% &
Segments\\& .
.\\. /
Where\\/ 4
(\\4 5
x\\5 6
=>\\7 9
!\\: ;
string\\; A
.\\A B
IsNullOrEmpty\\B O
(\\O P
x\\P Q
.\\Q R
SegmentDataFileUrl\\R d
)\\d e
)\\e f
.]] 
Select]] #
(]]# $
x]]$ %
=>]]& (
new]]) ,
CampaignSegmentVm]]- >
(]]> ?
)]]? @
{^^ 
SegmentNumber__  -
=__. /
x__0 1
.__1 2
SegmentNumber__2 ?
,__? @
SegmentDataFileUrl``  2
=``3 4
x``5 6
.``6 7
SegmentDataFileUrl``7 I
}aa 
)aa 
.aa 
OrderByaa &
(aa& '
xaa' (
=>aa) +
xaa, -
.aa- .
SegmentNumberaa. ;
)aa; <
.aa< =
ToListaa= C
(aaC D
)aaD E
;aaE F
varbb 
proDatasbb 
=bb 
campaignbb #
.bb# $
ProDatasbb$ ,
.cc 
Wherecc 
(cc 
xcc 
=>cc 
xcc 
.cc 
OrderNumbercc )
==cc* ,
campaignTrackingcc- =
.cc= >
OrderNumbercc> I
&&ccJ L
xccM N
.ccN O
SegmentNumberccO \
==cc] _
campaignTrackingcc` p
.ccp q
SegmentNumberccq ~
)cc~ 
.dd 
OrderByDescendingdd "
(dd" #
xdd# $
=>dd% '
xdd( )
.dd) *

ClickCountdd* 4
)dd4 5
;dd5 6
foreachff 
(ff 
varff 
proDataff  
inff! #
proDatasff$ ,
)ff, -
{gg 
modelhh 
.hh 
PerLinkhh 
.hh 
Addhh !
(hh! "
newhh" %$
CampaignTrackingDetailVmhh& >
{ii 
IoNumberjj 
=jj 
proDatajj &
.jj& '
IOjj' )
,jj) *
OrderNumberkk 
=kk  !
proDatakk" )
.kk) *
Reportsite_URLkk* 8
,kk8 9
Linkll 
=ll 
proDatall "
.ll" #
Destination_URLll# 2
,ll2 3

ClickCountmm 
=mm  
stringmm! '
.mm' (
Formatmm( .
(mm. /
$strmm/ 7
,mm7 8
proDatamm9 @
.mm@ A

ClickCountmmA K
)mmK L
,mmL M
UniqueCountnn 
=nn  !
stringnn" (
.nn( )
Formatnn) /
(nn/ 0
$strnn0 8
,nn8 9
proDatann: A
.nnA B
	UniqueCntnnB K
)nnK L
,nnL M
MobileCountoo 
=oo  !
stringoo" (
.oo( )
Formatoo) /
(oo/ 0
$stroo0 8
,oo8 9
proDataoo: A
.ooA B
	MobileCntooB K
)ooK L
}pp 
)pp 
;pp 
}qq 
returnrr 
modelrr 
;rr 
}ss 	
}tt 
}uu õ
WD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\ITrackingReport.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
	interface 
ITrackingReport 
{ 
void 
Generate 
( 
TemplateReportVm &
model' ,
,, -
string. 4
outputFilePath5 C
)C D
;D E
void 
PopulateRowTemplate  
(  !
	Worksheet! *
	worksheet+ 4
,4 5"
TemplateReportDetailVm6 L
rowM P
,P Q
uintR V
	rowNumberW `
)` a
;a b
}		 
}

 û˙
`D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\TrackingReportTemplate12.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
public 

class $
TrackingReportTemplate12 )
:* +
BaseTrackingReport, >
,> ?
ITrackingReport@ O
{ 
public $
TrackingReportTemplate12 '
(' (
string( .
reportTemplate/ =
,= >
string? E
customerNameF R
,R S
stringT Z
companyLogo[ f
,f g
stringh n
screenshotFilePath	o Å
)
Å Ç
: 
base 
( 
reportTemplate !
,! "
customerName# /
,/ 0
companyLogo1 <
,< =
screenshotFilePath> P
)P Q
{ 	
	LogoWidth 
= 
$num 
; 

LogoHeight 
= 
$num 
; 
} 	
public 
override 
void 
Generate %
(% &
TemplateReportVm& 6
model7 <
,< =
string> D
outputFilePathE S
)S T
{ 	
ImageResizer 
. 
Resize 
(  
LogoFilePath  ,
,, -
LogoResized. 9
,9 :
	LogoWidth; D
,D E

LogoHeightF P
,P Q
trueR V
)V W
;W X
File 
. 
Copy 
( 
TemplateFile "
," #
outputFilePath$ 2
,2 3
true4 8
)8 9
;9 :
byte 
[ 
] 
	byteArray 
= 
File #
.# $
ReadAllBytes$ 0
(0 1
outputFilePath1 ?
)? @
;@ A
using 
( 
MemoryStream 
stream  &
=' (
new) ,
MemoryStream- 9
(9 :
): ;
); <
{ 
stream   
.   
Write   
(   
	byteArray   &
,  & '
$num  ( )
,  ) *
	byteArray  + 4
.  4 5
Length  5 ;
)  ; <
;  < =
using!! 
(!! 
SpreadsheetDocument!! *
spreadSheet!!+ 6
=!!7 8
SpreadsheetDocument!!9 L
.!!L M
Open!!M Q
(!!Q R
stream!!R X
,!!X Y
true!!Z ^
)!!^ _
)!!_ `
{"" 
spreadSheet## 
.##  
WorkbookPart##  ,
.##, -
Workbook##- 5
.##5 6!
CalculationProperties##6 K
.##K L 
ForceFullCalculation##L `
=##a b
true##c g
;##g h
spreadSheet$$ 
.$$  
WorkbookPart$$  ,
.$$, -
Workbook$$- 5
.$$5 6!
CalculationProperties$$6 K
.$$K L!
FullCalculationOnLoad$$L a
=$$b c
true$$d h
;$$h i
IEnumerable'' 
<''  
Sheet''  %
>''% &
sheets''' -
=''. /
spreadSheet''0 ;
.''; <
WorkbookPart''< H
.''H I
Workbook''I Q
.(( 
GetFirstChild(( &
<((& '
Sheets((' -
>((- .
(((. /
)((/ 0
.((0 1
Elements((1 9
<((9 :
Sheet((: ?
>((? @
(((@ A
)((A B
.)) 
Where)) 
()) 
s))  
=>))! #
s))$ %
.))% &
Name))& *
==))+ -
$str)). >
)))> ?
.** 
ToArray**  
(**  !
)**! "
;**" #
if,, 
(,, 
!,, 
sheets,, 
.,,  
Any,,  #
(,,# $
),,$ %
),,% &
{-- 
throw.. 
new.. !
AdsException.." .
(... /
$str../ :
)..: ;
;..; <
}// 
string11 
relationshipId11 )
=11* +
sheets11, 2
.112 3
First113 8
(118 9
)119 :
.11: ;
Id11; =
.11= >
Value11> C
;11C D
WorksheetPart22 !
worksheetPart22" /
=220 1
(222 3
WorksheetPart223 @
)22@ A
spreadSheet22A L
.22L M
WorkbookPart22M Y
.22Y Z
GetPartById22Z e
(22e f
relationshipId22f t
)22t u
;22u v
ExcelHelper66 
.66  
AddImage66  (
(66( )
worksheetPart66) 6
,666 7
LogoResized668 C
,66C D
$num66E F
,66F G
$num66H I
)66I J
;66J K
ExcelHelper77 
.77  
AddImage77  (
(77( )
worksheetPart77) 6
,776 7
LogoResized778 C
,77C D
$num77E G
,77G H
$num77I J
)77J K
;77K L
Cell99 
cell99 
=99 
ExcelHelper99  +
.99+ ,
GetCell99, 3
(993 4
worksheetPart994 A
.99A B
	Worksheet99B K
,99K L
$str99M P
,99P Q
$num99R S
)99S T
;99T U
cell:: 
.:: 
	CellValue:: "
=::# $
new::% (
	CellValue::) 2
(::2 3
model::3 8
.::8 9
OrderNumber::9 D
)::D E
;::E F
cell;; 
.;; 
DataType;; !
=;;" #
new;;$ '
	EnumValue;;( 1
<;;1 2

CellValues;;2 <
>;;< =
(;;= >

CellValues;;> H
.;;H I
String;;I O
);;O P
;;;P Q
cell== 
=== 
ExcelHelper== &
.==& '
GetCell==' .
(==. /
worksheetPart==/ <
.==< =
	Worksheet=== F
,==F G
$str==H K
,==K L
$num==M N
)==N O
;==O P
cell>> 
.>> 
	CellValue>> "
=>># $
new>>% (
	CellValue>>) 2
(>>2 3
model>>3 8
.>>8 9
	StartDate>>9 B
)>>B C
;>>C D
cell?? 
.?? 
DataType?? !
=??" #
new??$ '
	EnumValue??( 1
<??1 2

CellValues??2 <
>??< =
(??= >

CellValues??> H
.??H I
String??I O
)??O P
;??P Q
cellAA 
=AA 
ExcelHelperAA &
.AA& '
GetCellAA' .
(AA. /
worksheetPartAA/ <
.AA< =
	WorksheetAA= F
,AAF G
$strAAH K
,AAK L
$numAAM O
)AAO P
;AAP Q
cellBB 
.BB 
	CellValueBB "
=BB# $
newBB% (
	CellValueBB) 2
(BB2 3
DateTimeBB3 ;
.BB; <
NowBB< ?
.BB? @
ToStringBB@ H
(BBH I
StringConstantsBBI X
.BBX Y
DateFormatSlashesBBY j
)BBj k
)BBk l
;BBl m
cellCC 
.CC 
DataTypeCC !
=CC" #
newCC$ '
	EnumValueCC( 1
<CC1 2

CellValuesCC2 <
>CC< =
(CC= >

CellValuesCC> H
.CCH I
StringCCI O
)CCO P
;CCP Q
cellEE 
=EE 
ExcelHelperEE &
.EE& '
GetCellEE' .
(EE. /
worksheetPartEE/ <
.EE< =
	WorksheetEE= F
,EEF G
$strEEH K
,EEK L
$numEEM N
)EEN O
;EEO P
cellFF 
.FF 
	CellValueFF "
=FF# $
newFF% (
	CellValueFF) 2
(FF2 3
modelFF3 8
.FF8 9
CampaignNameFF9 E
)FFE F
;FFF G
cellGG 
.GG 
DataTypeGG !
=GG" #
newGG$ '
	EnumValueGG( 1
<GG1 2

CellValuesGG2 <
>GG< =
(GG= >

CellValuesGG> H
.GGH I
StringGGI O
)GGO P
;GGP Q
cellNN 
=NN 
ExcelHelperNN &
.NN& '
GetCellNN' .
(NN. /
worksheetPartNN/ <
.NN< =
	WorksheetNN= F
,NNF G
$strNNH K
,NNK L
$numNNM O
)NNO P
;NNP Q
cellOO 
.OO 
	CellValueOO "
=OO# $
newOO% (
	CellValueOO) 2
(OO2 3
modelOO3 8
.OO8 9
QuantityOO9 A
)OOA B
;OOB C
cellPP 
.PP 
DataTypePP !
=PP" #
newPP$ '
	EnumValuePP( 1
<PP1 2

CellValuesPP2 <
>PP< =
(PP= >

CellValuesPP> H
.PPH I
NumberPPI O
)PPO P
;PPP Q
cellWW 
=WW 
ExcelHelperWW &
.WW& '
GetCellWW' .
(WW. /
worksheetPartWW/ <
.WW< =
	WorksheetWW= F
,WWF G
$strWWH K
,WWK L
$numWWM O
)WWO P
;WWP Q
cellXX 
.XX 
	CellValueXX "
=XX# $
newXX% (
	CellValueXX) 2
(XX2 3
modelXX3 8
.XX8 9
OpenedPercentageXX9 I
)XXI J
;XXJ K
cellYY 
.YY 
DataTypeYY !
=YY" #
newYY$ '
	EnumValueYY( 1
<YY1 2

CellValuesYY2 <
>YY< =
(YY= >

CellValuesYY> H
.YYH I
NumberYYI O
)YYO P
;YYP Q
cell[[ 
=[[ 
ExcelHelper[[ &
.[[& '
GetCell[[' .
([[. /
worksheetPart[[/ <
.[[< =
	Worksheet[[= F
,[[F G
$str[[H K
,[[K L
$num[[M O
)[[O P
;[[P Q
cell\\ 
.\\ 
	CellValue\\ "
=\\# $
new\\% (
	CellValue\\) 2
(\\2 3
model\\3 8
.\\8 9
Opened\\9 ?
)\\? @
;\\@ A
cell]] 
.]] 
DataType]] !
=]]" #
new]]$ '
	EnumValue]]( 1
<]]1 2

CellValues]]2 <
>]]< =
(]]= >

CellValues]]> H
.]]H I
Number]]I O
)]]O P
;]]P Q
cell`` 
=`` 
ExcelHelper`` &
.``& '
GetCell``' .
(``. /
worksheetPart``/ <
.``< =
	Worksheet``= F
,``F G
$str``H K
,``K L
$num``M O
)``O P
;``P Q
cellaa 
.aa 
	CellValueaa "
=aa# $
newaa% (
	CellValueaa) 2
(aa2 3
modelaa3 8
.aa8 9
Clickedaa9 @
)aa@ A
;aaA B
cellbb 
.bb 
DataTypebb !
=bb" #
newbb$ '
	EnumValuebb( 1
<bb1 2

CellValuesbb2 <
>bb< =
(bb= >

CellValuesbb> H
.bbH I
NumberbbI O
)bbO P
;bbP Q
celldd 
=dd 
ExcelHelperdd &
.dd& '
GetCelldd' .
(dd. /
worksheetPartdd/ <
.dd< =
	Worksheetdd= F
,ddF G
$strddH K
,ddK L
$numddM O
)ddO P
;ddP Q
cellee 
.ee 
	CellValueee "
=ee# $
newee% (
	CellValueee) 2
(ee2 3
modelee3 8
.ee8 9
ClickedPercentageee9 J
)eeJ K
;eeK L
cellff 
.ff 
DataTypeff !
=ff" #
newff$ '
	EnumValueff( 1
<ff1 2

CellValuesff2 <
>ff< =
(ff= >

CellValuesff> H
.ffH I
NumberffI O
)ffO P
;ffP Q
cellhh 
=hh 
ExcelHelperhh &
.hh& '
GetCellhh' .
(hh. /
worksheetParthh/ <
.hh< =
	Worksheethh= F
,hhF G
$strhhH K
,hhK L
$numhhM O
)hhO P
;hhP Q
cellii 
.ii 
	CellValueii "
=ii# $
newii% (
	CellValueii) 2
(ii2 3
modelii3 8
.ii8 9!
ClickToOpenPercentageii9 N
)iiN O
;iiO P
celljj 
.jj 
DataTypejj !
=jj" #
newjj$ '
	EnumValuejj( 1
<jj1 2

CellValuesjj2 <
>jj< =
(jj= >

CellValuesjj> H
.jjH I
NumberjjI O
)jjO P
;jjP Q
cellmm 
=mm 
ExcelHelpermm &
.mm& '
GetCellmm' .
(mm. /
worksheetPartmm/ <
.mm< =
	Worksheetmm= F
,mmF G
$strmmH K
,mmK L
$nummmM O
)mmO P
;mmP Q
cellnn 
.nn 
	CellValuenn "
=nn# $
newnn% (
	CellValuenn) 2
(nn2 3
modelnn3 8
.nn8 9
Bouncenn9 ?
)nn? @
;nn@ A
celloo 
.oo 
DataTypeoo !
=oo" #
newoo$ '
	EnumValueoo( 1
<oo1 2

CellValuesoo2 <
>oo< =
(oo= >

CellValuesoo> H
.ooH I
NumberooI O
)ooO P
;ooP Q
cellqq 
=qq 
ExcelHelperqq &
.qq& '
GetCellqq' .
(qq. /
worksheetPartqq/ <
.qq< =
	Worksheetqq= F
,qqF G
$strqqH K
,qqK L
$numqqM O
)qqO P
;qqP Q
cellrr 
.rr 
	CellValuerr "
=rr# $
newrr% (
	CellValuerr) 2
(rr2 3
modelrr3 8
.rr8 9
Optrr9 <
)rr< =
;rr= >
cellss 
.ss 
DataTypess !
=ss" #
newss$ '
	EnumValuess( 1
<ss1 2

CellValuesss2 <
>ss< =
(ss= >

CellValuesss> H
.ssH I
NumberssI O
)ssO P
;ssP Q
cellvv 
=vv 
ExcelHelpervv &
.vv& '
GetCellvv' .
(vv. /
worksheetPartvv/ <
.vv< =
	Worksheetvv= F
,vvF G
$strvvH K
,vvK L
$numvvM O
)vvO P
;vvP Q
cellww 
.ww 
	CellValueww "
=ww# $
newww% (
	CellValueww) 2
(ww2 3
modelww3 8
.ww8 9
Desktopww9 @
)ww@ A
;wwA B
cellxx 
.xx 
DataTypexx !
=xx" #
newxx$ '
	EnumValuexx( 1
<xx1 2

CellValuesxx2 <
>xx< =
(xx= >

CellValuesxx> H
.xxH I
NumberxxI O
)xxO P
;xxP Q
cellzz 
=zz 
ExcelHelperzz &
.zz& '
GetCellzz' .
(zz. /
worksheetPartzz/ <
.zz< =
	Worksheetzz= F
,zzF G
$strzzH K
,zzK L
$numzzM O
)zzO P
;zzP Q
cell{{ 
.{{ 
	CellValue{{ "
={{# $
new{{% (
	CellValue{{) 2
({{2 3
model{{3 8
.{{8 9
Mobile{{9 ?
){{? @
;{{@ A
cell|| 
.|| 
DataType|| !
=||" #
new||$ '
	EnumValue||( 1
<||1 2

CellValues||2 <
>||< =
(||= >

CellValues||> H
.||H I
Number||I O
)||O P
;||P Q
cell 
= 
ExcelHelper &
.& '
GetCell' .
(. /
worksheetPart/ <
.< =
	Worksheet= F
,F G
$strH K
,K L
$numM O
)O P
;P Q
cell
ÄÄ 
.
ÄÄ 
	CellValue
ÄÄ "
=
ÄÄ# $
new
ÄÄ% (
	CellValue
ÄÄ) 2
(
ÄÄ2 3
model
ÄÄ3 8
.
ÄÄ8 9
SubjectLine
ÄÄ9 D
)
ÄÄD E
;
ÄÄE F
cell
ÅÅ 
.
ÅÅ 
DataType
ÅÅ !
=
ÅÅ" #
new
ÅÅ$ '
	EnumValue
ÅÅ( 1
<
ÅÅ1 2

CellValues
ÅÅ2 <
>
ÅÅ< =
(
ÅÅ= >

CellValues
ÅÅ> H
.
ÅÅH I
String
ÅÅI O
)
ÅÅO P
;
ÅÅP Q
cell
ÉÉ 
=
ÉÉ 
ExcelHelper
ÉÉ &
.
ÉÉ& '
GetCell
ÉÉ' .
(
ÉÉ. /
worksheetPart
ÉÉ/ <
.
ÉÉ< =
	Worksheet
ÉÉ= F
,
ÉÉF G
$str
ÉÉH K
,
ÉÉK L
$num
ÉÉM O
)
ÉÉO P
;
ÉÉP Q
cell
ÑÑ 
.
ÑÑ 
	CellValue
ÑÑ "
=
ÑÑ# $
new
ÑÑ% (
	CellValue
ÑÑ) 2
(
ÑÑ2 3
model
ÑÑ3 8
.
ÑÑ8 9
FromLine
ÑÑ9 A
)
ÑÑA B
;
ÑÑB C
cell
ÖÖ 
.
ÖÖ 
DataType
ÖÖ !
=
ÖÖ" #
new
ÖÖ$ '
	EnumValue
ÖÖ( 1
<
ÖÖ1 2

CellValues
ÖÖ2 <
>
ÖÖ< =
(
ÖÖ= >

CellValues
ÖÖ> H
.
ÖÖH I
String
ÖÖI O
)
ÖÖO P
;
ÖÖP Q
if
àà 
(
àà 
Template
àà  
.
àà  !
Equals
àà! '
(
àà' (
ReportTemplate
àà( 6
.
àà6 7
	Tracking1
àà7 @
.
àà@ A
ToString
ààA I
(
ààI J
)
ààJ K
)
ààK L
&&
ààM O
(
ààP Q
!
ààR S
string
ààS Y
.
ààY Z
IsNullOrEmpty
ààZ g
(
ààg h
model
ààh m
.
ààm n
IoNumber
ààn v
)
ààv w
&&
ààx z
!
àà{ |
modelàà| Å
.ààÅ Ç
IoNumberààÇ ä
.ààä ã
EndsWithààã ì
(ààì î
$strààî ô
)ààô ö
)ààõ ú
)ààú ù
{
ââ 
uint
ää 
	rowNumber
ää &
=
ää' (
$num
ää) +
;
ää+ ,
foreach
ãã 
(
ãã  !
var
ãã! $
segment
ãã% ,
in
ãã- /
model
ãã0 5
.
ãã5 6
Segments
ãã6 >
)
ãã> ?
{
åå 
cell
çç  
=
çç! "
ExcelHelper
çç# .
.
çç. /
GetCell
çç/ 6
(
çç6 7
worksheetPart
çç7 D
.
ççD E
	Worksheet
ççE N
,
ççN O
$str
ççP S
,
ççS T
	rowNumber
ççU ^
)
çç^ _
;
çç_ `
cell
éé  
.
éé  !
	CellValue
éé! *
=
éé+ ,
new
éé- 0
	CellValue
éé1 :
(
éé: ;
segment
éé; B
.
ééB C
SegmentNumber
ééC P
)
ééP Q
;
ééQ R
cell
èè  
.
èè  !
DataType
èè! )
=
èè* +
new
èè, /
	EnumValue
èè0 9
<
èè9 :

CellValues
èè: D
>
èèD E
(
èèE F

CellValues
èèF P
.
èèP Q
String
èèQ W
)
èèW X
;
èèX Y
cell
ëë  
=
ëë! "
ExcelHelper
ëë# .
.
ëë. /
GetCell
ëë/ 6
(
ëë6 7
worksheetPart
ëë7 D
.
ëëD E
	Worksheet
ëëE N
,
ëëN O
$str
ëëP S
,
ëëS T
	rowNumber
ëëU ^
)
ëë^ _
;
ëë_ `
cell
íí  
.
íí  !
	CellValue
íí! *
=
íí+ ,
new
íí- 0
	CellValue
íí1 :
(
íí: ;
segment
íí; B
.
ííB C 
SegmentDataFileUrl
ííC U
)
ííU V
;
ííV W
cell
ìì  
.
ìì  !
DataType
ìì! )
=
ìì* +
new
ìì, /
	EnumValue
ìì0 9
<
ìì9 :

CellValues
ìì: D
>
ììD E
(
ììE F

CellValues
ììF P
.
ììP Q
String
ììQ W
)
ììW X
;
ììX Y
	rowNumber
îî %
++
îî% '
;
îî' (
}
ïï 
}
ññ 
if
ôô 
(
ôô 
Template
ôô  
.
ôô  !
Equals
ôô! '
(
ôô' (
ReportTemplate
ôô( 6
.
ôô6 7!
TrackingReTargeting
ôô7 J
.
ôôJ K
ToString
ôôK S
(
ôôS T
)
ôôT U
)
ôôU V
)
ôôV W
{
öö 
cell
õõ 
=
õõ 
ExcelHelper
õõ *
.
õõ* +
GetCell
õõ+ 2
(
õõ2 3
worksheetPart
õõ3 @
.
õõ@ A
	Worksheet
õõA J
,
õõJ K
$str
õõL O
,
õõO P
$num
õõQ S
)
õõS T
;
õõT U
cell
úú 
.
úú 
	CellValue
úú &
=
úú' (
new
úú) ,
	CellValue
úú- 6
(
úú6 7
model
úú7 <
.
úú< =$
RetargetingImpressions
úú= S
)
úúS T
;
úúT U
cell
ùù 
.
ùù 
DataType
ùù %
=
ùù& '
new
ùù( +
	EnumValue
ùù, 5
<
ùù5 6

CellValues
ùù6 @
>
ùù@ A
(
ùùA B

CellValues
ùùB L
.
ùùL M
Number
ùùM S
)
ùùS T
;
ùùT U
cell
üü 
=
üü 
ExcelHelper
üü *
.
üü* +
GetCell
üü+ 2
(
üü2 3
worksheetPart
üü3 @
.
üü@ A
	Worksheet
üüA J
,
üüJ K
$str
üüL O
,
üüO P
$num
üüQ S
)
üüS T
;
üüT U
cell
†† 
.
†† 
	CellValue
†† &
=
††' (
new
††) ,
	CellValue
††- 6
(
††6 7
model
††7 <
.
††< =
RetargetingClicks
††= N
)
††N O
;
††O P
cell
°° 
.
°° 
DataType
°° %
=
°°& '
new
°°( +
	EnumValue
°°, 5
<
°°5 6

CellValues
°°6 @
>
°°@ A
(
°°A B

CellValues
°°B L
.
°°L M
Number
°°M S
)
°°S T
;
°°T U
}
¢¢ 
if
®® 
(
®® 
File
®® 
.
®® 
Exists
®® #
(
®®# $ 
ScreenshotFilePath
®®$ 6
)
®®6 7
)
®®7 8
ExcelHelper
©© #
.
©©# $
AddImage
©©$ ,
(
©©, -
worksheetPart
©©- :
,
©©: ; 
ScreenshotFilePath
©©< N
,
©©N O
$num
©©P R
,
©©R S
$num
©©T U
)
©©U V
;
©©V W
cell
´´ 
=
´´ 
ExcelHelper
´´ &
.
´´& '
GetCell
´´' .
(
´´. /
worksheetPart
´´/ <
.
´´< =
	Worksheet
´´= F
,
´´F G
$str
´´H K
,
´´K L
$num
´´M O
)
´´O P
;
´´P Q
cell
¨¨ 
.
¨¨ 
	CellValue
¨¨ "
=
¨¨# $
new
¨¨% (
	CellValue
¨¨) 2
(
¨¨2 3
model
¨¨3 8
.
¨¨8 9
CampaignName
¨¨9 E
)
¨¨E F
;
¨¨F G
cell
≠≠ 
.
≠≠ 
DataType
≠≠ !
=
≠≠" #
new
≠≠$ '
	EnumValue
≠≠( 1
<
≠≠1 2

CellValues
≠≠2 <
>
≠≠< =
(
≠≠= >

CellValues
≠≠> H
.
≠≠H I
String
≠≠I O
)
≠≠O P
;
≠≠P Q
cell
ØØ 
=
ØØ 
ExcelHelper
ØØ &
.
ØØ& '
GetCell
ØØ' .
(
ØØ. /
worksheetPart
ØØ/ <
.
ØØ< =
	Worksheet
ØØ= F
,
ØØF G
$str
ØØH K
,
ØØK L
$num
ØØM O
)
ØØO P
;
ØØP Q
cell
∞∞ 
.
∞∞ 
	CellValue
∞∞ "
=
∞∞# $
new
∞∞% (
	CellValue
∞∞) 2
(
∞∞2 3
model
∞∞3 8
.
∞∞8 9
OrderNumber
∞∞9 D
)
∞∞D E
;
∞∞E F
cell
±± 
.
±± 
DataType
±± !
=
±±" #
new
±±$ '
	EnumValue
±±( 1
<
±±1 2

CellValues
±±2 <
>
±±< =
(
±±= >

CellValues
±±> H
.
±±H I
String
±±I O
)
±±O P
;
±±P Q
cell
≥≥ 
=
≥≥ 
ExcelHelper
≥≥ &
.
≥≥& '
GetCell
≥≥' .
(
≥≥. /
worksheetPart
≥≥/ <
.
≥≥< =
	Worksheet
≥≥= F
,
≥≥F G
$str
≥≥H K
,
≥≥K L
$num
≥≥M O
)
≥≥O P
;
≥≥P Q
cell
¥¥ 
.
¥¥ 
	CellValue
¥¥ "
=
¥¥# $
new
¥¥% (
	CellValue
¥¥) 2
(
¥¥2 3
model
¥¥3 8
.
¥¥8 9
	StartDate
¥¥9 B
)
¥¥B C
;
¥¥C D
cell
µµ 
.
µµ 
DataType
µµ !
=
µµ" #
new
µµ$ '
	EnumValue
µµ( 1
<
µµ1 2

CellValues
µµ2 <
>
µµ< =
(
µµ= >

CellValues
µµ> H
.
µµH I
String
µµI O
)
µµO P
;
µµP Q
cell
∑∑ 
=
∑∑ 
ExcelHelper
∑∑ &
.
∑∑& '
GetCell
∑∑' .
(
∑∑. /
worksheetPart
∑∑/ <
.
∑∑< =
	Worksheet
∑∑= F
,
∑∑F G
$str
∑∑H K
,
∑∑K L
$num
∑∑M O
)
∑∑O P
;
∑∑P Q
cell
∏∏ 
.
∏∏ 
	CellValue
∏∏ "
=
∏∏# $
new
∏∏% (
	CellValue
∏∏) 2
(
∏∏2 3
DateTime
∏∏3 ;
.
∏∏; <
Now
∏∏< ?
.
∏∏? @
ToString
∏∏@ H
(
∏∏H I
StringConstants
∏∏I X
.
∏∏X Y
DateFormatSlashes
∏∏Y j
)
∏∏j k
)
∏∏k l
;
∏∏l m
cell
ππ 
.
ππ 
DataType
ππ !
=
ππ" #
new
ππ$ '
	EnumValue
ππ( 1
<
ππ1 2

CellValues
ππ2 <
>
ππ< =
(
ππ= >

CellValues
ππ> H
.
ππH I
String
ππI O
)
ππO P
;
ππP Q
uint
ªª 
start
ªª 
=
ªª  
$num
ªª! #
;
ªª# $
int
ºº 
total
ºº 
=
ºº 
$num
ºº  #
;
ºº# $
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ  
vm
ΩΩ! #
in
ΩΩ$ &
model
ΩΩ' ,
.
ΩΩ, -
PerLink
ΩΩ- 4
)
ΩΩ4 5
{
ææ !
PopulateRowTemplate
øø +
(
øø+ ,
worksheetPart
øø, 9
.
øø9 :
	Worksheet
øø: C
,
øøC D
vm
øøE G
,
øøG H
start
øøI N
)
øøN O
;
øøO P
start
¿¿ 
++
¿¿ 
;
¿¿  
}
¡¡ 
ExcelHelper
≈≈ 
.
≈≈  

DeleteRows
≈≈  *
(
≈≈* +
start
≈≈+ 0
,
≈≈0 1
total
≈≈2 7
-
≈≈8 9
(
≈≈: ;
int
≈≈; >
)
≈≈> ?
start
≈≈? D
,
≈≈D E
worksheetPart
≈≈F S
.
≈≈S T
	Worksheet
≈≈T ]
.
≈≈] ^
GetFirstChild
≈≈^ k
<
≈≈k l
	SheetData
≈≈l u
>
≈≈u v
(
≈≈v w
)
≈≈w x
)
≈≈x y
;
≈≈y z
worksheetPart
«« !
.
««! "
	Worksheet
««" +
.
««+ ,
Save
««, 0
(
««0 1
)
««1 2
;
««2 3
spreadSheet
»» 
.
»»  
Close
»»  %
(
»»% &
)
»»& '
;
»»' (
}
…… 
File
   
.
   
WriteAllBytes
   "
(
  " #
outputFilePath
  # 1
,
  1 2
stream
  3 9
.
  9 :
ToArray
  : A
(
  A B
)
  B C
)
  C D
;
  D E
}
ÀÀ 
}
ÃÃ 	
public
ŒŒ 
override
ŒŒ 
void
ŒŒ !
PopulateRowTemplate
ŒŒ 0
(
ŒŒ0 1
	Worksheet
ŒŒ1 :
	worksheet
ŒŒ; D
,
ŒŒD E$
TemplateReportDetailVm
ŒŒF \
row
ŒŒ] `
,
ŒŒ` a
uint
ŒŒb f
	rowNumber
ŒŒg p
)
ŒŒp q
{
œœ 	
Cell
–– 
cell
–– 
=
–– 
ExcelHelper
–– #
.
––# $
GetCell
––$ +
(
––+ ,
	worksheet
––, 5
,
––5 6
$str
––7 :
,
––: ;
	rowNumber
––< E
)
––E F
;
––F G
cell
—— 
.
—— 
	CellValue
—— 
=
—— 
new
——  
	CellValue
——! *
(
——* +
row
——+ .
.
——. /
Link
——/ 3
)
——3 4
;
——4 5
cell
““ 
.
““ 
DataType
““ 
=
““ 
new
““ 
	EnumValue
““  )
<
““) *

CellValues
““* 4
>
““4 5
(
““5 6

CellValues
““6 @
.
““@ A
String
““A G
)
““G H
;
““H I
cell
‘‘ 
=
‘‘ 
ExcelHelper
‘‘ 
.
‘‘ 
GetCell
‘‘ &
(
‘‘& '
	worksheet
‘‘' 0
,
‘‘0 1
$str
‘‘2 5
,
‘‘5 6
	rowNumber
‘‘7 @
)
‘‘@ A
;
‘‘A B
cell
’’ 
.
’’ 
	CellValue
’’ 
=
’’ 
new
’’  
	CellValue
’’! *
(
’’* +
row
’’+ .
.
’’. /

ClickCount
’’/ 9
.
’’9 :
ToString
’’: B
(
’’B C
)
’’C D
)
’’D E
;
’’E F
cell
÷÷ 
.
÷÷ 
DataType
÷÷ 
=
÷÷ 
new
÷÷ 
	EnumValue
÷÷  )
<
÷÷) *

CellValues
÷÷* 4
>
÷÷4 5
(
÷÷5 6

CellValues
÷÷6 @
.
÷÷@ A
Number
÷÷A G
)
÷÷G H
;
÷÷H I
cell
ÿÿ 
=
ÿÿ 
ExcelHelper
ÿÿ 
.
ÿÿ 
GetCell
ÿÿ &
(
ÿÿ& '
	worksheet
ÿÿ' 0
,
ÿÿ0 1
$str
ÿÿ2 5
,
ÿÿ5 6
	rowNumber
ÿÿ7 @
)
ÿÿ@ A
;
ÿÿA B
cell
ŸŸ 
.
ŸŸ 
	CellValue
ŸŸ 
=
ŸŸ 
new
ŸŸ  
	CellValue
ŸŸ! *
(
ŸŸ* +
row
ŸŸ+ .
.
ŸŸ. /
UniqueCount
ŸŸ/ :
.
ŸŸ: ;
ToString
ŸŸ; C
(
ŸŸC D
)
ŸŸD E
)
ŸŸE F
;
ŸŸF G
cell
⁄⁄ 
.
⁄⁄ 
DataType
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 
	EnumValue
⁄⁄  )
<
⁄⁄) *

CellValues
⁄⁄* 4
>
⁄⁄4 5
(
⁄⁄5 6

CellValues
⁄⁄6 @
.
⁄⁄@ A
Number
⁄⁄A G
)
⁄⁄G H
;
⁄⁄H I
cell
‹‹ 
=
‹‹ 
ExcelHelper
‹‹ 
.
‹‹ 
GetCell
‹‹ &
(
‹‹& '
	worksheet
‹‹' 0
,
‹‹0 1
$str
‹‹2 5
,
‹‹5 6
	rowNumber
‹‹7 @
)
‹‹@ A
;
‹‹A B
cell
›› 
.
›› 
	CellValue
›› 
=
›› 
new
››  
	CellValue
››! *
(
››* +
row
››+ .
.
››. /
MobileCount
››/ :
.
››: ;
ToString
››; C
(
››C D
)
››D E
)
››E F
;
››F G
cell
ﬁﬁ 
.
ﬁﬁ 
DataType
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
	EnumValue
ﬁﬁ  )
<
ﬁﬁ) *

CellValues
ﬁﬁ* 4
>
ﬁﬁ4 5
(
ﬁﬁ5 6

CellValues
ﬁﬁ6 @
.
ﬁﬁ@ A
Number
ﬁﬁA G
)
ﬁﬁG H
;
ﬁﬁH I
}
ﬂﬂ 	
}
·· 
}‚‚ —«
cD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\TrackingReportTemplateStrat.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
public 

class '
TrackingReportTemplateStrat ,
:- .
BaseTrackingReport/ A
,A B
ITrackingReportC R
{ 
public '
TrackingReportTemplateStrat *
(* +
string+ 1
reportTemplate2 @
,@ A
stringB H
customerNameI U
,U V
stringW ]
companyLogo^ i
,i j
stringk q
screenshotFilePath	r Ñ
)
Ñ Ö
: 
base 
( 
reportTemplate !
,! "
customerName# /
,/ 0
companyLogo1 <
,< =
screenshotFilePath> P
)P Q
{ 	
	LogoWidth 
= 
$num 
; 

LogoHeight 
= 
$num 
; 
} 	
public 
override 
void 
Generate %
(% &
TemplateReportVm& 6
model7 <
,< =
string> D
outputFilePathE S
)S T
{ 	
File 
. 
Copy 
( 
TemplateFile "
," #
outputFilePath$ 2
,2 3
true4 8
)8 9
;9 :
byte 
[ 
] 
	byteArray 
= 
File #
.# $
ReadAllBytes$ 0
(0 1
outputFilePath1 ?
)? @
;@ A
using 
( 
MemoryStream 
stream  &
=' (
new) ,
MemoryStream- 9
(9 :
): ;
); <
{ 
stream   
.   
Write   
(   
	byteArray   &
,  & '
$num  ( )
,  ) *
	byteArray  + 4
.  4 5
Length  5 ;
)  ; <
;  < =
using!! 
(!! 
SpreadsheetDocument!! *
spreadSheet!!+ 6
=!!7 8
SpreadsheetDocument!!9 L
.!!L M
Open!!M Q
(!!Q R
stream!!R X
,!!X Y
true!!Z ^
)!!^ _
)!!_ `
{"" 
spreadSheet## 
.##  
WorkbookPart##  ,
.##, -
Workbook##- 5
.##5 6!
CalculationProperties##6 K
.##K L 
ForceFullCalculation##L `
=##a b
true##c g
;##g h
spreadSheet$$ 
.$$  
WorkbookPart$$  ,
.$$, -
Workbook$$- 5
.$$5 6!
CalculationProperties$$6 K
.$$K L!
FullCalculationOnLoad$$L a
=$$b c
true$$d h
;$$h i
IEnumerable'' 
<''  
Sheet''  %
>''% &
sheets''' -
=''. /
spreadSheet''0 ;
.''; <
WorkbookPart''< H
.''H I
Workbook''I Q
.(( 
GetFirstChild(( &
<((& '
Sheets((' -
>((- .
(((. /
)((/ 0
.((0 1
Elements((1 9
<((9 :
Sheet((: ?
>((? @
(((@ A
)((A B
.)) 
Where)) 
()) 
s))  
=>))! #
s))$ %
.))% &
Name))& *
==))+ -
$str)). >
)))> ?
.** 
ToArray**  
(**  !
)**! "
;**" #
if,, 
(,, 
!,, 
sheets,, 
.,,  
Any,,  #
(,,# $
),,$ %
),,% &
{-- 
throw.. 
new.. !
AdsException.." .
(... /
$str../ :
)..: ;
;..; <
}// 
string11 
relationshipId11 )
=11* +
sheets11, 2
.112 3
First113 8
(118 9
)119 :
.11: ;
Id11; =
.11= >
Value11> C
;11C D
WorksheetPart22 !
worksheetPart22" /
=220 1
(222 3
WorksheetPart223 @
)22@ A
spreadSheet22A L
.22L M
WorkbookPart22M Y
.22Y Z
GetPartById22Z e
(22e f
relationshipId22f t
)22t u
;22u v
Cell88 
cell88 
=88 
ExcelHelper88  +
.88+ ,
GetCell88, 3
(883 4
worksheetPart884 A
.88A B
	Worksheet88B K
,88K L
$str88M P
,88P Q
$num88R S
)88S T
;88T U
cell99 
.99 
	CellValue99 "
=99# $
new99% (
	CellValue99) 2
(992 3
DateTime993 ;
.99; <
Now99< ?
.99? @
ToString99@ H
(99H I
StringConstants99I X
.99X Y
DateFormatSlashes99Y j
)99j k
)99k l
;99l m
cell:: 
.:: 
DataType:: !
=::" #
new::$ '
	EnumValue::( 1
<::1 2

CellValues::2 <
>::< =
(::= >

CellValues::> H
.::H I
String::I O
)::O P
;::P Q
cell<< 
=<< 
ExcelHelper<< &
.<<& '
GetCell<<' .
(<<. /
worksheetPart<</ <
.<<< =
	Worksheet<<= F
,<<F G
$str<<H K
,<<K L
$num<<M N
)<<N O
;<<O P
cell== 
.== 
	CellValue== "
===# $
new==% (
	CellValue==) 2
(==2 3
model==3 8
.==8 9
	StartDate==9 B
)==B C
;==C D
cell>> 
.>> 
DataType>> !
=>>" #
new>>$ '
	EnumValue>>( 1
<>>1 2

CellValues>>2 <
>>>< =
(>>= >

CellValues>>> H
.>>H I
String>>I O
)>>O P
;>>P Q
cell@@ 
=@@ 
ExcelHelper@@ &
.@@& '
GetCell@@' .
(@@. /
worksheetPart@@/ <
.@@< =
	Worksheet@@= F
,@@F G
$str@@H K
,@@K L
$num@@M N
)@@N O
;@@O P
cellAA 
.AA 
	CellValueAA "
=AA# $
newAA% (
	CellValueAA) 2
(AA2 3
modelAA3 8
.AA8 9
SubjectLineAA9 D
)AAD E
;AAE F
cellBB 
.BB 
DataTypeBB !
=BB" #
newBB$ '
	EnumValueBB( 1
<BB1 2

CellValuesBB2 <
>BB< =
(BB= >

CellValuesBB> H
.BBH I
StringBBI O
)BBO P
;BBP Q
cellDD 
=DD 
ExcelHelperDD &
.DD& '
GetCellDD' .
(DD. /
worksheetPartDD/ <
.DD< =
	WorksheetDD= F
,DDF G
$strDDH K
,DDK L
$numDDM N
)DDN O
;DDO P
cellEE 
.EE 
	CellValueEE "
=EE# $
newEE% (
	CellValueEE) 2
(EE2 3
modelEE3 8
.EE8 9
FromLineEE9 A
)EEA B
;EEB C
cellFF 
.FF 
DataTypeFF !
=FF" #
newFF$ '
	EnumValueFF( 1
<FF1 2

CellValuesFF2 <
>FF< =
(FF= >

CellValuesFF> H
.FFH I
StringFFI O
)FFO P
;FFP Q
cellHH 
=HH 
ExcelHelperHH &
.HH& '
GetCellHH' .
(HH. /
worksheetPartHH/ <
.HH< =
	WorksheetHH= F
,HHF G
$strHHH K
,HHK L
$numHHM N
)HHN O
;HHO P
cellII 
.II 
	CellValueII "
=II# $
newII% (
	CellValueII) 2
(II2 3
modelII3 8
.II8 9

WhiteLabelII9 C
)IIC D
;IID E
cellJJ 
.JJ 
DataTypeJJ !
=JJ" #
newJJ$ '
	EnumValueJJ( 1
<JJ1 2

CellValuesJJ2 <
>JJ< =
(JJ= >

CellValuesJJ> H
.JJH I
StringJJI O
)JJO P
;JJP Q
cellLL 
=LL 
ExcelHelperLL &
.LL& '
GetCellLL' .
(LL. /
worksheetPartLL/ <
.LL< =
	WorksheetLL= F
,LLF G
$strLLH K
,LLK L
$numLLM N
)LLN O
;LLO P
cellMM 
.MM 
	CellValueMM "
=MM# $
newMM% (
	CellValueMM) 2
(MM2 3
modelMM3 8
.MM8 9
OrderNumberMM9 D
)MMD E
;MME F
cellNN 
.NN 
DataTypeNN !
=NN" #
newNN$ '
	EnumValueNN( 1
<NN1 2

CellValuesNN2 <
>NN< =
(NN= >

CellValuesNN> H
.NNH I
StringNNI O
)NNO P
;NNP Q
cellPP 
=PP 
ExcelHelperPP &
.PP& '
GetCellPP' .
(PP. /
worksheetPartPP/ <
.PP< =
	WorksheetPP= F
,PPF G
$strPPH K
,PPK L
$numPPM N
)PPN O
;PPO P
cellQQ 
.QQ 
	CellValueQQ "
=QQ# $
newQQ% (
	CellValueQQ) 2
(QQ2 3
modelQQ3 8
.QQ8 9
CampaignNameQQ9 E
)QQE F
;QQF G
cellRR 
.RR 
DataTypeRR !
=RR" #
newRR$ '
	EnumValueRR( 1
<RR1 2

CellValuesRR2 <
>RR< =
(RR= >

CellValuesRR> H
.RRH I
StringRRI O
)RRO P
;RRP Q
ifTT 
(TT 
!TT 
stringTT 
.TT 
IsNullOrEmptyTT ,
(TT, -
modelTT- 2
.TT2 3
IoNumberTT3 ;
)TT; <
&&TT= ?
!TT@ A
modelTTA F
.TTF G
IoNumberTTG O
.TTO P
EndsWithTTP X
(TTX Y
$strTTY ^
)TT^ _
)TT_ `
{UU 
uintVV 
	rowNumberVV &
=VV' (
$numVV) +
;VV+ ,
foreachWW 
(WW  !
varWW! $
segmentWW% ,
inWW- /
modelWW0 5
.WW5 6
SegmentsWW6 >
)WW> ?
{XX 
cellYY  
=YY! "
ExcelHelperYY# .
.YY. /
GetCellYY/ 6
(YY6 7
worksheetPartYY7 D
.YYD E
	WorksheetYYE N
,YYN O
$strYYP S
,YYS T
	rowNumberYYU ^
)YY^ _
;YY_ `
cellZZ  
.ZZ  !
	CellValueZZ! *
=ZZ+ ,
newZZ- 0
	CellValueZZ1 :
(ZZ: ;
segmentZZ; B
.ZZB C
SegmentNumberZZC P
)ZZP Q
;ZZQ R
cell[[  
.[[  !
DataType[[! )
=[[* +
new[[, /
	EnumValue[[0 9
<[[9 :

CellValues[[: D
>[[D E
([[E F

CellValues[[F P
.[[P Q
String[[Q W
)[[W X
;[[X Y
cell]]  
=]]! "
ExcelHelper]]# .
.]]. /
GetCell]]/ 6
(]]6 7
worksheetPart]]7 D
.]]D E
	Worksheet]]E N
,]]N O
$str]]P S
,]]S T
	rowNumber]]U ^
)]]^ _
;]]_ `
cell^^  
.^^  !
	CellValue^^! *
=^^+ ,
new^^- 0
	CellValue^^1 :
(^^: ;
segment^^; B
.^^B C
SegmentDataFileUrl^^C U
)^^U V
;^^V W
cell__  
.__  !
DataType__! )
=__* +
new__, /
	EnumValue__0 9
<__9 :

CellValues__: D
>__D E
(__E F

CellValues__F P
.__P Q
String__Q W
)__W X
;__X Y
	rowNumber`` %
++``% '
;``' (
}aa 
}bb 
cellee 
=ee 
ExcelHelperee &
.ee& '
GetCellee' .
(ee. /
worksheetPartee/ <
.ee< =
	Worksheetee= F
,eeF G
$streeH K
,eeK L
$numeeM N
)eeN O
;eeO P
cellff 
.ff 
	CellValueff "
=ff# $
newff% (
	CellValueff) 2
(ff2 3
modelff3 8
.ff8 9
Quantityff9 A
)ffA B
;ffB C
cellgg 
.gg 
DataTypegg !
=gg" #
newgg$ '
	EnumValuegg( 1
<gg1 2

CellValuesgg2 <
>gg< =
(gg= >

CellValuesgg> H
.ggH I
NumberggI O
)ggO P
;ggP Q
celljj 
=jj 
ExcelHelperjj &
.jj& '
GetCelljj' .
(jj. /
worksheetPartjj/ <
.jj< =
	Worksheetjj= F
,jjF G
$strjjH K
,jjK L
$numjjM O
)jjO P
;jjP Q
cellkk 
.kk 
	CellValuekk "
=kk# $
newkk% (
	CellValuekk) 2
(kk2 3
modelkk3 8
.kk8 9
Quantitykk9 A
)kkA B
;kkB C
cellll 
.ll 
DataTypell !
=ll" #
newll$ '
	EnumValuell( 1
<ll1 2

CellValuesll2 <
>ll< =
(ll= >

CellValuesll> H
.llH I
NumberllI O
)llO P
;llP Q
cellnn 
=nn 
ExcelHelpernn &
.nn& '
GetCellnn' .
(nn. /
worksheetPartnn/ <
.nn< =
	Worksheetnn= F
,nnF G
$strnnH K
,nnK L
$numnnM O
)nnO P
;nnP Q
celloo 
.oo 
	CellValueoo "
=oo# $
newoo% (
	CellValueoo) 2
(oo2 3
modeloo3 8
.oo8 9
Openedoo9 ?
)oo? @
;oo@ A
cellpp 
.pp 
DataTypepp !
=pp" #
newpp$ '
	EnumValuepp( 1
<pp1 2

CellValuespp2 <
>pp< =
(pp= >

CellValuespp> H
.ppH I
NumberppI O
)ppO P
;ppP Q
cellrr 
=rr 
ExcelHelperrr &
.rr& '
GetCellrr' .
(rr. /
worksheetPartrr/ <
.rr< =
	Worksheetrr= F
,rrF G
$strrrH K
,rrK L
$numrrM O
)rrO P
;rrP Q
cellss 
.ss 
	CellValuess "
=ss# $
newss% (
	CellValuess) 2
(ss2 3
modelss3 8
.ss8 9
Desktopss9 @
)ss@ A
;ssA B
celltt 
.tt 
DataTypett !
=tt" #
newtt$ '
	EnumValuett( 1
<tt1 2

CellValuestt2 <
>tt< =
(tt= >

CellValuestt> H
.ttH I
NumberttI O
)ttO P
;ttP Q
cellvv 
=vv 
ExcelHelpervv &
.vv& '
GetCellvv' .
(vv. /
worksheetPartvv/ <
.vv< =
	Worksheetvv= F
,vvF G
$strvvH K
,vvK L
$numvvM O
)vvO P
;vvP Q
cellww 
.ww 
	CellValueww "
=ww# $
newww% (
	CellValueww) 2
(ww2 3
modelww3 8
.ww8 9
Mobileww9 ?
)ww? @
;ww@ A
cellxx 
.xx 
DataTypexx !
=xx" #
newxx$ '
	EnumValuexx( 1
<xx1 2

CellValuesxx2 <
>xx< =
(xx= >

CellValuesxx> H
.xxH I
NumberxxI O
)xxO P
;xxP Q
cellzz 
=zz 
ExcelHelperzz &
.zz& '
GetCellzz' .
(zz. /
worksheetPartzz/ <
.zz< =
	Worksheetzz= F
,zzF G
$strzzH K
,zzK L
$numzzM O
)zzO P
;zzP Q
cell{{ 
.{{ 
	CellValue{{ "
={{# $
new{{% (
	CellValue{{) 2
({{2 3
model{{3 8
.{{8 9
Clicked{{9 @
){{@ A
;{{A B
cell|| 
.|| 
DataType|| !
=||" #
new||$ '
	EnumValue||( 1
<||1 2

CellValues||2 <
>||< =
(||= >

CellValues||> H
.||H I
Number||I O
)||O P
;||P Q
cell 
= 
ExcelHelper &
.& '
GetCell' .
(. /
worksheetPart/ <
.< =
	Worksheet= F
,F G
$strH K
,K L
$numM O
)O P
;P Q
cell
ÄÄ 
.
ÄÄ 
	CellValue
ÄÄ "
=
ÄÄ# $
new
ÄÄ% (
	CellValue
ÄÄ) 2
(
ÄÄ2 3
model
ÄÄ3 8
.
ÄÄ8 9
Bounce
ÄÄ9 ?
)
ÄÄ? @
;
ÄÄ@ A
cell
ÅÅ 
.
ÅÅ 
DataType
ÅÅ !
=
ÅÅ" #
new
ÅÅ$ '
	EnumValue
ÅÅ( 1
<
ÅÅ1 2

CellValues
ÅÅ2 <
>
ÅÅ< =
(
ÅÅ= >

CellValues
ÅÅ> H
.
ÅÅH I
Number
ÅÅI O
)
ÅÅO P
;
ÅÅP Q
cell
ÉÉ 
=
ÉÉ 
ExcelHelper
ÉÉ &
.
ÉÉ& '
GetCell
ÉÉ' .
(
ÉÉ. /
worksheetPart
ÉÉ/ <
.
ÉÉ< =
	Worksheet
ÉÉ= F
,
ÉÉF G
$str
ÉÉH K
,
ÉÉK L
$num
ÉÉM O
)
ÉÉO P
;
ÉÉP Q
cell
ÑÑ 
.
ÑÑ 
	CellValue
ÑÑ "
=
ÑÑ# $
new
ÑÑ% (
	CellValue
ÑÑ) 2
(
ÑÑ2 3
model
ÑÑ3 8
.
ÑÑ8 9
Opt
ÑÑ9 <
)
ÑÑ< =
;
ÑÑ= >
cell
ÖÖ 
.
ÖÖ 
DataType
ÖÖ !
=
ÖÖ" #
new
ÖÖ$ '
	EnumValue
ÖÖ( 1
<
ÖÖ1 2

CellValues
ÖÖ2 <
>
ÖÖ< =
(
ÖÖ= >

CellValues
ÖÖ> H
.
ÖÖH I
Number
ÖÖI O
)
ÖÖO P
;
ÖÖP Q
if
áá 
(
áá 
model
áá 
.
áá 
IsRetargeting
áá *
)
áá* +
{
àà 
cell
ââ 
=
ââ 
ExcelHelper
ââ *
.
ââ* +
GetCell
ââ+ 2
(
ââ2 3
worksheetPart
ââ3 @
.
ââ@ A
	Worksheet
ââA J
,
ââJ K
$str
ââL O
,
ââO P
$num
ââQ S
)
ââS T
;
ââT U
cell
ää 
.
ää 
	CellValue
ää &
=
ää' (
new
ää) ,
	CellValue
ää- 6
(
ää6 7
model
ää7 <
.
ää< =$
RetargetingImpressions
ää= S
)
ääS T
;
ääT U
cell
ãã 
.
ãã 
DataType
ãã %
=
ãã& '
new
ãã( +
	EnumValue
ãã, 5
<
ãã5 6

CellValues
ãã6 @
>
ãã@ A
(
ããA B

CellValues
ããB L
.
ããL M
Number
ããM S
)
ããS T
;
ããT U
cell
çç 
=
çç 
ExcelHelper
çç *
.
çç* +
GetCell
çç+ 2
(
çç2 3
worksheetPart
çç3 @
.
çç@ A
	Worksheet
ççA J
,
ççJ K
$str
ççL O
,
ççO P
$num
ççQ S
)
ççS T
;
ççT U
cell
éé 
.
éé 
	CellValue
éé &
=
éé' (
new
éé) ,
	CellValue
éé- 6
(
éé6 7
model
éé7 <
.
éé< =
RetargetingClicks
éé= N
)
ééN O
;
ééO P
}
èè 
else
êê 
{
ëë 
cell
íí 
=
íí 
ExcelHelper
íí *
.
íí* +
GetCell
íí+ 2
(
íí2 3
worksheetPart
íí3 @
.
íí@ A
	Worksheet
ííA J
,
ííJ K
$str
ííL O
,
ííO P
$num
ííQ S
)
ííS T
;
ííT U
cell
ìì 
.
ìì 
	CellValue
ìì &
=
ìì' (
new
ìì) ,
	CellValue
ìì- 6
(
ìì6 7
$str
ìì7 9
)
ìì9 :
;
ìì: ;
cell
îî 
.
îî 
DataType
îî %
=
îî& '
new
îî( +
	EnumValue
îî, 5
<
îî5 6

CellValues
îî6 @
>
îî@ A
(
îîA B

CellValues
îîB L
.
îîL M
String
îîM S
)
îîS T
;
îîT U
cell
ññ 
=
ññ 
ExcelHelper
ññ *
.
ññ* +
GetCell
ññ+ 2
(
ññ2 3
worksheetPart
ññ3 @
.
ññ@ A
	Worksheet
ññA J
,
ññJ K
$str
ññL O
,
ññO P
$num
ññQ S
)
ññS T
;
ññT U
cell
óó 
.
óó 
	CellValue
óó &
=
óó' (
new
óó) ,
	CellValue
óó- 6
(
óó6 7
$str
óó7 9
)
óó9 :
;
óó: ;
cell
òò 
.
òò 
DataType
òò %
=
òò& '
new
òò( +
	EnumValue
òò, 5
<
òò5 6

CellValues
òò6 @
>
òò@ A
(
òòA B

CellValues
òòB L
.
òòL M
String
òòM S
)
òòS T
;
òòT U
}
ôô 
uint
úú 
start
úú 
=
úú  
$num
úú! #
;
úú# $
foreach
ûû 
(
ûû 
var
ûû  
vm
ûû! #
in
ûû$ &
model
ûû' ,
.
ûû, -
PerLink
ûû- 4
)
ûû4 5
{
üü !
PopulateRowTemplate
†† +
(
††+ ,
worksheetPart
††, 9
.
††9 :
	Worksheet
††: C
,
††C D
vm
††E G
,
††G H
start
††I N
)
††N O
;
††O P
start
°° 
++
°° 
;
°°  
}
¢¢ 
if
¶¶ 
(
¶¶ 
File
¶¶ 
.
¶¶ 
Exists
¶¶ #
(
¶¶# $ 
ScreenshotFilePath
¶¶$ 6
)
¶¶6 7
)
¶¶7 8
ExcelHelper
ßß #
.
ßß# $
AddImage
ßß$ ,
(
ßß, -
worksheetPart
ßß- :
,
ßß: ; 
ScreenshotFilePath
ßß< N
,
ßßN O
$num
ßßP R
,
ßßR S
$num
ßßT U
)
ßßU V
;
ßßV W
worksheetPart
™™ !
.
™™! "
	Worksheet
™™" +
.
™™+ ,
Save
™™, 0
(
™™0 1
)
™™1 2
;
™™2 3
spreadSheet
´´ 
.
´´  
Close
´´  %
(
´´% &
)
´´& '
;
´´' (
}
¨¨ 
File
≠≠ 
.
≠≠ 
WriteAllBytes
≠≠ "
(
≠≠" #
outputFilePath
≠≠# 1
,
≠≠1 2
stream
≠≠3 9
.
≠≠9 :
ToArray
≠≠: A
(
≠≠A B
)
≠≠B C
)
≠≠C D
;
≠≠D E
}
ÆÆ 
}
ØØ 	
public
±± 
override
±± 
void
±± !
PopulateRowTemplate
±± 0
(
±±0 1
	Worksheet
±±1 :
	worksheet
±±; D
,
±±D E$
TemplateReportDetailVm
±±F \
row
±±] `
,
±±` a
uint
±±b f
	rowNumber
±±g p
)
±±p q
{
≤≤ 	
Cell
≥≥ 
cell
≥≥ 
=
≥≥ 
ExcelHelper
≥≥ #
.
≥≥# $
GetCell
≥≥$ +
(
≥≥+ ,
	worksheet
≥≥, 5
,
≥≥5 6
$str
≥≥7 :
,
≥≥: ;
	rowNumber
≥≥< E
)
≥≥E F
;
≥≥F G
if
¥¥ 
(
¥¥ 
cell
¥¥ 
==
¥¥ 
null
¥¥ 
)
¥¥ 
return
¥¥ $
;
¥¥$ %
cell
µµ 
.
µµ 
	CellValue
µµ 
=
µµ 
new
µµ  
	CellValue
µµ! *
(
µµ* +
row
µµ+ .
.
µµ. /
Link
µµ/ 3
)
µµ3 4
;
µµ4 5
cell
∂∂ 
.
∂∂ 
DataType
∂∂ 
=
∂∂ 
new
∂∂ 
	EnumValue
∂∂  )
<
∂∂) *

CellValues
∂∂* 4
>
∂∂4 5
(
∂∂5 6

CellValues
∂∂6 @
.
∂∂@ A
String
∂∂A G
)
∂∂G H
;
∂∂H I
cell
∏∏ 
=
∏∏ 
ExcelHelper
∏∏ 
.
∏∏ 
GetCell
∏∏ &
(
∏∏& '
	worksheet
∏∏' 0
,
∏∏0 1
$str
∏∏2 5
,
∏∏5 6
	rowNumber
∏∏7 @
)
∏∏@ A
;
∏∏A B
if
ππ 
(
ππ 
cell
ππ 
==
ππ 
null
ππ 
)
ππ 
return
ππ $
;
ππ$ %
cell
∫∫ 
.
∫∫ 
	CellValue
∫∫ 
=
∫∫ 
new
∫∫  
	CellValue
∫∫! *
(
∫∫* +
row
∫∫+ .
.
∫∫. /

ClickCount
∫∫/ 9
.
∫∫9 :
ToString
∫∫: B
(
∫∫B C
)
∫∫C D
)
∫∫D E
;
∫∫E F
cell
ªª 
.
ªª 
DataType
ªª 
=
ªª 
new
ªª 
	EnumValue
ªª  )
<
ªª) *

CellValues
ªª* 4
>
ªª4 5
(
ªª5 6

CellValues
ªª6 @
.
ªª@ A
Number
ªªA G
)
ªªG H
;
ªªH I
}
ºº 	
}
ææ 
}øø ÄΩ
`D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\TemplateReports\TrackingReportTemplate34.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
TemplateReports' 6
{ 
public 

class $
TrackingReportTemplate34 )
:* +
BaseTrackingReport, >
,> ?
ITrackingReport@ O
{ 
public $
TrackingReportTemplate34 '
(' (
string( .
reportTemplate/ =
,= >
string? E
customerNameF R
,R S
stringT Z
companyLogo[ f
,f g
stringh n
screenshotFilePath	o Å
)
Å Ç
: 
base 
( 
reportTemplate !
,! "
customerName# /
,/ 0
companyLogo1 <
,< =
screenshotFilePath> P
)P Q
{ 	
	LogoWidth 
= 
$num 
; 

LogoHeight 
= 
$num 
; 
} 	
public 
override 
void 
Generate %
(% &
TemplateReportVm& 6
model7 <
,< =
string> D
outputFilePathE S
)S T
{ 	
ImageResizer 
. 
Resize 
(  
LogoFilePath  ,
,, -
LogoResized. 9
,9 :
	LogoWidth; D
,D E

LogoHeightF P
,P Q
trueR V
)V W
;W X
File 
. 
Copy 
( 
TemplateFile "
," #
outputFilePath$ 2
,2 3
true4 8
)8 9
;9 :
byte 
[ 
] 
	byteArray 
= 
File #
.# $
ReadAllBytes$ 0
(0 1
outputFilePath1 ?
)? @
;@ A
using 
( 
MemoryStream 
stream  &
=' (
new) ,
MemoryStream- 9
(9 :
): ;
); <
{ 
stream   
.   
Write   
(   
	byteArray   &
,  & '
$num  ( )
,  ) *
	byteArray  + 4
.  4 5
Length  5 ;
)  ; <
;  < =
using!! 
(!! 
SpreadsheetDocument!! *
spreadSheet!!+ 6
=!!7 8
SpreadsheetDocument!!9 L
.!!L M
Open!!M Q
(!!Q R
stream!!R X
,!!X Y
true!!Z ^
)!!^ _
)!!_ `
{"" 
spreadSheet## 
.##  
WorkbookPart##  ,
.##, -
Workbook##- 5
.##5 6!
CalculationProperties##6 K
.##K L 
ForceFullCalculation##L `
=##a b
true##c g
;##g h
spreadSheet$$ 
.$$  
WorkbookPart$$  ,
.$$, -
Workbook$$- 5
.$$5 6!
CalculationProperties$$6 K
.$$K L!
FullCalculationOnLoad$$L a
=$$b c
true$$d h
;$$h i
IEnumerable'' 
<''  
Sheet''  %
>''% &
sheets''' -
=''. /
spreadSheet''0 ;
.''; <
WorkbookPart''< H
.''H I
Workbook''I Q
.(( 
GetFirstChild(( &
<((& '
Sheets((' -
>((- .
(((. /
)((/ 0
.((0 1
Elements((1 9
<((9 :
Sheet((: ?
>((? @
(((@ A
)((A B
.)) 
Where)) 
()) 
s))  
=>))! #
s))$ %
.))% &
Name))& *
==))+ -
$str)). >
)))> ?
.** 
ToArray**  
(**  !
)**! "
;**" #
if,, 
(,, 
!,, 
sheets,, 
.,,  
Any,,  #
(,,# $
),,$ %
),,% &
{-- 
throw.. 
new.. !
AdsException.." .
(... /
$str../ :
)..: ;
;..; <
}// 
string11 
relationshipId11 )
=11* +
sheets11, 2
.112 3
First113 8
(118 9
)119 :
.11: ;
Id11; =
.11= >
Value11> C
;11C D
WorksheetPart22 !
worksheetPart22" /
=220 1
(222 3
WorksheetPart223 @
)22@ A
spreadSheet22A L
.22L M
WorkbookPart22M Y
.22Y Z
GetPartById22Z e
(22e f
relationshipId22f t
)22t u
;22u v
ExcelHelper66 
.66  
AddImage66  (
(66( )
worksheetPart66) 6
,666 7
LogoResized668 C
,66C D
$num66E F
,66F G
$num66H I
)66I J
;66J K
Cell88 
cell88 
=88 
ExcelHelper88  +
.88+ ,
GetCell88, 3
(883 4
worksheetPart884 A
.88A B
	Worksheet88B K
,88K L
$str88M P
,88P Q
$num88R S
)88S T
;88T U
cell99 
.99 
	CellValue99 "
=99# $
new99% (
	CellValue99) 2
(992 3
DateTime993 ;
.99; <
Now99< ?
.99? @
ToString99@ H
(99H I
StringConstants99I X
.99X Y
DateFormatSlashes99Y j
)99j k
)99k l
;99l m
cell:: 
.:: 
DataType:: !
=::" #
new::$ '
	EnumValue::( 1
<::1 2

CellValues::2 <
>::< =
(::= >

CellValues::> H
.::H I
String::I O
)::O P
;::P Q
cell<< 
=<< 
ExcelHelper<< &
.<<& '
GetCell<<' .
(<<. /
worksheetPart<</ <
.<<< =
	Worksheet<<= F
,<<F G
$str<<H K
,<<K L
$num<<M O
)<<O P
;<<P Q
cell== 
.== 
	CellValue== "
===# $
new==% (
	CellValue==) 2
(==2 3
model==3 8
.==8 9
	StartDate==9 B
)==B C
;==C D
cell>> 
.>> 
DataType>> !
=>>" #
new>>$ '
	EnumValue>>( 1
<>>1 2

CellValues>>2 <
>>>< =
(>>= >

CellValues>>> H
.>>H I
String>>I O
)>>O P
;>>P Q
cell@@ 
=@@ 
ExcelHelper@@ &
.@@& '
GetCell@@' .
(@@. /
worksheetPart@@/ <
.@@< =
	Worksheet@@= F
,@@F G
$str@@H K
,@@K L
$num@@M O
)@@O P
;@@P Q
cellAA 
.AA 
	CellValueAA "
=AA# $
newAA% (
	CellValueAA) 2
(AA2 3
modelAA3 8
.AA8 9
SubjectLineAA9 D
)AAD E
;AAE F
cellBB 
.BB 
DataTypeBB !
=BB" #
newBB$ '
	EnumValueBB( 1
<BB1 2

CellValuesBB2 <
>BB< =
(BB= >

CellValuesBB> H
.BBH I
StringBBI O
)BBO P
;BBP Q
cellDD 
=DD 
ExcelHelperDD &
.DD& '
GetCellDD' .
(DD. /
worksheetPartDD/ <
.DD< =
	WorksheetDD= F
,DDF G
$strDDH K
,DDK L
$numDDM O
)DDO P
;DDP Q
cellEE 
.EE 
	CellValueEE "
=EE# $
newEE% (
	CellValueEE) 2
(EE2 3
modelEE3 8
.EE8 9
FromLineEE9 A
)EEA B
;EEB C
cellFF 
.FF 
DataTypeFF !
=FF" #
newFF$ '
	EnumValueFF( 1
<FF1 2

CellValuesFF2 <
>FF< =
(FF= >

CellValuesFF> H
.FFH I
StringFFI O
)FFO P
;FFP Q
cellHH 
=HH 
ExcelHelperHH &
.HH& '
GetCellHH' .
(HH. /
worksheetPartHH/ <
.HH< =
	WorksheetHH= F
,HHF G
$strHHH K
,HHK L
$numHHM O
)HHO P
;HHP Q
cellII 
.II 
	CellValueII "
=II# $
newII% (
	CellValueII) 2
(II2 3
modelII3 8
.II8 9

WhiteLabelII9 C
)IIC D
;IID E
cellJJ 
.JJ 
DataTypeJJ !
=JJ" #
newJJ$ '
	EnumValueJJ( 1
<JJ1 2

CellValuesJJ2 <
>JJ< =
(JJ= >

CellValuesJJ> H
.JJH I
StringJJI O
)JJO P
;JJP Q
cellLL 
=LL 
ExcelHelperLL &
.LL& '
GetCellLL' .
(LL. /
worksheetPartLL/ <
.LL< =
	WorksheetLL= F
,LLF G
$strLLH K
,LLK L
$numLLM O
)LLO P
;LLP Q
cellMM 
.MM 
	CellValueMM "
=MM# $
newMM% (
	CellValueMM) 2
(MM2 3
modelMM3 8
.MM8 9
OrderNumberMM9 D
)MMD E
;MME F
cellNN 
.NN 
DataTypeNN !
=NN" #
newNN$ '
	EnumValueNN( 1
<NN1 2

CellValuesNN2 <
>NN< =
(NN= >

CellValuesNN> H
.NNH I
StringNNI O
)NNO P
;NNP Q
cellPP 
=PP 
ExcelHelperPP &
.PP& '
GetCellPP' .
(PP. /
worksheetPartPP/ <
.PP< =
	WorksheetPP= F
,PPF G
$strPPH K
,PPK L
$numPPM O
)PPO P
;PPP Q
cellQQ 
.QQ 
	CellValueQQ "
=QQ# $
newQQ% (
	CellValueQQ) 2
(QQ2 3
modelQQ3 8
.QQ8 9
CampaignNameQQ9 E
)QQE F
;QQF G
cellRR 
.RR 
DataTypeRR !
=RR" #
newRR$ '
	EnumValueRR( 1
<RR1 2

CellValuesRR2 <
>RR< =
(RR= >

CellValuesRR> H
.RRH I
StringRRI O
)RRO P
;RRP Q
ifTT 
(TT 
!TT 
stringTT 
.TT 
IsNullOrEmptyTT ,
(TT, -
modelTT- 2
.TT2 3
IoNumberTT3 ;
)TT; <
&&TT= ?
!TT@ A
modelTTA F
.TTF G
IoNumberTTG O
.TTO P
EndsWithTTP X
(TTX Y
$strTTY ^
)TT^ _
)TT_ `
{UU 
uintVV 
	rowNumberVV &
=VV' (
$numVV) +
;VV+ ,
foreachWW 
(WW  !
varWW! $
segmentWW% ,
inWW- /
modelWW0 5
.WW5 6
SegmentsWW6 >
)WW> ?
{XX 
cellYY  
=YY! "
ExcelHelperYY# .
.YY. /
GetCellYY/ 6
(YY6 7
worksheetPartYY7 D
.YYD E
	WorksheetYYE N
,YYN O
$strYYP S
,YYS T
	rowNumberYYU ^
)YY^ _
;YY_ `
cellZZ  
.ZZ  !
	CellValueZZ! *
=ZZ+ ,
newZZ- 0
	CellValueZZ1 :
(ZZ: ;
segmentZZ; B
.ZZB C
SegmentNumberZZC P
)ZZP Q
;ZZQ R
cell[[  
.[[  !
DataType[[! )
=[[* +
new[[, /
	EnumValue[[0 9
<[[9 :

CellValues[[: D
>[[D E
([[E F

CellValues[[F P
.[[P Q
String[[Q W
)[[W X
;[[X Y
cell]]  
=]]! "
ExcelHelper]]# .
.]]. /
GetCell]]/ 6
(]]6 7
worksheetPart]]7 D
.]]D E
	Worksheet]]E N
,]]N O
$str]]P S
,]]S T
	rowNumber]]U ^
)]]^ _
;]]_ `
cell^^  
.^^  !
	CellValue^^! *
=^^+ ,
new^^- 0
	CellValue^^1 :
(^^: ;
segment^^; B
.^^B C
SegmentDataFileUrl^^C U
)^^U V
;^^V W
cell__  
.__  !
DataType__! )
=__* +
new__, /
	EnumValue__0 9
<__9 :

CellValues__: D
>__D E
(__E F

CellValues__F P
.__P Q
String__Q W
)__W X
;__X Y
	rowNumber`` %
++``% '
;``' (
}aa 
}bb 
cellee 
=ee 
ExcelHelperee &
.ee& '
GetCellee' .
(ee. /
worksheetPartee/ <
.ee< =
	Worksheetee= F
,eeF G
$streeH K
,eeK L
$numeeM N
)eeN O
;eeO P
cellff 
.ff 
	CellValueff "
=ff# $
newff% (
	CellValueff) 2
(ff2 3
modelff3 8
.ff8 9
Quantityff9 A
)ffA B
;ffB C
cellgg 
.gg 
DataTypegg !
=gg" #
newgg$ '
	EnumValuegg( 1
<gg1 2

CellValuesgg2 <
>gg< =
(gg= >

CellValuesgg> H
.ggH I
NumberggI O
)ggO P
;ggP Q
celljj 
=jj 
ExcelHelperjj &
.jj& '
GetCelljj' .
(jj. /
worksheetPartjj/ <
.jj< =
	Worksheetjj= F
,jjF G
$strjjH K
,jjK L
$numjjM O
)jjO P
;jjP Q
cellkk 
.kk 
	CellValuekk "
=kk# $
newkk% (
	CellValuekk) 2
(kk2 3
modelkk3 8
.kk8 9
Quantitykk9 A
)kkA B
;kkB C
cellll 
.ll 
DataTypell !
=ll" #
newll$ '
	EnumValuell( 1
<ll1 2

CellValuesll2 <
>ll< =
(ll= >

CellValuesll> H
.llH I
NumberllI O
)llO P
;llP Q
cellnn 
=nn 
ExcelHelpernn &
.nn& '
GetCellnn' .
(nn. /
worksheetPartnn/ <
.nn< =
	Worksheetnn= F
,nnF G
$strnnH K
,nnK L
$numnnM O
)nnO P
;nnP Q
celloo 
.oo 
	CellValueoo "
=oo# $
newoo% (
	CellValueoo) 2
(oo2 3
modeloo3 8
.oo8 9
Openedoo9 ?
)oo? @
;oo@ A
cellpp 
.pp 
DataTypepp !
=pp" #
newpp$ '
	EnumValuepp( 1
<pp1 2

CellValuespp2 <
>pp< =
(pp= >

CellValuespp> H
.ppH I
NumberppI O
)ppO P
;ppP Q
cellrr 
=rr 
ExcelHelperrr &
.rr& '
GetCellrr' .
(rr. /
worksheetPartrr/ <
.rr< =
	Worksheetrr= F
,rrF G
$strrrH K
,rrK L
$numrrM O
)rrO P
;rrP Q
cellss 
.ss 
	CellValuess "
=ss# $
newss% (
	CellValuess) 2
(ss2 3
modelss3 8
.ss8 9
Clickedss9 @
)ss@ A
;ssA B
celltt 
.tt 
DataTypett !
=tt" #
newtt$ '
	EnumValuett( 1
<tt1 2

CellValuestt2 <
>tt< =
(tt= >

CellValuestt> H
.ttH I
NumberttI O
)ttO P
;ttP Q
ifww 
(ww 
Templateww  
.ww  !
Equalsww! '
(ww' (
ReportTemplateww( 6
.ww6 7
	Tracking3ww7 @
.ww@ A
ToStringwwA I
(wwI J
)wwJ K
)wwK L
)wwL M
{xx 
cellyy 
=yy 
ExcelHelperyy *
.yy* +
GetCellyy+ 2
(yy2 3
worksheetPartyy3 @
.yy@ A
	WorksheetyyA J
,yyJ K
$stryyL O
,yyO P
$numyyQ S
)yyS T
;yyT U
cellzz 
.zz 
	CellValuezz &
=zz' (
newzz) ,
	CellValuezz- 6
(zz6 7
modelzz7 <
.zz< =
Unsubzz= B
)zzB C
;zzC D
cell{{ 
.{{ 
DataType{{ %
={{& '
new{{( +
	EnumValue{{, 5
<{{5 6

CellValues{{6 @
>{{@ A
({{A B

CellValues{{B L
.{{L M
Number{{M S
){{S T
;{{T U
}|| 
uint 
start 
=  
$num! #
;# $
if
ÅÅ 
(
ÅÅ 
Template
ÅÅ  
.
ÅÅ  !
Equals
ÅÅ! '
(
ÅÅ' (
ReportTemplate
ÅÅ( 6
.
ÅÅ6 7
	Tracking4
ÅÅ7 @
.
ÅÅ@ A
ToString
ÅÅA I
(
ÅÅI J
)
ÅÅJ K
)
ÅÅK L
)
ÅÅL M
{
ÇÇ 
start
ÉÉ 
=
ÉÉ 
$num
ÉÉ  "
;
ÉÉ" #
cell
ÖÖ 
=
ÖÖ 
ExcelHelper
ÖÖ *
.
ÖÖ* +
GetCell
ÖÖ+ 2
(
ÖÖ2 3
worksheetPart
ÖÖ3 @
.
ÖÖ@ A
	Worksheet
ÖÖA J
,
ÖÖJ K
$str
ÖÖL O
,
ÖÖO P
$num
ÖÖQ S
)
ÖÖS T
;
ÖÖT U
cell
ÜÜ 
.
ÜÜ 
	CellValue
ÜÜ &
=
ÜÜ' (
new
ÜÜ) ,
	CellValue
ÜÜ- 6
(
ÜÜ6 7
model
ÜÜ7 <
.
ÜÜ< =
SubjectLine
ÜÜ= H
)
ÜÜH I
;
ÜÜI J
cell
áá 
.
áá 
DataType
áá %
=
áá& '
new
áá( +
	EnumValue
áá, 5
<
áá5 6

CellValues
áá6 @
>
áá@ A
(
ááA B

CellValues
ááB L
.
ááL M
String
ááM S
)
ááS T
;
ááT U
cell
ââ 
=
ââ 
ExcelHelper
ââ *
.
ââ* +
GetCell
ââ+ 2
(
ââ2 3
worksheetPart
ââ3 @
.
ââ@ A
	Worksheet
ââA J
,
ââJ K
$str
ââL O
,
ââO P
$num
ââQ S
)
ââS T
;
ââT U
cell
ää 
.
ää 
	CellValue
ää &
=
ää' (
new
ää) ,
	CellValue
ää- 6
(
ää6 7
model
ää7 <
.
ää< =
FromLine
ää= E
)
ääE F
;
ääF G
cell
ãã 
.
ãã 
DataType
ãã %
=
ãã& '
new
ãã( +
	EnumValue
ãã, 5
<
ãã5 6

CellValues
ãã6 @
>
ãã@ A
(
ããA B

CellValues
ããB L
.
ããL M
String
ããM S
)
ããS T
;
ããT U
if
çç 
(
çç 
File
çç  
.
çç  !
Exists
çç! '
(
çç' ( 
ScreenshotFilePath
çç( :
)
çç: ;
)
çç; <
ExcelHelper
éé '
.
éé' (
AddImage
éé( 0
(
éé0 1
worksheetPart
éé1 >
,
éé> ? 
ScreenshotFilePath
éé@ R
,
ééR S
$num
ééT V
,
ééV W
$num
ééX Y
)
ééY Z
;
ééZ [
}
èè 
foreach
ìì 
(
ìì 
var
ìì  
vm
ìì! #
in
ìì$ &
model
ìì' ,
.
ìì, -
PerLink
ìì- 4
)
ìì4 5
{
îî !
PopulateRowTemplate
ïï +
(
ïï+ ,
worksheetPart
ïï, 9
.
ïï9 :
	Worksheet
ïï: C
,
ïïC D
vm
ïïE G
,
ïïG H
start
ïïI N
)
ïïN O
;
ïïO P
start
ññ 
++
ññ 
;
ññ  
}
óó 
cell
ôô 
=
ôô 
ExcelHelper
ôô &
.
ôô& '
GetCell
ôô' .
(
ôô. /
worksheetPart
ôô/ <
.
ôô< =
	Worksheet
ôô= F
,
ôôF G
$str
ôôH K
,
ôôK L
start
ôôM R
)
ôôR S
;
ôôS T
cell
öö 
.
öö 
	CellValue
öö "
=
öö# $
new
öö% (
	CellValue
öö) 2
(
öö2 3
$str
öö3 ;
)
öö; <
;
öö< =
cell
õõ 
.
õõ 
DataType
õõ !
=
õõ" #
new
õõ$ '
	EnumValue
õõ( 1
<
õõ1 2

CellValues
õõ2 <
>
õõ< =
(
õõ= >

CellValues
õõ> H
.
õõH I
String
õõI O
)
õõO P
;
õõP Q
cell
ùù 
=
ùù 
ExcelHelper
ùù &
.
ùù& '
GetCell
ùù' .
(
ùù. /
worksheetPart
ùù/ <
.
ùù< =
	Worksheet
ùù= F
,
ùùF G
$str
ùùH K
,
ùùK L
start
ùùM R
)
ùùR S
;
ùùS T
cell
ûû 
.
ûû 
	CellValue
ûû "
=
ûû# $
new
ûû% (
	CellValue
ûû) 2
(
ûû2 3
model
ûû3 8
.
ûû8 9
Clicked
ûû9 @
)
ûû@ A
;
ûûA B
cell
üü 
.
üü 
DataType
üü !
=
üü" #
new
üü$ '
	EnumValue
üü( 1
<
üü1 2

CellValues
üü2 <
>
üü< =
(
üü= >

CellValues
üü> H
.
üüH I
Number
üüI O
)
üüO P
;
üüP Q
worksheetPart
££ !
.
££! "
	Worksheet
££" +
.
££+ ,
Save
££, 0
(
££0 1
)
££1 2
;
££2 3
spreadSheet
§§ 
.
§§  
Close
§§  %
(
§§% &
)
§§& '
;
§§' (
}
•• 
File
¶¶ 
.
¶¶ 
WriteAllBytes
¶¶ "
(
¶¶" #
outputFilePath
¶¶# 1
,
¶¶1 2
stream
¶¶3 9
.
¶¶9 :
ToArray
¶¶: A
(
¶¶A B
)
¶¶B C
)
¶¶C D
;
¶¶D E
}
ßß 
}
®® 	
public
™™ 
override
™™ 
void
™™ !
PopulateRowTemplate
™™ 0
(
™™0 1
	Worksheet
™™1 :
	worksheet
™™; D
,
™™D E$
TemplateReportDetailVm
™™F \
row
™™] `
,
™™` a
uint
™™b f
	rowNumber
™™g p
)
™™p q
{
´´ 	
Cell
¨¨ 
cell
¨¨ 
=
¨¨ 
ExcelHelper
¨¨ #
.
¨¨# $
GetCell
¨¨$ +
(
¨¨+ ,
	worksheet
¨¨, 5
,
¨¨5 6
$str
¨¨7 :
,
¨¨: ;
	rowNumber
¨¨< E
)
¨¨E F
;
¨¨F G
cell
≠≠ 
.
≠≠ 
	CellValue
≠≠ 
=
≠≠ 
new
≠≠  
	CellValue
≠≠! *
(
≠≠* +
row
≠≠+ .
.
≠≠. /
Link
≠≠/ 3
)
≠≠3 4
;
≠≠4 5
cell
ÆÆ 
.
ÆÆ 
DataType
ÆÆ 
=
ÆÆ 
new
ÆÆ 
	EnumValue
ÆÆ  )
<
ÆÆ) *

CellValues
ÆÆ* 4
>
ÆÆ4 5
(
ÆÆ5 6

CellValues
ÆÆ6 @
.
ÆÆ@ A
String
ÆÆA G
)
ÆÆG H
;
ÆÆH I
cell
∞∞ 
=
∞∞ 
ExcelHelper
∞∞ 
.
∞∞ 
GetCell
∞∞ &
(
∞∞& '
	worksheet
∞∞' 0
,
∞∞0 1
$str
∞∞2 5
,
∞∞5 6
	rowNumber
∞∞7 @
)
∞∞@ A
;
∞∞A B
cell
±± 
.
±± 
	CellValue
±± 
=
±± 
new
±±  
	CellValue
±±! *
(
±±* +
row
±±+ .
.
±±. /

ClickCount
±±/ 9
.
±±9 :
ToString
±±: B
(
±±B C
)
±±C D
)
±±D E
;
±±E F
cell
≤≤ 
.
≤≤ 
DataType
≤≤ 
=
≤≤ 
new
≤≤ 
	EnumValue
≤≤  )
<
≤≤) *

CellValues
≤≤* 4
>
≤≤4 5
(
≤≤5 6

CellValues
≤≤6 @
.
≤≤@ A
Number
≤≤A G
)
≤≤G H
;
≤≤H I
}
≥≥ 	
}
µµ 
}∂∂ ñR
HD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\S3\S3FileManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
S3' )
{ 
public		 

class		 
S3FileManager		 
{

 
readonly 
static 
string 

clientCode )
=* +
System, 2
.2 3
Configuration3 @
.@ A 
ConfigurationManagerA U
.U V
AppSettingsV a
[a b
$strb n
]n o
;o p
private 
static 
string 
_serverPrefix +
=, -
$". 0
https://0 8
{8 9
Bucket9 ?
}? @
.s3.amazonaws.com/@ R
"R S
;S T
public 
static 
string 
Bucket #
{$ %
get 
{ 
return 
( 

clientCode "
==# %
Client& ,
., -
ADS- 0
.0 1
ToString1 9
(9 :
): ;
); <
?= >
$str? M
:N O
$strP ^
;^ _
} 
} 	
public 
static 
RegionEndpoint $
Region% +
{ 	
get 
{ 
return 
( 

clientCode "
==# %
Client& ,
., -
ADS- 0
.0 1
ToString1 9
(9 :
): ;
); <
?= >
RegionEndpoint? M
.M N
USEast2N U
:V W
RegionEndpointX f
.f g
USWest2g n
;n o
} 
} 	
public 
static 
string 
ServerPrefix )
{ 	
get   
{!! 
return"" 
_serverPrefix"" $
;""$ %
}## 
}$$ 	
public&& 
static&& 
void&& 
Upload&& !
(&&! "
string&&" (
fileKey&&) 0
,&&0 1
string&&2 8
localFilePath&&9 F
,&&F G
bool&&H L
ifMakePublic&&M Y
=&&Z [
true&&\ `
,&&` a
bool&&b f
	overWrite&&g p
=&&q r
false&&s x
)&&x y
{'' 	
if(( 
((( 
	overWrite(( 
)(( 
Delete(( !
(((! "
fileKey((" )
)(() *
;((* +
using** 
(** 
	IAmazonS3** 
client** #
=**$ %
new**& )
AmazonS3Client*** 8
(**8 9
Region**9 ?
)**? @
)**@ A
{++ 
PutObjectRequest,,  
request,,! (
=,,) *
new,,+ .
PutObjectRequest,,/ ?
(,,? @
),,@ A
;,,A B
request-- 
.-- 

BucketName-- "
=--# $
Bucket--% +
;--+ ,
request.. 
... 
Key.. 
=.. 
fileKey.. %
;..% &
request// 
.// 
FilePath//  
=//! "
localFilePath//# 0
;//0 1
client00 
.00 
	PutObject00  
(00  !
request00! (
)00( )
;00) *
}11 
if33 
(33 
ifMakePublic33 
)33 

MakePublic44 
(44 
fileKey44 "
)44" #
;44# $
}55 	
public77 
static77 
bool77 
Exists77 !
(77! "
string77" (
fileKey77) 0
)770 1
{88 	
using99 
(99 
	IAmazonS399 
client99 #
=99$ %
new99& )
AmazonS3Client99* 8
(998 9
Region999 ?
)99? @
)99@ A
{:: 

S3FileInfo;; 

s3FileInfo;; %
=;;& '
new;;( +

S3FileInfo;;, 6
(;;6 7
client;;7 =
,;;= >
Bucket;;? E
,;;E F
fileKey;;G N
);;N O
;;;O P
return<< 

s3FileInfo<< !
.<<! "
Exists<<" (
;<<( )
}== 
}>> 	
public@@ 
static@@ 
void@@ 
Download@@ #
(@@# $
string@@$ *
fileKey@@+ 2
,@@2 3
string@@4 :
localFilePath@@; H
)@@H I
{AA 	
usingBB 
(BB 
	IAmazonS3BB 
clientBB #
=BB$ %
newBB& )
AmazonS3ClientBB* 8
(BB8 9
RegionBB9 ?
)BB? @
)BB@ A
{CC 
GetObjectRequestDD  
requestDD! (
=DD) *
newDD+ .
GetObjectRequestDD/ ?
(DD? @
)DD@ A
;DDA B
requestEE 
.EE 

BucketNameEE "
=EE# $
BucketEE% +
;EE+ ,
requestFF 
.FF 
KeyFF 
=FF 
fileKeyFF %
;FF% &
GetObjectResponseGG !
responseGG" *
=GG+ ,
clientGG- 3
.GG3 4
	GetObjectGG4 =
(GG= >
requestGG> E
)GGE F
;GGF G
responseHH 
.HH %
WriteResponseStreamToFileHH 2
(HH2 3
localFilePathHH3 @
)HH@ A
;HHA B
}II 
}JJ 	
publicLL 
staticLL 
voidLL 
DeleteLL !
(LL! "
stringLL" (
fileKeyLL) 0
)LL0 1
{MM 	
usingNN 
(NN 
	IAmazonS3NN 
clientNN #
=NN$ %
newNN& )
AmazonS3ClientNN* 8
(NN8 9
RegionNN9 ?
)NN? @
)NN@ A
{OO 
DeleteObjectRequestPP #
requestPP$ +
=PP, -
newPP. 1
DeleteObjectRequestPP2 E
(PPE F
)PPF G
;PPG H
requestQQ 
.QQ 

BucketNameQQ "
=QQ# $
BucketQQ% +
;QQ+ ,
requestRR 
.RR 
KeyRR 
=RR 
fileKeyRR %
;RR% &
clientSS 
.SS 
DeleteObjectSS #
(SS# $
requestSS$ +
)SS+ ,
;SS, -
}TT 
}UU 	
publicWW 
staticWW 
voidWW 
CreateDirectoryWW *
(WW* +
stringWW+ 1

folderNameWW2 <
)WW< =
{XX 	
usingYY 
(YY 
	IAmazonS3YY 
clientYY #
=YY$ %
newYY& )
AmazonS3ClientYY* 8
(YY8 9
RegionYY9 ?
)YY? @
)YY@ A
{ZZ 
S3DirectoryInfo[[ 
destination[[  +
=[[, -
new[[. 1
S3DirectoryInfo[[2 A
([[A B
client[[B H
,[[H I
Bucket[[J P
,[[P Q

folderName[[R \
)[[\ ]
;[[] ^
if\\ 
(\\ 
!\\ 
destination\\  
.\\  !
Exists\\! '
)\\' (
destination\\) 4
.\\4 5
Create\\5 ;
(\\; <
)\\< =
;\\= >
}]] 
}^^ 	
public`` 
static`` 
void`` 
Move`` 
(``  
string``  &

oldFileKey``' 1
,``1 2
string``2 8

newFileKey``9 C
,``C D
string``E K

folderName``L V
,``V W
bool``X \
	overWrite``] f
=``g h
false``i n
)``n o
{aa 	
ifbb 
(bb 
stringbb 
.bb 
IsNullOrEmptybb #
(bb# $

oldFileKeybb$ .
)bb. /
)bb/ 0
returnbb1 7
;bb7 8
ifdd 
(dd 
	overWritedd 
)dd 
Deletedd  
(dd  !

newFileKeydd! +
)dd+ ,
;dd, -
usingff 
(ff 
	IAmazonS3ff 
clientff #
=ff$ %
newff& )
AmazonS3Clientff* 8
(ff8 9
Regionff9 ?
)ff? @
)ff@ A
{gg 

S3FileInfohh 
currentObjecthh (
=hh) *
newhh+ .

S3FileInfohh/ 9
(hh9 :
clienthh: @
,hh@ A
BuckethhB H
,hhH I

oldFileKeyhhJ T
)hhT U
;hhU V
S3DirectoryInfoii 
destinationii  +
=ii, -
newii. 1
S3DirectoryInfoii2 A
(iiA B
clientiiB H
,iiH I
BucketiiJ P
,iiP Q

folderNameiiR \
)ii\ ]
;ii] ^
ifjj 
(jj 
!jj 
destinationjj 
.jj  
Existsjj  &
)jj& '
destinationjj( 3
.jj3 4
Createjj4 :
(jj: ;
)jj; <
;jj< =

S3FileInfokk 
movedObjectkk &
=kk' (
currentObjectkk) 6
.kk6 7
MoveTokk7 =
(kk= >
Bucketkk> D
,kkD E

newFileKeykkF P
)kkP Q
;kkQ R
}ll 

MakePublicmm 
(mm 

newFileKeymm !
)mm! "
;mm" #
}nn 	
publicpp 
staticpp 
voidpp 

MakePublicpp %
(pp% &
stringpp& ,
fileKeypp- 4
)pp4 5
{qq 	
usingrr 
(rr 
	IAmazonS3rr 
clientrr #
=rr$ %
newrr& )
AmazonS3Clientrr* 8
(rr8 9
Regionrr9 ?
)rr? @
)rr@ A
{ss 
PutACLRequesttt 
requesttt %
=tt& '
newtt( +
PutACLRequesttt, 9
(tt9 :
)tt: ;
;tt; <
requestuu 
.uu 

BucketNameuu "
=uu# $
Bucketuu% +
;uu+ ,
requestvv 
.vv 
Keyvv 
=vv 
fileKeyvv %
;vv% &
requestww 
.ww 
	CannedACLww !
=ww" #
S3CannedACLww$ /
.ww/ 0

PublicReadww0 :
;ww: ;
clientxx 
.xx 
PutACLxx 
(xx 
requestxx %
)xx% &
;xx& '
}yy 
}zz 	
}{{ 
}|| œæ
UD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\MailChimps\MailChimpProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

MailChimps' 1
{ 
public 

class 
MailChimpProcessor #
{ 
	protected 
MailChimpProcessor $
($ %
)% &
{ 	
} 	
public 
static 
void 
QucikTestSend (
(( )

CreativeVm) 3
model4 9
)9 :
{ 	
string 

campaignId !
=" #$
CreateCampignWithContent$ <
(< =
model= B
)B C
;C D!
QuickTestSendCampaign %
(% &
model& +
,+ ,

campaignId- 7
,7 8
model9 >
.> ?
QuickTestEmails? N
.N O
SplitO T
(T U
$strU X
.X Y
ToCharArrayY d
(d e
)e f
)f g
)g h
;h i
} 	
private 
static 
void !
QuickTestSendCampaign 1
(1 2

CreativeVm2 <
model= B
,B C
stringD J

campaignIdK U
,U V
stringW ]
[] ^
]^ _

testEmails` j
)j k
{ 	
IMailChimpManager 
manager %
=& '
new( +
MailChimpManager, <
(< =
)= >
;> ?
var 
testSend 
= 
manager "
." #
	Campaigns# ,
., -
	TestAsync- 6
(6 7

campaignId7 A
,A B
newC F
CampaignTestRequestG Z
{ 
Emails   
=   

testEmails   #
,  # $
	EmailType!! 
=!! 
$str!! "
}"" 
)"" 
."" 
ConfigureAwait"" 
("" 
false"" #
)""# $
;""$ %
}$$ 	
public&& 
static&& 
void&& 
TestSend&& #
(&&# $

CreativeVm&&$ .
model&&/ 4
)&&4 5
{'' 	
using(( 
((( 
var(( 
db(( 
=(( 
new(( 
WfpictContext((  -
(((- .
)((. /
)((/ 0
{)) 
var** 
logs** 
=** 
db** 
.** 

SystemLogs** (
.**( )
Where**) .
(**. /
x**/ 0
=>**1 3
x**4 5
.**5 6
OrderNumber**6 A
==**B D
model**E J
.**J K
OrderNumber**K V
&&**W Y
x**Z [
.**[ \
LogType**\ c
==**d f
(**g h
int**h k
)**k l
LogType**l s
.**s t
	MailChimp**t }
)**} ~
;**~ 
foreach++ 
(++ 
var++ 
log++  
in++! #
logs++$ (
)++( )
{,, 
db-- 
.-- 

SystemLogs-- !
.--! "
Remove--" (
(--( )
log--) ,
)--, -
;--- .
}.. 
db// 
.// 
SaveChanges// 
(// 
)//  
;//  !
	LogHelper11 
.11 
AddLog11  
(11  !
db11! #
,11# $
LogType11% ,
.11, -
	MailChimp11- 6
,116 7
model118 =
.11= >
OrderNumber11> I
,11I J
$str11K p
+11q r
model11s x
.11x y
OrderNumber	11y Ñ
)
11Ñ Ö
;
11Ö Ü
string22 
listId22 
=22 

CreateList22  *
(22* +
db22+ -
,22- .
model22/ 4
)224 5
;225 6
CreateMembers33 
(33 
db33  
,33  !
listId33" (
,33( )
model33* /
)33/ 0
;330 1
Thread66 
.66 
Sleep66 
(66 
$num66 !
*66" #
$num66$ &
*66' (
$num66) *
)66* +
;66+ ,
int99 

templateId99 
=99  
CreateTemplate99! /
(99/ 0
db990 2
,992 3
model994 9
)999 :
;99: ;
string;; 

campaignId;; !
=;;" #%
CreateCampignWithTemplate;;$ =
(;;= >
db;;> @
,;;@ A
model;;B G
,;;G H
listId;;I O
,;;O P

templateId;;Q [
);;[ \
;;;\ ]
SendCampaign== 
(== 
db== 
,==  
model==! &
,==& '

campaignId==( 2
)==2 3
;==3 4
	LogHelper?? 
.?? 
AddLog??  
(??  !
db??! #
,??# $
LogType??% ,
.??, -
	MailChimp??- 6
,??6 7
model??8 =
.??= >
OrderNumber??> I
,??I J
$str??K n
)??n o
;??o p
}@@ 
}AA 	
privateCC 
staticCC 
voidCC 
SendCampaignCC (
(CC( )
WfpictContextCC) 6
dbCC7 9
,CC9 :

CreativeVmCC; E
modelCCF K
,CCK L
stringCCM S

campaignIdCCT ^
)CC^ _
{DD 	
IMailChimpManagerEE 
managerEE %
=EE& '
newEE( +
MailChimpManagerEE, <
(EE< =
)EE= >
;EE> ?
	LogHelperFF 
.FF 
AddLogFF 
(FF 
dbFF 
,FF  
LogTypeFF! (
.FF( )
	MailChimpFF) 2
,FF2 3
modelFF4 9
.FF9 :
OrderNumberFF: E
,FFE F
$strFFG ]
)FF] ^
;FF^ _
varGG 
sentGG 
=GG 
managerGG 
.GG 
	CampaignsGG (
.GG( )
	SendAsyncGG) 2
(GG2 3

campaignIdGG3 =
)GG= >
.GG> ?
ConfigureAwaitGG? M
(GGM N
falseGGN S
)GGS T
;GGT U
}II 	
privateKK 
staticKK 
stringKK $
CreateCampignWithContentKK 6
(KK6 7

CreativeVmKK7 A
modelKKB G
)KKG H
{LL 	
IMailChimpManagerMM 
managerMM %
=MM& '
newMM( +
MailChimpManagerMM, <
(MM< =
)MM= >
;MM> ?
varOO 
campaignOO 
=OO 
managerOO "
.OO" #
	CampaignsOO# ,
.OO, -
AddAsyncOO- 5
(OO5 6
newOO6 9
	MailChimpOO: C
.OOC D
NetOOD G
.OOG H
ModelsOOH N
.OON O
CampaignOOO W
{PP 
SettingsQQ 
=QQ 
newQQ 
SettingQQ &
{RR 
ReplyToSS 
=SS 
$strSS <
,SS< =
TitleTT 
=TT 
modelTT !
.TT! "
SubjectLineTT" -
,TT- .
FromNameUU 
=UU 
$strUU ,
,UU, -
SubjectLineVV 
=VV  !
modelVV" '
.VV' (
SubjectLineVV( 3
,VV3 4
}WW 
,WW 
TypeXX 
=XX 
CampaignTypeXX #
.XX# $
RegularXX$ +
,XX+ ,
}YY 
)YY 
.YY 
ConfigureAwaitYY 
(YY 
falseYY #
)YY# $
;YY$ %
var[[ 

campaignId[[ 
=[[ 
campaign[[ %
.[[% &

GetAwaiter[[& 0
([[0 1
)[[1 2
.[[2 3
	GetResult[[3 <
([[< =
)[[= >
.[[> ?
Id[[? A
;[[A B
var]] 
content]] 
=]] 
new]] 
ContentRequest]] ,
{^^ 
Html`` 
=`` 
model`` 
.`` 
	Creatives`` &
,``& '
}aa 
;aa 
managerbb 
.bb 
Contentbb 
.bb 
AddOrUpdateAsyncbb ,
(bb, -

campaignIdbb- 7
,bb7 8
contentbb9 @
)bb@ A
;bbA B
returncc 

campaignIdcc 
;cc 
}dd 	
privateff 
staticff 
stringff %
CreateCampignWithTemplateff 7
(ff7 8
WfpictContextff8 E
dbffF H
,ffH I

CreativeVmffJ T
modelffU Z
,ffZ [
stringff\ b
listIdffc i
,ffi j
intffk n

templateIdffo y
)ffy z
{gg 	
IMailChimpManagerhh 
managerhh %
=hh& '
newhh( +
MailChimpManagerhh, <
(hh< =
)hh= >
;hh> ?
	LogHelperii 
.ii 
AddLogii 
(ii 
dbii 
,ii  
LogTypeii! (
.ii( )
	MailChimpii) 2
,ii2 3
modelii4 9
.ii9 :
OrderNumberii: E
,iiE F
$striiG h
)iih i
;iii j
varjj 
campaignjj 
=jj 
managerjj "
.jj" #
	Campaignsjj# ,
.jj, -
AddAsyncjj- 5
(jj5 6
newjj6 9
	MailChimpjj: C
.jjC D
NetjjD G
.jjG H
ModelsjjH N
.jjN O
CampaignjjO W
{kk 

Recipientsll 
=ll 
newll  
	Recipientll! *
{mm 
ListIdnn 
=nn 
listIdnn #
}oo 
,oo 
Settingspp 
=pp 
newpp 
Settingpp &
{qq 
ReplyTorr 
=rr 
$strrr <
,rr< =
Titless 
=ss 
modelss !
.ss! "
SubjectLiness" -
,ss- .
FromNamett 
=tt 
$strtt ,
,tt, -
SubjectLineuu 
=uu  !
modeluu" '
.uu' (
SubjectLineuu( 3
,uu3 4

TemplateIdvv 
=vv  

templateIdvv! +
,vv+ ,
}ww 
,ww 
Typexx 
=xx 
CampaignTypexx #
.xx# $
Regularxx$ +
,xx+ ,
}yy 
)yy 
.yy 
ConfigureAwaityy 
(yy 
falseyy #
)yy# $
;yy$ %
var{{ 

campaignId{{ 
={{ 
campaign{{ %
.{{% &

GetAwaiter{{& 0
({{0 1
){{1 2
.{{2 3
	GetResult{{3 <
({{< =
){{= >
.{{> ?
Id{{? A
;{{A B
return|| 

campaignId|| 
;|| 
}}} 	
private 
static 
int 
CreateTemplate )
() *
WfpictContext* 7
db8 :
,: ;

CreativeVm< F
modelG L
)L M
{
ÄÄ 	
IMailChimpManager
ÅÅ 
manager
ÅÅ %
=
ÅÅ& '
new
ÅÅ( +
MailChimpManager
ÅÅ, <
(
ÅÅ< =
)
ÅÅ= >
;
ÅÅ> ?
	LogHelper
ÇÇ 
.
ÇÇ 
AddLog
ÇÇ 
(
ÇÇ 
db
ÇÇ 
,
ÇÇ  
LogType
ÇÇ! (
.
ÇÇ( )
	MailChimp
ÇÇ) 2
,
ÇÇ2 3
model
ÇÇ4 9
.
ÇÇ9 :
OrderNumber
ÇÇ: E
,
ÇÇE F
$str
ÇÇG i
)
ÇÇi j
;
ÇÇj k
var
ÉÉ !
allTemplatesRequest
ÉÉ #
=
ÉÉ$ %
manager
ÉÉ& -
.
ÉÉ- .
	Templates
ÉÉ. 7
.
ÉÉ7 8
GetAllAsync
ÉÉ8 C
(
ÉÉC D
)
ÉÉD E
.
ÉÉE F
ConfigureAwait
ÉÉF T
(
ÉÉT U
false
ÉÉU Z
)
ÉÉZ [
;
ÉÉ[ \
var
ÑÑ 
allTemplates
ÑÑ 
=
ÑÑ !
allTemplatesRequest
ÑÑ 2
.
ÑÑ2 3

GetAwaiter
ÑÑ3 =
(
ÑÑ= >
)
ÑÑ> ?
.
ÑÑ? @
	GetResult
ÑÑ@ I
(
ÑÑI J
)
ÑÑJ K
;
ÑÑK L
int
ÖÖ 
templateIdOld
ÖÖ 
=
ÖÖ 
-
ÖÖ  !
$num
ÖÖ! "
;
ÖÖ" #
foreach
ÜÜ 
(
ÜÜ 
var
ÜÜ 
allTemplate
ÜÜ $
in
ÜÜ% '
allTemplates
ÜÜ( 4
)
ÜÜ4 5
{
áá 
if
àà 
(
àà 
allTemplate
àà 
.
àà  
Name
àà  $
==
àà% '
model
àà( -
.
àà- .
OrderNumber
àà. 9
)
àà9 :
{
ââ 
templateIdOld
ää !
=
ää" #
allTemplate
ää$ /
.
ää/ 0
Id
ää0 2
;
ää2 3
break
ãã 
;
ãã 
}
åå 
}
çç 
if
éé 
(
éé 
templateIdOld
éé 
!=
éé  
-
éé! "
$num
éé" #
)
éé# $
{
èè 
	LogHelper
êê 
.
êê 
AddLog
êê  
(
êê  !
db
êê! #
,
êê# $
LogType
êê% ,
.
êê, -
	MailChimp
êê- 6
,
êê6 7
model
êê8 =
.
êê= >
OrderNumber
êê> I
,
êêI J
$str
êêK V
+
êêW X
model
êêY ^
.
êê^ _
OrderNumber
êê_ j
+
êêk l
$strêêm ë
)êêë í
;êêí ì
var
ëë #
deleteTemplateRequest
ëë )
=
ëë* +
manager
ëë, 3
.
ëë3 4
	Templates
ëë4 =
.
ëë= >
DeleteAsync
ëë> I
(
ëëI J
templateIdOld
ëëJ W
.
ëëW X
ToString
ëëX `
(
ëë` a
)
ëëa b
)
ëëb c
.
ëëc d
ConfigureAwait
ëëd r
(
ëër s
false
ëës x
)
ëëx y
;
ëëy z
}
íí 
var
îî 
template
îî 
=
îî 
manager
îî "
.
îî" #
	Templates
îî# ,
.
îî, -
CreateAsync
îî- 8
(
îî8 9
model
îî9 >
.
îî> ?
OrderNumber
îî? J
,
îîJ K
$str
îîL N
,
îîN O
model
îîP U
.
îîU V
	Creatives
îîV _
)
îî_ `
.
îî` a
ConfigureAwait
îîa o
(
îîo p
false
îîp u
)
îîu v
;
îîv w
var
ïï 

templateId
ïï 
=
ïï 
template
ïï %
.
ïï% &

GetAwaiter
ïï& 0
(
ïï0 1
)
ïï1 2
.
ïï2 3
	GetResult
ïï3 <
(
ïï< =
)
ïï= >
.
ïï> ?
Id
ïï? A
;
ïïA B
	LogHelper
ññ 
.
ññ 
AddLog
ññ 
(
ññ 
db
ññ 
,
ññ  
LogType
ññ! (
.
ññ( )
	MailChimp
ññ) 2
,
ññ2 3
model
ññ4 9
.
ññ9 :
OrderNumber
ññ: E
,
ññE F
$str
ññG q
)
ññq r
;
ññr s
return
óó 

templateId
óó 
;
óó 
}
òò 	
private
öö 
static
öö 
void
öö "
CreateTemplateFolder
öö 0
(
öö0 1

CreativeVm
öö1 ;
model
öö< A
)
ööA B
{
õõ 	
IMailChimpManager
úú 
manager
úú %
=
úú& '
new
úú( +
MailChimpManager
úú, <
(
úú< =
)
úú= >
;
úú> ?
var
ùù 
folder
ùù 
=
ùù 
manager
ùù 
.
ùù  
TemplateFolders
ùù  /
.
ùù/ 0
AddAsync
ùù0 8
(
ùù8 9
model
ùù9 >
.
ùù> ?
OrderNumber
ùù? J
)
ùùJ K
.
ùùK L
ConfigureAwait
ùùL Z
(
ùùZ [
false
ùù[ `
)
ùù` a
;
ùùa b
var
ûû 
folderStatus
ûû 
=
ûû 
folder
ûû %
.
ûû% &

GetAwaiter
ûû& 0
(
ûû0 1
)
ûû1 2
.
ûû2 3
	GetResult
ûû3 <
(
ûû< =
)
ûû= >
;
ûû> ?
}
üü 	
private
°° 
static
°° 
void
°° 
CreateMembers
°° )
(
°°) *
WfpictContext
°°* 7
db
°°8 :
,
°°: ;
string
°°< B
listId
°°C I
,
°°I J

CreativeVm
°°K U
model
°°V [
)
°°[ \
{
¢¢ 	
IMailChimpManager
££ 
manager
££ %
=
££& '
new
££( +
MailChimpManager
££, <
(
££< =
)
££= >
;
££> ?
	LogHelper
§§ 
.
§§ 
AddLog
§§ 
(
§§ 
db
§§ 
,
§§  
LogType
§§! (
.
§§( )
	MailChimp
§§) 2
,
§§2 3
model
§§4 9
.
§§9 :
OrderNumber
§§: E
,
§§E F
$str
§§G Y
)
§§Y Z
;
§§Z [
foreach
•• 
(
•• 
var
•• 
email
•• 
in
•• !
model
••" '
.
••' (

TestEmails
••( 2
)
••2 3
{
¶¶ 
var
ßß 
member
ßß 
=
ßß 
new
ßß  
Member
ßß! '
{
ßß( )
EmailAddress
ßß* 6
=
ßß7 8
email
ßß9 >
.
ßß> ?
Text
ßß? C
,
ßßC D
StatusIfNew
ßßE P
=
ßßQ R
Status
ßßS Y
.
ßßY Z

Subscribed
ßßZ d
}
ßße f
;
ßßf g
var
®® 
memberResult
®®  
=
®®! "
manager
®®# *
.
®®* +
Members
®®+ 2
.
®®2 3
AddOrUpdateAsync
®®3 C
(
®®C D
listId
®®D J
,
®®J K
member
®®L R
)
®®R S
.
®®S T
ConfigureAwait
®®T b
(
®®b c
false
®®c h
)
®®h i
;
®®i j
var
©© 
result
©© 
=
©© 
memberResult
©© )
.
©©) *

GetAwaiter
©©* 4
(
©©4 5
)
©©5 6
.
©©6 7
	GetResult
©©7 @
(
©©@ A
)
©©A B
;
©©B C
var
´´ 
exists
´´ 
=
´´ 
manager
´´ $
.
´´$ %
Members
´´% ,
.
´´, -
ExistsAsync
´´- 8
(
´´8 9
listId
´´9 ?
,
´´? @
email
´´A F
.
´´F G
Text
´´G K
)
´´K L
.
´´L M
Result
´´M S
;
´´S T
}
¨¨ 
	LogHelper
≠≠ 
.
≠≠ 
AddLog
≠≠ 
(
≠≠ 
db
≠≠ 
,
≠≠  
LogType
≠≠! (
.
≠≠( )
	MailChimp
≠≠) 2
,
≠≠2 3
model
≠≠4 9
.
≠≠9 :
OrderNumber
≠≠: E
,
≠≠E F
$str
≠≠G f
)
≠≠f g
;
≠≠g h
}
ÆÆ 	
private
∞∞ 
static
∞∞ 
string
∞∞ 

CreateList
∞∞ (
(
∞∞( )
WfpictContext
∞∞) 6
db
∞∞7 9
,
∞∞9 :

CreativeVm
∞∞; E
model
∞∞F K
)
∞∞K L
{
±± 	
bool
≤≤ 
isListExists
≤≤ 
=
≤≤ 
false
≤≤  %
;
≤≤% &
string
≥≥ 
listId
≥≥ 
=
≥≥ 
string
≥≥ "
.
≥≥" #
Empty
≥≥# (
;
≥≥( )
IMailChimpManager
¥¥ 
manager
¥¥ %
=
¥¥& '
new
¥¥( +
MailChimpManager
¥¥, <
(
¥¥< =
)
¥¥= >
;
¥¥> ?
var
µµ 
lists
µµ 
=
µµ 
manager
µµ 
.
µµ  
Lists
µµ  %
.
µµ% &
GetAllAsync
µµ& 1
(
µµ1 2
)
µµ2 3
.
µµ3 4
ConfigureAwait
µµ4 B
(
µµB C
false
µµC H
)
µµH I
;
µµI J
foreach
∂∂ 
(
∂∂ 
var
∂∂ 
list
∂∂ 
in
∂∂  
lists
∂∂! &
.
∂∂& '

GetAwaiter
∂∂' 1
(
∂∂1 2
)
∂∂2 3
.
∂∂3 4
	GetResult
∂∂4 =
(
∂∂= >
)
∂∂> ?
)
∂∂? @
{
∑∑ 
if
∏∏ 
(
∏∏ 
list
∏∏ 
.
∏∏ 
Name
∏∏ 
==
∏∏  
model
∏∏! &
.
∏∏& '
OrderNumber
∏∏' 2
)
∏∏2 3
{
ππ 
isListExists
∫∫  
=
∫∫! "
true
∫∫# '
;
∫∫' (
listId
ªª 
=
ªª 
list
ªª !
.
ªª! "
Id
ªª" $
;
ªª$ %
break
ºº 
;
ºº 
}
ΩΩ 
}
ææ 
if
¿¿ 
(
¿¿ 
isListExists
¿¿ 
)
¿¿ 
{
¡¡ 
	LogHelper
¬¬ 
.
¬¬ 
AddLog
¬¬  
(
¬¬  !
db
¬¬! #
,
¬¬# $
LogType
¬¬% ,
.
¬¬, -
	MailChimp
¬¬- 6
,
¬¬6 7
model
¬¬8 =
.
¬¬= >
OrderNumber
¬¬> I
,
¬¬I J
$str
¬¬K R
+
¬¬S T
model
¬¬U Z
.
¬¬Z [
OrderNumber
¬¬[ f
+
¬¬g h
$str
¬¬i {
)
¬¬{ |
;
¬¬| }
}
√√ 
else
ƒƒ 
{
≈≈ 
	LogHelper
∆∆ 
.
∆∆ 
AddLog
∆∆  
(
∆∆  !
db
∆∆! #
,
∆∆# $
LogType
∆∆% ,
.
∆∆, -
	MailChimp
∆∆- 6
,
∆∆6 7
model
∆∆8 =
.
∆∆= >
OrderNumber
∆∆> I
,
∆∆I J
$str
∆∆K Z
)
∆∆Z [
;
∆∆[ \
var
«« 
testList
«« 
=
«« 
manager
«« &
.
««& '
Lists
««' ,
.
««, -
AddOrUpdateAsync
««- =
(
««= >
new
»» 
List
»»  
(
»»  !
)
»»! "
{
…… 
Name
    
=
  ! "
model
  # (
.
  ( )
OrderNumber
  ) 4
,
  4 5 
PermissionReminder
ÀÀ .
=
ÀÀ/ 0
$str
ÀÀ1 7
,
ÀÀ7 8
Contact
ÃÃ #
=
ÃÃ$ %
new
ÃÃ& )
Contact
ÃÃ* 1
{
ÕÕ 
Address1
ŒŒ  (
=
ŒŒ) *
$str
ŒŒ+ 1
,
ŒŒ1 2
City
œœ  $
=
œœ% &
$str
œœ' 3
,
œœ3 4
Country
––  '
=
––( )
$str
––* /
,
––/ 0
State
——  %
=
——& '
$str
——( ,
,
——, -
Zip
““  #
=
““$ %
$str
““& -
,
““- .
Company
””  '
=
””( )
$str
””* 0
}
‘‘ 
,
‘‘ 
CampaignDefaults
’’ ,
=
’’- .
new
’’/ 2
CampaignDefaults
’’3 C
{
÷÷ 
	FromEmail
◊◊  )
=
◊◊* +
$str
◊◊, <
,
◊◊< =
FromName
ÿÿ  (
=
ÿÿ) *
model
ÿÿ+ 0
.
ÿÿ0 1
FromLine
ÿÿ1 9
,
ÿÿ9 :
Language
ŸŸ  (
=
ŸŸ) *
$str
ŸŸ+ /
,
ŸŸ/ 0
Subject
⁄⁄  '
=
⁄⁄( )
model
⁄⁄* /
.
⁄⁄/ 0
SubjectLine
⁄⁄0 ;
}
€€ 
}
‹‹ 
)
‹‹ 
.
‹‹ 
ConfigureAwait
‹‹ )
(
‹‹) *
false
‹‹* /
)
‹‹/ 0
;
‹‹0 1
var
›› 
list
›› 
=
›› 
testList
›› #
.
››# $

GetAwaiter
››$ .
(
››. /
)
››/ 0
.
››0 1
	GetResult
››1 :
(
››: ;
)
››; <
;
››< =
listId
ﬁﬁ 
=
ﬁﬁ 
list
ﬁﬁ 
.
ﬁﬁ 
Id
ﬁﬁ  
;
ﬁﬁ  !
	LogHelper
ﬂﬂ 
.
ﬂﬂ 
AddLog
ﬂﬂ  
(
ﬂﬂ  !
db
ﬂﬂ! #
,
ﬂﬂ# $
LogType
ﬂﬂ% ,
.
ﬂﬂ, -
	MailChimp
ﬂﬂ- 6
,
ﬂﬂ6 7
model
ﬂﬂ8 =
.
ﬂﬂ= >
OrderNumber
ﬂﬂ> I
,
ﬂﬂI J
$str
ﬂﬂK g
)
ﬂﬂg h
;
ﬂﬂh i
}
‡‡ 
return
‚‚ 
listId
‚‚ 
;
‚‚ 
}
„„ 	
}
ÊÊ 
}ÁÁ õ∆
ED:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Csv\CsvHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Csv' *
{ 
public 

class 
CsvFile 
: 
IDisposable &
{ 
public 
static 
CsvDefinition # 
DefaultCsvDefinition$ 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
static 
bool 

UseLambdas %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
static 
bool 
UseTasks #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
static 
bool 
FastIndexOfAny )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
static 
CsvFile 
( 
) 
{ 	 
DefaultCsvDefinition%%  
=%%! "
new%%# &
CsvDefinition%%' 4
{&& 
	EndOfLine'' 
='' 
$str'' "
,''" #
FieldSeparator(( 
=((  
$char((! $
,(($ %
TextQualifier)) 
=)) 
$char))  #
}** 
;** 

UseLambdas++ 
=++ 
true++ 
;++ 
UseTasks,, 
=,, 
true,, 
;,, 
FastIndexOfAny-- 
=-- 
true-- !
;--! "
}.. 	
internal22 
	protected22 
Stream22 !

BaseStream22" ,
;22, -
	protected33 
static33 
DateTime33 !
DateTimeZero33" .
=33/ 0
new331 4
DateTime335 =
(33= >
)33> ?
;33? @
public66 
static66 
IEnumerable66 !
<66! "
T66" #
>66# $
Read66% )
<66) *
T66* +
>66+ ,
(66, -
	CsvSource66- 6
	csvSource667 @
)66@ A
where66B G
T66H I
:66J K
new66L O
(66O P
)66P Q
{77 	
var88 
csvFileReader88 
=88 
new88  #
CsvFileReader88$ 1
<881 2
T882 3
>883 4
(884 5
	csvSource885 >
)88> ?
;88? @
return99 
(99 
IEnumerable99 
<99  
T99  !
>99! "
)99" #
csvFileReader99# 0
;990 1
}:: 	
public<< 
char<< 
FieldSeparator<< "
{<<# $
get<<% (
;<<( )
private<<* 1
set<<2 5
;<<5 6
}<<7 8
public== 
char== 
TextQualifier== !
{==" #
get==$ '
;==' (
private==) 0
set==1 4
;==4 5
}==6 7
public>> 
IEnumerable>> 
<>> 
String>> !
>>>! "
Columns>># *
{>>+ ,
get>>- 0
;>>0 1
private>>2 9
set>>: =
;>>= >
}>>? @
public@@ 
void@@ 
Dispose@@ 
(@@ 
)@@ 
{AA 	
DisposeBB 
(BB 
trueBB 
)BB 
;BB 
}CC 	
	protectedEE 
virtualEE 
voidEE 
DisposeEE &
(EE& '
boolEE' +
	disposingEE, 5
)EE5 6
{FF 	
}II 	
}JJ 
publicLL 

classLL 
CsvFileLL 
<LL 
TLL 
>LL 
:LL 
CsvFileLL %
{MM 
privateNN 
readonlyNN 
charNN 
_fieldSeparatorNN -
;NN- .
privateOO 
readonlyOO 
stringOO #
_fieldSeparatorAsStringOO  7
;OO7 8
privatePP 
readonlyPP 
charPP 
[PP 
]PP !
_invalidCharsInFieldsPP  5
;PP5 6
privateQQ 
readonlyQQ 
StreamWriterQQ %
_streamWriterQQ& 3
;QQ3 4
privateRR 
readonlyRR 
charRR 
_textQualifierRR ,
;RR, -
privateSS 
readonlySS 
StringSS 
[SS  
]SS  !
_columnsSS" *
;SS* +
privateTT 
FuncTT 
<TT 
TTT 
,TT 
objectTT 
>TT 
[TT  
]TT  !
_gettersTT" *
;TT* +
readonlyUU 
boolUU 
[UU 
]UU "
_isInvalidCharInFieldsUU .
;UU. /
privateWW 
intWW 
_linesToWriteWW !
;WW! "
privateXX 
readonlyXX 
BlockingCollectionXX +
<XX+ ,
stringXX, 2
>XX2 3
_csvLinesToWriteXX4 D
=XXE F
newXXG J
BlockingCollectionXXK ]
<XX] ^
stringXX^ d
>XXd e
(XXe f
$numXXf j
)XXj k
;XXk l
privateYY 
readonlyYY 
ThreadYY 
_writeCsvLinesTaskYY  2
;YY2 3
privateZZ 
TaskZZ 
_addAsyncTaskZZ "
;ZZ" #
public]] 
CsvFile]] 
(]] 
CsvDestination]] %
csvDestination]]& 4
)]]4 5
:^^ 
this^^ 
(^^ 
csvDestination^^ !
,^^! "
null^^# '
)^^' (
{__ 	
}`` 	
publicbb 
CsvFilebb 
(bb 
)bb 
{cc 	
}dd 	
publicff 
CsvFileff 
(ff 
CsvDestinationff %
csvDestinationff& 4
,ff4 5
CsvDefinitionff6 C
csvDefinitionffD Q
)ffQ R
{gg 	
ifhh 
(hh 
csvDefinitionhh 
==hh  
nullhh! %
)hh% &
csvDefinitionii 
=ii  
DefaultCsvDefinitionii  4
;ii4 5
thisjj 
.jj 
_columnsjj 
=jj 
(jj 
csvDefinitionjj *
.jj* +
Columnsjj+ 2
??jj3 5
InferColumnsjj6 B
(jjB C
typeofjjC I
(jjI J
TjjJ K
)jjK L
)jjL M
)jjM N
.jjN O
ToArrayjjO V
(jjV W
)jjW X
;jjX Y
thiskk 
.kk 
_fieldSeparatorkk  
=kk! "
csvDefinitionkk# 0
.kk0 1
FieldSeparatorkk1 ?
;kk? @
thisll 
.ll #
_fieldSeparatorAsStringll (
=ll) *
thisll+ /
.ll/ 0
_fieldSeparatorll0 ?
.ll? @
ToStringll@ H
(llH I
CultureInfollI T
.llT U
InvariantCulturellU e
)lle f
;llf g
thismm 
.mm 
_textQualifiermm 
=mm  !
csvDefinitionmm" /
.mm/ 0
TextQualifiermm0 =
;mm= >
thisnn 
.nn 
_streamWriternn 
=nn  
csvDestinationnn! /
.nn/ 0
StreamWriternn0 <
;nn< =
thispp 
.pp !
_invalidCharsInFieldspp &
=pp' (
newpp) ,
[pp, -
]pp- .
{pp/ 0
$charpp1 5
,pp5 6
$charpp7 ;
,pp; <
thispp= A
.ppA B
_textQualifierppB P
,ppP Q
thisppR V
.ppV W
_fieldSeparatorppW f
}ppg h
;pph i
thisqq 
.qq "
_isInvalidCharInFieldsqq '
=qq( )
newqq* -
boolqq. 2
[qq2 3
$numqq3 6
]qq6 7
;qq7 8
foreachss 
(ss 
varss 
css 
inss 
thisss "
.ss" #!
_invalidCharsInFieldsss# 8
)ss8 9
{tt 
thisuu 
.uu "
_isInvalidCharInFieldsuu +
[uu+ ,
cuu, -
]uu- .
=uu/ 0
trueuu1 5
;uu5 6
}vv 
thisww 
.ww 
WriteHeaderww 
(ww 
)ww 
;ww 
thisyy 
.yy 
CreateGettersyy 
(yy 
)yy  
;yy  !
if{{ 
({{ 
CsvFile{{ 
.{{ 
UseTasks{{  
){{  !
{|| 
_writeCsvLinesTask}} "
=}}# $
new}}% (
Thread}}) /
(}}/ 0
(}}0 1
o}}1 2
)}}2 3
=>}}4 6
this}}7 ;
.}}; <
WriteCsvLines}}< I
(}}I J
)}}J K
)}}K L
;}}L M
_writeCsvLinesTask~~ "
.~~" #
Start~~# (
(~~( )
)~~) *
;~~* +
} 
this
ÄÄ 
.
ÄÄ 
_addAsyncTask
ÄÄ 
=
ÄÄ  
Task
ÄÄ! %
.
ÄÄ% &
Factory
ÄÄ& -
.
ÄÄ- .
StartNew
ÄÄ. 6
(
ÄÄ6 7
(
ÄÄ7 8
)
ÄÄ8 9
=>
ÄÄ: <
{
ÄÄ= >
}
ÄÄ? @
)
ÄÄ@ A
;
ÄÄA B
}
ÑÑ 	
	protected
ÜÜ 
override
ÜÜ 
void
ÜÜ 
Dispose
ÜÜ  '
(
ÜÜ' (
bool
ÜÜ( ,
	disposing
ÜÜ- 6
)
ÜÜ6 7
{
áá 	
if
àà 
(
àà 
	disposing
àà 
)
àà 
{
ââ 
_addAsyncTask
çç 
.
çç 
Wait
çç "
(
çç" #
)
çç# $
;
çç$ %
if
éé 
(
éé 
_csvLinesToWrite
éé $
!=
éé% '
null
éé( ,
)
éé, -
{
èè 
_csvLinesToWrite
êê $
.
êê$ %
CompleteAdding
êê% 3
(
êê3 4
)
êê4 5
;
êê5 6
}
ëë 
if
íí 
(
íí  
_writeCsvLinesTask
íí &
!=
íí' )
null
íí* .
)
íí. / 
_writeCsvLinesTask
ìì &
.
ìì& '
Join
ìì' +
(
ìì+ ,
)
ìì, -
;
ìì- .
this
ïï 
.
ïï 
_streamWriter
ïï "
.
ïï" #
Close
ïï# (
(
ïï( )
)
ïï) *
;
ïï* +
}
ññ 
}
óó 	
	protected
ôô 
static
ôô 
IEnumerable
ôô $
<
ôô$ %
string
ôô% +
>
ôô+ ,
InferColumns
ôô- 9
(
ôô9 :
Type
ôô: >

recordType
ôô? I
)
ôôI J
{
öö 	
var
õõ 
columns
õõ 
=
õõ 

recordType
õõ $
.
úú 
GetProperties
úú 
(
úú 
BindingFlags
úú +
.
úú+ ,
Public
úú, 2
|
úú3 4
BindingFlags
úú5 A
.
úúA B
Instance
úúB J
)
úúJ K
.
ùù 
Where
ùù 
(
ùù 
pi
ùù 
=>
ùù 
pi
ùù 
.
ùù   
GetIndexParameters
ùù  2
(
ùù2 3
)
ùù3 4
.
ùù4 5
Length
ùù5 ;
==
ùù< >
$num
ùù? @
&&
ûû 
pi
ûû 
.
ûû 
GetSetMethod
ûû &
(
ûû& '
)
ûû' (
!=
ûû) +
null
ûû, 0
&&
üü 
!
üü 
	Attribute
üü !
.
üü! "
	IsDefined
üü" +
(
üü+ ,
pi
üü, .
,
üü. /
typeof
üü0 6
(
üü6 7(
CsvIgnorePropertyAttribute
üü7 Q
)
üüQ R
)
üüR S
)
üüS T
.
†† 
Select
†† 
(
†† 
pi
†† 
=>
†† 
pi
††  
.
††  !
Name
††! %
)
††% &
.
°° 
Concat
°° 
(
°° 

recordType
°° "
.
¢¢ 
	GetFields
¢¢ 
(
¢¢ 
BindingFlags
¢¢ +
.
¢¢+ ,
Public
¢¢, 2
|
¢¢3 4
BindingFlags
¢¢5 A
.
¢¢A B
Instance
¢¢B J
)
¢¢J K
.
££ 
Where
££ 
(
££ 
fi
££ 
=>
££  
!
££! "
	Attribute
££" +
.
££+ ,
	IsDefined
££, 5
(
££5 6
fi
££6 8
,
££8 9
typeof
££: @
(
££@ A(
CsvIgnorePropertyAttribute
££A [
)
££[ \
)
££\ ]
)
££] ^
.
§§ 
Select
§§ 
(
§§ 
fi
§§ 
=>
§§ !
fi
§§" $
.
§§$ %
Name
§§% )
)
§§) *
)
§§* +
.
•• 
ToList
•• 
(
•• 
)
•• 
;
•• 
return
¶¶ 
columns
¶¶ 
;
¶¶ 
}
ßß 	
private
™™ 
void
™™ 
WriteCsvLines
™™ "
(
™™" #
)
™™# $
{
´´ 	
int
¨¨ 
written
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
csvLine
≠≠  
in
≠≠! #
_csvLinesToWrite
≠≠$ 4
.
≠≠4 5$
GetConsumingEnumerable
≠≠5 K
(
≠≠K L
)
≠≠L M
)
≠≠M N
{
ÆÆ 
this
ØØ 
.
ØØ 
_streamWriter
ØØ "
.
ØØ" #
	WriteLine
ØØ# ,
(
ØØ, -
csvLine
ØØ- 4
)
ØØ4 5
;
ØØ5 6
written
∞∞ 
++
∞∞ 
;
∞∞ 
}
±± 
Interlocked
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
ref
≤≤ 
this
≤≤  $
.
≤≤$ %
_linesToWrite
≤≤% 2
,
≤≤2 3
-
≤≤4 5
written
≤≤5 <
)
≤≤< =
;
≤≤= >
}
≥≥ 	
public
∑∑ 
void
∑∑ 
Append
∑∑ 
(
∑∑ 
T
∑∑ 
record
∑∑ #
)
∑∑# $
{
∏∏ 	
if
∫∫ 
(
∫∫ 
CsvFile
∫∫ 
.
∫∫ 
UseTasks
∫∫  
)
∫∫  !
{
ªª 
var
ææ 
linesWaiting
ææ  
=
ææ! "
Interlocked
ææ# .
.
ææ. /
	Increment
ææ/ 8
(
ææ8 9
ref
ææ9 <
this
ææ= A
.
ææA B
_linesToWrite
ææB O
)
ææO P
;
ææP Q
Action
øø 
<
øø 
Task
øø 
>
øø 
	addRecord
øø &
=
øø' (
(
øø) *
t
øø* +
)
øø+ ,
=>
øø- /
{
¿¿ 
var
¡¡ 
csvLine
¡¡ 
=
¡¡  !
this
¡¡" &
.
¡¡& '
ToCsv
¡¡' ,
(
¡¡, -
record
¡¡- 3
)
¡¡3 4
;
¡¡4 5
this
¬¬ 
.
¬¬ 
_csvLinesToWrite
¬¬ )
.
¬¬) *
Add
¬¬* -
(
¬¬- .
csvLine
¬¬. 5
)
¬¬5 6
;
¬¬6 7
}
√√ 
;
√√ 
if
≈≈ 
(
≈≈ 
linesWaiting
≈≈  
<
≈≈! "
$num
≈≈# (
)
≈≈( )
this
∆∆ 
.
∆∆ 
_addAsyncTask
∆∆ &
=
∆∆' (
this
∆∆) -
.
∆∆- .
_addAsyncTask
∆∆. ;
.
∆∆; <
ContinueWith
∆∆< H
(
∆∆H I
	addRecord
∆∆I R
)
∆∆R S
;
∆∆S T
else
«« 
	addRecord
»» 
(
»» 
null
»» "
)
»»" #
;
»»# $
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
var
œœ 
csvLine
œœ 
=
œœ 
this
œœ "
.
œœ" #
ToCsv
œœ# (
(
œœ( )
record
œœ) /
)
œœ/ 0
;
œœ0 1
this
–– 
.
–– 
_streamWriter
–– "
.
––" #
	WriteLine
––# ,
(
––, -
csvLine
––- 4
)
––4 5
;
––5 6
}
—— 
}
““ 	
private
‘‘ 
static
‘‘ 
Func
‘‘ 
<
‘‘ 
T
‘‘ 
,
‘‘ 
object
‘‘ %
>
‘‘% &

FindGetter
‘‘' 1
(
‘‘1 2
string
‘‘2 8
c
‘‘9 :
,
‘‘: ;
bool
‘‘< @
staticMember
‘‘A M
)
‘‘M N
{
’’ 	
var
÷÷ 
flags
÷÷ 
=
÷÷ 
BindingFlags
÷÷ $
.
÷÷$ %
Public
÷÷% +
|
÷÷, -
BindingFlags
÷÷. :
.
÷÷: ;
	NonPublic
÷÷; D
|
÷÷E F
BindingFlags
÷÷G S
.
÷÷S T

IgnoreCase
÷÷T ^
|
÷÷_ `
(
÷÷a b
staticMember
÷÷b n
?
÷÷o p
BindingFlags
÷÷q }
.
÷÷} ~
Static÷÷~ Ñ
:÷÷Ö Ü
BindingFlags÷÷á ì
.÷÷ì î
Instance÷÷î ú
)÷÷ú ù
;÷÷ù û
Func
◊◊ 
<
◊◊ 
T
◊◊ 
,
◊◊ 
object
◊◊ 
>
◊◊ 
func
◊◊  
=
◊◊! "
null
◊◊# '
;
◊◊' (
PropertyInfo
ÿÿ 
pi
ÿÿ 
=
ÿÿ 
typeof
ÿÿ $
(
ÿÿ$ %
T
ÿÿ% &
)
ÿÿ& '
.
ÿÿ' (
GetProperty
ÿÿ( 3
(
ÿÿ3 4
c
ÿÿ4 5
,
ÿÿ5 6
flags
ÿÿ7 <
)
ÿÿ< =
;
ÿÿ= >
	FieldInfo
ŸŸ 
fi
ŸŸ 
=
ŸŸ 
typeof
ŸŸ !
(
ŸŸ! "
T
ŸŸ" #
)
ŸŸ# $
.
ŸŸ$ %
GetField
ŸŸ% -
(
ŸŸ- .
c
ŸŸ. /
,
ŸŸ/ 0
flags
ŸŸ1 6
)
ŸŸ6 7
;
ŸŸ7 8
if
€€ 
(
€€ 
CsvFile
€€ 
.
€€ 

UseLambdas
€€ "
)
€€" #
{
‹‹ 

Expression
›› 
expr
›› 
=
››  !
null
››" &
;
››& '!
ParameterExpression
ﬁﬁ #
	parameter
ﬁﬁ$ -
=
ﬁﬁ. /

Expression
ﬁﬁ0 :
.
ﬁﬁ: ;
	Parameter
ﬁﬁ; D
(
ﬁﬁD E
typeof
ﬁﬁE K
(
ﬁﬁK L
T
ﬁﬁL M
)
ﬁﬁM N
,
ﬁﬁN O
$str
ﬁﬁP S
)
ﬁﬁS T
;
ﬁﬁT U
Type
ﬂﬂ 
type
ﬂﬂ 
=
ﬂﬂ 
null
ﬂﬂ  
;
ﬂﬂ  !
if
·· 
(
·· 
pi
·· 
!=
·· 
null
·· 
)
·· 
{
‚‚ 
type
„„ 
=
„„ 
pi
„„ 
.
„„ 
PropertyType
„„ *
;
„„* +
expr
‰‰ 
=
‰‰ 

Expression
‰‰ %
.
‰‰% &
Property
‰‰& .
(
‰‰. /
	parameter
‰‰/ 8
,
‰‰8 9
pi
‰‰: <
.
‰‰< =
Name
‰‰= A
)
‰‰A B
;
‰‰B C
}
ÂÂ 
else
ÊÊ 
if
ÊÊ 
(
ÊÊ 
fi
ÊÊ 
!=
ÊÊ 
null
ÊÊ #
)
ÊÊ# $
{
ÁÁ 
type
ËË 
=
ËË 
fi
ËË 
.
ËË 
	FieldType
ËË '
;
ËË' (
expr
ÈÈ 
=
ÈÈ 

Expression
ÈÈ %
.
ÈÈ% &
Field
ÈÈ& +
(
ÈÈ+ ,
	parameter
ÈÈ, 5
,
ÈÈ5 6
fi
ÈÈ7 9
.
ÈÈ9 :
Name
ÈÈ: >
)
ÈÈ> ?
;
ÈÈ? @
}
ÍÍ 
if
ÎÎ 
(
ÎÎ 
expr
ÎÎ 
!=
ÎÎ 
null
ÎÎ  
)
ÎÎ  !
{
ÏÏ 

Expression
ÌÌ 
<
ÌÌ 
Func
ÌÌ #
<
ÌÌ# $
T
ÌÌ$ %
,
ÌÌ% &
object
ÌÌ' -
>
ÌÌ- .
>
ÌÌ. /
lambda
ÌÌ0 6
;
ÌÌ6 7
if
ÓÓ 
(
ÓÓ 
type
ÓÓ 
.
ÓÓ 
IsValueType
ÓÓ (
)
ÓÓ( )
{
ÔÔ 
lambda
 
=
  

Expression
! +
.
+ ,
Lambda
, 2
<
2 3
Func
3 7
<
7 8
T
8 9
,
9 :
object
; A
>
A B
>
B C
(
C D

Expression
D N
.
N O
TypeAs
O U
(
U V
expr
V Z
,
Z [
typeof
\ b
(
b c
object
c i
)
i j
)
j k
,
k l
	parameter
m v
)
v w
;
w x
}
ÒÒ 
else
ÚÚ 
{
ÛÛ 
lambda
ÙÙ 
=
ÙÙ  

Expression
ÙÙ! +
.
ÙÙ+ ,
Lambda
ÙÙ, 2
<
ÙÙ2 3
Func
ÙÙ3 7
<
ÙÙ7 8
T
ÙÙ8 9
,
ÙÙ9 :
object
ÙÙ; A
>
ÙÙA B
>
ÙÙB C
(
ÙÙC D
expr
ÙÙD H
,
ÙÙH I
	parameter
ÙÙJ S
)
ÙÙS T
;
ÙÙT U
}
ıı 
func
ˆˆ 
=
ˆˆ 
lambda
ˆˆ !
.
ˆˆ! "
Compile
ˆˆ" )
(
ˆˆ) *
)
ˆˆ* +
;
ˆˆ+ ,
}
˜˜ 
}
¯¯ 
else
˘˘ 
{
˙˙ 
if
˚˚ 
(
˚˚ 
pi
˚˚ 
!=
˚˚ 
null
˚˚ 
)
˚˚ 
func
¸¸ 
=
¸¸ 
o
¸¸ 
=>
¸¸ 
pi
¸¸  "
.
¸¸" #
GetValue
¸¸# +
(
¸¸+ ,
o
¸¸, -
,
¸¸- .
null
¸¸/ 3
)
¸¸3 4
;
¸¸4 5
else
˝˝ 
if
˝˝ 
(
˝˝ 
fi
˝˝ 
!=
˝˝ 
null
˝˝ #
)
˝˝# $
func
˛˛ 
=
˛˛ 
o
˛˛ 
=>
˛˛ 
fi
˛˛  "
.
˛˛" #
GetValue
˛˛# +
(
˛˛+ ,
o
˛˛, -
)
˛˛- .
;
˛˛. /
}
ˇˇ 
return
ÄÄ 
func
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
void
ÉÉ 
CreateGetters
ÉÉ "
(
ÉÉ" #
)
ÉÉ# $
{
ÑÑ 	
var
ÖÖ 
list
ÖÖ 
=
ÖÖ 
new
ÖÖ 
List
ÖÖ 
<
ÖÖ  
Func
ÖÖ  $
<
ÖÖ$ %
T
ÖÖ% &
,
ÖÖ& '
object
ÖÖ( .
>
ÖÖ. /
>
ÖÖ/ 0
(
ÖÖ0 1
)
ÖÖ1 2
;
ÖÖ2 3
foreach
áá 
(
áá 
var
áá 

columnName
áá #
in
áá$ &
_columns
áá' /
)
áá/ 0
{
àà 
Func
ââ 
<
ââ 
T
ââ 
,
ââ 
Object
ââ 
>
ââ 
func
ââ  $
=
ââ% &
null
ââ' +
;
ââ+ ,
var
ää 
propertyName
ää  
=
ää! "
(
ää# $

columnName
ää$ .
.
ää. /
IndexOf
ää/ 6
(
ää6 7
$char
ää7 :
)
ää: ;
<
ää< =
$num
ää> ?
?
ää@ A

columnName
ääB L
:
ääM N

columnName
ääO Y
.
ääY Z
Replace
ääZ a
(
ääa b
$str
ääb e
,
ääe f
$str
ääg i
)
ääi j
)
ääj k
;
ääk l
func
ãã 
=
ãã 

FindGetter
ãã !
(
ãã! "

columnName
ãã" ,
,
ãã, -
false
ãã. 3
)
ãã3 4
??
ãã5 7

FindGetter
ãã8 B
(
ããB C

columnName
ããC M
,
ããM N
true
ããO S
)
ããS T
;
ããT U
list
çç 
.
çç 
Add
çç 
(
çç 
func
çç 
)
çç 
;
çç 
}
éé 
this
èè 
.
èè 
_getters
èè 
=
èè 
list
èè  
.
èè  !
ToArray
èè! (
(
èè( )
)
èè) *
;
èè* +
}
êê 	
private
íí 
string
íí 
ToCsv
íí 
(
íí 
T
íí 
record
íí %
)
íí% &
{
ìì 	
if
îî 
(
îî 
record
îî 
==
îî 
null
îî 
)
îî 
throw
ïï 
new
ïï 
AdsException
ïï &
(
ïï& '
$str
ïï' 7
,
ïï7 8
$str
ïï9 A
)
ïïA B
;
ïïB C
string
óó 
[
óó 
]
óó 

csvStrings
óó 
=
óó  !
new
óó" %
string
óó& ,
[
óó, -
_getters
óó- 5
.
óó5 6
Length
óó6 <
]
óó< =
;
óó= >
for
ôô 
(
ôô 
int
ôô 
i
ôô 
=
ôô 
$num
ôô 
;
ôô 
i
ôô 
<
ôô 
_getters
ôô  (
.
ôô( )
Length
ôô) /
;
ôô/ 0
i
ôô1 2
++
ôô2 4
)
ôô4 5
{
öö 
var
õõ 
getter
õõ 
=
õõ 
_getters
õõ %
[
õõ% &
i
õõ& '
]
õõ' (
;
õõ( )
object
úú 

fieldValue
úú !
=
úú" #
getter
úú$ *
==
úú+ -
null
úú. 2
?
úú3 4
null
úú5 9
:
úú: ;
getter
úú< B
(
úúB C
record
úúC I
)
úúI J
;
úúJ K

csvStrings
ùù 
[
ùù 
i
ùù 
]
ùù 
=
ùù 
this
ùù  $
.
ùù$ %
ToCsvString
ùù% 0
(
ùù0 1

fieldValue
ùù1 ;
)
ùù; <
;
ùù< =
}
ûû 
return
üü 
string
üü 
.
üü 
Join
üü 
(
üü 
this
üü #
.
üü# $%
_fieldSeparatorAsString
üü$ ;
,
üü; <

csvStrings
üü= G
)
üüG H
;
üüH I
}
°° 	
private
££ 
string
££ 
ToCsvString
££ "
(
££" #
object
££# )
o
££* +
)
££+ ,
{
§§ 	
if
•• 
(
•• 
o
•• 
!=
•• 
null
•• 
)
•• 
{
¶¶ 
string
ßß 
valueString
ßß "
=
ßß# $
o
ßß% &
as
ßß' )
string
ßß* 0
??
ßß1 3
Convert
ßß4 ;
.
ßß; <
ToString
ßß< D
(
ßßD E
o
ßßE F
,
ßßF G
CultureInfo
ßßH S
.
ßßS T
CurrentUICulture
ßßT d
)
ßßd e
;
ßße f
if
®® 
(
®® 
RequiresQuotes
®® "
(
®®" #
valueString
®®# .
)
®®. /
)
®®/ 0
{
©© 
var
™™ 
csvLine
™™ 
=
™™  !
new
™™" %
StringBuilder
™™& 3
(
™™3 4
)
™™4 5
;
™™5 6
csvLine
´´ 
.
´´ 
Append
´´ "
(
´´" #
this
´´# '
.
´´' (
_textQualifier
´´( 6
)
´´6 7
;
´´7 8
foreach
¨¨ 
(
¨¨ 
char
¨¨ !
c
¨¨" #
in
¨¨$ &
valueString
¨¨' 2
)
¨¨2 3
{
≠≠ 
if
ÆÆ 
(
ÆÆ 
c
ÆÆ 
==
ÆÆ  
this
ÆÆ! %
.
ÆÆ% &
_textQualifier
ÆÆ& 4
)
ÆÆ4 5
csvLine
ØØ #
.
ØØ# $
Append
ØØ$ *
(
ØØ* +
c
ØØ+ ,
)
ØØ, -
;
ØØ- .
csvLine
±± 
.
±±  
Append
±±  &
(
±±& '
c
±±' (
)
±±( )
;
±±) *
}
≤≤ 
csvLine
≥≥ 
.
≥≥ 
Append
≥≥ "
(
≥≥" #
this
≥≥# '
.
≥≥' (
_textQualifier
≥≥( 6
)
≥≥6 7
;
≥≥7 8
return
¥¥ 
csvLine
¥¥ "
.
¥¥" #
ToString
¥¥# +
(
¥¥+ ,
)
¥¥, -
;
¥¥- .
}
µµ 
else
∂∂ 
return
∑∑ 
valueString
∑∑ &
;
∑∑& '
}
∏∏ 
return
ππ 
string
ππ 
.
ππ 
Empty
ππ 
;
ππ  
}
∫∫ 	
private
ºº 
bool
ºº 
RequiresQuotes
ºº #
(
ºº# $
string
ºº$ *
valueString
ºº+ 6
)
ºº6 7
{
ΩΩ 	
if
ææ 
(
ææ 
CsvFile
ææ 
.
ææ 
FastIndexOfAny
ææ &
)
ææ& '
{
øø 
var
¿¿ 
len
¿¿ 
=
¿¿ 
valueString
¿¿ %
.
¿¿% &
Length
¿¿& ,
;
¿¿, -
for
¡¡ 
(
¡¡ 
int
¡¡ 
i
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
i
¡¡  !
<
¡¡" #
len
¡¡$ '
;
¡¡' (
i
¡¡) *
++
¡¡* ,
)
¡¡, -
{
¬¬ 
char
√√ 
c
√√ 
=
√√ 
valueString
√√ (
[
√√( )
i
√√) *
]
√√* +
;
√√+ ,
if
ƒƒ 
(
ƒƒ 
c
ƒƒ 
<=
ƒƒ 
$num
ƒƒ  
&&
ƒƒ! #
this
ƒƒ$ (
.
ƒƒ( )$
_isInvalidCharInFields
ƒƒ) ?
[
ƒƒ? @
c
ƒƒ@ A
]
ƒƒA B
)
ƒƒB C
return
≈≈ 
true
≈≈ #
;
≈≈# $
}
∆∆ 
return
«« 
false
«« 
;
«« 
}
»» 
else
…… 
{
   
return
ÀÀ 
valueString
ÀÀ "
.
ÀÀ" #

IndexOfAny
ÀÀ# -
(
ÀÀ- .
this
ÀÀ. 2
.
ÀÀ2 3#
_invalidCharsInFields
ÀÀ3 H
)
ÀÀH I
>=
ÀÀJ L
$num
ÀÀM N
;
ÀÀN O
}
ÃÃ 
}
ÕÕ 	
private
œœ 
void
œœ 
WriteHeader
œœ  
(
œœ  !
)
œœ! "
{
–– 	
var
—— 
csvLine
—— 
=
—— 
new
—— 
StringBuilder
—— +
(
——+ ,
)
——, -
;
——- .
for
““ 
(
““ 
int
““ 
i
““ 
=
““ 
$num
““ 
;
““ 
i
““ 
<
““ 
this
““  $
.
““$ %
_columns
““% -
.
““- .
Length
““. 4
;
““4 5
i
““6 7
++
““7 9
)
““9 :
{
”” 
if
‘‘ 
(
‘‘ 
i
‘‘ 
>
‘‘ 
$num
‘‘ 
)
‘‘ 
csvLine
’’ 
.
’’ 
Append
’’ "
(
’’" #
this
’’# '
.
’’' (
_fieldSeparator
’’( 7
)
’’7 8
;
’’8 9
csvLine
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
this
÷÷ #
.
÷÷# $
ToCsvString
÷÷$ /
(
÷÷/ 0
this
÷÷0 4
.
÷÷4 5
_columns
÷÷5 =
[
÷÷= >
i
÷÷> ?
]
÷÷? @
)
÷÷@ A
)
÷÷A B
;
÷÷B C
}
◊◊ 
this
ÿÿ 
.
ÿÿ 
_streamWriter
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ (
(
ÿÿ( )
csvLine
ÿÿ) 0
.
ÿÿ0 1
ToString
ÿÿ1 9
(
ÿÿ9 :
)
ÿÿ: ;
)
ÿÿ; <
;
ÿÿ< =
}
ŸŸ 	
}
⁄⁄ 
internal
‹‹ 
class
‹‹ 
CsvFileReader
‹‹  
<
‹‹  !
T
‹‹! "
>
‹‹" #
:
‹‹$ %
CsvFile
‹‹& -
,
‹‹- .
IEnumerable
‹‹/ :
<
‹‹: ;
T
‹‹; <
>
‹‹< =
,
‹‹= >
IEnumerator
‹‹? J
<
‹‹J K
T
‹‹K L
>
‹‹L M
where
›› 

T
›› 
:
›› 
new
›› 
(
›› 
)
›› 
{
ﬁﬁ 
private
ﬂﬂ 
readonly
ﬂﬂ 

Dictionary
ﬂﬂ #
<
ﬂﬂ# $
Type
ﬂﬂ$ (
,
ﬂﬂ( )
List
ﬂﬂ* .
<
ﬂﬂ. /
Action
ﬂﬂ/ 5
<
ﬂﬂ5 6
T
ﬂﬂ6 7
,
ﬂﬂ7 8
String
ﬂﬂ9 ?
>
ﬂﬂ? @
>
ﬂﬂ@ A
>
ﬂﬂA B
_allSetters
ﬂﬂC N
=
ﬂﬂO P
new
ﬂﬂQ T

Dictionary
ﬂﬂU _
<
ﬂﬂ_ `
Type
ﬂﬂ` d
,
ﬂﬂd e
List
ﬂﬂf j
<
ﬂﬂj k
Action
ﬂﬂk q
<
ﬂﬂq r
T
ﬂﬂr s
,
ﬂﬂs t
String
ﬂﬂu {
>
ﬂﬂ{ |
>
ﬂﬂ| }
>
ﬂﬂ} ~
(
ﬂﬂ~ 
)ﬂﬂ Ä
;ﬂﬂÄ Å
private
‡‡ 
string
‡‡ 
[
‡‡ 
]
‡‡ 
_columns
‡‡ !
;
‡‡! "
private
·· 
char
·· 
_curChar
·· 
;
·· 
private
‚‚ 
int
‚‚ 
_len
‚‚ 
;
‚‚ 
private
„„ 
string
„„ 
_line
„„ 
;
„„ 
private
‰‰ 
int
‰‰ 
_pos
‰‰ 
;
‰‰ 
private
ÂÂ 
T
ÂÂ 
_record
ÂÂ 
;
ÂÂ 
private
ÊÊ 
readonly
ÊÊ 
char
ÊÊ 
_fieldSeparator
ÊÊ -
;
ÊÊ- .
private
ÁÁ 
readonly
ÁÁ 

TextReader
ÁÁ #
_textReader
ÁÁ$ /
;
ÁÁ/ 0
private
ËË 
readonly
ËË 
char
ËË 
_textQualifier
ËË ,
;
ËË, -
private
ÈÈ 
readonly
ÈÈ 
StringBuilder
ÈÈ &
_parseFieldResult
ÈÈ' 8
=
ÈÈ9 :
new
ÈÈ; >
StringBuilder
ÈÈ? L
(
ÈÈL M
)
ÈÈM N
;
ÈÈN O
public
ÎÎ 
CsvFileReader
ÎÎ 
(
ÎÎ 
	CsvSource
ÎÎ &
	csvSource
ÎÎ' 0
)
ÎÎ0 1
:
ÏÏ 
this
ÏÏ 
(
ÏÏ 
	csvSource
ÏÏ 
,
ÏÏ 
null
ÏÏ "
)
ÏÏ" #
{
ÌÌ 	
}
ÓÓ 	
public
 
CsvFileReader
 
(
 
	CsvSource
 &
	csvSource
' 0
,
0 1
CsvDefinition
2 ?
csvDefinition
@ M
)
M N
{
ÒÒ 	
var
ÚÚ 
streamReader
ÚÚ 
=
ÚÚ 
	csvSource
ÚÚ (
.
ÚÚ( )

TextReader
ÚÚ) 3
as
ÚÚ4 6
StreamReader
ÚÚ7 C
;
ÚÚC D
if
ÛÛ 
(
ÛÛ 
streamReader
ÛÛ 
!=
ÛÛ 
null
ÛÛ  $
)
ÛÛ$ %
this
ÙÙ 
.
ÙÙ 

BaseStream
ÙÙ 
=
ÙÙ  !
streamReader
ÙÙ" .
.
ÙÙ. /

BaseStream
ÙÙ/ 9
;
ÙÙ9 :
if
ıı 
(
ıı 
csvDefinition
ıı 
==
ıı  
null
ıı! %
)
ıı% &
csvDefinition
ˆˆ 
=
ˆˆ "
DefaultCsvDefinition
ˆˆ  4
;
ˆˆ4 5
this
˜˜ 
.
˜˜ 
_fieldSeparator
˜˜  
=
˜˜! "
csvDefinition
˜˜# 0
.
˜˜0 1
FieldSeparator
˜˜1 ?
;
˜˜? @
this
¯¯ 
.
¯¯ 
_textQualifier
¯¯ 
=
¯¯  !
csvDefinition
¯¯" /
.
¯¯/ 0
TextQualifier
¯¯0 =
;
¯¯= >
this
˙˙ 
.
˙˙ 
_textReader
˙˙ 
=
˙˙ 
	csvSource
˙˙ (
.
˙˙( )

TextReader
˙˙) 3
;
˙˙3 4
this
˝˝ 
.
˝˝ 

ReadHeader
˝˝ 
(
˝˝ 
csvDefinition
˝˝ )
.
˝˝) *
Header
˝˝* 0
)
˝˝0 1
;
˝˝1 2
}
ˇˇ 	
public
ÅÅ 
T
ÅÅ 
Current
ÅÅ 
{
ÇÇ 	
get
ÉÉ 
{
ÉÉ 
return
ÉÉ 
this
ÉÉ 
.
ÉÉ 
_record
ÉÉ %
;
ÉÉ% &
}
ÉÉ' (
}
ÑÑ 	
public
ÜÜ 
bool
ÜÜ 
Eof
ÜÜ 
{
áá 	
get
àà 
{
àà 
return
àà 
this
àà 
.
àà 
_line
àà #
==
àà$ &
null
àà' +
;
àà+ ,
}
àà- .
}
ââ 	
object
ãã 
IEnumerator
ãã 
.
ãã 
Current
ãã "
{
åå 	
get
çç 
{
çç 
return
çç 
this
çç 
.
çç 
Current
çç %
;
çç% &
}
çç' (
}
éé 	
	protected
êê 
override
êê 
void
êê 
Dispose
êê  '
(
êê' (
bool
êê( ,
	disposing
êê- 6
)
êê6 7
{
ëë 	
if
íí 
(
íí 
	disposing
íí 
)
íí 
{
ìì 
this
ññ 
.
ññ 
_textReader
ññ  
.
ññ  !
Dispose
ññ! (
(
ññ( )
)
ññ) *
;
ññ* +
}
óó 
}
òò 	
IEnumerator
öö 
IEnumerable
öö 
.
öö  
GetEnumerator
öö  -
(
öö- .
)
öö. /
{
õõ 	
return
úú 
this
úú 
.
úú 
GetEnumerator
úú %
(
úú% &
)
úú& '
;
úú' (
}
ùù 	
public
üü 
IEnumerator
üü 
<
üü 
T
üü 
>
üü 
GetEnumerator
üü +
(
üü+ ,
)
üü, -
{
†† 	
return
°° 
this
°° 
;
°° 
}
¢¢ 	
public
§§ 
bool
§§ 
MoveNext
§§ 
(
§§ 
)
§§ 
{
•• 	
this
¶¶ 
.
¶¶ 
ReadNextLine
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶  
if
ßß 
(
ßß 
this
ßß 
.
ßß 
_line
ßß 
==
ßß 
null
ßß "
&&
ßß# %
(
ßß& '
this
ßß' +
.
ßß+ ,
_line
ßß, 1
=
ßß2 3
this
ßß4 8
.
ßß8 9
_textReader
ßß9 D
.
ßßD E
ReadLine
ßßE M
(
ßßM N
)
ßßN O
)
ßßO P
==
ßßQ S
null
ßßT X
)
ßßX Y
{
®® 
this
©© 
.
©© 
_record
©© 
=
©© 
default
©© &
(
©©& '
T
©©' (
)
©©( )
;
©©) *
}
™™ 
else
´´ 
{
¨¨ 
this
≠≠ 
.
≠≠ 
_record
≠≠ 
=
≠≠ 
new
≠≠ "
T
≠≠# $
(
≠≠$ %
)
≠≠% &
;
≠≠& '
Type
ÆÆ 

recordType
ÆÆ 
=
ÆÆ  !
typeof
ÆÆ" (
(
ÆÆ( )
T
ÆÆ) *
)
ÆÆ* +
;
ÆÆ+ ,
List
ØØ 
<
ØØ 
Action
ØØ 
<
ØØ 
T
ØØ 
,
ØØ 
String
ØØ %
>
ØØ% &
>
ØØ& '
setters
ØØ( /
;
ØØ/ 0
if
∞∞ 
(
∞∞ 
!
∞∞ 
this
∞∞ 
.
∞∞ 
_allSetters
∞∞ %
.
∞∞% &
TryGetValue
∞∞& 1
(
∞∞1 2

recordType
∞∞2 <
,
∞∞< =
out
∞∞> A
setters
∞∞B I
)
∞∞I J
)
∞∞J K
{
±± 
setters
≤≤ 
=
≤≤ 
this
≤≤ "
.
≤≤" #
CreateSetters
≤≤# 0
(
≤≤0 1
)
≤≤1 2
;
≤≤2 3
this
≥≥ 
.
≥≥ 
_allSetters
≥≥ $
[
≥≥$ %

recordType
≥≥% /
]
≥≥/ 0
=
≥≥1 2
setters
≥≥3 :
;
≥≥: ;
}
¥¥ 
var
∂∂ 
fieldValues
∂∂ 
=
∂∂  !
new
∂∂" %
string
∂∂& ,
[
∂∂, -
setters
∂∂- 4
.
∂∂4 5
Count
∂∂5 :
]
∂∂: ;
;
∂∂; <
for
∑∑ 
(
∑∑ 
int
∑∑ 
i
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
i
∑∑  !
<
∑∑" #
setters
∑∑$ +
.
∑∑+ ,
Count
∑∑, 1
;
∑∑1 2
i
∑∑3 4
++
∑∑4 6
)
∑∑6 7
{
∏∏ 
fieldValues
ππ 
[
ππ  
i
ππ  !
]
ππ! "
=
ππ# $
this
ππ% )
.
ππ) *

ParseField
ππ* 4
(
ππ4 5
)
ππ5 6
;
ππ6 7
if
∫∫ 
(
∫∫ 
this
∫∫ 
.
∫∫ 
_curChar
∫∫ %
==
∫∫& (
this
∫∫) -
.
∫∫- .
_fieldSeparator
∫∫. =
)
∫∫= >
this
ªª 
.
ªª 
NextChar
ªª %
(
ªª% &
)
ªª& '
;
ªª' (
else
ºº 
break
ΩΩ 
;
ΩΩ 
}
ææ 
for
øø 
(
øø 
int
øø 
i
øø 
=
øø 
$num
øø 
;
øø 
i
øø  !
<
øø" #
setters
øø$ +
.
øø+ ,
Count
øø, 1
;
øø1 2
i
øø3 4
++
øø4 6
)
øø6 7
{
¿¿ 
var
¡¡ 
setter
¡¡ 
=
¡¡  
setters
¡¡! (
[
¡¡( )
i
¡¡) *
]
¡¡* +
;
¡¡+ ,
if
¬¬ 
(
¬¬ 
setter
¬¬ 
!=
¬¬ !
null
¬¬" &
)
¬¬& '
{
√√ 
setter
ƒƒ 
(
ƒƒ 
this
ƒƒ #
.
ƒƒ# $
_record
ƒƒ$ +
,
ƒƒ+ ,
fieldValues
ƒƒ- 8
[
ƒƒ8 9
i
ƒƒ9 :
]
ƒƒ: ;
)
ƒƒ; <
;
ƒƒ< =
}
≈≈ 
}
∆∆ 
}
«« 
return
»» 
(
»» 
this
»» 
.
»» 
_record
»»  
!=
»»! #
null
»»$ (
)
»»( )
;
»») *
}
…… 	
public
ÃÃ 
void
ÃÃ 
Reset
ÃÃ 
(
ÃÃ 
)
ÃÃ 
{
ÕÕ 	
throw
ŒŒ 
new
ŒŒ %
NotImplementedException
ŒŒ -
(
ŒŒ- .
$str
ŒŒ. W
)
ŒŒW X
;
ŒŒX Y
}
œœ 	
private
—— 
static
—— 
Action
—— 
<
—— 
T
—— 
,
——  
string
——! '
>
——' ( 
EmitSetValueAction
——) ;
(
——; <

MemberInfo
——< F
mi
——G I
,
——I J
Func
——K O
<
——O P
string
——P V
,
——V W
object
——X ^
>
——^ _
func
——` d
)
——d e
{
““ 	!
ParameterExpression
”” 
paramExpObj
””  +
=
””, -

Expression
””. 8
.
””8 9
	Parameter
””9 B
(
””B C
typeof
””C I
(
””I J
object
””J P
)
””P Q
,
””Q R
$str
””S X
)
””X Y
;
””Y Z!
ParameterExpression
‘‘ 
	paramExpT
‘‘  )
=
‘‘* +

Expression
‘‘, 6
.
‘‘6 7
	Parameter
‘‘7 @
(
‘‘@ A
typeof
‘‘A G
(
‘‘G H
T
‘‘H I
)
‘‘I J
,
‘‘J K
$str
‘‘L V
)
‘‘V W
;
‘‘W X
{
÷÷ 
var
◊◊ 
pi
◊◊ 
=
◊◊ 
mi
◊◊ 
as
◊◊ 
PropertyInfo
◊◊ +
;
◊◊+ ,
if
ÿÿ 
(
ÿÿ 
pi
ÿÿ 
!=
ÿÿ 
null
ÿÿ 
)
ÿÿ 
{
ŸŸ 
if
€€ 
(
€€ 
CsvFile
€€ 
.
€€  

UseLambdas
€€  *
)
€€* +
{
‹‹ 
var
›› 
callExpr
›› $
=
››% &

Expression
››' 1
.
››1 2
Call
››2 6
(
››6 7
	paramExpT
ﬁﬁ %
,
ﬁﬁ% &
pi
ﬂﬂ 
.
ﬂﬂ 
GetSetMethod
ﬂﬂ +
(
ﬂﬂ+ ,
)
ﬂﬂ, -
,
ﬂﬂ- .

Expression
‡‡ &
.
‡‡& '
ConvertChecked
‡‡' 5
(
‡‡5 6
paramExpObj
‡‡6 A
,
‡‡A B
pi
‡‡C E
.
‡‡E F
PropertyType
‡‡F R
)
‡‡R S
)
‡‡S T
;
‡‡T U
var
·· 
setter
·· "
=
··# $

Expression
··% /
.
··/ 0
Lambda
··0 6
<
··6 7
Action
··7 =
<
··= >
T
··> ?
,
··? @
object
··A G
>
··G H
>
··H I
(
··I J
callExpr
‚‚ $
,
‚‚$ %
	paramExpT
„„ %
,
„„% &
paramExpObj
‰‰ '
)
‰‰' (
.
‰‰( )
Compile
‰‰) 0
(
‰‰0 1
)
‰‰1 2
;
‰‰2 3
return
ÂÂ 
(
ÂÂ  
o
ÂÂ  !
,
ÂÂ! "
s
ÂÂ# $
)
ÂÂ$ %
=>
ÂÂ& (
setter
ÂÂ) /
(
ÂÂ/ 0
o
ÂÂ0 1
,
ÂÂ1 2
func
ÂÂ3 7
(
ÂÂ7 8
s
ÂÂ8 9
)
ÂÂ9 :
)
ÂÂ: ;
;
ÂÂ; <
}
ÊÊ 
return
ËË 
(
ËË 
o
ËË 
,
ËË 
v
ËË  
)
ËË  !
=>
ËË" $
pi
ËË% '
.
ËË' (
SetValue
ËË( 0
(
ËË0 1
o
ËË1 2
,
ËË2 3
(
ËË4 5
object
ËË5 ;
)
ËË; <
func
ËË< @
(
ËË@ A
v
ËËA B
)
ËËB C
,
ËËC D
null
ËËE I
)
ËËI J
;
ËËJ K
}
ÍÍ 
}
ÎÎ 
{
ÏÏ 
var
ÌÌ 
fi
ÌÌ 
=
ÌÌ 
mi
ÌÌ 
as
ÌÌ 
	FieldInfo
ÌÌ (
;
ÌÌ( )
if
ÓÓ 
(
ÓÓ 
fi
ÓÓ 
!=
ÓÓ 
null
ÓÓ 
)
ÓÓ 
{
ÔÔ 
if
ÒÒ 
(
ÒÒ 
CsvFile
ÒÒ 
.
ÒÒ  

UseLambdas
ÒÒ  *
)
ÒÒ* +
{
ÚÚ 
var
ıı 
valueExp
ıı $
=
ıı% &

Expression
ıı' 1
.
ıı1 2
ConvertChecked
ıı2 @
(
ıı@ A
paramExpObj
ııA L
,
ııL M
fi
ııN P
.
ııP Q
	FieldType
ııQ Z
)
ııZ [
;
ıı[ \
MemberExpression
˘˘ (
fieldExp
˘˘) 1
=
˘˘2 3

Expression
˘˘4 >
.
˘˘> ?
Field
˘˘? D
(
˘˘D E
	paramExpT
˘˘E N
,
˘˘N O
fi
˘˘P R
)
˘˘R S
;
˘˘S T
BinaryExpression
˙˙ (
	assignExp
˙˙) 2
=
˙˙3 4

Expression
˙˙5 ?
.
˙˙? @
Assign
˙˙@ F
(
˙˙F G
fieldExp
˙˙G O
,
˙˙O P
valueExp
˙˙Q Y
)
˙˙Y Z
;
˙˙Z [
var
¸¸ 
setter
¸¸ "
=
¸¸# $

Expression
¸¸% /
.
¸¸/ 0
Lambda
¸¸0 6
<
¸¸6 7
Action
¸¸7 =
<
¸¸= >
T
¸¸> ?
,
¸¸? @
object
¸¸A G
>
¸¸G H
>
¸¸H I
(
˝˝ 
	assignExp
˝˝ &
,
˝˝& '
	paramExpT
˝˝( 1
,
˝˝1 2
paramExpObj
˝˝3 >
)
˝˝> ?
.
˝˝? @
Compile
˝˝@ G
(
˝˝G H
)
˝˝H I
;
˝˝I J
return
ˇˇ 
(
ˇˇ  
o
ˇˇ  !
,
ˇˇ! "
s
ˇˇ# $
)
ˇˇ$ %
=>
ˇˇ& (
setter
ˇˇ) /
(
ˇˇ/ 0
o
ˇˇ0 1
,
ˇˇ1 2
func
ˇˇ3 7
(
ˇˇ7 8
s
ˇˇ8 9
)
ˇˇ9 :
)
ˇˇ: ;
;
ˇˇ; <
}
ÄÄ 
return
ÇÇ 
(
ÇÇ 
(
ÇÇ 
o
ÇÇ 
,
ÇÇ 
v
ÇÇ  !
)
ÇÇ! "
=>
ÇÇ# %
fi
ÇÇ& (
.
ÇÇ( )
SetValue
ÇÇ) 1
(
ÇÇ1 2
o
ÇÇ2 3
,
ÇÇ3 4
func
ÇÇ5 9
(
ÇÇ9 :
v
ÇÇ: ;
)
ÇÇ; <
)
ÇÇ< =
)
ÇÇ= >
;
ÇÇ> ?
}
ÉÉ 
}
ÑÑ 
throw
ÖÖ 
new
ÖÖ %
NotImplementedException
ÖÖ -
(
ÖÖ- .
)
ÖÖ. /
;
ÖÖ/ 0
}
ÜÜ 	
private
àà 
static
àà 
Action
àà 
<
àà 
T
àà 
,
àà  
string
àà! '
>
àà' (

FindSetter
àà) 3
(
àà3 4
string
àà4 :
c
àà; <
,
àà< =
bool
àà> B
staticMember
ààC O
)
ààO P
{
ââ 	
var
ää 
flags
ää 
=
ää 
BindingFlags
ää $
.
ää$ %
Public
ää% +
|
ää, -
BindingFlags
ää. :
.
ää: ;
	NonPublic
ää; D
|
ääE F
BindingFlags
ääG S
.
ääS T

IgnoreCase
ääT ^
|
ää_ `
(
ääa b
staticMember
ääb n
?
ääo p
BindingFlags
ääq }
.
ää} ~
Staticää~ Ñ
:ääÖ Ü
BindingFlagsääá ì
.ääì î
Instanceääî ú
)ääú ù
;ääù û
Action
ãã 
<
ãã 
T
ãã 
,
ãã 
string
ãã 
>
ãã 
action
ãã $
=
ãã% &
null
ãã' +
;
ãã+ ,
PropertyInfo
åå 
pi
åå 
=
åå 
typeof
åå $
(
åå$ %
T
åå% &
)
åå& '
.
åå' (
GetProperty
åå( 3
(
åå3 4
c
åå4 5
,
åå5 6
flags
åå7 <
)
åå< =
;
åå= >
if
çç 
(
çç 
pi
çç 
!=
çç 
null
çç 
)
çç 
{
éé 
var
èè 
pFunc
èè 
=
èè 
StringToObject
èè *
(
èè* +
pi
èè+ -
.
èè- .
PropertyType
èè. :
)
èè: ;
;
èè; <
action
êê 
=
êê  
EmitSetValueAction
êê +
(
êê+ ,
pi
êê, .
,
êê. /
pFunc
êê0 5
)
êê5 6
;
êê6 7
}
ëë 
	FieldInfo
íí 
fi
íí 
=
íí 
typeof
íí !
(
íí! "
T
íí" #
)
íí# $
.
íí$ %
GetField
íí% -
(
íí- .
c
íí. /
,
íí/ 0
flags
íí1 6
)
íí6 7
;
íí7 8
if
ìì 
(
ìì 
fi
ìì 
!=
ìì 
null
ìì 
)
ìì 
{
îî 
var
ïï 
fFunc
ïï 
=
ïï 
StringToObject
ïï *
(
ïï* +
fi
ïï+ -
.
ïï- .
	FieldType
ïï. 7
)
ïï7 8
;
ïï8 9
action
ññ 
=
ññ  
EmitSetValueAction
ññ +
(
ññ+ ,
fi
ññ, .
,
ññ. /
fFunc
ññ0 5
)
ññ5 6
;
ññ6 7
}
óó 
return
òò 
action
òò 
;
òò 
}
ôô 	
private
õõ 
static
õõ 
Func
õõ 
<
õõ 
string
õõ "
,
õõ" #
object
õõ$ *
>
õõ* +
StringToObject
õõ, :
(
õõ: ;
Type
õõ; ?
propertyType
õõ@ L
)
õõL M
{
úú 	
if
ùù 
(
ùù 
propertyType
ùù 
==
ùù 
typeof
ùù  &
(
ùù& '
string
ùù' -
)
ùù- .
)
ùù. /
return
ûû 
(
ûû 
s
ûû 
)
ûû 
=>
ûû 
s
ûû 
??
ûû  "
String
ûû# )
.
ûû) *
Empty
ûû* /
;
ûû/ 0
else
üü 
if
üü 
(
üü 
propertyType
üü !
==
üü" $
typeof
üü% +
(
üü+ ,
Int32
üü, 1
)
üü1 2
)
üü2 3
return
†† 
(
†† 
s
†† 
)
†† 
=>
†† 
String
†† $
.
††$ %
IsNullOrEmpty
††% 2
(
††2 3
s
††3 4
)
††4 5
?
††6 7
$num
††8 9
:
††: ;
Int32
††< A
.
††A B
Parse
††B G
(
††G H
s
††H I
)
††I J
;
††J K
if
°° 
(
°° 
propertyType
°° 
==
°° 
typeof
°°  &
(
°°& '
DateTime
°°' /
)
°°/ 0
)
°°0 1
return
¢¢ 
(
¢¢ 
s
¢¢ 
)
¢¢ 
=>
¢¢ 
String
¢¢ $
.
¢¢$ %
IsNullOrEmpty
¢¢% 2
(
¢¢2 3
s
¢¢3 4
)
¢¢4 5
?
¢¢6 7
DateTimeZero
¢¢8 D
:
¢¢E F
DateTime
¢¢G O
.
¢¢O P
Parse
¢¢P U
(
¢¢U V
s
¢¢V W
)
¢¢W X
;
¢¢X Y
else
££ 
throw
§§ 
new
§§ %
NotImplementedException
§§ 1
(
§§1 2
)
§§2 3
;
§§3 4
}
•• 	
private
ßß 
List
ßß 
<
ßß 
Action
ßß 
<
ßß 
T
ßß 
,
ßß 
string
ßß %
>
ßß% &
>
ßß& '
CreateSetters
ßß( 5
(
ßß5 6
)
ßß6 7
{
®® 	
var
©© 
list
©© 
=
©© 
new
©© 
List
©© 
<
©©  
Action
©©  &
<
©©& '
T
©©' (
,
©©( )
string
©©* 0
>
©©0 1
>
©©1 2
(
©©2 3
)
©©3 4
;
©©4 5
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
$num
™™ 
;
™™ 
i
™™ 
<
™™ 
this
™™  $
.
™™$ %
_columns
™™% -
.
™™- .
Length
™™. 4
;
™™4 5
i
™™6 7
++
™™7 9
)
™™9 :
{
´´ 
string
¨¨ 

columnName
¨¨ !
=
¨¨" #
this
¨¨$ (
.
¨¨( )
_columns
¨¨) 1
[
¨¨1 2
i
¨¨2 3
]
¨¨3 4
;
¨¨4 5
Action
≠≠ 
<
≠≠ 
T
≠≠ 
,
≠≠ 
string
≠≠  
>
≠≠  !
action
≠≠" (
=
≠≠) *
null
≠≠+ /
;
≠≠/ 0
if
ÆÆ 
(
ÆÆ 

columnName
ÆÆ 
.
ÆÆ 
IndexOf
ÆÆ &
(
ÆÆ& '
$char
ÆÆ' *
)
ÆÆ* +
>=
ÆÆ, .
$num
ÆÆ/ 0
)
ÆÆ0 1

columnName
ØØ 
=
ØØ  

columnName
ØØ! +
.
ØØ+ ,
Replace
ØØ, 3
(
ØØ3 4
$str
ØØ4 7
,
ØØ7 8
$str
ØØ9 ;
)
ØØ; <
;
ØØ< =
action
∞∞ 
=
∞∞ 

FindSetter
∞∞ #
(
∞∞# $

columnName
∞∞$ .
,
∞∞. /
false
∞∞0 5
)
∞∞5 6
??
∞∞7 9

FindSetter
∞∞: D
(
∞∞D E

columnName
∞∞E O
,
∞∞O P
true
∞∞Q U
)
∞∞U V
;
∞∞V W
list
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
action
≤≤ 
)
≤≤  
;
≤≤  !
}
≥≥ 
return
¥¥ 
list
¥¥ 
;
¥¥ 
}
µµ 	
private
∑∑ 
void
∑∑ 
NextChar
∑∑ 
(
∑∑ 
)
∑∑ 
{
∏∏ 	
if
ππ 
(
ππ 
this
ππ 
.
ππ 
_pos
ππ 
<
ππ 
this
ππ  
.
ππ  !
_len
ππ! %
)
ππ% &
{
∫∫ 
this
ªª 
.
ªª 
_pos
ªª 
++
ªª 
;
ªª 
this
ºº 
.
ºº 
_curChar
ºº 
=
ºº 
this
ºº  $
.
ºº$ %
_pos
ºº% )
<
ºº* +
this
ºº, 0
.
ºº0 1
_len
ºº1 5
?
ºº6 7
this
ºº8 <
.
ºº< =
_line
ºº= B
[
ººB C
this
ººC G
.
ººG H
_pos
ººH L
]
ººL M
:
ººN O
$char
ººP T
;
ººT U
}
ΩΩ 
}
ææ 	
private
¿¿ 
void
¿¿ 
ParseEndOfLine
¿¿ #
(
¿¿# $
)
¿¿$ %
{
¡¡ 	
throw
¬¬ 
new
¬¬ %
NotImplementedException
¬¬ -
(
¬¬- .
)
¬¬. /
;
¬¬/ 0
}
√√ 	
private
∆∆ 
string
∆∆ 

ParseField
∆∆ !
(
∆∆! "
)
∆∆" #
{
«« 	
_parseFieldResult
»» 
.
»» 
Length
»» $
=
»»% &
$num
»»' (
;
»»( )
if
…… 
(
…… 
this
…… 
.
…… 
_line
…… 
==
…… 
null
…… "
||
……# %
this
……& *
.
……* +
_pos
……+ /
>=
……0 2
this
……3 7
.
……7 8
_len
……8 <
)
……< =
return
   
null
   
;
   
while
ÀÀ 
(
ÀÀ 
this
ÀÀ 
.
ÀÀ 
_curChar
ÀÀ  
==
ÀÀ! #
$char
ÀÀ$ '
||
ÀÀ( *
this
ÀÀ+ /
.
ÀÀ/ 0
_curChar
ÀÀ0 8
==
ÀÀ9 ;
$char
ÀÀ< @
)
ÀÀ@ A
{
ÃÃ 
this
ÕÕ 
.
ÕÕ 
NextChar
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ  
}
ŒŒ 
if
œœ 
(
œœ 
this
œœ 
.
œœ 
_curChar
œœ 
==
œœ  
this
œœ! %
.
œœ% &
_textQualifier
œœ& 4
)
œœ4 5
{
–– 
this
—— 
.
—— 
NextChar
—— 
(
—— 
)
—— 
;
——  
while
““ 
(
““ 
this
““ 
.
““ 
_curChar
““ $
!=
““% '
$num
““( )
)
““) *
{
”” 
if
‘‘ 
(
‘‘ 
this
‘‘ 
.
‘‘ 
_curChar
‘‘ %
==
‘‘& (
this
‘‘) -
.
‘‘- .
_textQualifier
‘‘. <
)
‘‘< =
{
’’ 
this
÷÷ 
.
÷÷ 
NextChar
÷÷ %
(
÷÷% &
)
÷÷& '
;
÷÷' (
if
◊◊ 
(
◊◊ 
this
◊◊  
.
◊◊  !
_curChar
◊◊! )
==
◊◊* ,
this
◊◊- 1
.
◊◊1 2
_textQualifier
◊◊2 @
)
◊◊@ A
{
ÿÿ 
this
ŸŸ  
.
ŸŸ  !
NextChar
ŸŸ! )
(
ŸŸ) *
)
ŸŸ* +
;
ŸŸ+ ,
_parseFieldResult
⁄⁄ -
.
⁄⁄- .
Append
⁄⁄. 4
(
⁄⁄4 5
this
⁄⁄5 9
.
⁄⁄9 :
_textQualifier
⁄⁄: H
)
⁄⁄H I
;
⁄⁄I J
}
€€ 
else
‹‹ 
return
›› "
_parseFieldResult
››# 4
.
››4 5
ToString
››5 =
(
››= >
)
››> ?
;
››? @
}
ﬁﬁ 
else
ﬂﬂ 
if
ﬂﬂ 
(
ﬂﬂ 
this
ﬂﬂ !
.
ﬂﬂ! "
_curChar
ﬂﬂ" *
==
ﬂﬂ+ -
$char
ﬂﬂ. 2
)
ﬂﬂ2 3
{
‡‡ 
if
·· 
(
·· 
this
··  
.
··  !
_line
··! &
==
··' )
null
··* .
)
··. /
return
‚‚ "
_parseFieldResult
‚‚# 4
.
‚‚4 5
ToString
‚‚5 =
(
‚‚= >
)
‚‚> ?
;
‚‚? @
this
„„ 
.
„„ 
ReadNextLine
„„ )
(
„„) *
)
„„* +
;
„„+ ,
}
‰‰ 
else
ÂÂ 
{
ÊÊ 
_parseFieldResult
ÁÁ )
.
ÁÁ) *
Append
ÁÁ* 0
(
ÁÁ0 1
this
ÁÁ1 5
.
ÁÁ5 6
_curChar
ÁÁ6 >
)
ÁÁ> ?
;
ÁÁ? @
this
ËË 
.
ËË 
NextChar
ËË %
(
ËË% &
)
ËË& '
;
ËË' (
}
ÈÈ 
}
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
while
ÓÓ 
(
ÓÓ 
this
ÓÓ 
.
ÓÓ 
_curChar
ÓÓ $
!=
ÓÓ% '
$num
ÓÓ( )
&&
ÓÓ* ,
this
ÓÓ- 1
.
ÓÓ1 2
_curChar
ÓÓ2 :
!=
ÓÓ; =
this
ÓÓ> B
.
ÓÓB C
_fieldSeparator
ÓÓC R
&&
ÓÓS U
this
ÓÓV Z
.
ÓÓZ [
_curChar
ÓÓ[ c
!=
ÓÓd f
$char
ÓÓg k
&&
ÓÓl n
this
ÓÓo s
.
ÓÓs t
_curChar
ÓÓt |
!=
ÓÓ} 
$charÓÓÄ Ñ
)ÓÓÑ Ö
{
ÔÔ 
_parseFieldResult
 %
.
% &
Append
& ,
(
, -
this
- 1
.
1 2
_curChar
2 :
)
: ;
;
; <
this
ÒÒ 
.
ÒÒ 
NextChar
ÒÒ !
(
ÒÒ! "
)
ÒÒ" #
;
ÒÒ# $
}
ÚÚ 
}
ÛÛ 
return
ÙÙ 
_parseFieldResult
ÙÙ $
.
ÙÙ$ %
ToString
ÙÙ% -
(
ÙÙ- .
)
ÙÙ. /
;
ÙÙ/ 0
}
ıı 	
private
˜˜ 
void
˜˜ 

ReadHeader
˜˜ 
(
˜˜  
string
˜˜  &
header
˜˜' -
)
˜˜- .
{
¯¯ 	
if
˘˘ 
(
˘˘ 
header
˘˘ 
==
˘˘ 
null
˘˘ 
)
˘˘ 
{
˙˙ 
this
˚˚ 
.
˚˚ 
ReadNextLine
˚˚ !
(
˚˚! "
)
˚˚" #
;
˚˚# $
}
¸¸ 
else
˝˝ 
{
˛˛ 
this
ÅÅ 
.
ÅÅ 
_line
ÅÅ 
=
ÅÅ 
header
ÅÅ #
;
ÅÅ# $
this
ÇÇ 
.
ÇÇ 
_pos
ÇÇ 
=
ÇÇ 
-
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
this
ÉÉ 
.
ÉÉ 
_len
ÉÉ 
=
ÉÉ 
this
ÉÉ  
.
ÉÉ  !
_line
ÉÉ! &
.
ÉÉ& '
Length
ÉÉ' -
;
ÉÉ- .
this
ÑÑ 
.
ÑÑ 
NextChar
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ  
}
ÖÖ 
var
áá 
readColumns
áá 
=
áá 
new
áá !
List
áá" &
<
áá& '
string
áá' -
>
áá- .
(
áá. /
)
áá/ 0
;
áá0 1
string
àà 

columnName
àà 
;
àà 
while
ââ 
(
ââ 
(
ââ 

columnName
ââ 
=
ââ  
this
ââ! %
.
ââ% &

ParseField
ââ& 0
(
ââ0 1
)
ââ1 2
)
ââ2 3
!=
ââ4 6
null
ââ7 ;
)
ââ; <
{
ää 
readColumns
ãã 
.
ãã 
Add
ãã 
(
ãã  

columnName
ãã  *
)
ãã* +
;
ãã+ ,
if
åå 
(
åå 
this
åå 
.
åå 
_curChar
åå !
==
åå" $
this
åå% )
.
åå) *
_fieldSeparator
åå* 9
)
åå9 :
this
çç 
.
çç 
NextChar
çç !
(
çç! "
)
çç" #
;
çç# $
else
éé 
break
èè 
;
èè 
}
êê 
this
ëë 
.
ëë 
_columns
ëë 
=
ëë 
readColumns
ëë '
.
ëë' (
ToArray
ëë( /
(
ëë/ 0
)
ëë0 1
;
ëë1 2
}
íí 	
private
îî 
void
îî 
ReadNextLine
îî !
(
îî! "
)
îî" #
{
ïï 	
this
ññ 
.
ññ 
_line
ññ 
=
ññ 
this
ññ 
.
ññ 
_textReader
ññ )
.
ññ) *
ReadLine
ññ* 2
(
ññ2 3
)
ññ3 4
;
ññ4 5
this
óó 
.
óó 
_pos
óó 
=
óó 
-
óó 
$num
óó 
;
óó 
if
òò 
(
òò 
this
òò 
.
òò 
_line
òò 
==
òò 
null
òò "
)
òò" #
{
ôô 
this
öö 
.
öö 
_len
öö 
=
öö 
$num
öö 
;
öö 
this
õõ 
.
õõ 
_curChar
õõ 
=
õõ 
$char
õõ  $
;
õõ$ %
}
úú 
else
ùù 
{
ûû 
this
üü 
.
üü 
_len
üü 
=
üü 
this
üü  
.
üü  !
_line
üü! &
.
üü& '
Length
üü' -
;
üü- .
this
†† 
.
†† 
NextChar
†† 
(
†† 
)
†† 
;
††  
}
°° 
}
¢¢ 	
}
££ 
public
•• 

class
•• 
CsvDefinition
•• 
{
¶¶ 
public
ßß 
string
ßß 
Header
ßß 
{
ßß 
get
ßß "
;
ßß" #
set
ßß$ '
;
ßß' (
}
ßß) *
public
®® 
char
®® 
FieldSeparator
®® "
{
®®# $
get
®®% (
;
®®( )
set
®®* -
;
®®- .
}
®®/ 0
public
©© 
char
©© 
TextQualifier
©© !
{
©©" #
get
©©$ '
;
©©' (
set
©©) ,
;
©©, -
}
©©. /
public
™™ 
IEnumerable
™™ 
<
™™ 
String
™™ !
>
™™! "
Columns
™™# *
{
™™+ ,
get
™™- 0
;
™™0 1
set
™™2 5
;
™™5 6
}
™™7 8
public
´´ 
string
´´ 
	EndOfLine
´´ 
{
´´  !
get
´´" %
;
´´% &
set
´´' *
;
´´* +
}
´´, -
public
≠≠ 
CsvDefinition
≠≠ 
(
≠≠ 
)
≠≠ 
{
ÆÆ 	
if
ØØ 
(
ØØ 
CsvFile
ØØ 
.
ØØ "
DefaultCsvDefinition
ØØ ,
!=
ØØ- /
null
ØØ0 4
)
ØØ4 5
{
∞∞ 
FieldSeparator
±± 
=
±±  
CsvFile
±±! (
.
±±( )"
DefaultCsvDefinition
±±) =
.
±±= >
FieldSeparator
±±> L
;
±±L M
TextQualifier
≤≤ 
=
≤≤ 
CsvFile
≤≤  '
.
≤≤' ("
DefaultCsvDefinition
≤≤( <
.
≤≤< =
TextQualifier
≤≤= J
;
≤≤J K
	EndOfLine
≥≥ 
=
≥≥ 
CsvFile
≥≥ #
.
≥≥# $"
DefaultCsvDefinition
≥≥$ 8
.
≥≥8 9
	EndOfLine
≥≥9 B
;
≥≥B C
}
¥¥ 
}
µµ 	
}
∂∂ 
public
∏∏ 

class
∏∏ 
	CsvSource
∏∏ 
{
ππ 
public
∫∫ 
readonly
∫∫ 

TextReader
∫∫ "

TextReader
∫∫# -
;
∫∫- .
public
ºº 
static
ºº 
implicit
ºº 
operator
ºº '
	CsvSource
ºº( 1
(
ºº1 2
CsvFile
ºº2 9
csvFile
ºº: A
)
ººA B
{
ΩΩ 	
return
ææ 
new
ææ 
	CsvSource
ææ  
(
ææ  !
csvFile
ææ! (
)
ææ( )
;
ææ) *
}
øø 	
public
¡¡ 
static
¡¡ 
implicit
¡¡ 
operator
¡¡ '
	CsvSource
¡¡( 1
(
¡¡1 2
string
¡¡2 8
path
¡¡9 =
)
¡¡= >
{
¬¬ 	
return
√√ 
new
√√ 
	CsvSource
√√  
(
√√  !
path
√√! %
)
√√% &
;
√√& '
}
ƒƒ 	
public
∆∆ 
static
∆∆ 
implicit
∆∆ 
operator
∆∆ '
	CsvSource
∆∆( 1
(
∆∆1 2

TextReader
∆∆2 <

textReader
∆∆= G
)
∆∆G H
{
«« 	
return
»» 
new
»» 
	CsvSource
»»  
(
»»  !

textReader
»»! +
)
»»+ ,
;
»», -
}
…… 	
public
ÀÀ 
	CsvSource
ÀÀ 
(
ÀÀ 

TextReader
ÀÀ #

textReader
ÀÀ$ .
)
ÀÀ. /
{
ÃÃ 	
this
ÕÕ 
.
ÕÕ 

TextReader
ÕÕ 
=
ÕÕ 

textReader
ÕÕ (
;
ÕÕ( )
}
ŒŒ 	
public
–– 
	CsvSource
–– 
(
–– 
Stream
–– 
stream
––  &
)
––& '
{
—— 	
this
““ 
.
““ 

TextReader
““ 
=
““ 
new
““ !
StreamReader
““" .
(
““. /
stream
““/ 5
)
““5 6
;
““6 7
}
”” 	
public
’’ 
	CsvSource
’’ 
(
’’ 
string
’’ 
path
’’  $
)
’’$ %
{
÷÷ 	
this
◊◊ 
.
◊◊ 

TextReader
◊◊ 
=
◊◊ 
new
◊◊ !
StreamReader
◊◊" .
(
◊◊. /
path
◊◊/ 3
)
◊◊3 4
;
◊◊4 5
}
ÿÿ 	
public
⁄⁄ 
	CsvSource
⁄⁄ 
(
⁄⁄ 
CsvFile
⁄⁄  
csvFile
⁄⁄! (
)
⁄⁄( )
{
€€ 	
this
‹‹ 
.
‹‹ 

TextReader
‹‹ 
=
‹‹ 
new
‹‹ !
StreamReader
‹‹" .
(
‹‹. /
csvFile
‹‹/ 6
.
‹‹6 7

BaseStream
‹‹7 A
)
‹‹A B
;
‹‹B C
}
›› 	
}
ﬁﬁ 
public
‡‡ 

class
‡‡ 
CsvDestination
‡‡ 
{
·· 
private
‚‚ 
StreamWriter
‚‚ 
_streamWriter
‚‚ *
;
‚‚* +
public
‰‰ 
StreamWriter
‰‰ 
StreamWriter
‰‰ (
{
ÂÂ 	
get
ÊÊ 
{
ÊÊ 
return
ÊÊ 
_streamWriter
ÊÊ &
;
ÊÊ& '
}
ÊÊ( )
}
ÁÁ 	
public
ÈÈ 
static
ÈÈ 
implicit
ÈÈ 
operator
ÈÈ '
CsvDestination
ÈÈ( 6
(
ÈÈ6 7
string
ÈÈ7 =
path
ÈÈ> B
)
ÈÈB C
{
ÍÍ 	
return
ÎÎ 
new
ÎÎ 
CsvDestination
ÎÎ %
(
ÎÎ% &
path
ÎÎ& *
)
ÎÎ* +
;
ÎÎ+ ,
}
ÏÏ 	
private
ÌÌ 
CsvDestination
ÌÌ 
(
ÌÌ 
StreamWriter
ÌÌ +
streamWriter
ÌÌ, 8
)
ÌÌ8 9
{
ÓÓ 	
this
ÔÔ 
.
ÔÔ 
_streamWriter
ÔÔ 
=
ÔÔ  
streamWriter
ÔÔ! -
;
ÔÔ- .
}
 	
private
ÚÚ 
CsvDestination
ÚÚ 
(
ÚÚ 
Stream
ÚÚ %
stream
ÚÚ& ,
)
ÚÚ, -
{
ÛÛ 	
this
ÙÙ 
.
ÙÙ 
_streamWriter
ÙÙ 
=
ÙÙ  
new
ÙÙ! $
StreamWriter
ÙÙ% 1
(
ÙÙ1 2
stream
ÙÙ2 8
)
ÙÙ8 9
;
ÙÙ9 :
}
ıı 	
public
˜˜ 
CsvDestination
˜˜ 
(
˜˜ 
string
˜˜ $
fullName
˜˜% -
)
˜˜- .
{
¯¯ 	
FixCsvFileName
˘˘ 
(
˘˘ 
ref
˘˘ 
fullName
˘˘ '
)
˘˘' (
;
˘˘( )
this
˙˙ 
.
˙˙ 
_streamWriter
˙˙ 
=
˙˙  
new
˙˙! $
StreamWriter
˙˙% 1
(
˙˙1 2
fullName
˙˙2 :
)
˙˙: ;
;
˙˙; <
}
˚˚ 	
private
˝˝ 
static
˝˝ 
void
˝˝ 
FixCsvFileName
˝˝ *
(
˝˝* +
ref
˝˝+ .
string
˝˝/ 5
fullName
˝˝6 >
)
˝˝> ?
{
˛˛ 	
fullName
ˇˇ 
=
ˇˇ 
Path
ˇˇ 
.
ˇˇ 
GetFullPath
ˇˇ '
(
ˇˇ' (
fullName
ˇˇ( 0
)
ˇˇ0 1
;
ˇˇ1 2
var
ÄÄ 
path
ÄÄ 
=
ÄÄ 
Path
ÄÄ 
.
ÄÄ 
GetDirectoryName
ÄÄ ,
(
ÄÄ, -
fullName
ÄÄ- 5
)
ÄÄ5 6
;
ÄÄ6 7
if
ÅÅ 
(
ÅÅ 
path
ÅÅ 
!=
ÅÅ 
null
ÅÅ 
&&
ÅÅ 
!
ÅÅ  !
	Directory
ÅÅ! *
.
ÅÅ* +
Exists
ÅÅ+ 1
(
ÅÅ1 2
path
ÅÅ2 6
)
ÅÅ6 7
)
ÅÅ7 8
	Directory
ÇÇ 
.
ÇÇ 
CreateDirectory
ÇÇ )
(
ÇÇ) *
path
ÇÇ* .
)
ÇÇ. /
;
ÇÇ/ 0
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
String
ÉÉ 
.
ÉÉ 
Equals
ÉÉ 
(
ÉÉ 
Path
ÉÉ #
.
ÉÉ# $
GetExtension
ÉÉ$ 0
(
ÉÉ0 1
fullName
ÉÉ1 9
)
ÉÉ9 :
,
ÉÉ: ;
$str
ÉÉ< B
)
ÉÉB C
)
ÉÉC D
fullName
ÑÑ 
+=
ÑÑ 
$str
ÑÑ "
;
ÑÑ" #
}
ÖÖ 	
}
ÜÜ 
public
àà 

static
àà 
class
àà #
CsvFileLinqExtensions
àà -
{
ââ 
public
ää 
static
ää 
void
ää 
ToCsv
ää  
<
ää  !
T
ää! "
>
ää" #
(
ää# $
this
ää$ (
IEnumerable
ää) 4
<
ää4 5
T
ää5 6
>
ää6 7
source
ää8 >
,
ää> ?
CsvDestination
ää@ N
csvDestination
ääO ]
)
ää] ^
{
ãã 	
source
åå 
.
åå 
ToCsv
åå 
(
åå 
csvDestination
åå '
,
åå' (
null
åå) -
)
åå- .
;
åå. /
}
çç 	
public
èè 
static
èè 
void
èè 
ToCsv
èè  
<
èè  !
T
èè! "
>
èè" #
(
èè# $
this
èè$ (
IEnumerable
èè) 4
<
èè4 5
T
èè5 6
>
èè6 7
source
èè8 >
,
èè> ?
CsvDestination
èè@ N
csvDestination
èèO ]
,
èè] ^
CsvDefinition
èè_ l
csvDefinition
èèm z
)
èèz {
{
êê 	
using
ëë 
(
ëë 
var
ëë 
csvFile
ëë 
=
ëë  
new
ëë! $
CsvFile
ëë% ,
<
ëë, -
T
ëë- .
>
ëë. /
(
ëë/ 0
csvDestination
ëë0 >
,
ëë> ?
csvDefinition
ëë@ M
)
ëëM N
)
ëëN O
{
íí 
foreach
ìì 
(
ìì 
var
ìì 
record
ìì #
in
ìì$ &
source
ìì' -
)
ìì- .
{
îî 
csvFile
ïï 
.
ïï 
Append
ïï "
(
ïï" #
record
ïï# )
)
ïï) *
;
ïï* +
}
ññ 
}
óó 
}
òò 	
}
öö 
public
úú 

class
úú (
CsvIgnorePropertyAttribute
úú +
:
úú, -
	Attribute
úú. 7
{
ùù 
public
ûû 
override
ûû 
string
ûû 
ToString
ûû '
(
ûû' (
)
ûû( )
{
üü 	
return
†† 
$str
†† $
;
††$ %
}
°° 	
}
¢¢ 
}ßß Ñ
ED:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Csv\CsvReader.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Csv' *
{ 
public		 

class		 
	CsvReader		 
{

 
public 
static 
List 
< 
string !
>! "
ReadCsv# *
(* +
string+ 1
filePath2 :
): ;
{ 	
List 
< 
string 
> 
single_line_data )
=* +
new, /
List0 4
<4 5
string5 ;
>; <
(< =
)= >
;> ?
foreach 
( 
var 
line 
in  
File! %
.% &
ReadAllLines& 2
(2 3
filePath3 ;
); <
)< =
{ 
if 
( 
string 
. 
IsNullOrEmpty (
(( )
line) -
)- .
). /
continue0 8
;8 9
single_line_data  
.  !
Add! $
($ %
line% )
)) *
;* +
} 
return 
single_line_data #
;# $
} 	
} 
} ⁄à
JD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Db\SettingsManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Db' )
{ 
public		 

class		 
SettingsManager		  
{

 
private 
static 
SettingsManager &
	_instance' 0
;0 1
public 
static 
SettingsManager %
Instance& .
=>/ 1
	_instance2 ;
??< >
(? @
	_instance@ I
=J K
newL O
SettingsManagerP _
(_ `
)` a
)a b
;b c
private 

SettingsVm 
	_settings $
=% &
new' *

SettingsVm+ 5
(5 6
)6 7
;7 8
public 

SettingsVm 
LoadSettings &
(& '
WfpictContext' 4
db5 7
)7 8
{ 	
var 
settingAuto 
= 
db  
.  !
Settings! )
.) *
FirstOrDefault* 8
(8 9
x9 :
=>; =
x> ?
.? @
Key@ C
==D F
StringConstantsG V
.V W"
KeyAutoProcessTrackingW m
)m n
;n o
if 
( 
settingAuto 
!= 
null #
)# $
	_settings% .
.. /!
IsAutoProcessTracking/ D
=E F
intG J
.J K
ParseK P
(P Q
settingAutoQ \
.\ ]
Value] b
)b c
==d f
$numg h
;h i
var $
settingSendNotifications (
=) *
db+ -
.- .
Settings. 6
.6 7
FirstOrDefault7 E
(E F
xF G
=>H J
xK L
.L M
KeyM P
==Q S
StringConstantsT c
.c d%
KeySendNotificationEmailsd }
)} ~
;~ 
if 
( $
settingSendNotifications (
!=) +
null, 0
)0 1
	_settings2 ;
.; <$
IsSendNotificationEmails< T
=U V
intW Z
.Z [
Parse[ `
(` a$
settingSendNotificationsa y
.y z
Valuez 
)	 Ä
==
Å É
$num
Ñ Ö
;
Ö Ü
var 
key 
= 
db 
. 
Settings !
.! "
FirstOrDefault" 0
(0 1
x1 2
=>3 5
x6 7
.7 8
Key8 ;
==< >
StringConstants? N
.N O!
KeyNotStartedInXHoursO d
)d e
;e f
	_settings 
. #
NotStartedInXHoursValue -
=. /
key0 3
!=4 6
null7 ;
?< =
int> A
.A B
ParseB G
(G H
keyH K
.K L
ValueL Q
)Q R
:S T
$numU V
;V W
key 
= 
db 
. 
Settings 
. 
FirstOrDefault ,
(, -
x- .
=>/ 1
x2 3
.3 4
Key4 7
==8 :
StringConstants; J
.J K&
KeyNotHitOpenRateIn24HoursK e
)e f
;f g
	_settings 
. (
NotHitOpenRateIn24HoursValue 2
=3 4
key5 8
!=9 ;
null< @
?A B
doubleC I
.I J
ParseJ O
(O P
keyP S
.S T
ValueT Y
)Y Z
:[ \
$num] `
;` a
key 
= 
db 
. 
Settings 
. 
FirstOrDefault ,
(, -
x- .
=>/ 1
x2 3
.3 4
Key4 7
==8 :
StringConstants; J
.J K&
KeyNotHitOpenRateIn48HoursK e
)e f
;f g
	_settings   
.   (
NotHitOpenRateIn48HoursValue   2
=  3 4
key  5 8
!=  9 ;
null  < @
?  A B
double  C I
.  I J
Parse  J O
(  O P
key  P S
.  S T
Value  T Y
)  Y Z
:  [ \
$num  ] `
;  ` a
key"" 
="" 
db"" 
."" 
Settings"" 
."" 
FirstOrDefault"" ,
("", -
x""- .
=>""/ 1
x""2 3
.""3 4
Key""4 7
==""8 :
StringConstants""; J
.""J K&
KeyNotHitOpenRateIn72Hours""K e
)""e f
;""f g
	_settings## 
.## (
NotHitOpenRateIn72HoursValue## 2
=##3 4
key##5 8
!=##9 ;
null##< @
?##A B
double##C I
.##I J
Parse##J O
(##O P
key##P S
.##S T
Value##T Y
)##Y Z
:##[ \
$num##] `
;##` a
key%% 
=%% 
db%% 
.%% 
Settings%% 
.%% 
FirstOrDefault%% ,
(%%, -
x%%- .
=>%%/ 1
x%%2 3
.%%3 4
Key%%4 7
==%%8 :
StringConstants%%; J
.%%J K'
KeyNotHitClickRateIn24Hours%%K f
)%%f g
;%%g h
	_settings&& 
.&& )
NotHitClickRateIn24HoursValue&& 3
=&&4 5
key&&6 9
!=&&: <
null&&= A
?&&B C
double&&D J
.&&J K
Parse&&K P
(&&P Q
key&&Q T
.&&T U
Value&&U Z
)&&Z [
:&&\ ]
$num&&^ a
;&&a b
key(( 
=(( 
db(( 
.(( 
Settings(( 
.(( 
FirstOrDefault(( ,
(((, -
x((- .
=>((/ 1
x((2 3
.((3 4
Key((4 7
==((8 :
StringConstants((; J
.((J K'
KeyNotHitClickRateIn48Hours((K f
)((f g
;((g h
	_settings)) 
.)) )
NotHitClickRateIn48HoursValue)) 3
=))4 5
key))6 9
!=)): <
null))= A
?))B C
double))D J
.))J K
Parse))K P
())P Q
key))Q T
.))T U
Value))U Z
)))Z [
:))\ ]
$num))^ a
;))a b
key++ 
=++ 
db++ 
.++ 
Settings++ 
.++ 
FirstOrDefault++ ,
(++, -
x++- .
=>++/ 1
x++2 3
.++3 4
Key++4 7
==++8 :
StringConstants++; J
.++J K'
KeyNotHitClickRateIn72Hours++K f
)++f g
;++g h
	_settings,, 
.,, )
NotHitClickRateIn72HoursValue,, 3
=,,4 5
key,,6 9
!=,,: <
null,,= A
?,,B C
double,,D J
.,,J K
Parse,,K P
(,,P Q
key,,Q T
.,,T U
Value,,U Z
),,Z [
:,,\ ]
$num,,^ a
;,,a b
key.. 
=.. 
db.. 
... 
Settings.. 
... 
FirstOrDefault.. ,
(.., -
x..- .
=>../ 1
x..2 3
...3 4
Key..4 7
==..8 :
StringConstants..; J
...J K(
KeyExceededOpenRateIn24Hours..K g
)..g h
;..h i
	_settings// 
.// *
ExceededOpenRateIn24HoursValue// 4
=//5 6
key//7 :
!=//; =
null//> B
?//C D
double//E K
.//K L
Parse//L Q
(//Q R
key//R U
.//U V
Value//V [
)//[ \
://] ^
$num//_ b
;//b c
key11 
=11 
db11 
.11 
Settings11 
.11 
FirstOrDefault11 ,
(11, -
x11- .
=>11/ 1
x112 3
.113 4
Key114 7
==118 :
StringConstants11; J
.11J K(
KeyExceededOpenRateIn72Hours11K g
)11g h
;11h i
	_settings22 
.22 *
ExceededOpenRateIn72HoursValue22 4
=225 6
key227 :
!=22; =
null22> B
?22C D
double22E K
.22K L
Parse22L Q
(22Q R
key22R U
.22U V
Value22V [
)22[ \
:22] ^
$num22_ b
;22b c
key44 
=44 
db44 
.44 
Settings44 
.44 
FirstOrDefault44 ,
(44, -
x44- .
=>44/ 1
x442 3
.443 4
Key444 7
==448 :
StringConstants44; J
.44J K)
KeyExceededClickRateIn24Hours44K h
)44h i
;44i j
	_settings55 
.55 +
ExceededClickRateIn24HoursValue55 5
=556 7
key558 ;
!=55< >
null55? C
?55D E
double55F L
.55L M
Parse55M R
(55R S
key55S V
.55V W
Value55W \
)55\ ]
:55^ _
$num55` c
;55c d
key77 
=77 
db77 
.77 
Settings77 
.77 
FirstOrDefault77 ,
(77, -
x77- .
=>77/ 1
x772 3
.773 4
Key774 7
==778 :
StringConstants77; J
.77J K)
KeyExceededClickRateIn72Hours77K h
)77h i
;77i j
	_settings88 
.88 +
ExceededClickRateIn72HoursValue88 5
=886 7
key888 ;
!=88< >
null88? C
?88D E
double88F L
.88L M
Parse88M R
(88R S
key88S V
.88V W
Value88W \
)88\ ]
:88^ _
$num88` c
;88c d
return:: 
	_settings:: 
;:: 
};; 	
public== 
void== 
SaveSettings==  
(==  !
WfpictContext==! .
db==/ 1
,==1 2

SettingsVm==3 =
settings==> F
)==F G
{>> 	
SaveSetting?? 
(?? 
db?? 
,?? 
StringConstants?? +
.??+ ,"
KeyAutoProcessTracking??, B
,??B C
settings??D L
.??L M!
IsAutoProcessTracking??M b
???c d
$str??e h
:??i j
$str??k n
)??n o
;??o p
SaveSetting@@ 
(@@ 
db@@ 
,@@ 
StringConstants@@ +
.@@+ ,%
KeySendNotificationEmails@@, E
,@@E F
settings@@G O
.@@O P$
IsSendNotificationEmails@@P h
?@@i j
$str@@k n
:@@o p
$str@@q t
)@@t u
;@@u v
SaveSettingBB 
(BB 
dbBB 
,BB 
StringConstantsBB +
.BB+ ,!
KeyNotStartedInXHoursBB, A
,BBA B
settingsBBC K
.BBK L#
NotStartedInXHoursValueBBL c
.BBc d
ToStringBBd l
(BBl m
CultureInfoBBm x
.BBx y
InvariantCulture	BBy â
)
BBâ ä
)
BBä ã
;
BBã å
SaveSettingCC 
(CC 
dbCC 
,CC 
StringConstantsCC +
.CC+ ,&
KeyNotHitOpenRateIn24HoursCC, F
,CCF G
settingsCCH P
.CCP Q(
NotHitOpenRateIn24HoursValueCCQ m
.CCm n
ToStringCCn v
(CCv w
CultureInfo	CCw Ç
.
CCÇ É
InvariantCulture
CCÉ ì
)
CCì î
)
CCî ï
;
CCï ñ
SaveSettingDD 
(DD 
dbDD 
,DD 
StringConstantsDD +
.DD+ ,&
KeyNotHitOpenRateIn48HoursDD, F
,DDF G
settingsDDH P
.DDP Q(
NotHitOpenRateIn48HoursValueDDQ m
.DDm n
ToStringDDn v
(DDv w
CultureInfo	DDw Ç
.
DDÇ É
InvariantCulture
DDÉ ì
)
DDì î
)
DDî ï
;
DDï ñ
SaveSettingEE 
(EE 
dbEE 
,EE 
StringConstantsEE +
.EE+ ,&
KeyNotHitOpenRateIn72HoursEE, F
,EEF G
settingsEEH P
.EEP Q(
NotHitOpenRateIn72HoursValueEEQ m
.EEm n
ToStringEEn v
(EEv w
CultureInfo	EEw Ç
.
EEÇ É
InvariantCulture
EEÉ ì
)
EEì î
)
EEî ï
;
EEï ñ
SaveSettingFF 
(FF 
dbFF 
,FF 
StringConstantsFF +
.FF+ ,'
KeyNotHitClickRateIn24HoursFF, G
,FFG H
settingsFFI Q
.FFQ R)
NotHitClickRateIn24HoursValueFFR o
.FFo p
ToStringFFp x
(FFx y
CultureInfo	FFy Ñ
.
FFÑ Ö
InvariantCulture
FFÖ ï
)
FFï ñ
)
FFñ ó
;
FFó ò
SaveSettingGG 
(GG 
dbGG 
,GG 
StringConstantsGG +
.GG+ ,'
KeyNotHitClickRateIn48HoursGG, G
,GGG H
settingsGGI Q
.GGQ R)
NotHitClickRateIn48HoursValueGGR o
.GGo p
ToStringGGp x
(GGx y
CultureInfo	GGy Ñ
.
GGÑ Ö
InvariantCulture
GGÖ ï
)
GGï ñ
)
GGñ ó
;
GGó ò
SaveSettingHH 
(HH 
dbHH 
,HH 
StringConstantsHH +
.HH+ ,'
KeyNotHitClickRateIn72HoursHH, G
,HHG H
settingsHHI Q
.HHQ R)
NotHitClickRateIn72HoursValueHHR o
.HHo p
ToStringHHp x
(HHx y
CultureInfo	HHy Ñ
.
HHÑ Ö
InvariantCulture
HHÖ ï
)
HHï ñ
)
HHñ ó
;
HHó ò
SaveSettingJJ 
(JJ 
dbJJ 
,JJ 
StringConstantsJJ +
.JJ+ ,(
KeyExceededOpenRateIn24HoursJJ, H
,JJH I
settingsJJJ R
.JJR S*
ExceededOpenRateIn24HoursValueJJS q
.JJq r
ToStringJJr z
(JJz {
CultureInfo	JJ{ Ü
.
JJÜ á
InvariantCulture
JJá ó
)
JJó ò
)
JJò ô
;
JJô ö
SaveSettingKK 
(KK 
dbKK 
,KK 
StringConstantsKK +
.KK+ ,(
KeyExceededOpenRateIn72HoursKK, H
,KKH I
settingsKKJ R
.KKR S*
ExceededOpenRateIn72HoursValueKKS q
.KKq r
ToStringKKr z
(KKz {
CultureInfo	KK{ Ü
.
KKÜ á
InvariantCulture
KKá ó
)
KKó ò
)
KKò ô
;
KKô ö
SaveSettingLL 
(LL 
dbLL 
,LL 
StringConstantsLL +
.LL+ ,)
KeyExceededClickRateIn24HoursLL, I
,LLI J
settingsLLK S
.LLS T+
ExceededClickRateIn24HoursValueLLT s
.LLs t
ToStringLLt |
(LL| }
CultureInfo	LL} à
.
LLà â
InvariantCulture
LLâ ô
)
LLô ö
)
LLö õ
;
LLõ ú
SaveSettingMM 
(MM 
dbMM 
,MM 
StringConstantsMM +
.MM+ ,)
KeyExceededClickRateIn72HoursMM, I
,MMI J
settingsMMK S
.MMS T+
ExceededClickRateIn72HoursValueMMT s
.MMs t
ToStringMMt |
(MM| }
CultureInfo	MM} à
.
MMà â
InvariantCulture
MMâ ô
)
MMô ö
)
MMö õ
;
MMõ ú
}NN 	
	protectedPP 
voidPP 
SaveSettingPP "
(PP" #
WfpictContextPP# 0
dbPP1 3
,PP3 4
stringPP5 ;
keyPP< ?
,PP? @
stringPPA G
valuePPH M
)PPM N
{QQ 	
varRR 
settingRR 
=RR 
dbRR 
.RR 
SettingsRR %
.RR% &
FirstOrDefaultRR& 4
(RR4 5
xRR5 6
=>RR7 9
xRR: ;
.RR; <
KeyRR< ?
==RR@ B
keyRRC F
)RRF G
;RRG H
ifSS 
(SS 
settingSS 
==SS 
nullSS 
)SS  
{TT 
dbUU 
.UU 
SettingsUU 
.UU 
AddUU 
(UU  
newUU  #
SettingsUU$ ,
{VV 
IdWW 
=WW 
GuidWW 
.WW 
NewGuidWW %
(WW% &
)WW& '
,WW' (
	CreatedAtXX 
=XX 
DateTimeXX  (
.XX( )
NowXX) ,
,XX, -
KeyYY 
=YY 
keyYY 
,YY 
ValueZZ 
=ZZ 
valueZZ !
}[[ 
)[[ 
;[[ 
}\\ 
else]] 
{^^ 
setting__ 
.__ 
Value__ 
=__ 
value__  %
;__% &
}`` 
dbaa 
.aa 
SaveChangesaa 
(aa 
)aa 
;aa 
}bb 	
}cc 
}dd û
ED:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Db\SettingsVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Db' )
{ 
public 

class 

SettingsVm 
{ 
public 
bool !
IsAutoProcessTracking )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
bool $
IsSendNotificationEmails ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
int #
NotStartedInXHoursValue *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public		 
double		 (
NotHitOpenRateIn24HoursValue		 2
{		3 4
get		5 8
;		8 9
set		: =
;		= >
}		? @
public

 
double

 (
NotHitOpenRateIn48HoursValue

 2
{

3 4
get

5 8
;

8 9
set

: =
;

= >
}

? @
public 
double (
NotHitOpenRateIn72HoursValue 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
double )
NotHitClickRateIn24HoursValue 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
public 
double )
NotHitClickRateIn48HoursValue 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
public 
double )
NotHitClickRateIn72HoursValue 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
public 
double *
ExceededOpenRateIn24HoursValue 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
public 
double *
ExceededOpenRateIn72HoursValue 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
public 
double +
ExceededClickRateIn24HoursValue 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
public 
double +
ExceededClickRateIn72HoursValue 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
} 
} ¿8
RD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Exceptions\ExceptionHelper.cs
	namespace

 	
ADSDataDirect


 
{ 
public 

static 
partial 
class 
ExceptionHelper  /
{ 
public 
static 
string 
GetExceptionMessage 0
(0 1
this1 5
	Exception6 ?
ex@ B
,B C
stringD J
customMessageK X
=Y Z
$str[ ]
)] ^
{ 	
var 
message 
= 
( 
customMessage (
!=) +
$str, .
). /
? 
customMessage 
+  !
$str" %
+& '
ex( *
.* +
GetBaseException+ ;
(; <
)< =
.= >
Message> E
: 
ex 
. 
GetBaseException %
(% &
)& '
.' (
Message( /
;/ 0
message 
+= 
$str #
+$ %
ex& (
.( )

StackTrace) 3
+3 4
$str5 =
;= >
if 
( 
ex 
is 
SqlException "
)" #
{ 
return 
$str 6
+7 8
message9 @
;@ A
} 
else 
if 
( 
ex 
is $
IndexOutOfRangeException 3
)3 4
{ 
return 
$str 1
+2 3
message4 ;
;; <
} 
else 
if 
( 
ex 
is '
DbEntityValidationException 6
)6 7
{ 
var   
	exception   
=   
(    !'
DbEntityValidationException  ! <
)  < =
ex  = ?
;  ? @
var!! 
errorMessages!! !
=!!" #
	exception!!$ -
.!!- ."
EntityValidationErrors!!. D
."" 

SelectMany"" 
(""  
x""  !
=>""" $
x""% &
.""& '
ValidationErrors""' 7
)""7 8
.## 
Select## 
(## 
x## 
=>##  
x##! "
.##" #
ErrorMessage### /
)##/ 0
;##0 1
var$$ 
messages$$ 
=$$ 
errorMessages$$ ,
.$$, -
	Aggregate$$- 6
($$6 7
$str$$7 9
,$$9 :
(%% 
current%% 
,%% 
errorMessage%% *
)%%* +
=>%%, .
current%%/ 6
+%%7 8
(%%9 :
$str%%: @
+%%A B
errorMessage%%C O
+%%P Q
$str%%R Y
)%%Y Z
)%%Z [
;%%[ \
return&& 
message&& 
+&&  
$str&&! (
+&&) *
messages&&+ 3
;&&3 4
}'' 
else(( 
if(( 
((( 
ex(( 
is(( +
EntityCommandExecutionException(( :
)((: ;
{)) 
return** 
$str** >
+**? @
message**A H
;**H I
}++ 
else,, 
if,, 
(,, 
ex,, 
is,, 
SecurityException,, ,
),,, -
{-- 
return.. 
$str.. *
+..+ ,
message..- 4
;..4 5
}// 
else00 
if00 
(00 
ex00 
is00 
SystemException00 *
)00* +
{11 
return22 
message22 
;22 
}33 
else44 
if44 
(44 
ex44 
is44  
ApplicationException44 /
)44/ 0
{55 
return66 
message66 
;66 
}77 
else88 
{99 
return:: 
message:: 
;:: 
};; 
}<< 	
public== 
static== 
void== 
HandleException== *
(==* +
this==+ /
	Exception==0 9
ex==: <
,==< =
string==> D
customMessage==E R
===S T
$str==U W
)==W X
{>> 	
var?? 
message?? 
=?? 
(?? 
customMessage?? (
!=??) +
$str??, .
)??. /
?@@ 
customMessage@@ 
+@@  !
$str@@" %
+@@& '
ex@@( *
.@@* +
GetBaseException@@+ ;
(@@; <
)@@< =
.@@= >
Message@@> E
:AA 
exAA 
.AA 
GetBaseExceptionAA %
(AA% &
)AA& '
.AA' (
MessageAA( /
;AA/ 0
ifBB 
(BB 
exBB 
isBB 
SqlExceptionBB "
)BB" #
{CC 
}EE 
elseFF 
ifFF 
(FF 
exFF 
isFF $
IndexOutOfRangeExceptionFF 3
)FF3 4
{GG 
}II 
elseJJ 
ifJJ 
(JJ 
exJJ 
isJJ '
DbEntityValidationExceptionJJ 6
)JJ6 7
{KK 
varLL 
	exceptionLL 
=LL 
(LL  !'
DbEntityValidationExceptionLL! <
)LL< =
exLL= ?
;LL? @
varMM 
errorMessagesMM !
=MM" #
	exceptionMM$ -
.MM- ."
EntityValidationErrorsMM. D
.NN 

SelectManyNN 
(NN  
xNN  !
=>NN" $
xNN% &
.NN& '
ValidationErrorsNN' 7
)NN7 8
.OO 
SelectOO 
(OO 
xOO 
=>OO  
xOO! "
.OO" #
ErrorMessageOO# /
)OO/ 0
;OO0 1
varPP 
messagesPP 
=PP 
errorMessagesPP ,
.PP, -
	AggregatePP- 6
(PP6 7
$strPP7 9
,PP9 :
(QQ 
currentQQ 
,QQ 
errorMessageQQ *
)QQ* +
=>QQ, .
currentQQ/ 6
+QQ7 8
(QQ9 :
$strQQ: @
+QQA B
errorMessageQQC O
+QQP Q
$strQQR Y
)QQY Z
)QQZ [
;QQ[ \
}SS 
elseTT 
ifTT 
(TT 
exTT 
isTT +
EntityCommandExecutionExceptionTT :
)TT: ;
{UU 
}WW 
elseXX 
ifXX 
(XX 
exXX 
isXX 
SecurityExceptionXX ,
)XX, -
{YY 
}[[ 
else\\ 
if\\ 
(\\ 
ex\\ 
is\\ 
SystemException\\ *
)\\* +
{]] 
}__ 
else`` 
if`` 
(`` 
ex`` 
is``  
ApplicationException`` /
)``/ 0
{aa 
}cc 
elsedd 
{ee 
}gg 
}hh 	
}ii 
}jj ‹
SD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Notifications\QCRuleUtility.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Notifications' 4
{ 
public 

static 
class 
QcRuleUtility %
{ 
public 
static 
string 
	GetString &
(& '
int' *
qcRule+ 1
)1 2
{ 	
switch		 
(		 
qcRule		 
)		 
{

 
case 
( 
int 
) 
QcRule  
.  !#
NotStartedInFirstXHours! 8
:8 9
return 
$str D
;D E
case 
( 
int 
) 
QcRule  
.  !!
OpenTrafficInLast1Day! 6
:6 7
return 
$str D
;D E
case 
( 
int 
) 
QcRule  
.  !"
ClickTrafficInLast1Day! 7
:7 8
return 
$str E
;E F
case 
( 
int 
) 
QcRule  
.  ! 
NotHitOpenRateIn1Day! 5
:5 6
return 
$str I
;I J
case 
( 
int 
) 
QcRule  
.  !!
NotHitOpenRateIn2Days! 6
:6 7
return 
$str J
;J K
case 
( 
int 
) 
QcRule  
.  !!
NotHitOpenRateIn3Days! 6
:6 7
return 
$str J
;J K
case 
( 
int 
) 
QcRule  
.  !!
NotHitClickRateIn1Day! 6
:6 7
return 
$str J
;J K
case 
( 
int 
) 
QcRule  
.  !"
NotHitClickRateIn2Days! 7
:7 8
return 
$str K
;K L
case 
( 
int 
) 
QcRule  
.  !"
NotHitClickRateIn3Days! 7
:7 8
return 
$str K
;K L
} 
return 
$str 
; 
} 	
}   
}!! ™
KD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Common\NumberHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Common' -
{ 
public 

class 
NumberHelper 
{ 
private 
static 
int 
GetTotalFromRange ,
(, -
int- 0
firstNumber1 <
,< =
int> A
secondNumberB N
)N O
{ 	
if		 
(		 
firstNumber		 
==		 
$num		  
||		! #
secondNumber		$ 0
==		1 3
$num		4 5
)		5 6
return

 
$num

 
;

 
return 
secondNumber 
-  !
firstNumber" -
+. /
$num0 1
;1 2
} 	
public 
static 
int 
GetTotal "
(" #
int# &

firstStart' 1
,1 2
int3 6
firstEnd7 ?
,? @
intA D
secondStartE P
,P Q
intR U
	secondEndV _
,_ `
inta d

thirdStarte o
,o p
intq t
thirdEndu }
)} ~
{ 	
return 
GetTotalFromRange $
($ %

firstStart% /
,/ 0
firstEnd1 9
)9 :
+; <
GetTotalFromRange= N
(N O
secondStartO Z
,Z [
	secondEnd\ e
)e f
+g h
GetTotalFromRange $
($ %

thirdStart% /
,/ 0
thirdEnd1 9
)9 :
;: ;
} 	
public 
static 
int 
Parse 
(  
string  &
numberString' 3
)3 4
{ 	
int 
number 
= 
- 
$num 
; 
Int32 
. 
TryParse 
( 
numberString '
,' (
out) ,
number- 3
)3 4
;4 5
return 
number 
; 
} 	
} 
} Æ
QD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ReportingModel\ClickModel.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ReportingModel' 5
{ 
public 

class 

ClickModel 
{ 
public 
string 
Link 
{ 
get  
;  !
set" %
;% &
}' (
public 
double 
ClickPercentage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
int 
Clicks 
{ 
get 
;  
set! $
;$ %
}& '
public		 
int		 
Index		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
int

 
GroupNumber

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
int 
WhichOf3 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
WhichOf5 
{ 
get !
;! "
set# &
;& '
}( )
public 
double 
Distribution3 #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
double 
Distribution5 #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
double 
Distribution5Half '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
double 
Distribution35 $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
RandomOutOf10K !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ∞
XD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DynamicCoding\DynamicCodingInput.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DynamicCoding' 4
{ 
public 

class 
DynamicCodingInput #
{ 
public 
string 

OrignalURL  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
URLType 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
Qunatity 
{ 
get !
;! "
set# &
;& '
}( )
} 
}		 ß
YD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DynamicCoding\DynamicCodingLinkVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DynamicCoding' 4
{ 
public 

class 
DynamicCodingLinkVm $
{ 
public		 
string		 
OrderNumber		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
SalesMasterId

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
public 
string 
URLType 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
VerumURL 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

PartnerURL  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
IfURLRedemed "
{# $
get% (
;( )
set* -
;- .
}/ 0
static 
string 
baseURL 
= 
$str  8
;8 9
public 
static 
DynamicCodingLinkVm )
FromLink* 2
(2 3
DynamicCodingLink3 D
xE F
)F G
{ 	
return 
new 
DynamicCodingLinkVm *
(* +
)+ ,
{ 
OrderNumber 
= 
x 
.  
OrderNumber  +
,+ ,
SalesMasterId 
= 
x  !
.! "
SalesMasterId" /
./ 0
ToString0 8
(8 9
)9 :
,: ;
URLType 
= 
x 
. 
URLType #
,# $
VerumURL 
= 
$" 
{ 
baseURL %
}% &
/& '
{' (
x( )
.) *
VerumURL* 2
}2 3
"3 4
,4 5

PartnerURL 
= 
$" 
{  
x  !
.! "

OrignalURL" ,
}, -
"- .
,. /
IfURLRedemed 
= 
x  
.  !
IsURLRedemed! -
?. /
$str0 5
:6 7
$str8 <
,< =
} 
; 
} 	
} 
} ˙
[D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DynamicCoding\DynamicCodingLookupVm.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
DynamicCoding' 4
{ 
public 

class !
DynamicCodingLookupVm &
{ 
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
URL 
{ 
get 
;  
set! $
;$ %
}& '
public		 
string		 
Quantity		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
static 
string 
baseURL 
= 
$str  8
;8 9
public 
static !
DynamicCodingLookupVm +

FromLookup, 6
(6 7
DynamicCodingLookup7 J
xK L
)L M
{ 	
return 
new !
DynamicCodingLookupVm ,
(, -
)- .
{ 
OrderNumber 
= 
x 
.  
OrderNumber  +
,+ ,
URL 
= 
$" 
{ 
baseURL  
}  !
/! "
{" #
x# $
.$ %
VerumURL% -
}- .
". /
,/ 0
Quantity 
= 
$" 
{ 
x 
.  
Qunatity  (
}( )
") *
,* +
} 
; 
} 	
} 
} òk
\D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\DynamicCoding\DynamicCodingProcessor.cs
	namespace		 	
ADSDataDirect		
 
.		 
Infrastructure		 &
.		& '
DynamicCoding		' 4
{

 
public 

static 
class 
DynamicCodingHelper +
{ 
public 
static 
void 
ProcessInput '
(' (
WfpictContext( 5
db6 8
,8 9
string: @

uploadPathA K
,K L
stringM S
dataFileUrlT _
,_ `
stringa g
dynamicCodingFileh y
,y z
Guid{ 
?	 Ä

campaignId
Å ã
,
ã å
string
ç ì
orderNumber
î ü
)
ü †
{ 	
List 
< 
DynamicCodingInput #
># $
inputs% +
;+ ,
try 
{ 
inputs 
= 
LoadLookupInput (
(( )

uploadPath) 3
,3 4
dynamicCodingFile5 F
)F G
;G H
} 
catch 
( 
	Exception 
ex 
)  
{ 
throw 
new 
AdsException &
(& '
$str' v
+w x
exy {
.{ |
Message	| É
)
É Ñ
;
Ñ Ö
} 
int !
TotalQuantityRequired %
=& '
inputs( .
.. /
Sum/ 2
(2 3
x3 4
=>5 7
x8 9
.9 :
Qunatity: B
)B C
;C D
string 
dataFilePath 
=  !
Path" &
.& '
Combine' .
(. /

uploadPath/ 9
,9 :
dataFileUrl; F
)F G
;G H
S3FileManager 
. 
Download "
(" #
dataFileUrl# .
,. /
dataFilePath0 <
)< =
;= >
List 
< 
string 
> 
salesIds !
=" #
GetRandomSalesIds$ 5
(5 6
dataFilePath6 B
,B C!
TotalQuantityRequiredD Y
)Y Z
;Z [
if   
(   
salesIds   
.   
Count   
<    !
TotalQuantityRequired  ! 6
)  6 7
throw!! 
new!! 
AdsException!! &
(!!& '
$str	!!' á
)
!!á à
;
!!à â
db$$ 
.$$  
DynamicCodingLookups$$ #
.$$# $
RemoveRange$$$ /
($$/ 0
db$$0 2
.$$2 3 
DynamicCodingLookups$$3 G
.$$G H
Where$$H M
($$M N
x$$N O
=>$$P R
x$$S T
.$$T U

CampaignId$$U _
==$$` b

campaignId$$c m
)$$m n
)$$n o
;$$o p
db%% 
.%% 
SaveChanges%% 
(%% 
)%% 
;%% 
int&& 
Index&& 
=&& 
$num&& 
;&& 
foreach'' 
('' 
var'' 
input'' 
in'' !
inputs''" (
)''( )
{(( 
db)) 
.))  
DynamicCodingLookups)) '
.))' (
Add))( +
())+ ,
new)), /
DynamicCodingLookup))0 C
())C D
)))D E
{** 
Id++ 
=++ 
Guid++ 
.++ 
NewGuid++ %
(++% &
)++& '
,++' (
	CreatedAt,, 
=,, 
DateTime,,  (
.,,( )
Now,,) ,
,,,, -

CampaignId-- 
=--  

campaignId--! +
,--+ ,
OrderNumber.. 
=..  !
orderNumber.." -
,..- .

OrignalURL// 
=//  
input//! &
.//& '

OrignalURL//' 1
,//1 2
URLType00 
=00 
input00 #
.00# $
URLType00$ +
,00+ ,
Qunatity11 
=11 
input11 $
.11$ %
Qunatity11% -
,11- .
VerumURL22 
=22 
$"22 !
{22! "
orderNumber22" -
}22- .
/22. /
{22/ 0
input220 5
.225 6
URLType226 =
}22= >
/22> ?
{22? @
Index22@ E
}22E F
"22F G
}33 
)33 
;33 
Index44 
++44 
;44 
}55 
db66 
.66 
SaveChanges66 
(66 
)66 
;66 
db99 
.99 
DynamicCodingLinks99 !
.99! "
RemoveRange99" -
(99- .
db99. 0
.990 1
DynamicCodingLinks991 C
.99C D
Where99D I
(99I J
x99J K
=>99L N
x99O P
.99P Q

CampaignId99Q [
==99\ ^

campaignId99_ i
)99i j
)99j k
;99k l
db:: 
.:: 
SaveChanges:: 
(:: 
):: 
;:: 
int;; 
Index2;; 
=;; 
$num;; 
;;; 
foreach<< 
(<< 
var<< 
lookUp<< 
in<<  "
db<<# %
.<<% & 
DynamicCodingLookups<<& :
.<<: ;
Where<<; @
(<<@ A
x<<A B
=><<C E
x<<F G
.<<G H

CampaignId<<H R
==<<S U

campaignId<<V `
)<<` a
)<<a b
{== 
for>> 
(>> 
int>> 
quantity>> !
=>>" #
$num>>$ %
;>>% &
quantity>>' /
<>>0 1
lookUp>>2 8
.>>8 9
Qunatity>>9 A
;>>A B
quantity>>C K
++>>K M
)>>M N
{?? 
int@@ 
salesId@@ 
=@@  !
Int32@@" '
.@@' (
Parse@@( -
(@@- .
salesIds@@. 6
[@@6 7
Index2@@7 =
]@@= >
)@@> ?
;@@? @
dbAA 
.AA 
DynamicCodingLinksAA )
.AA) *
AddAA* -
(AA- .
newAA. 1
DynamicCodingLinkAA2 C
(AAC D
)AAD E
{BB 
IdCC 
=CC 
GuidCC !
.CC! "
NewGuidCC" )
(CC) *
)CC* +
,CC+ ,
	CreatedAtDD !
=DD" #
DateTimeDD$ ,
.DD, -
NowDD- 0
,DD0 1

CampaignIdEE "
=EE# $

campaignIdEE% /
,EE/ 0
OrderNumberFF #
=FF$ %
orderNumberFF& 1
,FF1 2
SalesMasterIdGG %
=GG& '
salesIdGG( /
,GG/ 0
URLTypeHH 
=HH  !
lookUpHH" (
.HH( )
URLTypeHH) 0
,HH0 1

OrignalURLII "
=II# $
lookUpII% +
.II+ ,

OrignalURLII, 6
.II6 7
ReplaceII7 >
(II> ?
$strII? K
,IIK L
salesIdIIM T
.IIT U
ToStringIIU ]
(II] ^
)II^ _
)II_ `
,II` a
VerumURLJJ  
=JJ! "
lookUpJJ# )
.JJ) *
VerumURLJJ* 2
,JJ2 3
IsURLRedemedKK $
=KK% &
falseKK' ,
}LL 
)LL 
;LL 
Index2MM 
++MM 
;MM 
}NN 
}OO 
dbPP 
.PP 
SaveChangesPP 
(PP 
)PP 
;PP 
}QQ 	
publicSS 
staticSS 
ListSS 
<SS 
DynamicCodingInputSS -
>SS- .
LoadLookupInputSS/ >
(SS> ?
stringSS? E

uploadPathSSF P
,SSP Q
stringSSR X
dynamicCodingFileSSY j
)SSj k
{TT 	
ListUU 
<UU 
DynamicCodingInputUU #
>UU# $
inputsUU% +
=UU, -
newUU. 1
ListUU2 6
<UU6 7
DynamicCodingInputUU7 I
>UUI J
(UUJ K
)UUK L
;UUL M
stringVV 
dyanmicFilePathVV "
=VV# $
SystemVV% +
.VV+ ,
IOVV, .
.VV. /
PathVV/ 3
.VV3 4
CombineVV4 ;
(VV; <

uploadPathVV< F
,VVF G
dynamicCodingFileVVH Y
)VVY Z
;VVZ [
S3FileManagerWW 
.WW 
DownloadWW "
(WW" #
dynamicCodingFileWW# 4
,WW4 5
dyanmicFilePathWW6 E
)WWE F
;WWF G
tryYY 
{ZZ 
bool[[ 
isFirstHeader[[ "
=[[# $
true[[% )
;[[) *
foreach\\ 
(\\ 
var\\ 
line\\ !
in\\" $
System\\% +
.\\+ ,
IO\\, .
.\\. /
File\\/ 3
.\\3 4
ReadAllLines\\4 @
(\\@ A
dyanmicFilePath\\A P
)\\P Q
)\\Q R
{]] 
if^^ 
(^^ 
isFirstHeader^^ %
)^^% &
{^^' (
isFirstHeader^^) 6
=^^7 8
false^^9 >
;^^> ?
continue^^@ H
;^^H I
}^^J K
if`` 
(`` 
string`` 
.`` 
IsNullOrEmpty`` ,
(``, -
line``- 1
)``1 2
)``2 3
continue``4 <
;``< =
stringbb 
[bb 
]bb 
trimmedCellsbb )
=bb* +
linebb, 0
.bb0 1
Splitbb1 6
(bb6 7
$strbb7 :
.bb: ;
ToCharArraybb; F
(bbF G
)bbG H
)bbH I
;bbI J
ifcc 
(cc 
trimmedCellscc $
.cc$ %
Lengthcc% +
!=cc, .
$numcc/ 0
||cc1 3
NumberHelpercc4 @
.cc@ A
ParseccA F
(ccF G
trimmedCellsccG S
[ccS T
$numccT U
]ccU V
)ccV W
==ccX Z
-cc[ \
$numcc\ ]
)cc] ^
continuecc_ g
;ccg h
inputsee 
.ee 
Addee 
(ee 
newee "
DynamicCodingInputee# 5
(ee5 6
)ee6 7
{ff 

OrignalURLgg "
=gg# $
trimmedCellsgg% 1
[gg1 2
$numgg2 3
]gg3 4
,gg4 5
URLTypehh 
=hh  !
trimmedCellshh" .
[hh. /
$numhh/ 0
]hh0 1
,hh1 2
Qunatityii  
=ii! "
Int32ii# (
.ii( )
Parseii) .
(ii. /
trimmedCellsii/ ;
[ii; <
$numii< =
]ii= >
)ii> ?
}jj 
)jj 
;jj 
}kk 
returnll 
inputsll 
;ll 
}mm 
catchnn 
(nn 
	Exceptionnn 
exnn 
)nn  
{oo 
throwpp 
newpp 
AdsExceptionpp &
(pp& '
$strpp' v
+ppw x
exppy {
.pp{ |
Message	pp| É
)
ppÉ Ñ
;
ppÑ Ö
}qq 
}rr 	
publictt 
statictt 
Listtt 
<tt 
stringtt !
>tt! "
GetRandomSalesIdstt# 4
(tt4 5
stringtt5 ;
filePathtt< D
,ttD E
intttF I
TotalQuantityttJ W
)ttW X
{uu 	
returnvv  
StringListRandomizervv '
.vv' (
RandomArrayEntriesvv( :
(vv: ;
LoadSalesIdsvv; G
(vvG H
filePathvvH P
,vvP Q
truevvR V
)vvV W
,vvW X
TotalQuantityvvY f
)vvf g
;vvg h
}ww 	
publicyy 
staticyy 
Listyy 
<yy 
stringyy !
>yy! "
LoadSalesIdsyy# /
(yy/ 0
stringyy0 6
filePathyy7 ?
,yy? @
boolyyA E
isFirstRowHeaderyyF V
)yyV W
{zz 	
List{{ 
<{{ 
string{{ 
>{{ 
salesIds{{ !
={{" #
new{{$ '
List{{( ,
<{{, -
string{{- 3
>{{3 4
({{4 5
){{5 6
;{{6 7
foreach|| 
(|| 
var|| 
line|| 
in||  
File||! %
.||% &
ReadAllLines||& 2
(||2 3
filePath||3 ;
)||; <
)||< =
{}} 
if~~ 
(~~ 
isFirstRowHeader~~ #
)~~# $
{~~% &
isFirstRowHeader~~' 7
=~~8 9
false~~: ?
;~~? @
continue~~A I
;~~I J
}~~K L
var 
splitted 
= 
line #
.# $
Split$ )
() *
$str* -
.- .
ToCharArray. 9
(9 :
): ;
); <
;< =
if
ÄÄ 
(
ÄÄ 
splitted
ÄÄ 
.
ÄÄ 
Length
ÄÄ #
>
ÄÄ$ %
$num
ÄÄ& '
)
ÄÄ' (
salesIds
ÅÅ 
.
ÅÅ 
Add
ÅÅ  
(
ÅÅ  !
splitted
ÅÅ! )
[
ÅÅ) *
$num
ÅÅ* +
]
ÅÅ+ ,
)
ÅÅ, -
;
ÅÅ- .
}
ÇÇ 
return
ÉÉ 
salesIds
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
}
ÜÜ 
}áá á3
BD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Extensions.cs
	namespace 	
ADSDataDirect
 
{ 
public 

static 
class 

Extensions "
{		 
public

 
static

 
string

 
ToJson

 #
(

# $
this

$ (
object

) /
value

0 5
)

5 6
{ 	
return 
JsonConvert 
. 
SerializeObject .
(. /
value/ 4
,4 5

Formatting6 @
.@ A
IndentedA I
)I J
;J K
} 	
public 
static 
string 
ToCapitalized *
(* +
this+ /
string0 6
value7 <
)< =
{ 	
return 
CultureInfo 
. 
CurrentCulture -
.- .
TextInfo. 6
.6 7
ToTitleCase7 B
(B C
valueC H
.H I
ReplaceI P
(P Q
$strQ T
,T U
$strV X
)X Y
)Y Z
;Z [
} 	
public 
static 
bool 
Contains #
(# $
this$ (
string) /
source0 6
,6 7
string8 >
search? E
, 
StringComparison 
compare &
)& '
{ 	
return 
source 
. 
IndexOf !
(! "
search" (
,( )
compare* 1
)1 2
>=3 5
$num6 7
;7 8
} 	
static 
Regex 
_r 
= 
new 
Regex #
(# $
$str$ ,
,, -
RegexOptions. :
.: ;#
IgnorePatternWhitespace; R
)R S
;S T
public 
static 
string !
ToCapitalLetterString 2
(2 3
this3 7
string8 >
s? @
)@ A
{   	
return!! 
_r!! 
.!! 
Replace!! 
(!! 
s!! 
,!!  
$str!!! $
)!!$ %
;!!% &
}"" 	
public$$ 
static$$ 
string$$ 
ToSafeString$$ )
($$) *
this$$* .
Guid$$/ 3
?$$3 4
value$$5 :
)$$: ;
{%% 	
return&& 
value&& 
?&& 
.&& 
ToString&& "
(&&" #
)&&# $
??&&% '
string&&( .
.&&. /
Empty&&/ 4
;&&4 5
}'' 	
public)) 
static)) 
string)) 
ToSafeString)) )
())) *
this))* .
DateTime))/ 7
?))7 8
value))9 >
,))> ?
string))@ F
format))G M
)))M N
{** 	
return++ 
value++ 
?++ 
.++ 
ToString++ "
(++" #
format++# )
)++) *
??+++ -
string++. 4
.++4 5
Empty++5 :
;++: ;
},, 	
public.. 
static.. 
string.. 
ToSafeString.. )
(..) *
this..* .
object../ 5
s..6 7
)..7 8
{// 	
if00 
(00 
s00 
==00 
null00 
)00 
return00 !
string00" (
.00( )
Empty00) .
;00. /
return11 
(11 
string11 
)11 
s11 
;11 
}22 	
public44 
static44 
DateTime44 
ToSafeDateTime44 -
(44- .
this44. 2
object443 9
s44: ;
)44; <
{55 	
if66 
(66 
s66 
==66 
null66 
)66 
return66 !
DateTime66" *
.66* +
MinValue66+ 3
;663 4
DateTime88 
dt88 
;88 
DateTime99 
.99 
TryParse99 
(99 
(99 
string99 %
)99% &
s99& '
,99' (
out99) ,
dt99- /
)99/ 0
;990 1
return:: 
dt:: 
;:: 
};; 	
public== 
static== 
int== 
	ToSafeInt== #
(==# $
this==$ (
object==) /
s==0 1
)==1 2
{>> 	
if?? 
(?? 
s?? 
==?? 
null?? 
)?? 
return?? !
-??" #
$num??# $
;??$ %
stringAA 
outputAA 
=AA 
RegexAA !
.AA! "
MatchAA" '
(AA' (
(AA( )
stringAA) /
)AA/ 0
sAA0 1
,AA1 2
$strAA3 9
)AA9 :
.AA: ;
ValueAA; @
;AA@ A
intCC 
nCC 
;CC 
Int32DD 
.DD 
TryParseDD 
(DD 
outputDD !
,DD! "
outDD# &
nDD' (
)DD( )
;DD) *
returnEE 
nEE 
;EE 
}FF 	
publicHH 
staticHH 
boolHH 
ToSafeBooleanHH (
(HH( )
thisHH) -
objectHH. 4
sHH5 6
)HH6 7
{II 	
ifJJ 
(JJ 
sJJ 
==JJ 
nullJJ 
)JJ 
returnJJ !
falseJJ" '
;JJ' (
returnKK 
(KK 
boolKK 
)KK 
sKK 
;KK 
}LL 	
publicNN 
staticNN 
longNN 

ToSafeLongNN %
(NN% &
thisNN& *
objectNN+ 1
sNN2 3
)NN3 4
{OO 	
ifPP 
(PP 
sPP 
==PP 
nullPP 
)PP 
returnPP !
-PP" #
$numPP# $
;PP$ %
longQQ 
nQQ 
;QQ 
Int64RR 
.RR 
TryParseRR 
(RR 
(RR 
stringRR "
)RR" #
sRR# $
,RR$ %
outRR& )
nRR* +
)RR+ ,
;RR, -
returnSS 
nSS 
;SS 
}TT 	
}UU 
}VV Ê
`D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\Advertisers\AdvertisersManager.cs
	namespace		 	
ADSDataDirect		
 
.		 
Infrastructure		 &
.		& '
	HasOffers		' 0
.		0 1
Advertisers		1 <
{

 
public 

class 
AdvertisersManager #
:$ %
HasOffersManager& 6
{ 
public &
GetAdvertisersListResponse )
List* .
(. /
)/ 0
{ 	
using 
( 

HttpClient 
client $
=% &
new' *

HttpClient+ 5
(5 6
)6 7
)7 8
{ 
client 
. 
Timeout 
=  
TimeSpan! )
.) *
FromMinutes* 5
(5 6
$num6 7
)7 8
;8 9
string 

requestUri !
=" #
$"$ &
{& '
baseURL' .
}. /#
/advertiser/list?token=/ F
{F G
tokenG L
}L M
&limit=10&offset=10M `
"` a
;a b
using 
( 
HttpResponseMessage *
response+ 3
=4 5
client6 <
.< =
GetAsync= E
(E F

requestUriF P
)P Q
.Q R
ResultR X
)X Y
using 
( 
HttpContent "
content# *
=+ ,
response- 5
.5 6
Content6 =
)= >
{ 
string 
responseContent *
=+ ,
content- 4
.4 5
ReadAsStringAsync5 F
(F G
)G H
.H I
ResultI O
;O P&
GetAdvertisersListResponse .&
getAdvertisersListResponse/ I
;I J
try 
{ &
getAdvertisersListResponse 2
=3 4&
GetAdvertisersListResponse5 O
.O P
FromJsonP X
(X Y
responseContentY h
)h i
;i j
} 
catch 
( 
	Exception $
ex% '
)' (
{ 
throw 
new !
AdsException" .
(. /
$str/ y
)y z
;z {
} 
return   &
getAdvertisersListResponse   5
;  5 6
}!! 
}"" 
}## 	
public%% &
GetAdvertisersListResponse%% )
Create%%* 0
(%%0 1
)%%1 2
{&& 	
return'' 
null'' 
;'' 
}>> 	
}?? 
}@@ “1
hD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\Advertisers\GetAdvertisersListResponse.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	HasOffers' 0
.0 1
Advertisers1 <
{		 
public

 

partial

 
class

 &
GetAdvertisersListResponse

 3
{ 
[ 	
JsonProperty	 
( 
$str 
) 
] 
public 
List 
< 
Datum 
> 
Data 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
JsonProperty	 
( 
$str 
) 
]  
public 
object 
Errors 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
JsonProperty	 
( 
$str 
)  
]  !
public 
bool 
Success 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 

partial 
class 
Datum 
{ 
[ 	
JsonProperty	 
( 
$str 
) 
] 
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
[ 	
JsonProperty	 
( 
$str 
)  
]  !
public 
string 
Company 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
JsonProperty	 
( 
$str 
)  
]  !
public 
string 
Zipcode 
{ 
get  #
;# $
set% (
;( )
}* +
[!! 	
JsonProperty!!	 
(!! 
$str!! 
)!! 
]!!  
public"" 
string"" 
Status"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
[$$ 	
JsonProperty$$	 
($$ 
$str$$ 
,$$ 
NullValueHandling$$ 0
=$$1 2
NullValueHandling$$3 D
.$$D E
Ignore$$E K
)$$K L
]$$L M
public%% 
string%% 
Email%% 
{%% 
get%% !
;%%! "
set%%# &
;%%& '
}%%( )
['' 	
JsonProperty''	 
('' 
$str'' 
,'' 
NullValueHandling'' 0
=''1 2
NullValueHandling''3 D
.''D E
Ignore''E K
)''K L
]''L M
public(( 
string(( 
Phone(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
[** 	
JsonProperty**	 
(** 
$str** #
,**# $
NullValueHandling**% 6
=**7 8
NullValueHandling**9 J
.**J K
Ignore**K Q
)**Q R
]**R S
public++ 
string++ 

WhiteLabel++  
{++! "
get++# &
;++& '
set++( +
;+++ ,
}++- .
[-- 	
JsonProperty--	 
(-- 
$str-- 
,-- 
NullValueHandling--  1
=--2 3
NullValueHandling--4 E
.--E F
Ignore--F L
)--L M
]--M N
public.. 
string.. 
Domain.. 
{.. 
get.. "
;.." #
set..$ '
;..' (
}..) *
[00 	
JsonProperty00	 
(00 
$str00 '
,00' (
NullValueHandling00) :
=00; <
NullValueHandling00= N
.00N O
Ignore00O U
)00U V
]00V W
public11 
string11 
ReportTemplate11 $
{11% &
get11' *
;11* +
set11, /
;11/ 0
}111 2
}22 
public44 

partial44 
class44 &
GetAdvertisersListResponse44 3
{55 
public66 
static66 &
GetAdvertisersListResponse66 0
FromJson661 9
(669 :
string66: @
json66A E
)66E F
=>66G I
JsonConvert66J U
.66U V
DeserializeObject66V g
<66g h'
GetAdvertisersListResponse	66h Ç
>
66Ç É
(
66É Ñ
json
66Ñ à
,
66à â
	Converter
66ä ì
.
66ì î
Settings
66î ú
)
66ú ù
;
66ù û
}77 
public99 

static99 
class99 
	Serialize99 !
{:: 
public;; 
static;; 
string;; 
ToJson;; #
(;;# $
this;;$ (&
GetAdvertisersListResponse;;) C
self;;D H
);;H I
=>;;J L
JsonConvert;;M X
.;;X Y
SerializeObject;;Y h
(;;h i
self;;i m
,;;m n
	Converter;;o x
.;;x y
Settings	;;y Å
)
;;Å Ç
;
;;Ç É
}<< 
internal>> 
static>> 
class>> 
	Converter>> #
{?? 
public@@ 
static@@ 
readonly@@ "
JsonSerializerSettings@@ 5
Settings@@6 >
=@@? @
new@@A D"
JsonSerializerSettings@@E [
{AA 	$
MetadataPropertyHandlingBB $
=BB% &$
MetadataPropertyHandlingBB' ?
.BB? @
IgnoreBB@ F
,BBF G
DateParseHandlingCC 
=CC 
DateParseHandlingCC  1
.CC1 2
NoneCC2 6
,CC6 7

ConvertersDD 
=DD 
{DD 
newEE  
IsoDateTimeConverterEE (
{EE) *
DateTimeStylesEE+ 9
=EE: ;
DateTimeStylesEE< J
.EEJ K
AssumeUniversalEEK Z
}EE[ \
}FF 
,FF 
}GG 	
;GG	 

}HH 
}II ‘
\D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\Campaigns\CampaignsManager.cs
	namespace		 	
ADSDataDirect		
 
.		 
Infrastructure		 &
.		& '
	HasOffers		' 0
.		0 1
	Campaigns		1 :
{

 
public 

class 
CampaignsManager !
:" #
HasOffersManager$ 4
{ 
public $
GetCampaignsListResponse '
List( ,
(, -
)- .
{ 	
using 
( 

HttpClient 
client $
=% &
new' *

HttpClient+ 5
(5 6
)6 7
)7 8
{ 
client 
. 
Timeout 
=  
TimeSpan! )
.) *
FromMinutes* 5
(5 6
$num6 7
)7 8
;8 9
string 

requestUri !
=" #
$"$ &
{& '
baseURL' .
}. /!
/campaign/list?token=/ D
{D E
tokenE J
}J K
&limit=10&offset=10K ^
"^ _
;_ `
using 
( 
HttpResponseMessage *
response+ 3
=4 5
client6 <
.< =
GetAsync= E
(E F

requestUriF P
)P Q
.Q R
ResultR X
)X Y
using 
( 
HttpContent "
content# *
=+ ,
response- 5
.5 6
Content6 =
)= >
{ 
string 
responseContent *
=+ ,
content- 4
.4 5
ReadAsStringAsync5 F
(F G
)G H
.H I
ResultI O
;O P$
GetCampaignsListResponse ,&
getAdvertisersListResponse- G
;G H
try 
{ &
getAdvertisersListResponse 2
=3 4$
GetCampaignsListResponse5 M
.M N
FromJsonN V
(V W
responseContentW f
)f g
;g h
} 
catch 
( 
	Exception $
ex% '
)' (
{ 
throw 
new !
AdsException" .
(. /
$str/ y
)y z
;z {
} 
return   &
getAdvertisersListResponse   5
;  5 6
}!! 
}"" 
}## 	
public%% $
GetCampaignsListResponse%% '
Create%%( .
(%%. /
)%%/ 0
{&& 	
return'' 
null'' 
;'' 
}>> 	
}?? 
}@@ ÿ0
dD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\Campaigns\GetCampaignsListResponse.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	HasOffers' 0
.0 1
	Campaigns1 :
{		 
public

 
partial

 
class

 $
GetCampaignsListResponse

 5
{ 	
[ 
JsonProperty 
( 
$str  
)  !
]! "
public 
List 
< 
Datum 
> 
Data #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
JsonProperty 
( 
$str "
)" #
]# $
public 
object 
Errors  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
JsonProperty 
( 
$str #
)# $
]$ %
public 
bool 
Success 
{  !
get" %
;% &
set' *
;* +
}, -
} 	
public 
partial 
class 
Datum "
{ 	
[ 
JsonProperty 
( 
$str 
) 
]  
public 
long 
Id 
{ 
get  
;  !
set" %
;% &
}' (
[ 
JsonProperty 
( 
$str )
)) *
]* +
public 
long 
AdvertiserId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 
JsonProperty 
( 
$str  
)  !
]! "
public 
string 
Name 
{  
get! $
;$ %
set& )
;) *
}+ ,
[!! 
JsonProperty!! 
(!! 
$str!! $
)!!$ %
]!!% &
public"" 
DateTimeOffset"" !
EndDate""" )
{""* +
get"", /
;""/ 0
set""1 4
;""4 5
}""6 7
[$$ 
JsonProperty$$ 
($$ 
$str$$ '
)$$' (
]$$( )
public%% 
string%% 

PayoutType%% $
{%%% &
get%%' *
;%%* +
set%%, /
;%%/ 0
}%%1 2
['' 
JsonProperty'' 
('' 
$str'' (
)''( )
]'') *
public(( 
string(( 
RevenueType(( %
{((& '
get((( +
;((+ ,
set((- 0
;((0 1
}((2 3
[** 
JsonProperty** 
(** 
$str** "
)**" #
]**# $
public++ 
string++ 
Status++  
{++! "
get++# &
;++& '
set++( +
;+++ ,
}++- .
[-- 
JsonProperty-- 
(-- 
$str-- 4
)--4 5
]--5 6
public.. "
CountryRegionTargeting.. )"
CountryRegionTargeting..* @
{..A B
get..C F
;..F G
set..H K
;..K L
}..M N
[00 
JsonProperty00 
(00 
$str00 .
)00. /
]00/ 0
public11 
List11 
<11 
object11 
>11 
AdvancedTargeting11  1
{112 3
get114 7
;117 8
set119 <
;11< =
}11> ?
}22 	
public44 
partial44 
class44 "
CountryRegionTargeting44 3
{55 	
[66 
JsonProperty66 
(66 
$str66 
)66 
]66  
public77 
List77 
<77 
string77 
>77 
Ru77  "
{77# $
get77% (
;77( )
set77* -
;77- .
}77/ 0
}88 	
public:: 
partial:: 
class:: $
GetCampaignsListResponse:: 5
{;; 	
public<< 
static<< $
GetCampaignsListResponse<< 2
FromJson<<3 ;
(<<; <
string<<< B
json<<C G
)<<G H
=><<I K
JsonConvert<<L W
.<<W X
DeserializeObject<<X i
<<<i j%
GetCampaignsListResponse	<<j Ç
>
<<Ç É
(
<<É Ñ
json
<<Ñ à
,
<<à â
	Converter
<<ä ì
.
<<ì î
Settings
<<î ú
)
<<ú ù
;
<<ù û
}== 	
public?? 
static?? 
class?? 
	Serialize?? %
{@@ 	
publicAA 
staticAA 
stringAA  
ToJsonAA! '
(AA' (
thisAA( ,$
GetCampaignsListResponseAA- E
selfAAF J
)AAJ K
=>AAL N
JsonConvertAAO Z
.AAZ [
SerializeObjectAA[ j
(AAj k
selfAAk o
,AAo p
	ConverterAAq z
.AAz {
Settings	AA{ É
)
AAÉ Ñ
;
AAÑ Ö
}BB 	
internalDD 
staticDD 
classDD 
	ConverterDD '
{EE 	
publicFF 
staticFF 
readonlyFF ""
JsonSerializerSettingsFF# 9
SettingsFF: B
=FFC D
newFFE H"
JsonSerializerSettingsFFI _
{GG $
MetadataPropertyHandlingHH (
=HH) *$
MetadataPropertyHandlingHH+ C
.HHC D
IgnoreHHD J
,HHJ K
DateParseHandlingII !
=II" #
DateParseHandlingII$ 5
.II5 6
NoneII6 :
,II: ;

ConvertersJJ 
=JJ 
{JJ 
newKK  
IsoDateTimeConverterKK (
{KK) *
DateTimeStylesKK+ 9
=KK: ;
DateTimeStylesKK< J
.KKJ K
AssumeUniversalKKK Z
}KK[ \
}LL 
,LL 
}MM 
;MM 
}NN 	
}OO õ
RD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\HasOffersManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	HasOffers' 0
{ 
public 

class 
HasOffersManager !
{		 
	protected

 
string

 
token

 
=

  
$"

! #*
NETBz0WoaQDsIOhGe8qifouha6bOGw

# A
"

A B
;

B C
	protected 
string 
baseURL  
=! "
$"# %#
http://78.31.77.44:8280% <
"< =
;= >
} 
} ø+
fD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\Publishers\GetPublishersListResponse.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
	HasOffers' 0
.0 1

Publishers1 ;
{		 
public

 

partial

 
class

 %
GetPublishersListResponse

 2
{ 
[ 	
JsonProperty	 
( 
$str 
) 
] 
public 
List 
< 
Datum 
> 
Data 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
JsonProperty	 
( 
$str 
) 
]  
public 
object 
Errors 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
JsonProperty	 
( 
$str 
)  
]  !
public 
bool 
Success 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 

partial 
class 
Datum 
{ 
[ 	
JsonProperty	 
( 
$str 
) 
] 
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
[ 	
JsonProperty	 
( 
$str 
)  
]  !
public 
string 
Company 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
JsonProperty	 
( 
$str 
)  
]  !
public 
string 
Zipcode 
{ 
get  #
;# $
set% (
;( )
}* +
[!! 	
JsonProperty!!	 
(!! 
$str!! 
)!! 
]!!  
public"" 
string"" 
Status"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
[$$ 	
JsonProperty$$	 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 
string%% 
Email%% 
{%% 
get%% !
;%%! "
set%%# &
;%%& '
}%%( )
['' 	
JsonProperty''	 
('' 
$str'' 
)'' 
]'' 
public(( 
string(( 
Phone(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
[** 	
JsonProperty**	 
(** 
$str** 
)** 
]** 
public++ 
string++ 
Name++ 
{++ 
get++  
;++  !
set++" %
;++% &
}++' (
[-- 	
JsonProperty--	 
(-- 
$str--  
,--  !
NullValueHandling--" 3
=--4 5
NullValueHandling--6 G
.--G H
Ignore--H N
)--N O
]--O P
public.. 
string.. 
CcEmail.. 
{.. 
get..  #
;..# $
set..% (
;..( )
}..* +
}// 
public11 

partial11 
class11 %
GetPublishersListResponse11 2
{22 
public33 
static33 %
GetPublishersListResponse33 /
FromJson330 8
(338 9
string339 ?
json33@ D
)33D E
=>33F H
JsonConvert33I T
.33T U
DeserializeObject33U f
<33f g&
GetPublishersListResponse	33g Ä
>
33Ä Å
(
33Å Ç
json
33Ç Ü
,
33Ü á
	Converter
33à ë
.
33ë í
Settings
33í ö
)
33ö õ
;
33õ ú
}44 
public66 

static66 
class66 
	Serialize66 !
{77 
public88 
static88 
string88 
ToJson88 #
(88# $
this88$ (%
GetPublishersListResponse88) B
self88C G
)88G H
=>88I K
JsonConvert88L W
.88W X
SerializeObject88X g
(88g h
self88h l
,88l m
	Converter88n w
.88w x
Settings	88x Ä
)
88Ä Å
;
88Å Ç
}99 
internal;; 
static;; 
class;; 
	Converter;; #
{<< 
public== 
static== 
readonly== "
JsonSerializerSettings== 5
Settings==6 >
===? @
new==A D"
JsonSerializerSettings==E [
{>> 	$
MetadataPropertyHandling?? $
=??% &$
MetadataPropertyHandling??' ?
.??? @
Ignore??@ F
,??F G
DateParseHandling@@ 
=@@ 
DateParseHandling@@  1
.@@1 2
None@@2 6
,@@6 7

ConvertersAA 
=AA 
{AA 
newBB  
IsoDateTimeConverterBB (
{BB) *
DateTimeStylesBB+ 9
=BB: ;
DateTimeStylesBB< J
.BBJ K
AssumeUniversalBBK Z
}BB[ \
}CC 
,CC 
}DD 	
;DD	 

}EE 
}FF ›
^D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\HasOffers\Publishers\PublishersManager.cs
	namespace		 	
ADSDataDirect		
 
.		 
Infrastructure		 &
.		& '
	HasOffers		' 0
.		0 1

Publishers		1 ;
{

 
public 

class 
PublishersManager "
:# $
HasOffersManager% 5
{ 
public %
GetPublishersListResponse (
List) -
(- .
). /
{ 	
using 
( 

HttpClient 
client $
=% &
new' *

HttpClient+ 5
(5 6
)6 7
)7 8
{ 
client 
. 
Timeout 
=  
TimeSpan! )
.) *
FromMinutes* 5
(5 6
$num6 7
)7 8
;8 9
string 

requestUri !
=" #
$"$ &
{& '
baseURL' .
}. /"
/affiliate/list?token=/ E
{E F
tokenF K
}K L
&limit=10&offset=10L _
"_ `
;` a
using 
( 
HttpResponseMessage *
response+ 3
=4 5
client6 <
.< =
GetAsync= E
(E F

requestUriF P
)P Q
.Q R
ResultR X
)X Y
using 
( 
HttpContent "
content# *
=+ ,
response- 5
.5 6
Content6 =
)= >
{ 
string 
responseContent *
=+ ,
content- 4
.4 5
ReadAsStringAsync5 F
(F G
)G H
.H I
ResultI O
;O P%
GetPublishersListResponse -&
getAdvertisersListResponse. H
;H I
try 
{ &
getAdvertisersListResponse 2
=3 4%
GetPublishersListResponse5 N
.N O
FromJsonO W
(W X
responseContentX g
)g h
;h i
} 
catch 
( 
	Exception $
ex% '
)' (
{ 
throw 
new !
AdsException" .
(. /
$str/ y
)y z
;z {
} 
return   &
getAdvertisersListResponse   5
;  5 6
}!! 
}"" 
}## 	
public%% %
GetPublishersListResponse%% (
Create%%) /
(%%/ 0
)%%0 1
{&& 	
return'' 
null'' 
;'' 
}>> 	
}?? 
}@@ °p
RD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ProData\OpenModelerProData.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ProData' .
{ 
public 

sealed 
class 
OpenModelerProData *
{ 
private		 
OpenModelerProData		 "
(		" #
)		# $
{

 	
} 	
private 
static 
readonly 
SortedDictionary  0
<0 1
int1 4
,4 5
KeyValuePair6 B
<B C
intC F
,F G
intH K
>K L
>L M,
 HoursPercentageDictionaryDynamicN n
= 
new 
SortedDictionary "
<" #
int# &
,& '
KeyValuePair( 4
<4 5
int5 8
,8 9
int: =
>= >
>> ?
(? @
)@ A
{ 	
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ -
,- .
$num/ 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ -
,- .
$num/ 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
} 	
;	 

public 
static 
double  
GetPercentageDynamic 1
(1 2
int2 5
hr6 8
)8 9
{ 	
var 
r 
= 
new 
Random 
( 
)  
;  !
double   
finalPercentage   "
=  # $
$num  % (
;  ( )
if!! 
(!! 
hr!! 
>=!! 
$num!! 
)!! 
finalPercentage"" 
+=""  "
r""# $
.""$ %
Next""% )
("") *,
 HoursPercentageDictionaryDynamic""* J
[""J K
$num""K L
]""L M
.""M N
Key""N Q
,""Q R,
 HoursPercentageDictionaryDynamic""S s
[""s t
$num""t u
]""u v
.""v w
Value""w |
)""| }
/""~ 
$num
""Ä á
;
""á à
if## 
(## 
hr## 
>=## 
$num## 
)## 
finalPercentage$$ 
+=$$  "
r$$# $
.$$$ %
Next$$% )
($$) *,
 HoursPercentageDictionaryDynamic$$* J
[$$J K
$num$$K L
]$$L M
.$$M N
Key$$N Q
,$$Q R,
 HoursPercentageDictionaryDynamic$$S s
[$$s t
$num$$t u
]$$u v
.$$v w
Value$$w |
)$$| }
/$$~ 
$num
$$Ä á
;
$$á à
if%% 
(%% 
hr%% 
>=%% 
$num%% 
)%% 
finalPercentage&& 
+=&&  "
r&&# $
.&&$ %
Next&&% )
(&&) *,
 HoursPercentageDictionaryDynamic&&* J
[&&J K
$num&&K L
]&&L M
.&&M N
Key&&N Q
,&&Q R,
 HoursPercentageDictionaryDynamic&&S s
[&&s t
$num&&t u
]&&u v
.&&v w
Value&&w |
)&&| }
/&&~ 
$num
&&Ä á
;
&&á à
if'' 
('' 
hr'' 
>='' 
$num'' 
)'' 
finalPercentage(( 
+=((  "
r((# $
.(($ %
Next((% )
((() *,
 HoursPercentageDictionaryDynamic((* J
[((J K
$num((K L
]((L M
.((M N
Key((N Q
,((Q R,
 HoursPercentageDictionaryDynamic((S s
[((s t
$num((t u
]((u v
.((v w
Value((w |
)((| }
/((~ 
$num
((Ä á
;
((á à
if)) 
()) 
hr)) 
>=)) 
$num)) 
))) 
finalPercentage** 
+=**  "
r**# $
.**$ %
Next**% )
(**) *,
 HoursPercentageDictionaryDynamic*** J
[**J K
$num**K L
]**L M
.**M N
Key**N Q
,**Q R,
 HoursPercentageDictionaryDynamic**S s
[**s t
$num**t u
]**u v
.**v w
Value**w |
)**| }
/**~ 
$num
**Ä á
;
**á à
if++ 
(++ 
hr++ 
>=++ 
$num++ 
)++ 
finalPercentage,, 
+=,,  "
r,,# $
.,,$ %
Next,,% )
(,,) *,
 HoursPercentageDictionaryDynamic,,* J
[,,J K
$num,,K M
],,M N
.,,N O
Key,,O R
,,,R S,
 HoursPercentageDictionaryDynamic,,T t
[,,t u
$num,,u w
],,w x
.,,x y
Value,,y ~
),,~ 
/
,,Ä Å
$num
,,Ç â
;
,,â ä
if-- 
(-- 
hr-- 
>=-- 
$num-- 
)-- 
finalPercentage.. 
+=..  "
r..# $
...$ %
Next..% )
(..) *,
 HoursPercentageDictionaryDynamic..* J
[..J K
$num..K M
]..M N
...N O
Key..O R
,..R S,
 HoursPercentageDictionaryDynamic..T t
[..t u
$num..u w
]..w x
...x y
Value..y ~
)..~ 
/
..Ä Å
$num
..Ç â
;
..â ä
if// 
(// 
hr// 
>=// 
$num// 
)// 
finalPercentage00 
+=00  "
r00# $
.00$ %
Next00% )
(00) *,
 HoursPercentageDictionaryDynamic00* J
[00J K
$num00K M
]00M N
.00N O
Key00O R
,00R S,
 HoursPercentageDictionaryDynamic00T t
[00t u
$num00u w
]00w x
.00x y
Value00y ~
)00~ 
/
00Ä Å
$num
00Ç â
;
00â ä
if11 
(11 
hr11 
>=11 
$num11 
)11 
finalPercentage22 
+=22  "
r22# $
.22$ %
Next22% )
(22) *,
 HoursPercentageDictionaryDynamic22* J
[22J K
$num22K M
]22M N
.22N O
Key22O R
,22R S,
 HoursPercentageDictionaryDynamic22T t
[22t u
$num22u w
]22w x
.22x y
Value22y ~
)22~ 
/
22Ä Å
$num
22Ç â
;
22â ä
if33 
(33 
hr33 
>=33 
$num33 
)33 
finalPercentage44 
+=44  "
r44# $
.44$ %
Next44% )
(44) *,
 HoursPercentageDictionaryDynamic44* J
[44J K
$num44K M
]44M N
.44N O
Key44O R
,44R S,
 HoursPercentageDictionaryDynamic44T t
[44t u
$num44u w
]44w x
.44x y
Value44y ~
)44~ 
/
44Ä Å
$num
44Ç â
;
44â ä
if55 
(55 
hr55 
>=55 
$num55 
)55 
finalPercentage66 
+=66  "
r66# $
.66$ %
Next66% )
(66) *,
 HoursPercentageDictionaryDynamic66* J
[66J K
$num66K M
]66M N
.66N O
Key66O R
,66R S,
 HoursPercentageDictionaryDynamic66T t
[66t u
$num66u w
]66w x
.66x y
Value66y ~
)66~ 
/
66Ä Å
$num
66Ç â
;
66â ä
return77 
finalPercentage77 "
;77" #
}88 	
private:: 
static:: 
readonly:: 
SortedDictionary::  0
<::0 1
int::1 4
,::4 5
double::6 <
>::< =%
HoursPercentageDictionary::> W
=::X Y
new::Z ]
SortedDictionary::^ n
<::n o
int::o r
,::r s
double::t z
>::z {
(::{ |
)::| }
{;; 	
{<< 
$num<< 
,<< 
$num<< 
}<< 
,<< 
{<< 
$num<< 
,<< 
$num<< $
}<<$ %
,<<% &
{<<' (
$num<<( )
,<<) *
$num<<+ 1
}<<1 2
,<<2 3
{<<4 5
$num<<5 7
,<<7 8
$num<<9 ?
}<<? @
,<<@ A
{<<B C
$num<<C E
,<<E F
$num<<G M
}<<M N
,<<N O
{<<P Q
$num<<Q S
,<<S T
$num<<U [
}<<[ \
,<<\ ]
{<<^ _
$num<<_ a
,<<a b
$num<<c i
}<<i j
,<<j k
{<<l m
$num<<m o
,<<o p
$num<<q w
}<<w x
,<<x y
{<<z {
$num<<{ }
,<<} ~
$num	<< Ö
}
<<Ö Ü
}== 	
;==	 

publicCC 
staticCC 
doubleCC 
GetPercentageCC *
(CC* +
intCC+ .
hrCC/ 1
)CC1 2
{DD 	
ifEE 
(EE 
hrEE 
>=EE 
$numEE 
)EE 
returnEE  %
HoursPercentageDictionaryEE! :
[EE: ;
$numEE; =
]EE= >
;EE> ?
intGG 
actualHrGG 
=GG 
-GG 
$numGG 
;GG 
intHH 
[HH 
]HH 
hrsHH 
=HH %
HoursPercentageDictionaryHH 1
.HH1 2
KeysHH2 6
.HH6 7
ToArrayHH7 >
(HH> ?
)HH? @
;HH@ A
forII 
(II 
intII 
iII 
=II 
$numII 
;II 
iII 
<II 
hrsII  #
.II# $
LengthII$ *
;II* +
iII, -
++II- /
)II/ 0
{JJ 
ifKK 
(KK 
hrKK 
>=KK 
hrsKK 
[KK 
iKK 
]KK  
&&KK! #
hrKK$ &
<KK' (
hrsKK) ,
[KK, -
iKK- .
+KK/ 0
$numKK1 2
]KK2 3
)KK3 4
{LL 
actualHrMM 
=MM 
hrsMM "
[MM" #
iMM# $
]MM$ %
;MM% &
breakNN 
;NN 
}OO 
}PP 
returnQQ %
HoursPercentageDictionaryQQ ,
[QQ, -
actualHrQQ- 5
]QQ5 6
;QQ6 7
}RR 	
publicTT 
staticTT 
intTT 
GetOpensTT "
(TT" #
longTT# '
quantityTT( 0
,TT0 1
DateTimeTT2 :
startDateTimeTT; H
)TTH I
{UU 	
intVV 
	hrsPassedVV 
=VV 
(VV 
intVV  
)VV  !
MathVV! %
.VV% &
RoundVV& +
(VV+ ,
(VV, -
DateTimeVV- 5
.VV5 6
NowVV6 9
-VV: ;
startDateTimeVV< I
)VVI J
.VVJ K

TotalHoursVVK U
)VVU V
;VVV W
returnWW 
(WW 
intWW 
)WW 
MathWW 
.WW 
RoundWW "
(WW" #
quantityWW# +
*WW, - 
GetPercentageDynamicWW. B
(WWB C
	hrsPassedWWC L
)WWL M
)WWM N
;WWN O
}XX 	
}YY 
}ZZ èt
\D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Notifications\NotificationsProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
Notifications' 4
{ 
public 

static 
class "
NotificationsProcessor .
{ 
static 
string 

ClientCode  
{! "
get# &
;& '
}( )
=* +
System, 2
.2 3
Configuration3 @
.@ A 
ConfigurationManagerA U
.U V
AppSettingsV a
[a b
$strb n
]n o
;o p
static 
bool 
IsNxs 
=> 

ClientCode '
==( *
Client+ 1
.1 2
NXS2 5
.5 6
ToString6 >
(> ?
)? @
;@ A
public 
static 
void #
FetchAndCheckForQcRules 2
(2 3
)3 4
{ 	
DateTime 
dtFrom 
= 
DateTime &
.& '
Now' *
.* +
AddDays+ 2
(2 3
-3 4
$num4 6
)6 7
;7 8
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
bool !
isAutoProcessTracking *
=+ ,
false- 2
;2 3
var 
settingAuto 
=  !
db" $
.$ %
Settings% -
.- .
FirstOrDefault. <
(< =
x= >
=>? A
xB C
.C D
KeyD G
==H J
StringConstantsK Z
.Z ["
KeyAutoProcessTracking[ q
)q r
;r s
if 
( 
settingAuto 
!=  "
null# '
)' (!
isAutoProcessTracking) >
=? @
intA D
.D E
ParseE J
(J K
settingAutoK V
.V W
ValueW \
)\ ]
==^ `
$numa b
;b c
if   
(   !
isAutoProcessTracking   )
)  ) *
{!! 
db## 
.## 

SystemLogs## !
.##! "
Where##" '
(##' (
x##( )
=>##* ,
x##- .
.##. /
LogType##/ 6
==##7 9
(##: ;
int##; >
)##> ?
LogType##? F
.##F G
RulesProcessing##G V
||##W Y
x##Z [
.##[ \
LogType##\ c
==##d f
(##g h
int##h k
)##k l
LogType##l s
.##s t
Vendor##t z
)##z {
.##{ |
Delete	##| Ç
(
##Ç É
)
##É Ñ
;
##Ñ Ö
db$$ 
.$$ 
SaveChanges$$ "
($$" #
)$$# $
;$$$ %
	LogHelper&& 
.&& 
AddLog&& $
(&&$ %
db&&% '
,&&' (
LogType&&) 0
.&&0 1
RulesProcessing&&1 @
,&&@ A
$str&&B D
,&&D E
$"&&F H/
#FetchAndCheckForQCRules started at &&H k
{&&k l
DateTime&&l t
.&&t u
Now&&u x
}&&x y
"&&y z
)&&z {
;&&{ |
List)) 
<)) 
Campaign)) !
>))! "
	campaigns))# ,
=))- .
db))/ 1
.))1 2
	Campaigns))2 ;
.** 
Include**  
(**  !
x**! "
=>**# %
x**& '
.**' (
Testing**( /
)**/ 0
.++ 
Include++  
(++  !
x++! "
=>++# %
x++& '
.++' (
Approved++( 0
)++0 1
.,, 
Include,,  
(,,  !
x,,! "
=>,,# %
x,,& '
.,,' (
Segments,,( 0
),,0 1
.-- 
Include--  
(--  !
x--! "
=>--# %
x--& '
.--' (
	Trackings--( 1
)--1 2
... 
Where.. 
(.. 
x..  
=>..! #
x..$ %
...% &
Status..& ,
==..- /
(..0 1
int..1 4
)..4 5
CampaignStatus..5 C
...C D

Monitoring..D N
||..O Q
x..R S
...S T
Segments..T \
...\ ]
Any..] `
(..` a
s..a b
=>..c e
s..f g
...g h
SegmentStatus..h u
==..v x
(..y z
int..z }
)..} ~
SegmentStatus	..~ ã
.
..ã å

Monitoring
..å ñ
)
..ñ ó
)
..ó ò
.// 
Where// 
(// 
x//  
=>//! #
x//$ %
.//% &
Approved//& .
!=/// 1
null//2 6
)//6 7
.00 
Where00 
(00 
x00  
=>00! #
DbFunctions00$ /
.00/ 0
TruncateTime000 <
(00< =
x00= >
.00> ?
	CreatedAt00? H
)00H I
>=00J L
dtFrom00M S
)00S T
.11 
Where11 
(11 
x11  
=>11! #
!11$ %
string11% +
.11+ ,
IsNullOrEmpty11, 9
(119 :
x11: ;
.11; <
Testing11< C
.11C D#
ClickMeterRotatorLinkId11D [
)11[ \
)11\ ]
.22 
ToList22 
(22  
)22  !
;22! "
	LogHelper44 
.44 
AddLog44 $
(44$ %
db44% '
,44' (
LogType44) 0
.440 1
RulesProcessing441 @
,44@ A
$str44B D
,44D E
$"44F H/
#FetchAndCheckForQCRules processing 44H k
{44k l
	campaigns44l u
.44u v
Count44v {
}44{ |
 campaigns.	44| á
"
44á à
)
44à â
;
44â ä
int77 
index77 
=77 
$num77  !
;77! "
foreach88 
(88 
var88  
campaign88! )
in88* ,
	campaigns88- 6
)886 7
{99 
if:: 
(:: 
IsNxs:: !
)::! "
{;; $
ClickMeterModelProcessor<< 4
.<<4 5"
PopulateFromClickMeter<<5 K
(<<K L
db<<L N
,<<N O
campaign<<P X
)<<X Y
;<<Y Z
}== 
else>> 
{?? 
ProDataApiManager@@ -
.@@- .#
FetchAndUpdateTrackings@@. E
(@@E F
db@@F H
,@@H I
campaign@@J R
)@@R S
;@@S T
}AA 
	LogHelperBB !
.BB! "
AddLogBB" (
(BB( )
dbBB) +
,BB+ ,
LogTypeBB- 4
.BB4 5
RulesProcessingBB5 D
,BBD E
$strBBF H
,BBH I
$"BBJ L.
"FetchAndCheckForQCRules completed BBL n
{BBn o
indexBBo t
}BBt u
 out of BBu }
{BB} ~
	campaigns	BB~ á
.
BBá à
Count
BBà ç
}
BBç é
 campaigns.
BBé ô
"
BBô ö
)
BBö õ
;
BBõ ú
indexCC 
++CC 
;CC  
}DD 
varHH 
toBeExpiredHH #
=HH$ %
dbHH& (
.HH( )
NotificationsHH) 6
.HH6 7
ToListHH7 =
(HH= >
)HH> ?
.II 
WhereII "
(II" #
xII# $
=>II% '
xII( )
.II) *
FoundAtII* 1
!=II2 4
nullII5 9
&&II: <
DateTimeII= E
.IIE F
NowIIF I
.III J
SubtractIIJ R
(IIR S
xIIS T
.IIT U
FoundAtIIU \
.II\ ]
ValueII] b
)IIb c
.IIc d
HoursIId i
>=IIj l
$numIIm p
)IIp q
.JJ 
ToListJJ #
(JJ# $
)JJ$ %
;JJ% &
ifKK 
(KK 
toBeExpiredKK #
.KK# $
CountKK$ )
>KK* +
$numKK, -
)KK- .
{LL 
	LogHelperMM !
.MM! "
AddLogMM" (
(MM( )
dbMM) +
,MM+ ,
LogTypeMM- 4
.MM4 5
RulesProcessingMM5 D
,MMD E
$strMMF H
,MMH I
$strMMJ m
)MMm n
;MMn o
foreachNN 
(NN  !
varNN! $
notificationNN% 1
inNN2 4
toBeExpiredNN5 @
)NN@ A
{OO 
notificationPP (
.PP( )
StatusPP) /
=PP0 1
(PP2 3
intPP3 6
)PP6 7
NotificationStatusPP7 I
.PPI J
ExpiredPPJ Q
;PPQ R
}QQ 
dbRR 
.RR 
SaveChangesRR &
(RR& '
)RR' (
;RR( )
}SS 
	LogHelperUU 
.UU 
AddLogUU $
(UU$ %
dbUU% '
,UU' (
LogTypeUU) 0
.UU0 1
RulesProcessingUU1 @
,UU@ A
$strUUB D
,UUD E
$"UUF H0
$FetchAndCheckForQCRules finished at UUH l
{UUl m
DateTimeUUm u
.UUu v
NowUUv y
}UUy z
, UUz |
{UU| }
	campaigns	UU} Ü
.
UUÜ á
Count
UUá å
}
UUå ç#
 campaigns refreshed.
UUç ¢
"
UU¢ £
)
UU£ §
;
UU§ •
}VV 
}WW 
}XX 	
publicZZ 
staticZZ 
voidZZ "
SendNotificationEmailsZZ 1
(ZZ1 2
)ZZ2 3
{[[ 	
using\\ 
(\\ 
var\\ 
db\\ 
=\\ 
new\\ 
WfpictContext\\  -
(\\- .
)\\. /
)\\/ 0
{]] 
bool^^ $
isSendNotificationEmails^^ -
=^^. /
false^^0 5
;^^5 6
var__ $
settingSendNotifications__ ,
=__- .
db__/ 1
.__1 2
Settings__2 :
.__: ;
FirstOrDefault__; I
(__I J
x__J K
=>__L N
x__O P
.__P Q
Key__Q T
==__U W
StringConstants__X g
.__g h&
KeySendNotificationEmails	__h Å
)
__Å Ç
;
__Ç É
if`` 
(`` $
settingSendNotifications`` ,
!=``- /
null``0 4
)``4 5$
isSendNotificationEmails``6 N
=``O P
int``Q T
.``T U
Parse``U Z
(``Z [$
settingSendNotifications``[ s
.``s t
Value``t y
)``y z
==``{ }
$num``~ 
;	`` Ä
ifaa 
(aa 
!aa $
isSendNotificationEmailsaa ,
)aa, -
returnaa. 4
;aa4 5
varee 
	campaignsee 
=ee 
(ee  !
fromee! %
cee& '
inee( *
dbee+ -
.ee- .
	Campaignsee. 7
joinff  $
nff% &
inff' )
dbff* ,
.ff, -
Notificationsff- :
onff; =
cff> ?
.ff? @
Idff@ B
equalsffC I
nffJ K
.ffK L

CampaignIdffL V
wheregg  %
ngg& '
.gg' (
Statusgg( .
==gg/ 1
(gg2 3
intgg3 6
)gg6 7
NotificationStatusgg7 I
.ggI J
FoundggJ O
&&hh  "
(hh# $
chh$ %
.hh% &
Statushh& ,
==hh- /
(hh0 1
inthh1 4
)hh4 5
CampaignStatushh5 C
.hhC D

MonitoringhhD N
||hhO Q
cii$ %
.ii% &
Segmentsii& .
.ii. /
Anyii/ 2
(ii2 3
sii3 4
=>ii5 7
sii8 9
.ii9 :
SegmentStatusii: G
==iiH J
(iiK L
intiiL O
)iiO P
SegmentStatusiiP ]
.ii] ^

Monitoringii^ h
)iih i
)iii j
selectjj! '
cjj( )
)jj) *
.kk  !
Distinctkk! )
(kk) *
)kk* +
.ll  !
Includell! (
(ll( )
xll) *
=>ll+ -
xll. /
.ll/ 0
Testingll0 7
)ll7 8
.mm  !
Includemm! (
(mm( )
xmm) *
=>mm+ -
xmm. /
.mm/ 0
	Trackingsmm0 9
)mm9 :
.nn  !
Includenn! (
(nn( )
xnn) *
=>nn+ -
xnn. /
.nn/ 0
Notificationsnn0 =
)nn= >
.oo  !
OrderByDescendingoo! 2
(oo2 3
xoo3 4
=>oo5 7
xoo8 9
.oo9 :
	CreatedAtoo: C
)ooC D
.pp  !
ThenBypp! '
(pp' (
xpp( )
=>pp* ,
xpp- .
.pp. /
OrderNumberpp/ :
)pp: ;
.qq  !
ToListqq! '
(qq' (
)qq( )
;qq) *
varss 
vendorss 
=ss 
dbss 
.ss  
Vendorsss  '
.ss' (
FirstOrDefaultss( 6
(ss6 7
xss7 8
=>ss9 ;
xss< =
.ss= >
Namess> B
.ssB C
ToLowerssC J
(ssJ K
)ssK L
.ssL M
ContainsssM U
(ssU V
$strssV ]
)ss] ^
)ss^ _
;ss_ `
iftt 
(tt 
vendortt 
==tt 
nulltt "
)tt" #
vendoruu 
=uu 
dbuu 
.uu  
Vendorsuu  '
.uu' (
FirstOrDefaultuu( 6
(uu6 7
xuu7 8
=>uu9 ;
xuu< =
.uu= >
Nameuu> B
.uuB C
ToLoweruuC J
(uuJ K
)uuK L
.uuL M
ContainsuuM U
(uuU V
$struuV \
)uu\ ]
)uu] ^
;uu^ _
ifww 
(ww 
	campaignsww 
.ww 
Countww #
>ww$ %
$numww& '
)ww' (
{xx 
	LogHelperyy 
.yy 
AddLogyy $
(yy$ %
dbyy% '
,yy' (
LogTypeyy) 0
.yy0 1
RulesProcessingyy1 @
,yy@ A
$stryyB D
,yyD E
$stryyF c
)yyc d
;yyd e
EmailHelperzz 
.zz  %
SendNotificationsToVendorzz  9
(zz9 :
vendorzz: @
,zz@ A
	campaignszzB K
)zzK L
;zzL M
}{{ 
}|| 
}}} 	
} 
}ÄÄ û´
QD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ProData\ProDataApiManager.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ProData' .
{ 
public 

class 
ProDataApiManager "
:# $ 
NotificationRecorder% 9
{ 
private 
static 
string 
_urlTracking *
=+ ,
$str- t
;t u
private 
static 
string 
_urlCreateOrder -
=. /
$str0 x
;x y
private 
static 
string 
_prodataAuth *
=+ ,
$str- O
;O P
public 
static 
readonly 
string %
Success& -
=. /
$str0 9
;9 :
public 
static 
readonly 
string %
Error& +
=, -
$str. 5
;5 6
static 
readonly 
Random 
Random %
=& '
new( +
Random, 2
(2 3
)3 4
;4 5
public 
static 
void 
Load 
(  
)  !
{ 	
string 
json 
= 
File 
. 
ReadAllText *
(* +
$"+ -
C:\\resp.txt- 9
"9 :
): ;
;; <
ProDataResponse 
m 
= 
JsonConvert  +
.+ ,
DeserializeObject, =
<= >
ProDataResponse> M
>M N
(N O
jsonO S
)S T
;T U
} 	
public!! 
static!! 
ProDataResponse!! %
Create!!& ,
(!!, -
Campaign!!- 5
campaign!!6 >
,!!> ?
CampaignSegment!!@ O
segment!!P W
,!!W X
string!!Y _
whiteLabelDomain!!` p
)!!p q
{"" 	
string## 
orderNumber## 
=##  
segment##! (
!=##) +
null##, 0
?##1 2
$"##3 5
ADS##5 8
{##8 9
segment##9 @
.##@ A
SegmentNumber##A N
}##N O
"##O P
:##Q R
($$ 
campaign$$ %
.$$% &
ReBroadcasted$$& 3
?$$4 5
$"$$6 8
ADS$$8 ;
{$$; <
campaign$$< D
.$$D E$
ReBroadcastedOrderNumber$$E ]
}$$] ^
"$$^ _
:$$` a
$"$$b d
ADS$$d g
{$$g h
campaign$$h p
.$$p q
OrderNumber$$q |
}$$| }
"$$} ~
)$$~ 
;	$$ Ä
double&& 

ctrPercent&& 
=&& 
campaign&&  (
.&&( )
Approved&&) 1
.&&1 2
	OpenGoals&&2 ;
==&&< >
$num&&? @
?&&A B
$num&&C D
:&&E F
('' 
double'' 
)'' 
campaign''  
.''  !
Approved''! )
.'') *

ClickGoals''* 4
/''5 6
campaign''7 ?
.''? @
Approved''@ H
.''H I
	OpenGoals''I R
;''R S
if)) 
()) 

ctrPercent)) 
>)) 
$num))  
)))  !

ctrPercent))" ,
=))- .

ctrPercent))/ 9
/)): ;
$num))< A
;))A B
ProDataRequest++ 
request++ "
=++# $
new++% (
ProDataRequest++) 7
(++7 8
)++8 9
{,, 
io-- 
=-- 
orderNumber--  
,--  !
campaign_name.. 
=.. 
campaign..  (
...( )
Approved..) 1
...1 2
CampaignName..2 >
,..> ?
is_rebroadcast// 
=//  
campaign//! )
.//) *
Approved//* 2
.//2 3
ReBroadCast//3 >
?//? @
$str//A D
://E F
$str//G J
,//J K
white_label00 
=00 
whiteLabelDomain00 .
,00. /
creative_url11 
=11 
campaign11 '
.11' (
Assets11( .
.11. /
CreativeUrl11/ :
,11: ;
quantity22 
=22 
campaign22 #
.22# $
Approved22$ ,
.22, -
Quantity22- 5
,225 6
geo_type33 
=33 
$str33 '
,33' (
geo_url44 
=44 
campaign44 "
.44" #
Assets44# )
.44) *

ZipCodeUrl44* 4
,444 5
open_percent55 
=55 
(55  
double55  &
)55& '
campaign55' /
.55/ 0
Approved550 8
.558 9
	OpenGoals559 B
/55C D
campaign55E M
.55M N
Approved55N V
.55V W
Quantity55W _
,55_ `
ctr_percent66 
=66 

ctrPercent66 (
,66( )
subject77 
=77 
campaign77 "
.77" #
Approved77# +
.77+ ,
SubjectLine77, 7
,777 8
	from_name88 
=88 
campaign88 $
.88$ %
Approved88% -
.88- .
FromLine88. 6
,886 7

from_email99 
=99 
campaign99 %
.99% &
RepresentativeEmail99& 9
,999 :
deploy_date:: 
=:: 
campaign:: &
.::& '
Approved::' /
.::/ 0

DeployDate::0 :
?::: ;
.::; <
ToString::< D
(::D E
StringConstants::E T
.::T U 
DateTimeFormatDashes::U i
)::i j
,::j k
};; 
;;; 
if== 
(== 
campaign== 
.== 
Approved== !
.==! "
IsOpenPixel==" -
)==- .
{>> 
request?? 
.?? 
is_open_pixel?? %
=??& '
$str??( +
;??+ ,
request@@ 
.@@ 

open_pixel@@ "
=@@# $
campaign@@% -
.@@- .
Approved@@. 6
.@@6 7
OpenPixelUrl@@7 C
;@@C D
}AA 
elseBB 
{CC 
requestDD 
.DD 
is_open_pixelDD %
=DD& '
$strDD( +
;DD+ ,
}EE 
ifHH 
(HH 
!HH 
stringHH 
.HH 
IsNullOrEmptyHH %
(HH% &
segmentHH& -
?HH- .
.HH. /
SegmentDataFileUrlHH/ A
)HHA B
)HHB C
{II 
requestJJ 
.JJ 
is_data_fileJJ $
=JJ% &
$strJJ' *
;JJ* +
requestKK 
.KK 
data_file_urlKK %
=KK& '
segmentKK( /
.KK/ 0
SegmentDataFileUrlKK0 B
;KKB C
requestLL 
.LL '
data_file_replacement_paramLL 3
=LL4 5
segmentLL6 =
.LL= >
SegmentNumberLL> K
;LLK L
requestMM 
.MM (
data_file_replacement_columnMM 4
=MM5 6
$strMM7 :
;MM: ;
requestNN 
.NN 
data_file_unique_ipNN +
=NN, -
$strNN. 1
;NN1 2
}OO 
elsePP 
requestQQ 
.QQ 
is_data_fileQQ $
=QQ% &
$strQQ' *
;QQ* +
returnSS 
CreateSS 
(SS 
requestSS !
)SS! "
;SS" #
}TT 	
privateVV 
staticVV 
ProDataResponseVV &
CreateVV' -
(VV- .
ProDataRequestVV. <
requestVV= D
)VVD E
{WW 	
usingXX 
(XX 

HttpClientXX 
clientXX $
=XX% &
newXX' *

HttpClientXX+ 5
(XX5 6
)XX6 7
)XX7 8
{YY 
clientZZ 
.ZZ 
TimeoutZZ 
=ZZ  
TimeSpanZZ! )
.ZZ) *
FromMinutesZZ* 5
(ZZ5 6
$numZZ6 7
)ZZ7 8
;ZZ8 9
client[[ 
.[[ !
DefaultRequestHeaders[[ ,
.[[, -
Add[[- 0
([[0 1
$str[[1 E
,[[E F
_prodataAuth[[G S
)[[S T
;[[T U
var\\ 
httpContent\\ 
=\\  !
new\\" %
StringContent\\& 3
(\\3 4
request\\4 ;
.\\; <
ToJson\\< B
(\\B C
)\\C D
,\\D E
Encoding\\F N
.\\N O
UTF8\\O S
,\\S T
$str\\U g
)\\g h
;\\h i
using]] 
(]] 
HttpResponseMessage]] *
response]]+ 3
=]]4 5
client]]6 <
.]]< =
	PostAsync]]= F
(]]F G
_urlCreateOrder]]G V
,]]V W
httpContent]]X c
)]]c d
.]]d e
Result]]e k
)]]k l
using^^ 
(^^ 
HttpContent^^ "
content^^# *
=^^+ ,
response^^- 5
.^^5 6
Content^^6 =
)^^= >
{__ 
string`` 
responseContent`` *
=``+ ,
content``- 4
.``4 5
ReadAsStringAsync``5 F
(``F G
)``G H
.``H I
Result``I O
;``O P
ProDataResponseaa #
proDataResponseaa$ 3
;aa3 4
trybb 
{cc 
proDataResponsedd '
=dd( )
JsonConvertdd* 5
.dd5 6
DeserializeObjectdd6 G
<ddG H
ProDataResponseddH W
>ddW X
(ddX Y
responseContentddY h
)ddh i
;ddi j
proDataResponseee '
.ee' (
RequestMessageee( 6
=ee7 8
requestee9 @
.ee@ A
ToStringeeA I
(eeI J
)eeJ K
;eeK L
}ff 
catchgg 
(gg 
	Exceptiongg $
exgg% '
)gg' (
{hh 
throwii 
newii !
AdsExceptionii" .
(ii. /
$strii/ u
)iiu v
;iiv w
}jj 
returnkk 
proDataResponsekk *
;kk* +
}ll 
}mm 
}nn 	
privaterr 
staticrr 
ProDataResponserr &
Fetchrr' ,
(rr, -
stringrr- 3
orderNumberrr4 ?
)rr? @
{ss 	
iftt 
(tt  
ConfigurationManagertt $
.tt$ %
AppSettingstt% 0
[tt0 1
$strtt1 9
]tt9 :
==tt; =
$strtt> E
)ttE F
{uu 
orderNumbervv 
=vv 
$strvv $
;vv$ %
}ww 
ProDataResponseyy 
proDataResponseyy +
=yy, -
nullyy. 2
;yy2 3
stringzz 
urlzz 
=zz 
stringzz 
.zz  
Formatzz  &
(zz& '
_urlTrackingzz' 3
,zz3 4
orderNumberzz5 @
)zz@ A
;zzA B
using{{ 
({{ 

HttpClient{{ 
client{{ $
={{% &
new{{' *

HttpClient{{+ 5
({{5 6
){{6 7
){{7 8
{|| 
client}} 
.}} 
Timeout}} 
=}}  
TimeSpan}}! )
.}}) *
FromMinutes}}* 5
(}}5 6
$num}}6 7
)}}7 8
;}}8 9
client~~ 
.~~ !
DefaultRequestHeaders~~ ,
.~~, -
Add~~- 0
(~~0 1
$str~~1 E
,~~E F
_prodataAuth~~G S
)~~S T
;~~T U
using 
( 
HttpResponseMessage *
response+ 3
=4 5
client6 <
.< =
GetAsync= E
(E F
urlF I
)I J
.J K
ResultK Q
)Q R
using
ÄÄ 
(
ÄÄ 
HttpContent
ÄÄ "
content
ÄÄ# *
=
ÄÄ+ ,
response
ÄÄ- 5
.
ÄÄ5 6
Content
ÄÄ6 =
)
ÄÄ= >
{
ÅÅ 
string
ÇÇ 
responseContent
ÇÇ *
=
ÇÇ+ ,
content
ÇÇ- 4
.
ÇÇ4 5
ReadAsStringAsync
ÇÇ5 F
(
ÇÇF G
)
ÇÇG H
.
ÇÇH I
Result
ÇÇI O
;
ÇÇO P
try
ÉÉ 
{
ÑÑ 
proDataResponse
ÖÖ '
=
ÖÖ( )
JsonConvert
ÖÖ* 5
.
ÖÖ5 6
DeserializeObject
ÖÖ6 G
<
ÖÖG H
ProDataResponse
ÖÖH W
>
ÖÖW X
(
ÖÖX Y
responseContent
ÖÖY h
)
ÖÖh i
;
ÖÖi j
proDataResponse
ÜÜ '
.
ÜÜ' (
ResponseStatus
ÜÜ( 6
=
ÜÜ7 8#
ProDataResponseStatus
ÜÜ9 N
.
ÜÜN O
Found
ÜÜO T
.
ÜÜT U
ToString
ÜÜU ]
(
ÜÜ] ^
)
ÜÜ^ _
;
ÜÜ_ `
}
áá 
catch
àà 
(
àà 
	Exception
àà $
ex
àà% '
)
àà' (
{
ââ 
if
ää 
(
ää 
ex
ää 
.
ää 
Message
ää &
.
ää& '
ToLowerInvariant
ää' 7
(
ää7 8
)
ää8 9
.
ää9 :
Contains
ää: B
(
ääB C
$str
ääC P
)
ääP Q
)
ääQ R
{
ãã 
proDataResponse
åå +
=
åå, -
new
åå. 1
ProDataResponse
åå2 A
(
ååA B
)
ååB C
{
çç 
ResponseStatus
éé  .
=
éé/ 0#
ProDataResponseStatus
éé1 F
.
ééF G
NotFound
ééG O
.
ééO P
ToString
ééP X
(
ééX Y
)
ééY Z
,
ééZ [
ResponseMessage
èè  /
=
èè0 1
$str
èè2 M
}
êê 
;
êê 
}
ëë 
else
íí 
{
ìì 
proDataResponse
îî +
=
îî, -
new
îî. 1
ProDataResponse
îî2 A
(
îîA B
)
îîB C
{
ïï 
ResponseStatus
ññ  .
=
ññ/ 0#
ProDataResponseStatus
ññ1 F
.
ññF G
Error
ññG L
.
ññL M
ToString
ññM U
(
ññU V
)
ññV W
,
ññW X
ResponseMessage
óó  /
=
óó0 1
$str
óó2 x
}
òò 
;
òò 
}
ôô 
}
õõ 
return
ùù 
proDataResponse
ùù *
;
ùù* +
}
ûû 
}
üü 
}
†† 	
public
¢¢ 
static
¢¢ 
void
¢¢ %
FetchAndUpdateTrackings
¢¢ 2
(
¢¢2 3
WfpictContext
¢¢3 @
db
¢¢A C
,
¢¢C D
Campaign
¢¢E M
campaign
¢¢N V
)
¢¢V W
{
££ 	
	LogHelper
§§ 
.
§§ 
AddLog
§§ 
(
§§ 
db
§§ 
,
§§  
LogType
§§! (
.
§§( )
Vendor
§§) /
,
§§/ 0
campaign
§§1 9
.
§§9 :
OrderNumber
§§: E
,
§§E F
$"
§§G I"
Starting refresh at 
§§I ]
{
§§] ^
DateTime
§§^ f
.
§§f g
Now
§§g j
}
§§j k
"
§§l m
)
§§m n
;
§§n o
var
¶¶ 
settings
¶¶ 
=
¶¶ 
SettingsManager
¶¶ *
.
¶¶* +
Instance
¶¶+ 3
.
¶¶3 4
LoadSettings
¶¶4 @
(
¶¶@ A
db
¶¶A C
)
¶¶C D
;
¶¶D E
var
©© 
data
©© 
=
©© 
Fetch
©© 
(
©© 
campaign
©© %
.
©©% &
OrderNumber
©©& 1
)
©©1 2
;
©©2 3
SaveProData
™™ 
(
™™ 
db
™™ 
,
™™ 
campaign
™™ $
.
™™$ %
Id
™™% '
,
™™' (
campaign
™™) 1
.
™™1 2
OrderNumber
™™2 =
,
™™= >
string
™™? E
.
™™E F
Empty
™™F K
,
™™K L
data
™™M Q
)
™™Q R
;
™™R S
var
´´ 
campaignTracking
´´  
=
´´! "
UpdateTracking
´´# 1
(
´´1 2
db
´´2 4
,
´´4 5
campaign
´´6 >
,
´´> ?
campaign
´´@ H
.
´´H I
OrderNumber
´´I T
,
´´T U
string
´´V \
.
´´\ ]
Empty
´´] b
,
´´b c
data
´´d h
)
´´h i
;
´´i j
SaveNotification
¨¨ 
(
¨¨ 
db
¨¨ 
,
¨¨  
settings
¨¨! )
,
¨¨) *
campaign
¨¨+ 3
.
¨¨3 4
Id
¨¨4 6
,
¨¨6 7
campaign
¨¨8 @
.
¨¨@ A
OrderNumber
¨¨A L
,
¨¨L M
string
¨¨N T
.
¨¨T U
Empty
¨¨U Z
,
¨¨Z [
campaign
¨¨\ d
.
¨¨d e
Approved
¨¨e m
.
¨¨m n

DeployDate
¨¨n x
,
¨¨x y
data
¨¨z ~
.
¨¨~ 
ResponseStatus¨¨ ç
,¨¨ç é 
campaignTracking¨¨è ü
)¨¨ü †
;¨¨† °
if
ØØ 
(
ØØ 
campaign
ØØ 
.
ØØ 
ReBroadcasted
ØØ &
)
ØØ& '
{
∞∞ 
var
±± 
data1
±± 
=
±± 
Fetch
±± !
(
±±! "
campaign
±±" *
.
±±* +&
ReBroadcastedOrderNumber
±±+ C
)
±±C D
;
±±D E
SaveProData
≤≤ 
(
≤≤ 
db
≤≤ 
,
≤≤ 
campaign
≤≤  (
.
≤≤( )
Id
≤≤) +
,
≤≤+ ,
campaign
≤≤- 5
.
≤≤5 6&
ReBroadcastedOrderNumber
≤≤6 N
,
≤≤N O
string
≤≤P V
.
≤≤V W
Empty
≤≤W \
,
≤≤\ ]
data1
≤≤^ c
)
≤≤c d
;
≤≤d e
var
≥≥ 
campaignTracking1
≥≥ %
=
≥≥& '
UpdateTracking
≥≥( 6
(
≥≥6 7
db
≥≥7 9
,
≥≥9 :
campaign
≥≥; C
,
≥≥C D
campaign
≥≥E M
.
≥≥M N&
ReBroadcastedOrderNumber
≥≥N f
,
≥≥f g
string
≥≥h n
.
≥≥n o
Empty
≥≥o t
,
≥≥t u
data1
≥≥v {
)
≥≥{ |
;
≥≥| }
SaveNotification
¥¥  
(
¥¥  !
db
¥¥! #
,
¥¥# $
settings
¥¥% -
,
¥¥- .
campaign
¥¥/ 7
.
¥¥7 8
Id
¥¥8 :
,
¥¥: ;
campaign
¥¥< D
.
¥¥D E&
ReBroadcastedOrderNumber
¥¥E ]
,
¥¥] ^
string
¥¥_ e
.
¥¥e f
Empty
¥¥f k
,
¥¥k l
campaign
¥¥m u
.
¥¥u v 
ReBroadcastedDate¥¥v á
,¥¥á à
data1¥¥â é
.¥¥é è
ResponseStatus¥¥è ù
,¥¥ù û!
campaignTracking1¥¥ü ∞
)¥¥∞ ±
;¥¥± ≤
}
µµ 
foreach
∏∏ 
(
∏∏ 
var
∏∏ 
segment
∏∏  
in
∏∏! #
campaign
∏∏$ ,
.
∏∏, -
Segments
∏∏- 5
.
∏∏5 6
Where
∏∏6 ;
(
∏∏; <
x
∏∏< =
=>
∏∏> @
x
∏∏A B
.
∏∏B C
SegmentStatus
∏∏C P
==
∏∏Q S
(
∏∏T U
int
∏∏U X
)
∏∏X Y
SegmentStatus
∏∏Y f
.
∏∏f g

Monitoring
∏∏g q
)
∏∏q r
)
∏∏r s
{
ππ 
if
∫∫ 
(
∫∫ 
segment
∫∫ 
.
∫∫ 
SegmentStatus
∫∫ )
!=
∫∫* ,
(
∫∫- .
int
∫∫. 1
)
∫∫1 2
SegmentStatus
∫∫2 ?
.
∫∫? @

Monitoring
∫∫@ J
)
∫∫J K
continue
∫∫L T
;
∫∫T U
var
ºº 
data1
ºº 
=
ºº 
Fetch
ºº !
(
ºº! "
segment
ºº" )
.
ºº) *
SegmentNumber
ºº* 7
)
ºº7 8
;
ºº8 9
SaveProData
ΩΩ 
(
ΩΩ 
db
ΩΩ 
,
ΩΩ 
campaign
ΩΩ  (
.
ΩΩ( )
Id
ΩΩ) +
,
ΩΩ+ ,
campaign
ΩΩ- 5
.
ΩΩ5 6
OrderNumber
ΩΩ6 A
,
ΩΩA B
segment
ΩΩC J
.
ΩΩJ K
SegmentNumber
ΩΩK X
,
ΩΩX Y
data1
ΩΩZ _
)
ΩΩ_ `
;
ΩΩ` a
var
ææ 
campaignTracking1
ææ %
=
ææ& '
UpdateTracking
ææ( 6
(
ææ6 7
db
ææ7 9
,
ææ9 :
campaign
ææ; C
,
ææC D
campaign
ææE M
.
ææM N
OrderNumber
ææN Y
,
ææY Z
segment
ææ[ b
.
ææb c
SegmentNumber
ææc p
,
ææp q
data1
æær w
)
ææw x
;
ææx y
SaveNotification
øø  
(
øø  !
db
øø! #
,
øø# $
settings
øø% -
,
øø- .
campaign
øø/ 7
.
øø7 8
Id
øø8 :
,
øø: ;
campaign
øø< D
.
øøD E
OrderNumber
øøE P
,
øøP Q
segment
øøR Y
.
øøY Z
SegmentNumber
øøZ g
,
øøg h
segment
øøi p
.
øøp q
DeploymentDate
øøq 
,øø Ä
dataøøÅ Ö
.øøÖ Ü
ResponseStatusøøÜ î
,øøî ï!
campaignTracking1øøñ ß
)øøß ®
;øø® ©
}
¿¿ 
}
¡¡ 	
private
√√ 
static
√√ 
void
√√ 
SaveProData
√√ '
(
√√' (
WfpictContext
√√( 5
db
√√6 8
,
√√8 9
Guid
√√: >
?
√√> ?

campaignId
√√@ J
,
√√J K
string
√√L R
orderNumber
√√S ^
,
√√^ _
string
√√` f
segmentNumber
√√g t
,
√√t u
ProDataResponse√√v Ö
data√√Ü ä
)√√ä ã
{
ƒƒ 	
	LogHelper
∆∆ 
.
∆∆ 
AddLog
∆∆ 
(
∆∆ 
db
∆∆ 
,
∆∆  
LogType
∆∆! (
.
∆∆( )
Vendor
∆∆) /
,
∆∆/ 0
orderNumber
∆∆1 <
,
∆∆< =
$"
∆∆> @#
Deleting Old ProData 
∆∆@ U
"
∆∆U V
)
∆∆V W
;
∆∆W X
var
«« 
proDatas
«« 
=
«« 
db
«« 
.
«« 
ProDatas
«« &
.
««& '
Where
««' ,
(
««, -
x
««- .
=>
««/ 1
x
««2 3
.
««3 4

CampaignId
««4 >
==
««? A

campaignId
««B L
&&
««M O
x
««P Q
.
««Q R
OrderNumber
««R ]
==
««^ `
orderNumber
««a l
&&
««m o
x
««p q
.
««q r
SegmentNumber
««r 
==««Ä Ç
segmentNumber««É ê
)««ê ë
;««ë í
foreach
»» 
(
»» 
var
»» 
proData
»»  
in
»»! #
proDatas
»»$ ,
)
»», -
{
…… 
db
   
.
   
ProDatas
   
.
   
Remove
   "
(
  " #
proData
  # *
)
  * +
;
  + ,
}
ÀÀ 
db
ÃÃ 
.
ÃÃ 
SaveChanges
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ 
if
œœ 
(
œœ 
data
œœ 
.
œœ 
reports
œœ 
!=
œœ 
null
œœ  $
&&
œœ% '
data
œœ( ,
.
œœ, -
reports
œœ- 4
.
œœ4 5
report
œœ5 ;
!=
œœ< >
null
œœ? C
)
œœC D
{
–– 
var
—— 
reports
—— 
=
—— 
data
—— "
.
——" #
reports
——# *
.
——* +
report
——+ 1
;
——1 2
	LogHelper
““ 
.
““ 
AddLog
““  
(
““  !
db
““! #
,
““# $
LogType
““% ,
.
““, -
Vendor
““- 3
,
““3 4
orderNumber
““5 @
,
““@ A
$"
““B D
{
““D E
reports
““E L
.
““L M
Length
““M S
}
““S T,
 records fetched from ProData 
““T r
"
““r s
)
““s t
;
““t u
foreach
”” 
(
”” 
var
”” 
report
”” #
in
””$ &
reports
””' .
)
””. /
{
‘‘ 
db
’’ 
.
’’ 
ProDatas
’’ 
.
’’  
Add
’’  #
(
’’# $
new
’’$ '
Core
’’( ,
.
’’, -
Entities
’’- 5
.
’’5 6
ProData
’’6 =
(
’’= >
)
’’> ?
{
÷÷ 
Id
◊◊ 
=
◊◊ 
Guid
◊◊ !
.
◊◊! "
NewGuid
◊◊" )
(
◊◊) *
)
◊◊* +
,
◊◊+ ,
	CreatedAt
ÿÿ !
=
ÿÿ" #
DateTime
ÿÿ$ ,
.
ÿÿ, -
Now
ÿÿ- 0
,
ÿÿ0 1

CampaignId
ŸŸ "
=
ŸŸ# $

campaignId
ŸŸ% /
,
ŸŸ/ 0
OrderNumber
⁄⁄ #
=
⁄⁄$ %
orderNumber
⁄⁄& 1
,
⁄⁄1 2
SegmentNumber
€€ %
=
€€& '
segmentNumber
€€( 5
,
€€5 6
CampaignName
›› $
=
››% &
report
››' -
.
››- .
CampaignName
››. :
,
››: ;
Reportsite_URL
ﬁﬁ &
=
ﬁﬁ' (
report
ﬁﬁ) /
.
ﬁﬁ/ 0
Reportsite_URL
ﬁﬁ0 >
,
ﬁﬁ> ?
Destination_URL
ﬂﬂ '
=
ﬂﬂ( )
report
ﬂﬂ* 0
.
ﬂﬂ0 1
Destination_URL
ﬂﬂ1 @
,
ﬂﬂ@ A
CampaignStartDate
‡‡ )
=
‡‡* +
report
‡‡, 2
.
‡‡2 3
CampaignStartDate
‡‡3 D
,
‡‡D E

ClickCount
·· "
=
··# $
long
··% )
.
··) *
Parse
··* /
(
··/ 0
report
··0 6
.
··6 7

ClickCount
··7 A
)
··A B
,
··B C
	UniqueCnt
‰‰ !
=
‰‰" #
long
‰‰$ (
.
‰‰( )
Parse
‰‰) .
(
‰‰. /
report
‰‰/ 5
.
‰‰5 6

ClickCount
‰‰6 @
)
‰‰@ A
*
‰‰B C
Random
‰‰D J
.
‰‰J K
Next
‰‰K O
(
‰‰O P
$num
‰‰P R
,
‰‰R S
$num
‰‰T V
)
‰‰V W
/
‰‰X Y
$num
‰‰Z ]
,
‰‰] ^
	MobileCnt
ÁÁ !
=
ÁÁ" #
long
ÁÁ$ (
.
ÁÁ( )
Parse
ÁÁ) .
(
ÁÁ. /
report
ÁÁ/ 5
.
ÁÁ5 6

ClickCount
ÁÁ6 @
)
ÁÁ@ A
*
ÁÁB C
Random
ÁÁD J
.
ÁÁJ K
Next
ÁÁK O
(
ÁÁO P
$num
ÁÁP R
,
ÁÁR S
$num
ÁÁT V
)
ÁÁV W
/
ÁÁX Y
$num
ÁÁZ ]
,
ÁÁ] ^
ImpressionCnt
ËË %
=
ËË& '
report
ËË( .
.
ËË. /
ImpressionCnt
ËË/ <
,
ËË< =
IO
ÈÈ 
=
ÈÈ 
report
ÈÈ #
.
ÈÈ# $
IO
ÈÈ$ &
}
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}
ÎÎ 
db
ÏÏ 
.
ÏÏ 
SaveChanges
ÏÏ 
(
ÏÏ 
)
ÏÏ  
;
ÏÏ  !
	LogHelper
ÌÌ 
.
ÌÌ 
AddLog
ÌÌ  
(
ÌÌ  !
db
ÌÌ! #
,
ÌÌ# $
LogType
ÌÌ% ,
.
ÌÌ, -
Vendor
ÌÌ- 3
,
ÌÌ3 4
orderNumber
ÌÌ5 @
,
ÌÌ@ A
$"
ÌÌB D0
"Refresh completed successfully at 
ÌÌD f
{
ÌÌf g
DateTime
ÌÌg o
.
ÌÌo p
Now
ÌÌp s
}
ÌÌs t
"
ÌÌu v
)
ÌÌv w
;
ÌÌw x
}
ÓÓ 
}
 	
private
ÚÚ 
static
ÚÚ 
CampaignTracking
ÚÚ '
UpdateTracking
ÚÚ( 6
(
ÚÚ6 7
WfpictContext
ÚÚ7 D
db
ÚÚE G
,
ÚÚG H
Campaign
ÚÚI Q
campaign
ÚÚR Z
,
ÚÚZ [
string
ÚÚ\ b
orderNumber
ÚÚc n
,
ÚÚn o
string
ÚÚp v
segmentNumberÚÚw Ñ
,ÚÚÑ Ö
ProDataResponseÚÚÜ ï
dataÚÚñ ö
)ÚÚö õ
{
ÛÛ 	
var
ÙÙ 
campaignTracking
ÙÙ  
=
ÙÙ! "
campaign
ÙÙ# +
.
ÙÙ+ ,
	Trackings
ÙÙ, 5
.
ÙÙ5 6
FirstOrDefault
ÙÙ6 D
(
ÙÙD E
x
ÙÙE F
=>
ÙÙG I
x
ÙÙJ K
.
ÙÙK L
OrderNumber
ÙÙL W
==
ÙÙX Z
orderNumber
ÙÙ[ f
&&
ÙÙg i
x
ÙÙj k
.
ÙÙk l
SegmentNumber
ÙÙl y
==
ÙÙz |
segmentNumberÙÙ} ä
)ÙÙä ã
;ÙÙã å
if
˜˜ 
(
˜˜ 
campaignTracking
˜˜  
==
˜˜! #
null
˜˜$ (
)
˜˜( )
{
¯¯ 
string
˘˘ 
orderNumberRdp
˘˘ %
;
˘˘% &
long
˙˙ 
quantity
˙˙ 
;
˙˙ 
if
˚˚ 
(
˚˚ 
campaign
˚˚ 
.
˚˚ 
ReBroadcasted
˚˚ *
)
˚˚* +
{
¸¸ 
orderNumberRdp
˝˝ "
=
˝˝# $
campaign
˝˝% -
.
˝˝- .&
ReBroadcastedOrderNumber
˝˝. F
;
˝˝F G
quantity
˛˛ 
=
˛˛ 
campaign
˛˛ '
.
˛˛' (#
ReBroadcastedQuantity
˛˛( =
;
˛˛= >
}
ˇˇ 
else
ÄÄ 
{
ÅÅ 
orderNumberRdp
ÇÇ "
=
ÇÇ# $
campaign
ÇÇ% -
.
ÇÇ- .
OrderNumber
ÇÇ. 9
;
ÇÇ9 :
quantity
ÉÉ 
=
ÉÉ 
campaign
ÉÉ '
.
ÉÉ' (
Approved
ÉÉ( 0
.
ÉÉ0 1
Quantity
ÉÉ1 9
;
ÉÉ9 :
}
ÑÑ 
var
ÖÖ 

trackingId
ÖÖ 
=
ÖÖ  
Guid
ÖÖ! %
.
ÖÖ% &
NewGuid
ÖÖ& -
(
ÖÖ- .
)
ÖÖ. /
;
ÖÖ/ 0
campaignTracking
ÜÜ  
=
ÜÜ! "
new
ÜÜ# &
CampaignTracking
ÜÜ' 7
(
ÜÜ7 8
)
ÜÜ8 9
{
áá 
Id
àà 
=
àà 

trackingId
àà #
,
àà# $
	CreatedAt
ââ 
=
ââ 
DateTime
ââ  (
.
ââ( )
Now
ââ) ,
,
ââ, -

CampaignId
ää 
=
ää  
campaign
ää! )
.
ää) *
Id
ää* ,
,
ää, -
OrderNumber
ãã 
=
ãã  !
orderNumberRdp
ãã" 0
,
ãã0 1
SegmentNumber
åå !
=
åå" #
string
åå$ *
.
åå* +
Empty
åå+ 0
,
åå0 1
Quantity
çç 
=
çç 
quantity
çç '
,
çç' (
DateSent
éé 
=
éé 
DateTime
éé '
.
éé' (
Now
éé( +
,
éé+ ,!
IsCreatedThroughApi
èè '
=
èè( )
false
èè* /
}
êê 
;
êê 
db
ëë 
.
ëë 
CampaignTrackings
ëë $
.
ëë$ %
Add
ëë% (
(
ëë( )
campaignTracking
ëë) 9
)
ëë9 :
;
ëë: ;
db
íí 
.
íí 
SaveChanges
íí 
(
íí 
)
íí  
;
íí  !
}
ìì 
if
ïï 
(
ïï 
campaignTracking
ïï  
?
ïï  !
.
ïï! "
DateSent
ïï" *
==
ïï+ -
null
ïï. 2
||
ïï3 5
data
ïï6 :
.
ïï: ;
reports
ïï; B
?
ïïB C
.
ïïC D
report
ïïD J
==
ïïK M
null
ïïN R
||
ïïS U
data
ïïV Z
.
ïïZ [
reports
ïï[ b
.
ïïb c
report
ïïc i
.
ïïi j
Length
ïïj p
==
ïïq s
$num
ïït u
)
ïïu v
return
ïïw }
campaignTrackingïï~ é
;ïïé è
var
óó 
reports
óó 
=
óó 
data
óó 
.
óó 
reports
óó &
.
óó& '
report
óó' -
;
óó- .
var
òò 
report
òò 
=
òò 
reports
òò  
[
òò  !
$num
òò! "
]
òò" #
;
òò# $
DateTime
ôô 
startDateTime
ôô "
;
ôô" #
DateTime
öö 
.
öö 
TryParse
öö 
(
öö 
report
öö $
.
öö$ %
CampaignStartDate
öö% 6
,
öö6 7
out
öö8 ;
startDateTime
öö< I
)
ööI J
;
ööJ K
campaignTracking
õõ 
.
õõ 
IoNumber
õõ %
=
õõ& '
report
õõ( .
.
õõ. /
IO
õõ/ 1
;
õõ1 2
campaignTracking
úú 
.
úú 
	StartDate
úú &
=
úú' (
startDateTime
úú) 6
;
úú6 7
campaignTracking
ùù 
.
ùù 
Deployed
ùù %
=
ùù& '
(
ùù( )
long
ùù) -
)
ùù- .
(
ùù. /
campaignTracking
ùù/ ?
.
ùù? @
Quantity
ùù@ H
*
ùùI J
(
ùùK L
$num
ùùL M
+
ùùN O
Random
ùùP V
.
ùùV W
Next
ùùW [
(
ùù[ \
$num
ùù\ ]
,
ùù] ^
$num
ùù_ a
)
ùùa b
/
ùùc d
$num
ùùe l
)
ùùl m
)
ùùm n
;
ùùn o
campaignTracking
ûû 
.
ûû 
Opened
ûû #
=
ûû$ %
campaign
ûû& .
.
ûû. /
Approved
ûû/ 7
.
ûû7 8!
IsUseApiDataForOpen
ûû8 K
?
ûûL M
report
ûûN T
.
ûûT U
ImpressionCnt
ûûU b
:
ûûc d 
OpenModelerProData
ûûe w
.
ûûw x
GetOpensûûx Ä
(ûûÄ Å 
campaignTrackingûûÅ ë
.ûûë í
Quantityûûí ö
,ûûö õ
startDateTimeûûú ©
)ûû© ™
;ûû™ ´
if
üü 
(
üü 
campaign
üü 
.
üü 
Approved
üü !
.
üü! "

WhiteLabel
üü" ,
==
üü- /
StringConstants
üü0 ?
.
üü? @
CustomerStrategus
üü@ Q
)
üüQ R
campaignTracking
††  
.
††  !
Opened
††! '
=
††( )
(
††* +
long
††+ /
)
††/ 0
(
††0 1
(
††1 2
(
††2 3
campaignTracking
††3 C
.
††C D
Quantity
††D L
*
††M N
Random
††O U
.
††U V
Next
††V Z
(
††Z [
$num
††[ a
,
††a b
$num
††c i
)
††i j
)
††j k
/
††l m
$num
††n u
)
††u v
/
††w x
$num
††y ~
)
††~ 
;†† Ä
campaignTracking
¢¢ 
.
¢¢ 
Clicked
¢¢ $
=
¢¢% &
reports
¢¢' .
.
¢¢. /
Sum
¢¢/ 2
(
¢¢2 3
x
¢¢3 4
=>
¢¢5 7
long
¢¢8 <
.
¢¢< =
Parse
¢¢= B
(
¢¢B C
x
¢¢C D
.
¢¢D E

ClickCount
¢¢E O
)
¢¢O P
)
¢¢P Q
;
¢¢Q R
campaignTracking
££ 
.
££ 
Mobile
££ #
=
££$ %
reports
££& -
.
££- .
Sum
££. 1
(
££1 2
x
££2 3
=>
££4 6
x
££7 8
.
££8 9
	MobileCnt
££9 B
)
££B C
;
££C D
campaignTracking
§§ 
.
§§ 
Desktop
§§ $
=
§§% &
report
§§' -
.
§§- .
	UniqueCnt
§§. 7
;
§§7 8
campaignTracking
•• 
.
•• 
Unsub
•• "
=
••# $
Random
••% +
.
••+ ,
Next
••, 0
(
••0 1
$num
••1 2
,
••2 3
$num
••4 7
)
••7 8
;
••8 9
campaignTracking
¶¶ 
.
¶¶ 
Forwards
¶¶ %
=
¶¶& '
Random
¶¶( .
.
¶¶. /
Next
¶¶/ 3
(
¶¶3 4
$num
¶¶4 5
,
¶¶5 6
$num
¶¶7 :
)
¶¶: ;
;
¶¶; <
campaignTracking
ßß 
.
ßß 
Bounce
ßß #
=
ßß$ %
campaignTracking
ßß& 6
.
ßß6 7
Deployed
ßß7 ?
-
ßß@ A
campaignTracking
ßßB R
.
ßßR S
Quantity
ßßS [
;
ßß[ \
campaignTracking
®® 
.
®® 
Opt
®®  
=
®®! "
Random
®®# )
.
®®) *
Next
®®* .
(
®®. /
$num
®®/ 0
,
®®0 1
$num
®®2 4
)
®®4 5
;
®®5 6
campaignTracking
©© 
.
©©  
DeliveryPercentage
©© /
=
©©0 1
campaignTracking
©©2 B
.
©©B C
Quantity
©©C K
==
©©L N
$num
©©O P
?
©©Q R
$num
©©S T
:
©©U V
(
©©W X
double
©©X ^
)
©©^ _
campaignTracking
©©_ o
.
©©o p
Quantity
©©p x
/
©©y z
campaignTracking©©{ ã
.©©ã å
Deployed©©å î
;©©î ï
campaignTracking
™™ 
.
™™ 
OpenedPercentage
™™ -
=
™™. /
campaignTracking
™™0 @
.
™™@ A
Quantity
™™A I
==
™™J L
$num
™™M N
?
™™O P
$num
™™Q R
:
™™S T
(
™™U V
double
™™V \
)
™™\ ]
campaignTracking
™™] m
.
™™m n
Opened
™™n t
/
™™u v
campaignTracking™™w á
.™™á à
Quantity™™à ê
;™™ê ë
campaignTracking
´´ 
.
´´ 
ClickedPercentage
´´ .
=
´´/ 0
campaignTracking
´´1 A
.
´´A B
Quantity
´´B J
==
´´K M
$num
´´N O
?
´´P Q
$num
´´R S
:
´´T U
(
´´V W
double
´´W ]
)
´´] ^
campaignTracking
´´^ n
.
´´n o
Clicked
´´o v
/
´´w x
campaignTracking´´y â
.´´â ä
Quantity´´ä í
;´´í ì
campaignTracking
¨¨ 
.
¨¨ 
UnsubPercentage
¨¨ ,
=
¨¨- .
campaignTracking
¨¨/ ?
.
¨¨? @
Quantity
¨¨@ H
==
¨¨I K
$num
¨¨L M
?
¨¨N O
$num
¨¨P Q
:
¨¨R S
(
¨¨T U
double
¨¨U [
)
¨¨[ \
campaignTracking
¨¨\ l
.
¨¨l m
Unsub
¨¨m r
/
¨¨s t
campaignTracking¨¨u Ö
.¨¨Ö Ü
Quantity¨¨Ü é
;¨¨é è
campaignTracking
≠≠ 
.
≠≠ #
ClickToOpenPercentage
≠≠ 2
=
≠≠3 4
campaignTracking
≠≠5 E
.
≠≠E F
Opened
≠≠F L
==
≠≠M O
$num
≠≠P Q
?
≠≠R S
$num
≠≠T U
:
≠≠V W
(
≠≠X Y
double
≠≠Y _
)
≠≠_ `
campaignTracking
≠≠` p
.
≠≠p q
Clicked
≠≠q x
/
≠≠y z
campaignTracking≠≠{ ã
.≠≠ã å
Opened≠≠å í
;≠≠í ì
campaignTracking
ÆÆ 
.
ÆÆ #
UnsubToOpenPercentage
ÆÆ 2
=
ÆÆ3 4
campaignTracking
ÆÆ5 E
.
ÆÆE F
Opened
ÆÆF L
==
ÆÆM O
$num
ÆÆP Q
?
ÆÆR S
$num
ÆÆT U
:
ÆÆV W
(
ÆÆX Y
double
ÆÆY _
)
ÆÆ_ `
campaignTracking
ÆÆ` p
.
ÆÆp q
Unsub
ÆÆq v
/
ÆÆw x
campaignTrackingÆÆy â
.ÆÆâ ä
OpenedÆÆä ê
;ÆÆê ë
db
ØØ 
.
ØØ 
SaveChanges
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
return
±± 
campaignTracking
±± #
;
±±# $
}
≤≤ 	
private
¥¥ 
static
¥¥ 
void
¥¥ 
SaveNotification
¥¥ ,
(
¥¥, -
WfpictContext
¥¥- :
db
¥¥; =
,
¥¥= >

SettingsVm
¥¥? I
settings
¥¥J R
,
¥¥R S
Guid
¥¥T X
?
¥¥X Y

campaignId
¥¥Z d
,
¥¥d e
string
¥¥f l
orderNumber
¥¥m x
,
¥¥x y
string¥¥z Ä
segmentNumber¥¥Å é
,¥¥é è
DateTime¥¥ê ò
?¥¥ò ô

deployDate¥¥ö §
,¥¥§ •
string¥¥¶ ¨
responseStatus¥¥≠ ª
,¥¥ª º 
CampaignTracking¥¥Ω Õ 
campaignTracking¥¥Œ ﬁ
)¥¥ﬁ ﬂ
{
µµ 	
if
∂∂ 
(
∂∂ 
!
∂∂ 

deployDate
∂∂ 
.
∂∂ 
HasValue
∂∂ $
)
∂∂$ %
return
∂∂& ,
;
∂∂, -
string
∏∏ 
message
∏∏ 
;
∏∏ 
int
∫∫ 
hoursPassed
∫∫ 
=
∫∫ 
DateTime
∫∫ &
.
∫∫& '
Now
∫∫' *
.
∫∫* +
Subtract
∫∫+ 3
(
∫∫3 4

deployDate
∫∫4 >
.
∫∫> ?
Value
∫∫? D
)
∫∫D E
.
∫∫E F
Hours
∫∫F K
;
∫∫K L
if
ΩΩ 
(
ΩΩ 
responseStatus
ΩΩ 
==
ΩΩ !#
ProDataResponseStatus
ΩΩ" 7
.
ΩΩ7 8
NotFound
ΩΩ8 @
.
ΩΩ@ A
ToString
ΩΩA I
(
ΩΩI J
)
ΩΩJ K
&&
ΩΩL N
hoursPassed
ææ 
>=
ææ 
settings
ææ '
.
ææ' (%
NotStartedInXHoursValue
ææ( ?
)
ææ? @
{
øø 
message
¡¡ 
=
¡¡ 
$"
¡¡ 
Campaign started 
¡¡ -
{
¡¡- .

deployDate
¡¡. 8
.
¡¡8 9
Value
¡¡9 >
}
¡¡> ?
 as of 
¡¡? F
{
¡¡F G
DateTime
¡¡G O
.
¡¡O P
Now
¡¡P S
}
¡¡S T(
, Campaign has no traffic.
¡¡T n
"
¡¡n o
;
¡¡o p$
SaveNotificationRecord
¬¬ &
(
¬¬& '
db
¬¬' )
,
¬¬) *

campaignId
¬¬+ 5
,
¬¬5 6
orderNumber
¬¬7 B
,
¬¬B C
segmentNumber
¬¬D Q
,
¬¬Q R
QcRule
¬¬S Y
.
¬¬Y Z%
NotStartedInFirstXHours
¬¬Z q
,
¬¬q r
message
√√ 
)
√√ 
;
√√ 
}
ƒƒ 
else
≈≈ 
{
∆∆ 
if
»» 
(
»» 
campaignTracking
»» $
.
»»$ %
OpenedPercentage
»»% 5
<
»»6 7
$num
»»8 <
&&
»»= ?
hoursPassed
»»@ K
>
»»L M
$num
»»N O
)
»»O P
{
…… 
message
   
=
   
$"
    F
8Number of Opens in last 24hrs, No Open Traffic in 24hrs.
    X
"
  X Y
;
  Y Z$
SaveNotificationRecord
ÀÀ *
(
ÀÀ* +
db
ÀÀ+ -
,
ÀÀ- .

campaignId
ÀÀ/ 9
,
ÀÀ9 :
orderNumber
ÀÀ; F
,
ÀÀF G
segmentNumber
ÀÀH U
,
ÀÀU V
QcRule
ÀÀW ]
.
ÀÀ] ^#
OpenTrafficInLast1Day
ÀÀ^ s
,
ÀÀs t
message
ÀÀu |
)
ÀÀ| }
;
ÀÀ} ~
}
ÃÃ 
if
œœ 
(
œœ 
campaignTracking
œœ $
.
œœ$ %
ClickedPercentage
œœ% 6
<
œœ7 8
$num
œœ9 =
&&
œœ> @
hoursPassed
œœA L
>
œœM N
$num
œœO P
)
œœP Q
{
–– 
message
—— 
=
—— 
$"
——  H
:Number of Clicks in last 24hrs, No Click Traffic in 24hrs.
——  Z
"
——Z [
;
——[ \$
SaveNotificationRecord
““ *
(
““* +
db
““+ -
,
““- .

campaignId
““/ 9
,
““9 :
orderNumber
““; F
,
““F G
segmentNumber
““H U
,
““U V
QcRule
““W ]
.
““] ^$
ClickTrafficInLast1Day
““^ t
,
““t u
message
““v }
)
““} ~
;
““~ 
}
”” 
}
‘‘ 
if
÷÷ 
(
÷÷ 
hoursPassed
÷÷ 
>=
÷÷ 
$num
÷÷ !
)
÷÷! "
{
◊◊ 
if
ŸŸ 
(
ŸŸ 
campaignTracking
ŸŸ $
.
ŸŸ$ %
OpenedPercentage
ŸŸ% 5
<
ŸŸ6 7
(
ŸŸ8 9
settings
ŸŸ9 A
.
ŸŸA B*
NotHitOpenRateIn24HoursValue
ŸŸB ^
/
ŸŸ_ `
$num
ŸŸa f
)
ŸŸf g
)
ŸŸg h
{
⁄⁄ 
message
€€ 
=
€€ 
$"
€€  
{
€€  !
campaignTracking
€€! 1
.
€€1 2
Opened
€€2 8
}
€€8 9
 / 
€€9 <
{
€€< =
campaignTracking
€€= M
.
€€M N
Quantity
€€N V
}
€€V W+
 is Less than required value 
€€W t
{
€€t u
settings
€€u }
.
€€} ~+
NotHitOpenRateIn24HoursValue€€~ ö
}€€ö õ 
% in first 24hrs€€õ ´
"€€´ ¨
;€€¨ ≠$
SaveNotificationRecord
‹‹ *
(
‹‹* +
db
‹‹+ -
,
‹‹- .

campaignId
‹‹/ 9
,
‹‹9 :
orderNumber
‹‹; F
,
‹‹F G
segmentNumber
‹‹H U
,
‹‹U V
QcRule
‹‹W ]
.
‹‹] ^"
NotHitOpenRateIn1Day
‹‹^ r
,
‹‹r s
message
‹‹t {
)
‹‹{ |
;
‹‹| }
}
›› 
if
‡‡ 
(
‡‡ 
campaignTracking
‡‡ $
.
‡‡$ %
ClickedPercentage
‡‡% 6
<
‡‡7 8
(
‡‡9 :
settings
‡‡: B
.
‡‡B C+
NotHitClickRateIn24HoursValue
‡‡C `
/
‡‡a b
$num
‡‡c h
)
‡‡h i
)
‡‡i j
{
·· 
message
‚‚ 
=
‚‚ 
$"
‚‚  
{
‚‚  !
campaignTracking
‚‚! 1
.
‚‚1 2
Clicked
‚‚2 9
}
‚‚9 :
 / 
‚‚: =
{
‚‚= >
campaignTracking
‚‚> N
.
‚‚N O
Quantity
‚‚O W
}
‚‚W X+
 is Less than required value 
‚‚X u
{
‚‚u v
settings
‚‚v ~
.
‚‚~ ,
NotHitClickRateIn24HoursValue‚‚ ú
}‚‚ú ù 
% in first 24hrs‚‚ù ≠
"‚‚≠ Æ
;‚‚Æ Ø$
SaveNotificationRecord
„„ *
(
„„* +
db
„„+ -
,
„„- .

campaignId
„„/ 9
,
„„9 :
orderNumber
„„; F
,
„„F G
segmentNumber
„„H U
,
„„U V
QcRule
„„W ]
.
„„] ^#
NotHitClickRateIn1Day
„„^ s
,
„„s t
message
„„u |
)
„„| }
;
„„} ~
}
‰‰ 
if
ÁÁ 
(
ÁÁ 
campaignTracking
ÁÁ $
.
ÁÁ$ %
OpenedPercentage
ÁÁ% 5
>
ÁÁ6 7
(
ÁÁ8 9
settings
ÁÁ9 A
.
ÁÁA B,
ExceededOpenRateIn24HoursValue
ÁÁB `
/
ÁÁa b
$num
ÁÁc h
)
ÁÁh i
)
ÁÁi j
{
ËË 
message
ÈÈ 
=
ÈÈ 
$"
ÈÈ  
{
ÈÈ  !
campaignTracking
ÈÈ! 1
.
ÈÈ1 2
Opened
ÈÈ2 8
}
ÈÈ8 9
 / 
ÈÈ9 <
{
ÈÈ< =
campaignTracking
ÈÈ= M
.
ÈÈM N
Quantity
ÈÈN V
}
ÈÈV W.
  is Greater than required value 
ÈÈW w
{
ÈÈw x
settingsÈÈx Ä
.ÈÈÄ Å.
ExceededOpenRateIn24HoursValueÈÈÅ ü
}ÈÈü † 
% in first 24hrsÈÈ† ∞
"ÈÈ∞ ±
;ÈÈ± ≤$
SaveNotificationRecord
ÍÍ *
(
ÍÍ* +
db
ÍÍ+ -
,
ÍÍ- .

campaignId
ÍÍ/ 9
,
ÍÍ9 :
orderNumber
ÍÍ; F
,
ÍÍF G
segmentNumber
ÍÍH U
,
ÍÍU V
QcRule
ÍÍW ]
.
ÍÍ] ^'
ExceededOpenRateIn24Hours
ÍÍ^ w
,
ÍÍw x
messageÍÍy Ä
)ÍÍÄ Å
;ÍÍÅ Ç
}
ÎÎ 
if
ÓÓ 
(
ÓÓ 
campaignTracking
ÓÓ $
.
ÓÓ$ %
ClickedPercentage
ÓÓ% 6
>
ÓÓ7 8
(
ÓÓ9 :
settings
ÓÓ: B
.
ÓÓB C-
ExceededClickRateIn24HoursValue
ÓÓC b
/
ÓÓc d
$num
ÓÓe j
)
ÓÓj k
)
ÓÓk l
{
ÔÔ 
message
 
=
 
$"
  
{
  !
campaignTracking
! 1
.
1 2
Clicked
2 9
}
9 :
 / 
: =
{
= >
campaignTracking
> N
.
N O
Quantity
O W
}
W X.
  is Greater than required value 
X x
{
x y
settingsy Å
.Å Ç/
ExceededClickRateIn24HoursValueÇ °
}° ¢ 
% in first 24hrs¢ ≤
"≤ ≥
;≥ ¥$
SaveNotificationRecord
ÒÒ *
(
ÒÒ* +
db
ÒÒ+ -
,
ÒÒ- .

campaignId
ÒÒ/ 9
,
ÒÒ9 :
orderNumber
ÒÒ; F
,
ÒÒF G
segmentNumber
ÒÒH U
,
ÒÒU V
QcRule
ÒÒW ]
.
ÒÒ] ^(
ExceededClickRateIn24Hours
ÒÒ^ x
,
ÒÒx y
messageÒÒz Å
)ÒÒÅ Ç
;ÒÒÇ É
}
ÚÚ 
}
ÛÛ 
else
ÙÙ 
if
ÙÙ 
(
ÙÙ 
hoursPassed
ÙÙ  
>=
ÙÙ! #
$num
ÙÙ$ &
)
ÙÙ& '
{
ıı 
if
˜˜ 
(
˜˜ 
campaignTracking
˜˜ $
.
˜˜$ %
OpenedPercentage
˜˜% 5
<
˜˜6 7
(
˜˜8 9
settings
˜˜9 A
.
˜˜A B*
NotHitOpenRateIn72HoursValue
˜˜B ^
/
˜˜_ `
$num
˜˜a f
)
˜˜f g
)
˜˜g h
{
¯¯ 
message
˘˘ 
=
˘˘ 
$"
˘˘  
{
˘˘  !
campaignTracking
˘˘! 1
.
˘˘1 2
Opened
˘˘2 8
}
˘˘8 9
 / 
˘˘9 <
{
˘˘< =
campaignTracking
˘˘= M
.
˘˘M N
Quantity
˘˘N V
}
˘˘V W+
 is Less than required value 
˘˘W t
{
˘˘t u
settings
˘˘u }
.
˘˘} ~+
NotHitOpenRateIn72HoursValue˘˘~ ö
}˘˘ö õ 
% in first 72hrs˘˘õ ´
"˘˘´ ¨
;˘˘¨ ≠$
SaveNotificationRecord
˙˙ *
(
˙˙* +
db
˙˙+ -
,
˙˙- .

campaignId
˙˙/ 9
,
˙˙9 :
orderNumber
˙˙; F
,
˙˙F G
segmentNumber
˙˙H U
,
˙˙U V
QcRule
˙˙W ]
.
˙˙] ^#
NotHitOpenRateIn3Days
˙˙^ s
,
˙˙s t
message
˙˙u |
)
˙˙| }
;
˙˙} ~
}
˚˚ 
if
˛˛ 
(
˛˛ 
campaignTracking
˛˛ $
.
˛˛$ %
ClickedPercentage
˛˛% 6
<
˛˛7 8
(
˛˛9 :
settings
˛˛: B
.
˛˛B C+
NotHitClickRateIn72HoursValue
˛˛C `
/
˛˛a b
$num
˛˛c h
)
˛˛h i
)
˛˛i j
{
ˇˇ 
message
ÄÄ 
=
ÄÄ 
$"
ÄÄ  
{
ÄÄ  !
campaignTracking
ÄÄ! 1
.
ÄÄ1 2
Clicked
ÄÄ2 9
}
ÄÄ9 :
 / 
ÄÄ: =
{
ÄÄ= >
campaignTracking
ÄÄ> N
.
ÄÄN O
Quantity
ÄÄO W
}
ÄÄW X+
 is Less than required value 
ÄÄX u
{
ÄÄu v
settings
ÄÄv ~
.
ÄÄ~ ,
NotHitClickRateIn72HoursValueÄÄ ú
}ÄÄú ù 
% in first 72hrsÄÄù ≠
"ÄÄ≠ Æ
;ÄÄÆ Ø$
SaveNotificationRecord
ÅÅ *
(
ÅÅ* +
db
ÅÅ+ -
,
ÅÅ- .

campaignId
ÅÅ/ 9
,
ÅÅ9 :
orderNumber
ÅÅ; F
,
ÅÅF G
segmentNumber
ÅÅH U
,
ÅÅU V
QcRule
ÅÅW ]
.
ÅÅ] ^$
NotHitClickRateIn3Days
ÅÅ^ t
,
ÅÅt u
message
ÅÅv }
)
ÅÅ} ~
;
ÅÅ~ 
}
ÇÇ 
if
ÖÖ 
(
ÖÖ 
campaignTracking
ÖÖ $
.
ÖÖ$ %
OpenedPercentage
ÖÖ% 5
>
ÖÖ6 7
(
ÖÖ8 9
settings
ÖÖ9 A
.
ÖÖA B,
ExceededOpenRateIn72HoursValue
ÖÖB `
/
ÖÖa b
$num
ÖÖc h
)
ÖÖh i
)
ÖÖi j
{
ÜÜ 
message
áá 
=
áá 
$"
áá  
{
áá  !
campaignTracking
áá! 1
.
áá1 2
Opened
áá2 8
}
áá8 9
 / 
áá9 <
{
áá< =
campaignTracking
áá= M
.
ááM N
Quantity
ááN V
}
ááV W.
  is Greater than required value 
ááW w
{
ááw x
settingsááx Ä
.ááÄ Å.
ExceededOpenRateIn72HoursValueááÅ ü
}ááü † 
% in first 72hrsáá† ∞
"áá∞ ±
;áá± ≤$
SaveNotificationRecord
àà *
(
àà* +
db
àà+ -
,
àà- .

campaignId
àà/ 9
,
àà9 :
orderNumber
àà; F
,
ààF G
segmentNumber
ààH U
,
ààU V
QcRule
ààW ]
.
àà] ^'
ExceededOpenRateIn72Hours
àà^ w
,
ààw x
messageàày Ä
)ààÄ Å
;ààÅ Ç
}
ââ 
if
åå 
(
åå 
campaignTracking
åå $
.
åå$ %
ClickedPercentage
åå% 6
>
åå7 8
(
åå9 :
settings
åå: B
.
ååB C-
ExceededClickRateIn72HoursValue
ååC b
/
ååc d
$num
ååe j
)
ååj k
)
ååk l
{
çç 
message
éé 
=
éé 
$"
éé  
{
éé  !
campaignTracking
éé! 1
.
éé1 2
Clicked
éé2 9
}
éé9 :
 / 
éé: =
{
éé= >
campaignTracking
éé> N
.
ééN O
Quantity
ééO W
}
ééW X.
  is Greater than required value 
ééX x
{
ééx y
settingsééy Å
.ééÅ Ç/
ExceededClickRateIn72HoursValueééÇ °
}éé° ¢ 
% in first 72hrséé¢ ≤
"éé≤ ≥
;éé≥ ¥$
SaveNotificationRecord
èè *
(
èè* +
db
èè+ -
,
èè- .

campaignId
èè/ 9
,
èè9 :
orderNumber
èè; F
,
èèF G
segmentNumber
èèH U
,
èèU V
QcRule
èèW ]
.
èè] ^(
ExceededClickRateIn72Hours
èè^ x
,
èèx y
messageèèz Å
)èèÅ Ç
;èèÇ É
}
êê 
}
ëë 
}
ìì 	
}
ïï 
}ññ ú	
MD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ProData\ProDataHelper.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ProData' .
{ 
public 

static 
class 
ProDataHelper %
{ 
public 
static 
int 
GetIndex "
(" #
string# )
reportSiteUrl* 7
)7 8
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
reportSiteUrl% 2
)2 3
)3 4
return5 ;
$num< =
;= >
var		 
parts		 
=		 
reportSiteUrl		 %
.		% &
Split		& +
(		+ ,
$char		, /
)		/ 0
;		0 1
return

 
int

 
.

 
Parse

 
(

 
parts

 "
[

" #
parts

# (
.

( )
Length

) /
-

0 1
$num

2 3
]

3 4
)

4 5
;

5 6
} 	
} 
} Ù8
ND:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ProData\ProDataRequest.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ProData' .
{ 
public 

class 
ProDataRequest 
{ 
public 
string 
io 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
campaign_name #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
is_rebroadcast $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
white_label !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
creative_url		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public

 
long

 
quantity

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
geo_type 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
geo_url 
{ 
get  #
;# $
set% (
;( )
}* +
public 
double 
ctr_percent !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
subject 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
	from_name 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

from_email  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
deploy_date !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
is_open_pixel #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
double 
open_percent "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

open_pixel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
is_data_file "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
data_file_url #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string '
data_file_replacement_param 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 
string (
data_file_replacement_column 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
string 
data_file_unique_ip )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
override 
string 
ToString '
(' (
)( )
{ 	
return 
$@" ù
ê<br/><p><b>Order Details</b></p><br/>
                    <table border=""2"">
                    <tr><th align=""left"">Order/IO #:</th><td>! ?
{!!? @
io!!@ B
}!!B CZ
N</td></tr>
                    <tr><th align=""left"">Campaign Name:</th><td>!"C B
{""B C
campaign_name""C P
}""P QX
L</td></tr>
                    <tr><th align=""left"">Rebroadcast:</th><td>"#Q @
{##@ A
(##A B
is_rebroadcast##B P
)##P Q
}##Q R\
P</td></tr>    
                    <tr><th align=""left"">White Label:</th><td>#$R @
{$$@ A
white_label$$A L
}$$L MÅ
u</td></tr>                                        
                    <tr><th align=""left"">Creative URL:</th><td>$%M A
{%%A B
creative_url%%B N
}%%N OU
I</td></tr>
                    <tr><th align=""left"">Quantity:</th><td>%&O =
{&&= >
quantity&&> F
}&&F GU
I</td></tr>
                    <tr><th align=""left"">Geo Type:</th><td>&'G =
{''= >
geo_type''> F
}''F G^
R</td></tr>
                    <tr><tr><th align=""left"">Geo / Zip URL:</th><td>'(G F
{((F G
geo_url((G N
}((N O_
S</td></tr>
                    <tr><tr><th align=""left"">CTR Percentage:</th><td>()O G
{))G H
ctr_percent))H S
}))S TY
M</td></tr>
                    <tr><th align=""left"">Subject Line:</th><td>)*T A
{**A B
subject**B I
}**I JV
J</td></tr>
                    <tr><th align=""left"">From Line:</th><td>*+J >
{++> ?
	from_name++? H
}++H IW
K</td></tr>
                    <tr><th align=""left"">From Email:</th><td>+,I ?
{,,? @

from_email,,@ J
},,J Kd
X</td></tr>
                    <tr><th align=""left"">Broadcast / Deploy Date:</th><td>,-K L
{--L M
deploy_date--M X
}--X Y]
Q</td></tr>

                    <tr><th align=""left"">Has Open Pixel:</th><td>-/Y C
{//C D
(//D E
is_open_pixel//E R
)//R S
}//S TY
M</td></tr>
                    <tr><th align=""left"">Open Percent:</th><td>/0T A
{00A B
open_percent00B N
}00N O[
O</td></tr>
                    <tr><th align=""left"">Open Pixel URL:</th><td>01O C
{11C D

open_pixel11D N
}11N O\
P</td></tr>

                    <tr><th align=""left"">Has Data File:</th><td>13O B
{33B C
is_data_file33C O
}33O PZ
N</td></tr>
                    <tr><th align=""left"">Data File URL:</th><td>34P B
{44B C
data_file_url44C P
}44P Qh
\</td></tr>
                    <tr><th align=""left"">Data File Replacement Param:</th><td>45Q P
{55P Q'
data_file_replacement_param55Q l
}55l mi
]</td></tr>
                    <tr><th align=""left"">Data File Replacement Column:</th><td>56m Q
{66Q R(
data_file_replacement_column66R n
}66n o`
T</td></tr>
                    <tr><th align=""left"">Data File Unique IP:</th><td>67o H
{77H I
data_file_unique_ip77I \
}77\ ]8
,</td></tr>
                    </table></p>78]  
"88  !
;88! "
}99 	
}:: 
};; »"
OD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ProData\ProDataResponse.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ProData' .
{ 
public 

class 
ProDataResponse  
{ 
public 
string 
status 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
Reports		 
reports		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
string

 
	timestamp

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 
message 
{ 
get  #
;# $
set% (
;( )
}* +
public 
List 
< 
string 
> 
error_fields (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
long &
queued_pending_campaign_id .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string 
ResponseStatus $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ResponseMessage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
RequestMessage $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ErrorMessage "
{ 	
get 
{ 
StringBuilder 
errorMessage *
=+ ,
new- 0
StringBuilder1 >
(> ?
message? F
)F G
;G H
foreach 
( 
var 
field "
in# %
error_fields& 2
)2 3
{ 
errorMessage  
.  !
Append! '
(' (
$"( *
<br/>* /
{/ 0
field0 5
}5 6
"6 7
)7 8
;8 9
} 
return 
errorMessage #
.# $
ToString$ ,
(, -
)- .
;. /
} 
} 	
} 
public   

class   
Reports   
{!! 
public"" 
Report"" 
["" 
]"" 
report"" 
{""  
get""! $
;""$ %
set""& )
;"") *
}""+ ,
}## 
public%% 

class%% 
Report%% 
{&& 
public'' 
string'' 
IO'' 
{'' 
get'' 
;'' 
set''  #
;''# $
}''% &
public(( 
string(( 
Reportsite_URL(( $
{((% &
get((' *
;((* +
set((, /
;((/ 0
}((1 2
public)) 
string)) 
Destination_URL)) %
{))& '
get))( +
;))+ ,
set))- 0
;))0 1
}))2 3
public** 
string** 
CampaignStartDate** '
{**( )
get*** -
;**- .
set**/ 2
;**2 3
}**4 5
public++ 
string++ 

ClickCount++  
{++! "
get++# &
;++& '
set++( +
;+++ ,
}++- .
public,, 
string,, 
CampaignName,, "
{,,# $
get,,% (
;,,( )
set,,* -
;,,- .
},,/ 0
public-- 
long-- 
	UniqueCnt-- 
{-- 
get--  #
;--# $
set--% (
;--( )
}--* +
public.. 
long.. 
	MobileCnt.. 
{.. 
get..  #
;..# $
set..% (
;..( )
}..* +
public// 
long// 
ImpressionCnt// !
{//" #
get//$ '
;//' (
set//) ,
;//, -
}//. /
}00 
}22 çÍ
^D:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\ReportingModel\ReportingModelProcessor.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '
ReportingModel' 5
{ 
public 

class #
ReportingModelProcessor (
:) * 
NotificationRecorder+ ?
{ 
readonly 
static 
string 

clientCode )
=* +
System, 2
.2 3
Configuration3 @
.@ A 
ConfigurationManagerA U
.U V
AppSettingsV a
[a b
$strb n
]n o
;o p
static 
readonly 
Random 
Random %
=& '
new( +
Random, 2
(2 3
)3 4
;4 5
public 
static 
void 
PopulateFakeData +
(+ ,
WfpictContext, 9
db: <
,< =
Campaign> F
campaignG O
,O P
stringQ W
orderNumberX c
,c d
stringe k

UploadPathl v
)v w
{ 	
string 
filePath 
= 
Path "
." #
Combine# *
(* +

UploadPath+ 5
,5 6
campaign7 ?
.? @
Assets@ F
.F G
OpenModelLinksFileG Y
)Y Z
;Z [
S3FileManager 
. 
Download "
(" #
campaign# +
.+ ,
Assets, 2
.2 3
OpenModelLinksFile3 E
,E F
filePathG O
)O P
;P Q
List 
< 
string 
> 
links 
=  
	CsvReader! *
.* +
ReadCsv+ 2
(2 3
filePath3 ;
); <
;< =
PopulateFakeData 
( 
db 
,  
campaign! )
,) *
orderNumber+ 6
,6 7
links8 =
)= >
;> ?
} 	
public 
static 
void 
PopulateFakeData +
(+ ,
WfpictContext, 9
db: <
,< =
Campaign> F
campaignG O
,O P
stringQ W
orderNumberX c
,c d
Liste i
<i j
stringj p
>p q
linksr w
)w x
{ 	
if 
( 
string 
. 
IsNullOrEmpty #
(# $
campaign$ ,
., -
Approved- 5
.5 6

WhiteLabel6 @
)@ A
)A B
throw   
new   
AdsException   &
(  & '
$str  ' _
)  _ `
;  ` a
var"" 
customer"" 
="" 
db"" 
."" 
	Customers"" '
.""' (
FirstOrDefault""( 6
(""6 7
x""7 8
=>""9 ;
x""< =
.""= >

WhiteLabel""> H
==""I K
campaign""L T
.""T U
Approved""U ]
.""] ^

WhiteLabel""^ h
)""h i
;""i j
if## 
(## 
customer## 
==## 
null##  
)##  !
throw$$ 
new$$ 
AdsException$$ &
($$& '
$str$$' \
)$$\ ]
;$$] ^
var&& 
keywords&& 
=&& 
db&& 
.&& 
OpenModelKeywords&& /
.&&/ 0
ToList&&0 6
(&&6 7
)&&7 8
;&&8 9
Random(( 
r(( 
=(( 
new(( 
Random(( !
(((! "
)((" #
;((# $
int)) 
clicksRandom)) 
=)) 
r))  
.))  !
Next))! %
())% &
())& '
int))' *
)))* +
customer))+ 3
.))3 4
ClickInitial))4 @
,))@ A
())B C
int))C F
)))F G
customer))G O
.))O P
ClickEnd))P X
)))X Y
;))Y Z
long** 
quantity** 
=** 
orderNumber** '
.**' (
EndsWith**( 0
(**0 1
$str**1 6
)**6 7
?**8 9
campaign**: B
.**B C!
ReBroadcastedQuantity**C X
:**Y Z
campaign**[ c
.**c d
Approved**d l
.**l m
Quantity**m u
;**u v
long++ 
clickCountTotal++  
=++! "
(++# $
long++$ (
)++( )
(++) *
(++* +
clicksRandom+++ 7
*++8 9
quantity++: B
/++C D
$num++E M
)++M N
/++O P
$num++Q V
)++V W
;++W X
List-- 
<-- 

ClickModel-- 
>-- 
clicks-- #
=--$ %
null--& *
;--* +
clicks.. 
=.. 
ClickModeler.. !
...! "
GenerateClicks.." 0
(..0 1
links..1 6
,..6 7
clickCountTotal..8 G
,..G H
keywords..I Q
)..Q R
;..R S
List00 
<00 
Report00 
>00 
reports00  
=00! "
new00# &
List00' +
<00+ ,
Report00, 2
>002 3
(003 4
)004 5
;005 6
int11 
counter11 
=11 
$num11 
;11 
foreach22 
(22 
var22 
c22 
in22 
clicks22 $
)22$ %
{33 
reports44 
.44 
Add44 
(44 
new44 
Report44  &
(44& '
)44' (
{55 
IO66 
=66 
orderNumber66 $
,66$ %
CampaignName77  
=77! "
campaign77# +
.77+ ,
Approved77, 4
.774 5
CampaignName775 A
,77A B
CampaignStartDate88 %
=88& '
campaign88( 0
.880 1
Approved881 9
.889 :

DeployDate88: D
?88D E
.88E F
ToString88F N
(88N O
StringConstants88O ^
.88^ _ 
DateTimeFormatDashes88_ s
)88s t
,88t u
Reportsite_URL99 "
=99# $
$"99% '%
http://report-site.com/c/99' @
{99@ A
orderNumber99A L
}99L M
/99M N
{99N O
counter99O V
}99V W
"99W X
,99X Y
Destination_URL:: #
=::$ %
c::& '
.::' (
Link::( ,
,::, -

ClickCount;; 
=;;  
c;;! "
.;;" #
Clicks;;# )
.;;) *
ToString;;* 2
(;;2 3
);;3 4
}<< 
)<< 
;<< 
counter== 
++== 
;== 
}>> 
var?? 
data?? 
=?? 
new?? 
ProDataResponse?? *
(??* +
)??+ ,
{@@ 
reportsAA 
=AA 
newAA 
ProDataAA %
.AA% &
ReportsAA& -
(AA- .
)AA. /
{AA0 1
reportBB 
=BB 
reportsBB $
.BB$ %
ToArrayBB% ,
(BB, -
)BB- .
}CC 
}DD 
;DD 
SaveProDataNXSFF 
(FF 
dbFF 
,FF 
campaignFF '
.FF' (
IdFF( *
,FF* +
orderNumberFF, 7
,FF7 8
stringFF9 ?
.FF? @
EmptyFF@ E
,FFE F
dataFFG K
)FFK L
;FFL M
varGG 
campaignTrackingGG  
=GG! "
UpdateTrackingNXSGG# 4
(GG4 5
dbGG5 7
,GG7 8
campaignGG9 A
,GGA B
orderNumberGGC N
,GGN O
stringGGP V
.GGV W
EmptyGGW \
,GG\ ]
dataGG^ b
,GGb c
customerGGd l
)GGl m
;GGm n
}KK 	
	protectedMM 
staticMM 
voidMM 
SaveProDataNXSMM ,
(MM, -
WfpictContextMM- :
dbMM; =
,MM= >
GuidMM? C
?MMC D

campaignIdMME O
,MMO P
stringMMQ W
orderNumberMMX c
,MMc d
stringMMe k
segmentNumberMMl y
,MMy z
ProDataResponse	MM{ ä
data
MMã è
)
MMè ê
{NN 	
ifOO 
(OO 
dataOO 
.OO 
reportsOO 
==OO 
nullOO  $
||OO% '
dataOO( ,
.OO, -
reportsOO- 4
?OO4 5
.OO5 6
reportOO6 <
==OO= ?
nullOO@ D
||OOE G
dataOOH L
.OOL M
reportsOOM T
?OOT U
.OOU V
reportOOV \
.OO\ ]
LengthOO] c
==OOd f
$numOOg h
)OOh i
returnPP 
;PP 
	LogHelperSS 
.SS 
AddLogSS 
(SS 
dbSS 
,SS  
LogTypeSS! (
.SS( )
VendorSS) /
,SS/ 0
orderNumberSS1 <
,SS< =
$"SS> @%
Deleting Old Vendor Data SS@ Y
"SSY Z
)SSZ [
;SS[ \
varTT 
proDatasTT 
=TT 
dbTT 
.TT 
ProDatasTT &
.TT& '
WhereTT' ,
(TT, -
xTT- .
=>TT/ 1
xTT2 3
.TT3 4

CampaignIdTT4 >
==TT? A

campaignIdTTB L
&&TTM O
xTTP Q
.TTQ R
OrderNumberTTR ]
==TT^ `
orderNumberTTa l
&&TTm o
xTTp q
.TTq r
SegmentNumberTTr 
==
TTÄ Ç
segmentNumber
TTÉ ê
)
TTê ë
;
TTë í
foreachUU 
(UU 
varUU 
proDataUU  
inUU! #
proDatasUU$ ,
)UU, -
{VV 
dbWW 
.WW 
ProDatasWW 
.WW 
RemoveWW "
(WW" #
proDataWW# *
)WW* +
;WW+ ,
}XX 
dbYY 
.YY 
SaveChangesYY 
(YY 
)YY 
;YY 
var\\ 
reports\\ 
=\\ 
data\\ 
.\\ 
reports\\ &
.\\& '
report\\' -
;\\- .
	LogHelper]] 
.]] 
AddLog]] 
(]] 
db]] 
,]]  
LogType]]! (
.]]( )
Vendor]]) /
,]]/ 0
orderNumber]]1 <
,]]< =
$"]]> @
{]]@ A
reports]]A H
.]]H I
Length]]I O
}]]O P(
 records fetched from Vendor]]P l
"]]l m
)]]m n
;]]n o
foreach^^ 
(^^ 
var^^ 
report^^ 
in^^  "
reports^^# *
)^^* +
{__ 
var`` 
proData`` 
=`` 
new`` !
Core``" &
.``& '
Entities``' /
.``/ 0
ProData``0 7
(``7 8
)``8 9
{aa 
Idbb 
=bb 
Guidbb 
.bb 
NewGuidbb %
(bb% &
)bb& '
,bb' (
	CreatedAtcc 
=cc 
DateTimecc  (
.cc( )
Nowcc) ,
,cc, -

CampaignIddd 
=dd  

campaignIddd! +
,dd+ ,
OrderNumberee 
=ee  !
orderNumberee" -
,ee- .
SegmentNumberff !
=ff" #
segmentNumberff$ 1
,ff1 2
CampaignNamehh  
=hh! "
reporthh# )
.hh) *
CampaignNamehh* 6
,hh6 7
Reportsite_URLii "
=ii# $
reportii% +
.ii+ ,
Reportsite_URLii, :
,ii: ;
Destination_URLjj #
=jj$ %
reportjj& ,
.jj, -
Destination_URLjj- <
,jj< =
CampaignStartDatekk %
=kk& '
reportkk( .
.kk. /
CampaignStartDatekk/ @
,kk@ A

ClickCountll 
=ll  
longll! %
.ll% &
Parsell& +
(ll+ ,
reportll, 2
.ll2 3

ClickCountll3 =
)ll= >
,ll> ?
	UniqueCntoo 
=oo 
longoo  $
.oo$ %
Parseoo% *
(oo* +
reportoo+ 1
.oo1 2

ClickCountoo2 <
)oo< =
*oo> ?
Randomoo@ F
.ooF G
NextooG K
(ooK L
$numooL N
,ooN O
$numooP R
)ooR S
/ooT U
$numooV Y
,ooY Z
	MobileCntrr 
=rr 
longrr  $
.rr$ %
Parserr% *
(rr* +
reportrr+ 1
.rr1 2

ClickCountrr2 <
)rr< =
*rr> ?
Randomrr@ F
.rrF G
NextrrG K
(rrK L
$numrrL N
,rrN O
$numrrP R
)rrR S
/rrT U
$numrrV Y
,rrY Z
ImpressionCntss !
=ss" #
reportss$ *
.ss* +
ImpressionCntss+ 8
,ss8 9
IOtt 
=tt 
reporttt 
.tt  
IOtt  "
}uu 
;uu 
dbvv 
.vv 
ProDatasvv 
.vv 
Addvv 
(vv  
proDatavv  '
)vv' (
;vv( )
}ww 
dbxx 
.xx 
SaveChangesxx 
(xx 
)xx 
;xx 
	LogHelperyy 
.yy 
AddLogyy 
(yy 
dbyy 
,yy  
LogTypeyy! (
.yy( )
Vendoryy) /
,yy/ 0
orderNumberyy1 <
,yy< =
$"yy> @.
"Refresh completed successfully at yy@ b
{yyb c
DateTimeyyc k
.yyk l
Nowyyl o
}yyo p
"yyq r
)yyr s
;yys t
}zz 	
	protected|| 
static|| 
CampaignTracking|| )
UpdateTrackingNXS||* ;
(||; <
WfpictContext||< I
db||J L
,||L M
Campaign||N V
campaign||W _
,||_ `
string||a g
orderNumber||h s
,||s t
string||u {
segmentNumber	||| â
,
||â ä
ProDataResponse
||ã ö
data
||õ ü
,
||ü †
Customer
||° ©
customer
||™ ≤
,
||≤ ≥
List
||¥ ∏
<
||∏ π
long
||π Ω
>
||Ω æ
dayWise
||ø ∆
=
||« »
null
||… Õ
)
||Õ Œ
{}} 	
var~~ 
campaignTracking~~  
=~~! "
campaign~~# +
.~~+ ,
	Trackings~~, 5
.~~5 6
FirstOrDefault~~6 D
(~~D E
x~~E F
=>~~G I
x~~J K
.~~K L
OrderNumber~~L W
==~~X Z
orderNumber~~[ f
&&~~g i
x~~j k
.~~k l
SegmentNumber~~l y
==~~z |
segmentNumber	~~} ä
)
~~ä ã
;
~~ã å
long
ÄÄ 
quantity
ÄÄ 
=
ÄÄ 
orderNumber
ÄÄ '
.
ÄÄ' (
EndsWith
ÄÄ( 0
(
ÄÄ0 1
$str
ÄÄ1 6
)
ÄÄ6 7
?
ÄÄ8 9
campaign
ÄÄ: B
.
ÄÄB C#
ReBroadcastedQuantity
ÄÄC X
:
ÄÄY Z
campaign
ÄÄ[ c
.
ÄÄc d
Approved
ÄÄd l
.
ÄÄl m
Quantity
ÄÄm u
;
ÄÄu v
DateTime
ÅÅ 
?
ÅÅ 
startDateTime
ÅÅ #
=
ÅÅ$ %
orderNumber
ÅÅ& 1
.
ÅÅ1 2
EndsWith
ÅÅ2 :
(
ÅÅ: ;
$str
ÅÅ; @
)
ÅÅ@ A
?
ÅÅB C
campaign
ÅÅD L
.
ÅÅL M
ReBroadcastedDate
ÅÅM ^
:
ÅÅ_ `
campaign
ÅÅa i
.
ÅÅi j
Approved
ÅÅj r
.
ÅÅr s

DeployDate
ÅÅs }
;
ÅÅ} ~
if
ÑÑ 
(
ÑÑ 
campaignTracking
ÑÑ  
==
ÑÑ! #
null
ÑÑ$ (
)
ÑÑ( )
{
ÖÖ 
var
ÜÜ 

trackingId
ÜÜ 
=
ÜÜ  
Guid
ÜÜ! %
.
ÜÜ% &
NewGuid
ÜÜ& -
(
ÜÜ- .
)
ÜÜ. /
;
ÜÜ/ 0
campaignTracking
áá  
=
áá! "
new
áá# &
CampaignTracking
áá' 7
(
áá7 8
)
áá8 9
{
àà 
Id
ââ 
=
ââ 

trackingId
ââ #
,
ââ# $
	CreatedAt
ää 
=
ää 
DateTime
ää  (
.
ää( )
Now
ää) ,
,
ää, -

CampaignId
ãã 
=
ãã  
campaign
ãã! )
.
ãã) *
Id
ãã* ,
,
ãã, -
OrderNumber
åå 
=
åå  !
orderNumber
åå" -
,
åå- .
SegmentNumber
çç !
=
çç" #
string
çç$ *
.
çç* +
Empty
çç+ 0
,
çç0 1
Quantity
éé 
=
éé 
quantity
éé '
,
éé' (
DateSent
èè 
=
èè 
DateTime
èè '
.
èè' (
Now
èè( +
,
èè+ ,!
IsCreatedThroughApi
êê '
=
êê( )
false
êê* /
}
ëë 
;
ëë 
db
íí 
.
íí 
CampaignTrackings
íí $
.
íí$ %
Add
íí% (
(
íí( )
campaignTracking
íí) 9
)
íí9 :
;
íí: ;
db
ìì 
.
ìì 
SaveChanges
ìì 
(
ìì 
)
ìì  
;
ìì  !
}
îî 
if
ññ 
(
ññ 
campaignTracking
ññ  
?
ññ  !
.
ññ! "
DateSent
ññ" *
==
ññ+ -
null
ññ. 2
||
ññ3 5
data
ññ6 :
.
ññ: ;
reports
ññ; B
?
ññB C
.
ññC D
report
ññD J
==
ññK M
null
ññN R
||
ññS U
data
ññV Z
.
ññZ [
reports
ññ[ b
.
ññb c
report
ññc i
.
ññi j
Length
ññj p
==
ññq s
$num
ññt u
)
ññu v
return
ññw }
campaignTrackingññ~ é
;ññé è
var
òò 
reports
òò 
=
òò 
data
òò 
.
òò 
reports
òò &
.
òò& '
report
òò' -
;
òò- .
var
ôô 
report
ôô 
=
ôô 
reports
ôô  
[
ôô  !
$num
ôô! "
]
ôô" #
;
ôô# $
campaignTracking
öö 
.
öö 
IoNumber
öö %
=
öö& '
report
öö( .
.
öö. /
IO
öö/ 1
;
öö1 2
campaignTracking
õõ 
.
õõ 
	StartDate
õõ &
=
õõ' (
startDateTime
õõ) 6
;
õõ6 7
campaignTracking
úú 
.
úú 
Deployed
úú %
=
úú& '
(
úú( )
long
úú) -
)
úú- .
(
úú. /
campaignTracking
úú/ ?
.
úú? @
Quantity
úú@ H
*
úúI J
(
úúK L
$num
úúL M
+
úúN O
Random
úúP V
.
úúV W
Next
úúW [
(
úú[ \
$num
úú\ ]
,
úú] ^
$num
úú_ a
)
úúa b
/
úúc d
$num
úúe l
)
úúl m
)
úúm n
;
úún o
int
üü 

openRandom
üü 
=
üü 
Random
üü #
.
üü# $
Next
üü$ (
(
üü( )
(
üü) *
int
üü* -
)
üü- .
customer
üü. 6
.
üü6 7
OpenInitial
üü7 B
,
üüB C
(
üüD E
int
üüE H
)
üüH I
customer
üüI Q
.
üüQ R
OpenEnd
üüR Y
)
üüY Z
;
üüZ [
long
†† 
openCountTotal
†† 
=
††  !
(
††" #
long
††# '
)
††' (
(
††( )
(
††) *

openRandom
††* 4
*
††5 6
campaignTracking
††7 G
.
††G H
Quantity
††H P
/
††Q R
$num
††S [
)
††[ \
/
††] ^
$num
††_ d
)
††d e
;
††e f
campaignTracking
°° 
.
°° 
Opened
°° #
=
°°$ %
openCountTotal
°°& 4
;
°°4 5
campaignTracking
§§ 
.
§§ 
Desktop
§§ $
=
§§% &
(
§§' (
long
§§( ,
)
§§, -
(
§§- .
(
§§. /
(
§§/ 0
campaignTracking
§§0 @
.
§§@ A
Opened
§§A G
*
§§H I
Random
§§J P
.
§§P Q
Next
§§Q U
(
§§U V
$num
§§V [
,
§§[ \
$num
§§] b
)
§§b c
)
§§c d
/
§§e f
$num
§§g m
)
§§m n
/
§§o p
$num
§§q v
)
§§v w
;
§§w x
campaignTracking
•• 
.
•• 
Mobile
•• #
=
••$ %
campaignTracking
••& 6
.
••6 7
Opened
••7 =
-
••> ?
campaignTracking
••@ P
.
••P Q
Desktop
••Q X
;
••X Y
campaignTracking
ßß 
.
ßß 
Clicked
ßß $
=
ßß% &
reports
ßß' .
.
ßß. /
Sum
ßß/ 2
(
ßß2 3
x
ßß3 4
=>
ßß5 7
long
ßß8 <
.
ßß< =
Parse
ßß= B
(
ßßB C
x
ßßC D
.
ßßD E

ClickCount
ßßE O
)
ßßO P
)
ßßP Q
;
ßßQ R
campaignTracking
®® 
.
®® 
Unsub
®® "
=
®®# $
Random
®®% +
.
®®+ ,
Next
®®, 0
(
®®0 1
$num
®®1 2
,
®®2 3
$num
®®4 7
)
®®7 8
;
®®8 9
campaignTracking
©© 
.
©© 
Forwards
©© %
=
©©& '
Random
©©( .
.
©©. /
Next
©©/ 3
(
©©3 4
$num
©©4 5
,
©©5 6
$num
©©7 :
)
©©: ;
;
©©; <
campaignTracking
™™ 
.
™™ 
Bounce
™™ #
=
™™$ %
Random
™™& ,
.
™™, -
Next
™™- 1
(
™™1 2
$num
™™2 3
,
™™3 4
$num
™™5 7
)
™™7 8
;
™™8 9
campaignTracking
´´ 
.
´´ 
Opt
´´  
=
´´! "
Random
´´# )
.
´´) *
Next
´´* .
(
´´. /
$num
´´/ 0
,
´´0 1
$num
´´2 3
)
´´3 4
;
´´4 5
campaignTracking
∞∞ 
.
∞∞ $
RetargetingImpressions
∞∞ 3
=
∞∞4 5
(
∞∞6 7
long
∞∞7 ;
)
∞∞; <
(
∞∞< =
(
∞∞= >
campaignTracking
∞∞> N
.
∞∞N O
Quantity
∞∞O W
*
∞∞X Y
Random
∞∞Z `
.
∞∞` a
Next
∞∞a e
(
∞∞e f
$num
∞∞f l
,
∞∞l m
$num
∞∞n t
)
∞∞t u
)
∞∞u v
/
∞∞w x
$num∞∞y Å
)∞∞Å Ç
;∞∞Ç É
campaignTracking
≤≤ 
.
≤≤ 
RetargetingClicks
≤≤ .
=
≤≤/ 0
(
≤≤1 2
long
≤≤2 6
)
≤≤6 7
(
≤≤7 8
(
≤≤8 9
campaignTracking
≤≤9 I
.
≤≤I J
Quantity
≤≤J R
*
≤≤S T
Random
≤≤U [
.
≤≤[ \
Next
≤≤\ `
(
≤≤` a
$num
≤≤a d
,
≤≤d e
$num
≤≤f j
)
≤≤j k
)
≤≤k l
/
≤≤m n
$num
≤≤o w
)
≤≤w x
;
≤≤x y
campaignTracking
¥¥ 
.
¥¥  
DeliveryPercentage
¥¥ /
=
¥¥0 1
campaignTracking
¥¥2 B
.
¥¥B C
Quantity
¥¥C K
==
¥¥L N
$num
¥¥O P
?
¥¥Q R
$num
¥¥S T
:
¥¥U V
(
¥¥W X
double
¥¥X ^
)
¥¥^ _
campaignTracking
¥¥_ o
.
¥¥o p
Quantity
¥¥p x
/
¥¥y z
campaignTracking¥¥{ ã
.¥¥ã å
Deployed¥¥å î
;¥¥î ï
campaignTracking
µµ 
.
µµ 
OpenedPercentage
µµ -
=
µµ. /
campaignTracking
µµ0 @
.
µµ@ A
Quantity
µµA I
==
µµJ L
$num
µµM N
?
µµO P
$num
µµQ R
:
µµS T
(
µµU V
double
µµV \
)
µµ\ ]
campaignTracking
µµ] m
.
µµm n
Opened
µµn t
/
µµu v
campaignTrackingµµw á
.µµá à
Quantityµµà ê
;µµê ë
campaignTracking
∂∂ 
.
∂∂ 
ClickedPercentage
∂∂ .
=
∂∂/ 0
campaignTracking
∂∂1 A
.
∂∂A B
Quantity
∂∂B J
==
∂∂K M
$num
∂∂N O
?
∂∂P Q
$num
∂∂R S
:
∂∂T U
(
∂∂V W
double
∂∂W ]
)
∂∂] ^
campaignTracking
∂∂^ n
.
∂∂n o
Clicked
∂∂o v
/
∂∂w x
campaignTracking∂∂y â
.∂∂â ä
Quantity∂∂ä í
;∂∂í ì
campaignTracking
∑∑ 
.
∑∑ 
UnsubPercentage
∑∑ ,
=
∑∑- .
campaignTracking
∑∑/ ?
.
∑∑? @
Quantity
∑∑@ H
==
∑∑I K
$num
∑∑L M
?
∑∑N O
$num
∑∑P Q
:
∑∑R S
(
∑∑T U
double
∑∑U [
)
∑∑[ \
campaignTracking
∑∑\ l
.
∑∑l m
Unsub
∑∑m r
/
∑∑s t
campaignTracking∑∑u Ö
.∑∑Ö Ü
Quantity∑∑Ü é
;∑∑é è
campaignTracking
∏∏ 
.
∏∏ #
ClickToOpenPercentage
∏∏ 2
=
∏∏3 4
campaignTracking
∏∏5 E
.
∏∏E F
Opened
∏∏F L
==
∏∏M O
$num
∏∏P Q
?
∏∏R S
$num
∏∏T U
:
∏∏V W
(
∏∏X Y
double
∏∏Y _
)
∏∏_ `
campaignTracking
∏∏` p
.
∏∏p q
Clicked
∏∏q x
/
∏∏y z
campaignTracking∏∏{ ã
.∏∏ã å
Opened∏∏å í
;∏∏í ì
campaignTracking
ππ 
.
ππ #
UnsubToOpenPercentage
ππ 2
=
ππ3 4
campaignTracking
ππ5 E
.
ππE F
Opened
ππF L
==
ππM O
$num
ππP Q
?
ππR S
$num
ππT U
:
ππV W
(
ππX Y
double
ππY _
)
ππ_ `
campaignTracking
ππ` p
.
ππp q
Unsub
ππq v
/
ππw x
campaignTrackingππy â
.ππâ ä
Openedππä ê
;ππê ë
if
ªª 
(
ªª 
dayWise
ªª 
!=
ªª 
null
ªª 
)
ªª 
{
ºº 
campaignTracking
ΩΩ  
.
ΩΩ  !

Day1Clicks
ΩΩ! +
=
ΩΩ, -
GetCount
ΩΩ. 6
(
ΩΩ6 7
dayWise
ΩΩ7 >
,
ΩΩ> ?
$num
ΩΩ@ A
)
ΩΩA B
;
ΩΩB C
campaignTracking
ææ  
.
ææ  !

Day2Clicks
ææ! +
=
ææ, -
GetCount
ææ. 6
(
ææ6 7
dayWise
ææ7 >
,
ææ> ?
$num
ææ@ A
)
ææA B
;
ææB C
campaignTracking
øø  
.
øø  !

Day3Clicks
øø! +
=
øø, -
GetCount
øø. 6
(
øø6 7
dayWise
øø7 >
,
øø> ?
$num
øø@ A
)
øøA B
;
øøB C
campaignTracking
¿¿  
.
¿¿  !

Day4Clicks
¿¿! +
=
¿¿, -
GetCount
¿¿. 6
(
¿¿6 7
dayWise
¿¿7 >
,
¿¿> ?
$num
¿¿@ A
)
¿¿A B
;
¿¿B C
campaignTracking
¡¡  
.
¡¡  !

Day5Clicks
¡¡! +
=
¡¡, -
GetCount
¡¡. 6
(
¡¡6 7
dayWise
¡¡7 >
,
¡¡> ?
$num
¡¡@ A
)
¡¡A B
;
¡¡B C
campaignTracking
¬¬  
.
¬¬  !

Day6Clicks
¬¬! +
=
¬¬, -
GetCount
¬¬. 6
(
¬¬6 7
dayWise
¬¬7 >
,
¬¬> ?
$num
¬¬@ A
)
¬¬A B
;
¬¬B C
campaignTracking
√√  
.
√√  !

Day7Clicks
√√! +
=
√√, -
GetCount
√√. 6
(
√√6 7
dayWise
√√7 >
,
√√> ?
$num
√√@ A
)
√√A B
;
√√B C
campaignTracking
ƒƒ  
.
ƒƒ  !
Day7PlusClicks
ƒƒ! /
=
ƒƒ0 1
dayWise
ƒƒ2 9
.
ƒƒ9 :
Sum
ƒƒ: =
(
ƒƒ= >
)
ƒƒ> ?
;
ƒƒ? @
}
≈≈ 
db
∆∆ 
.
∆∆ 
SaveChanges
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
return
»» 
campaignTracking
»» #
;
»»# $
}
…… 	
public
ÀÀ 
static
ÀÀ 
long
ÀÀ 
GetCount
ÀÀ #
(
ÀÀ# $
List
ÀÀ$ (
<
ÀÀ( )
long
ÀÀ) -
>
ÀÀ- .
dayWise
ÀÀ/ 6
,
ÀÀ6 7
int
ÀÀ8 ;
index
ÀÀ< A
)
ÀÀA B
{
ÃÃ 	
long
ÕÕ 
dayWiseCount
ÕÕ 
=
ÕÕ 
$num
ÕÕ  !
;
ÕÕ! "
try
ŒŒ 
{
œœ 
dayWiseCount
–– 
=
–– 
dayWise
–– &
[
––& '
index
––' ,
]
––, -
;
––- .
return
—— 
dayWiseCount
—— #
;
——# $
}
““ 
catch
”” 
(
”” 
	Exception
”” 
)
”” 
{
‘‘ 
}
÷÷ 
return
◊◊ 
dayWiseCount
◊◊ 
;
◊◊  
}
ÿÿ 	
}
ŸŸ 
}⁄⁄ ˙
OD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 7
)7 8
]8 9
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 9
)9 :
]: ;
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ñ
KD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\SmartSheet\SheetMap.cs
	namespace 	
ADSDataDirect
 
. 
Infrastructure &
.& '

Smartsheet' 1
{ 
public 

class 
SheetMap 
{ 
public		 
Sheet		 
Sheet		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 

Dictionary

 
<

 
string

  
,

  !
long

" &
>

& '
	ColumnMap

( 1
{

2 3
get

4 7
;

7 8
set

9 <
;

< =
}

> ?
public 
Cell 
GetCellByColumnName '
(' (
AbstractRow( 3
<3 4
Column4 :
,: ;
Cell< @
>@ A
rowB E
,E F
stringG M

columnNameN X
)X Y
{ 	
return 
row 
. 
Cells 
. 
First "
(" #
cell# '
=>( *
cell+ /
./ 0
ColumnId0 8
==9 ;
	ColumnMap< E
[E F

columnNameF P
]P Q
)Q R
;R S
} 	
public 
Row 
GetRowByIONumber #
(# $
string$ *
IONumber+ 3
)3 4
{ 	
Row 
rowFound 
= 
null 
;  
foreach 
( 
var 
row 
in 
Sheet  %
.% &
Rows& *
)* +
{ 
var 
cell 
= 
GetCellByColumnName .
(. /
row/ 2
,2 3
$str4 9
)9 :
;: ;
if 
( 
cell 
. 
DisplayValue %
==& (
IONumber) 1
)1 2
{ 
rowFound 
= 
row "
;" #
break 
; 
} 
} 
return 
rowFound 
; 
} 	
public   
Row   

GetRowById   
(   
long   "
rowId  # (
)  ( )
{!! 	
Row"" 
rowFound"" 
="" 
Sheet""  
.""  !
Rows""! %
.""% &
FirstOrDefault""& 4
(""4 5
x""5 6
=>""7 9
x"": ;
.""; <
Id""< >
==""? A
rowId""B G
)""G H
;""H I
return## 
rowFound## 
;## 
}$$ 	
}&& 
}'' öã
TD:\GitHub\ADSDataDirect\ADSDataDirect.Infrastructure\SmartSheet\SmartsheetManager.cs
	namespace

 	
ADSDataDirect


 
.

 
Infrastructure

 &
.

& '

Smartsheet

' 1
{ 
public 

class 
SmartsheetManager "
{ 
readonly 
WfpictContext 
Db !
;! "
public 
SmartsheetManager  
(  !
WfpictContext! .
db/ 1
)1 2
{ 	
Db 
= 
db 
; 
} 	
private 
static 

Dictionary !
<! "
string" (
,( )
SheetMap* 2
>2 3
	sheetMaps4 =
=> ?
new@ C

DictionaryD N
<N O
stringO U
,U V
SheetMapW _
>_ `
(` a
)a b
;b c
private 
static 
SmartsheetClient '
	GetClient( 1
(1 2
)2 3
{ 	
SmartsheetClient 
client #
=$ %
new& )
SmartsheetBuilder* ;
(; <
)< =
. 
SetAccessToken 
(   
ConfigurationManager  4
.4 5
AppSettings5 @
[@ A
$strA S
]S T
)T U
. 
Build 
( 
) 
; 
return 
client 
; 
} 	
public 
PaginatedResult 
< 
Sheet $
>$ %
	GetSheets& /
(/ 0
)0 1
{   	
PaginatedResult"" 
<"" 
Sheet"" !
>""! "
sheets""# )
=""* +
	GetClient"", 5
(""5 6
)""6 7
.""7 8
SheetResources""8 F
.""F G

ListSheets""G Q
(""Q R
null## 
,## 
null$$ 
,$$ 
null%% 
)&& 
;&& 
Console'' 
.'' 
	WriteLine'' 
('' 
$str'' &
+''' (
sheets'') /
.''/ 0

TotalCount''0 :
+''; <
$str''= F
)''F G
;''G H
return(( 
sheets(( 
;(( 
})) 	
public++ 
List++ 
<++ 
string++ 
>++ 
GetSheetNames++ )
(++) *
)++* +
{,, 	
return-- 
	GetSheets-- 
(-- 
)-- 
.-- 
Data-- #
.--# $
Select--$ *
(--* +
x--+ ,
=>--- /
x--0 1
.--1 2
Name--2 6
)--6 7
.--7 8
ToList--8 >
(--> ?
)--? @
;--@ A
}.. 	
public00 
void00 
LoadSheetMaps00 !
(00! "
)00" #
{11 	
	sheetMaps22 
.22 
Clear22 
(22 
)22 
;22 
foreach33 
(33 
var33 
sheet33 
in33 !
	GetSheets33" +
(33+ ,
)33, -
.33- .
Data33. 2
)332 3
{44 
Console55 
.55 
	WriteLine55 !
(55! "
$str55" 6
+557 8
sheet559 >
.55> ?
Id55? A
)55A B
;55B C
var88 
entireSheet88 
=88  !
	GetClient88" +
(88+ ,
)88, -
.88- .
SheetResources88. <
.88< =
GetSheet88= E
(88E F
sheet99 
.99 
Id99 
.99 
Value99 "
,99" #
null:: 
,:: 
null;; 
,;; 
null<< 
,<< 
null== 
,== 
null>> 
,>> 
null?? 
,?? 
null@@ 
)AA 
;AA 
ConsoleBB 
.BB 
	WriteLineBB !
(BB! "
$strBB" +
+BB, -
entireSheetBB. 9
.BB9 :
RowsBB: >
.BB> ?
CountBB? D
+BBE F
$strBBG [
+BB\ ]
entireSheetBB^ i
.BBi j
NameBBj n
)BBn o
;BBo p

DictionaryDD 
<DD 
stringDD !
,DD! "
longDD# '
>DD' (
	columnMapDD) 2
=DD3 4
newDD5 8

DictionaryDD9 C
<DDC D
stringDDD J
,DDJ K
longDDL P
>DDP Q
(DDQ R
)DDR S
;DDS T
foreachEE 
(EE 
ColumnEE 
columnEE  &
inEE' )
entireSheetEE* 5
.EE5 6
ColumnsEE6 =
)EE= >
	columnMapFF 
.FF 
AddFF !
(FF! "
columnFF" (
.FF( )
TitleFF) .
,FF. /
(FF0 1
longFF1 5
)FF5 6
columnFF6 <
.FF< =
IdFF= ?
)FF? @
;FF@ A
	sheetMapsHH 
.HH 
AddHH 
(HH 
sheetHH #
.HH# $
NameHH$ (
,HH( )
newHH* -
SheetMapHH. 6
(HH6 7
)HH7 8
{HH9 :
SheetHH; @
=HHA B
entireSheetHHC N
,HHN O
	ColumnMapHHP Y
=HHZ [
	columnMapHH\ e
}HHf g
)HHg h
;HHh i
}II 
}JJ 	
publicLL 
ListLL 
<LL 
CampaignLL 
>LL 
ReadLL "
(LL" #
stringLL# )
	sheetNameLL* 3
)LL3 4
{MM 	
ListNN 
<NN 
CampaignNN 
>NN 
	campaignsNN $
=NN% &
newNN' *
ListNN+ /
<NN/ 0
CampaignNN0 8
>NN8 9
(NN9 :
)NN: ;
;NN; <
varOO 
campsOO 
=OO 
DbOO 
.OO 
	CampaignsOO $
.OO$ %
ToListOO% +
(OO+ ,
)OO, -
;OO- .
intPP 
newOrderNumberPP 
=PP  
campsPP! &
.PP& '
CountPP' ,
>PP- .
$numPP/ 0
?QQ 
campsQQ 
.QQ 
MaxQQ 
(QQ 
xQQ 
=>QQ  
intQQ! $
.QQ$ %
ParseQQ% *
(QQ* +
xQQ+ ,
.QQ, -
OrderNumberQQ- 8
.QQ8 9
TrimEndQQ9 @
(QQ@ A
$strQQA F
.QQF G
ToCharArrayQQG R
(QQR S
)QQS T
)QQT U
)QQU V
)QQV W
+QQX Y
$numQQZ [
:RR 
$numRR 
;RR 
varTT 
sheetMapTT 
=TT 
	sheetMapsTT $
[TT$ %
	sheetNameTT% .
]TT. /
;TT/ 0
foreachVV 
(VV 
varVV 
rowVV 
inVV 
sheetMapVV  (
.VV( )
SheetVV) .
.VV. /
RowsVV/ 3
)VV3 4
{WW 
CampaignXX 
campaignXX !
=XX" #
nullXX$ (
;XX( )
switchZZ 
(ZZ 
	sheetNameZZ !
)ZZ! "
{[[ 
case\\ 
$str\\ $
:\\$ %
campaign]]  
=]]! "
ReadRowStrategus]]# 3
(]]3 4
row]]4 7
,]]7 8
sheetMap]]9 A
)]]A B
;]]B C
break^^ 
;^^ 
case__ 
$str__ .
:__. /
campaign``  
=``! "
ReadRowCustomers``# 3
(``3 4
row``4 7
,``7 8
sheetMap``9 A
)``A B
;``B C
breakaa 
;aa 
casebb 
$strbb .
:bb. /
campaigncc  
=cc! "
ReadRowAdvantagecc# 3
(cc3 4
rowcc4 7
,cc7 8
sheetMapcc9 A
)ccA B
;ccB C
breakdd 
;dd 
defaultee 
:ee 
throwff 
newff !
AdsExceptionff" .
(ff. /
$strff/ d
)ffd e
;ffe f
}gg 
ifii 
(ii 
campaignii 
==ii 
nullii  $
)ii$ %
continuejj 
;jj 
campaignll 
.ll 
OrderNumberll $
=ll% &
newOrderNumberll' 5
.ll5 6
ToStringll6 >
(ll> ?
)ll? @
;ll@ A
newOrderNumbermm 
++mm  
;mm  !
	campaignsnn 
.nn 
Addnn 
(nn 
campaignnn &
)nn& '
;nn' (
}oo 
returnpp 
	campaignspp 
;pp 
}qq 	
privatess 
Campaignss 
ReadRowStrategusss )
(ss) *
Rowss* -
rowss. 1
,ss1 2
SheetMapss3 ;
sheetMapss< D
)ssD E
{tt 	
stringvv 
IONumbervv 
=vv 
sheetMapvv &
.vv& '
GetCellByColumnNamevv' :
(vv: ;
rowvv; >
,vv> ?
$strvv@ O
)vvO P
.vvP Q
DisplayValuevvQ ]
;vv] ^
ifww 
(ww 
!ww 
stringww 
.ww 
IsNullOrEmptyww %
(ww% &
IONumberww& .
)ww. /
)ww/ 0
returnxx 
nullxx 
;xx 
varzz 
campaignzz 
=zz 
newzz 
Campaignzz '
(zz' (
)zz( )
;zz) *
campaign{{ 
.{{ 
Price{{ 
={{ 
row{{  
.{{  !
Id{{! #
.{{# $
Value{{$ )
;{{) *
campaign|| 
.|| 
Id|| 
=|| 
Guid|| 
.|| 
NewGuid|| &
(||& '
)||' (
;||( )
campaign}} 
.}} 
	CreatedAt}} 
=}}  
DateTime}}! )
.}}) *
Now}}* -
;}}- .
campaign~~ 
.~~ 
	CreatedBy~~ 
=~~  
$str~~! -
;~~- .
campaign 
. 
Status 
= 
( 
int "
)" #
CampaignStatus# 1
.1 2
OrderRecevied2 ?
;? @
campaign
ÄÄ 
.
ÄÄ 

WhiteLabel
ÄÄ 
=
ÄÄ  !
StringConstants
ÄÄ" 1
.
ÄÄ1 2
CustomerStrategus
ÄÄ2 C
;
ÄÄC D
campaign
ÅÅ 
.
ÅÅ 
CampaignName
ÅÅ !
=
ÅÅ" #
sheetMap
ÅÅ$ ,
.
ÅÅ, -!
GetCellByColumnName
ÅÅ- @
(
ÅÅ@ A
row
ÅÅA D
,
ÅÅD E
$str
ÅÅF U
)
ÅÅU V
.
ÅÅV W
DisplayValue
ÅÅW c
;
ÅÅc d
campaign
ÇÇ 
.
ÇÇ 
Quantity
ÇÇ 
=
ÇÇ 
sheetMap
ÇÇ  (
.
ÇÇ( )!
GetCellByColumnName
ÇÇ) <
(
ÇÇ< =
row
ÇÇ= @
,
ÇÇ@ A
$str
ÇÇB S
)
ÇÇS T
.
ÇÇT U
DisplayValue
ÇÇU a
.
ÇÇa b
	ToSafeInt
ÇÇb k
(
ÇÇk l
)
ÇÇl m
;
ÇÇm n
campaign
ÉÉ 
.
ÉÉ 
BroadcastDate
ÉÉ "
=
ÉÉ# $
sheetMap
ÉÉ% -
.
ÉÉ- .!
GetCellByColumnName
ÉÉ. A
(
ÉÉA B
row
ÉÉB E
,
ÉÉE F
$str
ÉÉG W
)
ÉÉW X
.
ÉÉX Y
Value
ÉÉY ^
.
ÉÉ^ _
ToSafeDateTime
ÉÉ_ m
(
ÉÉm n
)
ÉÉn o
;
ÉÉo p
campaign
ÑÑ 
.
ÑÑ 

GeoDetails
ÑÑ 
=
ÑÑ  !
sheetMap
ÑÑ" *
.
ÑÑ* +!
GetCellByColumnName
ÑÑ+ >
(
ÑÑ> ?
row
ÑÑ? B
,
ÑÑB C
$str
ÑÑD O
)
ÑÑO P
.
ÑÑP Q
DisplayValue
ÑÑQ ]
;
ÑÑ] ^
campaign
ÖÖ 
.
ÖÖ 
Demographics
ÖÖ !
=
ÖÖ" #
sheetMap
ÖÖ$ ,
.
ÖÖ, -!
GetCellByColumnName
ÖÖ- @
(
ÖÖ@ A
row
ÖÖA D
,
ÖÖD E
$str
ÖÖF T
)
ÖÖT U
.
ÖÖU V
DisplayValue
ÖÖV b
;
ÖÖb c
campaign
ÜÜ 
.
ÜÜ 
FromLine
ÜÜ 
=
ÜÜ 
sheetMap
ÜÜ  (
.
ÜÜ( )!
GetCellByColumnName
ÜÜ) <
(
ÜÜ< =
row
ÜÜ= @
,
ÜÜ@ A
$str
ÜÜB M
)
ÜÜM N
.
ÜÜN O
Value
ÜÜO T
.
ÜÜT U
ToSafeString
ÜÜU a
(
ÜÜa b
)
ÜÜb c
;
ÜÜc d
campaign
áá 
.
áá 
SubjectLine
áá  
=
áá! "
sheetMap
áá# +
.
áá+ ,!
GetCellByColumnName
áá, ?
(
áá? @
row
áá@ C
,
ááC D
$str
ááE S
)
ááS T
.
ááT U
DisplayValue
ááU a
;
ááa b
campaign
àà 
.
àà !
SpecialInstructions
àà (
=
àà) *
sheetMap
àà+ 3
.
àà3 4!
GetCellByColumnName
àà4 G
(
ààG H
row
ààH K
,
ààK L
$str
ààM c
)
ààc d
.
ààd e
DisplayValue
ààe q
;
ààq r
campaign
ââ 
.
ââ 
ReBroadcastedURL
ââ %
=
ââ& '
sheetMap
ââ( 0
.
ââ0 1!
GetCellByColumnName
ââ1 D
(
ââD E
row
ââE H
,
ââH I
$str
ââJ S
)
ââS T
.
ââT U
DisplayValue
ââU a
;
ââa b
campaign
ää 
.
ää  
RepresentativeName
ää '
=
ää( )
sheetMap
ää* 2
.
ää2 3!
GetCellByColumnName
ää3 F
(
ääF G
row
ääG J
,
ääJ K
$str
ääL Y
)
ääY Z
.
ääZ [
DisplayValue
ää[ g
;
ääg h
campaign
ãã 
.
ãã !
RepresentativeEmail
ãã (
=
ãã) *
sheetMap
ãã+ 3
.
ãã3 4!
GetCellByColumnName
ãã4 G
(
ããG H
row
ããH K
,
ããK L
$str
ããM Z
)
ããZ [
.
ãã[ \
DisplayValue
ãã\ h
;
ããh i
campaign
åå 
.
åå 
Assets
åå 
=
åå 
new
åå !
CampaignAsset
åå" /
(
åå/ 0
)
åå0 1
;
åå1 2
campaign
éé 
.
éé 
Assets
éé 
.
éé 
Id
éé 
=
éé  
Guid
éé! %
.
éé% &
NewGuid
éé& -
(
éé- .
)
éé. /
;
éé/ 0
campaign
èè 
.
èè 
Assets
èè 
.
èè 

CampaignId
èè &
=
èè' (
campaign
èè) 1
.
èè1 2
Id
èè2 4
;
èè4 5
campaign
êê 
.
êê 
Assets
êê 
.
êê 
	CreatedAt
êê %
=
êê& '
DateTime
êê( 0
.
êê0 1
Now
êê1 4
;
êê4 5
campaign
ëë 
.
ëë 
Assets
ëë 
.
ëë 
	CreatedBy
ëë %
=
ëë& '
$str
ëë( 4
;
ëë4 5
return
ìì 
campaign
ìì 
;
ìì 
}
îî 	
private
ññ 
Campaign
ññ 
ReadRowCustomers
ññ )
(
ññ) *
Row
ññ* -
row
ññ. 1
,
ññ1 2
SheetMap
ññ3 ;
sheetMap
ññ< D
)
ññD E
{
óó 	
string
ôô 
IONumber
ôô 
=
ôô 
sheetMap
ôô &
.
ôô& '!
GetCellByColumnName
ôô' :
(
ôô: ;
row
ôô; >
,
ôô> ?
$str
ôô@ E
)
ôôE F
.
ôôF G
DisplayValue
ôôG S
;
ôôS T
if
öö 
(
öö 
!
öö 
string
öö 
.
öö 
IsNullOrEmpty
öö %
(
öö% &
IONumber
öö& .
)
öö. /
)
öö/ 0
return
õõ 
null
õõ 
;
õõ 
var
ùù 
campaign
ùù 
=
ùù 
new
ùù 
Campaign
ùù '
(
ùù' (
)
ùù( )
;
ùù) *
campaign
ûû 
.
ûû 
Price
ûû 
=
ûû 
row
ûû  
.
ûû  !
Id
ûû! #
.
ûû# $
Value
ûû$ )
;
ûû) *
campaign
üü 
.
üü 
Id
üü 
=
üü 
Guid
üü 
.
üü 
NewGuid
üü &
(
üü& '
)
üü' (
;
üü( )
campaign
†† 
.
†† 
	CreatedAt
†† 
=
††  
DateTime
††! )
.
††) *
Now
††* -
;
††- .
campaign
°° 
.
°° 
	CreatedBy
°° 
=
°°  
$str
°°! -
;
°°- .
campaign
¢¢ 
.
¢¢ 
Status
¢¢ 
=
¢¢ 
(
¢¢ 
int
¢¢ "
)
¢¢" #
CampaignStatus
¢¢# 1
.
¢¢1 2
OrderRecevied
¢¢2 ?
;
¢¢? @
campaign
££ 
.
££ 

WhiteLabel
££ 
=
££  !
sheetMap
££" *
.
££* +!
GetCellByColumnName
££+ >
(
££> ?
row
££? B
,
££B C
$str
££D Q
)
££Q R
.
££R S
DisplayValue
££S _
;
££_ `
campaign
§§ 
.
§§ 
CampaignName
§§ !
=
§§" #
sheetMap
§§$ ,
.
§§, -!
GetCellByColumnName
§§- @
(
§§@ A
row
§§A D
,
§§D E
$str
§§F U
)
§§U V
.
§§V W
DisplayValue
§§W c
;
§§c d
campaign
•• 
.
•• 
BroadcastDate
•• "
=
••# $
sheetMap
••% -
.
••- .!
GetCellByColumnName
••. A
(
••A B
row
••B E
,
••E F
$str
••G W
)
••W X
.
••X Y
Value
••Y ^
.
••^ _
ToSafeDateTime
••_ m
(
••m n
)
••n o
;
••o p
campaign
¶¶ 
.
¶¶  
RepresentativeName
¶¶ '
=
¶¶( )
sheetMap
¶¶* 2
.
¶¶2 3!
GetCellByColumnName
¶¶3 F
(
¶¶F G
row
¶¶G J
,
¶¶J K
$str
¶¶L \
)
¶¶\ ]
.
¶¶] ^
DisplayValue
¶¶^ j
;
¶¶j k
campaign
ßß 
.
ßß !
RepresentativeEmail
ßß (
=
ßß) *
sheetMap
ßß+ 3
.
ßß3 4!
GetCellByColumnName
ßß4 G
(
ßßG H
row
ßßH K
,
ßßK L
$str
ßßM ]
)
ßß] ^
.
ßß^ _
DisplayValue
ßß_ k
;
ßßk l
campaign
©© 
.
©© 
Quantity
©© 
=
©© 
sheetMap
©©  (
.
©©( )!
GetCellByColumnName
©©) <
(
©©< =
row
©©= @
,
©©@ A
$str
©©B G
)
©©G H
.
©©H I
DisplayValue
©©I U
.
©©U V
	ToSafeInt
©©V _
(
©©_ `
)
©©` a
;
©©a b
campaign
™™ 
.
™™ 

GeoDetails
™™ 
=
™™  !
sheetMap
™™" *
.
™™* +!
GetCellByColumnName
™™+ >
(
™™> ?
row
™™? B
,
™™B C
$str
™™D I
)
™™I J
.
™™J K
DisplayValue
™™K W
;
™™W X
campaign
´´ 
.
´´ 
Demographics
´´ !
=
´´" #
sheetMap
´´$ ,
.
´´, -!
GetCellByColumnName
´´- @
(
´´@ A
row
´´A D
,
´´D E
$str
´´F L
)
´´L M
.
´´M N
DisplayValue
´´N Z
;
´´Z [
campaign
¨¨ 
.
¨¨ 
FromLine
¨¨ 
=
¨¨ 
sheetMap
¨¨  (
.
¨¨( )!
GetCellByColumnName
¨¨) <
(
¨¨< =
row
¨¨= @
,
¨¨@ A
$str
¨¨B M
)
¨¨M N
.
¨¨N O
DisplayValue
¨¨O [
;
¨¨[ \
campaign
≠≠ 
.
≠≠ 
SubjectLine
≠≠  
=
≠≠! "
sheetMap
≠≠# +
.
≠≠+ ,!
GetCellByColumnName
≠≠, ?
(
≠≠? @
row
≠≠@ C
,
≠≠C D
$str
≠≠E S
)
≠≠S T
.
≠≠T U
DisplayValue
≠≠U a
;
≠≠a b
campaign
ÆÆ 
.
ÆÆ !
SpecialInstructions
ÆÆ (
=
ÆÆ) *
sheetMap
ÆÆ+ 3
.
ÆÆ3 4!
GetCellByColumnName
ÆÆ4 G
(
ÆÆG H
row
ÆÆH K
,
ÆÆK L
$str
ÆÆM c
)
ÆÆc d
.
ÆÆd e
DisplayValue
ÆÆe q
;
ÆÆq r
campaign
ØØ 
.
ØØ 
IsPersonalization
ØØ &
=
ØØ' (
sheetMap
ØØ) 1
.
ØØ1 2!
GetCellByColumnName
ØØ2 E
(
ØØE F
row
ØØF I
,
ØØI J
$str
ØØK \
)
ØØ\ ]
.
ØØ] ^
Value
ØØ^ c
.
ØØc d
ToSafeBoolean
ØØd q
(
ØØq r
)
ØØr s
;
ØØs t
campaign
∞∞ 
.
∞∞ 
IsSuppression
∞∞ "
=
∞∞# $
sheetMap
∞∞% -
.
∞∞- .!
GetCellByColumnName
∞∞. A
(
∞∞A B
row
∞∞B E
,
∞∞E F
$str
∞∞G T
)
∞∞T U
.
∞∞U V
Value
∞∞V [
.
∞∞[ \
ToSafeBoolean
∞∞\ i
(
∞∞i j
)
∞∞j k
;
∞∞k l
campaign
±± 
.
±± 
Assets
±± 
=
±± 
new
±± !
CampaignAsset
±±" /
(
±±/ 0
)
±±0 1
;
±±1 2
campaign
≥≥ 
.
≥≥ 
Assets
≥≥ 
.
≥≥ 
Id
≥≥ 
=
≥≥  
Guid
≥≥! %
.
≥≥% &
NewGuid
≥≥& -
(
≥≥- .
)
≥≥. /
;
≥≥/ 0
campaign
¥¥ 
.
¥¥ 
Assets
¥¥ 
.
¥¥ 

CampaignId
¥¥ &
=
¥¥' (
campaign
¥¥) 1
.
¥¥1 2
Id
¥¥2 4
;
¥¥4 5
campaign
µµ 
.
µµ 
Assets
µµ 
.
µµ 
	CreatedAt
µµ %
=
µµ& '
DateTime
µµ( 0
.
µµ0 1
Now
µµ1 4
;
µµ4 5
campaign
∂∂ 
.
∂∂ 
Assets
∂∂ 
.
∂∂ 
	CreatedBy
∂∂ %
=
∂∂& '
$str
∂∂( 4
;
∂∂4 5
return
∏∏ 
campaign
∏∏ 
;
∏∏ 
}
ππ 	
private
ªª 
Campaign
ªª 
ReadRowAdvantage
ªª )
(
ªª) *
Row
ªª* -
row
ªª. 1
,
ªª1 2
SheetMap
ªª3 ;
sheetMap
ªª< D
)
ªªD E
{
ºº 	
string
ææ 
IONumber
ææ 
=
ææ 
sheetMap
ææ &
.
ææ& '!
GetCellByColumnName
ææ' :
(
ææ: ;
row
ææ; >
,
ææ> ?
$str
ææ@ J
)
ææJ K
.
ææK L
DisplayValue
ææL X
;
ææX Y
if
øø 
(
øø 
!
øø 
string
øø 
.
øø 
IsNullOrEmpty
øø %
(
øø% &
IONumber
øø& .
)
øø. /
)
øø/ 0
return
¿¿ 
null
¿¿ 
;
¿¿ 
var
¬¬ 
campaign
¬¬ 
=
¬¬ 
new
¬¬ 
Campaign
¬¬ '
(
¬¬' (
)
¬¬( )
;
¬¬) *
campaign
√√ 
.
√√ 
Price
√√ 
=
√√ 
row
√√  
.
√√  !
Id
√√! #
.
√√# $
Value
√√$ )
;
√√) *
campaign
ƒƒ 
.
ƒƒ 
Id
ƒƒ 
=
ƒƒ 
Guid
ƒƒ 
.
ƒƒ 
NewGuid
ƒƒ &
(
ƒƒ& '
)
ƒƒ' (
;
ƒƒ( )
campaign
≈≈ 
.
≈≈ 
	CreatedAt
≈≈ 
=
≈≈  
DateTime
≈≈! )
.
≈≈) *
Now
≈≈* -
;
≈≈- .
campaign
∆∆ 
.
∆∆ 
	CreatedBy
∆∆ 
=
∆∆  
$str
∆∆! -
;
∆∆- .
campaign
«« 
.
«« 
Status
«« 
=
«« 
(
«« 
int
«« "
)
««" #
CampaignStatus
««# 1
.
««1 2
OrderRecevied
««2 ?
;
««? @
campaign
»» 
.
»» 

WhiteLabel
»» 
=
»»  !
StringConstants
»»" 1
.
»»1 2
CustomerAdvantage
»»2 C
;
»»C D
campaign
…… 
.
…… 
CampaignName
…… !
=
……" #
sheetMap
……$ ,
.
……, -!
GetCellByColumnName
……- @
(
……@ A
row
……A D
,
……D E
$str
……F U
)
……U V
.
……V W
DisplayValue
……W c
;
……c d
campaign
   
.
   
BroadcastDate
   "
=
  # $
sheetMap
  % -
.
  - .!
GetCellByColumnName
  . A
(
  A B
row
  B E
,
  E F
$str
  G W
)
  W X
.
  X Y
Value
  Y ^
.
  ^ _
ToSafeDateTime
  _ m
(
  m n
)
  n o
;
  o p
campaign
ÀÀ 
.
ÀÀ  
RepresentativeName
ÀÀ '
=
ÀÀ( )
sheetMap
ÀÀ* 2
.
ÀÀ2 3!
GetCellByColumnName
ÀÀ3 F
(
ÀÀF G
row
ÀÀG J
,
ÀÀJ K
$str
ÀÀL ]
)
ÀÀ] ^
.
ÀÀ^ _
DisplayValue
ÀÀ_ k
;
ÀÀk l
campaign
ÃÃ 
.
ÃÃ !
RepresentativeEmail
ÃÃ (
=
ÃÃ) *
sheetMap
ÃÃ+ 3
.
ÃÃ3 4!
GetCellByColumnName
ÃÃ4 G
(
ÃÃG H
row
ÃÃH K
,
ÃÃK L
$str
ÃÃM ^
)
ÃÃ^ _
.
ÃÃ_ `
DisplayValue
ÃÃ` l
;
ÃÃl m
campaign
ÕÕ 
.
ÕÕ 
Quantity
ÕÕ 
=
ÕÕ 
sheetMap
ÕÕ  (
.
ÕÕ( )!
GetCellByColumnName
ÕÕ) <
(
ÕÕ< =
row
ÕÕ= @
,
ÕÕ@ A
$str
ÕÕB V
)
ÕÕV W
.
ÕÕW X
DisplayValue
ÕÕX d
.
ÕÕd e
	ToSafeInt
ÕÕe n
(
ÕÕn o
)
ÕÕo p
;
ÕÕp q
campaign
ŒŒ 
.
ŒŒ 

GeoDetails
ŒŒ 
=
ŒŒ  !
sheetMap
ŒŒ" *
.
ŒŒ* +!
GetCellByColumnName
ŒŒ+ >
(
ŒŒ> ?
row
ŒŒ? B
,
ŒŒB C
$str
ŒŒD M
)
ŒŒM N
.
ŒŒN O
DisplayValue
ŒŒO [
;
ŒŒ[ \
campaign
œœ 
.
œœ 
FromLine
œœ 
=
œœ 
sheetMap
œœ  (
.
œœ( )!
GetCellByColumnName
œœ) <
(
œœ< =
row
œœ= @
,
œœ@ A
$str
œœB M
)
œœM N
.
œœN O
Value
œœO T
.
œœT U
ToSafeString
œœU a
(
œœa b
)
œœb c
;
œœc d
campaign
–– 
.
–– 
SubjectLine
––  
=
––! "
sheetMap
––# +
.
––+ ,!
GetCellByColumnName
––, ?
(
––? @
row
––@ C
,
––C D
$str
––E S
)
––S T
.
––T U
DisplayValue
––U a
;
––a b
campaign
—— 
.
—— !
SpecialInstructions
—— (
=
——) *
sheetMap
——+ 3
.
——3 4!
GetCellByColumnName
——4 G
(
——G H
row
——H K
,
——K L
$str
——M n
)
——n o
.
——o p
DisplayValue
——p |
;
——| }
campaign
““ 
.
““ 
Assets
““ 
=
““ 
new
““ !
CampaignAsset
““" /
(
““/ 0
)
““0 1
;
““1 2
campaign
‘‘ 
.
‘‘ 
Assets
‘‘ 
.
‘‘ 
Id
‘‘ 
=
‘‘  
Guid
‘‘! %
.
‘‘% &
NewGuid
‘‘& -
(
‘‘- .
)
‘‘. /
;
‘‘/ 0
campaign
’’ 
.
’’ 
Assets
’’ 
.
’’ 

CampaignId
’’ &
=
’’' (
campaign
’’) 1
.
’’1 2
Id
’’2 4
;
’’4 5
campaign
÷÷ 
.
÷÷ 
Assets
÷÷ 
.
÷÷ 
	CreatedAt
÷÷ %
=
÷÷& '
DateTime
÷÷( 0
.
÷÷0 1
Now
÷÷1 4
;
÷÷4 5
campaign
◊◊ 
.
◊◊ 
Assets
◊◊ 
.
◊◊ 
	CreatedBy
◊◊ %
=
◊◊& '
$str
◊◊( 4
;
◊◊4 5
return
ŸŸ 
campaign
ŸŸ 
;
ŸŸ 
}
⁄⁄ 	
public
‹‹ 
bool
‹‹ 
Update
‹‹ 
(
‹‹ 
string
‹‹ !
	sheetName
‹‹" +
,
‹‹+ ,
long
‹‹- 1
rowId
‹‹2 7
,
‹‹7 8
string
‹‹9 ?
IONumber
‹‹@ H
)
‹‹H I
{
›› 	
var
ﬁﬁ 
sheetMap
ﬁﬁ 
=
ﬁﬁ 
	sheetMaps
ﬁﬁ $
[
ﬁﬁ$ %
	sheetName
ﬁﬁ% .
]
ﬁﬁ. /
;
ﬁﬁ/ 0
var
‡‡ 
rowToUpdate
‡‡ 
=
‡‡ 
sheetMap
‡‡ &
.
‡‡& '

GetRowById
‡‡' 1
(
‡‡1 2
rowId
‡‡2 7
)
‡‡7 8
;
‡‡8 9
if
·· 
(
·· 
rowToUpdate
·· 
==
·· 
null
·· #
)
··# $
return
··% +
false
··, 1
;
··1 2
Cell
„„ 
[
„„ 
]
„„ 
cellsToUpdate
„„  
=
„„! "
null
„„# '
;
„„' (
switch
ÂÂ 
(
ÂÂ 
	sheetName
ÂÂ 
)
ÂÂ 
{
ÊÊ 
case
ÁÁ 
$str
ÁÁ  
:
ÁÁ  !
cellsToUpdate
ËË !
=
ËË" #
new
ËË$ '
Cell
ËË( ,
[
ËË, -
]
ËË- .
{
ËË/ 0
new
ÈÈ 
Cell
ÈÈ  $
.
ÈÈ$ %
UpdateCellBuilder
ÈÈ% 6
(
ÈÈ6 7
sheetMap
ÈÈ7 ?
.
ÈÈ? @
	ColumnMap
ÈÈ@ I
[
ÈÈI J
$str
ÈÈJ Y
]
ÈÈY Z
,
ÈÈZ [
IONumber
ÈÈ[ c
)
ÈÈc d
.
ÈÈd e
Build
ÈÈe j
(
ÈÈj k
)
ÈÈk l
,
ÈÈl m
new
ÍÍ 
Cell
ÍÍ  $
.
ÍÍ$ %
UpdateCellBuilder
ÍÍ% 6
(
ÍÍ6 7
sheetMap
ÍÍ7 ?
.
ÍÍ? @
	ColumnMap
ÍÍ@ I
[
ÍÍI J
$str
ÍÍJ W
]
ÍÍW X
,
ÍÍX Y
$str
ÍÍY ^
)
ÍÍ^ _
.
ÍÍ_ `
Build
ÍÍ` e
(
ÍÍe f
)
ÍÍf g
,
ÍÍg h
}
ÎÎ 
;
ÎÎ 
break
ÏÏ 
;
ÏÏ 
case
ÌÌ 
$str
ÌÌ *
:
ÌÌ* +
cellsToUpdate
ÓÓ !
=
ÓÓ" #
new
ÓÓ$ '
Cell
ÓÓ( ,
[
ÓÓ, -
]
ÓÓ- .
{
ÓÓ/ 0
new
ÔÔ 
Cell
ÔÔ  $
.
ÔÔ$ %
UpdateCellBuilder
ÔÔ% 6
(
ÔÔ6 7
sheetMap
ÔÔ7 ?
.
ÔÔ? @
	ColumnMap
ÔÔ@ I
[
ÔÔI J
$str
ÔÔJ O
]
ÔÔO P
,
ÔÔP Q
IONumber
ÔÔQ Y
)
ÔÔY Z
.
ÔÔZ [
Build
ÔÔ[ `
(
ÔÔ` a
)
ÔÔa b
,
ÔÔb c
new
 
Cell
  $
.
$ %
UpdateCellBuilder
% 6
(
6 7
sheetMap
7 ?
.
? @
	ColumnMap
@ I
[
I J
$str
J Y
]
Y Z
,
Z [
$str
[ `
)
` a
.
a b
Build
b g
(
g h
)
h i
,
i j
}
ÒÒ 
;
ÒÒ 
break
ÚÚ 
;
ÚÚ 
case
ÛÛ 
$str
ÛÛ *
:
ÛÛ* +
cellsToUpdate
ÙÙ !
=
ÙÙ" #
new
ÙÙ$ '
Cell
ÙÙ( ,
[
ÙÙ, -
]
ÙÙ- .
{
ÙÙ/ 0
new
ıı 
Cell
ıı  $
.
ıı$ %
UpdateCellBuilder
ıı% 6
(
ıı6 7
sheetMap
ıı7 ?
.
ıı? @
	ColumnMap
ıı@ I
[
ııI J
$str
ııJ T
]
ııT U
,
ııU V
IONumber
ııV ^
)
ıı^ _
.
ıı_ `
Build
ıı` e
(
ııe f
)
ııf g
,
ııg h
new
ˆˆ 
Cell
ˆˆ  $
.
ˆˆ$ %
UpdateCellBuilder
ˆˆ% 6
(
ˆˆ6 7
sheetMap
ˆˆ7 ?
.
ˆˆ? @
	ColumnMap
ˆˆ@ I
[
ˆˆI J
$str
ˆˆJ Y
]
ˆˆY Z
,
ˆˆZ [
$str
ˆˆ[ `
)
ˆˆ` a
.
ˆˆa b
Build
ˆˆb g
(
ˆˆg h
)
ˆˆh i
,
ˆˆi j
}
˜˜ 
;
˜˜ 
break
¯¯ 
;
¯¯ 
}
˘˘ 
Row
˚˚ 
rowBeingUpdated
˚˚ 
=
˚˚  !
new
˚˚" %
Row
˚˚& )
.
˚˚) *
UpdateRowBuilder
˚˚* :
(
˚˚: ;
rowToUpdate
˚˚; F
.
˚˚F G
Id
˚˚G I
)
˚˚I J
.
˚˚J K
SetCells
˚˚K S
(
˚˚S T
cellsToUpdate
˚˚T a
)
˚˚a b
.
˚˚b c
Build
˚˚c h
(
˚˚h i
)
˚˚i j
;
˚˚j k
IList
¸¸ 
<
¸¸ 
Row
¸¸ 
>
¸¸ 
updatedRows
¸¸ "
=
¸¸# $
	GetClient
¸¸% .
(
¸¸. /
)
¸¸/ 0
.
¸¸0 1
SheetResources
¸¸1 ?
.
¸¸? @
RowResources
¸¸@ L
.
˝˝0 1

UpdateRows
˝˝1 ;
(
˝˝; <
sheetMap
˝˝< D
.
˝˝D E
Sheet
˝˝E J
.
˝˝J K
Id
˝˝K M
.
˝˝M N
Value
˝˝N S
,
˝˝S T
new
˝˝T W
Row
˝˝X [
[
˝˝[ \
]
˝˝\ ]
{
˝˝^ _
rowBeingUpdated
˝˝` o
}
˝˝p q
)
˝˝q r
;
˝˝r s
return
˛˛ 
updatedRows
˛˛ 
.
˛˛ 
Count
˛˛ $
>
˛˛% &
$num
˛˛' (
;
˛˛( )
}
ˇˇ 	
}
ÄÄ 
}ÅÅ 