á
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Hangfire\HangfireBootstrapper .cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Hangfire 
{ 
public 

class  
HangfireBootstrapper %
:& '
IRegisteredObject( 9
{ 
public 
static 
readonly  
HangfireBootstrapper 3
Instance4 <
== >
new? B 
HangfireBootstrapperC W
(W X
)X Y
;Y Z
private

 
readonly

 
object

 
_lockObject

  +
=

, -
new

. 1
object

2 8
(

8 9
)

9 :
;

: ;
private 
bool 
_started 
; 
private 
BackgroundJobServer # 
_backgroundJobServer$ 8
;8 9
private  
HangfireBootstrapper $
($ %
)% &
{ 	
} 	
public 
void 
Start 
( 
) 
{ 	
lock 
( 
_lockObject 
) 
{ 
if 
( 
_started 
) 
return $
;$ %
_started 
= 
true 
;  
HostingEnvironment "
." #
RegisterObject# 1
(1 2
this2 6
)6 7
;7 8
GlobalConfiguration #
.# $
Configuration$ 1
.1 2
UseSqlServerStorage2 E
(E F
$strF U
)U V
;V W 
_backgroundJobServer $
=% &
new' *
BackgroundJobServer+ >
(> ?
)? @
;@ A
}   
}!! 	
public## 
void## 
Stop## 
(## 
)## 
{$$ 	
lock%% 
(%% 
_lockObject%% 
)%% 
{&&  
_backgroundJobServer'' $
?''$ %
.''% &
Dispose''& -
(''- .
)''. /
;''/ 0
HostingEnvironment)) "
.))" #
UnregisterObject))# 3
())3 4
this))4 8
)))8 9
;))9 :
}** 
}++ 	
void-- 
IRegisteredObject-- 
.-- 
Stop-- #
(--# $
bool--$ (
	immediate--) 2
)--2 3
{.. 	
Stop// 
(// 
)// 
;// 
}00 	
}11 
}22 »
HE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Hangfire\ApplicationPreload.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Hangfire 
{ 
public 

class 
ApplicationPreload #
:$ %
System& ,
., -
Web- 0
.0 1
Hosting1 8
.8 9%
IProcessHostPreloadClient9 R
{ 
public 
void 
Preload 
( 
string "
[" #
]# $

parameters% /
)/ 0
{ 	 
HangfireBootstrapper  
.  !
Instance! )
.) *
Start* /
(/ 0
)0 1
;1 2
} 	
}		 
}

 €
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\BundleConfig.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

class 
BundleConfig 
{ 
public 
static 
void 
RegisterBundles *
(* +
BundleCollection+ ;
bundles< C
)C D
{		 	
bundles 
. 
Add 
( 
new 
StyleBundle '
(' (
$str( 5
)5 6
.6 7
Include7 >
(> ?
$str "
," #
$str "
," #
$str   ,
,  , -
$str!! )
,!!) *
$str"" !
,""! "
$str## (
,##( )
$str$$ %
,$$% &
$str%% +
,%%+ ,
$str&& $
,&&$ %
$str'' %
,''% &
$str(( &
,((& '
$str)) 
,))  
$str** "
,**" #
$str++ #
,++# $
$str,, /
,,,/ 0
$str-- &
,--& '
$str.. &
,..& '
$str// 8
)00 
)00 
;00 
bundles22 
.22 
Add22 
(22 
new22 
ScriptBundle22 (
(22( )
$str22) 5
)225 6
.226 7
Include227 >
(22> ?
$str44 +
,44+ ,
$str55 '
,55' (
$str66 '
,66' (
$str77 (
,77( )
$str88 $
,88$ %
$str99 *
,99* +
$str::  
,::  !
$str;; '
,;;' (
$str== %
,==% &
$str>> )
,>>) *
$str?? )
,??) *
$str@@ 
,@@ 
$strAA 
,AA 
$strBB 6
,BB6 7
$strCC +
,CC+ ,
$strDD .
,DD. /
$strEE *
,EE* +
$strFF )
,FF) *
$strGG "
,GG" #
$strHH 7
)II 
)II 
;II 
bundlesKK 
.KK 
AddKK 
(KK 
newKK 
ScriptBundleKK (
(KK( )
$strKK) ;
)KK; <
.KK< =
IncludeKK= D
(KKD E
$strLL #
,LL# $
$strMM &
)NN 
)NN 
;NN 
BundleTablePP 
.PP 
EnableOptimizationsPP +
=PP, -
falsePP. 3
;PP3 4
}QQ 	
}RR 
}SS ©
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\FilterConfig.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

class 
FilterConfig 
{ 
public 
static 
void !
RegisterGlobalFilters 0
(0 1"
GlobalFilterCollection1 G
filtersH O
)O P
{ 	
filters		 
.		 
Add		 
(		 
new		  
HandleErrorAttribute		 0
(		0 1
)		1 2
)		2 3
;		3 4
}

 	
} 
} †S
EE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\IdentityConfig.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

class 
EmailService 
: #
IIdentityMessageService  7
{ 
public 
Task 
	SendAsync 
( 
IdentityMessage -
message. 5
)5 6
{ 	
return 
Task 
. 

FromResult "
(" #
$num# $
)$ %
;% &
} 	
} 
public 

class 

SmsService 
: #
IIdentityMessageService 5
{ 
public 
Task 
	SendAsync 
( 
IdentityMessage -
message. 5
)5 6
{ 	
return 
Task 
. 

FromResult "
(" #
$num# $
)$ %
;% &
} 	
} 
public   

class   "
ApplicationUserManager   '
:  ( )
UserManager  * 5
<  5 6
WfpUser  6 =
>  = >
{!! 
public"" "
ApplicationUserManager"" %
(""% &

IUserStore""& 0
<""0 1
WfpUser""1 8
>""8 9
store"": ?
)""? @
:""A B
base""C G
(""G H
store""H M
)""M N
{## 	
}$$ 	
public&& 
static&& "
ApplicationUserManager&& ,
Create&&- 3
(&&3 4"
IdentityFactoryOptions&&4 J
<&&J K"
ApplicationUserManager&&K a
>&&a b
options&&c j
,&&j k
IOwinContext&&l x
context	&&y Ä
)
&&Ä Å
{'' 	
var(( 
manager(( 
=(( 
new(( "
ApplicationUserManager(( 4
(((4 5
new((5 8
	UserStore((9 B
<((B C
WfpUser((C J
>((J K
(((K L
context((L S
.((S T
Get((T W
<((W X
WfpictContext((X e
>((e f
(((f g
)((g h
)((h i
)((i j
;((j k
manager** 
.** 
UserValidator** !
=**" #
new**$ '
UserValidator**( 5
<**5 6
WfpUser**6 =
>**= >
(**> ?
manager**? F
)**F G
{++ *
AllowOnlyAlphanumericUserNames,, .
=,,/ 0
false,,1 6
,,,6 7
RequireUniqueEmail-- "
=--# $
true--% )
}.. 
;.. 
manager11 
.11 
PasswordValidator11 %
=11& '
new11( +
PasswordValidator11, =
{22 
}88 
;88 
manager;; 
.;; '
UserLockoutEnabledByDefault;; /
=;;0 1
true;;2 6
;;;6 7
manager<< 
.<< )
DefaultAccountLockoutTimeSpan<< 1
=<<2 3
TimeSpan<<4 <
.<<< =
FromMinutes<<= H
(<<H I
$num<<I J
)<<J K
;<<K L
manager== 
.== 0
$MaxFailedAccessAttemptsBeforeLockout== 8
===9 :
$num==; <
;==< =
managerAA 
.AA %
RegisterTwoFactorProviderAA -
(AA- .
$strAA. :
,AA: ;
newAA< ?$
PhoneNumberTokenProviderAA@ X
<AAX Y
WfpUserAAY `
>AA` a
{BB 
MessageFormatCC 
=CC 
$strCC  ;
}DD 
)DD 
;DD 
managerEE 
.EE %
RegisterTwoFactorProviderEE -
(EE- .
$strEE. :
,EE: ;
newEE< ?
EmailTokenProviderEE@ R
<EER S
WfpUserEES Z
>EEZ [
{FF 
SubjectGG 
=GG 
$strGG )
,GG) *

BodyFormatHH 
=HH 
$strHH 8
}II 
)II 
;II 
managerJJ 
.JJ 
EmailServiceJJ  
=JJ! "
newJJ# &
EmailServiceJJ' 3
(JJ3 4
)JJ4 5
;JJ5 6
managerKK 
.KK 

SmsServiceKK 
=KK  
newKK! $

SmsServiceKK% /
(KK/ 0
)KK0 1
;KK1 2
varLL "
dataProtectionProviderLL &
=LL' (
optionsLL) 0
.LL0 1"
DataProtectionProviderLL1 G
;LLG H
ifMM 
(MM "
dataProtectionProviderMM &
!=MM' )
nullMM* .
)MM. /
{NN 
managerOO 
.OO 
UserTokenProviderOO )
=OO* +
newPP &
DataProtectorTokenProviderPP 2
<PP2 3
WfpUserPP3 :
>PP: ;
(PP; <"
dataProtectionProviderPP< R
.PPR S
CreatePPS Y
(PPY Z
$strPPZ l
)PPl m
)PPm n
;PPn o
}QQ 
returnRR 
managerRR 
;RR 
}SS 	
}TT 
publicVV 

classVV "
ApplicationRoleManagerVV '
:VV( )
RoleManagerVV* 5
<VV5 6
WfpRoleVV6 =
>VV= >
{WW 
publicXX "
ApplicationRoleManagerXX %
(XX% &

IRoleStoreXX& 0
<XX0 1
WfpRoleXX1 8
,XX8 9
stringXX: @
>XX@ A
	roleStoreXXB K
)XXK L
:XXL M
baseXXN R
(XXR S
	roleStoreXXS \
)XX\ ]
{YY 	
}ZZ 	
public\\ 
static\\ "
ApplicationRoleManager\\ ,
Create\\- 3
(\\3 4"
IdentityFactoryOptions\\4 J
<\\J K"
ApplicationRoleManager\\K a
>\\a b
options\\c j
,\\j k
IOwinContext\\l x
context	\\y Ä
)
\\Ä Å
{]] 	
return^^ 
new^^ "
ApplicationRoleManager^^ -
(^^- .
new^^. 1
	RoleStore^^2 ;
<^^; <
WfpRole^^< C
>^^C D
(^^D E
context^^E L
.^^L M
Get^^M P
<^^P Q
WfpictContext^^Q ^
>^^^ _
(^^_ `
)^^` a
)^^a b
)^^b c
;^^c d
}__ 	
publicaa 
voidaa 
AddClaimaa 
(aa 
WfpictContextaa *
ctxaa+ .
,aa. /
stringaa0 6
roleIdaa7 =
,aa= >
Guidaa? C
claimIDaaD K
)aaK L
{bb 	
ctxcc 
.cc 

RoleClaimscc 
.cc 
Addcc 
(cc 
newcc "
AspNetRoleClaimscc# 3
(cc3 4
)cc4 5
{dd 
Idee 
=ee 
Guidee 
.ee 
NewGuidee !
(ee! "
)ee" #
,ee# $
RoleIDff 
=ff 
roleIdff 
,ff  
ClaimIDgg 
=gg 
claimIDgg !
,gg! "
	CreatedAthh 
=hh 
DateTimehh $
.hh$ %
Nowhh% (
}ii 
)ii 
;ii 
ctxjj 
.jj 
SaveChangesjj 
(jj 
)jj 
;jj 
}kk 	
}ll 
publicoo 

classoo $
ApplicationSignInManageroo )
:oo* +
SignInManageroo, 9
<oo9 :
WfpUseroo: A
,ooA B
stringooC I
>ooI J
{pp 
publicqq $
ApplicationSignInManagerqq '
(qq' ("
ApplicationUserManagerqq( >
userManagerqq? J
,qqJ K"
IAuthenticationManagerqqL b!
authenticationManagerqqc x
)qqx y
:rr 
baserr 
(rr 
userManagerrr 
,rr !
authenticationManagerrr  5
)rr5 6
{ss 	
}tt 	
publicvv 
overridevv 
Taskvv 
<vv 
ClaimsIdentityvv +
>vv+ ,#
CreateUserIdentityAsyncvv- D
(vvD E
WfpUservvE L
uservvM Q
)vvQ R
{ww 	
returnxx 
userxx 
.xx %
GenerateUserIdentityAsyncxx 1
(xx1 2
(xx2 3"
ApplicationUserManagerxx3 I
)xxI J
UserManagerxxJ U
)xxU V
;xxV W
}yy 	
public{{ 
static{{ $
ApplicationSignInManager{{ .
Create{{/ 5
({{5 6"
IdentityFactoryOptions{{6 L
<{{L M$
ApplicationSignInManager{{M e
>{{e f
options{{g n
,{{n o
IOwinContext{{p |
context	{{} Ñ
)
{{Ñ Ö
{|| 	
return}} 
new}} $
ApplicationSignInManager}} /
(}}/ 0
context}}0 7
.}}7 8
GetUserManager}}8 F
<}}F G"
ApplicationUserManager}}G ]
>}}] ^
(}}^ _
)}}_ `
,}}` a
context}}b i
.}}i j
Authentication}}j x
)}}x y
;}}y z
}~~ 	
public
ÄÄ 
override
ÄÄ 
Task
ÄÄ 
SignInAsync
ÄÄ (
(
ÄÄ( )
WfpUser
ÄÄ) 0
user
ÄÄ1 5
,
ÄÄ5 6
bool
ÄÄ7 ;
isPersistent
ÄÄ< H
,
ÄÄH I
bool
ÄÄJ N
rememberBrowser
ÄÄO ^
)
ÄÄ^ _
{
ÅÅ 	
return
ÇÇ 
base
ÇÇ 
.
ÇÇ 
SignInAsync
ÇÇ #
(
ÇÇ# $
user
ÇÇ$ (
,
ÇÇ( )
isPersistent
ÇÇ* 6
,
ÇÇ6 7
rememberBrowser
ÇÇ8 G
)
ÇÇG H
;
ÇÇH I
}
ÉÉ 	
public
ÖÖ 
override
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
SignInStatus
ÖÖ )
>
ÖÖ) *"
TwoFactorSignInAsync
ÖÖ+ ?
(
ÖÖ? @
string
ÖÖ@ F
provider
ÖÖG O
,
ÖÖO P
string
ÖÖQ W
code
ÖÖX \
,
ÖÖ\ ]
bool
ÖÖ^ b
isPersistent
ÖÖc o
,
ÖÖo p
bool
ÖÖq u
rememberBrowserÖÖv Ö
)ÖÖÖ Ü
{
ÜÜ 	
return
áá 
base
áá 
.
áá "
TwoFactorSignInAsync
áá ,
(
áá, -
provider
áá- 5
,
áá5 6
code
áá7 ;
,
áá; <
isPersistent
áá= I
,
ááI J
rememberBrowser
ááK Z
)
ááZ [
;
áá[ \
}
àà 	
}
ªª 
}ºº á	
BE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\RouteConfig.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

class 
RouteConfig 
{ 
public		 
static		 
void		 
RegisterRoutes		 )
(		) *
RouteCollection		* 9
routes		: @
)		@ A
{

 	
routes 
. 
IgnoreRoute 
( 
$str ;
); <
;< =
routes 
. 
MapRoute 
( 
name 
: 
$str 
,  
url 
: 
$str 1
,1 2
defaults 
: 
new 
{ 

controller  *
=+ ,
$str- 8
,8 9
action: @
=A B
$strC J
,J K
idL N
=O P
UrlParameterQ ]
.] ^
Optional^ f
}g h
) 
; 
} 	
} 
} Ñ
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\Startup.Auth.cs
	namespace		 	
WFP		
 
.		 
ICT		 
.		 
Web		 
{

 
public 

partial 
class 
Startup  
{ 
public 
void 
ConfigureAuth !
(! "
IAppBuilder" -
app. 1
)1 2
{ 	
app 
.  
CreatePerOwinContext $
($ %
WfpictContext% 2
.2 3
Create3 9
)9 :
;: ;
app 
.  
CreatePerOwinContext $
<$ %"
ApplicationUserManager% ;
>; <
(< ="
ApplicationUserManager= S
.S T
CreateT Z
)Z [
;[ \
app 
.  
CreatePerOwinContext $
<$ %"
ApplicationRoleManager% ;
>; <
(< ="
ApplicationRoleManager= S
.S T
CreateT Z
)Z [
;[ \
app 
.  
CreatePerOwinContext $
<$ %$
ApplicationSignInManager% =
>= >
(> ?$
ApplicationSignInManager? W
.W X
CreateX ^
)^ _
;_ `
app 
. #
UseCookieAuthentication '
(' (
new( +'
CookieAuthenticationOptions, G
{ 
AuthenticationType "
=# $&
DefaultAuthenticationTypes% ?
.? @
ApplicationCookie@ Q
,Q R
	LoginPath 
= 
new 

PathString  *
(* +
$str+ ;
); <
,< =
Provider 
= 
new (
CookieAuthenticationProvider ;
{ 
OnValidateIdentity!! &
=!!' ("
SecurityStampValidator!!) ?
.!!? @
OnValidateIdentity!!@ R
<!!R S"
ApplicationUserManager!!S i
,!!i j
WfpUser!!k r
>!!r s
(!!s t
validateInterval"" (
:""( )
TimeSpan""* 2
.""2 3
FromMinutes""3 >
(""> ?
$num""? A
)""A B
,""B C
regenerateIdentity## *
:##* +
(##, -
manager##- 4
,##4 5
user##6 :
)##: ;
=>##< >
user##? C
.##C D%
GenerateUserIdentityAsync##D ]
(##] ^
manager##^ e
)##e f
)##f g
}$$ 
}%% 
)%% 
;%% 
app&& 
.&& #
UseExternalSignInCookie&& '
(&&' (&
DefaultAuthenticationTypes&&( B
.&&B C
ExternalCookie&&C Q
)&&Q R
;&&R S
app)) 
.)) $
UseTwoFactorSignInCookie)) (
())( )&
DefaultAuthenticationTypes))) C
.))C D
TwoFactorCookie))D S
,))S T
TimeSpan))U ]
.))] ^
FromMinutes))^ i
())i j
$num))j k
)))k l
)))l m
;))m n
app.. 
... -
!UseTwoFactorRememberBrowserCookie.. 1
(..1 2&
DefaultAuthenticationTypes..2 L
...L M*
TwoFactorRememberBrowserCookie..M k
)..k l
;..l m
}BB 	
}CC 
}DD ≥
BE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\UnityConfig.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public

 

class

 
UnityConfig

 
{ 
private 
static 
Lazy 
< 
IUnityContainer +
>+ ,
	container- 6
=7 8
new9 <
Lazy= A
<A B
IUnityContainerB Q
>Q R
(R S
(S T
)T U
=>V X
{ 	
var 
	container 
= 
new 
UnityContainer  .
(. /
)/ 0
;0 1
RegisterTypes 
( 
	container #
)# $
;$ %
return 
	container 
; 
} 	
)	 

;
 
public 
static 
IUnityContainer %"
GetConfiguredContainer& <
(< =
)= >
{ 	
return 
	container 
. 
Value "
;" #
} 	
public!! 
static!! 
void!! 
RegisterTypes!! (
(!!( )
IUnityContainer!!) 8
	container!!9 B
)!!B C
{"" 	
	container)) 
.)) 
RegisterType)) "
<))" #
Controllers))# .
.)). /
AccountController))/ @
>))@ A
())A B
new))B E 
InjectionConstructor))F Z
())Z [
)))[ \
)))\ ]
;))] ^
	container++ 
.++ 
RegisterType++ "
<++" #
System++# )
.++) *
Data++* .
.++. /
Entity++/ 5
.++5 6
	DbContext++6 ?
,++? @
WfpictContext++A N
>++N O
(++O P
new++P S'
HierarchicalLifetimeManager++T o
(++o p
)++p q
)++q r
;++r s
},, 	
}-- 
}.. Î
HE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\UnityMvcActivator.cs
[ 
assembly 	
:	 

WebActivatorEx 
. %
PreApplicationStartMethod 3
(3 4
typeof4 :
(: ;
UnityWebActivator; L
)L M
,M N
$strO V
)V W
]W X
[ 
assembly 	
:	 

WebActivatorEx 
. %
ApplicationShutdownMethod 3
(3 4
typeof4 :
(: ;
UnityWebActivator; L
)L M
,M N
$strO Y
)Y Z
]Z [
	namespace		 	
WFP		
 
.		 
ICT		 
.		 
Web		 
{

 
public 

static 
class 
UnityWebActivator )
{ 
public 
static 
void 
Start  
(  !
)! "
{ 	
var 
	container 
= 
UnityConfig '
.' ("
GetConfiguredContainer( >
(> ?
)? @
;@ A
FilterProviders 
. 
	Providers %
.% &
Remove& ,
(, -
FilterProviders- <
.< =
	Providers= F
.F G
OfTypeG M
<M N)
FilterAttributeFilterProviderN k
>k l
(l m
)m n
.n o
Firsto t
(t u
)u v
)v w
;w x
FilterProviders 
. 
	Providers %
.% &
Add& )
() *
new* -.
"UnityFilterAttributeFilterProvider. P
(P Q
	containerQ Z
)Z [
)[ \
;\ ]
DependencyResolver 
. 
SetResolver *
(* +
new+ .#
UnityDependencyResolver/ F
(F G
	containerG P
)P Q
)Q R
;R S
} 	
public 
static 
void 
Shutdown #
(# $
)$ %
{ 	
var 
	container 
= 
UnityConfig '
.' ("
GetConfiguredContainer( >
(> ?
)? @
;@ A
	container   
.   
Dispose   
(   
)   
;    
}!! 	
}"" 
}## ˘
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\App_Start\WebApiConfig.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

static 
class 
WebApiConfig $
{		 
public

 
static

 
void

 
Register

 #
(

# $
HttpConfiguration

$ 5
config

6 <
)

< =
{ 	
config 
. "
MapHttpAttributeRoutes )
() *
)* +
;+ ,
config 
. 
Routes 
. 
MapHttpRoute &
(& '
name 
: 
$str "
," #
routeTemplate 
: 
$str 6
,6 7
defaults 
: 
new 
{ 
id  "
=# $
RouteParameter% 3
.3 4
Optional4 <
}= >
) 
; 
var 
jsonFormatter 
= 
config  &
.& '

Formatters' 1
.1 2
OfType2 8
<8 9"
JsonMediaTypeFormatter9 O
>O P
(P Q
)Q R
.R S
FirstS X
(X Y
)Y Z
;Z [
jsonFormatter 
. 
SerializerSettings ,
., -
ContractResolver- =
=> ?
new@ C2
&CamelCasePropertyNamesContractResolverD j
(j k
)k l
;l m
} 	
} 
} ï]
JE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\CompanyController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
public 

class 
CompanyController "
:# $
BaseController% 3
{ 
private 
const 
int 
PageSize "
=# $
$num% '
;' (
private "
ApplicationUserManager &
_userManager' 3
;3 4
private "
ApplicationUserManager &
UserManager' 2
{ 	
get 
{ 
return 
_userManager #
??$ &
HttpContext' 2
.2 3
GetOwinContext3 A
(A B
)B C
.C D
GetUserManagerD R
<R S"
ApplicationUserManagerS i
>i j
(j k
)k l
;l m
} 
} 	
public 
ActionResult 
Users !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
var 
model 
= 
UserManager #
.# $
Users$ )
.) *
Select* 0
(0 1
x1 2
=>3 5
new   
UserProfileVM   
(   
)   
{!! 
Id"" 
="" 
x"" 
."" 
Id"" 
,"" 
UserName## 
=## 
x## 
.## 
UserName## %
,##% &
Email$$ 
=$$ 
x$$ 
.$$ 
Email$$ 
,$$  
DateCreated%% 
=%% 
x%% 
.%%  
	CreatedAt%%  )
.%%) *
ToString%%* 2
(%%2 3
)%%3 4
,%%4 5
Status&& 
=&& 
x&& 
.&& 
Status&& !
,&&! "
Type'' 
='' 
x'' 
.'' 
UserType'' !
,''! "
	FirstName(( 
=(( 
x(( 
.(( 
	FirstName(( '
,((' (
LastName)) 
=)) 
x)) 
.)) 
LastName)) %
,))% &
CompanyName** 
=** 
x** 
.**  
CompanyName**  +
,**+ ,
CompanyLogo++ 
=++ 
x++ 
.++  
CompanyLogo++  +
,+++ ,

WhiteLabel,, 
=,, 
x,, 
.,, 

WhiteLabel,, )
,,,) *
ReportTemplate-- 
=--  
x--! "
.--" #
ReportTemplate--# 1
,--1 2
IsTestsCreatives..  
=..! "
x..# $
...$ %
IsTestsCreatives..% 5
,..5 6
	IsUsesApi// 
=// 
x// 
.// 
	IsUsesApi// '
}00 
)00 
.00 
ToList00 
(00 
)00 
;00 
int22 

pageNumber22 
=22 
(22 
sc22  
.22  !
page22! %
??22& (
$num22) *
)22* +
;22+ ,
var33 
Model33 
=33 
model33 
.33 
ToPagedList33 )
(33) *

pageNumber33* 4
,334 5
PageSize336 >
)33> ?
;33? @
ViewBag44 
.44 

WhiteLabel44 
=44  
CustomersList44! .
;44. /
return55 
View55 
(55 
$str55 
,55  
Model55! &
)55& '
;55' (
}66 	
public88 
ActionResult88 
ChangeWhiteLabel88 ,
(88, -
Guid88- 1
?881 2
userId883 9
,889 :
string88; A

whiteLabel88B L
)88L M
{99 	
try:: 
{;; 
var<< 
user<< 
=<< 
UserManager<< &
.<<& '
FindById<<' /
(<</ 0
userId<<0 6
.<<6 7
ToString<<7 ?
(<<? @
)<<@ A
)<<A B
;<<B C
user== 
.== 

WhiteLabel== 
===  !

whiteLabel==" ,
;==, -
Db>> 
.>> 
SaveChanges>> 
(>> 
)>>  
;>>  !
return?? 
Json?? 
(?? 
new?? 
JsonResponse??  ,
(??, -
)??- .
{??/ 0
IsSucess??1 9
=??: ;
true??< @
}??A B
,??B C
JsonRequestBehavior??D W
.??W X
AllowGet??X `
)??` a
;??a b
}@@ 
catchAA 
(AA 
	ExceptionAA 
exAA 
)AA  
{BB 
returnCC 
JsonCC 
(CC 
newCC 
JsonResponseCC  ,
(CC, -
)CC- .
{CC/ 0
IsSucessCC1 9
=CC: ;
falseCC< A
,CCA B
ErrorMessageCCC O
=CCP Q
exCCR T
.CCT U
MessageCCU \
}CC] ^
,CC^ _
JsonRequestBehaviorCC` s
.CCs t
AllowGetCCt |
)CC| }
;CC} ~
}DD 
}EE 	
publicFF 
ActionResultFF 
SaveUserFF $
(FF$ %
CompanyUsersVMFF% 3
modelFF4 9
)FF9 :
{GG 	
tryHH 
{II 
varJJ 
userJJ 
=JJ 
UserManagerJJ &
.JJ& '
FindByIdJJ' /
(JJ/ 0
modelJJ0 5
.JJ5 6
IDJJ6 8
.JJ8 9
ToStringJJ9 A
(JJA B
)JJB C
)JJC D
;JJD E
switchKK 
(KK 
modelKK 
.KK 
ActionKK $
)KK$ %
{LL 
caseMM 
$strMM 
:MM  
ifNN 
(NN 
userNN  
.NN  !
StatusNN! '
==NN( *
(NN+ ,
intNN, /
)NN/ 0

UserStatusNN0 :
.NN: ;
ActiveNN; A
)NNA B
{OO 
userPP  
.PP  !
StatusPP! '
=PP( )
(PP* +
intPP+ .
)PP. /

UserStatusPP/ 9
.PP9 :
LockedPP: @
;PP@ A
userQQ  
.QQ  !
LockoutEndDateUtcQQ! 2
=QQ3 4
newQQ5 8
DateTimeQQ9 A
(QQA B
$numQQB F
,QQF G
$numQQH J
,QQJ K
$numQQL N
)QQN O
;QQO P
boolRR  
aRR! "
=RR# $
UserManagerRR% 0
.RR0 1
IsLockedOutRR1 <
(RR< =
userRR= A
.RRA B
IdRRB D
)RRD E
;RRE F
}SS 
elseTT 
ifTT 
(TT  !
userTT! %
.TT% &
StatusTT& ,
==TT- /
(TT0 1
intTT1 4
)TT4 5

UserStatusTT5 ?
.TT? @
LockedTT@ F
)TTF G
{UU 
userVV  
.VV  !
StatusVV! '
=VV( )
(VV* +
intVV+ .
)VV. /

UserStatusVV/ 9
.VV9 :
ActiveVV: @
;VV@ A
userWW  
.WW  !
LockoutEndDateUtcWW! 2
=WW3 4
nullWW5 9
;WW9 :
boolXX  
aXX! "
=XX# $
UserManagerXX% 0
.XX0 1
IsLockedOutXX1 <
(XX< =
userXX= A
.XXA B
IdXXB D
)XXD E
;XXE F
}YY 
breakZZ 
;ZZ 
case[[ 
$str[[ 
:[[  
if\\ 
(\\ 
user\\  
.\\  !
UserType\\! )
==\\* ,
(\\- .
int\\. 1
)\\1 2
UserType\\2 :
.\\: ;
Admin\\; @
)\\@ A
{]] 
user^^  
.^^  !
UserType^^! )
=^^* +
(^^, -
int^^- 0
)^^0 1
UserType^^1 9
.^^9 :
User^^: >
;^^> ?
}__ 
else`` 
if`` 
(``  !
user``! %
.``% &
UserType``& .
==``/ 1
(``2 3
int``3 6
)``6 7
UserType``7 ?
.``? @
User``@ D
)``D E
{aa 
userbb  
.bb  !
UserTypebb! )
=bb* +
(bb, -
intbb- 0
)bb0 1
UserTypebb1 9
.bb9 :
Adminbb: ?
;bb? @
}cc 
breakdd 
;dd 
caseee 
$stree  
:ee  !
ifff 
(ff 
userff  
.ff  !
IsTestsCreativesff! 1
)ff1 2
{gg 
userhh  
.hh  !
IsTestsCreativeshh! 1
=hh2 3
falsehh4 9
;hh9 :
}ii 
elsejj 
{kk 
userll  
.ll  !
IsTestsCreativesll! 1
=ll2 3
truell4 8
;ll8 9
}mm 
breaknn 
;nn 
caseoo 
$stroo #
:oo# $
ifpp 
(pp 
!pp 
stringpp #
.pp# $
IsNullOrEmptypp$ 1
(pp1 2
modelpp2 7
.pp7 8
Passwordpp8 @
)pp@ A
)ppA B
{qq 
stringrr "

resetTokenrr# -
=rr. /
UserManagerrr0 ;
.rr; <&
GeneratePasswordResetTokenrr< V
(rrV W
userrrW [
.rr[ \
Idrr\ ^
)rr^ _
;rr_ `
IdentityResultss * 
passwordChangeResultss+ ?
=ss@ A
UserManagerssB M
.ssM N
ResetPasswordssN [
(ss[ \
userss\ `
.ss` a
Idssa c
,ssc d

resetTokensse o
,sso p
modelssq v
.ssv w
Passwordssw 
)	ss Ä
;
ssÄ Å
iftt 
(tt   
passwordChangeResulttt  4
!=tt5 7
IdentityResulttt8 F
.ttF G
SuccessttG N
)ttN O
{uu 
throwvv  %
newvv& )
AdsExceptionvv* 6
(vv6 7 
passwordChangeResultvv7 K
.vvK L
ErrorsvvL R
.vvR S
FirstOrDefaultvvS a
(vva b
)vvb c
)vvc d
;vvd e
}ww 
}xx 
breakyy 
;yy 
casezz 
$strzz !
:zz! "
UserManager{{ #
.{{# $
Delete{{$ *
({{* +
user{{+ /
){{/ 0
;{{0 1
break|| 
;|| 
}}} 
Db~~ 
.~~ 
SaveChanges~~ 
(~~ 
)~~  
;~~  !
return 
Json 
( 
new 
JsonResponse  ,
(, -
)- .
{/ 0
IsSucess1 9
=: ;
true< @
}A B
,B C
JsonRequestBehaviorD W
.W X
AllowGetX `
)` a
;a b
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÇÇ 
return
ÉÉ 
Json
ÉÉ 
(
ÉÉ 
new
ÉÉ 
JsonResponse
ÉÉ  ,
(
ÉÉ, -
)
ÉÉ- .
{
ÉÉ/ 0
IsSucess
ÉÉ1 9
=
ÉÉ: ;
false
ÉÉ< A
,
ÉÉA B
ErrorMessage
ÉÉC O
=
ÉÉP Q
ex
ÉÉR T
.
ÉÉT U
Message
ÉÉU \
}
ÉÉ] ^
,
ÉÉ^ _!
JsonRequestBehavior
ÑÑ '
.
ÑÑ' (
AllowGet
ÑÑ( 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÖÖ 
}
ÜÜ 	
}
ââ 
}ää ñ
GE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\TestController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{		 
public

 

class

 
TestController

 
:

  !
BaseController

" 0
{ 
public 
ActionResult 
AddCustomers (
(( )
)) *
{ 	

Dictionary 
< 
string 
, 
string %
>% & 
whiteLabelDictionary' ;
=< =
new> A

DictionaryB L
<L M
stringM S
,S T
stringU [
>[ \
(\ ]
)] ^
{ 
{ 
$str 
, 
$str 2
}2 3
,3 4
{ 
$str 
, 
$str .
}. /
,/ 0
{ 
$str 
, 
$str 1
}1 2
,2 3
{ 
$str 
, 
$str =
}= >
,> ?
{ 
$str 
, 
$str :
}: ;
,; <
{ 
$str 
, 
$str =
}= >
,> ?
{ 
$str !
,! "
$str# B
}B C
,C D
{ 
$str 
, 
$str >
}> ?
,? @
{ 
$str 
, 
$str <
}< =
,= >
{ 
$str 
, 
$str :
}: ;
,; <
{ 
$str 
, 
$str ;
}; <
,< =
{ 
$str 
, 
$str 3
}3 4
,4 5
{ 
$str 
, 
$str 2
}2 3
} 
; 
foreach 
( 
var 
dic 
in  
whiteLabelDictionary  4
)4 5
{   
Db!! 
.!! 
	Customers!! 
.!! 
Add!!  
(!!  !
new!!! $
Customer!!% -
(!!- .
)!!. /
{"" 
Id## 
=## 
Guid## 
.## 
NewGuid## %
(##% &
)##& '
,##' (
	CreatedAt$$ 
=$$ 
DateTime$$  (
.$$( )
Now$$) ,
,$$, -
Code%% 
=%% 
dic%% 
.%% 
Key%% "
,%%" #
Name&& 
=&& 
dic&& 
.&& 
Key&& "
,&&" #
	WebDomain'' 
='' 
dic''  #
.''# $
Value''$ )
}(( 
)(( 
;(( 
})) 
Db** 
.** 
SaveChanges** 
(** 
)** 
;** 
return++ 
View++ 
(++ 
$str++ !
)++! "
;++" #
},, 	
}-- 
}.. ˛S
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\CustomerController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
CustomerController #
:$ %
BaseController& 4
{ 
private 
const 
int 
PageSize "
=# $
$num% '
;' (
public 
ActionResult 
Index !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
var 
customer 
= 
Db 
. 
	Customers '
.' (
Select( .
(. /
x/ 0
=>1 3
new 

CustomerVm 
{ 
Id 
= 
x 
. 
Id 
. 
ToString "
(" #
)# $
,$ %
Code 
= 
x 
. 
Code 
, 
Name 
= 
x 
. 
Name 
, 
	WebDomain 
= 
x 
. 
	WebDomain '
,' (
Phone 
= 
x 
. 
Phone 
,  
Email 
= 
x 
. 
Email 
,  
DateCreated 
= 
x 
.  
	CreatedAt  )
.) *
ToString* 2
(2 3
)3 4
} 
) 
. 
ToList 
( 
) 
; 
int!! 

pageNumber!! 
=!! 
(!! 
sc!!  
.!!  !
page!!! %
??!!& (
$num!!) *
)!!* +
;!!+ ,
var"" 
model"" 
="" 
customer""  
.""  !
ToPagedList""! ,
("", -

pageNumber""- 7
,""7 8
PageSize""9 A
)""A B
;""B C
return## 
View## 
(## 
model## 
)## 
;## 
}$$ 	
public&& 
ActionResult&& 
New&& 
(&&  
)&&  !
{'' 	
return(( 
View(( 
((( 
)(( 
;(( 
})) 	
[++ 	
HttpPost++	 
]++ 
public,, 
ActionResult,, 
New,, 
(,,  

CustomerVm,,  *

customerVm,,+ 5
),,5 6
{-- 	
try.. 
{// 
var00 
customer00 
=00 
new00 "
Customer00# +
{11 
Id22 
=22 
Guid22 
.22 
NewGuid22 %
(22% &
)22& '
,22' (
	CreatedAt33 
=33 
DateTime33  (
.33( )
Now33) ,
,33, -
	CreatedBy44 
=44 
LoggedInUser44  ,
.44, -
Id44- /
,44/ 0
Code55 
=55 

customerVm55 %
.55% &
Code55& *
,55* +
Name66 
=66 

customerVm66 %
.66% &
Name66& *
,66* +
Email77 
=77 

customerVm77 &
.77& '
Email77' ,
,77, -
Phone88 
=88 

customerVm88 &
.88& '
Phone88' ,
,88, -
	WebDomain99 
=99 

customerVm99  *
.99* +
	WebDomain99+ 4
,994 5
}:: 
;:: 
Db;; 
.;; 
	Customers;; 
.;; 
Add;;  
(;;  !
customer;;! )
);;) *
;;;* +
Db<< 
.<< 
SaveChanges<< 
(<< 
)<<  
;<<  !
ForceCustomers>> 
=>>  
true>>! %
;>>% &
TempData@@ 
[@@ 
$str@@ "
]@@" #
=@@$ %
$str@@& T
;@@T U
returnAA 
RedirectToActionAA '
(AA' (
$strAA( /
)AA/ 0
;AA0 1
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
}FF 
returnGG 
ViewGG 
(GG 
$strGG 
)GG  
;GG  !
}HH 	
publicJJ 
ActionResultJJ 
EditJJ  
(JJ  !
GuidJJ! %
?JJ% &
idJJ' )
)JJ) *
{KK 	
ifLL 
(LL 
idLL 
==LL 
nullLL 
)LL 
{MM 
throwNN 
newNN 
HttpExceptionNN '
(NN' (
$numNN( +
,NN+ ,
$strNN- :
)NN: ;
;NN; <
}OO 
varPP 
xPP 
=PP 
DbPP 
.PP 
	CustomersPP  
.PP  !
FindPP! %
(PP% &
idPP& (
)PP( )
;PP) *
ifQQ 
(QQ 
xQQ 
==QQ 
nullQQ 
)QQ 
{RR 
throwSS 
newSS 
HttpExceptionSS '
(SS' (
$numSS( +
,SS+ ,
$strSS- 8
)SS8 9
;SS9 :
}TT 
varUU 
vendorUU 
=UU 
newUU 

CustomerVmUU '
{VV 
IdWW 
=WW 
xWW 
.WW 
IdWW 
.WW 
ToStringWW "
(WW" #
)WW# $
,WW$ %
CodeXX 
=XX 
xXX 
.XX 
CodeXX 
,XX 
NameYY 
=YY 
xYY 
.YY 
NameYY 
,YY 
EmailZZ 
=ZZ 
xZZ 
.ZZ 
EmailZZ 
,ZZ  
Phone[[ 
=[[ 
x[[ 
.[[ 
Phone[[ 
,[[  
	WebDomain\\ 
=\\ 
x\\ 
.\\ 
	WebDomain\\ '
,\\' (
DateCreated]] 
=]] 
x]] 
.]]  
	CreatedAt]]  )
.]]) *
ToString]]* 2
(]]2 3
)]]3 4
}^^ 
;^^ 
return`` 
View`` 
(`` 
$str`` 
,`` 
vendor`` %
)``% &
;``& '
}aa 	
[cc 	
HttpPostcc	 
]cc 
publicdd 
ActionResultdd 
Editdd  
(dd  !

CustomerVmdd! +

customerVmdd, 6
)dd6 7
{ee 	
tryff 
{gg 
varhh 
customerhh 
=hh 
Dbhh !
.hh! "
	Customershh" +
.hh+ ,
Findhh, 0
(hh0 1
Guidhh1 5
.hh5 6
Parsehh6 ;
(hh; <

customerVmhh< F
.hhF G
IdhhG I
)hhI J
)hhJ K
;hhK L
ifii 
(ii 
customerii 
!=ii 
nullii  $
)ii$ %
{jj 
customerkk 
.kk 
Codekk !
=kk" #

customerVmkk$ .
.kk. /
Codekk/ 3
;kk3 4
customerll 
.ll 
Namell !
=ll" #

customerVmll$ .
.ll. /
Namell/ 3
;ll3 4
customermm 
.mm 
	WebDomainmm &
=mm' (

customerVmmm) 3
.mm3 4
	WebDomainmm4 =
;mm= >
customernn 
.nn 
Emailnn "
=nn# $

customerVmnn% /
.nn/ 0
Emailnn0 5
;nn5 6
customeroo 
.oo 
Phoneoo "
=oo# $

customerVmoo% /
.oo/ 0
Phoneoo0 5
;oo5 6
}pp 
Dbqq 
.qq 
SaveChangesqq 
(qq 
)qq  
;qq  !
TempDatarr 
[rr 
$strrr "
]rr" #
=rr$ %
$strrr& [
;rr[ \
ForceCustomerstt 
=tt  
truett! %
;tt% &
returnuu 
RedirectToActionuu '
(uu' (
$struu( /
)uu/ 0
;uu0 1
}vv 
catchww 
(ww 
	Exceptionww 
exww 
)ww  
{xx 
}zz 
return{{ 
View{{ 
({{ 
$str{{ 
){{  
;{{  !
}|| 	
public~~ 
ActionResult~~ 
Delete~~ "
(~~" #
Guid~~# '
?~~' (
id~~) +
)~~+ ,
{ 	
try
ÄÄ 
{
ÅÅ 
var
ÇÇ 
customer
ÇÇ 
=
ÇÇ 
Db
ÇÇ !
.
ÇÇ! "
	Customers
ÇÇ" +
.
ÇÇ+ ,
Find
ÇÇ, 0
(
ÇÇ0 1
id
ÇÇ1 3
)
ÇÇ3 4
;
ÇÇ4 5
if
ÉÉ 
(
ÉÉ 
customer
ÉÉ 
!=
ÉÉ 
null
ÉÉ  $
)
ÉÉ$ %
{
ÑÑ 
Db
ÖÖ 
.
ÖÖ 
	Customers
ÖÖ  
.
ÖÖ  !
Remove
ÖÖ! '
(
ÖÖ' (
customer
ÖÖ( 0
)
ÖÖ0 1
;
ÖÖ1 2
Db
ÜÜ 
.
ÜÜ 
SaveChanges
ÜÜ "
(
ÜÜ" #
)
ÜÜ# $
;
ÜÜ$ %
ForceCustomers
áá "
=
áá# $
true
áá% )
;
áá) *
}
àà 
return
ââ 
Json
ââ 
(
ââ 
new
ââ 
JsonResponse
ââ  ,
(
ââ, -
)
ââ- .
{
ââ/ 0
IsSucess
ââ1 9
=
ââ: ;
true
ââ< @
}
ââA B
,
ââB C!
JsonRequestBehavior
ââD W
.
ââW X
AllowGet
ââX `
)
ââ` a
;
ââa b
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
åå 
return
çç 
Json
çç 
(
çç 
new
çç 
JsonResponse
çç  ,
(
çç, -
)
çç- .
{
çç/ 0
IsSucess
çç1 9
=
çç: ;
false
çç< A
,
ççA B
ErrorMessage
ççC O
=
ççP Q
ex
ççR T
.
ççT U
Message
ççU \
}
çç] ^
,
çç^ _!
JsonRequestBehavior
éé '
.
éé' (
AllowGet
éé( 0
)
éé0 1
;
éé1 2
}
èè 
}
êê 	
}
ëë 
}íí ¯S
IE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\VendorController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
VendorController !
:" #
BaseController$ 2
{ 
private 
const 
int 
PageSize "
=# $
$num% '
;' (
public 
ActionResult 
Index !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
var 
vendors 
= 
Db 
. 
Vendors $
.$ %
Select% +
(+ ,
x, -
=>. 0
new 
VendorVm 
{ 
Id 
= 
x 
. 
Id 
. 
ToString "
(" #
)# $
,$ %
Name 
= 
x 
. 
Name 
, 
CompanyName 
= 
x 
.  
CompanyName  +
,+ ,
Phone 
= 
x 
. 
Phone 
,  
Email 
= 
x 
. 
Email 
,  
CcEmails 
= 
x 
. 
CcEmails %
,% &
DateCreated 
= 
x 
.  
	CreatedAt  )
.) *
ToString* 2
(2 3
)3 4
} 
) 
. 
ToList 
( 
) 
; 
int!! 

pageNumber!! 
=!! 
(!! 
sc!!  
.!!  !
page!!! %
??!!& (
$num!!) *
)!!* +
;!!+ ,
var"" 
model"" 
="" 
vendors"" 
.""  
ToPagedList""  +
(""+ ,

pageNumber"", 6
,""6 7
PageSize""8 @
)""@ A
;""A B
return## 
View## 
(## 
model## 
)## 
;## 
}$$ 	
public&& 
ActionResult&& 
New&& 
(&&  
)&&  !
{'' 	
return(( 
View(( 
((( 
)(( 
;(( 
})) 	
[++ 	
HttpPost++	 
]++ 
public,, 
ActionResult,, 
New,, 
(,,  
VendorVm,,  (
vendorVm,,) 1
),,1 2
{-- 	
try.. 
{// 
var00 
vendor00 
=00 
new00  
Vendor00! '
(00' (
)00( )
{11 
Id22 
=22 
Guid22 
.22 
NewGuid22 %
(22% &
)22& '
,22' (
	CreatedAt33 
=33 
DateTime33  (
.33( )
Now33) ,
,33, -
	CreatedBy44 
=44 
LoggedInUser44  ,
.44, -
Id44- /
,44/ 0
Name55 
=55 
vendorVm55 #
.55# $
Name55$ (
,55( )
CompanyName66 
=66  !
vendorVm66" *
.66* +
CompanyName66+ 6
,666 7
Email77 
=77 
vendorVm77 $
.77$ %
Email77% *
,77* +
CcEmails88 
=88 
vendorVm88 '
.88' (
CcEmails88( 0
,880 1
Phone99 
=99 
vendorVm99 $
.99$ %
Phone99% *
,99* +
}:: 
;:: 
Db;; 
.;; 
Vendors;; 
.;; 
Add;; 
(;; 
vendor;; %
);;% &
;;;& '
Db<< 
.<< 
SaveChanges<< 
(<< 
)<<  
;<<  !
ForceVendors>> 
=>> 
true>> #
;>># $
TempData@@ 
[@@ 
$str@@ "
]@@" #
=@@$ %
$str@@& T
;@@T U
returnAA 
RedirectToActionAA '
(AA' (
$strAA( /
)AA/ 0
;AA0 1
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
}FF 
returnGG 
ViewGG 
(GG 
$strGG 
)GG  
;GG  !
}HH 	
publicJJ 
ActionResultJJ 
EditJJ  
(JJ  !
GuidJJ! %
?JJ% &
idJJ' )
)JJ) *
{KK 	
ifLL 
(LL 
idLL 
==LL 
nullLL 
)LL 
{MM 
throwNN 
newNN 
HttpExceptionNN '
(NN' (
$numNN( +
,NN+ ,
$strNN- :
)NN: ;
;NN; <
}OO 
varPP 
xPP 
=PP 
DbPP 
.PP 
VendorsPP 
.PP 
FindPP #
(PP# $
idPP$ &
)PP& '
;PP' (
ifQQ 
(QQ 
xQQ 
==QQ 
nullQQ 
)QQ 
{RR 
throwSS 
newSS 
HttpExceptionSS '
(SS' (
$numSS( +
,SS+ ,
$strSS- 8
)SS8 9
;SS9 :
}TT 
varUU 
vendorUU 
=UU 
newUU 
VendorVmUU %
{VV 
IdWW 
=WW 
xWW 
.WW 
IdWW 
.WW 
ToStringWW "
(WW" #
)WW# $
,WW$ %
NameXX 
=XX 
xXX 
.XX 
NameXX 
,XX 
CompanyNameYY 
=YY 
xYY 
.YY  
CompanyNameYY  +
,YY+ ,
EmailZZ 
=ZZ 
xZZ 
.ZZ 
EmailZZ 
,ZZ  
CcEmails[[ 
=[[ 
x[[ 
.[[ 
CcEmails[[ %
,[[% &
Phone\\ 
=\\ 
x\\ 
.\\ 
Phone\\ 
,\\  
DateCreated]] 
=]] 
x]] 
.]]  
	CreatedAt]]  )
.]]) *
ToString]]* 2
(]]2 3
)]]3 4
}^^ 
;^^ 
return`` 
View`` 
(`` 
$str`` 
,`` 
vendor`` %
)``% &
;``& '
}aa 	
[cc 	
HttpPostcc	 
]cc 
publicdd 
ActionResultdd 
Editdd  
(dd  !
VendorVmdd! )
vendorVmdd* 2
)dd2 3
{ee 	
tryff 
{gg 
varhh 
vendorhh 
=hh 
Dbhh 
.hh  
Vendorshh  '
.hh' (
Findhh( ,
(hh, -
Guidhh- 1
.hh1 2
Parsehh2 7
(hh7 8
vendorVmhh8 @
.hh@ A
IdhhA C
)hhC D
)hhD E
;hhE F
ifii 
(ii 
vendorii 
!=ii 
nullii "
)ii" #
{jj 
vendorkk 
.kk 
Namekk 
=kk  !
vendorVmkk" *
.kk* +
Namekk+ /
;kk/ 0
vendorll 
.ll 
CompanyNamell &
=ll' (
vendorVmll) 1
.ll1 2
CompanyNamell2 =
;ll= >
vendormm 
.mm 
Emailmm  
=mm! "
vendorVmmm# +
.mm+ ,
Emailmm, 1
;mm1 2
vendornn 
.nn 
Phonenn  
=nn! "
vendorVmnn# +
.nn+ ,
Phonenn, 1
;nn1 2
vendoroo 
.oo 
CcEmailsoo #
=oo$ %
vendorVmoo& .
.oo. /
CcEmailsoo/ 7
;oo7 8
}pp 
Dbqq 
.qq 
SaveChangesqq 
(qq 
)qq  
;qq  !
TempDatarr 
[rr 
$strrr "
]rr" #
=rr$ %
$strrr& V
;rrV W
ForceVendorstt 
=tt 
truett #
;tt# $
returnuu 
RedirectToActionuu '
(uu' (
$struu( /
)uu/ 0
;uu0 1
}vv 
catchww 
(ww 
	Exceptionww 
exww 
)ww  
{xx 
}zz 
return{{ 
View{{ 
({{ 
$str{{ 
){{  
;{{  !
}|| 	
public~~ 
ActionResult~~ 
Delete~~ "
(~~" #
Guid~~# '
?~~' (
id~~) +
)~~+ ,
{ 	
try
ÄÄ 
{
ÅÅ 
var
ÇÇ 
vendor
ÇÇ 
=
ÇÇ 
Db
ÇÇ 
.
ÇÇ  
Vendors
ÇÇ  '
.
ÇÇ' (
Find
ÇÇ( ,
(
ÇÇ, -
id
ÇÇ- /
)
ÇÇ/ 0
;
ÇÇ0 1
if
ÉÉ 
(
ÉÉ 
vendor
ÉÉ 
!=
ÉÉ 
null
ÉÉ "
)
ÉÉ" #
{
ÑÑ 
Db
ÖÖ 
.
ÖÖ 
Vendors
ÖÖ 
.
ÖÖ 
Remove
ÖÖ %
(
ÖÖ% &
vendor
ÖÖ& ,
)
ÖÖ, -
;
ÖÖ- .
Db
ÜÜ 
.
ÜÜ 
SaveChanges
ÜÜ "
(
ÜÜ" #
)
ÜÜ# $
;
ÜÜ$ %
ForceVendors
áá  
=
áá! "
true
áá# '
;
áá' (
}
àà 
return
ââ 
Json
ââ 
(
ââ 
new
ââ 
JsonResponse
ââ  ,
(
ââ, -
)
ââ- .
{
ââ/ 0
IsSucess
ââ1 9
=
ââ: ;
true
ââ< @
}
ââA B
,
ââB C!
JsonRequestBehavior
ââD W
.
ââW X
AllowGet
ââX `
)
ââ` a
;
ââa b
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
åå 
return
çç 
Json
çç 
(
çç 
new
çç 
JsonResponse
çç  ,
(
çç, -
)
çç- .
{
çç/ 0
IsSucess
çç1 9
=
çç: ;
false
çç< A
,
ççA B
ErrorMessage
ççC O
=
ççP Q
ex
ççR T
.
ççT U
Message
ççU \
}
çç] ^
,
çç^ _!
JsonRequestBehavior
éé '
.
éé' (
AllowGet
éé( 0
)
éé0 1
;
éé1 2
}
èè 
}
êê 	
}
ëë 
}íí Œ
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\AdsException.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
[		 
Serializable		 
]		 
public

 

class

 
AdsException

 
:

 
	Exception

  )
{ 
public 
AdsException 
( 
) 
: 	
base
 
( 
) 
{ 
} 
public 
AdsException 
( 
string "
message# *
)* +
: 	
base
 
( 
message 
) 
{ 
} 
public 
AdsException 
( 
string "
format# )
,) *
params+ 1
object2 8
[8 9
]9 :
args; ?
)? @
: 	
base
 
( 
string 
. 
Format 
( 
format #
,# $
args% )
)) *
)* +
{, -
}. /
public 
AdsException 
( 
string "
message# *
,* +
	Exception, 5
innerException6 D
)D E
: 	
base
 
( 
message 
, 
innerException &
)& '
{( )
}* +
public 
AdsException 
( 
string "
format# )
,) *
	Exception+ 4
innerException5 C
,C D
paramsE K
objectL R
[R S
]S T
argsU Y
)Y Z
: 	
base
 
( 
string 
. 
Format 
( 
format #
,# $
args% )
)) *
,* +
innerException, :
): ;
{< =
}> ?
	protected 
AdsException 
( 
SerializationInfo 0
info1 5
,5 6
StreamingContext7 G
contextH O
)O P
: 	
base
 
( 
info 
, 
context 
) 
{ 
}  !
} 
} Ù

>E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CustomerVm.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 

CustomerVm 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Code 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
	WebDomain 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
Phone

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
string 
DateCreated !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ˆ

<E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\VendorVm.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
VendorVm 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
CompanyName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
CcEmails

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
DateCreated !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ¶P
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\ProData\NotificationsProcessor.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
ProData 
{ 
public 

static 
class "
NotificationsProcessor .
{ 
public 
static 
void #
FetchAndCheckForQcRules 2
(2 3
)3 4
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
RulesProcessing- <
,< =
$str> @
,@ A
$"B D/
#FetchAndCheckForQCRules started at D g
{g h
DateTimeh p
.p q
Nowq t
}t u
"u v
)v w
;w x
List 
< 
Campaign 
> 
	campaigns (
=) *
db+ -
.- .
	Campaigns. 7
. 
Include 
( 
x 
=> !
x" #
.# $
Approved$ ,
), -
. 
Include 
( 
x 
=> !
x" #
.# $
Segments$ ,
), -
. 
Include 
( 
x 
=> !
x" #
.# $
	Trackings$ -
)- .
. 
Where 
( 
x 
=> 
x  !
.! "
Status" (
==) +
(, -
int- 0
)0 1
CampaignStatus1 ?
.? @

Monitoring@ J
||K M
xN O
.O P
SegmentsP X
.X Y
AnyY \
(\ ]
s] ^
=>_ a
sb c
.c d
SegmentStatusd q
==r t
(u v
intv y
)y z
SegmentStatus	z á
.
á à

Monitoring
à í
)
í ì
)
ì î
. 
Where 
( 
x 
=> 
x  !
.! "
Approved" *
!=+ -
null. 2
)2 3
. 
ToList 
( 
) 
; 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
RulesProcessing- <
,< =
$str> @
,@ A
$"B D/
#FetchAndCheckForQCRules processing D g
{g h
	campaignsh q
.q r
Countr w
}w x
 campaigns.	x É
"
É Ñ
)
Ñ Ö
;
Ö Ü
int"" 
index"" 
="" 
$num"" 
;"" 
foreach## 
(## 
var## 
campaign## %
in##& (
	campaigns##) 2
)##2 3
{$$ 
ProDataApiManager%% %
.%%% &#
FetchAndUpdateTrackings%%& =
(%%= >
db%%> @
,%%@ A
campaign%%B J
)%%J K
;%%K L
	LogHelper&& 
.&& 
AddLog&& $
(&&$ %
db&&% '
,&&' (
LogType&&) 0
.&&0 1
RulesProcessing&&1 @
,&&@ A
$str&&B D
,&&D E
$"&&F H.
"FetchAndCheckForQCRules completed &&H j
{&&j k
index&&k p
}&&p q
 out of &&q y
{&&y z
	campaigns	&&z É
.
&&É Ñ
Count
&&Ñ â
}
&&â ä
 campaigns.
&&ä ï
"
&&ï ñ
)
&&ñ ó
;
&&ó ò
index'' 
++'' 
;'' 
}(( 
var,, 
toBeExpired,, 
=,,  !
db,," $
.,,$ %
Notifications,,% 2
.,,2 3
ToList,,3 9
(,,9 :
),,: ;
.-- 
Where-- 
(-- 
x--  
=>--! #
(--$ %
DateTime--% -
.--- .
Now--. 1
.--1 2
	TimeOfDay--2 ;
.--; <
Hours--< A
---B C
x--D E
.--E F
FoundAt--F M
?--M N
.--N O
	TimeOfDay--O X
.--X Y
Hours--Y ^
)--^ _
>=--` b
$num--c f
)--f g
... 
ToList.. 
(..  
)..  !
;..! "
if// 
(// 
toBeExpired// 
.//  
Count//  %
>//& '
$num//( )
)//) *
{00 
	LogHelper11 
.11 
AddLog11 $
(11$ %
db11% '
,11' (
LogType11) 0
.110 1
RulesProcessing111 @
,11@ A
$str11B D
,11D E
$str11F i
)11i j
;11j k
foreach22 
(22 
var22  
notification22! -
in22. 0
toBeExpired221 <
)22< =
{33 
notification44 $
.44$ %
Status44% +
=44, -
(44. /
int44/ 2
)442 3
NotificationStatus443 E
.44E F
Expired44F M
;44M N
}55 
db66 
.66 
SaveChanges66 "
(66" #
)66# $
;66$ %
}77 
var:: 
logs:: 
=:: 
db:: 
.:: 

SystemLogs:: (
.::( )
Where::) .
(::. /
x::/ 0
=>::1 3
(::4 5
x::5 6
.::6 7
LogType::7 >
==::? A
(::B C
int::C F
)::F G
LogType::G N
.::N O
RulesProcessing::O ^
||::_ a
x::b c
.::c d
LogType::d k
==::l n
(::o p
int::p s
)::s t
LogType::t {
.::{ |
ProData	::| É
)
::É Ñ
&&
::Ö á
(;;4 5
DateTime;;5 =
.;;= >
Now;;> A
.;;A B
	TimeOfDay;;B K
.;;K L
Hours;;L Q
-;;R S
x;;T U
.;;U V
	CreatedAt;;V _
.;;_ `
	TimeOfDay;;` i
.;;i j
Hours;;j o
);;o p
>=;;q s
$num;;t v
);;v w
.;;w x
ToList;;x ~
(;;~ 
)	;; Ä
;
;;Ä Å
if<< 
(<< 
logs<< 
.<< 
Count<< 
><<  
$num<<! "
)<<" #
{== 
foreach>> 
(>> 
var>>  
log>>! $
in>>% '
logs>>( ,
)>>, -
{?? 
db@@ 
.@@ 

SystemLogs@@ %
.@@% &
Remove@@& ,
(@@, -
log@@- 0
)@@0 1
;@@1 2
}AA 
dbBB 
.BB 
SaveChangesBB "
(BB" #
)BB# $
;BB$ %
}CC 
	LogHelperEE 
.EE 
AddLogEE  
(EE  !
dbEE! #
,EE# $
LogTypeEE% ,
.EE, -
RulesProcessingEE- <
,EE< =
$strEE> @
,EE@ A
$"EEB D0
$FetchAndCheckForQCRules finished at EED h
{EEh i
DateTimeEEi q
.EEq r
NowEEr u
}EEu v
, EEv x
{EEx y
	campaigns	EEy Ç
.
EEÇ É
Count
EEÉ à
}
EEà â#
 campaigns refreshed.
EEâ û
"
EEû ü
)
EEü †
;
EE† °
}GG 
}HH 	
publicJJ 
staticJJ 
voidJJ "
SendNotificationEmailsJJ 1
(JJ1 2
)JJ2 3
{KK 	
usingLL 
(LL 
varLL 
dbLL 
=LL 
newLL 
WfpictContextLL  -
(LL- .
)LL. /
)LL/ 0
{MM 
varWW 
	campaignsWW 
=WW 
(WW  !
fromWW! %
cWW& '
inWW( *
dbWW+ -
.WW- .
	CampaignsWW. 7
joinXX  $
nXX% &
inXX' )
dbXX* ,
.XX, -
NotificationsXX- :
onXX; =
cXX> ?
.XX? @
IdXX@ B
equalsXXC I
nXXJ K
.XXK L

CampaignIdXXL V
whereYY  %
nYY& '
.YY' (
StatusYY( .
==YY/ 1
(YY2 3
intYY3 6
)YY6 7
NotificationStatusYY7 I
.YYI J
FoundYYJ O
selectZZ  &
cZZ' (
)ZZ( )
.ZZ) *
DistinctZZ* 2
(ZZ2 3
)ZZ3 4
.ZZ4 5
IncludeZZ5 <
(ZZ< =
xZZ= >
=>ZZ? A
xZZB C
.ZZC D
NotificationsZZD Q
)ZZQ R
.ZZR S
ToListZZS Y
(ZZY Z
)ZZZ [
;ZZ[ \
var\\ 
vendor\\ 
=\\ 
db\\ 
.\\  
Vendors\\  '
.\\' (
FirstOrDefault\\( 6
(\\6 7
x\\7 8
=>\\9 ;
x\\< =
.\\= >
Name\\> B
.\\B C
Contains\\C K
(\\K L
$str\\L Q
)\\Q R
||\\S U
x\\V W
.\\W X
Name\\X \
.\\\ ]
Contains\\] e
(\\e f
$str\\f l
)\\l m
)\\m n
;\\n o
if^^ 
(^^ 
	campaigns^^ 
.^^ 
Count^^ #
>^^$ %
$num^^& '
)^^' (
{__ 
	LogHelper`` 
.`` 
AddLog`` $
(``$ %
db``% '
,``' (
LogType``) 0
.``0 1
RulesProcessing``1 @
,``@ A
$str``B D
,``D E
$str``F c
)``c d
;``d e
EmailHelperaa 
.aa  %
SendNotificationsToVendoraa  9
(aa9 :
vendoraa: @
,aa@ A
	campaignsaaB K
)aaK L
;aaL M
}bb 
}cc 
}dd 	
}ff 
}gg ‡U
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\CampaignProcessor.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Async

 
{ 
public 

static 
class 
CampaignProcessor )
{ 
public 
static 
void 
SendVendorEmail *
(* +
Guid+ /
?/ 0
vendorId1 9
,9 :
string; A
orderNumberB M
,M N
stringO U
[U V
]V W
segmentsSelectedX h
)h i
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
Campaign 
campaign !
=" #
db$ &
.& '
	Campaigns' 0
. 
Include 
( 
x 
=> !
x" #
.# $
Assets$ *
)* +
. 
Include 
( 
x 
=> !
x" #
.# $
Segments$ ,
), -
. 
Include 
( 
x 
=> !
x" #
.# $
Approved$ ,
), -
. 
Include 
( 
x 
=> !
x" #
.# $
	Trackings$ -
)- .
. 
FirstOrDefault #
(# $
x$ %
=>& (
x) *
.* +
OrderNumber+ 6
==7 9
orderNumber: E
)E F
;F G
var 
vendor 
= 
db 
.  
Vendors  '
.' (
FirstOrDefault( 6
(6 7
x7 8
=>9 ;
x< =
.= >
Id> @
==A C
vendorIdD L
)L M
;M N
if 
( 
segmentsSelected $
==% '
null( ,
), -
{ 
EmailHelper 
.   
SendApprovedToVendor  4
(4 5
vendor5 ;
,; <
campaign= E
,E F
nullG K
)K L
;L M
string 
orderNumberRdp )
;) *
long   
quantity   !
;  ! "
if!! 
(!! 
campaign!!  
.!!  !
ReBroadcasted!!! .
)!!. /
{"" 
orderNumberRdp## &
=##' (
campaign##) 1
.##1 2$
ReBroadcastedOrderNumber##2 J
;##J K
quantity$$  
=$$! "
campaign$$# +
.$$+ ,!
ReBroadcastedQuantity$$, A
;$$A B
}%% 
else&& 
{'' 
orderNumberRdp(( &
=((' (
campaign(() 1
.((1 2
OrderNumber((2 =
;((= >
quantity))  
=))! "
campaign))# +
.))+ ,
Approved)), 4
.))4 5
Quantity))5 =
;))= >
}** 
var,, 
campaignTracking,, (
=,,) *
db-- 
.-- 
CampaignTrackings-- /
.--/ 0
FirstOrDefault--0 >
(--> ?
x--? @
=>--A C
x--D E
.--E F

CampaignId--F P
==--Q S
campaign--T \
.--\ ]
Id--] _
&&--` b
x--c d
.--d e
OrderNumber--e p
==--q s
orderNumberRdp	--t Ç
&&
--É Ö
x
--Ü á
.
--á à
SegmentNumber
--à ï
==
--ñ ò
$str
--ô õ
)
--õ ú
;
--ú ù
if// 
(// 
campaignTracking// (
==//) +
null//, 0
)//0 1
{00 
var11 

trackingId11 &
=11' (
Guid11) -
.11- .
NewGuid11. 5
(115 6
)116 7
;117 8
var22 
tracking22 $
=22% &
new22' *
CampaignTracking22+ ;
(22; <
)22< =
{33 
Id44 
=44  

trackingId44! +
,44+ ,
	CreatedAt55 %
=55& '
DateTime55( 0
.550 1
Now551 4
,554 5

CampaignId66 &
=66' (
campaign66) 1
.661 2
Id662 4
,664 5
OrderNumber77 '
=77( )
orderNumberRdp77* 8
,778 9
SegmentNumber88 )
=88* +
string88, 2
.882 3
Empty883 8
,888 9
Quantity99 $
=99% &
quantity99' /
,99/ 0
DateSent:: $
=::% &
DateTime::' /
.::/ 0
Now::0 3
,::3 4
IsCreatedThroughApi;; /
=;;0 1
false;;2 7
}<< 
;<< 
db== 
.== 
CampaignTrackings== ,
.==, -
Add==- 0
(==0 1
tracking==1 9
)==9 :
;==: ;
}>> 
if@@ 
(@@ 
!@@ 
campaign@@ !
.@@! "
ReBroadcasted@@" /
)@@/ 0
{AA 
	LogHelperBB !
.BB! "
AddLogBB" (
(BB( )
dbBB) +
,BB+ ,
LogTypeBB- 4
.BB4 5
ProDataBB5 <
,BB< =
orderNumberBB> I
,BBI J
$strBBK x
)BBx y
;BBy z
}CC 
elseDD 
{EE 
	LogHelperFF !
.FF! "
AddLogFF" (
(FF( )
dbFF) +
,FF+ ,
LogTypeFF- 4
.FF4 5
ProDataFF5 <
,FF< =
orderNumberFF> I
,FFI J
$strFFK 
)	FF Ä
;
FFÄ Å
}GG 
dbHH 
.HH 
SaveChangesHH "
(HH" #
)HH# $
;HH$ %
}JJ 
elseKK 
{LL 
varMM 
segmentsMM  
=MM! "
dbMM# %
.MM% &
CampaignSegmentsMM& 6
.NN# $
WhereNN$ )
(NN) *
cNN* +
=>NN, .
cNN/ 0
.NN0 1

CampaignIdNN1 ;
==NN< >
campaignNN? G
.NNG H
IdNNH J
&&NNK M
segmentsSelectedNNN ^
.NN^ _
ContainsNN_ g
(NNg h
cNNh i
.NNi j
SegmentNumberNNj w
)NNw x
)NNx y
.OO# $
ToListOO$ *
(OO* +
)OO+ ,
;OO, -
foreachQQ 
(QQ 
varQQ  
segmentQQ! (
inQQ) +
segmentsQQ, 4
)QQ4 5
{RR 
EmailHelperSS #
.SS# $ 
SendApprovedToVendorSS$ 8
(SS8 9
vendorSS9 ?
,SS? @
campaignSSA I
,SSI J
segmentSSK R
)SSR S
;SSS T
segmentUU 
.UU  
SegmentStatusUU  -
=UU. /
(UU0 1
intUU1 4
)UU4 5
SegmentStatusUU5 B
.UUB C

MonitoringUUC M
;UUM N
varWW 
campaignTrackingWW ,
=WW- .
dbXX 
.XX 
CampaignTrackingsXX 0
.XX0 1
FirstOrDefaultXX1 ?
(XX? @
xXX@ A
=>XXB D
xXXE F
.XXF G

CampaignIdXXG Q
==XXR T
campaignXXU ]
.XX] ^
IdXX^ `
&&XXa c
xXXd e
.XXe f
SegmentNumberXXf s
==XXt v
segmentXXw ~
.XX~ 
SegmentNumber	XX å
)
XXå ç
;
XXç é
ifZZ 
(ZZ 
campaignTrackingZZ ,
==ZZ- /
nullZZ0 4
)ZZ4 5
{[[ 
var\\ 

trackingId\\  *
=\\+ ,
Guid\\- 1
.\\1 2
NewGuid\\2 9
(\\9 :
)\\: ;
;\\; <
var]] 
tracking]]  (
=]]) *
new]]+ .
CampaignTracking]]/ ?
(]]? @
)]]@ A
{^^ 
Id__  "
=__# $

trackingId__% /
,__/ 0
	CreatedAt``  )
=``* +
DateTime``, 4
.``4 5
Now``5 8
,``8 9

CampaignIdaa  *
=aa+ ,
campaignaa- 5
.aa5 6
Idaa6 8
,aa8 9
OrderNumberbb  +
=bb, -
orderNumberbb. 9
,bb9 :
SegmentNumbercc  -
=cc. /
segmentcc0 7
.cc7 8
SegmentNumbercc8 E
,ccE F
Quantitydd  (
=dd) *
segmentdd+ 2
.dd2 3
Quantitydd3 ;
,dd; <
DateSentee  (
=ee) *
DateTimeee+ 3
.ee3 4
Nowee4 7
,ee7 8
IsCreatedThroughApiff  3
=ff4 5
falseff6 ;
}gg 
;gg 
dbhh 
.hh 
CampaignTrackingshh 0
.hh0 1
Addhh1 4
(hh4 5
trackinghh5 =
)hh= >
;hh> ?
}ii 
	LogHelperjj !
.jj! "
AddLogjj" (
(jj( )
dbjj) +
,jj+ ,
LogTypejj- 4
.jj4 5
ProDatajj5 <
,jj< =
orderNumberjj> I
,jjI J
$"jjK M
Segment jjM U
{jjU V
segmentjjV ]
.jj] ^
SegmentNumberjj^ k
}jjk l3
& has been sent to vendor successfully.	jjl í
"
jjí ì
)
jjì î
;
jjî ï
}kk 
}ll 
varoo #
ifSomeSegmentsRemainingoo +
=oo, -
dboo. 0
.oo0 1
CampaignSegmentsoo1 A
.pp 
Wherepp $
(pp$ %
cpp% &
=>pp' )
cpp* +
.pp+ ,

CampaignIdpp, 6
==pp7 9
campaignpp: B
.ppB C
IdppC E
)ppE F
.qq 
Anyqq "
(qq" #
xqq# $
=>qq% '
xqq( )
.qq) *
SegmentStatusqq* 7
==qq8 :
(qq; <
intqq< ?
)qq? @
SegmentStatusqq@ M
.qqM N
	GeneratedqqN W
||qqX Z
xqq[ \
.qq\ ]
SegmentStatusqq] j
==qqk m
(qqn o
intqqo r
)qqr s
SegmentStatus	qqs Ä
.
qqÄ Å
Approved
qqÅ â
)
qqâ ä
;
qqä ã
ifrr 
(rr 
!rr #
ifSomeSegmentsRemainingrr ,
)rr, -
{ss 
campaigntt 
.tt 
Statustt #
=tt$ %
(tt& '
inttt' *
)tt* +
CampaignStatustt+ 9
.tt9 :

Monitoringtt: D
;ttD E
dbuu 
.uu 
SaveChangesuu "
(uu" #
)uu# $
;uu$ %
}vv 
}xx 
}yy 	
}{{ 
}|| ˇn
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\DataFileProcessor.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Async 
{ 
public 

class 
DataFileProcessor "
{ 
public 
DataFileProcessor  
(  !
)! "
{ 	
} 	
public 
static 
async 
Task  
FetchSQLDataFile! 1
(1 2
string2 8

UploadPath9 C
,C D
stringE K
OrderNumberL W
,W X
stringY _
ZipCodeFile` k
,k l
long 
DataQuantity 
) 
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
	LogHelper 
. 
AddLog  
(  !
db! #
,# $
LogType% ,
., -
DataProcessing- ;
,; <
OrderNumber= H
,H I
$strJ l
)l m
;m n
try 
{ 
string   
ZipFilePath   &
=  ' (
Path  ) -
.  - .
Combine  . 5
(  5 6

UploadPath  6 @
,  @ A
ZipCodeFile  B M
)  M N
;  N O
S3FileManager!! !
.!!! "
Download!!" *
(!!* +
ZipCodeFile!!+ 6
,!!6 7
ZipFilePath!!8 C
)!!C D
;!!D E
var"" 
list"" 
="" 
new"" "
List""# '
<""' (
string""( .
>"". /
(""/ 0
)""0 1
;""1 2
foreach## 
(## 
var##  
line##! %
in##& (
File##) -
.##- .
ReadAllLines##. :
(##: ;
ZipFilePath##; F
)##F G
)##G H
{$$ 
var%% 
trimmed%% #
=%%$ %
StringHelper%%& 2
.%%2 3
Trim%%3 7
(%%7 8
line%%8 <
)%%< =
;%%= >
if&& 
(&& 
string&& "
.&&" #
IsNullOrEmpty&&# 0
(&&0 1
trimmed&&1 8
)&&8 9
)&&9 :
continue&&; C
;&&C D
list'' 
.'' 
Add''  
(''  !
trimmed''! (
)''( )
;'') *
}(( 
	LogHelper)) 
.)) 
AddLog)) $
())$ %
db))% '
,))' (
LogType))) 0
.))0 1
DataProcessing))1 ?
,))? @
OrderNumber))A L
,))L M
ZipCodeFile** #
+**$ %
$str**& ?
)**? @
;**@ A
try-- 
{.. 
var// 
data//  
=//! "
SegmentDataManager//# 5
.//5 6
FetchSegmentsData//6 G
(//G H
new//H K
SegmentParameters//L ]
(//] ^
)//^ _
{00 
DataQuantity11 (
=11) *
DataQuantity11+ 7
,117 8
CustomerCode22 (
=22) *
SegmentDataManager22+ =
.22= >
CustomerCode22> J
,22J K
ZipCodes33 $
=33% &
list33' +
}44 
)44 
;44 
string55 
fileName55 '
=55( )
string55* 0
.550 1
Format551 7
(557 8
$str558 J
,55J K
OrderNumber55L W
)55W X
;55X Y
var66 
filePath66 $
=66% &
string66' -
.66- .
Format66. 4
(664 5
$str665 ?
,66? @

UploadPath66A K
,66K L
fileName66M U
)66U V
;66V W
data77 
.77 
ToCsv77 "
(77" #
filePath77# +
,77+ ,
new77- 0
CsvDefinition771 >
(77> ?
)77? @
{88 
	EndOfLine99 %
=99& '
$str99( .
,99. /
FieldSeparator:: *
=::+ ,
$char::- 0
,::0 1
TextQualifier;; )
=;;* +
$char;;, /
,;;/ 0
Columns<< #
=<<$ %
new==  #
List==$ (
<==( )
string==) /
>==/ 0
{>>  !
$str?? +
,??+ ,
$str@@ '
,@@' (
$strAA &
,AA& '
$strBB %
,BB% &
$strCC "
,CC" #
$strDD #
,DD# $
$strEE !
,EE! "
$strFF "
,FF" #
$strGG !
,GG! "
$strHH +
,HH+ ,
$strII #
}JJ  !
}KK 
)KK 
;KK 
stringLL 
amazonFileKeyLL ,
=LL- .
stringLL/ 5
.LL5 6
FormatLL6 <
(LL< =
$strLL= N
,LLN O
OrderNumberLLP [
)LL[ \
;LL\ ]
S3FileManagerMM %
.MM% &
UploadMM& ,
(MM, -
amazonFileKeyMM- :
,MM: ;
filePathMM< D
,MMD E
trueMMF J
)MMJ K
;MMK L
	LogHelperNN !
.NN! "
AddLogNN" (
(NN( )
dbNN) +
,NN+ ,
LogTypeNN- 4
.NN4 5
DataProcessingNN5 C
,NNC D
OrderNumberNNE P
,NNP Q
amazonFileKeyOO $
+OO% &
$strOO' a
)OOa b
;OOb c
CampaignRR  
campaignRR! )
=RR* +
dbSS 
.SS 
	CampaignsSS (
.SS( )
IncludeSS) 0
(SS0 1
xSS1 2
=>SS3 5
xSS6 7
.SS7 8
SegmentsSS8 @
)SS@ A
.SSA B
FirstOrDefaultSSB P
(SSP Q
xSSQ R
=>SSS U
xSSV W
.SSW X
OrderNumberSSX c
==SSd f
OrderNumberSSg r
)SSr s
;SSs t
varUU 
campaignTestingUU +
=UU, -
dbUU. 0
.UU0 1
CampaignsTestingUU1 A
.UUA B
FirstOrDefaultUUB P
(UUP Q
xUUQ R
=>UUS U
xUUV W
.UUW X

CampaignIdUUX b
==UUc e
campaignUUf n
.UUn o
IdUUo q
)UUq r
;UUr s
campaignTestingVV '
.VV' (
DataFileUrlVV( 3
=VV4 5
amazonFileKeyVV6 C
;VVC D
campaignTestingWW '
.WW' (
DateFetchedWW( 3
=WW4 5
DateTimeWW6 >
.WW> ?
NowWW? B
;WWB C
dbXX 
.XX 
SaveChangesXX &
(XX& '
)XX' (
;XX( )
foreachZZ 
(ZZ  !
varZZ! $
segmentZZ% ,
inZZ- /
campaignZZ0 8
.ZZ8 9
SegmentsZZ9 A
.ZZA B
OrderByZZB I
(ZZI J
xZZJ K
=>ZZL N
xZZO P
.ZZP Q
SegmentNumberZZQ ^
)ZZ^ _
)ZZ_ `
{[[ 
string\\ "
	fileName1\\# ,
=\\- .
string\\/ 5
.\\5 6
Format\\6 <
(\\< =
$str\\= O
,\\O P
campaign\\Q Y
.\\Y Z
OrderNumber\\Z e
,\\e f
segment\\g n
.\\n o
SegmentNumber\\o |
)\\| }
;\\} ~
var]] 
	filePath1]]  )
=]]* +
string]], 2
.]]2 3
Format]]3 9
(]]9 :
$str]]: D
,]]D E

UploadPath]]F P
,]]P Q
	fileName1]]R [
)]][ \
;]]\ ]
var^^ 
data1^^  %
=^^& '
data__  $
.__$ %
Where__% *
(__* +
x__+ ,
=>__- /
x__0 1
.__1 2
Index__2 7
>=__8 :
segment__; B
.__B C
FirstRangeStart__C R
&&__S U
x__V W
.__W X
Index__X ]
<=__^ `
segment__a h
.__h i
FirstRangeEnd__i v
)__v w
.__w x
ToList__x ~
(__~ 
)	__ Ä
;
__Ä Å
var`` 
data2``  %
=``& '
dataaa  $
.aa$ %
Whereaa% *
(aa* +
xaa+ ,
=>aa- /
xaa0 1
.aa1 2
Indexaa2 7
>=aa8 :
segmentaa; B
.aaB C
SecondRangeStartaaC S
&&aaT V
xaaW X
.aaX Y
IndexaaY ^
<=aa_ a
segmentaab i
.aai j
SecondRangeEndaaj x
)aax y
.bb$ %
ToListbb% +
(bb+ ,
)bb, -
;bb- .
varcc 
data3cc  %
=cc& '
datadd  $
.dd$ %
Wheredd% *
(dd* +
xdd+ ,
=>dd- /
xdd0 1
.dd1 2
Indexdd2 7
>=dd8 :
segmentdd; B
.ddB C
ThirdRangeStartddC R
&&ddS U
xddV W
.ddW X
IndexddX ]
<=dd^ `
segmentdda h
.ddh i
ThirdRangeEndddi v
)ddv w
.ddw x
ToListddx ~
(dd~ 
)	dd Ä
;
ddÄ Å
data2ee !
.ee! "
AddRangeee" *
(ee* +
data3ee+ 0
)ee0 1
;ee1 2
data1ff !
.ff! "
AddRangeff" *
(ff* +
data2ff+ 0
)ff0 1
;ff1 2
data1gg !
.gg! "
ToCsvgg" '
(gg' (
	filePath1gg( 1
,gg1 2
newgg3 6
CsvDefinitiongg7 D
(ggD E
)ggE F
{hh 
	EndOfLineii  )
=ii* +
$strii, 2
,ii2 3
FieldSeparatorjj  .
=jj/ 0
$charjj1 4
,jj4 5
TextQualifierkk  -
=kk. /
$charkk0 3
,kk3 4
Columnsll  '
=ll( )
newmm$ '
Listmm( ,
<mm, -
stringmm- 3
>mm3 4
{nn$ %
$stroo  /
,oo/ 0
$strpp  +
,pp+ ,
$strqq  *
,qq* +
$strrr  )
,rr) *
$strss  &
,ss& '
$strtt  '
,tt' (
$struu  %
,uu% &
$strvv  &
,vv& '
$strww  %
,ww% &
$strxx  /
,xx/ 0
$stryy  '
}zz$ %
}{{ 
){{ 
;{{ 
string|| "
amazonFileKey1||# 1
=||2 3
string||4 :
.||: ;
Format||; A
(||A B
$str||B S
,||S T
campaign||U ]
.||] ^
OrderNumber||^ i
,||i j
segment||k r
.||r s
SegmentNumber	||s Ä
)
||Ä Å
;
||Å Ç
S3FileManager}} )
.}}) *
Upload}}* 0
(}}0 1
amazonFileKey1}}1 ?
,}}? @
filePath}}A I
,}}I J
true}}K O
)}}O P
;}}P Q
segment #
.# $
SegmentDataFileUrl$ 6
=7 8
FileManager9 D
.D E
GetFilePathLiveE T
(T U
UploadFileTypeU c
.c d
DataFiled l
,l m
campaign
ÄÄ  (
.
ÄÄ( )
OrderNumber
ÄÄ) 4
,
ÄÄ4 5
string
ÄÄ6 <
.
ÄÄ< =
Empty
ÄÄ= B
,
ÄÄB C
segment
ÄÄD K
.
ÄÄK L
SegmentNumber
ÄÄL Y
)
ÄÄY Z
;
ÄÄZ [
segment
ÅÅ #
.
ÅÅ# $
DateFetched
ÅÅ$ /
=
ÅÅ0 1
DateTime
ÅÅ2 :
.
ÅÅ: ;
Now
ÅÅ; >
;
ÅÅ> ?
segment
ÇÇ #
.
ÇÇ# $
UploadStatus
ÇÇ$ 0
=
ÇÇ1 2
(
ÇÇ3 4
int
ÇÇ4 7
)
ÇÇ7 8
UploadFileStatus
ÇÇ8 H
.
ÇÇH I
	Completed
ÇÇI R
;
ÇÇR S
segment
ÉÉ #
.
ÉÉ# $
SegmentStatus
ÉÉ$ 1
=
ÉÉ2 3
(
ÉÉ4 5
int
ÉÉ5 8
)
ÉÉ8 9
SegmentStatus
ÉÉ9 F
.
ÉÉF G
	Generated
ÉÉG P
;
ÉÉP Q
	LogHelper
ÖÖ %
.
ÖÖ% &
AddLog
ÖÖ& ,
(
ÖÖ, -
db
ÖÖ- /
,
ÖÖ/ 0
LogType
ÖÖ1 8
.
ÖÖ8 9
DataProcessing
ÖÖ9 G
,
ÖÖG H
OrderNumber
ÖÖI T
,
ÖÖT U
amazonFileKey1
ÜÜ  .
+
ÜÜ/ 0
$str
ÜÜ1 k
)
ÜÜk l
;
ÜÜl m
}
àà 
db
ââ 
.
ââ 
SaveChanges
ââ &
(
ââ& '
)
ââ' (
;
ââ( )
	LogHelper
ãã !
.
ãã! "
AddLog
ãã" (
(
ãã( )
db
ãã) +
,
ãã+ ,
LogType
ãã- 4
.
ãã4 5
DataProcessing
ãã5 C
,
ããC D
OrderNumber
ããE P
,
ããP Q
$str
ããR z
)
ããz {
;
ãã{ |
}
åå 
catch
çç 
(
çç 
	Exception
çç $
ex
çç% '
)
çç' (
{
éé 
	LogHelper
èè !
.
èè! "
AddError
èè" *
(
èè* +
db
èè+ -
,
èè- .
LogType
èè/ 6
.
èè6 7
DataProcessing
èè7 E
,
èèE F
OrderNumber
èèG R
,
èèR S
$str
èèT z
+
èè{ |
ex
èè} 
.èè Ä
MessageèèÄ á
)èèá à
;èèà â
}
êê 
}
íí 
catch
ìì 
(
ìì 
	Exception
ìì  
ex
ìì! #
)
ìì# $
{
îî 
	LogHelper
ïï 
.
ïï 
AddError
ïï &
(
ïï& '
db
ïï' )
,
ïï) *
LogType
ïï+ 2
.
ïï2 3
DataProcessing
ïï3 A
,
ïïA B
OrderNumber
ïïC N
,
ïïN O
$str
ïïP c
+
ïïd e
ZipCodeFile
ïïf q
+
ïïr s
$str
ïït w
+
ïïx y
ex
ïïz |
.
ïï| }
Messageïï} Ñ
)ïïÑ Ö
;ïïÖ Ü
}
ññ 
}
óó 
}
òò 	
}
ôô 
}öö ˛æ
EE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\MailChimpProcessor.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Async 
{ 
public 

class 
MailChimpProcessor #
{ 
public 
MailChimpProcessor !
(! "
)" #
{ 	
} 	
public 
static 
void 
QucikTestSend (
(( )

CreativeVM) 3
model4 9
)9 :
{ 	
string 

campaignId !
=" #$
CreateCampignWithContent$ <
(< =
model= B
)B C
;C D!
QuickTestSendCampaign %
(% &
model& +
,+ ,

campaignId- 7
,7 8
model9 >
.> ?
QuickTestEmails? N
.N O
SplitO T
(T U
$strU X
.X Y
ToCharArrayY d
(d e
)e f
)f g
)g h
;h i
} 	
private 
static 
void !
QuickTestSendCampaign 1
(1 2

CreativeVM2 <
model= B
,B C
stringD J

campaignIdK U
,U V
stringW ]
[] ^
]^ _

testEmails` j
)j k
{   	
IMailChimpManager!! 
manager!! %
=!!& '
new!!( +
MailChimpManager!!, <
(!!< =
)!!= >
;!!> ?
var"" 
testSend"" 
="" 
manager"" "
.""" #
	Campaigns""# ,
."", -
	TestAsync""- 6
(""6 7

campaignId""7 A
,""A B
new""C F
CampaignTestRequest""G Z
{## 
Emails%% 
=%% 

testEmails%% #
,%%# $
	EmailType&& 
=&& 
$str&& "
}'' 
)'' 
.'' 
ConfigureAwait'' 
('' 
false'' #
)''# $
;''$ %
})) 	
public++ 
static++ 
void++ 
TestSend++ #
(++# $

CreativeVM++$ .
model++/ 4
)++4 5
{,, 	
using-- 
(-- 
var-- 
db-- 
=-- 
new-- 
WfpictContext--  -
(--- .
)--. /
)--/ 0
{.. 
var// 
logs// 
=// 
db// 
.// 

SystemLogs// (
.//( )
Where//) .
(//. /
x/// 0
=>//1 3
x//4 5
.//5 6
OrderNumber//6 A
==//B D
model//E J
.//J K
OrderNumber//K V
&&//W Y
x//Z [
.//[ \
LogType//\ c
==//d f
(//g h
int//h k
)//k l
LogType//l s
.//s t
	MailChimp//t }
)//} ~
;//~ 
foreach00 
(00 
var00 
log00  
in00! #
logs00$ (
)00( )
{11 
db22 
.22 

SystemLogs22 !
.22! "
Remove22" (
(22( )
log22) ,
)22, -
;22- .
}33 
db44 
.44 
SaveChanges44 
(44 
)44  
;44  !
	LogHelper66 
.66 
AddLog66  
(66  !
db66! #
,66# $
LogType66% ,
.66, -
	MailChimp66- 6
,666 7
model668 =
.66= >
OrderNumber66> I
,66I J
$str66K p
+66q r
model66s x
.66x y
OrderNumber	66y Ñ
)
66Ñ Ö
;
66Ö Ü
string77 
listId77 
=77 

CreateList77  *
(77* +
db77+ -
,77- .
model77/ 4
)774 5
;775 6
CreateMembers88 
(88 
db88  
,88  !
listId88" (
,88( )
model88* /
)88/ 0
;880 1
Thread;; 
.;; 
Sleep;; 
(;; 
$num;; !
*;;" #
$num;;$ &
*;;' (
$num;;) *
);;* +
;;;+ ,
int>> 

templateId>> 
=>>  
CreateTemplate>>! /
(>>/ 0
db>>0 2
,>>2 3
model>>4 9
)>>9 :
;>>: ;
string@@ 

campaignId@@ !
=@@" #%
CreateCampignWithTemplate@@$ =
(@@= >
db@@> @
,@@@ A
model@@B G
,@@G H
listId@@I O
,@@O P

templateId@@Q [
)@@[ \
;@@\ ]
SendCampaignBB 
(BB 
dbBB 
,BB  
modelBB! &
,BB& '

campaignIdBB( 2
)BB2 3
;BB3 4
	LogHelperDD 
.DD 
AddLogDD  
(DD  !
dbDD! #
,DD# $
LogTypeDD% ,
.DD, -
	MailChimpDD- 6
,DD6 7
modelDD8 =
.DD= >
OrderNumberDD> I
,DDI J
$strDDK n
)DDn o
;DDo p
}EE 
}FF 	
privateHH 
staticHH 
voidHH 
SendCampaignHH (
(HH( )
WfpictContextHH) 6
dbHH7 9
,HH9 :

CreativeVMHH; E
modelHHF K
,HHK L
stringHHM S

campaignIdHHT ^
)HH^ _
{II 	
IMailChimpManagerJJ 
managerJJ %
=JJ& '
newJJ( +
MailChimpManagerJJ, <
(JJ< =
)JJ= >
;JJ> ?
	LogHelperKK 
.KK 
AddLogKK 
(KK 
dbKK 
,KK  
LogTypeKK! (
.KK( )
	MailChimpKK) 2
,KK2 3
modelKK4 9
.KK9 :
OrderNumberKK: E
,KKE F
$strKKG ]
)KK] ^
;KK^ _
varLL 
sentLL 
=LL 
managerLL 
.LL 
	CampaignsLL (
.LL( )
	SendAsyncLL) 2
(LL2 3

campaignIdLL3 =
)LL= >
.LL> ?
ConfigureAwaitLL? M
(LLM N
falseLLN S
)LLS T
;LLT U
}NN 	
privatePP 
staticPP 
stringPP $
CreateCampignWithContentPP 6
(PP6 7

CreativeVMPP7 A
modelPPB G
)PPG H
{QQ 	
IMailChimpManagerRR 
managerRR %
=RR& '
newRR( +
MailChimpManagerRR, <
(RR< =
)RR= >
;RR> ?
varTT 
campaignTT 
=TT 
managerTT "
.TT" #
	CampaignsTT# ,
.TT, -
AddAsyncTT- 5
(TT5 6
newTT6 9
	MailChimpTT: C
.TTC D
NetTTD G
.TTG H
ModelsTTH N
.TTN O
CampaignTTO W
{UU 
SettingsVV 
=VV 
newVV 
SettingVV &
{WW 
ReplyToXX 
=XX 
$strXX <
,XX< =
TitleYY 
=YY 
modelYY !
.YY! "
SubjectLineYY" -
,YY- .
FromNameZZ 
=ZZ 
$strZZ ,
,ZZ, -
SubjectLine[[ 
=[[  !
model[[" '
.[[' (
SubjectLine[[( 3
,[[3 4
}\\ 
,\\ 
Type]] 
=]] 
CampaignType]] #
.]]# $
Regular]]$ +
,]]+ ,
}^^ 
)^^ 
.^^ 
ConfigureAwait^^ 
(^^ 
false^^ #
)^^# $
;^^$ %
var`` 

campaignId`` 
=`` 
campaign`` %
.``% &

GetAwaiter``& 0
(``0 1
)``1 2
.``2 3
	GetResult``3 <
(``< =
)``= >
.``> ?
Id``? A
;``A B
varbb 
contentbb 
=bb 
newbb 
ContentRequestbb ,
{cc 
Htmlee 
=ee 
modelee 
.ee 
	Creativesee &
,ee& '
}ff 
;ff 
managergg 
.gg 
Contentgg 
.gg 
AddOrUpdateAsyncgg ,
(gg, -

campaignIdgg- 7
,gg7 8
contentgg9 @
)gg@ A
;ggA B
returnhh 

campaignIdhh 
;hh 
}ii 	
privatekk 
statickk 
stringkk %
CreateCampignWithTemplatekk 7
(kk7 8
WfpictContextkk8 E
dbkkF H
,kkH I

CreativeVMkkJ T
modelkkU Z
,kkZ [
stringkk\ b
listIdkkc i
,kki j
intkkk n

templateIdkko y
)kky z
{ll 	
IMailChimpManagermm 
managermm %
=mm& '
newmm( +
MailChimpManagermm, <
(mm< =
)mm= >
;mm> ?
	LogHelpernn 
.nn 
AddLognn 
(nn 
dbnn 
,nn  
LogTypenn! (
.nn( )
	MailChimpnn) 2
,nn2 3
modelnn4 9
.nn9 :
OrderNumbernn: E
,nnE F
$strnnG h
)nnh i
;nni j
varoo 
campaignoo 
=oo 
manageroo "
.oo" #
	Campaignsoo# ,
.oo, -
AddAsyncoo- 5
(oo5 6
newoo6 9
	MailChimpoo: C
.ooC D
NetooD G
.ooG H
ModelsooH N
.ooN O
CampaignooO W
{pp 

Recipientsqq 
=qq 
newqq  
	Recipientqq! *
{rr 
ListIdss 
=ss 
listIdss #
}tt 
,tt 
Settingsuu 
=uu 
newuu 
Settinguu &
{vv 
ReplyToww 
=ww 
$strww <
,ww< =
Titlexx 
=xx 
modelxx !
.xx! "
SubjectLinexx" -
,xx- .
FromNameyy 
=yy 
$stryy ,
,yy, -
SubjectLinezz 
=zz  !
modelzz" '
.zz' (
SubjectLinezz( 3
,zz3 4

TemplateId{{ 
={{  

templateId{{! +
,{{+ ,
}|| 
,|| 
Type}} 
=}} 
CampaignType}} #
.}}# $
Regular}}$ +
,}}+ ,
}~~ 
)~~ 
.~~ 
ConfigureAwait~~ 
(~~ 
false~~ #
)~~# $
;~~$ %
var
ÄÄ 

campaignId
ÄÄ 
=
ÄÄ 
campaign
ÄÄ %
.
ÄÄ% &

GetAwaiter
ÄÄ& 0
(
ÄÄ0 1
)
ÄÄ1 2
.
ÄÄ2 3
	GetResult
ÄÄ3 <
(
ÄÄ< =
)
ÄÄ= >
.
ÄÄ> ?
Id
ÄÄ? A
;
ÄÄA B
return
ÅÅ 

campaignId
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
private
ÑÑ 
static
ÑÑ 
int
ÑÑ 
CreateTemplate
ÑÑ )
(
ÑÑ) *
WfpictContext
ÑÑ* 7
db
ÑÑ8 :
,
ÑÑ: ;

CreativeVM
ÑÑ< F
model
ÑÑG L
)
ÑÑL M
{
ÖÖ 	
IMailChimpManager
ÜÜ 
manager
ÜÜ %
=
ÜÜ& '
new
ÜÜ( +
MailChimpManager
ÜÜ, <
(
ÜÜ< =
)
ÜÜ= >
;
ÜÜ> ?
	LogHelper
áá 
.
áá 
AddLog
áá 
(
áá 
db
áá 
,
áá  
LogType
áá! (
.
áá( )
	MailChimp
áá) 2
,
áá2 3
model
áá4 9
.
áá9 :
OrderNumber
áá: E
,
ááE F
$str
ááG i
)
áái j
;
ááj k
var
àà !
allTemplatesRequest
àà #
=
àà$ %
manager
àà& -
.
àà- .
	Templates
àà. 7
.
àà7 8
GetAllAsync
àà8 C
(
ààC D
)
ààD E
.
ààE F
ConfigureAwait
ààF T
(
ààT U
false
ààU Z
)
ààZ [
;
àà[ \
var
ââ 
allTemplates
ââ 
=
ââ !
allTemplatesRequest
ââ 2
.
ââ2 3

GetAwaiter
ââ3 =
(
ââ= >
)
ââ> ?
.
ââ? @
	GetResult
ââ@ I
(
ââI J
)
ââJ K
;
ââK L
int
ää 
templateIdOld
ää 
=
ää 
-
ää  !
$num
ää! "
;
ää" #
foreach
ãã 
(
ãã 
var
ãã 
allTemplate
ãã $
in
ãã% '
allTemplates
ãã( 4
)
ãã4 5
{
åå 
if
çç 
(
çç 
allTemplate
çç 
.
çç  
Name
çç  $
==
çç% '
model
çç( -
.
çç- .
OrderNumber
çç. 9
)
çç9 :
{
éé 
templateIdOld
èè !
=
èè" #
allTemplate
èè$ /
.
èè/ 0
Id
èè0 2
;
èè2 3
break
êê 
;
êê 
}
ëë 
}
íí 
if
ìì 
(
ìì 
templateIdOld
ìì 
!=
ìì  
-
ìì! "
$num
ìì" #
)
ìì# $
{
îî 
	LogHelper
ïï 
.
ïï 
AddLog
ïï  
(
ïï  !
db
ïï! #
,
ïï# $
LogType
ïï% ,
.
ïï, -
	MailChimp
ïï- 6
,
ïï6 7
model
ïï8 =
.
ïï= >
OrderNumber
ïï> I
,
ïïI J
$str
ïïK V
+
ïïW X
model
ïïY ^
.
ïï^ _
OrderNumber
ïï_ j
+
ïïk l
$strïïm ë
)ïïë í
;ïïí ì
var
ññ #
deleteTemplateRequest
ññ )
=
ññ* +
manager
ññ, 3
.
ññ3 4
	Templates
ññ4 =
.
ññ= >
DeleteAsync
ññ> I
(
ññI J
templateIdOld
ññJ W
.
ññW X
ToString
ññX `
(
ññ` a
)
ñña b
)
ññb c
.
ññc d
ConfigureAwait
ññd r
(
ññr s
false
ññs x
)
ññx y
;
ññy z
}
óó 
var
ôô 
template
ôô 
=
ôô 
manager
ôô "
.
ôô" #
	Templates
ôô# ,
.
ôô, -
CreateAsync
ôô- 8
(
ôô8 9
model
ôô9 >
.
ôô> ?
OrderNumber
ôô? J
,
ôôJ K
$str
ôôL N
,
ôôN O
model
ôôP U
.
ôôU V
	Creatives
ôôV _
)
ôô_ `
.
ôô` a
ConfigureAwait
ôôa o
(
ôôo p
false
ôôp u
)
ôôu v
;
ôôv w
var
öö 

templateId
öö 
=
öö 
template
öö %
.
öö% &

GetAwaiter
öö& 0
(
öö0 1
)
öö1 2
.
öö2 3
	GetResult
öö3 <
(
öö< =
)
öö= >
.
öö> ?
Id
öö? A
;
ööA B
	LogHelper
õõ 
.
õõ 
AddLog
õõ 
(
õõ 
db
õõ 
,
õõ  
LogType
õõ! (
.
õõ( )
	MailChimp
õõ) 2
,
õõ2 3
model
õõ4 9
.
õõ9 :
OrderNumber
õõ: E
,
õõE F
$str
õõG q
)
õõq r
;
õõr s
return
úú 

templateId
úú 
;
úú 
}
ùù 	
private
üü 
static
üü 
void
üü "
CreateTemplateFolder
üü 0
(
üü0 1

CreativeVM
üü1 ;
model
üü< A
)
üüA B
{
†† 	
IMailChimpManager
°° 
manager
°° %
=
°°& '
new
°°( +
MailChimpManager
°°, <
(
°°< =
)
°°= >
;
°°> ?
var
¢¢ 
folder
¢¢ 
=
¢¢ 
manager
¢¢ 
.
¢¢  
TemplateFolders
¢¢  /
.
¢¢/ 0
AddAsync
¢¢0 8
(
¢¢8 9
model
¢¢9 >
.
¢¢> ?
OrderNumber
¢¢? J
)
¢¢J K
.
¢¢K L
ConfigureAwait
¢¢L Z
(
¢¢Z [
false
¢¢[ `
)
¢¢` a
;
¢¢a b
var
££ 
folderStatus
££ 
=
££ 
folder
££ %
.
££% &

GetAwaiter
££& 0
(
££0 1
)
££1 2
.
££2 3
	GetResult
££3 <
(
££< =
)
££= >
;
££> ?
}
§§ 	
private
¶¶ 
static
¶¶ 
void
¶¶ 
CreateMembers
¶¶ )
(
¶¶) *
WfpictContext
¶¶* 7
db
¶¶8 :
,
¶¶: ;
string
¶¶< B
listId
¶¶C I
,
¶¶I J

CreativeVM
¶¶K U
model
¶¶V [
)
¶¶[ \
{
ßß 	
IMailChimpManager
®® 
manager
®® %
=
®®& '
new
®®( +
MailChimpManager
®®, <
(
®®< =
)
®®= >
;
®®> ?
	LogHelper
©© 
.
©© 
AddLog
©© 
(
©© 
db
©© 
,
©©  
LogType
©©! (
.
©©( )
	MailChimp
©©) 2
,
©©2 3
model
©©4 9
.
©©9 :
OrderNumber
©©: E
,
©©E F
$str
©©G Y
)
©©Y Z
;
©©Z [
foreach
™™ 
(
™™ 
var
™™ 
email
™™ 
in
™™ !
model
™™" '
.
™™' (

TestEmails
™™( 2
)
™™2 3
{
´´ 
var
¨¨ 
member
¨¨ 
=
¨¨ 
new
¨¨  
Member
¨¨! '
{
¨¨( )
EmailAddress
¨¨* 6
=
¨¨7 8
email
¨¨9 >
.
¨¨> ?
Text
¨¨? C
,
¨¨C D
StatusIfNew
¨¨E P
=
¨¨Q R
Status
¨¨S Y
.
¨¨Y Z

Subscribed
¨¨Z d
}
¨¨e f
;
¨¨f g
var
≠≠ 
memberResult
≠≠  
=
≠≠! "
manager
≠≠# *
.
≠≠* +
Members
≠≠+ 2
.
≠≠2 3
AddOrUpdateAsync
≠≠3 C
(
≠≠C D
listId
≠≠D J
,
≠≠J K
member
≠≠L R
)
≠≠R S
.
≠≠S T
ConfigureAwait
≠≠T b
(
≠≠b c
false
≠≠c h
)
≠≠h i
;
≠≠i j
var
ÆÆ 
result
ÆÆ 
=
ÆÆ 
memberResult
ÆÆ )
.
ÆÆ) *

GetAwaiter
ÆÆ* 4
(
ÆÆ4 5
)
ÆÆ5 6
.
ÆÆ6 7
	GetResult
ÆÆ7 @
(
ÆÆ@ A
)
ÆÆA B
;
ÆÆB C
var
∞∞ 
exists
∞∞ 
=
∞∞ 
manager
∞∞ $
.
∞∞$ %
Members
∞∞% ,
.
∞∞, -
ExistsAsync
∞∞- 8
(
∞∞8 9
listId
∞∞9 ?
,
∞∞? @
email
∞∞A F
.
∞∞F G
Text
∞∞G K
)
∞∞K L
.
∞∞L M
Result
∞∞M S
;
∞∞S T
}
±± 
	LogHelper
≤≤ 
.
≤≤ 
AddLog
≤≤ 
(
≤≤ 
db
≤≤ 
,
≤≤  
LogType
≤≤! (
.
≤≤( )
	MailChimp
≤≤) 2
,
≤≤2 3
model
≤≤4 9
.
≤≤9 :
OrderNumber
≤≤: E
,
≤≤E F
$str
≤≤G f
)
≤≤f g
;
≤≤g h
}
≥≥ 	
private
µµ 
static
µµ 
string
µµ 

CreateList
µµ (
(
µµ( )
WfpictContext
µµ) 6
db
µµ7 9
,
µµ9 :

CreativeVM
µµ; E
model
µµF K
)
µµK L
{
∂∂ 	
bool
∑∑ 
isListExists
∑∑ 
=
∑∑ 
false
∑∑  %
;
∑∑% &
string
∏∏ 
listId
∏∏ 
=
∏∏ 
string
∏∏ "
.
∏∏" #
Empty
∏∏# (
;
∏∏( )
IMailChimpManager
ππ 
manager
ππ %
=
ππ& '
new
ππ( +
MailChimpManager
ππ, <
(
ππ< =
)
ππ= >
;
ππ> ?
var
∫∫ 
lists
∫∫ 
=
∫∫ 
manager
∫∫ 
.
∫∫  
Lists
∫∫  %
.
∫∫% &
GetAllAsync
∫∫& 1
(
∫∫1 2
)
∫∫2 3
.
∫∫3 4
ConfigureAwait
∫∫4 B
(
∫∫B C
false
∫∫C H
)
∫∫H I
;
∫∫I J
foreach
ªª 
(
ªª 
var
ªª 
list
ªª 
in
ªª  
lists
ªª! &
.
ªª& '

GetAwaiter
ªª' 1
(
ªª1 2
)
ªª2 3
.
ªª3 4
	GetResult
ªª4 =
(
ªª= >
)
ªª> ?
)
ªª? @
{
ºº 
if
ΩΩ 
(
ΩΩ 
list
ΩΩ 
.
ΩΩ 
Name
ΩΩ 
==
ΩΩ  
model
ΩΩ! &
.
ΩΩ& '
OrderNumber
ΩΩ' 2
)
ΩΩ2 3
{
ææ 
isListExists
øø  
=
øø! "
true
øø# '
;
øø' (
listId
¿¿ 
=
¿¿ 
list
¿¿ !
.
¿¿! "
Id
¿¿" $
;
¿¿$ %
break
¡¡ 
;
¡¡ 
}
¬¬ 
}
√√ 
if
≈≈ 
(
≈≈ 
isListExists
≈≈ 
)
≈≈ 
{
∆∆ 
	LogHelper
«« 
.
«« 
AddLog
««  
(
««  !
db
««! #
,
««# $
LogType
««% ,
.
««, -
	MailChimp
««- 6
,
««6 7
model
««8 =
.
««= >
OrderNumber
««> I
,
««I J
$str
««K R
+
««S T
model
««U Z
.
««Z [
OrderNumber
««[ f
+
««g h
$str
««i {
)
««{ |
;
««| }
}
»» 
else
…… 
{
   
	LogHelper
ÀÀ 
.
ÀÀ 
AddLog
ÀÀ  
(
ÀÀ  !
db
ÀÀ! #
,
ÀÀ# $
LogType
ÀÀ% ,
.
ÀÀ, -
	MailChimp
ÀÀ- 6
,
ÀÀ6 7
model
ÀÀ8 =
.
ÀÀ= >
OrderNumber
ÀÀ> I
,
ÀÀI J
$str
ÀÀK Z
)
ÀÀZ [
;
ÀÀ[ \
var
ÃÃ 
testList
ÃÃ 
=
ÃÃ 
manager
ÃÃ &
.
ÃÃ& '
Lists
ÃÃ' ,
.
ÃÃ, -
AddOrUpdateAsync
ÃÃ- =
(
ÃÃ= >
new
ÕÕ 
List
ÕÕ  
(
ÕÕ  !
)
ÕÕ! "
{
ŒŒ 
Name
œœ  
=
œœ! "
model
œœ# (
.
œœ( )
OrderNumber
œœ) 4
,
œœ4 5 
PermissionReminder
–– .
=
––/ 0
$str
––1 7
,
––7 8
Contact
—— #
=
——$ %
new
——& )
Contact
——* 1
{
““ 
Address1
””  (
=
””) *
$str
””+ 1
,
””1 2
City
‘‘  $
=
‘‘% &
$str
‘‘' 3
,
‘‘3 4
Country
’’  '
=
’’( )
$str
’’* /
,
’’/ 0
State
÷÷  %
=
÷÷& '
$str
÷÷( ,
,
÷÷, -
Zip
◊◊  #
=
◊◊$ %
$str
◊◊& -
,
◊◊- .
Company
ÿÿ  '
=
ÿÿ( )
$str
ÿÿ* 0
}
ŸŸ 
,
ŸŸ 
CampaignDefaults
⁄⁄ ,
=
⁄⁄- .
new
⁄⁄/ 2
CampaignDefaults
⁄⁄3 C
{
€€ 
	FromEmail
‹‹  )
=
‹‹* +
$str
‹‹, K
,
‹‹K L
FromName
››  (
=
››) *
model
››+ 0
.
››0 1
FromLine
››1 9
,
››9 :
Language
ﬁﬁ  (
=
ﬁﬁ) *
$str
ﬁﬁ+ /
,
ﬁﬁ/ 0
Subject
ﬂﬂ  '
=
ﬂﬂ( )
model
ﬂﬂ* /
.
ﬂﬂ/ 0
SubjectLine
ﬂﬂ0 ;
}
‡‡ 
}
·· 
)
·· 
.
·· 
ConfigureAwait
·· )
(
··) *
false
··* /
)
··/ 0
;
··0 1
var
‚‚ 
list
‚‚ 
=
‚‚ 
testList
‚‚ #
.
‚‚# $

GetAwaiter
‚‚$ .
(
‚‚. /
)
‚‚/ 0
.
‚‚0 1
	GetResult
‚‚1 :
(
‚‚: ;
)
‚‚; <
;
‚‚< =
listId
„„ 
=
„„ 
list
„„ 
.
„„ 
Id
„„  
;
„„  !
	LogHelper
‰‰ 
.
‰‰ 
AddLog
‰‰  
(
‰‰  !
db
‰‰! #
,
‰‰# $
LogType
‰‰% ,
.
‰‰, -
	MailChimp
‰‰- 6
,
‰‰6 7
model
‰‰8 =
.
‰‰= >
OrderNumber
‰‰> I
,
‰‰I J
$str
‰‰K g
)
‰‰g h
;
‰‰h i
}
ÂÂ 
return
ÁÁ 
listId
ÁÁ 
;
ÁÁ 
}
ËË 	
}
ÎÎ 
}ÏÏ ¬
BE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\ProData\ProDataHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
ProData 
{ 
public 

static 
class 
ProDataHelper %
{		 
public

 
static

 
int

 
GetIndex

 "
(

" #
string

# )
ReportSiteURL

* 7
)

7 8
{ 	
var 
parts 
= 
ReportSiteURL %
.% &
Split& +
(+ ,
$char, /
)/ 0
;0 1
return 
int 
. 
Parse 
( 
parts "
[" #
parts# (
.( )
Length) /
-0 1
$num2 3
]3 4
)4 5
;5 6
} 	
} 
} óí
JE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\AccountController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
AccountController "
:# $
BaseController% 3
{ 
private "
ApplicationUserManager &
_userManager' 3
;3 4
private $
ApplicationSignInManager (
_signInManager) 7
;7 8
public 
AccountController  
(  !
)! "
{ 	
} 	
public 
AccountController  
(  !"
ApplicationUserManager! 7
userManager8 C
,C D$
ApplicationSignInManagerE ]
signInManager^ k
)l m
{ 	
UserManager 
= 
userManager %
;% &
SignInManager 
= 
signInManager )
;) *
} 	
public   "
ApplicationUserManager   %
UserManager  & 1
{!! 	
get"" 
{## 
return$$ 
_userManager$$ #
??$$$ &
HttpContext$$' 2
.$$2 3
GetOwinContext$$3 A
($$A B
)$$B C
.$$C D
GetUserManager$$D R
<$$R S"
ApplicationUserManager$$S i
>$$i j
($$j k
)$$k l
;$$l m
}%% 
set&& 
{'' 
_userManager(( 
=(( 
value(( $
;(($ %
})) 
}** 	
public,, $
ApplicationSignInManager,, '
SignInManager,,( 5
{-- 	
get.. 
{// 
return00 
_signInManager00 %
??00& (
HttpContext00) 4
.004 5
GetOwinContext005 C
(00C D
)00D E
.00E F
Get00F I
<00I J$
ApplicationSignInManager00J b
>00b c
(00c d
)00d e
;00e f
}11 
private22 
set22 
{33 
_signInManager44 
=44  
value44! &
;44& '
}55 
}66 	
[:: 	
AllowAnonymous::	 
]:: 
public;; 
ActionResult;; 
Login;; !
(;;! "
string;;" (
	returnUrl;;) 2
);;2 3
{<< 	
ViewBag== 
.== 
	ReturnUrl== 
=== 
	returnUrl==  )
;==) *
if>> 
(>> 
LoggedInUser>> 
!=>> 
null>>  $
)>>$ %
{?? 
if@@ 
(@@ 
	returnUrl@@ 
!=@@  
null@@! %
)@@% &
returnAA 
RedirectAA #
(AA# $
	returnUrlAA$ -
)AA- .
;AA. /
elseBB 
returnCC 
RedirectToActionCC +
(CC+ ,
$strCC, 3
,CC3 4
$strCC5 ;
)CC; <
;CC< =
}DD 
elseEE 
returnFF 
ViewFF 
(FF 
)FF 
;FF 
}GG 	
[KK 	
HttpPostKK	 
]KK 
[LL 	
AllowAnonymousLL	 
]LL 
[MM 	$
ValidateAntiForgeryTokenMM	 !
]MM! "
publicNN 
asyncNN 
TaskNN 
<NN 
ActionResultNN &
>NN& '
LoginNN( -
(NN- .
LoginViewModelNN. <
modelNN= B
,NNB C
stringNND J
	returnUrlNNK T
)NNT U
{OO 	
tryRR 
{SS 
ifTT 
(TT 
!TT 

ModelStateTT 
.TT  
IsValidTT  '
)TT' (
{UU 
StringBuilderVV !
errorsVV" (
=VV) *
newVV+ .
StringBuilderVV/ <
(VV< =
)VV= >
;VV> ?
foreachWW 
(WW 
varWW  
msWW! #
inWW$ &

ModelStateWW' 1
.WW1 2
ValuesWW2 8
)WW8 9
{XX 
foreachYY 
(YY  !
varYY! $
errorYY% *
inYY+ -
msYY. 0
.YY0 1
ErrorsYY1 7
)YY7 8
{ZZ 
errors[[ "
.[[" #
Append[[# )
([[) *
$"[[* ,
{[[, -
error[[- 2
.[[2 3
ErrorMessage[[3 ?
}[[? @
<br/>[[@ E
"[[E F
)[[F G
;[[G H
}\\ 
}]] 
if^^ 
(^^ 
!^^ 
string^^ 
.^^  
IsNullOrEmpty^^  -
(^^- .
errors^^. 4
.^^4 5
ToString^^5 =
(^^= >
)^^> ?
)^^? @
)^^@ A
throw__ 
new__ !
AdsException__" .
(__. /
errors__/ 5
.__5 6
ToString__6 >
(__> ?
)__? @
)__@ A
;__A B
}`` 
varbb 
resultbb 
=bb 
awaitbb "
SignInManagerbb# 0
.bb0 1
PasswordSignInAsyncbb1 D
(bbD E
modelbbE J
.bbJ K
UsernamebbK S
,bbS T
modelbbU Z
.bbZ [
Passwordbb[ c
,bbc d
modelbbe j
.bbj k

RememberMebbk u
,bbu v
shouldLockout	bbw Ñ
:
bbÑ Ö
false
bbÜ ã
)
bbã å
;
bbå ç
switchcc 
(cc 
resultcc 
)cc 
{dd 
caseee 
SignInStatusee %
.ee% &
Successee& -
:ee- .
SetupLoggedInUserff )
(ff) *
modelff* /
.ff/ 0
Usernameff0 8
)ff8 9
;ff9 :
returngg 
Jsongg #
(gg# $
newgg$ '
JsonResponsegg( 4
(gg4 5
)gg5 6
{gg7 8
IsSucessgg9 A
=ggB C
trueggD H
}ggI J
,ggJ K
JsonRequestBehaviorggL _
.gg_ `
AllowGetgg` h
)ggh i
;ggi j
caseii 
SignInStatusii %
.ii% & 
RequiresVerificationii& :
:ii: ;
returnss 
RedirectToLocalss .
(ss. /
	returnUrlss/ 8
)ss8 9
;ss9 :
casevv 
SignInStatusvv %
.vv% &
	LockedOutvv& /
:vv/ 0
throwww 
newww !
AdsExceptionww" .
(ww. /
$strww/ ?
)ww? @
;ww@ A
caseyy 
SignInStatusyy %
.yy% &
Failureyy& -
:yy- .
throwzz 
newzz !
AdsExceptionzz" .
(zz. /
$strzz/ S
)zzS T
;zzT U
default{{ 
:{{ 
throw|| 
new|| !
AdsException||" .
(||. /
$str||/ S
)||S T
;||T U
} 
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÉÉ 
return
ÑÑ 
Json
ÑÑ 
(
ÑÑ 
new
ÑÑ 
JsonResponse
ÑÑ  ,
(
ÑÑ, -
)
ÑÑ- .
{
ÑÑ/ 0
IsSucess
ÑÑ1 9
=
ÑÑ: ;
false
ÑÑ< A
,
ÑÑA B
ErrorMessage
ÑÑC O
=
ÑÑP Q
ex
ÑÑR T
.
ÑÑT U
Message
ÑÑU \
}
ÑÑ] ^
,
ÑÑ^ _!
JsonRequestBehavior
ÑÑ` s
.
ÑÑs t
AllowGet
ÑÑt |
)
ÑÑ| }
;
ÑÑ} ~
}
ÖÖ 
}
ÜÜ 	
[
åå 	
	Authorize
åå	 
]
åå 
public
çç 
ActionResult
çç 
LogOff
çç "
(
çç" #
)
çç# $
{
éé 	
Session
èè 
.
èè 
Clear
èè 
(
èè 
)
èè 
;
èè 
Session
êê 
.
êê 
Abandon
êê 
(
êê 
)
êê 
;
êê #
AuthenticationManager
ëë !
.
ëë! "
SignOut
ëë" )
(
ëë) *(
DefaultAuthenticationTypes
ëë* D
.
ëëD E
ApplicationCookie
ëëE V
)
ëëV W
;
ëëW X
return
íí 
RedirectToAction
íí #
(
íí# $
$str
íí$ +
,
íí+ ,
$str
íí- 6
)
íí6 7
;
íí7 8
}
ìì 	
[
¬¬ 	
AllowAnonymous
¬¬	 
]
¬¬ 
public
√√ 
ActionResult
√√ 
Register
√√ $
(
√√$ %
)
√√% &
{
ƒƒ 	
ViewBag
≈≈ 
.
≈≈ 

WhiteLabel
≈≈ 
=
≈≈  
new
≈≈! $

SelectList
≈≈% /
(
≈≈/ 0
CustomersList
≈≈0 =
,
≈≈= >
$str
≈≈? F
,
≈≈F G
$str
≈≈H N
)
≈≈N O
;
≈≈O P
return
∆∆ 
View
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
}
«« 	
[
ÀÀ 	
HttpPost
ÀÀ	 
]
ÀÀ 
[
ÃÃ 	
AllowAnonymous
ÃÃ	 
]
ÃÃ 
[
ÕÕ 	&
ValidateAntiForgeryToken
ÕÕ	 !
]
ÕÕ! "
public
ŒŒ 
async
ŒŒ 
Task
ŒŒ 
<
ŒŒ 
ActionResult
ŒŒ &
>
ŒŒ& '
Register
ŒŒ( 0
(
ŒŒ0 1
RegisterViewModel
ŒŒ1 B
model
ŒŒC H
)
ŒŒH I
{
œœ 	
if
–– 
(
–– 

ModelState
–– 
.
–– 
IsValid
–– "
)
––" #
{
—— 
var
’’ 
appUser
’’ 
=
’’ 
new
’’ !
WfpUser
’’" )
{
÷÷ 
Id
◊◊ 
=
◊◊ 
Guid
◊◊ 
.
◊◊ 
NewGuid
◊◊ %
(
◊◊% &
)
◊◊& '
.
◊◊' (
ToString
◊◊( 0
(
◊◊0 1
)
◊◊1 2
,
◊◊2 3
	CreatedAt
ÿÿ 
=
ÿÿ 
DateTime
ÿÿ  (
.
ÿÿ( )
Now
ÿÿ) ,
,
ÿÿ, -

WhiteLabel
ŸŸ 
=
ŸŸ  
model
ŸŸ! &
.
ŸŸ& '

WhiteLabel
ŸŸ' 1
,
ŸŸ1 2
UserName
⁄⁄ 
=
⁄⁄ 
model
⁄⁄ $
.
⁄⁄$ %
UserName
⁄⁄% -
,
⁄⁄- .
Email
€€ 
=
€€ 
model
€€ !
.
€€! "
Email
€€" '
,
€€' (
Status
‹‹ 
=
‹‹ 
(
‹‹ 
int
‹‹ !
)
‹‹! "

UserStatus
‹‹" ,
.
‹‹, -
Active
‹‹- 3
,
‹‹3 4
UserType
›› 
=
›› 
model
›› $
.
››$ %
IsAdminUser
››% 0
?
››1 2
(
››3 4
int
››4 7
)
››7 8
UserType
››8 @
.
››@ A
Admin
››A F
:
››F G
(
››H I
int
››I L
)
››L M
UserType
››M U
.
››U V
User
››V Z
,
››Z [
	IsUsesApi
ﬁﬁ 
=
ﬁﬁ 
model
ﬁﬁ  %
.
ﬁﬁ% &
	IsUsesAPI
ﬁﬁ& /
,
ﬁﬁ/ 0
IsTestsCreatives
ﬂﬂ $
=
ﬂﬂ% &
model
ﬂﬂ' ,
.
ﬂﬂ, -
IsTestsCreatives
ﬂﬂ- =
}
‡‡ 
;
‡‡ 
var
·· 
result
·· 
=
·· 
UserManager
·· (
.
··( )
CreateAsync
··) 4
(
··4 5
appUser
··5 <
,
··< =
model
··> C
.
··C D
Password
··D L
)
··L M
;
··M N
if
‚‚ 
(
‚‚ 
result
‚‚ 
.
‚‚ 
Result
‚‚ !
==
‚‚" $
IdentityResult
‚‚% 3
.
‚‚3 4
Success
‚‚4 ;
)
‚‚; <
{
„„ 
return
‰‰ 
RedirectToAction
‰‰ +
(
‰‰+ ,
$str
‰‰, 3
,
‰‰3 4
$str
‰‰5 >
)
‰‰> ?
;
‰‰? @
}
ÂÂ 
	AddErrors
ÊÊ 
(
ÊÊ 
result
ÊÊ  
.
ÊÊ  !
Result
ÊÊ! '
)
ÊÊ' (
;
ÊÊ( )
}
ÁÁ 
ViewBag
ËË 
.
ËË 

WhiteLabel
ËË 
=
ËË  
new
ËË! $

SelectList
ËË% /
(
ËË/ 0
CustomersList
ËË0 =
,
ËË= >
$str
ËË? F
,
ËËF G
$str
ËËH N
)
ËËN O
;
ËËO P
return
ÍÍ 
View
ÍÍ 
(
ÍÍ 
model
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}
ÎÎ 	
[
≈≈ 	
AllowAnonymous
≈≈	 
]
≈≈ 
public
∆∆ 
ActionResult
∆∆ "
ExternalLoginFailure
∆∆ 0
(
∆∆0 1
)
∆∆1 2
{
«« 	
return
»» 
View
»» 
(
»» 
)
»» 
;
»» 
}
…… 	
	protected
ÀÀ 
override
ÀÀ 
void
ÀÀ 
Dispose
ÀÀ  '
(
ÀÀ' (
bool
ÀÀ( ,
	disposing
ÀÀ- 6
)
ÀÀ6 7
{
ÃÃ 	
if
ÕÕ 
(
ÕÕ 
	disposing
ÕÕ 
)
ÕÕ 
{
ŒŒ 
if
œœ 
(
œœ 
_userManager
œœ  
!=
œœ! #
null
œœ$ (
)
œœ( )
{
–– 
_userManager
——  
.
——  !
Dispose
——! (
(
——( )
)
——) *
;
——* +
_userManager
““  
=
““! "
null
““# '
;
““' (
}
”” 
if
’’ 
(
’’ 
_signInManager
’’ "
!=
’’# %
null
’’& *
)
’’* +
{
÷÷ 
_signInManager
◊◊ "
.
◊◊" #
Dispose
◊◊# *
(
◊◊* +
)
◊◊+ ,
;
◊◊, -
_signInManager
ÿÿ "
=
ÿÿ# $
null
ÿÿ% )
;
ÿÿ) *
}
ŸŸ 
}
⁄⁄ 
base
‹‹ 
.
‹‹ 
Dispose
‹‹ 
(
‹‹ 
	disposing
‹‹ "
)
‹‹" #
;
‹‹# $
}
›› 	
private
·· 
const
·· 
string
·· 
XsrfKey
·· $
=
··% &
$str
··' /
;
··/ 0
private
„„ $
IAuthenticationManager
„„ &#
AuthenticationManager
„„' <
{
‰‰ 	
get
ÂÂ 
{
ÊÊ 
return
ÁÁ 
HttpContext
ÁÁ "
.
ÁÁ" #
GetOwinContext
ÁÁ# 1
(
ÁÁ1 2
)
ÁÁ2 3
.
ÁÁ3 4
Authentication
ÁÁ4 B
;
ÁÁB C
}
ËË 
}
ÈÈ 	
private
ÎÎ 
void
ÎÎ 
	AddErrors
ÎÎ 
(
ÎÎ 
IdentityResult
ÎÎ -
result
ÎÎ. 4
)
ÎÎ4 5
{
ÏÏ 	
foreach
ÌÌ 
(
ÌÌ 
var
ÌÌ 
error
ÌÌ 
in
ÌÌ !
result
ÌÌ" (
.
ÌÌ( )
Errors
ÌÌ) /
)
ÌÌ/ 0
{
ÓÓ 

ModelState
ÔÔ 
.
ÔÔ 
AddModelError
ÔÔ (
(
ÔÔ( )
$str
ÔÔ) +
,
ÔÔ+ ,
error
ÔÔ- 2
)
ÔÔ2 3
;
ÔÔ3 4
}
 
}
ÒÒ 	
private
ÛÛ 
ActionResult
ÛÛ 
RedirectToLocal
ÛÛ ,
(
ÛÛ, -
string
ÛÛ- 3
	returnUrl
ÛÛ4 =
)
ÛÛ= >
{
ÙÙ 	
if
ıı 
(
ıı 
Url
ıı 
.
ıı 

IsLocalUrl
ıı 
(
ıı 
	returnUrl
ıı (
)
ıı( )
)
ıı) *
{
ˆˆ 
return
˜˜ 
Redirect
˜˜ 
(
˜˜  
	returnUrl
˜˜  )
)
˜˜) *
;
˜˜* +
}
¯¯ 
return
˘˘ 
RedirectToAction
˘˘ #
(
˘˘# $
$str
˘˘$ +
,
˘˘+ ,
$str
˘˘- 3
)
˘˘3 4
;
˘˘4 5
}
˙˙ 	
internal
¸¸ 
class
¸¸ 
ChallengeResult
¸¸ &
:
¸¸' ($
HttpUnauthorizedResult
¸¸) ?
{
˝˝ 	
public
˛˛ 
ChallengeResult
˛˛ "
(
˛˛" #
string
˛˛# )
provider
˛˛* 2
,
˛˛2 3
string
˛˛4 :
redirectUri
˛˛; F
)
˛˛F G
:
ˇˇ 
this
ˇˇ 
(
ˇˇ 
provider
ˇˇ 
,
ˇˇ  
redirectUri
ˇˇ! ,
,
ˇˇ, -
null
ˇˇ. 2
)
ˇˇ2 3
{
ÄÄ 
}
ÅÅ 
public
ÉÉ 
ChallengeResult
ÉÉ "
(
ÉÉ" #
string
ÉÉ# )
provider
ÉÉ* 2
,
ÉÉ2 3
string
ÉÉ4 :
redirectUri
ÉÉ; F
,
ÉÉF G
string
ÉÉH N
userId
ÉÉO U
)
ÉÉU V
{
ÑÑ 
LoginProvider
ÖÖ 
=
ÖÖ 
provider
ÖÖ  (
;
ÖÖ( )
RedirectUri
ÜÜ 
=
ÜÜ 
redirectUri
ÜÜ )
;
ÜÜ) *
UserId
áá 
=
áá 
userId
áá 
;
áá  
}
àà 
public
ää 
string
ää 
LoginProvider
ää '
{
ää( )
get
ää* -
;
ää- .
set
ää/ 2
;
ää2 3
}
ää4 5
public
ãã 
string
ãã 
RedirectUri
ãã %
{
ãã& '
get
ãã( +
;
ãã+ ,
set
ãã- 0
;
ãã0 1
}
ãã2 3
public
åå 
string
åå 
UserId
åå  
{
åå! "
get
åå# &
;
åå& '
set
åå( +
;
åå+ ,
}
åå- .
public
éé 
override
éé 
void
éé  
ExecuteResult
éé! .
(
éé. /
ControllerContext
éé/ @
context
ééA H
)
ééH I
{
èè 
var
êê 

properties
êê 
=
êê  
new
êê! $&
AuthenticationProperties
êê% =
{
êê> ?
RedirectUri
êê@ K
=
êêL M
RedirectUri
êêN Y
}
êêZ [
;
êê[ \
if
ëë 
(
ëë 
UserId
ëë 
!=
ëë 
null
ëë "
)
ëë" #
{
íí 

properties
ìì 
.
ìì 

Dictionary
ìì )
[
ìì) *
XsrfKey
ìì* 1
]
ìì1 2
=
ìì3 4
UserId
ìì5 ;
;
ìì; <
}
îî 
context
ïï 
.
ïï 
HttpContext
ïï #
.
ïï# $
GetOwinContext
ïï$ 2
(
ïï2 3
)
ïï3 4
.
ïï4 5
Authentication
ïï5 C
.
ïïC D
	Challenge
ïïD M
(
ïïM N

properties
ïïN X
,
ïïX Y
LoginProvider
ïïZ g
)
ïïg h
;
ïïh i
}
ññ 
}
óó 	
}
ôô 
}öö ÙW
>E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\API\AdsController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
API 
{ 
public 

class 
AdsController 
:  
ApiController! .
{ 
private 
readonly 
string '
AuthenticationParameterName  ;
=< =
$str> J
;J K
private 
readonly 
int 
APIMaxDailyLimit -
=. /
$num0 2
;2 3
private 
readonly 
WfpictContext &
_db' *
=+ ,
new- 0
WfpictContext1 >
(> ?
)? @
;@ A
public 

JsonResult 
< 
JsonResponse &
>& '
Get( +
(+ ,
), -
{ 	
try 
{ 
if 
( 
! 
Request 
. 
Headers $
.$ %
Contains% -
(- .'
AuthenticationParameterName. I
)I J
)J K
{ 
throw 
new 
AdsException *
(* +
$str+ N
)N O
;O P
} 
string 
token 
= 
Request &
.& '
Headers' .
.. /
	GetValues/ 8
(8 9'
AuthenticationParameterName9 T
)T U
.U V
FirstV [
([ \
)\ ]
;] ^
var!! 
user!! 
=!! 
_db!! 
.!! 
Users!! $
.!!$ %
FirstOrDefault!!% 3
(!!3 4
x!!4 5
=>!!6 8
x!!9 :
.!!: ;
ApiKey!!; A
.!!A B
Equals!!B H
(!!H I
token!!I N
)!!N O
)!!O P
;!!P Q
var"" 
isValidUser"" 
=""  !
user""" &
!=""' )
null""* .
;"". /
if## 
(## 
!## 
isValidUser##  
)##  !
{$$ 
throw%% 
new%% 
AdsException%% *
(%%* +
$str%%+ K
)%%K L
;%%L M
}&& 
int(( 
todaysRequests(( "
=((# $
_db((% (
.((( )
ApiRequests(() 4
.((4 5
Count((5 :
(((: ;
x((; <
=>((= ?
x((@ A
.((A B
APIKey((B H
==((I K
token((L Q
&&((R T
x((U V
.((V W
	CreatedAt((W `
.((` a
Date((a e
==((f h
DateTime((i q
.((q r
Now((r u
.((u v
Date((v z
)((z {
;(({ |
if)) 
()) 
todaysRequests)) "
>))# $
APIMaxDailyLimit))% 5
)))5 6
{** 
throw++ 
new++ 
AdsException++ *
(++* +
$str+++ A
+++B C
APIMaxDailyLimit++D T
+++U V
$str,,( N
),,N O
;,,O P
}-- 
_db// 
.// 
ApiRequests// 
.//  
Add//  #
(//# $
new//$ '

ApiRequest//( 2
(//2 3
)//3 4
{00 
Id11 
=11 
Guid11 
.11 
NewGuid11 %
(11% &
)11& '
,11' (
	CreatedAt22 
=22 
DateTime22  (
.22( )
Now22) ,
,22, -
APIKey33 
=33 
token33 "
}44 
)44 
;44 
_db55 
.55 
SaveChanges55 
(55  
)55  !
;55! "
var77 
	campaigns77 
=77 
_db77  #
.77# $
	Campaigns77$ -
.88 
Include88 
(88 
x88 
=>88 !
x88" #
.88# $
ProDatas88$ ,
)88, -
.99 
Include99 
(99 
x99 
=>99 !
x99" #
.99# $
Testing99$ +
)99+ ,
.:: 
Include:: 
(:: 
x:: 
=>:: !
x::" #
.::# $
Approved::$ ,
)::, -
.;; 
Where;; 
(;; 
x;; 
=>;; 
x;;  !
.;;! "
AssignedToCustomer;;" 4
==;;5 7
user;;8 <
.;;< =
Id;;= ?
&&;;@ B
x;;C D
.;;D E
Status;;E K
==;;L N
(;;O P
int;;P S
);;S T
CampaignStatus;;T b
.;;b c
	Completed;;c l
);;l m
.<< 
ToList<< 
(<< 
)<< 
.== 
Select== 
(== 
x== 
=>==  
Campaign==! )
.==) *
FromCampaign==* 6
(==6 7
x==7 8
)==8 9
)==9 :
;==: ;
return?? 
Json?? 
(?? 
new?? 
JsonResponse??  ,
(??, -
)??- .
{??/ 0
IsSucess??0 8
=??9 :
true??; ?
,??? @
Result??A G
=??H I
	campaigns??J S
}??S T
)??T U
;??U V
}@@ 
catchAA 
(AA 
	ExceptionAA 
exAA 
)AA  
{BB 
returnCC 
JsonCC 
(CC 
newCC 
JsonResponseCC  ,
(CC, -
)CC- .
{CC/ 0
IsSucessCC0 8
=CC9 :
falseCC; @
,CC@ A
ErrorMessageCCB N
=CCO P
exCCQ S
.CCS T
MessageCCT [
}CC[ \
)CC\ ]
;CC] ^
}DD 
}EE 	
publicHH 

JsonResultHH 
<HH 
JsonResponseHH &
>HH& '
PostHH( ,
(HH, -
[HH- .
FromBodyHH. 6
]HH6 7
CampaignHH8 @
campaginHHA I
)HHI J
{II 	
tryJJ 
{KK 
ifLL 
(LL 
!LL 
RequestLL 
.LL 
HeadersLL $
.LL$ %
ContainsLL% -
(LL- .'
AuthenticationParameterNameLL. I
)LLI J
)LLJ K
{MM 
throwNN 
newNN 
AdsExceptionNN *
(NN* +
$strNN+ N
)NNN O
;NNO P
}OO 
ifPP 
(PP 
stringPP 
.PP 
IsNullOrEmptyPP (
(PP( )
campaginPP) 1
.PP1 2
OrderNumberPP2 =
)PP= >
)PP> ?
{QQ 
throwRR 
newRR 
AdsExceptionRR *
(RR* +
$strRR+ C
)RRC D
;RRD E
}SS 
ifTT 
(TT 
stringTT 
.TT 
IsNullOrEmptyTT (
(TT( )
campaginTT) 1
.TT1 2
IoNumberTT2 :
)TT: ;
)TT; <
{UU 
throwVV 
newVV 
AdsExceptionVV *
(VV* +
$strVV+ @
)VV@ A
;VVA B
}WW 
stringYY 
tokenYY 
=YY 
RequestYY &
.YY& '
HeadersYY' .
.YY. /
	GetValuesYY/ 8
(YY8 9'
AuthenticationParameterNameYY9 T
)YYT U
.YYU V
FirstYYV [
(YY[ \
)YY\ ]
;YY] ^
var[[ 
user[[ 
=[[ 
_db[[ 
.[[ 
Users[[ $
.[[$ %
FirstOrDefault[[% 3
([[3 4
x[[4 5
=>[[6 8
x[[9 :
.[[: ;
ApiKey[[; A
.[[A B
Equals[[B H
([[H I
token[[I N
)[[N O
)[[O P
;[[P Q
var\\ 
isValidUser\\ 
=\\  !
user\\" &
!=\\' )
null\\* .
;\\. /
if]] 
(]] 
!]] 
isValidUser]]  
)]]  !
{^^ 
throw__ 
new__ 
AdsException__ *
(__* +
$str__+ K
)__K L
;__L M
}`` 
_dbbb 
.bb 
ApiRequestsbb 
.bb  
Addbb  #
(bb# $
newbb$ '

ApiRequestbb( 2
(bb2 3
)bb3 4
{cc 
Iddd 
=dd 
Guiddd 
.dd 
NewGuiddd %
(dd% &
)dd& '
,dd' (
	CreatedAtee 
=ee 
DateTimeee  (
.ee( )
Nowee) ,
,ee, -
APIKeyff 
=ff 
tokenff "
}gg 
)gg 
;gg 
_dbhh 
.hh 
SaveChangeshh 
(hh  
)hh  !
;hh! "
varjj 
campaignTrackingjj $
=jj% &
_dbjj' *
.jj* +
CampaignTrackingsjj+ <
.kk  !
FirstOrDefaultkk! /
(kk/ 0
xkk0 1
=>kk2 4
xkk5 6
.kk6 7
SegmentNumberkk7 D
==kkE G
campaginkkH P
.kkP Q
OrderNumberkkQ \
.kk\ ]
Trimkk] a
(kka b
)kkb c
)kkc d
;kkd e
ifmm 
(mm 
campaignTrackingmm $
==mm% '
nullmm( ,
)mm, -
{nn 
throwoo 
newoo 
AdsExceptionoo *
(oo* +
$stroo+ H
+ooI J
campaginooK S
.ooS T
OrderNumberooT _
+oo` a
$stroob t
)oot u
;oou v
}pp 
campaignTrackingrr  
.rr  !
IoNumberrr! )
=rr* +
campaginrr, 4
.rr4 5
IoNumberrr5 =
.rr= >
Trimrr> B
(rrB C
)rrC D
;rrD E
_dbss 
.ss 
SaveChangesss 
(ss  
)ss  !
;ss! "
stringuu 
messageuu 
=uu  
$struu! >
+uu? @
campaginuuA I
.uuI J
OrderNumberuuJ U
+uuV W
$strvv! D
+vvE F
campaginvvG O
.vvO P
IoNumbervvP X
;vvX Y
returnxx 
Jsonxx 
(xx 
newxx 
JsonResponsexx  ,
(xx, -
)xx- .
{xx/ 0
IsSucessxx1 9
=xx: ;
truexx< @
,xx@ A
ResultxxB H
=xxI J
messagexxK R
}xxS T
)xxT U
;xxU V
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
return|| 
Json|| 
(|| 
new|| 
JsonResponse||  ,
(||, -
)||- .
{||/ 0
IsSucess||1 9
=||: ;
false||< A
,||A B
ErrorMessage||C O
=||P Q
ex||R T
.||T U
Message||U \
}||] ^
)||^ _
;||_ `
}}} 
}~~ 	
}
ÄÄ 
}ÅÅ ’Ç
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\ApprovedController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
ApprovedController #
:$ %
BaseController& 4
{ 
public 
ActionResult 
Index !
(! "
Guid" &
?& '
id( *
)* +
{ 	
var 
campaign 
= 
Db 
. 
	Campaigns '
. 
Include 
( 
c 
=> 
c 
.  
Testing  '
)' (
. 
Include 
( 
c 
=> 
c 
.  
Approved  (
)( )
. 
FirstOrDefault 
(  
c  !
=>" $
c% &
.& '
Id' )
==* ,
id- /
)/ 0
;0 1
Session 
[ 
$str 
] 
= 
id 
; 
Session 
[ 
$str !
]! "
=# $
campaign% -
.- .
OrderNumber. 9
;9 :
if   
(   
campaign   
.   
Testing    
==  ! #
null  $ (
)  ( )
{!! 
TempData"" 
["" 
$str""  
]""  !
=""" #
$str""$ H
;""H I
return## 
RedirectToAction## '
(##' (
$str##( /
,##/ 0
$str##1 <
)##< =
;##= >
}$$ 
if&& 
(&& 
campaign&& 
.&& 
Approved&& !
==&&" $
null&&% )
)&&) *
{'' 
var(( 
testing(( 
=(( 
campaign(( &
.((& '
Testing((' .
;((. /
var)) 

approvedId)) 
=))  
Guid))! %
.))% &
NewGuid))& -
())- .
))). /
;))/ 0
var** 
approved** 
=** 
new** "
CampaignApproved**# 3
(**3 4
)**4 5
{++ 
Id,, 
=,, 

approvedId,, #
,,,# $

CampaignId-- 
=--  
campaign--! )
.--) *
Id--* ,
,--, -
	CreatedAt.. 
=.. 
DateTime..  (
...( )
Now..) ,
,.., -
	CreatedBy// 
=// 
campaign//  (
.//( )
	CreatedBy//) 2
,//2 3
CampaignName00  
=00! "
testing00# *
.00* +
CampaignName00+ 7
,007 8

WhiteLabel11 
=11  
testing11! (
.11( )

WhiteLabel11) 3
,113 4
ReBroadCast22 
=22  !
testing22" )
.22) *
ReBroadCast22* 5
,225 6
ReBroadcastDate33 #
=33$ %
testing33& -
.33- .
ReBroadcastDate33. =
,33= >
FromLine44 
=44 
testing44 &
.44& '
FromLine44' /
,44/ 0
SubjectLine55 
=55  !
testing55" )
.55) *
SubjectLine55* 5
,555 6

DeployDate66 
=66  
testing66! (
.66( )

DeployDate66) 3
,663 4

GeoDetails88 
=88  
testing88! (
.88( )

GeoDetails88) 3
,883 4
Demographics99  
=99! "
testing99# *
.99* +
Demographics99+ 7
,997 8
Quantity:: 
=:: 
testing:: &
.::& '
Quantity::' /
,::/ 0
SpecialInstructions;; '
=;;( )
testing;;* 1
.;;1 2
SpecialInstructions;;2 E
,;;E F
ReportSiteLink<< "
=<<# $
$"<<% '(
http://report-site.com/c/ADS<<' C
{<<C D
campaign<<D L
.<<L M
OrderNumber<<M X
}<<X Y
"<<Y Z
,<<Z [
LinkBreakout==  
===! "
$"==# %/
#http://www.digitaldynamixs.net/ep2/==% H
{==H I
campaign==I Q
.==Q R
OrderNumber==R ]
}==] ^
/==^ _
{==_ `
campaign==` h
.==h i
OrderNumber==i t
}==t u
	linkr.csv==u ~
"==~ 
,	== Ä
IsOpenPixel>> 
=>>  !
testing>>" )
.>>) *
IsOpenPixel>>* 5
,>>5 6
OpenPixelUrl??  
=??! "
testing??# *
.??* +
OpenPixelUrl??+ 7
,??7 8
	OpenGoals@@ 
=@@ 
testing@@  '
.@@' (
	OpenGoals@@( 1
,@@1 2

ClickGoalsAA 
=AA  
testingAA! (
.AA( )

ClickGoalsAA) 3
,AA3 4
DataFileQuantityBB $
=BB% &
testingBB' .
.BB. /
DataFileQuantityBB/ ?
,BB? @
DataFileUrlCC 
=CC  !
testingCC" )
.CC) *
DataFileUrlCC* 5
,CC5 6
IsOmniOrderEE 
=EE  !
testingEE" )
.EE) *
IsOmniOrderEE* 5
,EE5 6
OmniDeployDateFF "
=FF# $
testingFF% ,
.FF, -
OmniDeployDateFF- ;
,FF; <
ImpressionsGG 
=GG  !
testingGG" )
.GG) *
ImpressionsGG* 5
,GG5 6
ChannelTypesHH  
=HH! "
testingHH# *
.HH* +
ChannelTypesHH+ 7
,HH7 8
}II 
;II 
DbJJ 
.JJ 
CampaignsApprovedJJ $
.JJ$ %
AddJJ% (
(JJ( )
approvedJJ) 1
)JJ1 2
;JJ2 3
DbKK 
.KK 
SaveChangesKK 
(KK 
)KK  
;KK  !
campaignLL 
.LL 

ApprovedIdLL #
=LL$ %

approvedIdLL& 0
;LL0 1
DbMM 
.MM 
SaveChangesMM 
(MM 
)MM  
;MM  !
}NN 
campaignOO 
.OO 
StatusOO 
=OO 
(OO 
intOO "
)OO" #
CampaignStatusOO# 1
.OO1 2
ApprovedOO2 :
;OO: ;
DbPP 
.PP 
SaveChangesPP 
(PP 
)PP 
;PP 
returnQQ 
RedirectToActionQQ #
(QQ# $
$strQQ$ 2
,QQ2 3
$strQQ4 >
,QQ> ?
newQQ@ C
{QQD E
idQQF H
=QQI J
campaignQQK S
.QQS T

ApprovedIdQQT ^
}QQ_ `
)QQ` a
;QQa b
}SS 	
publicVV 
ActionResultVV 
EditApprovedVV (
(VV( )
GuidVV) -
?VV- .
idVV/ 1
)VV1 2
{WW 	
CampaignApprovedXX 
campaignApprovedXX -
=XX. /
DbXX0 2
.XX2 3
CampaignsApprovedXX3 D
.XXD E
FirstOrDefaultXXE S
(XXS T
cXXT U
=>XXV X
cXXY Z
.XXZ [
IdXX[ ]
==XX^ `
idXXa c
)XXc d
;XXd e
ifYY 
(YY 
campaignApprovedYY  
==YY! #
nullYY$ (
)YY( )
{ZZ 
throw[[ 
new[[ 
HttpException[[ '
([[' (
$num[[( +
,[[+ ,
$str[[- 8
)[[8 9
;[[9 :
}\\ 

TinyMapper^^ 
.^^ 
Bind^^ 
<^^ 
CampaignApproved^^ ,
,^^, -
CampaignApprovedVM^^. @
>^^@ A
(^^A B
config^^B H
=>^^I K
{__ 
config`` 
.`` 
Ignore`` 
(`` 
x`` 
=>``  "
x``# $
.``$ %
ChannelTypes``% 1
)``1 2
;``2 3
}aa 
)aa 
;aa 
varcc 
campaignApprovedVmcc "
=cc# $

TinyMappercc% /
.cc/ 0
Mapcc0 3
<cc3 4
CampaignApprovedVMcc4 F
>ccF G
(ccG H
campaignApprovedccH X
)ccX Y
;ccY Z
Campaigndd 
campaigndd 
=dd 
Dbdd  "
.dd" #
	Campaignsdd# ,
.ee 
Includeee 
(ee 
xee 
=>ee  
xee! "
.ee" #
Assetsee# )
)ee) *
.ff 
Includeff 
(ff 
xff 
=>ff  
xff! "
.ff" #
Segmentsff# +
)ff+ ,
.gg 
FirstOrDefaultgg "
(gg" #
xgg# $
=>gg% '
xgg( )
.gg) *
Idgg* ,
==gg- /
campaignApprovedVmgg0 B
.ggB C

CampaignIdggC M
)ggM N
;ggN O
campaignApprovedVmhh 
.hh 
OrderNumberhh *
=hh+ ,
campaignhh- 5
.hh5 6
OrderNumberhh6 A
;hhA B
campaignApprovedVmii 
.ii 
Assetsii %
=ii& '
campaignii( 0
.ii0 1
Assetsii1 7
;ii7 8
foreachjj 
(jj 
varjj 
segmentjj  
injj! #
campaignjj$ ,
.jj, -
Segmentsjj- 5
)jj5 6
{kk 
varll 
	segmentVmll 
=ll 

TinyMapperll  *
.ll* +
Mapll+ .
<ll. /
CampaignSegmentVMll/ @
>ll@ A
(llA B
segmentllB I
)llI J
;llJ K
campaignApprovedVmmm "
.mm" #
Segmentsmm# +
.mm+ ,
Addmm, /
(mm/ 0
	segmentVmmm0 9
)mm9 :
;mm: ;
}nn 
campaignApprovedVmpp 
.pp 
ChannelTypespp +
=pp, -
stringpp. 4
.pp4 5
IsNullOrEmptypp5 B
(ppB C
campaignApprovedppC S
.ppS T
ChannelTypesppT `
)pp` a
?ppb c
newppd g
Listpph l
<ppl m
ChannelTypeppm x
>ppx y
{ppz {
}pp| }
:pp~ 
campaignApprovedqq  
.qq  !
ChannelTypesqq! -
.rr 
Splitrr 
(rr 
$strrr 
.rr 
ToCharArrayrr *
(rr* +
)rr+ ,
)rr, -
.ss 
Selectss 
(ss 
xss 
=>ss  
(ss! "
ChannelTypess" -
)ss- .
Systemss. 4
.ss4 5
Enumss5 9
.ss9 :
Parsess: ?
(ss? @
typeofss@ F
(ssF G
ChannelTypessG R
)ssR S
,ssS T
xssU V
)ssV W
)ssW X
.ssX Y
ToListssY _
(ss_ `
)ss` a
;ssa b
varuu 
proDatauu 
=uu 
VendorsListuu %
.uu% &
FirstOrDefaultuu& 4
(uu4 5
xuu5 6
=>uu7 9
xuu: ;
.uu; <
Textuu< @
.uu@ A
ToLowerInvariantuuA Q
(uuQ R
)uuR S
.uuS T
ContainsuuT \
(uu\ ]
$struu] b
)uub c
)uuc d
;uud e
ViewBagvv 
.vv 
Vendorvv 
=vv 
newvv  

SelectListvv! +
(vv+ ,
VendorsListvv, 7
,vv7 8
$strvv9 @
,vv@ A
$strvvB H
,vvH I
proDatavvJ Q
)vvQ R
;vvR S
ViewBagww 
.ww 

WhiteLabelww 
=ww  
newww! $

SelectListww% /
(ww/ 0
CustomersListww0 =
,ww= >
$strww? F
,wwF G
$strwwH N
,wwN O
campaignApprovedVmwwP b
.wwb c

WhiteLabelwwc m
)wwm n
;wwn o
returnxx 
Viewxx 
(xx 
campaignApprovedVmxx *
)xx* +
;xx+ ,
}yy 	
[{{ 	
HttpPost{{	 
]{{ 
[|| 	$
ValidateAntiForgeryToken||	 !
]||! "
public}} 
ActionResult}} 
EditApproved}} (
(}}( )
[}}) *
Bind}}* .
(}}. /
Include}}/ 6
=}}7 8
$str	}}9 ÷
)
}}÷ ◊
]
}}◊ ÿ 
CampaignApprovedVM
}}Ÿ Î 
campaignApprovedVm
}}Ï ˛
)
}}˛ ˇ
{~~ 	
if 
( 

ModelState 
. 
IsValid "
)" #
{
ÄÄ 

TinyMapper
ÉÉ 
.
ÉÉ 
Bind
ÉÉ 
<
ÉÉ   
CampaignApprovedVM
ÉÉ  2
,
ÉÉ2 3
CampaignApproved
ÉÉ4 D
>
ÉÉD E
(
ÉÉE F
config
ÉÉF L
=>
ÉÉM O
{
ÑÑ 
config
ÖÖ 
.
ÖÖ 
Ignore
ÖÖ !
(
ÖÖ! "
x
ÖÖ" #
=>
ÖÖ$ &
x
ÖÖ' (
.
ÖÖ( )
ChannelTypes
ÖÖ) 5
)
ÖÖ5 6
;
ÖÖ6 7
config
ÜÜ 
.
ÜÜ 
Ignore
ÜÜ !
(
ÜÜ! "
x
ÜÜ" #
=>
ÜÜ$ &
x
ÜÜ' (
.
ÜÜ( )
Assets
ÜÜ) /
)
ÜÜ/ 0
;
ÜÜ0 1
config
áá 
.
áá 
Ignore
áá !
(
áá! "
x
áá" #
=>
áá$ &
x
áá' (
.
áá( )
Segments
áá) 1
)
áá1 2
;
áá2 3
}
àà 
)
àà 
;
àà 
var
ââ 
campaignApproved
ââ $
=
ââ% &

TinyMapper
ââ' 1
.
ââ1 2
Map
ââ2 5
<
ââ5 6
CampaignApproved
ââ6 F
>
ââF G
(
ââG H 
campaignApprovedVm
ââH Z
)
ââZ [
;
ââ[ \
campaignApproved
ää  
.
ää  !
ChannelTypes
ää! -
=
ää. / 
campaignApprovedVm
ää0 B
.
ääB C
ChannelTypes
ääC O
==
ääP R
null
ääS W
?
ääX Y
null
ääZ ^
:
ää_ `
string
ãã 
.
ãã 
Join
ãã 
(
ãã  
$str
ãã  #
,
ãã# $ 
campaignApprovedVm
ãã% 7
.
ãã7 8
ChannelTypes
ãã8 D
)
ããD E
;
ããE F
Db
åå 
.
åå 
Entry
åå 
(
åå 
campaignApproved
åå )
)
åå) *
.
åå* +
State
åå+ 0
=
åå1 2
EntityState
åå3 >
.
åå> ?
Modified
åå? G
;
ååG H
Db
çç 
.
çç 
SaveChanges
çç 
(
çç 
)
çç  
;
çç  !
var
êê 
campaignAssets
êê "
=
êê# $
Db
êê% '
.
êê' (
CampaignAssets
êê( 6
.
êê6 7
FirstOrDefault
êê7 E
(
êêE F
x
êêF G
=>
êêH J
x
êêK L
.
êêL M

CampaignId
êêM W
==
êêX Z 
campaignApprovedVm
êê[ m
.
êêm n

CampaignId
êên x
)
êêx y
;
êêy z
campaignAssets
ëë 
.
ëë 
CreativeFiles
ëë ,
=
ëë- . 
campaignApprovedVm
ëë/ A
.
ëëA B
Assets
ëëB H
.
ëëH I
CreativeFiles
ëëI V
;
ëëV W
campaignAssets
íí 
.
íí 
CreativeUrl
íí *
=
íí+ , 
campaignApprovedVm
íí- ?
.
íí? @
Assets
íí@ F
.
ííF G
CreativeUrl
ííG R
;
ííR S
campaignAssets
ìì 
.
ìì 
ZipCodeFile
ìì *
=
ìì+ , 
campaignApprovedVm
ìì- ?
.
ìì? @
Assets
ìì@ F
.
ììF G
ZipCodeFile
ììG R
;
ììR S
campaignAssets
îî 
.
îî 

ZipCodeUrl
îî )
=
îî* + 
campaignApprovedVm
îî, >
.
îî> ?
Assets
îî? E
.
îîE F

ZipCodeUrl
îîF P
;
îîP Q
campaignAssets
ïï 
.
ïï 
TestSeedFile
ïï +
=
ïï, - 
campaignApprovedVm
ïï. @
.
ïï@ A
Assets
ïïA G
.
ïïG H
TestSeedFile
ïïH T
;
ïïT U
campaignAssets
ññ 
.
ññ 
LiveSeedFile
ññ +
=
ññ, - 
campaignApprovedVm
ññ. @
.
ññ@ A
Assets
ññA G
.
ññG H
LiveSeedFile
ññH T
;
ññT U
Db
óó 
.
óó 
Entry
óó 
(
óó 
campaignAssets
óó '
)
óó' (
.
óó( )
State
óó) .
=
óó/ 0
EntityState
óó1 <
.
óó< =
Modified
óó= E
;
óóE F
Db
òò 
.
òò 
SaveChanges
òò 
(
òò 
)
òò  
;
òò  !
TempData
öö 
[
öö 
$str
öö "
]
öö" #
=
öö$ %
$str
öö& I
;
ööI J
}
õõ 
else
úú 
{
ùù 
var
ûû 
	errorList
ûû 
=
ûû 
(
ûû  !
from
ûû! %
item
ûû& *
in
ûû+ -

ModelState
ûû. 8
.
ûû8 9
Values
ûû9 ?
from
üü! %
error
üü& +
in
üü, .
item
üü/ 3
.
üü3 4
Errors
üü4 :
select
††! '
error
††( -
.
††- .
ErrorMessage
††. :
)
††: ;
.
††; <
ToList
††< B
(
††B C
)
††C D
;
††D E
TempData
°° 
[
°° 
$str
°°  
]
°°  !
=
°°" #
$str
°°$ D
+
°°E F
string
°°G M
.
°°M N
Join
°°N R
(
°°R S
$str
°°S Z
,
°°Z [
	errorList
°°\ e
)
°°e f
;
°°f g
}
¢¢ 
var
££ 
proData
££ 
=
££ 
VendorsList
££ %
.
££% &
FirstOrDefault
££& 4
(
££4 5
x
££5 6
=>
££7 9
x
££: ;
.
££; <
Text
££< @
.
££@ A
Contains
££A I
(
££I J
$str
££J O
)
££O P
)
££P Q
;
££Q R
ViewBag
§§ 
.
§§ 
Vendor
§§ 
=
§§ 
new
§§  

SelectList
§§! +
(
§§+ ,
VendorsList
§§, 7
,
§§7 8
$str
§§9 @
,
§§@ A
$str
§§B H
,
§§H I
proData
§§J Q
)
§§Q R
;
§§R S
ViewBag
•• 
.
•• 

WhiteLabel
•• 
=
••  
new
••! $

SelectList
••% /
(
••/ 0
CustomersList
••0 =
,
••= >
$str
••? F
,
••F G
$str
••H N
,
••N O 
campaignApprovedVm
••P b
.
••b c

WhiteLabel
••c m
)
••m n
;
••n o
return
ßß 
View
ßß 
(
ßß  
campaignApprovedVm
ßß *
)
ßß* +
;
ßß+ ,
}
®® 	
public
™™ 
ActionResult
™™ 
CompleteSegment
™™ +
(
™™+ ,
Guid
™™, 0
?
™™0 1
id
™™2 4
)
™™4 5
{
´´ 	
try
¨¨ 
{
≠≠ 
var
ÆÆ 
segment
ÆÆ 
=
ÆÆ 
Db
ÆÆ  
.
ÆÆ  !
CampaignSegments
ÆÆ! 1
.
ÆÆ1 2
FirstOrDefault
ÆÆ2 @
(
ÆÆ@ A
x
ÆÆA B
=>
ÆÆC E
x
ÆÆF G
.
ÆÆG H
Id
ÆÆH J
==
ÆÆK M
id
ÆÆN P
)
ÆÆP Q
;
ÆÆQ R
segment
ØØ 
.
ØØ 
SegmentStatus
ØØ %
=
ØØ& '
(
ØØ( )
int
ØØ) ,
)
ØØ, -
SegmentStatus
ØØ- :
.
ØØ: ;
Complete
ØØ; C
;
ØØC D
segment
∞∞ 
.
∞∞ 
DateComplete
∞∞ $
=
∞∞% &
DateTime
∞∞' /
.
∞∞/ 0
Now
∞∞0 3
;
∞∞3 4
Db
±± 
.
±± 
SaveChanges
±± 
(
±± 
)
±±  
;
±±  !
return
≤≤ 
Json
≤≤ 
(
≤≤ 
new
≤≤ 
JsonResponse
≤≤  ,
(
≤≤, -
)
≤≤- .
{
≤≤/ 0
IsSucess
≤≤1 9
=
≤≤: ;
true
≤≤< @
}
≤≤A B
,
≤≤B C!
JsonRequestBehavior
≤≤D W
.
≤≤W X
AllowGet
≤≤X `
)
≤≤` a
;
≤≤a b
}
≥≥ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
µµ 
return
∂∂ 
Json
∂∂ 
(
∂∂ 
new
∂∂ 
JsonResponse
∂∂  ,
(
∂∂, -
)
∂∂- .
{
∂∂/ 0
IsSucess
∂∂1 9
=
∂∂: ;
false
∂∂< A
,
∂∂A B
ErrorMessage
∂∂C O
=
∂∂P Q
ex
∂∂R T
.
∂∂T U
Message
∂∂U \
}
∂∂] ^
,
∂∂^ _!
JsonRequestBehavior
∂∂` s
.
∂∂s t
AllowGet
∂∂t |
)
∂∂| }
;
∂∂} ~
}
∑∑ 
}
∏∏ 	
public
∫∫ 
ActionResult
∫∫ 
SendToVendor
∫∫ (
(
∫∫( )
Guid
∫∫) -
?
∫∫- .
vendorId
∫∫/ 7
,
∫∫7 8
Guid
∫∫9 =
?
∫∫= >
id
∫∫? A
,
∫∫A B
string
∫∫C I
[
∫∫I J
]
∫∫J K
segmentsSelected
∫∫L \
)
∫∫\ ]
{
ªª 	
try
ºº 
{
ΩΩ 
Campaign
ææ 
campaign
ææ !
=
ææ" #
Db
ææ$ &
.
ææ& '
	Campaigns
ææ' 0
.
ææ0 1
Include
ææ1 8
(
ææ8 9
x
ææ9 :
=>
ææ; =
x
ææ> ?
.
ææ? @
Approved
ææ@ H
)
ææH I
.
ææI J
FirstOrDefault
ææJ X
(
ææX Y
x
ææY Z
=>
ææ[ ]
x
ææ^ _
.
ææ_ `
Id
ææ` b
==
ææc e
id
ææf h
)
ææh i
;
ææi j
if
øø 
(
øø 
campaign
øø 
==
øø 
null
øø  $
)
øø$ %
{
¿¿ 
throw
¡¡ 
new
¡¡ 
AdsException
¡¡ *
(
¡¡* +
$str
¡¡+ ?
+
¡¡@ A
id
¡¡B D
+
¡¡E F
$str
¡¡G T
)
¡¡T U
;
¡¡U V
}
¬¬ 
if
√√ 
(
√√ 
campaign
√√ 
.
√√ 
Approved
√√ %
==
√√& (
null
√√) -
)
√√- .
{
ƒƒ 
throw
≈≈ 
new
≈≈ 
AdsException
≈≈ *
(
≈≈* +
$str
≈≈+ 7
+
≈≈8 9
campaign
≈≈: B
.
≈≈B C
CampaignName
≈≈C O
+
≈≈P Q
$str
≈≈R i
)
≈≈i j
;
≈≈j k
}
∆∆ 
BackgroundJob
»» 
.
»» 
Enqueue
»» %
(
»»% &
(
»»& '
)
»»' (
=>
»») +
CampaignProcessor
»», =
.
»»= >
SendVendorEmail
»»> M
(
»»M N
vendorId
»»N V
,
»»V W
campaign
»»X `
.
»»` a
OrderNumber
»»a l
,
»»l m
segmentsSelected
»»n ~
)
»»~ 
)»» Ä
;»»Ä Å
return
   
Json
   
(
   
new
   
JsonResponse
    ,
(
  , -
)
  - .
{
  / 0
IsSucess
  1 9
=
  : ;
true
  < @
}
  A B
,
  B C!
JsonRequestBehavior
  D W
.
  W X
AllowGet
  X `
)
  ` a
;
  a b
}
ÀÀ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÕÕ 
return
ŒŒ 
Json
ŒŒ 
(
ŒŒ 
new
ŒŒ 
JsonResponse
ŒŒ  ,
(
ŒŒ, -
)
ŒŒ- .
{
ŒŒ/ 0
IsSucess
ŒŒ1 9
=
ŒŒ: ;
false
ŒŒ< A
,
ŒŒA B
ErrorMessage
ŒŒC O
=
ŒŒP Q
ex
ŒŒR T
.
ŒŒT U
Message
ŒŒU \
}
ŒŒ] ^
,
ŒŒ^ _!
JsonRequestBehavior
ŒŒ` s
.
ŒŒs t
AllowGet
ŒŒt |
)
ŒŒ| }
;
ŒŒ} ~
}
œœ 
}
—— 	
public
”” 
ActionResult
”” 

SendViaApi
”” &
(
””& '
Guid
””' +
?
””+ ,
id
””- /
)
””/ 0
{
‘‘ 	
try
’’ 
{
÷÷ 
Campaign
◊◊ 
campaign
◊◊ !
=
◊◊" #
Db
◊◊$ &
.
◊◊& '
	Campaigns
◊◊' 0
.
ÿÿ 
Include
ÿÿ 
(
ÿÿ 
x
ÿÿ 
=>
ÿÿ !
x
ÿÿ" #
.
ÿÿ# $
Assets
ÿÿ$ *
)
ÿÿ* +
.
ŸŸ 
Include
ŸŸ 
(
ŸŸ 
x
ŸŸ 
=>
ŸŸ !
x
ŸŸ" #
.
ŸŸ# $
Segments
ŸŸ$ ,
)
ŸŸ, -
.
⁄⁄ 
Include
⁄⁄ 
(
⁄⁄ 
x
⁄⁄ 
=>
⁄⁄ !
x
⁄⁄" #
.
⁄⁄# $
Approved
⁄⁄$ ,
)
⁄⁄, -
.
€€ 
FirstOrDefault
€€ #
(
€€# $
x
€€$ %
=>
€€& (
x
€€) *
.
€€* +
Id
€€+ -
==
€€. 0
id
€€1 3
)
€€3 4
;
€€4 5
if
‹‹ 
(
‹‹ 
campaign
‹‹ 
==
‹‹ 
null
‹‹  $
)
‹‹$ %
{
›› 
throw
ﬁﬁ 
new
ﬁﬁ 
AdsException
ﬁﬁ *
(
ﬁﬁ* +
$str
ﬁﬁ+ ?
+
ﬁﬁ@ A
id
ﬁﬁB D
+
ﬁﬁE F
$str
ﬁﬁG T
)
ﬁﬁT U
;
ﬁﬁU V
}
ﬂﬂ 
if
‡‡ 
(
‡‡ 
campaign
‡‡ 
.
‡‡ 
Approved
‡‡ %
==
‡‡& (
null
‡‡) -
)
‡‡- .
{
·· 
throw
‚‚ 
new
‚‚ 
AdsException
‚‚ *
(
‚‚* +
$str
‚‚+ 7
+
‚‚8 9
campaign
‚‚: B
.
‚‚B C
CampaignName
‚‚C O
+
‚‚P Q
$str
‚‚R i
)
‚‚i j
;
‚‚j k
}
„„ 
var
ÂÂ 
segment
ÂÂ 
=
ÂÂ 
campaign
ÂÂ &
.
ÂÂ& '
Segments
ÂÂ' /
.
ÂÂ/ 0
FirstOrDefault
ÂÂ0 >
(
ÂÂ> ?
)
ÂÂ? @
;
ÂÂ@ A
string
ÊÊ 

whiteLabel
ÊÊ !
=
ÊÊ" #
string
ÊÊ$ *
.
ÊÊ* +
IsNullOrEmpty
ÊÊ+ 8
(
ÊÊ8 9
LoggedInUser
ÊÊ9 E
?
ÊÊE F
.
ÊÊF G

WhiteLabel
ÊÊG Q
)
ÊÊQ R
?
ÊÊS T
$str
ÊÊU Y
:
ÊÊZ [
LoggedInUser
ÊÊ\ h
?
ÊÊh i
.
ÊÊi j

WhiteLabel
ÊÊj t
;
ÊÊt u
string
ÁÁ 
whiteLabelDomain
ÁÁ '
=
ÁÁ( )
CustomersList
ÁÁ* 7
.
ÁÁ7 8
FirstOrDefault
ÁÁ8 F
(
ÁÁF G
x
ÁÁG H
=>
ÁÁI K
x
ÁÁL M
.
ÁÁM N
Value
ÁÁN S
==
ÁÁT V

whiteLabel
ÁÁW a
)
ÁÁa b
?
ÁÁb c
.
ÁÁc d
Text
ÁÁd h
.
ÁÁh i
Split
ÁÁi n
(
ÁÁn o
$str
ÁÁo r
.
ÁÁr s
ToCharArray
ÁÁs ~
(
ÁÁ~ 
)ÁÁ Ä
)ÁÁÄ Å
.ÁÁÅ Ç
LastOrDefaultÁÁÇ è
(ÁÁè ê
)ÁÁê ë
?ÁÁë í
.ÁÁí ì
TrimÁÁì ó
(ÁÁó ò
)ÁÁò ô
;ÁÁô ö
var
ËË 
response
ËË 
=
ËË 
ProDataApiManager
ËË 0
.
ËË0 1
Create
ËË1 7
(
ËË7 8
campaign
ËË8 @
,
ËË@ A
segment
ËËB I
,
ËËI J
whiteLabelDomain
ËËK [
)
ËË[ \
;
ËË\ ]
if
ÈÈ 
(
ÈÈ 
response
ÈÈ 
.
ÈÈ 
status
ÈÈ #
==
ÈÈ$ &
ProDataApiManager
ÈÈ' 8
.
ÈÈ8 9
Success
ÈÈ9 @
)
ÈÈ@ A
{
ÍÍ 
var
ÎÎ 
campaignTracking
ÎÎ (
=
ÎÎ) *
Db
ÏÏ 
.
ÏÏ 
CampaignTrackings
ÏÏ +
.
ÏÏ+ ,
FirstOrDefault
ÏÏ, :
(
ÏÏ: ;
x
ÏÏ; <
=>
ÏÏ= ?
x
ÏÏ@ A
.
ÏÏA B

CampaignId
ÏÏB L
==
ÏÏM O
campaign
ÏÏP X
.
ÏÏX Y
Id
ÏÏY [
&&
ÏÏ\ ^
x
ÏÏ_ `
.
ÏÏ` a
SegmentNumber
ÏÏa n
==
ÏÏo q
(
ÏÏr s
segment
ÏÏs z
!=
ÏÏ{ }
nullÏÏ~ Ç
?ÏÏÉ Ñ
segmentÏÏÖ å
.ÏÏå ç
SegmentNumberÏÏç ö
:ÏÏõ ú
nullÏÏù °
)ÏÏ° ¢
)ÏÏ¢ £
;ÏÏ£ §
if
ÓÓ 
(
ÓÓ 
campaignTracking
ÓÓ (
==
ÓÓ) +
null
ÓÓ, 0
)
ÓÓ0 1
{
ÔÔ 
var
 

trackingId
 &
=
' (
Guid
) -
.
- .
NewGuid
. 5
(
5 6
)
6 7
;
7 8
var
ÒÒ 
tracking
ÒÒ $
=
ÒÒ% &
new
ÒÒ' *
CampaignTracking
ÒÒ+ ;
(
ÒÒ; <
)
ÒÒ< =
{
ÚÚ 
Id
ÛÛ 
=
ÛÛ  

trackingId
ÛÛ! +
,
ÛÛ+ ,
	CreatedAt
ÙÙ %
=
ÙÙ& '
DateTime
ÙÙ( 0
.
ÙÙ0 1
Now
ÙÙ1 4
,
ÙÙ4 5

CampaignId
ıı &
=
ıı' (
campaign
ıı) 1
.
ıı1 2
Id
ıı2 4
,
ıı4 5
SegmentNumber
ˆˆ )
=
ˆˆ* +
segment
ˆˆ, 3
?
ˆˆ3 4
.
ˆˆ4 5
SegmentNumber
ˆˆ5 B
,
ˆˆB C
DateSent
˜˜ $
=
˜˜% &
DateTime
˜˜' /
.
˜˜/ 0
Now
˜˜0 3
,
˜˜3 4!
IsCreatedThroughApi
¯¯ /
=
¯¯0 1
true
¯¯2 6
,
¯¯6 7
QueuedCampaignId
˘˘ ,
=
˘˘- .
response
˘˘/ 7
.
˘˘7 8(
queued_pending_campaign_id
˘˘8 R
.
˘˘R S
ToString
˘˘S [
(
˘˘[ \
)
˘˘\ ]
,
˘˘] ^
}
˙˙ 
;
˙˙ 
Db
˚˚ 
.
˚˚ 
CampaignTrackings
˚˚ ,
.
˚˚, -
Add
˚˚- 0
(
˚˚0 1
tracking
˚˚1 9
)
˚˚9 :
;
˚˚: ;
campaign
¸¸  
.
¸¸  !
Status
¸¸! '
=
¸¸( )
(
¸¸* +
int
¸¸+ .
)
¸¸. /
CampaignStatus
¸¸/ =
.
¸¸= >

Monitoring
¸¸> H
;
¸¸H I
Db
˝˝ 
.
˝˝ 
SaveChanges
˝˝ &
(
˝˝& '
)
˝˝' (
;
˝˝( )
}
˛˛ 
}
ˇˇ 
else
ÄÄ 
{
ÅÅ 
StringBuilder
ÇÇ !
message
ÇÇ" )
=
ÇÇ* +
new
ÇÇ, /
StringBuilder
ÇÇ0 =
(
ÇÇ= >
response
ÇÇ> F
.
ÇÇF G
message
ÇÇG N
)
ÇÇN O
;
ÇÇO P
foreach
ÉÉ 
(
ÉÉ 
var
ÉÉ  
field
ÉÉ! &
in
ÉÉ' )
response
ÉÉ* 2
.
ÉÉ2 3
error_fields
ÉÉ3 ?
)
ÉÉ? @
{
ÑÑ 
message
ÖÖ 
.
ÖÖ  
Append
ÖÖ  &
(
ÖÖ& '
$"
ÖÖ' )
<br/>
ÖÖ) .
{
ÖÖ. /
field
ÖÖ/ 4
}
ÖÖ4 5
"
ÖÖ5 6
)
ÖÖ6 7
;
ÖÖ7 8
}
ÜÜ 
throw
áá 
new
áá 
AdsException
áá *
(
áá* +
message
áá+ 2
.
áá2 3
ToString
áá3 ;
(
áá; <
)
áá< =
)
áá= >
;
áá> ?
}
àà 
return
ää 
Json
ää 
(
ää 
new
ää 
JsonResponse
ää  ,
(
ää, -
)
ää- .
{
ää/ 0
IsSucess
ää1 9
=
ää: ;
true
ää< @
}
ääA B
,
ääB C!
JsonRequestBehavior
ääD W
.
ääW X
AllowGet
ääX `
)
ää` a
;
ääa b
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
ex
åå 
)
åå  
{
çç 
return
éé 
Json
éé 
(
éé 
new
éé 
JsonResponse
éé  ,
(
éé, -
)
éé- .
{
éé/ 0
IsSucess
éé1 9
=
éé: ;
false
éé< A
,
ééA B
ErrorMessage
ééC O
=
ééP Q
ex
ééR T
.
ééT U
Message
ééU \
}
éé] ^
,
éé^ _!
JsonRequestBehavior
éé` s
.
éés t
AllowGet
éét |
)
éé| }
;
éé} ~
}
èè 
}
ëë 	
}
ìì 
}îî ãß
GE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\BaseController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
public 

class 
BaseController 
:  !

Controller" ,
{ 
	protected 
readonly 
Random !
Random" (
=) *
new+ .
Random/ 5
(5 6
)6 7
;7 8
	protected 
const 
int 
PageSize $
=% &
$num' )
;) *
private 
WfpictContext 
_db !
;! "
	protected 
WfpictContext 
Db  "
{ 	
get 
{ 
if 
( 
_db 
!= 
null 
)  
return! '
_db( +
;+ ,
_db 
= 
HttpContext !
.! "
GetOwinContext" 0
(0 1
)1 2
.2 3
Get3 6
<6 7
WfpictContext7 D
>D E
(E F
)F G
;G H
return 
_db 
; 
} 
private 
set 
{ 
_db 
= 
value 
; 
}   
}!! 	
public## 
void## 
SetupLoggedInUser## %
(##% &
string##& ,
userName##- 5
)##5 6
{$$ 	
var%% 
user%% 
=%% 
Db%% 
.%% 
Users%% 
.%%  
Include%%  '
(%%' (
u%%( )
=>%%* ,
u%%- .
.%%. /
Roles%%/ 4
)%%4 5
.%%5 6
FirstOrDefault%%6 D
(%%D E
x%%E F
=>%%G I
x%%J K
.%%K L
UserName%%L T
==%%U W
userName%%X `
)%%` a
;%%a b
Session&& 
[&& 
$str&& 
]&& 
=&& 
user&& "
;&&" #
}'' 	
	protected)) 
WfpUser)) 
LoggedInUser)) &
{** 	
get++ 
{,, 
return-- 
Session-- 
[-- 
$str-- %
]--% &
as--' )
WfpUser--* 1
;--1 2
}.. 
}// 	
	protected11 
bool11 
IsAdmin11 
{22 	
get33 
{44 
return55 
LoggedInUser55 #
!=55$ &
null55' +
&&55, .
(55/ 0
LoggedInUser550 <
.55< =
UserType55= E
==55F H
(55I J
int55J M
)55M N
UserType55N V
.55V W
Admin55W \
)55\ ]
;55] ^
}66 
}77 	
readonly99 
string99 
_uploadPath99 #
=99$ %
$"99& (
	~/Uploads99( 1
"991 2
;992 3
	protected:: 
string:: 

UploadPath:: #
{;; 	
get<< 
{== 
string>> 

uploadPath>> !
=>>" #
Server>>$ *
.>>* +
MapPath>>+ 2
(>>2 3
_uploadPath>>3 >
)>>> ?
;>>? @
if?? 
(?? 
!?? 
System?? 
.?? 
IO?? 
.?? 
	Directory?? (
.??( )
Exists??) /
(??/ 0

uploadPath??0 :
)??: ;
)??; <
System??= C
.??C D
IO??D F
.??F G
	Directory??G P
.??P Q
CreateDirectory??Q `
(??` a

uploadPath??a k
)??k l
;??l m
return@@ 

uploadPath@@ !
;@@! "
}AA 
}BB 	
readonlyDD 
stringDD 
_downloadPathDD %
=DD& '
$"DD( *
~/DownloadsDD* 5
"DD5 6
;DD6 7
	protectedEE 
stringEE 
DownloadPathEE %
{FF 	
getGG 
{HH 
stringII 
downloadPathII #
=II$ %
ServerII& ,
.II, -
MapPathII- 4
(II4 5
_downloadPathII5 B
)IIB C
;IIC D
ifJJ 
(JJ 
!JJ 
SystemJJ 
.JJ 
IOJJ 
.JJ 
	DirectoryJJ (
.JJ( )
ExistsJJ) /
(JJ/ 0
downloadPathJJ0 <
)JJ< =
)JJ= >
SystemJJ? E
.JJE F
IOJJF H
.JJH I
	DirectoryJJI R
.JJR S
CreateDirectoryJJS b
(JJb c
downloadPathJJc o
)JJo p
;JJp q
returnKK 
downloadPathKK #
;KK# $
}LL 
}MM 	
readonlyOO 
stringOO 
_imagesPathOO #
=OO$ %
$"OO& (
~/imagesOO( 0
"OO0 1
;OO1 2
	protectedPP 
stringPP 

ImagesPathPP #
{QQ 	
getRR 
{SS 
returnTT 
ServerTT 
.TT 
MapPathTT %
(TT% &
_imagesPathTT& 1
)TT1 2
;TT2 3
}UU 
}VV 	
	protectedXX 

SelectListXX 

StatusListXX '
{YY 	
getZZ 
{[[ 
var\\ 
items\\ 
=\\ 

EnumHelper\\ &
.\\& '
GetEnumTextValues\\' 8
(\\8 9
typeof\\9 ?
(\\? @
CampaignStatus\\@ N
)\\N O
)\\O P
.]] 
Select]] 
(]] 
x]] 
=>]]  
new]]! $
SelectListItem]]% 3
(]]3 4
)]]4 5
{^^ 
Text__ 
=__ 
x__  
.__  !
Text__! %
,__% &
Value`` 
=`` 
x``  !
.``! "
Value``" '
}aa 
)aa 
.aa 
ToListaa 
(aa 
)aa 
;aa  
itemsbb 
.bb 
Insertbb 
(bb 
$numbb 
,bb 
newbb  #
SelectListItembb$ 2
(bb2 3
)bb3 4
{cc 
Textdd 
=dd 
$strdd *
,dd* +
Valueee 
=ee 
stringee "
.ee" #
Emptyee# (
}ff 
)ff 
;ff 
returngg 
newgg 

SelectListgg %
(gg% &
itemsgg& +
,gg+ ,
$strgg- 4
,gg4 5
$strgg6 <
)gg< =
;gg= >
}hh 
}ii 	
	protectedkk 
IEnumerablekk 
<kk 
SelectListItemkk ,
>kk, -
ReportTemplateskk. =
{ll 	
getmm 
{nn 
varoo 
itemsoo 
=oo 

EnumHelperoo &
.oo& '
GetEnumTextValuesoo' 8
(oo8 9
typeofoo9 ?
(oo? @
ReportTemplateoo@ N
)ooN O
)ooO P
.pp 
Selectpp 
(pp 
xpp 
=>pp  
newpp! $
SelectListItempp% 3
(pp3 4
)pp4 5
{qq 
Textrr 
=rr 
xrr  
.rr  !
Textrr! %
,rr% &
Valuess 
=ss 
xss  !
.ss! "
Valuess" '
}tt 
)tt 
.tt 
ToListtt 
(tt 
)tt 
;tt  
itemsuu 
.uu 
Insertuu 
(uu 
$numuu 
,uu 
newuu  #
SelectListItemuu$ 2
(uu2 3
)uu3 4
{vv 
Textww 
=ww 
$strww ,
,ww, -
Valuexx 
=xx 
stringxx "
.xx" #
Emptyxx# (
}yy 
)yy 
;yy 
returnzz 
itemszz 
;zz 
}{{ 
}|| 	
public~~ 
IEnumerable~~ 
<~~ 
SelectListItem~~ )
>~~) *

MonthsList~~+ 5
{ 	
get
ÄÄ 
{
ÅÅ 
var
ÇÇ 
months
ÇÇ 
=
ÇÇ 
new
ÇÇ  
List
ÇÇ! %
<
ÇÇ% &
SelectListItem
ÇÇ& 4
>
ÇÇ4 5
(
ÇÇ5 6
)
ÇÇ6 7
;
ÇÇ7 8
for
ÉÉ 
(
ÉÉ 
int
ÉÉ 
i
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
i
ÉÉ  !
<
ÉÉ" #
$num
ÉÉ$ &
;
ÉÉ& '
i
ÉÉ( )
++
ÉÉ) +
)
ÉÉ+ ,
{
ÑÑ 
months
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
SelectListItem
ÖÖ# 1
(
ÖÖ1 2
)
ÖÖ2 3
{
ÜÜ 
Text
áá 
=
áá 
CultureInfo
áá *
.
áá* +
CurrentCulture
áá+ 9
.
áá9 :
DateTimeFormat
áá: H
.
ááH I
GetMonthName
ááI U
(
ááU V
i
ááV W
+
ááX Y
$num
ááZ [
)
áá[ \
,
áá\ ]
Value
àà 
=
àà 
i
àà  !
.
àà! "
ToString
àà" *
(
àà* +
)
àà+ ,
}
ââ 
)
ââ 
;
ââ 
}
ää 
months
ãã 
.
ãã 
Insert
ãã 
(
ãã 
$num
ãã 
,
ãã  
new
ãã! $
SelectListItem
ãã% 3
(
ãã3 4
)
ãã4 5
{
åå 
Text
çç 
=
çç 
$str
çç )
,
çç) *
Value
éé 
=
éé 
string
éé "
.
éé" #
Empty
éé# (
}
èè 
)
èè 
;
èè 
return
êê 
months
êê 
;
êê 
}
ëë 
}
íí 	
private
îî 
static
îî 
List
îî 
<
îî 
SelectListItem
îî *
>
îî* +
_users
îî, 2
;
îî2 3
	protected
ïï 
IEnumerable
ïï 
<
ïï 
SelectListItem
ïï ,
>
ïï, -
	UsersList
ïï. 7
{
ññ 	
get
óó 
{
òò 
if
ôô 
(
ôô 
_users
ôô 
==
ôô 
null
ôô "
)
ôô" #
{
öö 
var
õõ 
user
õõ 
=
õõ 
Session
õõ &
[
õõ& '
$str
õõ' -
]
õõ- .
as
õõ/ 1
WfpUser
õõ2 9
;
õõ9 :
_users
úú 
=
úú 
Db
úú 
.
úú  
Users
úú  %
.
ùù 
OrderBy
ùù  
(
ùù  !
x
ùù! "
=>
ùù# %
x
ùù& '
.
ùù' (
	CreatedAt
ùù( 1
)
ùù1 2
.
ùù2 3
Select
ùù3 9
(
ùù9 :
x
ûû 
=>
ûû !
new
ûû" %
SelectListItem
ûû& 4
(
ûû4 5
)
ûû5 6
{
üü 
Text
††! %
=
††& '
x
††( )
.
††) *
UserName
††* 2
,
††2 3
Value
°°! &
=
°°' (
x
°°) *
.
°°* +
UserName
°°+ 3
}
¢¢ 
)
¢¢ 
.
¢¢  
ToList
¢¢  &
(
¢¢& '
)
¢¢' (
;
¢¢( )
_users
££ 
.
££ 
Insert
££ !
(
££! "
$num
££" #
,
££# $
new
££% (
SelectListItem
££) 7
(
££7 8
)
££8 9
{
§§ 
Text
•• 
=
•• 
$str
•• ,
,
••, -
Value
¶¶ 
=
¶¶ 
string
¶¶  &
.
¶¶& '
Empty
¶¶' ,
}
ßß 
)
ßß 
;
ßß 
}
®® 
return
©© 
_users
©© 
;
©© 
}
™™ 
}
´´ 	
private
≠≠ 
static
≠≠ 
bool
≠≠ 
_forceOrders
≠≠ (
;
≠≠( )
public
ØØ 
static
ØØ 
bool
ØØ 
ForceOrders
ØØ &
{
∞∞ 	
get
±± 
{
±± 
return
±± 
_forceOrders
±± %
;
±±% &
}
±±' (
set
≤≤ 
{
≤≤ 
_forceOrders
≤≤ 
=
≤≤  
value
≤≤! &
;
≤≤& '
}
≤≤( )
}
≥≥ 	
private
¥¥ 
List
¥¥ 
<
¥¥ 
SelectListItem
¥¥ #
>
¥¥# $
_orderNumbers
¥¥% 2
;
¥¥2 3
public
µµ 
IEnumerable
µµ 
<
µµ 
SelectListItem
µµ )
>
µµ) *
OrderNumberList
µµ+ :
{
∂∂ 	
get
∑∑ 
{
∏∏ 
if
ππ 
(
ππ 
_orderNumbers
ππ !
==
ππ" $
null
ππ% )
||
ππ* ,
_forceOrders
ππ- 9
)
ππ9 :
{
∫∫ 
_orderNumbers
ªª !
=
ªª" #
Db
ªª$ &
.
ªª& '
	Campaigns
ªª' 0
.
ºº 
OrderBy
ºº  
(
ºº  !
x
ºº! "
=>
ºº# %
x
ºº& '
.
ºº' (
	CreatedAt
ºº( 1
)
ºº1 2
.
ºº2 3
Select
ºº3 9
(
ºº9 :
x
ΩΩ 
=>
ΩΩ !
new
ΩΩ" %
SelectListItem
ΩΩ& 4
(
ΩΩ4 5
)
ΩΩ5 6
{
ææ 
Text
øø! %
=
øø& '
x
øø( )
.
øø) *
OrderNumber
øø* 5
,
øø5 6
Value
¿¿! &
=
¿¿' (
x
¿¿) *
.
¿¿* +
Id
¿¿+ -
.
¿¿- .
ToString
¿¿. 6
(
¿¿6 7
)
¿¿7 8
}
¡¡ 
)
¡¡ 
.
¡¡  
ToList
¡¡  &
(
¡¡& '
)
¡¡' (
;
¡¡( )
_orderNumbers
¬¬ !
.
¬¬! "
Insert
¬¬" (
(
¬¬( )
$num
¬¬) *
,
¬¬* +
new
¬¬, /
SelectListItem
¬¬0 >
(
¬¬> ?
)
¬¬? @
{
√√ 
Text
ƒƒ 
=
ƒƒ 
$str
ƒƒ /
,
ƒƒ/ 0
Value
≈≈ 
=
≈≈ 
string
≈≈  &
.
≈≈& '
Empty
≈≈' ,
}
∆∆ 
)
∆∆ 
;
∆∆ 
}
«« 
return
»» 
_orderNumbers
»» $
;
»»$ %
}
…… 
}
   	
private
ÃÃ 
static
ÃÃ 
bool
ÃÃ 
_forceVendors
ÃÃ )
;
ÃÃ) *
	protected
ÕÕ 
static
ÕÕ 
bool
ÕÕ 
ForceVendors
ÕÕ *
{
ŒŒ 	
get
œœ 
{
œœ 
return
œœ 
_forceVendors
œœ &
;
œœ& '
}
œœ( )
set
–– 
{
–– 
_forceVendors
–– 
=
––  !
value
––" '
;
––' (
}
––) *
}
—— 	
private
”” 
List
”” 
<
”” 
SelectListItem
”” #
>
””# $
_vendors
””% -
;
””- .
	protected
‘‘ 
IEnumerable
‘‘ 
<
‘‘ 
SelectListItem
‘‘ ,
>
‘‘, -
VendorsList
‘‘. 9
{
’’ 	
get
÷÷ 
{
◊◊ 
if
ÿÿ 
(
ÿÿ 
_vendors
ÿÿ 
==
ÿÿ 
null
ÿÿ  $
||
ÿÿ% '
_forceVendors
ÿÿ( 5
)
ÿÿ5 6
{
ŸŸ 
_vendors
⁄⁄ 
=
⁄⁄ 
Db
⁄⁄ !
.
⁄⁄! "
Vendors
⁄⁄" )
.
€€ 
OrderBy
€€  
(
€€  !
x
€€! "
=>
€€# %
x
€€& '
.
€€' (
	CreatedAt
€€( 1
)
€€1 2
.
€€2 3
Select
€€3 9
(
€€9 :
x
‹‹ 
=>
‹‹ !
new
‹‹" %
SelectListItem
‹‹& 4
(
‹‹4 5
)
‹‹5 6
{
›› 
Text
ﬁﬁ! %
=
ﬁﬁ& '
x
ﬁﬁ( )
.
ﬁﬁ) *
Name
ﬁﬁ* .
,
ﬁﬁ. /
Value
ﬂﬂ! &
=
ﬂﬂ' (
x
ﬂﬂ) *
.
ﬂﬂ* +
Id
ﬂﬂ+ -
.
ﬂﬂ- .
ToString
ﬂﬂ. 6
(
ﬂﬂ6 7
)
ﬂﬂ7 8
}
‡‡ 
)
‡‡ 
.
‡‡  
ToList
‡‡  &
(
‡‡& '
)
‡‡' (
;
‡‡( )
_vendors
·· 
.
·· 
Insert
·· #
(
··# $
$num
··$ %
,
··% &
new
··' *
SelectListItem
··+ 9
(
··9 :
)
··: ;
{
‚‚ 
Text
„„ 
=
„„ 
$str
„„ .
,
„„. /
Value
‰‰ 
=
‰‰ 
string
‰‰  &
.
‰‰& '
Empty
‰‰' ,
}
ÂÂ 
)
ÂÂ 
;
ÂÂ 
}
ÊÊ 
return
ÁÁ 
_vendors
ÁÁ 
;
ÁÁ  
}
ËË 
}
ÈÈ 	
private
ÎÎ 
static
ÎÎ 
bool
ÎÎ 
_forceCustomers
ÎÎ +
;
ÎÎ+ ,
	protected
ÏÏ 
static
ÏÏ 
bool
ÏÏ 
ForceCustomers
ÏÏ ,
{
ÌÌ 	
get
ÓÓ 
{
ÓÓ 
return
ÓÓ 
_forceCustomers
ÓÓ (
;
ÓÓ( )
}
ÓÓ* +
set
ÔÔ 
{
ÔÔ 
_forceCustomers
ÔÔ !
=
ÔÔ" #
value
ÔÔ$ )
;
ÔÔ) *
}
ÔÔ+ ,
}
 	
private
ÚÚ 
List
ÚÚ 
<
ÚÚ 
SelectListItem
ÚÚ #
>
ÚÚ# $

_customers
ÚÚ% /
;
ÚÚ/ 0
	protected
ÛÛ 
IEnumerable
ÛÛ 
<
ÛÛ 
SelectListItem
ÛÛ ,
>
ÛÛ, -
CustomersList
ÛÛ. ;
{
ÙÙ 	
get
ıı 
{
ˆˆ 
if
˜˜ 
(
˜˜ 

_customers
˜˜ 
==
˜˜ !
null
˜˜" &
||
˜˜' )
_forceCustomers
˜˜* 9
)
˜˜9 :
{
¯¯ 

_customers
˘˘ 
=
˘˘  
Db
˘˘! #
.
˘˘# $
	Customers
˘˘$ -
.
˙˙ 
OrderBy
˙˙  
(
˙˙  !
x
˙˙! "
=>
˙˙# %
x
˙˙& '
.
˙˙' (
	CreatedAt
˙˙( 1
)
˙˙1 2
.
˙˙2 3
Select
˙˙3 9
(
˙˙9 :
x
˚˚ 
=>
˚˚ !
new
˚˚" %
SelectListItem
˚˚& 4
(
˚˚4 5
)
˚˚5 6
{
¸¸ 
Text
˝˝! %
=
˝˝& '
x
˝˝( )
.
˝˝) *
Name
˝˝* .
+
˝˝/ 0
$str
˝˝1 6
+
˝˝7 8
x
˝˝9 :
.
˝˝: ;
	WebDomain
˝˝; D
,
˝˝D E
Value
˛˛! &
=
˛˛' (
x
˛˛) *
.
˛˛* +
Code
˛˛+ /
}
ˇˇ 
)
ˇˇ 
.
ˇˇ  
ToList
ˇˇ  &
(
ˇˇ& '
)
ˇˇ' (
;
ˇˇ( )

_customers
ÄÄ 
.
ÄÄ 
Insert
ÄÄ %
(
ÄÄ% &
$num
ÄÄ& '
,
ÄÄ' (
new
ÄÄ) ,
SelectListItem
ÄÄ- ;
(
ÄÄ; <
)
ÄÄ< =
{
ÅÅ 
Text
ÇÇ 
=
ÇÇ 
$str
ÇÇ 0
,
ÇÇ0 1
Value
ÉÉ 
=
ÉÉ 
string
ÉÉ  &
.
ÉÉ& '
Empty
ÉÉ' ,
}
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
return
ÜÜ 

_customers
ÜÜ !
;
ÜÜ! "
}
áá 
}
àà 	
private
ää 
List
ää 
<
ää 
SelectListItem
ää #
>
ää# $
_claimTypes
ää% 0
;
ää0 1
public
ãã 
IEnumerable
ãã 
<
ãã 
SelectListItem
ãã )
>
ãã) *

ClaimTypes
ãã+ 5
{
åå 	
get
çç 
{
éé 
if
èè 
(
èè 
_claimTypes
èè 
==
èè  "
null
èè# '
)
èè' (
{
êê 
var
ëë 
mgr
ëë 
=
ëë 
new
ëë !!
AspNetClaimsManager
ëë" 5
(
ëë5 6
)
ëë6 7
;
ëë7 8
_claimTypes
íí 
=
íí  !
mgr
íí" %
.
íí% &
GetAll
íí& ,
(
íí, -
)
íí- .
.
íí. /
Select
íí/ 5
(
íí5 6
x
ìì 
=>
ìì 
new
ìì 
SelectListItem
ìì +
(
ìì+ ,
)
ìì, -
{
îî 
Text
ïï 
=
ïï 
x
ïï  
.
ïï  !
	ClaimType
ïï! *
,
ïï* +
Value
ññ 
=
ññ 
x
ññ  !
.
ññ! "
	ClaimType
ññ" +
}
óó 
)
óó 
.
óó 
Distinct
óó 
(
óó  
)
óó  !
.
óó! "
ToList
óó" (
(
óó( )
)
óó) *
;
óó* +
_claimTypes
òò 
.
òò  
Insert
òò  &
(
òò& '
$num
òò' (
,
òò( )
new
òò* -
SelectListItem
òò. <
(
òò< =
)
òò= >
{
ôô 
Text
öö 
=
öö 
$str
öö 0
,
öö0 1
Value
õõ 
=
õõ 
string
õõ  &
.
õõ& '
Empty
õõ' ,
}
úú 
)
úú 
;
úú 
}
ùù 
return
ûû 
_claimTypes
ûû "
;
ûû" #
}
üü 
}
†† 	
}
¢¢ 
}££ Ò
OE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\NotificationController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[		 
	Authorize		 
]		 
public

 

class

 "
NotificationController

 '
:

( )
BaseController

* 8
{ 
public 
ActionResult 
Index !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
var 
notifications 
= 
Db  "
." #
Notifications# 0
.0 1
Where1 6
(6 7
x7 8
=>9 ;
x< =
.= >
Status> D
==E G
(H I
intI L
)L M
NotificationStatusM _
._ `
Found` e
)e f
.f g
ToListg m
(m n
)n o
;o p
int 

pageNumber 
= 
( 
sc  
.  !
page! %
??& (
$num) *
)* +
;+ ,
return 
View 
( 
notifications %
.% &
ToPagedList& 1
(1 2

pageNumber2 <
,< =
PageSize> F
)F G
)G H
;H I
} 	
}
ßß 
}®® ≤Â
IE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\StatusController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
StatusController !
:" #
BaseController$ 2
{ 
public 
ActionResult 
Index !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
sc& (
.( )
clearSessionId) 7
)7 8
)8 9
{ 
Session 
[ 
$str 
] 
= 
null  $
;$ %
sc 
. 
basicString 
=  
string! '
.' (
Empty( -
;- .
} 
ViewBag 
. 
CurrentSort 
=  !
sc" $
.$ %
	sortOrder% .
;. /
ViewBag 
.  
CampaignNameSortParm (
=) *
sc+ -
.- .
	sortOrder. 7
==8 :
$str; I
?J K
$strL _
:` a
$strb p
;p q
ViewBag 
. !
BroadcastDateSortParm )
=* +
sc, .
.. /
	sortOrder/ 8
==9 ;
$str< K
?L M
$strN b
:c d
$stre t
;t u
ViewBag 
. 
CreatedBySortParm %
=& '
sc( *
.* +
	sortOrder+ 4
==5 7
$str8 C
?D E
$strF V
:W X
$strY d
;d e
ViewBag 
. 
StatusSortParm "
=# $
sc% '
.' (
	sortOrder( 1
==2 4
$str5 =
?> ?
$str@ M
:N O
$strP X
;X Y
ViewBag 
. 
OrderNumberSortParm '
=( )
sc* ,
., -
	sortOrder- 6
==7 9
$str: G
?H I
$strJ \
:] ^
$str_ l
;l m
var!! 
	campagins!! 
=!! 
Db!! 
.!! 
	Campaigns!! (
."" 
Include"" 
("" 
x"" 
=>"" 
x"" 
.""  
Testing""  '
)""' (
.## 
Include## 
(## 
x## 
=>## 
x## 
.##  
Approved##  (
)##( )
.$$ 
Include$$ 
($$ 
x$$ 
=>$$ 
x$$ 
.$$  
	Trackings$$  )
)$$) *
.%% 
ToList%% 
(%% 
)%% 
;%% 
switch'' 
('' 
sc'' 
.'' 
	sortOrder''  
)''  !
{(( 
case)) 
$str)) #
:))# $
	campagins** 
=** 
	campagins**  )
.**) *
OrderBy*** 1
(**1 2
s**2 3
=>**4 6
s**7 8
.**8 9
CampaignName**9 E
)**E F
.**F G
ToList**G M
(**M N
)**N O
;**O P
break++ 
;++ 
case,, 
$str,, (
:,,( )
	campagins-- 
=-- 
	campagins--  )
.--) *
OrderByDescending--* ;
(--; <
s--< =
=>--> @
s--A B
.--B C
CampaignName--C O
)--O P
.--P Q
ToList--Q W
(--W X
)--X Y
;--Y Z
break.. 
;.. 
case// 
$str// $
://$ %
	campagins00 
=00 
	campagins00  )
.00) *
OrderBy00* 1
(001 2
s002 3
=>004 6
s007 8
.008 9
BroadcastDate009 F
)00F G
.00G H
ToList00H N
(00N O
)00O P
;00P Q
break11 
;11 
case22 
$str22 )
:22) *
	campagins33 
=33 
	campagins33  )
.33) *
OrderByDescending33* ;
(33; <
s33< =
=>33> @
s33A B
.33B C
BroadcastDate33C P
)33P Q
.33Q R
ToList33R X
(33X Y
)33Y Z
;33Z [
break44 
;44 
case55 
$str55  
:55  !
	campagins66 
=66 
	campagins66  )
.66) *
OrderBy66* 1
(661 2
s662 3
=>664 6
s667 8
.668 9
	CreatedBy669 B
)66B C
.66C D
ToList66D J
(66J K
)66K L
;66L M
break77 
;77 
case88 
$str88 %
:88% &
	campagins99 
=99 
	campagins99  )
.99) *
OrderByDescending99* ;
(99; <
s99< =
=>99> @
s99A B
.99B C
	CreatedBy99C L
)99L M
.99M N
ToList99N T
(99T U
)99U V
;99V W
break:: 
;:: 
case;; 
$str;; 
:;; 
	campagins<< 
=<< 
	campagins<<  )
.<<) *
OrderBy<<* 1
(<<1 2
s<<2 3
=><<4 6
s<<7 8
.<<8 9
Status<<9 ?
)<<? @
.<<@ A
ToList<<A G
(<<G H
)<<H I
;<<I J
break== 
;== 
case>> 
$str>> "
:>>" #
	campagins?? 
=?? 
	campagins??  )
.??) *
OrderByDescending??* ;
(??; <
s??< =
=>??> @
s??A B
.??B C
Status??C I
)??I J
.??J K
ToList??K Q
(??Q R
)??R S
;??S T
break@@ 
;@@ 
caseAA 
$strAA "
:AA" #
	campaginsBB 
=BB 
	campaginsBB  )
.BB) *
OrderByBB* 1
(BB1 2
sBB2 3
=>BB4 6
sBB7 8
.BB8 9
OrderNumberBB9 D
)BBD E
.BBE F
ToListBBF L
(BBL M
)BBM N
;BBN O
breakCC 
;CC 
caseDD 
$strDD '
:DD' (
	campaginsEE 
=EE 
	campaginsEE  )
.EE) *
OrderByDescendingEE* ;
(EE; <
sEE< =
=>EE> @
sEEA B
.EEB C
OrderNumberEEC N
)EEN O
.EEO P
ToListEEP V
(EEV W
)EEW X
;EEX Y
breakFF 
;FF 
defaultGG 
:GG 
	campaginsHH 
=HH 
	campaginsHH  )
.HH) *
OrderByDescendingHH* ;
(HH; <
sHH< =
=>HH> @
sHHA B
.HHB C
	CreatedAtHHC L
)HHL M
.HHM N
ToListHHN T
(HHT U
)HHU V
;HHV W
breakII 
;II 
}JJ 
ViewBagLL 
.LL 

SearchTypeLL 
=LL  
scLL! #
.LL# $

searchTypeLL$ .
;LL. /
ifMM 
(MM 
scMM 
.MM 

searchTypeMM 
==MM  
$strMM! (
)MM( )
{NN 
ifOO 
(OO 
!OO 
stringOO 
.OO 
IsNullOrEmptyOO )
(OO) *
scOO* ,
.OO, -
basicStringOO- 8
)OO8 9
)OO9 :
{PP 
	campaginsQQ 
=QQ 
	campaginsQQ  )
.QQ) *
WhereQQ* /
(QQ/ 0
sQQ0 1
=>QQ2 4
sRR 
.RR 
OrderNumberRR !
.RR! "
EqualsRR" (
(RR( )
scRR) +
.RR+ ,
basicStringRR, 7
)RR7 8
||RR9 ;
sSS 
.SS $
ReBroadcastedOrderNumberSS .
==SS/ 1
scSS2 4
.SS4 5
basicStringSS5 @
||SSA C
sTT 
.TT 
CampaignNameTT "
.TT" #
IndexOfTT# *
(TT* +
scTT+ -
.TT- .
basicStringTT. 9
,TT9 :
StringComparisonTT; K
.TTK L&
InvariantCultureIgnoreCaseTTL f
)TTf g
>=TTh j
$numTTk l
)TTl m
.TTm n
ToListTTn t
(TTt u
)TTu v
;TTv w
ViewBagUU 
.UU 
BasicStringSearchedUU /
=UU0 1
scUU2 4
.UU4 5
basicStringUU5 @
;UU@ A
}VV 
elseWW 
ifWW 
(WW 
!WW 
stringWW  
.WW  !
IsNullOrEmptyWW! .
(WW. /
scWW/ 1
.WW1 2
basicStatusWW2 =
)WW= >
)WW> ?
{XX 
intYY 
statusYY 
=YY  
intYY! $
.YY$ %
ParseYY% *
(YY* +
scYY+ -
.YY- .
basicStatusYY. 9
)YY9 :
;YY: ;
ifZZ 
(ZZ 
statusZZ 
==ZZ !
(ZZ" #
intZZ# &
)ZZ& '
CampaignStatusZZ' 5
.ZZ5 6
RebroadcastedZZ6 C
)ZZC D
	campagins[[ !
=[[" #
	campagins[[$ -
.[[- .
Where[[. 3
([[3 4
s[[4 5
=>[[6 8
s[[9 :
.[[: ;
ReBroadcasted[[; H
)[[H I
.[[I J
ToList[[J P
([[P Q
)[[Q R
;[[R S
else\\ 
if\\ 
(\\ 
status\\ #
==\\$ &
(\\' (
int\\( +
)\\+ ,
CampaignStatus\\, :
.\\: ;
NotRebroadcasted\\; K
)\\K L
	campagins]] !
=]]" #
	campagins]]$ -
.]]- .
Where]]. 3
(]]3 4
s]]4 5
=>]]6 8
s]]9 :
.]]: ;
ReBroadCast]]; F
&&]]G I
!]]J K
s]]K L
.]]L M
ReBroadcasted]]M Z
)]]Z [
.]][ \
ToList]]\ b
(]]b c
)]]c d
;]]d e
else^^ 
	campagins__ !
=__" #
	campagins__$ -
.__- .
Where__. 3
(__3 4
s__4 5
=>__6 8
s__9 :
.__: ;
Status__; A
==__B D
status__E K
)__K L
.__L M
ToList__M S
(__S T
)__T U
;__U V
ViewBag`` 
.`` 
BasicStatusSearched`` /
=``0 1
sc``2 4
.``4 5
basicStatus``5 @
;``@ A
}aa 
elsebb 
ifbb 
(bb 
!bb 
stringbb  
.bb  !
IsNullOrEmptybb! .
(bb. /
scbb/ 1
.bb1 2
basicOrderNumberbb2 B
)bbB C
)bbC D
{cc 
	campaginsdd 
=dd 
	campaginsdd  )
.dd) *
Wheredd* /
(dd/ 0
sdd0 1
=>dd2 4
sdd5 6
.dd6 7
Iddd7 9
.dd9 :
ToStringdd: B
(ddB C
)ddC D
.ddD E
EqualsddE K
(ddK L
scddL N
.ddN O
basicOrderNumberddO _
)dd_ `
)dd` a
.dda b
ToListddb h
(ddh i
)ddi j
;ddj k
}ee 
}ff 
elsegg 
ifgg 
(gg 
scgg 
.gg 

searchTypegg "
==gg# %
$strgg& 0
)gg0 1
{hh 
ifii 
(ii 
!ii 
stringii 
.ii 
IsNullOrEmptyii )
(ii) *
scii* ,
.ii, -
advancedStatusii- ;
)ii; <
)ii< =
{jj 
intkk 
statuskk 
=kk  
intkk! $
.kk$ %
Parsekk% *
(kk* +
sckk+ -
.kk- .
advancedStatuskk. <
)kk< =
;kk= >
ifll 
(ll 
statusll 
==ll !
(ll" #
intll# &
)ll& '
CampaignStatusll' 5
.ll5 6
Rebroadcastedll6 C
)llC D
	campaginsmm !
=mm" #
	campaginsmm$ -
.mm- .
Wheremm. 3
(mm3 4
smm4 5
=>mm6 8
smm9 :
.mm: ;
OrderNumbermm; F
.mmF G
EndsWithmmG O
(mmO P
$strmmP U
)mmU V
)mmV W
.mmW X
ToListmmX ^
(mm^ _
)mm_ `
;mm` a
elsenn 
	campaginsoo !
=oo" #
	campaginsoo$ -
.oo- .
Whereoo. 3
(oo3 4
soo4 5
=>oo6 8
soo9 :
.oo: ;
Statusoo; A
==ooB D
statusooE K
)ooK L
.ooL M
ToListooM S
(ooS T
)ooT U
;ooU V
ViewBagpp 
.pp "
AdvancedStatusSearchedpp 2
=pp3 4
scpp5 7
.pp7 8
advancedStatuspp8 F
;ppF G
}qq 
ifrr 
(rr 
!rr 
stringrr 
.rr 
IsNullOrEmptyrr )
(rr) *
scrr* ,
.rr, -
advancedUserrr- 9
)rr9 :
)rr: ;
{ss 
	campaginstt 
=tt 
	campaginstt  )
.tt) *
Wherett* /
(tt/ 0
stt0 1
=>tt2 4
stt5 6
.tt6 7
	CreatedBytt7 @
==ttA C
scttD F
.ttF G
advancedUserttG S
)ttS T
.ttT U
ToListttU [
(tt[ \
)tt\ ]
;tt] ^
ViewBaguu 
.uu  
AdvancedUserSearcheduu 0
=uu1 2
scuu3 5
.uu5 6
advancedUseruu6 B
;uuB C
}vv 
ifxx 
(xx 
!xx 
stringxx 
.xx 
IsNullOrEmptyxx )
(xx) *
scxx* ,
.xx, -
campaignNamexx- 9
)xx9 :
)xx: ;
{yy 
sczz 
.zz 
campaignNamezz #
=zz$ %
sczz& (
.zz( )
campaignNamezz) 5
.zz5 6
ToLowerInvariantzz6 F
(zzF G
)zzG H
;zzH I
	campagins{{ 
={{ 
	campagins{{  )
.{{) *
Where{{* /
({{/ 0
s{{0 1
=>{{2 4
s{{5 6
.{{6 7
CampaignName{{7 C
.{{C D
IndexOf{{D K
({{K L
sc{{L N
.{{N O
campaignName{{O [
,{{[ \
StringComparison{{] m
.{{m n%
CurrentCultureIgnoreCase	{{n Ü
)
{{Ü á
>=
{{à ä
$num
{{ã å
)
{{å ç
.
{{ç é
ToList
{{é î
(
{{î ï
)
{{ï ñ
;
{{ñ ó
ViewBag|| 
.|| 
CampaignName|| (
=||) *
sc||+ -
.||- .
campaignName||. :
;||: ;
}}} 
if 
( 
! 
string 
. 
IsNullOrEmpty )
() *
sc* ,
., -
isTested- 5
)5 6
)6 7
{
ÄÄ 
bool
ÅÅ 
IsTested
ÅÅ !
=
ÅÅ" #
Boolean
ÅÅ$ +
.
ÅÅ+ ,
Parse
ÅÅ, 1
(
ÅÅ1 2
sc
ÅÅ2 4
.
ÅÅ4 5
isTested
ÅÅ5 =
)
ÅÅ= >
;
ÅÅ> ?
	campagins
ÇÇ 
=
ÇÇ 
	campagins
ÇÇ  )
.
ÇÇ) *
Where
ÇÇ* /
(
ÇÇ/ 0
s
ÇÇ0 1
=>
ÇÇ2 4
s
ÇÇ5 6
.
ÇÇ6 7
Testing
ÇÇ7 >
!=
ÇÇ? A
null
ÇÇB F
&&
ÉÉ2 4
s
ÉÉ5 6
.
ÉÉ6 7
Testing
ÉÉ7 >
?
ÉÉ> ?
.
ÉÉ? @
IsTested
ÉÉ@ H
==
ÉÉI K
IsTested
ÉÉL T
)
ÉÉT U
.
ÉÉU V
ToList
ÉÉV \
(
ÉÉ\ ]
)
ÉÉ] ^
;
ÉÉ^ _
ViewBag
ÑÑ 
.
ÑÑ 
IsTested
ÑÑ $
=
ÑÑ% &
sc
ÑÑ' )
.
ÑÑ) *
isTested
ÑÑ* 2
;
ÑÑ2 3
}
ÖÖ 
if
áá 
(
áá 
!
áá 
string
áá 
.
áá 
IsNullOrEmpty
áá )
(
áá) *
sc
áá* ,
.
áá, -
orderedFrom
áá- 8
)
áá8 9
)
áá9 :
{
àà 
DateTime
ââ 
dateFrom
ââ %
=
ââ& '
DateTime
ââ( 0
.
ââ0 1

ParseExact
ââ1 ;
(
ââ; <
sc
ââ< >
.
ââ> ?
orderedFrom
ââ? J
,
ââJ K
$str
ââL X
,
ââX Y
CultureInfo
ââZ e
.
ââe f
InvariantCulture
ââf v
)
ââv w
;
ââw x
	campagins
ää 
=
ää 
	campagins
ää  )
.
ää) *
Where
ää* /
(
ää/ 0
s
ää0 1
=>
ää2 4
s
ää5 6
.
ää6 7
	CreatedAt
ää7 @
.
ää@ A
Date
ääA E
>=
ääF H
dateFrom
ääI Q
.
ääQ R
Date
ääR V
)
ääV W
.
ääW X
ToList
ääX ^
(
ää^ _
)
ää_ `
;
ää` a
ViewBag
ãã 
.
ãã 
OrderedFrom
ãã '
=
ãã( )
sc
ãã* ,
.
ãã, -
orderedFrom
ãã- 8
;
ãã8 9
}
åå 
if
éé 
(
éé 
!
éé 
string
éé 
.
éé 
IsNullOrEmpty
éé )
(
éé) *
sc
éé* ,
.
éé, -
	orderedTo
éé- 6
)
éé6 7
)
éé7 8
{
èè 
DateTime
êê 
dateTo
êê #
=
êê$ %
DateTime
êê& .
.
êê. /

ParseExact
êê/ 9
(
êê9 :
sc
êê: <
.
êê< =
	orderedTo
êê= F
,
êêF G
$str
êêH T
,
êêT U
CultureInfo
êêV a
.
êêa b
InvariantCulture
êêb r
)
êêr s
;
êês t
	campagins
ëë 
=
ëë 
	campagins
ëë  )
.
ëë) *
Where
ëë* /
(
ëë/ 0
s
ëë0 1
=>
ëë2 4
s
ëë5 6
.
ëë6 7
	CreatedAt
ëë7 @
.
ëë@ A
Date
ëëA E
<=
ëëF H
dateTo
ëëI O
.
ëëO P
Date
ëëP T
)
ëëT U
.
ëëU V
ToList
ëëV \
(
ëë\ ]
)
ëë] ^
;
ëë^ _
ViewBag
íí 
.
íí 
	OrderedTo
íí %
=
íí& '
sc
íí( *
.
íí* +
	orderedTo
íí+ 4
;
íí4 5
}
ìì 
if
ïï 
(
ïï 
!
ïï 
string
ïï 
.
ïï 
IsNullOrEmpty
ïï )
(
ïï) *
sc
ïï* ,
.
ïï, -
broadcastFrom
ïï- :
)
ïï: ;
)
ïï; <
{
ññ 
DateTime
óó 
dateFrom
óó %
=
óó& '
DateTime
óó( 0
.
óó0 1

ParseExact
óó1 ;
(
óó; <
sc
óó< >
.
óó> ?
broadcastFrom
óó? L
,
óóL M
$str
óóN Z
,
óóZ [
CultureInfo
óó\ g
.
óóg h
InvariantCulture
óóh x
)
óóx y
;
óóy z
	campagins
òò 
=
òò 
	campagins
òò  )
.
òò) *
Where
òò* /
(
òò/ 0
s
òò0 1
=>
òò2 4
s
òò5 6
.
òò6 7
BroadcastDate
òò7 D
?
òòD E
.
òòE F
Date
òòF J
>=
òòK M
dateFrom
òòN V
.
òòV W
Date
òòW [
)
òò[ \
.
òò\ ]
ToList
òò] c
(
òòc d
)
òòd e
;
òòe f
ViewBag
ôô 
.
ôô 
BroadcastFrom
ôô )
=
ôô* +
sc
ôô, .
.
ôô. /
broadcastFrom
ôô/ <
;
ôô< =
}
öö 
if
úú 
(
úú 
!
úú 
string
úú 
.
úú 
IsNullOrEmpty
úú )
(
úú) *
sc
úú* ,
.
úú, -
broadcastTo
úú- 8
)
úú8 9
)
úú9 :
{
ùù 
DateTime
ûû 
dateTo
ûû #
=
ûû$ %
DateTime
ûû& .
.
ûû. /

ParseExact
ûû/ 9
(
ûû9 :
sc
ûû: <
.
ûû< =
broadcastTo
ûû= H
,
ûûH I
$str
ûûJ V
,
ûûV W
CultureInfo
ûûX c
.
ûûc d
InvariantCulture
ûûd t
)
ûût u
;
ûûu v
	campagins
üü 
=
üü 
	campagins
üü  )
.
üü) *
Where
üü* /
(
üü/ 0
s
üü0 1
=>
üü2 4
s
üü5 6
.
üü6 7
BroadcastDate
üü7 D
?
üüD E
.
üüE F
Date
üüF J
<=
üüK M
dateTo
üüN T
.
üüT U
Date
üüU Y
)
üüY Z
.
üüZ [
ToList
üü[ a
(
üüa b
)
üüb c
;
üüc d
ViewBag
†† 
.
†† 
BroadcastTo
†† '
=
††( )
sc
††* ,
.
††, -
broadcastTo
††- 8
;
††8 9
}
°° 
}
¢¢ 
if
§§ 
(
§§ 
!
§§ 
IsAdmin
§§ 
)
§§ 
{
•• 
	campagins
¶¶ 
=
¶¶ 
	campagins
¶¶ %
.
¶¶% &
Where
¶¶& +
(
¶¶+ ,
s
¶¶, -
=>
¶¶. 0
s
¶¶1 2
.
¶¶2 3
	CreatedBy
¶¶3 <
==
¶¶= ?
LoggedInUser
¶¶@ L
?
¶¶L M
.
¶¶M N
UserName
¶¶N V
)
¶¶V W
.
¶¶W X
ToList
¶¶X ^
(
¶¶^ _
)
¶¶_ `
;
¶¶` a
}
ßß 
ViewBag
©© 
.
©© 
BasicOrderNumber
©© $
=
©©% &
OrderNumberList
©©' 6
;
©©6 7
ViewBag
™™ 
.
™™ 
BasicStatus
™™ 
=
™™  !

StatusList
™™" ,
;
™™, -
ViewBag
´´ 
.
´´ 
AdvancedStatus
´´ "
=
´´# $

StatusList
´´% /
;
´´/ 0
ViewBag
¨¨ 
.
¨¨ 
AdvancedUser
¨¨  
=
¨¨! "
	UsersList
¨¨# ,
;
¨¨, -
ViewBag
≠≠ 
.
≠≠ 
Customer
≠≠ 
=
≠≠ 
	UsersList
≠≠ (
;
≠≠( )
int
∞∞ 

pageNumber
∞∞ 
=
∞∞ 
(
∞∞ 
sc
∞∞  
.
∞∞  !
page
∞∞! %
??
∞∞& (
$num
∞∞) *
)
∞∞* +
;
∞∞+ ,
return
±± 
View
±± 
(
±± 
	campagins
±± !
.
±±! "
ToPagedList
±±" -
(
±±- .

pageNumber
±±. 8
,
±±8 9
PageSize
±±: B
)
±±B C
)
±±C D
;
±±D E
}
≤≤ 	
public
¥¥ 
ActionResult
¥¥ 
ChangeAssigned
¥¥ *
(
¥¥* +
Guid
¥¥+ /
?
¥¥/ 0
Id
¥¥1 3
,
¥¥3 4
string
¥¥5 ;
UserId
¥¥< B
)
¥¥B C
{
µµ 	
Campaign
∂∂ 
campaign
∂∂ 
=
∂∂ 
Db
∂∂  "
.
∂∂" #
	Campaigns
∂∂# ,
.
∂∂, -
FirstOrDefault
∂∂- ;
(
∂∂; <
x
∂∂< =
=>
∂∂> @
x
∂∂A B
.
∂∂B C
Id
∂∂C E
==
∂∂F H
Id
∂∂I K
)
∂∂K L
;
∂∂L M
if
∑∑ 
(
∑∑ 
campaign
∑∑ 
==
∑∑ 
null
∑∑  
)
∑∑  !
{
∏∏ 
throw
ππ 
new
ππ 
HttpException
ππ '
(
ππ' (
$num
ππ( +
,
ππ+ ,
$str
ππ- 8
)
ππ8 9
;
ππ9 :
}
∫∫ 
try
ªª 
{
ºº 
campaign
ΩΩ 
.
ΩΩ  
AssignedToCustomer
ΩΩ +
=
ΩΩ, -
UserId
ΩΩ. 4
;
ΩΩ4 5
Db
ææ 
.
ææ 
SaveChanges
ææ 
(
ææ 
)
ææ  
;
ææ  !
return
øø 
Json
øø 
(
øø 
new
øø 
JsonResponse
øø  ,
(
øø, -
)
øø- .
{
øø/ 0
IsSucess
øø1 9
=
øø: ;
true
øø< @
}
øøA B
,
øøB C!
JsonRequestBehavior
øøD W
.
øøW X
AllowGet
øøX `
)
øø` a
;
øøa b
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¬¬ 
return
√√ 
Json
√√ 
(
√√ 
new
√√ 
JsonResponse
√√  ,
(
√√, -
)
√√- .
{
√√/ 0
IsSucess
√√1 9
=
√√: ;
false
√√< A
,
√√A B
ErrorMessage
√√C O
=
√√P Q
ex
√√R T
.
√√T U
Message
√√U \
}
√√] ^
,
√√^ _!
JsonRequestBehavior
√√` s
.
√√s t
AllowGet
√√t |
)
√√| }
;
√√} ~
}
ƒƒ 
}
≈≈ 	
public
«« 
ActionResult
«« 
SendToTracking
«« *
(
««* +
Guid
««+ /
?
««/ 0
id
««1 3
,
««3 4
string
««5 ;
segmentNumber
««< I
,
««I J
string
««K Q
ioNumber
««R Z
)
««Z [
{
»» 	
Campaign
…… 
campaign
…… 
=
…… 
Db
……  "
.
……" #
	Campaigns
……# ,
.
……, -
FirstOrDefault
……- ;
(
……; <
x
……< =
=>
……> @
x
……A B
.
……B C
Id
……C E
==
……F H
id
……I K
)
……K L
;
……L M
if
   
(
   
campaign
   
==
   
null
    
)
    !
{
ÀÀ 
throw
ÃÃ 
new
ÃÃ 
HttpException
ÃÃ '
(
ÃÃ' (
$num
ÃÃ( +
,
ÃÃ+ ,
$str
ÃÃ- 8
)
ÃÃ8 9
;
ÃÃ9 :
}
ÕÕ 
try
ŒŒ 
{
œœ 
CampaignTracking
––  
campaignTracking
––! 1
=
––2 3
null
––4 8
;
––8 9
if
““ 
(
““ 
string
““ 
.
““ 
IsNullOrEmpty
““ '
(
““' (
segmentNumber
““( 5
)
““5 6
)
““6 7
campaignTracking
”” $
=
””% &
Db
””' )
.
””) *
CampaignTrackings
””* ;
.
””; <
FirstOrDefault
””< J
(
””J K
x
””K L
=>
””M O
x
””P Q
.
””Q R

CampaignId
””R \
==
””] _
id
””` b
)
””b c
;
””c d
else
‘‘ 
campaignTracking
’’ $
=
’’% &
Db
’’' )
.
’’) *
CampaignTrackings
’’* ;
.
’’; <
FirstOrDefault
’’< J
(
’’J K
x
’’K L
=>
’’M O
x
’’P Q
.
’’Q R

CampaignId
’’R \
==
’’] _
id
’’` b
&&
’’c e
x
’’f g
.
’’g h
SegmentNumber
’’h u
==
’’v x
segmentNumber’’y Ü
)’’Ü á
;’’á à
if
◊◊ 
(
◊◊ 
campaignTracking
◊◊ $
!=
◊◊% '
null
◊◊( ,
)
◊◊, -
{
ÿÿ 
campaignTracking
ŸŸ $
.
ŸŸ$ %
IoNumber
ŸŸ% -
=
ŸŸ. /
ioNumber
ŸŸ0 8
;
ŸŸ8 9
}
⁄⁄ 
campaign
€€ 
.
€€ 
Status
€€ 
=
€€  !
(
€€" #
int
€€# &
)
€€& '
CampaignStatus
€€( 6
.
€€6 7

Monitoring
€€7 A
;
€€A B
Db
‹‹ 
.
‹‹ 
SaveChanges
‹‹ 
(
‹‹ 
)
‹‹  
;
‹‹  !
return
›› 
Json
›› 
(
›› 
new
›› 
JsonResponse
››  ,
(
››, -
)
››- .
{
››/ 0
IsSucess
››1 9
=
››: ;
true
››< @
}
››A B
,
››B C!
JsonRequestBehavior
››D W
.
››W X
AllowGet
››X `
)
››` a
;
››a b
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
	Exception
ﬂﬂ 
ex
ﬂﬂ 
)
ﬂﬂ  
{
‡‡ 
return
·· 
Json
·· 
(
·· 
new
·· 
JsonResponse
··  ,
(
··, -
)
··- .
{
··/ 0
IsSucess
··1 9
=
··: ;
false
··< A
,
··A B
ErrorMessage
··C O
=
··P Q
ex
··R T
.
··T U
Message
··U \
}
··] ^
,
··^ _!
JsonRequestBehavior
··` s
.
··s t
AllowGet
··t |
)
··| }
;
··} ~
}
‚‚ 
}
„„ 	
}
‰‰ 
}ÂÂ Öó
LE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\CampaignsController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
CampaignsController $
:% &
BaseController' 5
{ 
private 
static 
char 
c1 
; 
public 
ActionResult 
Index !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
if 
( 
LoggedInUser 
== 
null  $
)$ %
return& ,
RedirectToAction- =
(= >
$str> F
,F G
$strH Q
)Q R
;R S
ViewBag!! 
.!! 
CurrentSort!! 
=!!  !
sc!!" $
.!!$ %
	sortOrder!!% .
;!!. /
ViewBag"" 
."" 
OrderNumberSortParm"" '
=""( )
sc""* ,
."", -
	sortOrder""- 6
==""7 9
$str"": G
?""H I
$str""J \
:""] ^
$str""_ l
;""l m
ViewBag## 
.##  
CampaignNameSortParm## (
=##) *
sc##+ -
.##- .
	sortOrder##. 7
==##8 :
$str##; I
?##J K
$str##L _
:##` a
$str##b p
;##p q
ViewBag$$ 
.$$ 
CreatedBySortParm$$ %
=$$& '
sc$$( *
.$$* +
	sortOrder$$+ 4
==$$5 7
$str$$8 C
?$$D E
$str$$F V
:$$W X
$str$$Y d
;$$d e
ViewBag%% 
.%% 
CreatedAtSortParm%% %
=%%& '
sc%%( *
.%%* +
	sortOrder%%+ 4
==%%5 7
$str%%8 C
?%%D E
$str%%F V
:%%W X
$str%%Y d
;%%d e
ViewBag&& 
.&& !
BroadcastDateSortParm&& )
=&&* +
sc&&, .
.&&. /
	sortOrder&&/ 8
==&&9 ;
$str&&< K
?&&L M
$str&&N b
:&&c d
$str&&e t
;&&t u
ViewBag'' 
.'' 
QuantitySortParm'' $
=''% &
sc''' )
.'') *
	sortOrder''* 3
==''4 6
$str''7 A
?''B C
$str''D S
:''T U
$str''V `
;''` a
ViewBag(( 
.(( 
StatusSortParm(( "
=((# $
sc((% '
.((' (
	sortOrder((( 1
==((2 4
$str((5 =
?((> ?
$str((@ M
:((N O
$str((P X
;((X Y
var** 
	campagins** 
=** 
Db++ 
.++ 
	Campaigns++ 
.,, 
Include,, 
(,, 
x,, 
=>,, 
x,, 
.,,  
Testing,,  '
),,' (
.,,( )
Include,,) 0
(,,0 1
x,,1 2
=>,,3 5
x,,6 7
.,,7 8
Approved,,8 @
),,@ A
.-- 
ToList-- 
(-- 
)-- 
;-- 
switch// 
(// 
sc// 
.// 
	sortOrder//  
)//  !
{00 
case11 
$str11 "
:11" #
	campagins22 
=22 
	campagins22  )
.22) *
OrderBy22* 1
(221 2
s222 3
=>224 6
s227 8
.228 9
OrderNumber229 D
)22D E
.22E F
ToList22F L
(22L M
)22M N
;22N O
break33 
;33 
case44 
$str44 '
:44' (
	campagins55 
=55 
	campagins55  )
.55) *
OrderByDescending55* ;
(55; <
s55< =
=>55> @
s55A B
.55B C
OrderNumber55C N
)55N O
.55O P
ToList55P V
(55V W
)55W X
;55X Y
break66 
;66 
case77 
$str77 #
:77# $
	campagins88 
=88 
	campagins88  )
.88) *
OrderBy88* 1
(881 2
s882 3
=>884 6
s887 8
.888 9
CampaignName889 E
)88E F
.88F G
ToList88G M
(88M N
)88N O
;88O P
break99 
;99 
case:: 
$str:: (
:::( )
	campagins;; 
=;; 
	campagins;;  )
.;;) *
OrderByDescending;;* ;
(;;; <
s;;< =
=>;;> @
s;;A B
.;;B C
CampaignName;;C O
);;O P
.;;P Q
ToList;;Q W
(;;W X
);;X Y
;;;Y Z
break<< 
;<< 
case== 
$str==  
:==  !
	campagins>> 
=>> 
	campagins>>  )
.>>) *
OrderBy>>* 1
(>>1 2
s>>2 3
=>>>4 6
s>>7 8
.>>8 9
	CreatedBy>>9 B
)>>B C
.>>C D
ToList>>D J
(>>J K
)>>K L
;>>L M
break?? 
;?? 
case@@ 
$str@@ %
:@@% &
	campaginsAA 
=AA 
	campaginsAA  )
.AA) *
OrderByDescendingAA* ;
(AA; <
sAA< =
=>AA> @
sAAA B
.AAB C
	CreatedByAAC L
)AAL M
.AAM N
ToListAAN T
(AAT U
)AAU V
;AAV W
breakBB 
;BB 
caseCC 
$strCC  
:CC  !
	campaginsDD 
=DD 
	campaginsDD  )
.DD) *
OrderByDD* 1
(DD1 2
sDD2 3
=>DD4 6
sDD7 8
.DD8 9
	CreatedAtDD9 B
)DDB C
.DDC D
ToListDDD J
(DDJ K
)DDK L
;DDL M
breakEE 
;EE 
caseFF 
$strFF %
:FF% &
	campaginsGG 
=GG 
	campaginsGG  )
.GG) *
OrderByDescendingGG* ;
(GG; <
sGG< =
=>GG> @
sGGA B
.GGB C
	CreatedAtGGC L
)GGL M
.GGM N
ToListGGN T
(GGT U
)GGU V
;GGV W
breakHH 
;HH 
caseII 
$strII $
:II$ %
	campaginsJJ 
=JJ 
	campaginsJJ  )
.JJ) *
OrderByJJ* 1
(JJ1 2
sJJ2 3
=>JJ4 6
sJJ7 8
.JJ8 9
BroadcastDateJJ9 F
)JJF G
.JJG H
ToListJJH N
(JJN O
)JJO P
;JJP Q
breakKK 
;KK 
caseLL 
$strLL )
:LL) *
	campaginsMM 
=MM 
	campaginsMM  )
.MM) *
OrderByDescendingMM* ;
(MM; <
sMM< =
=>MM> @
sMMA B
.MMB C
BroadcastDateMMC P
)MMP Q
.MMQ R
ToListMMR X
(MMX Y
)MMY Z
;MMZ [
breakNN 
;NN 
caseOO 
$strOO 
:OO  
	campaginsPP 
=PP 
	campaginsPP  )
.PP) *
OrderByPP* 1
(PP1 2
sPP2 3
=>PP4 6
sPP7 8
.PP8 9
QuantityPP9 A
)PPA B
.PPB C
ToListPPC I
(PPI J
)PPJ K
;PPK L
breakQQ 
;QQ 
caseRR 
$strRR $
:RR$ %
	campaginsSS 
=SS 
	campaginsSS  )
.SS) *
OrderByDescendingSS* ;
(SS; <
sSS< =
=>SS> @
sSSA B
.SSB C
QuantitySSC K
)SSK L
.SSL M
ToListSSM S
(SSS T
)SST U
;SSU V
breakTT 
;TT 
caseUU 
$strUU 
:UU 
	campaginsVV 
=VV 
	campaginsVV  )
.VV) *
OrderByVV* 1
(VV1 2
sVV2 3
=>VV4 6
sVV7 8
.VV8 9
StatusVV9 ?
)VV? @
.VV@ A
ToListVVA G
(VVG H
)VVH I
;VVI J
breakWW 
;WW 
caseXX 
$strXX "
:XX" #
	campaginsYY 
=YY 
	campaginsYY  )
.YY) *
OrderByDescendingYY* ;
(YY; <
sYY< =
=>YY> @
sYYA B
.YYB C
StatusYYC I
)YYI J
.YYJ K
ToListYYK Q
(YYQ R
)YYR S
;YYS T
breakZZ 
;ZZ 
default[[ 
:[[ 
	campagins\\ 
=\\ 
	campagins\\  )
.\\) *
OrderByDescending\\* ;
(\\; <
s\\< =
=>\\> @
s\\A B
.\\B C
	CreatedAt\\C L
)\\L M
.\\M N
ToList\\N T
(\\T U
)\\U V
;\\V W
break]] 
;]] 
}^^ 
ViewBag`` 
.`` 

SearchType`` 
=``  
sc``! #
.``# $

searchType``$ .
;``. /
ifaa 
(aa 
scaa 
.aa 

searchTypeaa 
==aa  
$straa! (
)aa( )
{bb 
ifcc 
(cc 
!cc 
stringcc 
.cc 
IsNullOrEmptycc )
(cc) *
sccc* ,
.cc, -
basicStringcc- 8
)cc8 9
)cc9 :
{dd 
	campaginsee 
=ee 
	campaginsee  )
.ee) *
Whereee* /
(ee/ 0
see0 1
=>ee2 4
sff 
.ff 
OrderNumberff !
.ff! "
Equalsff" (
(ff( )
scff) +
.ff+ ,
basicStringff, 7
)ff7 8
||ff9 ;
sgg 
.gg $
ReBroadcastedOrderNumbergg .
==gg/ 1
scgg2 4
.gg4 5
basicStringgg5 @
||ggA C
shh 
.hh 
CampaignNamehh "
.hh" #
IndexOfhh# *
(hh* +
schh+ -
.hh- .
basicStringhh. 9
,hh9 :
StringComparisonhh; K
.hhK L&
InvariantCultureIgnoreCasehhL f
)hhf g
>=hhh j
$numhhk l
)hhl m
.hhm n
ToListhhn t
(hht u
)hhu v
;hhv w
ViewBagii 
.ii 
BasicStringSearchedii /
=ii0 1
scii2 4
.ii4 5
basicStringii5 @
;ii@ A
}jj 
elsejj 
ifjj 
(jj 
!jj 
stringjj "
.jj" #
IsNullOrEmptyjj# 0
(jj0 1
scjj1 3
.jj3 4
basicStatusjj4 ?
)jj? @
)jj@ A
{kk 
intll 
statusll 
=ll  
intll! $
.ll$ %
Parsell% *
(ll* +
scll+ -
.ll- .
basicStatusll. 9
)ll9 :
;ll: ;
ifmm 
(mm 
statusmm 
==mm !
(mm" #
intmm# &
)mm& '
CampaignStatusmm' 5
.mm5 6
Rebroadcastedmm6 C
)mmC D
	campaginsnn !
=nn" #
	campaginsnn$ -
.nn- .
Wherenn. 3
(nn3 4
snn4 5
=>nn6 8
snn9 :
.nn: ;
ReBroadcastednn; H
)nnH I
.nnI J
ToListnnJ P
(nnP Q
)nnQ R
;nnR S
elseoo 
ifoo 
(oo 
statusoo #
==oo$ &
(oo' (
intoo( +
)oo+ ,
CampaignStatusoo, :
.oo: ;
NotRebroadcastedoo; K
)ooK L
	campaginspp !
=pp" #
	campaginspp$ -
.pp- .
Wherepp. 3
(pp3 4
spp4 5
=>pp6 8
spp9 :
.pp: ;
ReBroadCastpp; F
&&ppG I
!ppJ K
sppK L
.ppL M
ReBroadcastedppM Z
)ppZ [
.pp[ \
ToListpp\ b
(ppb c
)ppc d
;ppd e
elseqq 
	campaginsrr !
=rr" #
	campaginsrr$ -
.rr- .
Whererr. 3
(rr3 4
srr4 5
=>rr6 8
srr9 :
.rr: ;
Statusrr; A
==rrB D
statusrrE K
)rrK L
.rrL M
ToListrrM S
(rrS T
)rrT U
;rrU V
ViewBagss 
.ss 
BasicStatusSearchedss /
=ss0 1
scss2 4
.ss4 5
basicStatusss5 @
;ss@ A
}tt 
elsett 
iftt 
(tt 
!tt 
stringtt "
.tt" #
IsNullOrEmptytt# 0
(tt0 1
sctt1 3
.tt3 4
basicOrderNumbertt4 D
)ttD E
)ttE F
{uu 
	campaginsvv 
=vv 
	campaginsvv  )
.vv) *
Wherevv* /
(vv/ 0
svv0 1
=>vv2 4
svv5 6
.vv6 7
Idvv7 9
.vv9 :
ToStringvv: B
(vvB C
)vvC D
.vvD E
EqualsvvE K
(vvK L
scvvL N
.vvN O
basicOrderNumbervvO _
)vv_ `
)vv` a
.vva b
ToListvvb h
(vvh i
)vvi j
;vvj k
}ww 
}yy 
elsezz 
ifzz 
(zz 
sczz 
.zz 

searchTypezz "
==zz# %
$strzz& 0
)zz0 1
{{{ 
if|| 
(|| 
!|| 
string|| 
.|| 
IsNullOrEmpty|| )
(||) *
sc||* ,
.||, -
advancedStatus||- ;
)||; <
)||< =
{}} 
int~~ 
status~~ 
=~~  
int~~! $
.~~$ %
Parse~~% *
(~~* +
sc~~+ -
.~~- .
advancedStatus~~. <
)~~< =
;~~= >
if 
( 
status 
== !
(" #
int# &
)& '
CampaignStatus' 5
.5 6
Rebroadcasted6 C
)C D
	campagins
ÄÄ !
=
ÄÄ" #
	campagins
ÄÄ$ -
.
ÄÄ- .
Where
ÄÄ. 3
(
ÄÄ3 4
s
ÄÄ4 5
=>
ÄÄ6 8
s
ÄÄ9 :
.
ÄÄ: ;
OrderNumber
ÄÄ; F
.
ÄÄF G
EndsWith
ÄÄG O
(
ÄÄO P
$str
ÄÄP U
)
ÄÄU V
)
ÄÄV W
.
ÄÄW X
ToList
ÄÄX ^
(
ÄÄ^ _
)
ÄÄ_ `
;
ÄÄ` a
else
ÅÅ 
	campagins
ÇÇ !
=
ÇÇ" #
	campagins
ÇÇ$ -
.
ÇÇ- .
Where
ÇÇ. 3
(
ÇÇ3 4
s
ÇÇ4 5
=>
ÇÇ6 8
s
ÇÇ9 :
.
ÇÇ: ;
Status
ÇÇ; A
==
ÇÇB D
status
ÇÇE K
)
ÇÇK L
.
ÇÇL M
ToList
ÇÇM S
(
ÇÇS T
)
ÇÇT U
;
ÇÇU V
ViewBag
ÉÉ 
.
ÉÉ $
AdvancedStatusSearched
ÉÉ 2
=
ÉÉ3 4
sc
ÉÉ5 7
.
ÉÉ7 8
advancedStatus
ÉÉ8 F
;
ÉÉF G
}
ÑÑ 
if
ÖÖ 
(
ÖÖ 
!
ÖÖ 
string
ÖÖ 
.
ÖÖ 
IsNullOrEmpty
ÖÖ )
(
ÖÖ) *
sc
ÖÖ* ,
.
ÖÖ, -
advancedUser
ÖÖ- 9
)
ÖÖ9 :
)
ÖÖ: ;
{
ÜÜ 
	campagins
áá 
=
áá 
	campagins
áá  )
.
áá) *
Where
áá* /
(
áá/ 0
s
áá0 1
=>
áá2 4
s
áá5 6
.
áá6 7
	CreatedBy
áá7 @
==
ááA C
sc
ááD F
.
ááF G
advancedUser
ááG S
)
ááS T
.
ááT U
ToList
ááU [
(
áá[ \
)
áá\ ]
;
áá] ^
ViewBag
àà 
.
àà "
AdvancedUserSearched
àà 0
=
àà1 2
sc
àà3 5
.
àà5 6
advancedUser
àà6 B
;
ààB C
}
ââ 
if
ãã 
(
ãã 
!
ãã 
string
ãã 
.
ãã 
IsNullOrEmpty
ãã )
(
ãã) *
sc
ãã* ,
.
ãã, -
campaignName
ãã- 9
)
ãã9 :
)
ãã: ;
{
åå 
sc
çç 
.
çç 
campaignName
çç #
=
çç$ %
sc
çç& (
.
çç( )
campaignName
çç) 5
.
çç5 6
ToLowerInvariant
çç6 F
(
ççF G
)
ççG H
;
ççH I
	campagins
éé 
=
éé 
	campagins
éé  )
.
éé) *
Where
éé* /
(
éé/ 0
s
éé0 1
=>
éé2 4
s
éé5 6
.
éé6 7
CampaignName
éé7 C
.
ééC D
IndexOf
ééD K
(
ééK L
sc
ééL N
.
ééN O
campaignName
ééO [
,
éé[ \
StringComparison
éé] m
.
éém n'
CurrentCultureIgnoreCaseéén Ü
)ééÜ á
>=ééà ä
$numééã å
)ééå ç
.ééç é
ToListééé î
(ééî ï
)ééï ñ
;ééñ ó
ViewBag
èè 
.
èè 
CampaignName
èè (
=
èè) *
sc
èè+ -
.
èè- .
campaignName
èè. :
;
èè: ;
}
êê 
if
íí 
(
íí 
!
íí 
string
íí 
.
íí 
IsNullOrEmpty
íí )
(
íí) *
sc
íí* ,
.
íí, -
isTested
íí- 5
)
íí5 6
)
íí6 7
{
ìì 
bool
îî 
IsTested
îî !
=
îî" #
Boolean
îî$ +
.
îî+ ,
Parse
îî, 1
(
îî1 2
sc
îî2 4
.
îî4 5
isTested
îî5 =
)
îî= >
;
îî> ?
	campagins
ïï 
=
ïï 
	campagins
ïï  )
.
ïï) *
Where
ïï* /
(
ïï/ 0
s
ïï0 1
=>
ïï2 4
s
ïï5 6
.
ïï6 7
Testing
ïï7 >
!=
ïï? A
null
ïïB F
&&
ññ2 4
s
ññ5 6
.
ññ6 7
Testing
ññ7 >
?
ññ> ?
.
ññ? @
IsTested
ññ@ H
==
ññI K
IsTested
ññL T
)
ññT U
.
ññU V
ToList
ññV \
(
ññ\ ]
)
ññ] ^
;
ññ^ _
ViewBag
óó 
.
óó 
IsTested
óó $
=
óó% &
sc
óó' )
.
óó) *
isTested
óó* 2
;
óó2 3
}
òò 
if
öö 
(
öö 
!
öö 
string
öö 
.
öö 
IsNullOrEmpty
öö )
(
öö) *
sc
öö* ,
.
öö, -
orderedFrom
öö- 8
)
öö8 9
)
öö9 :
{
õõ 
DateTime
úú 
dateFrom
úú %
=
úú& '
DateTime
úú( 0
.
úú0 1

ParseExact
úú1 ;
(
úú; <
sc
úú< >
.
úú> ?
orderedFrom
úú? J
,
úúJ K
$str
úúL X
,
úúX Y
CultureInfo
úúZ e
.
úúe f
InvariantCulture
úúf v
)
úúv w
;
úúw x
	campagins
ùù 
=
ùù 
	campagins
ùù  )
.
ùù) *
Where
ùù* /
(
ùù/ 0
s
ùù0 1
=>
ùù2 4
s
ùù5 6
.
ùù6 7
	CreatedAt
ùù7 @
.
ùù@ A
Date
ùùA E
>=
ùùF H
dateFrom
ùùI Q
.
ùùQ R
Date
ùùR V
)
ùùV W
.
ùùW X
ToList
ùùX ^
(
ùù^ _
)
ùù_ `
;
ùù` a
ViewBag
ûû 
.
ûû 
OrderedFrom
ûû '
=
ûû( )
sc
ûû* ,
.
ûû, -
orderedFrom
ûû- 8
;
ûû8 9
}
üü 
if
°° 
(
°° 
!
°° 
string
°° 
.
°° 
IsNullOrEmpty
°° )
(
°°) *
sc
°°* ,
.
°°, -
	orderedTo
°°- 6
)
°°6 7
)
°°7 8
{
¢¢ 
DateTime
££ 
dateTo
££ #
=
££$ %
DateTime
££& .
.
££. /

ParseExact
££/ 9
(
££9 :
sc
££: <
.
££< =
	orderedTo
££= F
,
££F G
$str
££H T
,
££T U
CultureInfo
££V a
.
££a b
InvariantCulture
££b r
)
££r s
;
££s t
	campagins
§§ 
=
§§ 
	campagins
§§  )
.
§§) *
Where
§§* /
(
§§/ 0
s
§§0 1
=>
§§2 4
s
§§5 6
.
§§6 7
	CreatedAt
§§7 @
.
§§@ A
Date
§§A E
<=
§§F H
dateTo
§§I O
.
§§O P
Date
§§P T
)
§§T U
.
§§U V
ToList
§§V \
(
§§\ ]
)
§§] ^
;
§§^ _
ViewBag
•• 
.
•• 
	OrderedTo
•• %
=
••& '
sc
••( *
.
••* +
	orderedTo
••+ 4
;
••4 5
}
¶¶ 
if
®® 
(
®® 
!
®® 
string
®® 
.
®® 
IsNullOrEmpty
®® )
(
®®) *
sc
®®* ,
.
®®, -
broadcastFrom
®®- :
)
®®: ;
)
®®; <
{
©© 
DateTime
™™ 
dateFrom
™™ %
=
™™& '
DateTime
™™( 0
.
™™0 1

ParseExact
™™1 ;
(
™™; <
sc
™™< >
.
™™> ?
broadcastFrom
™™? L
,
™™L M
$str
™™N Z
,
™™Z [
CultureInfo
™™\ g
.
™™g h
InvariantCulture
™™h x
)
™™x y
;
™™y z
	campagins
´´ 
=
´´ 
	campagins
´´  )
.
´´) *
Where
´´* /
(
´´/ 0
s
´´0 1
=>
´´2 4
s
´´5 6
.
´´6 7
BroadcastDate
´´7 D
?
´´D E
.
´´E F
Date
´´F J
>=
´´K M
dateFrom
´´N V
.
´´V W
Date
´´W [
)
´´[ \
.
´´\ ]
ToList
´´] c
(
´´c d
)
´´d e
;
´´e f
ViewBag
¨¨ 
.
¨¨ 
BroadcastFrom
¨¨ )
=
¨¨* +
sc
¨¨, .
.
¨¨. /
broadcastFrom
¨¨/ <
;
¨¨< =
}
≠≠ 
if
ØØ 
(
ØØ 
!
ØØ 
string
ØØ 
.
ØØ 
IsNullOrEmpty
ØØ )
(
ØØ) *
sc
ØØ* ,
.
ØØ, -
broadcastTo
ØØ- 8
)
ØØ8 9
)
ØØ9 :
{
∞∞ 
DateTime
±± 
dateTo
±± #
=
±±$ %
DateTime
±±& .
.
±±. /

ParseExact
±±/ 9
(
±±9 :
sc
±±: <
.
±±< =
broadcastTo
±±= H
,
±±H I
$str
±±J V
,
±±V W
CultureInfo
±±X c
.
±±c d
InvariantCulture
±±d t
)
±±t u
;
±±u v
	campagins
≤≤ 
=
≤≤ 
	campagins
≤≤  )
.
≤≤) *
Where
≤≤* /
(
≤≤/ 0
s
≤≤0 1
=>
≤≤2 4
s
≤≤5 6
.
≤≤6 7
BroadcastDate
≤≤7 D
?
≤≤D E
.
≤≤E F
Date
≤≤F J
<=
≤≤K M
dateTo
≤≤N T
.
≤≤T U
Date
≤≤U Y
)
≤≤Y Z
.
≤≤Z [
ToList
≤≤[ a
(
≤≤a b
)
≤≤b c
;
≤≤c d
ViewBag
≥≥ 
.
≥≥ 
BroadcastTo
≥≥ '
=
≥≥( )
sc
≥≥* ,
.
≥≥, -
broadcastTo
≥≥- 8
;
≥≥8 9
}
¥¥ 
}
µµ 
if
∑∑ 
(
∑∑ 
LoggedInUser
∑∑ 
!=
∑∑ 
null
∑∑  $
&&
∑∑% '
!
∑∑( )
IsAdmin
∑∑) 0
)
∑∑0 1
{
∏∏ 
	campagins
ππ 
=
ππ 
	campagins
ππ %
.
ππ% &
Where
ππ& +
(
ππ+ ,
s
ππ, -
=>
ππ. 0
s
ππ1 2
.
ππ2 3
	CreatedBy
ππ3 <
==
ππ= ?
LoggedInUser
ππ@ L
.
ππL M
UserName
ππM U
)
ππU V
.
ππV W
ToList
ππW ]
(
ππ] ^
)
ππ^ _
;
ππ_ `
}
∫∫ 
ViewBag
ºº 
.
ºº 
BasicOrderNumber
ºº $
=
ºº% &
OrderNumberList
ºº' 6
;
ºº6 7
ViewBag
ΩΩ 
.
ΩΩ 
BasicStatus
ΩΩ 
=
ΩΩ  !

StatusList
ΩΩ" ,
;
ΩΩ, -
ViewBag
ææ 
.
ææ 
AdvancedStatus
ææ "
=
ææ# $

StatusList
ææ% /
;
ææ/ 0
ViewBag
øø 
.
øø 
AdvancedUser
øø  
=
øø! "
	UsersList
øø# ,
;
øø, -
string
¡¡ 
idsForPrint
¡¡ 
=
¡¡  
string
¡¡! '
.
¡¡' (
IsNullOrEmpty
¡¡( 5
(
¡¡5 6
ViewBag
¡¡6 =
.
¡¡= >
	SearchIds
¡¡> G
)
¡¡G H
?
¡¡I J
string
¬¬$ *
.
¬¬* +
Join
¬¬+ /
(
¬¬/ 0
$str
¬¬0 3
,
¬¬3 4
	campagins
¬¬5 >
.
¬¬> ?
Select
¬¬? E
(
¬¬E F
x
¬¬F G
=>
¬¬H J
x
¬¬K L
.
¬¬L M
Id
¬¬M O
.
¬¬O P
ToString
¬¬P X
(
¬¬X Y
)
¬¬Y Z
)
¬¬Z [
)
¬¬[ \
:
√√$ %
ViewBag
√√& -
.
√√- .
	SearchIds
√√. 7
;
√√7 8
Session
ƒƒ 
[
ƒƒ 
$str
ƒƒ !
]
ƒƒ! "
=
ƒƒ# $
idsForPrint
ƒƒ% 0
;
ƒƒ0 1
int
«« 

pageNumber
«« 
=
«« 
(
«« 
sc
««  
.
««  !
page
««! %
??
««& (
$num
««) *
)
««* +
;
««+ ,
return
»» 
View
»» 
(
»» 
	campagins
»» !
.
»»! "
ToPagedList
»»" -
(
»»- .

pageNumber
»». 8
,
»»8 9
PageSize
»»: B
)
»»B C
)
»»C D
;
»»D E
}
…… 	
public
ÀÀ 
ActionResult
ÀÀ 
Download
ÀÀ $
(
ÀÀ$ %
)
ÀÀ% &
{
ÃÃ 	
string
ÕÕ 
fileName
ÕÕ 
=
ÕÕ 
$"
ÕÕ  
Orders_
ÕÕ  '
{
ÕÕ' (
DateTime
ÕÕ( 0
.
ÕÕ0 1
Now
ÕÕ1 4
:
ÕÕ4 5
yyyyMMdd_HHmmss
ÕÕ5 D
}
ÕÕD E
.csv
ÕÕE I
"
ÕÕI J
;
ÕÕJ K
var
ŒŒ 
filePath
ŒŒ 
=
ŒŒ 
$"
ŒŒ 
{
ŒŒ 
DownloadPath
ŒŒ *
}
ŒŒ* +
\\
ŒŒ+ -
{
ŒŒ- .
fileName
ŒŒ. 6
}
ŒŒ6 7
"
ŒŒ7 8
;
ŒŒ8 9
if
œœ 
(
œœ 
Session
œœ 
[
œœ 
$str
œœ %
]
œœ% &
!=
œœ' )
null
œœ* .
)
œœ. /
{
–– 
List
—— 
<
—— 
Guid
—— 
>
—— 
ids
—— 
;
—— 
try
““ 
{
”” 
ids
‘‘ 
=
‘‘ 
(
‘‘ 
Session
‘‘ "
[
‘‘" #
$str
‘‘# 0
]
‘‘0 1
as
‘‘2 4
string
‘‘5 ;
)
‘‘; <
?
‘‘< =
.
‘‘= >
Split
‘‘> C
(
‘‘C D
$str
‘‘D G
.
‘‘G H
ToCharArray
‘‘H S
(
‘‘S T
)
‘‘T U
)
‘‘U V
.
‘‘V W
Select
‘‘W ]
(
‘‘] ^
Guid
‘‘^ b
.
‘‘b c
Parse
‘‘c h
)
‘‘h i
.
‘‘i j
ToList
‘‘j p
(
‘‘p q
)
‘‘q r
;
‘‘r s
var
’’ 
	campagins
’’ !
=
’’" #
Db
’’$ &
.
’’& '
	Campaigns
’’' 0
.
÷÷ 
Include
÷÷  
(
÷÷  !
x
÷÷! "
=>
÷÷# %
x
÷÷& '
.
÷÷' (
Testing
÷÷( /
)
÷÷/ 0
.
÷÷0 1
Include
÷÷1 8
(
÷÷8 9
x
÷÷9 :
=>
÷÷; =
x
÷÷> ?
.
÷÷? @
Approved
÷÷@ H
)
÷÷H I
.
◊◊ 
Where
◊◊ 
(
◊◊ 
x
◊◊  
=>
◊◊! #
ids
◊◊$ '
.
◊◊' (
Contains
◊◊( 0
(
◊◊0 1
x
◊◊1 2
.
◊◊2 3
Id
◊◊3 5
)
◊◊5 6
)
◊◊6 7
.
ÿÿ 
ToList
ÿÿ 
(
ÿÿ  
)
ÿÿ  !
.
ŸŸ 
Select
ŸŸ 
(
ŸŸ  
x
ŸŸ  !
=>
ŸŸ" $
new
ŸŸ% (

CampaignVM
ŸŸ) 3
(
ŸŸ3 4
)
ŸŸ4 5
{
⁄⁄ 
OrderNumber
€€ '
=
€€( )
x
€€* +
.
€€+ ,
OrderNumber
€€, 7
,
€€7 8
CampaignName
‹‹ (
=
‹‹) *
x
‹‹+ ,
.
‹‹, -
CampaignName
‹‹- 9
,
‹‹9 :
BroadcastDate
›› )
=
››* +
x
››, -
.
››- .
BroadcastDate
››. ;
,
››; <
Quantity
ﬁﬁ $
=
ﬁﬁ% &
x
ﬁﬁ' (
.
ﬁﬁ( )
Approved
ﬁﬁ) 1
?
ﬁﬁ1 2
.
ﬁﬁ2 3
Quantity
ﬁﬁ3 ;
??
ﬁﬁ< >
(
ﬁﬁ? @
x
ﬁﬁ@ A
.
ﬁﬁA B
Testing
ﬁﬁB I
?
ﬁﬁI J
.
ﬁﬁJ K
Quantity
ﬁﬁK S
??
ﬁﬁT V
x
ﬁﬁW X
.
ﬁﬁX Y
Quantity
ﬁﬁY a
)
ﬁﬁa b
,
ﬁﬁb c
Status
ﬂﬂ "
=
ﬂﬂ# $
System
ﬂﬂ% +
.
ﬂﬂ+ ,
Enum
ﬂﬂ, 0
.
ﬂﬂ0 1
GetName
ﬂﬂ1 8
(
ﬂﬂ8 9
typeof
ﬂﬂ9 ?
(
ﬂﬂ? @
CampaignStatus
ﬂﬂ@ N
)
ﬂﬂN O
,
ﬂﬂO P
x
ﬂﬂQ R
.
ﬂﬂR S
Status
ﬂﬂS Y
)
ﬂﬂY Z
}
‡‡ 
)
‡‡ 
;
‡‡ 
	campagins
‚‚ 
.
‚‚ 
ToCsv
‚‚ #
(
‚‚# $
filePath
‚‚$ ,
,
‚‚, -
new
‚‚. 1
CsvDefinition
‚‚2 ?
(
‚‚? @
)
‚‚@ A
{
„„ 
	EndOfLine
‰‰ !
=
‰‰" #
$str
‰‰$ *
,
‰‰* +
FieldSeparator
ÂÂ &
=
ÂÂ' (
$char
ÂÂ) ,
,
ÂÂ, -
TextQualifier
ÊÊ %
=
ÊÊ& '
$char
ÊÊ( +
,
ÊÊ+ ,
Columns
ÁÁ 
=
ÁÁ" #
new
ÁÁ$ '
List
ÁÁ( ,
<
ÁÁ, -
string
ÁÁ- 3
>
ÁÁ3 4
{
ÁÁ5 6
$str
ÁÁ7 D
,
ÁÁD E
$str
ÁÁF T
,
ÁÁT U
$str
ÁÁV e
,
ÁÁe f
$str
ÁÁg q
,
ÁÁq r
$str
ÁÁs {
}
ÁÁ| }
}
ËË 
)
ËË 
;
ËË 
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
throw
ÏÏ 
new
ÏÏ 
AdsException
ÏÏ *
(
ÏÏ* +
$str
ÏÏ+ :
+
ÏÏ; <
ex
ÏÏ= ?
.
ÏÏ? @
Message
ÏÏ@ G
)
ÏÏG H
;
ÏÏH I
}
ÌÌ 
}
ÓÓ 
return
ÔÔ 
File
ÔÔ 
(
ÔÔ 
filePath
ÔÔ  
,
ÔÔ  !
$str
ÔÔ" ,
,
ÔÔ, -
fileName
ÔÔ. 6
)
ÔÔ6 7
;
ÔÔ7 8
}
 	
public
ÛÛ 
ActionResult
ÛÛ 
Details
ÛÛ #
(
ÛÛ# $
Guid
ÛÛ$ (
?
ÛÛ( )
id
ÛÛ* ,
)
ÛÛ, -
{
ÙÙ 	
if
ıı 
(
ıı 
id
ıı 
==
ıı 
null
ıı 
)
ıı 
{
ˆˆ 
throw
˜˜ 
new
˜˜ 
HttpException
˜˜ '
(
˜˜' (
$num
˜˜( +
,
˜˜+ ,
$str
˜˜- :
)
˜˜: ;
;
˜˜; <
}
¯¯ 
Campaign
˘˘ 
campaign
˘˘ 
=
˘˘ 
Db
˘˘  "
.
˘˘" #
	Campaigns
˘˘# ,
.
˘˘, -
Find
˘˘- 1
(
˘˘1 2
id
˘˘2 4
)
˘˘4 5
;
˘˘5 6
if
˙˙ 
(
˙˙ 
campaign
˙˙ 
==
˙˙ 
null
˙˙  
)
˙˙  !
{
˚˚ 
throw
¸¸ 
new
¸¸ 
HttpException
¸¸ '
(
¸¸' (
$num
¸¸( +
,
¸¸+ ,
$str
¸¸- 8
)
¸¸8 9
;
¸¸9 :
}
˝˝ 
return
˛˛ 
View
˛˛ 
(
˛˛ 
campaign
˛˛  
)
˛˛  !
;
˛˛! "
}
ˇˇ 	
public
ÅÅ 
ActionResult
ÅÅ 

NewSegment
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
{
ÇÇ 	
var
ÑÑ 
segment
ÑÑ 
=
ÑÑ 
new
ÑÑ 
CampaignSegment
ÑÑ -
(
ÑÑ- .
)
ÑÑ. /
{
ÖÖ 
Id
ÜÜ 
=
ÜÜ 
Guid
ÜÜ 
.
ÜÜ 
NewGuid
ÜÜ !
(
ÜÜ! "
)
ÜÜ" #
,
ÜÜ# $
	CreatedAt
áá 
=
áá 
DateTime
áá $
.
áá$ %
Now
áá% (
,
áá( )
SegmentNumber
àà 
=
àà 
$str
àà  "
+
àà# $
c1
àà% '
++
àà' )
,
àà) *

WhiteLabel
ââ 
=
ââ 
LoggedInUser
ââ )
.
ââ) *

WhiteLabel
ââ* 4
}
ää 
;
ää 
return
ãã 
PartialView
ãã 
(
ãã 
$str
ãã J
,
ããJ K
segment
ããL S
)
ããS T
;
ããT U
}
åå 	
public
èè 
ActionResult
èè 
Create
èè "
(
èè" #
)
èè# $
{
êê 	
c1
ëë 
=
ëë 
$char
ëë 
;
ëë 

CampaignVM
íí 
model
íí 
=
íí 
new
íí "

CampaignVM
íí# -
(
íí- .
)
íí. /
{
ìì  
RepresentativeName
îî "
=
îî# $
LoggedInUser
îî% 1
?
îî1 2
.
îî2 3
UserName
îî3 ;
,
îî; <!
RepresentativeEmail
ïï #
=
ïï$ %
LoggedInUser
ïï& 2
?
ïï2 3
.
ïï3 4
Email
ïï4 9
,
ïï9 :
ChannelTypes
ññ 
=
ññ 
new
ññ "
List
ññ# '
<
ññ' (
ChannelType
ññ( 3
>
ññ3 4
{
ññ5 6
}
ññ7 8
}
òò 
;
òò 
ViewBag
ôô 
.
ôô 
TestingUrgency
ôô "
=
ôô# $
new
ôô% (

SelectList
ôô) 3
(
ôô3 4

EnumHelper
ôô4 >
.
ôô> ?
GetEnumTextValues
ôô? P
(
ôôP Q
typeof
ôôQ W
(
ôôW X
TestingUrgency
ôôX f
)
ôôf g
)
ôôg h
,
ôôh i
$str
ôôj q
,
ôôq r
$str
öö 
,
öö 
model
öö 
.
öö 
TestingUrgency
öö ,
)
öö, -
;
öö- .
ViewBag
õõ 
.
õõ 

WhiteLabel
õõ 
=
õõ  
new
õõ! $

SelectList
õõ% /
(
õõ/ 0
CustomersList
õõ0 =
,
õõ= >
$str
õõ? F
,
õõF G
$str
õõH N
,
õõN O
LoggedInUser
õõP \
?
õõ\ ]
.
õõ] ^

WhiteLabel
õõ^ h
)
õõh i
;
õõi j
return
úú 
View
úú 
(
úú 
model
úú 
)
úú 
;
úú 
}
ùù 	
[
¢¢ 	
HttpPost
¢¢	 
]
¢¢ 
[
££ 	&
ValidateAntiForgeryToken
££	 !
]
££! "
public
§§ 
ActionResult
§§ 
Create
§§ "
(
§§" #
[
•• 
Bind
•• 
(
•• 
Include
¶¶ 
=
¶¶ 
$strßß ∑
)ßß∑ ∏
]ßß∏ π

CampaignVMßß∫ ƒ

campaignVmßß≈ œ
)ßßœ –
{
®® 	
if
©© 
(
©© 

ModelState
©© 
.
©© 
IsValid
©© "
)
©©" #
{
™™ 
try
´´ 
{
¨¨ 
var
ÆÆ 
camps
ÆÆ 
=
ÆÆ 
Db
ÆÆ  "
.
ÆÆ" #
	Campaigns
ÆÆ# ,
.
ÆÆ, -
ToList
ÆÆ- 3
(
ÆÆ3 4
)
ÆÆ4 5
;
ÆÆ5 6
int
ØØ 
newOrderNumber
ØØ &
=
ØØ' (
camps
ØØ) .
.
ØØ. /
Count
ØØ/ 4
>
ØØ5 6
$num
ØØ7 8
?
∞∞ 
camps
∞∞ 
.
∞∞  
Max
∞∞  #
(
∞∞# $
x
∞∞$ %
=>
∞∞& (
int
∞∞) ,
.
∞∞, -
Parse
∞∞- 2
(
∞∞2 3
x
∞∞3 4
.
∞∞4 5
OrderNumber
∞∞5 @
.
∞∞@ A
TrimEnd
∞∞A H
(
∞∞H I
$str
∞∞I N
.
∞∞N O
ToCharArray
∞∞O Z
(
∞∞Z [
)
∞∞[ \
)
∞∞\ ]
)
∞∞] ^
)
∞∞^ _
+
∞∞` a
$num
∞∞b c
:
±± 
$num
±± 
;
±± 
string
≥≥ 
userName
≥≥ #
=
≥≥$ %
LoggedInUser
≥≥& 2
?
≥≥2 3
.
≥≥3 4
UserName
≥≥4 <
;
≥≥< =

TinyMapper
µµ 
.
µµ 
Bind
µµ #
<
µµ# $

CampaignVM
µµ$ .
,
µµ. /
Campaign
µµ0 8
>
µµ8 9
(
µµ9 :
config
µµ: @
=>
µµA C
{
∂∂ 
config
∑∑ 
.
∑∑ 
Ignore
∑∑ %
(
∑∑% &
x
∑∑& '
=>
∑∑( *
x
∑∑+ ,
.
∑∑, -
Segments
∑∑- 5
)
∑∑5 6
;
∑∑6 7
config
∏∏ 
.
∏∏ 
Ignore
∏∏ %
(
∏∏% &
x
∏∏& '
=>
∏∏( *
x
∏∏+ ,
.
∏∏, -
ChannelTypes
∏∏- 9
)
∏∏9 :
;
∏∏: ;
}
ππ 
)
ππ 
;
ππ 
var
ªª 
campaign
ªª  
=
ªª! "

TinyMapper
ªª# -
.
ªª- .
Map
ªª. 1
<
ªª1 2
Campaign
ªª2 :
>
ªª: ;
(
ªª; <

campaignVm
ªª< F
)
ªªF G
;
ªªG H
char
ºº 
c2
ºº 
=
ºº 
$char
ºº !
;
ºº! "
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ  
	segmentVm
ΩΩ! *
in
ΩΩ+ -

campaignVm
ΩΩ. 8
.
ΩΩ8 9
Segments
ΩΩ9 A
)
ΩΩA B
{
ææ 
var
øø 
segment
øø #
=
øø$ %

TinyMapper
øø& 0
.
øø0 1
Map
øø1 4
<
øø4 5
CampaignSegment
øø5 D
>
øøD E
(
øøE F
	segmentVm
øøF O
)
øøO P
;
øøP Q
segment
¿¿ 
.
¿¿  
Id
¿¿  "
=
¿¿# $
Guid
¿¿% )
.
¿¿) *
NewGuid
¿¿* 1
(
¿¿1 2
)
¿¿2 3
;
¿¿3 4
segment
¡¡ 
.
¡¡  
	CreatedAt
¡¡  )
=
¡¡* +
DateTime
¡¡, 4
.
¡¡4 5
Now
¡¡5 8
;
¡¡8 9
segment
¬¬ 
.
¬¬  
OrderNumber
¬¬  +
=
¬¬, -
$str
¬¬. 0
+
¬¬1 2
newOrderNumber
¬¬3 A
;
¬¬A B
segment
√√ 
.
√√  
SegmentNumber
√√  -
=
√√. /
newOrderNumber
√√0 >
+
√√? @
$str
√√A C
+
√√D E
c2
√√F H
++
√√H J
;
√√J K
campaign
ƒƒ  
.
ƒƒ  !
Segments
ƒƒ! )
.
ƒƒ) *
Add
ƒƒ* -
(
ƒƒ- .
segment
ƒƒ. 5
)
ƒƒ5 6
;
ƒƒ6 7
}
≈≈ 
campaign
∆∆ 
.
∆∆ 
Id
∆∆ 
=
∆∆  !
Guid
∆∆" &
.
∆∆& '
NewGuid
∆∆' .
(
∆∆. /
)
∆∆/ 0
;
∆∆0 1
campaign
«« 
.
«« 
	CreatedAt
«« &
=
««' (
DateTime
««) 1
.
««1 2
Now
««2 5
;
««5 6
campaign
»» 
.
»» 
	CreatedBy
»» &
=
»»' (
userName
»») 1
;
»»1 2
campaign
…… 
.
…… 
OrderNumber
…… (
=
……) *
newOrderNumber
……+ 9
.
……9 :
ToString
……: B
(
……B C
)
……C D
;
……D E
campaign
   
.
   
IP
   
=
    !
Request
  " )
.
  ) *
ServerVariables
  * 9
[
  9 :
$str
  : G
]
  G H
;
  H I
campaign
ÀÀ 
.
ÀÀ 
Browser
ÀÀ $
=
ÀÀ% &
Request
ÀÀ' .
.
ÀÀ. /
	UserAgent
ÀÀ/ 8
;
ÀÀ8 9
campaign
ÃÃ 
.
ÃÃ 
OS
ÃÃ 
=
ÃÃ  !
Environment
ÃÃ" -
.
ÃÃ- .
	OSVersion
ÃÃ. 7
.
ÃÃ7 8
Platform
ÃÃ8 @
+
ÃÃA B
$str
ÃÃC F
+
ÃÃG H
Environment
ÃÃI T
.
ÃÃT U
	OSVersion
ÃÃU ^
.
ÃÃ^ _
VersionString
ÃÃ_ l
;
ÃÃl m
campaign
ÕÕ 
.
ÕÕ 
Referrer
ÕÕ %
=
ÕÕ& '
Request
ÕÕ( /
.
ÕÕ/ 0
UrlReferrer
ÕÕ0 ;
.
ÕÕ; <
AbsolutePath
ÕÕ< H
;
ÕÕH I
campaign
ŒŒ 
.
ŒŒ 
ChannelTypes
ŒŒ )
=
ŒŒ* +

campaignVm
ŒŒ, 6
.
ŒŒ6 7
ChannelTypes
ŒŒ7 C
==
ŒŒD F
null
ŒŒG K
?
ŒŒL M
null
ŒŒN R
:
ŒŒS T
string
œœ 
.
œœ 
Join
œœ #
(
œœ# $
$str
œœ$ '
,
œœ' (

campaignVm
œœ) 3
.
œœ3 4
ChannelTypes
œœ4 @
)
œœ@ A
;
œœA B
campaign
–– 
.
–– 
Assets
–– #
.
––# $
Id
––$ &
=
––' (
Guid
––) -
.
––- .
NewGuid
––. 5
(
––5 6
)
––6 7
;
––7 8
campaign
—— 
.
—— 
Assets
—— #
.
——# $

CampaignId
——$ .
=
——/ 0
campaign
——1 9
.
——9 :
Id
——: <
;
——< =
campaign
““ 
.
““ 
Assets
““ #
.
““# $
	CreatedAt
““$ -
=
““. /
DateTime
““0 8
.
““8 9
Now
““9 <
;
““< =
campaign
”” 
.
”” 
Assets
”” #
.
””# $
	CreatedBy
””$ -
=
””. /
userName
””0 8
;
””8 9
Db
’’ 
.
’’ 
	Campaigns
’’  
.
’’  !
Add
’’! $
(
’’$ %
campaign
’’% -
)
’’- .
;
’’. /
Db
÷÷ 
.
÷÷ 
SaveChanges
÷÷ "
(
÷÷" #
)
÷÷# $
;
÷÷$ %
BackgroundJob
ÿÿ !
.
ÿÿ! "
Enqueue
ÿÿ" )
(
ÿÿ) *
(
ÿÿ* +
)
ÿÿ+ ,
=>
ÿÿ- /
FileProcessor
ÿÿ0 =
.
ÿÿ= >
ProcessNewOrder
ÿÿ> M
(
ÿÿM N
campaign
ÿÿN V
.
ÿÿV W
OrderNumber
ÿÿW b
,
ÿÿb c
userName
ÿÿd l
)
ÿÿl m
)
ÿÿm n
;
ÿÿn o
ForceOrders
⁄⁄ 
=
⁄⁄  !
true
⁄⁄" &
;
⁄⁄& '
TempData
€€ 
[
€€ 
$str
€€ &
]
€€& '
=
€€( )
$str
€€* 5
+
€€5 6
campaign
€€7 ?
.
€€? @
OrderNumber
€€@ K
+
€€L M
$str
€€N \
+
€€] ^
campaign
€€_ g
.
€€g h
CampaignName
€€h t
+
€€u v
$str€€w ô
;€€ô ö
}
‹‹ 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
ﬁﬁ 
TempData
ﬂﬂ 
[
ﬂﬂ 
$str
ﬂﬂ $
]
ﬂﬂ$ %
=
ﬂﬂ& '
$str
ﬂﬂ( M
+
ﬂﬂN O
ex
ﬂﬂP R
.
ﬂﬂR S
Message
ﬂﬂS Z
;
ﬂﬂZ [
}
‡‡ 
return
·· 
RedirectToAction
·· '
(
··' (
$str
··( /
)
··/ 0
;
··0 1
}
‚‚ 

campaignVm
„„ 
.
„„ 
ChannelTypes
„„ #
=
„„$ %

campaignVm
„„& 0
.
„„0 1
ChannelTypes
„„1 =
??
„„> @
new
„„A D
List
„„E I
<
„„I J
ChannelType
„„J U
>
„„U V
{
„„W X
}
„„X Y
;
„„Y Z
ViewBag
ÂÂ 
.
ÂÂ 
TestingUrgency
ÂÂ "
=
ÂÂ# $
new
ÂÂ% (

SelectList
ÂÂ) 3
(
ÂÂ3 4

EnumHelper
ÂÂ4 >
.
ÂÂ> ?
GetEnumTextValues
ÂÂ? P
(
ÂÂP Q
typeof
ÂÂQ W
(
ÂÂW X
TestingUrgency
ÂÂX f
)
ÂÂf g
)
ÂÂg h
,
ÂÂh i
$str
ÂÂj q
,
ÂÂq r
$str
ÊÊ 
,
ÊÊ 

campaignVm
ÊÊ "
.
ÊÊ" #
TestingUrgency
ÊÊ# 1
)
ÊÊ1 2
;
ÊÊ2 3
ViewBag
ÁÁ 
.
ÁÁ 

WhiteLabel
ÁÁ 
=
ÁÁ  
new
ÁÁ! $

SelectList
ÁÁ% /
(
ÁÁ/ 0
CustomersList
ÁÁ0 =
,
ÁÁ= >
$str
ÁÁ? F
,
ÁÁF G
$str
ÁÁH N
,
ÁÁN O
LoggedInUser
ÁÁP \
?
ÁÁ\ ]
.
ÁÁ] ^

WhiteLabel
ÁÁ^ h
)
ÁÁh i
;
ÁÁi j
return
ËË 
View
ËË 
(
ËË 

campaignVm
ËË "
)
ËË" #
;
ËË# $
}
ÈÈ 	
public
ÌÌ 
ActionResult
ÌÌ 
Edit
ÌÌ  
(
ÌÌ  !
Guid
ÌÌ! %
?
ÌÌ% &
id
ÌÌ' )
)
ÌÌ) *
{
ÓÓ 	
if
ÔÔ 
(
ÔÔ 
id
ÔÔ 
==
ÔÔ 
null
ÔÔ 
)
ÔÔ 
{
 
throw
ÒÒ 
new
ÒÒ 
HttpException
ÒÒ '
(
ÒÒ' (
$num
ÒÒ( +
,
ÒÒ+ ,
$str
ÒÒ- :
)
ÒÒ: ;
;
ÒÒ; <
}
ÚÚ 
Campaign
ÛÛ 
campaign
ÛÛ 
=
ÛÛ 
Db
ÛÛ  "
.
ÛÛ" #
	Campaigns
ÛÛ# ,
.
ÛÛ, -
Find
ÛÛ- 1
(
ÛÛ1 2
id
ÛÛ2 4
)
ÛÛ4 5
;
ÛÛ5 6
if
ÙÙ 
(
ÙÙ 
campaign
ÙÙ 
==
ÙÙ 
null
ÙÙ  
)
ÙÙ  !
{
ıı 
throw
ˆˆ 
new
ˆˆ 
HttpException
ˆˆ '
(
ˆˆ' (
$num
ˆˆ( +
,
ˆˆ+ ,
$str
ˆˆ- 8
)
ˆˆ8 9
;
ˆˆ9 :
}
˜˜ 
ViewBag
¯¯ 
.
¯¯ 
TestingUrgency
¯¯ "
=
¯¯# $
new
¯¯% (

SelectList
¯¯) 3
(
¯¯3 4

EnumHelper
¯¯4 >
.
¯¯> ?
GetEnumTextValues
¯¯? P
(
¯¯P Q
typeof
¯¯Q W
(
¯¯W X
TestingUrgency
¯¯X f
)
¯¯f g
)
¯¯g h
,
¯¯h i
$str
¯¯j q
,
¯¯q r
$str
˘˘ 
,
˘˘ 
campaign
˘˘  
.
˘˘  !
TestingUrgency
˘˘! /
)
˘˘/ 0
;
˘˘0 1
ViewBag
˙˙ 
.
˙˙ 
Status
˙˙ 
=
˙˙ 
new
˙˙  

SelectList
˙˙! +
(
˙˙+ ,

EnumHelper
˙˙, 6
.
˙˙6 7
GetEnumTextValues
˙˙7 H
(
˙˙H I
typeof
˙˙I O
(
˙˙O P
CampaignStatus
˙˙P ^
)
˙˙^ _
)
˙˙_ `
,
˙˙` a
$str
˙˙b i
,
˙˙i j
$str
˙˙k q
,
˙˙q r
campaign
˚˚ 
.
˚˚ 
Status
˚˚ 
)
˚˚  
;
˚˚  !
return
¸¸ 
View
¸¸ 
(
¸¸ 
campaign
¸¸  
)
¸¸  !
;
¸¸! "
}
˝˝ 	
[
ÇÇ 	
HttpPost
ÇÇ	 
]
ÇÇ 
[
ÉÉ 	&
ValidateAntiForgeryToken
ÉÉ	 !
]
ÉÉ! "
public
ÑÑ 
ActionResult
ÑÑ 
Edit
ÑÑ  
(
ÑÑ  !
[
ÖÖ 
Bind
ÖÖ 
(
ÖÖ 
Include
ÜÜ 
=
ÜÜ 
$stráá Å
)
àà 
]
àà 
Campaign
àà 
campaign
àà !
)
àà! "
{
ââ 	
if
ää 
(
ää 

ModelState
ää 
.
ää 
IsValid
ää "
)
ää" #
{
ãã 
Db
åå 
.
åå 
Entry
åå 
(
åå 
campaign
åå !
)
åå! "
.
åå" #
State
åå# (
=
åå) *
EntityState
åå+ 6
.
åå6 7
Modified
åå7 ?
;
åå? @
Db
çç 
.
çç 
SaveChanges
çç 
(
çç 
)
çç  
;
çç  !
return
éé 
RedirectToAction
éé '
(
éé' (
$str
éé( /
)
éé/ 0
;
éé0 1
}
èè 
ViewBag
êê 
.
êê 
TestingUrgency
êê "
=
êê# $
new
êê% (

SelectList
êê) 3
(
êê3 4

EnumHelper
êê4 >
.
êê> ?
GetEnumTextValues
êê? P
(
êêP Q
typeof
êêQ W
(
êêW X
TestingUrgency
êêX f
)
êêf g
)
êêg h
,
êêh i
$str
êêj q
,
êêq r
$str
ëë 
,
ëë 
campaign
ëë  
.
ëë  !
TestingUrgency
ëë! /
)
ëë/ 0
;
ëë0 1
ViewBag
íí 
.
íí 
Status
íí 
=
íí 
new
íí  

SelectList
íí! +
(
íí+ ,

EnumHelper
íí, 6
.
íí6 7
GetEnumTextValues
íí7 H
(
ííH I
typeof
ííI O
(
ííO P
CampaignStatus
ííP ^
)
íí^ _
)
íí_ `
,
íí` a
$str
ííb i
,
ííi j
$str
íík q
,
ííq r
campaign
ìì 
.
ìì 
Status
ìì 
)
ìì  
;
ìì  !
return
îî 
View
îî 
(
îî 
campaign
îî  
)
îî  !
;
îî! "
}
ïï 	
public
óó 
ActionResult
óó 
Clone
óó !
(
óó! "
Guid
óó" &
?
óó& '
id
óó( *
)
óó* +
{
òò 	
Campaign
ôô 
campaign
ôô 
=
ôô 
Db
ôô  "
.
ôô" #
	Campaigns
ôô# ,
.
ôô, -
Find
ôô- 1
(
ôô1 2
id
ôô2 4
)
ôô4 5
;
ôô5 6
if
öö 
(
öö 
campaign
öö 
==
öö 
null
öö  
)
öö  !
{
õõ 
throw
úú 
new
úú 
HttpException
úú '
(
úú' (
$num
úú( +
,
úú+ ,
$str
úú- 8
)
úú8 9
;
úú9 :
}
ùù 
return
ûû 
View
ûû 
(
ûû 
$str
ûû 
,
ûû  
campaign
ûû! )
)
ûû) *
;
ûû* +
}
üü 	
[
°° 	
HttpPost
°°	 
,
°° 

ActionName
°° 
(
°° 
$str
°° %
)
°°% &
]
°°& '
[
¢¢ 	&
ValidateAntiForgeryToken
¢¢	 !
]
¢¢! "
public
££ 
ActionResult
££ 
CloneConfirmed
££ *
(
££* +
Guid
££+ /
id
££0 2
)
££2 3
{
§§ 	
var
•• 
camps
•• 
=
•• 
Db
•• 
.
•• 
	Campaigns
•• $
.
••$ %
ToList
••% +
(
••+ ,
)
••, -
;
••- .
int
¶¶ 
newOrderNumber
¶¶ 
=
¶¶  
camps
¶¶! &
.
¶¶& '
Count
¶¶' ,
>
¶¶- .
$num
¶¶/ 0
?
¶¶1 2
camps
¶¶3 8
.
¶¶8 9
Max
¶¶9 <
(
¶¶< =
x
¶¶= >
=>
¶¶? A
int
¶¶B E
.
¶¶E F
Parse
¶¶F K
(
¶¶K L
x
¶¶L M
.
¶¶M N
OrderNumber
¶¶N Y
.
¶¶Y Z
TrimEnd
¶¶Z a
(
¶¶a b
$str
¶¶b g
.
¶¶g h
ToCharArray
¶¶h s
(
¶¶s t
)
¶¶t u
)
¶¶u v
)
¶¶v w
)
¶¶w x
+
¶¶y z
$num
¶¶{ |
:
¶¶} ~
$num¶¶ É
;¶¶É Ñ
Campaign
®® 
campaign
®® 
=
®® 
Db
®®  "
.
®®" #
	Campaigns
®®# ,
.
©© 
Include
©© 
(
©© 
x
©© 
=>
©© 
x
©© 
.
©©  
Assets
©©  &
)
©©& '
.
™™ 
Include
™™ 
(
™™ 
x
™™ 
=>
™™ 
x
™™ 
.
™™  
Segments
™™  (
)
™™( )
.
´´ 
Include
´´ 
(
´´ 
x
´´ 
=>
´´ 
x
´´ 
.
´´  
Testing
´´  '
)
´´' (
.
¨¨ 
Include
¨¨ 
(
¨¨ 
x
¨¨ 
=>
¨¨ 
x
¨¨ 
.
¨¨  
Approved
¨¨  (
)
¨¨( )
.
≠≠ 
FirstOrDefault
≠≠ 
(
≠≠  
x
≠≠  !
=>
≠≠" $
x
≠≠% &
.
≠≠& '
Id
≠≠' )
==
≠≠* ,
id
≠≠- /
)
≠≠/ 0
;
≠≠0 1
var
ØØ 
copyId
ØØ 
=
ØØ 
Guid
ØØ 
.
ØØ 
NewGuid
ØØ %
(
ØØ% &
)
ØØ& '
;
ØØ' (
var
∞∞ 
copy
∞∞ 
=
∞∞ 
new
∞∞ 
Campaign
∞∞ #
(
∞∞# $
)
∞∞$ %
;
∞∞% &
Db
±± 
.
±± 
	Campaigns
±± 
.
±± 
Add
±± 
(
±± 
copy
±± !
)
±±! "
;
±±" #
Db
≤≤ 
.
≤≤ 
Entry
≤≤ 
(
≤≤ 
copy
≤≤ 
)
≤≤ 
.
≤≤ 
CurrentValues
≤≤ (
.
≤≤( )
	SetValues
≤≤) 2
(
≤≤2 3
Db
≤≤3 5
.
≤≤5 6
Entry
≤≤6 ;
(
≤≤; <
campaign
≤≤< D
)
≤≤D E
.
≤≤E F
CurrentValues
≤≤F S
)
≤≤S T
;
≤≤T U
copy
≥≥ 
.
≥≥ 
Id
≥≥ 
=
≥≥ 
copyId
≥≥ 
;
≥≥ 
copy
¥¥ 
.
¥¥ 
	CreatedAt
¥¥ 
=
¥¥ 
DateTime
¥¥ %
.
¥¥% &
Now
¥¥& )
;
¥¥) *
copy
µµ 
.
µµ 
OrderNumber
µµ 
=
µµ 
newOrderNumber
µµ -
.
µµ- .
ToString
µµ. 6
(
µµ6 7
)
µµ7 8
;
µµ8 9
copy
∂∂ 
.
∂∂ 
Status
∂∂ 
=
∂∂ 
(
∂∂ 
int
∂∂ 
)
∂∂ 
CampaignStatus
∂∂ -
.
∂∂- .
OrderRecevied
∂∂. ;
;
∂∂; <
copy
∑∑ 
.
∑∑ 
	TestingId
∑∑ 
=
∑∑ 
null
∑∑ !
;
∑∑! "
copy
∏∏ 
.
∏∏ 

ApprovedId
∏∏ 
=
∏∏ 
null
∏∏ "
;
∏∏" #
Db
ππ 
.
ππ 
SaveChanges
ππ 
(
ππ 
)
ππ 
;
ππ 
var
ªª 

copyAssets
ªª 
=
ªª 
new
ªª  
CampaignAsset
ªª! .
(
ªª. /
)
ªª/ 0
;
ªª0 1
Db
ºº 
.
ºº 
CampaignAssets
ºº 
.
ºº 
Add
ºº !
(
ºº! "

copyAssets
ºº" ,
)
ºº, -
;
ºº- .
Db
ΩΩ 
.
ΩΩ 
Entry
ΩΩ 
(
ΩΩ 

copyAssets
ΩΩ 
)
ΩΩ  
.
ΩΩ  !
CurrentValues
ΩΩ! .
.
ΩΩ. /
	SetValues
ΩΩ/ 8
(
ΩΩ8 9
Db
ΩΩ9 ;
.
ΩΩ; <
Entry
ΩΩ< A
(
ΩΩA B
campaign
ΩΩB J
.
ΩΩJ K
Assets
ΩΩK Q
)
ΩΩQ R
.
ΩΩR S
CurrentValues
ΩΩS `
)
ΩΩ` a
;
ΩΩa b

copyAssets
ææ 
.
ææ 
Id
ææ 
=
ææ 
Guid
ææ  
.
ææ  !
NewGuid
ææ! (
(
ææ( )
)
ææ) *
;
ææ* +

copyAssets
øø 
.
øø 

CampaignId
øø !
=
øø" #
copyId
øø$ *
;
øø* +

copyAssets
¿¿ 
.
¿¿ 
	CreatedAt
¿¿  
=
¿¿! "
DateTime
¿¿# +
.
¿¿+ ,
Now
¿¿, /
;
¿¿/ 0
Db
¡¡ 
.
¡¡ 
SaveChanges
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡ 
copy
¬¬ 
.
¬¬ 
AssetsId
¬¬ 
=
¬¬ 

copyAssets
¬¬ &
.
¬¬& '
Id
¬¬' )
;
¬¬) *
Db
√√ 
.
√√ 
SaveChanges
√√ 
(
√√ 
)
√√ 
;
√√ 
foreach
≈≈ 
(
≈≈ 
var
≈≈ 
segment
≈≈  
in
≈≈! #
campaign
≈≈$ ,
.
≈≈, -
Segments
≈≈- 5
.
≈≈5 6
ToList
≈≈6 <
(
≈≈< =
)
≈≈= >
)
≈≈> ?
{
∆∆ 
var
«« 
copySegment
«« 
=
««  !
new
««" %
CampaignSegment
««& 5
(
««5 6
)
««6 7
;
««7 8
Db
»» 
.
»» 
CampaignSegments
»» #
.
»»# $
Add
»»$ '
(
»»' (
copySegment
»»( 3
)
»»3 4
;
»»4 5
Db
…… 
.
…… 
Entry
…… 
(
…… 
copySegment
…… $
)
……$ %
.
……% &
CurrentValues
……& 3
.
……3 4
	SetValues
……4 =
(
……= >
Db
……> @
.
……@ A
Entry
……A F
(
……F G
segment
……G N
)
……N O
.
……O P
CurrentValues
……P ]
)
……] ^
;
……^ _
copySegment
   
.
   
Id
   
=
    
Guid
  ! %
.
  % &
NewGuid
  & -
(
  - .
)
  . /
;
  / 0
copySegment
ÀÀ 
.
ÀÀ 

CampaignId
ÀÀ &
=
ÀÀ' (
copyId
ÀÀ) /
;
ÀÀ/ 0
copySegment
ÃÃ 
.
ÃÃ 
OrderNumber
ÃÃ '
=
ÃÃ( )
$str
ÃÃ* ,
+
ÃÃ- .
newOrderNumber
ÃÃ/ =
;
ÃÃ= >
copySegment
ÕÕ 
.
ÕÕ 
	CreatedAt
ÕÕ %
=
ÕÕ& '
DateTime
ÕÕ( 0
.
ÕÕ0 1
Now
ÕÕ1 4
;
ÕÕ4 5
Db
ŒŒ 
.
ŒŒ 
SaveChanges
ŒŒ 
(
ŒŒ 
)
ŒŒ  
;
ŒŒ  !
}
œœ 
if
—— 
(
—— 
campaign
—— 
.
—— 
Testing
——  
!=
——! #
null
——$ (
)
——( )
{
““ 
var
”” 
	testingId
”” 
=
”” 
Guid
””  $
.
””$ %
NewGuid
””% ,
(
””, -
)
””- .
;
””. /
var
‘‘ 
testing
‘‘ 
=
‘‘ 
new
‘‘ !
CampaignTesting
‘‘" 1
(
‘‘1 2
)
‘‘2 3
;
‘‘3 4
Db
’’ 
.
’’ 
CampaignsTesting
’’ #
.
’’# $
Add
’’$ '
(
’’' (
testing
’’( /
)
’’/ 0
;
’’0 1
Db
÷÷ 
.
÷÷ 
Entry
÷÷ 
(
÷÷ 
testing
÷÷  
)
÷÷  !
.
÷÷! "
CurrentValues
÷÷" /
.
÷÷/ 0
	SetValues
÷÷0 9
(
÷÷9 :
Db
÷÷: <
.
÷÷< =
Entry
÷÷= B
(
÷÷B C
campaign
÷÷C K
.
÷÷K L
Testing
÷÷L S
)
÷÷S T
.
÷÷T U
CurrentValues
÷÷U b
)
÷÷b c
;
÷÷c d
testing
◊◊ 
.
◊◊ 
Id
◊◊ 
=
◊◊ 
	testingId
◊◊ &
;
◊◊& '
testing
ÿÿ 
.
ÿÿ 
	CreatedAt
ÿÿ !
=
ÿÿ" #
DateTime
ÿÿ$ ,
.
ÿÿ, -
Now
ÿÿ- 0
;
ÿÿ0 1
testing
ŸŸ 
.
ŸŸ 

CampaignId
ŸŸ "
=
ŸŸ# $
copy
ŸŸ% )
.
ŸŸ) *
Id
ŸŸ* ,
;
ŸŸ, -
Db
⁄⁄ 
.
⁄⁄ 
SaveChanges
⁄⁄ 
(
⁄⁄ 
)
⁄⁄  
;
⁄⁄  !
copy
‹‹ 
.
‹‹ 
	TestingId
‹‹ 
=
‹‹  
	testingId
‹‹! *
;
‹‹* +
Db
›› 
.
›› 
SaveChanges
›› 
(
›› 
)
››  
;
››  !
}
ﬁﬁ 
if
‡‡ 
(
‡‡ 
campaign
‡‡ 
.
‡‡ 
Approved
‡‡ !
!=
‡‡" $
null
‡‡% )
)
‡‡) *
{
·· 
var
‚‚ 

approvedId
‚‚ 
=
‚‚  
Guid
‚‚! %
.
‚‚% &
NewGuid
‚‚& -
(
‚‚- .
)
‚‚. /
;
‚‚/ 0
var
„„ 
approved
„„ 
=
„„ 
new
„„ "
CampaignApproved
„„# 3
(
„„3 4
)
„„4 5
;
„„5 6
Db
‰‰ 
.
‰‰ 
CampaignsApproved
‰‰ $
.
‰‰$ %
Add
‰‰% (
(
‰‰( )
approved
‰‰) 1
)
‰‰1 2
;
‰‰2 3
Db
ÂÂ 
.
ÂÂ 
Entry
ÂÂ 
(
ÂÂ 
approved
ÂÂ !
)
ÂÂ! "
.
ÂÂ" #
CurrentValues
ÂÂ# 0
.
ÂÂ0 1
	SetValues
ÂÂ1 :
(
ÂÂ: ;
Db
ÂÂ; =
.
ÂÂ= >
Entry
ÂÂ> C
(
ÂÂC D
campaign
ÂÂD L
.
ÂÂL M
Approved
ÂÂM U
)
ÂÂU V
.
ÂÂV W
CurrentValues
ÂÂW d
)
ÂÂd e
;
ÂÂe f
approved
ÊÊ 
.
ÊÊ 
Id
ÊÊ 
=
ÊÊ 

approvedId
ÊÊ (
;
ÊÊ( )
approved
ÁÁ 
.
ÁÁ 
	CreatedAt
ÁÁ "
=
ÁÁ# $
DateTime
ÁÁ% -
.
ÁÁ- .
Now
ÁÁ. 1
;
ÁÁ1 2
approved
ËË 
.
ËË 

CampaignId
ËË #
=
ËË$ %
copy
ËË& *
.
ËË* +
Id
ËË+ -
;
ËË- .
Db
ÈÈ 
.
ÈÈ 
SaveChanges
ÈÈ 
(
ÈÈ 
)
ÈÈ  
;
ÈÈ  !
copy
ÎÎ 
.
ÎÎ 

ApprovedId
ÎÎ 
=
ÎÎ  !

approvedId
ÎÎ" ,
;
ÎÎ, -
Db
ÏÏ 
.
ÏÏ 
SaveChanges
ÏÏ 
(
ÏÏ 
)
ÏÏ  
;
ÏÏ  !
}
ÌÌ 
ForceOrders
ÓÓ 
=
ÓÓ 
true
ÓÓ 
;
ÓÓ 
TempData
ÔÔ 
[
ÔÔ 
$str
ÔÔ 
]
ÔÔ 
=
ÔÔ  !
$str
ÔÔ" ,
+
ÔÔ- .
campaign
ÔÔ/ 7
.
ÔÔ7 8
OrderNumber
ÔÔ8 C
+
ÔÔD E
$str
ÔÔF c
+
ÔÔd e
newOrderNumber
ÔÔf t
+
ÔÔu v
$strÔÔw Ü
;ÔÔÜ á
return
 
RedirectToAction
 #
(
# $
$str
$ +
,
+ ,
$str
- 8
)
8 9
;
9 :
}
ÒÒ 	
public
ÙÙ 
ActionResult
ÙÙ 
Delete
ÙÙ "
(
ÙÙ" #
Guid
ÙÙ# '
?
ÙÙ' (
id
ÙÙ) +
)
ÙÙ+ ,
{
ıı 	
if
ˆˆ 
(
ˆˆ 
id
ˆˆ 
==
ˆˆ 
null
ˆˆ 
)
ˆˆ 
{
˜˜ 
throw
¯¯ 
new
¯¯ 
HttpException
¯¯ '
(
¯¯' (
$num
¯¯( +
,
¯¯+ ,
$str
¯¯- :
)
¯¯: ;
;
¯¯; <
}
˘˘ 
Campaign
˙˙ 
campaign
˙˙ 
=
˙˙ 
Db
˙˙  "
.
˙˙" #
	Campaigns
˙˙# ,
.
˙˙, -
Find
˙˙- 1
(
˙˙1 2
id
˙˙2 4
)
˙˙4 5
;
˙˙5 6
if
˚˚ 
(
˚˚ 
campaign
˚˚ 
==
˚˚ 
null
˚˚  
)
˚˚  !
{
¸¸ 
throw
˝˝ 
new
˝˝ 
HttpException
˝˝ '
(
˝˝' (
$num
˝˝( +
,
˝˝+ ,
$str
˝˝- 8
)
˝˝8 9
;
˝˝9 :
}
˛˛ 
return
ˇˇ 
View
ˇˇ 
(
ˇˇ 
campaign
ˇˇ  
)
ˇˇ  !
;
ˇˇ! "
}
ÄÄ 	
[
ÉÉ 	
HttpPost
ÉÉ	 
,
ÉÉ 

ActionName
ÉÉ 
(
ÉÉ 
$str
ÉÉ &
)
ÉÉ& '
]
ÉÉ' (
[
ÑÑ 	&
ValidateAntiForgeryToken
ÑÑ	 !
]
ÑÑ! "
public
ÖÖ 
ActionResult
ÖÖ 
DeleteConfirmed
ÖÖ +
(
ÖÖ+ ,
Guid
ÖÖ, 0
id
ÖÖ1 3
)
ÖÖ3 4
{
ÜÜ 	
Campaign
áá 
campaign
áá 
=
áá 
Db
áá  "
.
áá" #
	Campaigns
áá# ,
.
áá, -
Find
áá- 1
(
áá1 2
id
áá2 4
)
áá4 5
;
áá5 6
var
àà 
proDatas
àà 
=
àà 
Db
àà 
.
àà 
ProDatas
àà &
.
àà& '
Where
àà' ,
(
àà, -
x
àà- .
=>
àà/ 1
x
àà2 3
.
àà3 4

CampaignId
àà4 >
==
àà? A
campaign
ààB J
.
ààJ K
Id
ààK M
)
ààM N
;
ààN O
foreach
ââ 
(
ââ 
var
ââ 
proData
ââ  
in
ââ! #
proDatas
ââ$ ,
)
ââ, -
{
ää 
Db
ãã 
.
ãã 
ProDatas
ãã 
.
ãã 
Remove
ãã "
(
ãã" #
proData
ãã# *
)
ãã* +
;
ãã+ ,
}
åå 
Db
çç 
.
çç 
SaveChanges
çç 
(
çç 
)
çç 
;
çç 
var
èè 
segments
èè 
=
èè 
Db
èè 
.
èè 
CampaignSegments
èè .
.
èè. /
Where
èè/ 4
(
èè4 5
x
èè5 6
=>
èè7 9
x
èè: ;
.
èè; <

CampaignId
èè< F
==
èèG I
campaign
èèJ R
.
èèR S
Id
èèS U
)
èèU V
;
èèV W
foreach
êê 
(
êê 
var
êê 
segment
êê  
in
êê! #
segments
êê$ ,
)
êê, -
{
ëë 
Db
íí 
.
íí 
CampaignSegments
íí #
.
íí# $
Remove
íí$ *
(
íí* +
segment
íí+ 2
)
íí2 3
;
íí3 4
}
ìì 
Db
îî 
.
îî 
SaveChanges
îî 
(
îî 
)
îî 
;
îî 
var
ññ 
assets
ññ 
=
ññ 
Db
ññ 
.
ññ 
CampaignAssets
ññ *
.
ññ* +
FirstOrDefault
ññ+ 9
(
ññ9 :
x
ññ: ;
=>
ññ< >
x
ññ? @
.
ññ@ A

CampaignId
ññA K
==
ññL N
campaign
ññO W
.
ññW X
Id
ññX Z
)
ññZ [
;
ññ[ \
if
óó 
(
óó 
assets
óó 
!=
óó 
null
óó 
)
óó 
Db
òò 
.
òò 
CampaignAssets
òò !
.
òò! "
Remove
òò" (
(
òò( )
assets
òò) /
)
òò/ 0
;
òò0 1
Db
ôô 
.
ôô 
SaveChanges
ôô 
(
ôô 
)
ôô 
;
ôô 
var
õõ 
testing
õõ 
=
õõ 
Db
õõ 
.
õõ 
CampaignsTesting
õõ -
.
õõ- .
FirstOrDefault
õõ. <
(
õõ< =
x
õõ= >
=>
õõ? A
x
õõB C
.
õõC D

CampaignId
õõD N
==
õõO Q
campaign
õõR Z
.
õõZ [
Id
õõ[ ]
)
õõ] ^
;
õõ^ _
if
úú 
(
úú 
testing
úú 
!=
úú 
null
úú 
)
úú 
Db
ùù 
.
ùù 
CampaignsTesting
ùù #
.
ùù# $
Remove
ùù$ *
(
ùù* +
testing
ùù+ 2
)
ùù2 3
;
ùù3 4
Db
ûû 
.
ûû 
SaveChanges
ûû 
(
ûû 
)
ûû 
;
ûû 
var
†† 
approved
†† 
=
†† 
Db
†† 
.
†† 
CampaignsApproved
†† /
.
††/ 0
FirstOrDefault
††0 >
(
††> ?
x
††? @
=>
††A C
x
††D E
.
††E F

CampaignId
††F P
==
††Q S
campaign
††T \
.
††\ ]
Id
††] _
)
††_ `
;
††` a
if
°° 
(
°° 
approved
°° 
!=
°° 
null
°°  
)
°°  !
Db
¢¢ 
.
¢¢ 
CampaignsApproved
¢¢ $
.
¢¢$ %
Remove
¢¢% +
(
¢¢+ ,
approved
¢¢, 4
)
¢¢4 5
;
¢¢5 6
Db
££ 
.
££ 
SaveChanges
££ 
(
££ 
)
££ 
;
££ 
Db
•• 
.
•• 
	Campaigns
•• 
.
•• 
Remove
•• 
(
••  
campaign
••  (
)
••( )
;
••) *
Db
¶¶ 
.
¶¶ 
SaveChanges
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶ 
ForceOrders
ßß 
=
ßß 
true
ßß 
;
ßß 
TempData
®® 
[
®® 
$str
®® 
]
®® 
=
®®  !
$str
®®" +
+
®®, -
campaign
®®. 6
.
®®6 7
OrderNumber
®®7 B
+
®®C D
$str
®®E e
;
®®e f
return
©© 
RedirectToAction
©© #
(
©©# $
$str
©©$ +
)
©©+ ,
;
©©, -
}
™™ 	
public
¨¨ 
ActionResult
¨¨ 
Cancel
¨¨ "
(
¨¨" #
Guid
¨¨# '
?
¨¨' (
id
¨¨) +
)
¨¨+ ,
{
≠≠ 	
if
ÆÆ 
(
ÆÆ 
id
ÆÆ 
==
ÆÆ 
null
ÆÆ 
)
ÆÆ 
{
ØØ 
throw
∞∞ 
new
∞∞ 
HttpException
∞∞ '
(
∞∞' (
$num
∞∞( +
,
∞∞+ ,
$str
∞∞- :
)
∞∞: ;
;
∞∞; <
}
±± 
Campaign
≤≤ 
campaign
≤≤ 
=
≤≤ 
Db
≤≤  "
.
≤≤" #
	Campaigns
≤≤# ,
.
≤≤, -
Find
≤≤- 1
(
≤≤1 2
id
≤≤2 4
)
≤≤4 5
;
≤≤5 6
if
≥≥ 
(
≥≥ 
campaign
≥≥ 
==
≥≥ 
null
≥≥  
)
≥≥  !
{
¥¥ 
throw
µµ 
new
µµ 
HttpException
µµ '
(
µµ' (
$num
µµ( +
,
µµ+ ,
$str
µµ- 8
)
µµ8 9
;
µµ9 :
}
∂∂ 
return
∑∑ 
View
∑∑ 
(
∑∑ 
campaign
∑∑  
)
∑∑  !
;
∑∑! "
}
∏∏ 	
[
∫∫ 	
HttpPost
∫∫	 
,
∫∫ 

ActionName
∫∫ 
(
∫∫ 
$str
∫∫ &
)
∫∫& '
]
∫∫' (
[
ªª 	&
ValidateAntiForgeryToken
ªª	 !
]
ªª! "
public
ºº 
ActionResult
ºº 
CancelConfirmed
ºº +
(
ºº+ ,
Guid
ºº, 0
id
ºº1 3
)
ºº3 4
{
ΩΩ 	
var
ææ 
campaign
ææ 
=
ææ 
Db
ææ 
.
ææ 
	Campaigns
ææ '
.
ææ' (
Find
ææ( ,
(
ææ, -
id
ææ- /
)
ææ/ 0
;
ææ0 1
campaign
øø 
.
øø 
Status
øø 
=
øø 
(
øø 
int
øø "
)
øø" #
CampaignStatus
øø# 1
.
øø1 2
	Cancelled
øø2 ;
;
øø; <
Db
¿¿ 
.
¿¿ 
SaveChanges
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿ 
TempData
¡¡ 
[
¡¡ 
$str
¡¡ 
]
¡¡ 
=
¡¡  !
$str
¡¡" +
+
¡¡, -
campaign
¡¡. 6
.
¡¡6 7
OrderNumber
¡¡7 B
+
¡¡C D
$str
¡¡E g
;
¡¡g h
return
¬¬ 
RedirectToAction
¬¬ #
(
¬¬# $
$str
¬¬$ +
,
¬¬+ ,
$str
¬¬- 8
)
¬¬8 9
;
¬¬9 :
}
√√ 	
public
≈≈ 
ActionResult
≈≈ 
Complete
≈≈ $
(
≈≈$ %
Guid
≈≈% )
?
≈≈) *
id
≈≈+ -
)
≈≈- .
{
∆∆ 	
if
«« 
(
«« 
id
«« 
==
«« 
null
«« 
)
«« 
{
»» 
throw
…… 
new
…… 
HttpException
…… '
(
……' (
$num
……( +
,
……+ ,
$str
……- :
)
……: ;
;
……; <
}
   
Campaign
ÀÀ 
campaign
ÀÀ 
=
ÀÀ 
Db
ÀÀ  "
.
ÀÀ" #
	Campaigns
ÀÀ# ,
.
ÀÀ, -
Find
ÀÀ- 1
(
ÀÀ1 2
id
ÀÀ2 4
)
ÀÀ4 5
;
ÀÀ5 6
if
ÃÃ 
(
ÃÃ 
campaign
ÃÃ 
==
ÃÃ 
null
ÃÃ  
)
ÃÃ  !
{
ÕÕ 
throw
ŒŒ 
new
ŒŒ 
HttpException
ŒŒ '
(
ŒŒ' (
$num
ŒŒ( +
,
ŒŒ+ ,
$str
ŒŒ- 8
)
ŒŒ8 9
;
ŒŒ9 :
}
œœ 
return
–– 
View
–– 
(
–– 
campaign
––  
)
––  !
;
––! "
}
—— 	
[
”” 	
HttpPost
””	 
,
”” 

ActionName
”” 
(
”” 
$str
”” (
)
””( )
]
””) *
[
‘‘ 	&
ValidateAntiForgeryToken
‘‘	 !
]
‘‘! "
public
’’ 
ActionResult
’’ 
CompleteConfirmed
’’ -
(
’’- .
Guid
’’. 2
id
’’3 5
)
’’5 6
{
÷÷ 	
var
◊◊ 
campaign
◊◊ 
=
◊◊ 
Db
◊◊ 
.
◊◊ 
	Campaigns
◊◊ '
.
◊◊' (
Include
◊◊( /
(
◊◊/ 0
x
◊◊0 1
=>
◊◊2 4
x
◊◊5 6
.
◊◊6 7
Testing
◊◊7 >
)
◊◊> ?
.
◊◊? @
FirstOrDefault
◊◊@ N
(
◊◊N O
x
◊◊O P
=>
◊◊Q S
x
◊◊T U
.
◊◊U V
Id
◊◊V X
==
◊◊Y [
id
◊◊\ ^
)
◊◊^ _
;
◊◊_ `
if
ÿÿ 
(
ÿÿ 
campaign
ÿÿ 
.
ÿÿ 
Testing
ÿÿ  
==
ÿÿ! #
null
ÿÿ$ (
)
ÿÿ( )
{
ŸŸ 
TempData
⁄⁄ 
[
⁄⁄ 
$str
⁄⁄  
]
⁄⁄  !
=
⁄⁄" #
$str
⁄⁄$ H
;
⁄⁄H I
return
€€ 
RedirectToAction
€€ '
(
€€' (
$str
€€( /
,
€€/ 0
$str
€€1 <
)
€€< =
;
€€= >
}
‹‹ 
var
›› "
notCompletedSegments
›› $
=
››% &
Db
››' )
.
››) *
CampaignSegments
››* :
.
ﬁﬁ 
Where
ﬁﬁ 
(
ﬁﬁ 
x
ﬁﬁ 
=>
ﬁﬁ 
x
ﬁﬁ 
.
ﬁﬁ 

CampaignId
ﬁﬁ (
==
ﬁﬁ) +
campaign
ﬁﬁ, 4
.
ﬁﬁ4 5
Id
ﬁﬁ5 7
&&
ﬁﬁ8 :
x
ﬁﬁ; <
.
ﬁﬁ< =
SegmentStatus
ﬁﬁ= J
!=
ﬁﬁK M
(
ﬁﬁN O
int
ﬁﬁO R
)
ﬁﬁR S
SegmentStatus
ﬁﬁS `
.
ﬁﬁ` a
Complete
ﬁﬁa i
)
ﬁﬁi j
;
ﬁﬁj k
if
ﬂﬂ 
(
ﬂﬂ "
notCompletedSegments
ﬂﬂ $
.
ﬂﬂ$ %
Any
ﬂﬂ% (
(
ﬂﬂ( )
)
ﬂﬂ) *
)
ﬂﬂ* +
{
‡‡ 
string
·· 
segments
·· 
=
··  !
string
··" (
.
··( )
Join
··) -
(
··- .
$str
··. 1
,
··1 2"
notCompletedSegments
··3 G
.
··G H
Select
··H N
(
··N O
x
··O P
=>
··Q S
x
··T U
.
··U V
SegmentNumber
··V c
)
··c d
)
··d e
;
··e f
TempData
‚‚ 
[
‚‚ 
$str
‚‚  
]
‚‚  !
=
‚‚" #
$str
‚‚$ /
+
‚‚0 1
segments
‚‚2 :
+
‚‚; <
$str
‚‚= _
;
‚‚_ `
return
„„ 
RedirectToAction
„„ '
(
„„' (
$str
„„( /
,
„„/ 0
$str
„„1 <
)
„„< =
;
„„= >
}
‰‰ 
campaign
ÂÂ 
.
ÂÂ 
Status
ÂÂ 
=
ÂÂ 
(
ÂÂ 
int
ÂÂ "
)
ÂÂ" #
CampaignStatus
ÂÂ# 1
.
ÂÂ1 2
	Completed
ÂÂ2 ;
;
ÂÂ; <
Db
ÊÊ 
.
ÊÊ 
SaveChanges
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
TempData
ÁÁ 
[
ÁÁ 
$str
ÁÁ 
]
ÁÁ 
=
ÁÁ  !
$str
ÁÁ" -
+
ÁÁ. /
campaign
ÁÁ0 8
.
ÁÁ8 9
CampaignName
ÁÁ9 E
+
ÁÁF G
$str
ÁÁH j
;
ÁÁj k
return
ËË 
RedirectToAction
ËË #
(
ËË# $
$str
ËË$ +
,
ËË+ ,
$str
ËË- 8
)
ËË8 9
;
ËË9 :
}
ÈÈ 	
public
ÎÎ 
ActionResult
ÎÎ 
Rebroad
ÎÎ #
(
ÎÎ# $
Guid
ÎÎ$ (
?
ÎÎ( )
id
ÎÎ* ,
)
ÎÎ, -
{
ÏÏ 	
if
ÌÌ 
(
ÌÌ 
id
ÌÌ 
==
ÌÌ 
null
ÌÌ 
)
ÌÌ 
{
ÓÓ 
throw
ÔÔ 
new
ÔÔ 
HttpException
ÔÔ '
(
ÔÔ' (
$num
ÔÔ( +
,
ÔÔ+ ,
$str
ÔÔ- :
)
ÔÔ: ;
;
ÔÔ; <
}
 
Campaign
ÒÒ 
campaign
ÒÒ 
=
ÒÒ 
Db
ÒÒ  "
.
ÒÒ" #
	Campaigns
ÒÒ# ,
.
ÒÒ, -
Include
ÒÒ- 4
(
ÒÒ4 5
x
ÒÒ5 6
=>
ÒÒ7 9
x
ÒÒ: ;
.
ÒÒ; <
Segments
ÒÒ< D
)
ÒÒD E
.
ÒÒE F
Include
ÒÒF M
(
ÒÒM N
x
ÒÒN O
=>
ÒÒP R
x
ÒÒS T
.
ÒÒT U
	Trackings
ÒÒU ^
)
ÒÒ^ _
.
ÚÚ 
FirstOrDefault
ÚÚ 
(
ÚÚ  
x
ÚÚ  !
=>
ÚÚ" $
x
ÚÚ% &
.
ÚÚ& '
Id
ÚÚ' )
==
ÚÚ* ,
id
ÚÚ- /
)
ÚÚ/ 0
;
ÚÚ0 1
if
ÛÛ 
(
ÛÛ 
campaign
ÛÛ 
==
ÛÛ 
null
ÛÛ  
)
ÛÛ  !
{
ÙÙ 
throw
ıı 
new
ıı 
HttpException
ıı '
(
ıı' (
$num
ıı( +
,
ıı+ ,
$str
ıı- 8
)
ıı8 9
;
ıı9 :
}
ˆˆ 
var
˜˜ 
proData
˜˜ 
=
˜˜ 
VendorsList
˜˜ %
.
˜˜% &
FirstOrDefault
˜˜& 4
(
˜˜4 5
x
˜˜5 6
=>
˜˜7 9
x
˜˜: ;
.
˜˜; <
Text
˜˜< @
.
˜˜@ A
Contains
˜˜A I
(
˜˜I J
$str
˜˜J O
)
˜˜O P
)
˜˜P Q
;
˜˜Q R
ViewBag
¯¯ 
.
¯¯ 
Vendor
¯¯ 
=
¯¯ 
new
¯¯  

SelectList
¯¯! +
(
¯¯+ ,
VendorsList
¯¯, 7
,
¯¯7 8
$str
¯¯9 @
,
¯¯@ A
$str
¯¯B H
,
¯¯H I
proData
¯¯J Q
)
¯¯Q R
;
¯¯R S
var
˙˙ 
campaignTracking
˙˙  
=
˙˙! "
campaign
˙˙# +
.
˙˙+ ,
	Trackings
˙˙, 5
.
˙˙5 6
FirstOrDefault
˙˙6 D
(
˙˙D E
x
˙˙E F
=>
˙˙G I
x
˙˙J K
.
˙˙K L
SegmentNumber
˙˙L Y
==
˙˙Z \
string
˙˙] c
.
˙˙c d
Empty
˙˙d i
)
˙˙i j
;
˙˙j k
long
¸¸  
opennedFromOrignal
¸¸ #
=
¸¸$ %
campaignTracking
¸¸& 6
?
¸¸6 7
.
¸¸7 8
Opened
¸¸8 >
??
¸¸? A
campaign
¸¸B J
.
¸¸J K
Quantity
¸¸K S
;
¸¸S T
campaign
˝˝ 
.
˝˝ #
ReBroadcastedQuantity
˝˝ *
=
˝˝+ , 
opennedFromOrignal
˝˝- ?
;
˝˝? @
return
˛˛ 
View
˛˛ 
(
˛˛ 
campaign
˛˛  
)
˛˛  !
;
˛˛! "
}
ˇˇ 	
[
ÅÅ 	
HttpPost
ÅÅ	 
,
ÅÅ 

ActionName
ÅÅ 
(
ÅÅ 
$str
ÅÅ '
)
ÅÅ' (
]
ÅÅ( )
[
ÇÇ 	&
ValidateAntiForgeryToken
ÇÇ	 !
]
ÇÇ! "
public
ÉÉ 
ActionResult
ÉÉ 
RebroadConfirmed
ÉÉ ,
(
ÉÉ, -
Guid
ÉÉ- 1
?
ÉÉ1 2
Id
ÉÉ2 4
,
ÉÉ4 5
DateTime
ÉÉ6 >
?
ÉÉ> ?
ReBroadcastedDate
ÉÉ@ Q
,
ÉÉQ R
long
ÉÉS W#
ReBroadcastedQuantity
ÉÉX m
,
ÉÉm n
Guid
ÉÉo s
?
ÉÉs t
Vendor
ÉÉu {
,
ÉÉ{ |
stringÉÉ} É
[ÉÉÉ Ñ
]ÉÉÑ Ö 
SegmentsSelectedÉÉÜ ñ
)ÉÉñ ó
{
ÑÑ 	
if
ÖÖ 
(
ÖÖ 
ReBroadcastedDate
ÖÖ !
==
ÖÖ" $
null
ÖÖ% )
||
ÖÖ* ,
Vendor
ÖÖ- 3
==
ÖÖ4 6
null
ÖÖ7 ;
)
ÖÖ; <
{
ÜÜ 
TempData
áá 
[
áá 
$str
áá  
]
áá  !
=
áá" #
$"
áá$ &7
)ReBroadcastedDate and Vendor is required.
áá& O
"
ááO P
;
ááP Q
return
àà 
RedirectToAction
àà '
(
àà' (
$str
àà( 1
,
àà1 2
$str
àà3 >
,
àà> ?
new
àà@ C
{
ààD E
id
ààF H
=
ààJ K
Id
ààL N
}
ààN O
)
ààO P
;
ààP Q
}
ââ 
Campaign
ää 
campaign
ää 
=
ää 
Db
ää  "
.
ää" #
	Campaigns
ää# ,
.
ää, -
FirstOrDefault
ää- ;
(
ää; <
x
ää< =
=>
ää> @
x
ääA B
.
ääB C
Id
ääC E
==
ääF H
Id
ääI K
)
ääK L
;
ääL M
if
ãã 
(
ãã 
campaign
ãã 
.
ãã 
ReBroadcasted
ãã &
)
ãã& '
{
åå 
TempData
çç 
[
çç 
$str
çç  
]
çç  !
=
çç" #
$"
çç$ &$
Already rebroadcasted.
çç& <
"
çç< =
;
çç= >
return
éé 
RedirectToAction
éé '
(
éé' (
$str
éé( 1
,
éé1 2
$str
éé3 >
,
éé> ?
new
éé@ C
{
ééD E
id
ééF H
=
ééI J
Id
ééK M
}
ééN O
)
ééO P
;
ééP Q
}
èè 
campaign
êê 
.
êê 
ReBroadcasted
êê "
=
êê# $
true
êê% )
;
êê) *
campaign
ëë 
.
ëë 
ReBroadcastedDate
ëë &
=
ëë' (
ReBroadcastedDate
ëë) :
;
ëë: ;
campaign
íí 
.
íí #
ReBroadcastedQuantity
íí *
=
íí+ ,#
ReBroadcastedQuantity
íí- B
;
ííB C
campaign
ìì 
.
ìì &
ReBroadcastedOrderNumber
ìì -
=
ìì. /
campaign
ìì0 8
.
ìì8 9
OrderNumber
ìì9 D
+
ììE F
$str
ììG L
;
ììL M
Db
îî 
.
îî 
SaveChanges
îî 
(
îî 
)
îî 
;
îî 
BackgroundJob
óó 
.
óó 
Enqueue
óó !
(
óó! "
(
óó" #
)
óó# $
=>
óó% '
CampaignProcessor
óó( 9
.
óó9 :
SendVendorEmail
óó: I
(
óóI J
Vendor
óóJ P
,
óóP Q
campaign
óóR Z
.
óóZ [
OrderNumber
óó[ f
,
óóf g
SegmentsSelected
óóh x
)
óóx y
)
óóy z
;
óóz {
TempData
ôô 
[
ôô 
$str
ôô 
]
ôô 
=
ôô  !
$str
ôô" ,
+
ôô- .
campaign
ôô/ 7
.
ôô7 8
OrderNumber
ôô8 C
+
ôôD E
$str
ôôF S
+
ôôT U
campaign
ôôV ^
.
ôô^ _
CampaignName
ôô_ k
+
ôôl m
$strôôn ù
;ôôù û
return
öö 
RedirectToAction
öö #
(
öö# $
$str
öö$ +
,
öö+ ,
$str
öö- 8
)
öö8 9
;
öö9 :
}
õõ 	
}
úú 
}ùù ‘
HE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\ErrorController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
public 

class 
ErrorController  
:! "
BaseController# 1
{ 
public

 
ActionResult

 
Index

 !
(

! "
)

" #
{ 	
return 
RedirectToAction #
(# $
$str$ 2
,2 3
new4 7
HandleErrorInfo8 G
(G H
newH K
HttpExceptionL Y
(Y Z
$numZ ]
,] ^
$str_ |
)| }
,} ~
$str	 ê
,
ê ë
$str
í ô
)
ô ö
)
ö õ
;
õ ú
} 	
public 

ViewResult 
GenericError &
(& '
HandleErrorInfo' 6
	exception7 @
)@ A
{ 	
return 
View 
( 
$str 
,  
	exception! *
)* +
;+ ,
} 	
public 

ViewResult 
NotFound "
(" #
HandleErrorInfo# 2
	exception3 <
)< =
{ 	
ViewBag 
. 
Title 
= 
$str ,
;, -
return 
View 
( 
$str 
,  
new! $
HandleErrorInfo% 4
(4 5
new5 8
HttpException9 F
(F G
$numG J
,J K
$strL \
)\ ]
,] ^
$str_ p
,p q
$strr y
)y z
)z {
;{ |
} 	
public 

ViewResult 

BadRequest $
($ %
HandleErrorInfo% 4
	exception5 >
)> ?
{ 	
ViewBag 
. 
Title 
= 
$str .
;. /
return 
View 
( 
$str 
,  
new! $
HandleErrorInfo% 4
(4 5
new5 8
HttpException9 F
(F G
$numG J
,J K
$strL ^
)^ _
,_ `
$stra r
,r s
$strt {
){ |
)| }
;} ~
} 	
public   

ViewResult   
NotAuthorized   '
(  ' (
)  ( )
{!! 	
ViewBag"" 
."" 
Title"" 
="" 
$str"" 4
;""4 5
return## 
View## 
(## 
$str## 
)##  
;##  !
}$$ 	
}%% 
}&& åj
GE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\FileController.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Controllers

 !
{ 
public 

sealed 
class 
FileController &
:' (
BaseController) 7
{ 
[ 	
HttpPost	 
] 
public 

JsonResult 

UploadFile $
($ %
UploadFileVM% 1
fileVm2 8
)8 9
{ 	
try 
{ 
string 
amazonFileKey $
=% &
$str' )
;) *
foreach 
( 
string 
selectedFile  ,
in- /
Request0 7
.7 8
Files8 =
)= >
{ 
var 
fileContent #
=$ %
Request& -
.- .
Files. 3
[3 4
selectedFile4 @
]@ A
;A B
if 
( 
fileContent #
!=$ &
null' +
&&, .
fileContent/ :
.: ;
ContentLength; H
>I J
$numK L
)L M
{ 
var 
stream "
=# $
fileContent% 0
.0 1
InputStream1 <
;< =
string 
filePath '
=( )
Path* .
.. /
Combine/ 6
(6 7

UploadPath7 A
,A B
fileContentC N
.N O
FileNameO W
)W X
;X Y
using 
( 
var "

fileStream# -
=. /
System0 6
.6 7
IO7 9
.9 :
File: >
.> ?
Create? E
(E F
filePathF N
)N O
)O P
{ 
stream "
." #
CopyTo# )
() *

fileStream* 4
)4 5
;5 6
} 
if!! 
(!! 
!!! 
fileVm!! #
.!!# $
IsValid!!$ +
(!!+ ,
filePath!!, 4
)!!4 5
)!!5 6
{"" 
if## 
(##  
System##  &
.##& '
IO##' )
.##) *
File##* .
.##. /
Exists##/ 5
(##5 6
filePath##6 >
)##> ?
)##? @
System$$  &
.$$& '
IO$$' )
.$$) *
File$$* .
.$$. /
Delete$$/ 5
($$5 6
filePath$$6 >
)$$> ?
;$$? @
throw%% !
new%%" %
AdsException%%& 2
(%%2 3
fileVm%%3 9
.%%9 :
FileType%%: B
+%%C D
$str%%E o
)%%o p
;%%p q
}&& 
if(( 
((( 
fileVm(( "
.((" #
FileType((# +
==((, .
$str((/ <
)((< =
{)) 
string** "
logoFileName**# /
=**0 1

FileHelper**2 <
.**< =
GetValidFileName**= M
(**M N
LoggedInUser**N Z
?**Z [
.**[ \
Id**\ ^
+**_ `
System**a g
.**g h
IO**h j
.**j k
Path**k o
.**o p
GetExtension**p |
(**| }
fileContent	**} à
.
**à â
FileName
**â ë
)
**ë í
)
**í ì
;
**ì î
string++ "
logoFilePath++# /
=++0 1
Path++2 6
.++6 7
Combine++7 >
(++> ?

ImagesPath++? I
,++I J
logoFileName++K W
)++W X
;++X Y
System,, "
.,," #
IO,,# %
.,,% &
File,,& *
.,,* +
Copy,,+ /
(,,/ 0
filePath,,0 8
,,,8 9
logoFilePath,,: F
,,,F G
true,,H L
),,L M
;,,M N
amazonFileKey-- )
=--* +
logoFileName--, 8
;--8 9
}.. 
else// 
if// 
(//  !
string//! '
.//' (
IsNullOrEmpty//( 5
(//5 6
fileVm//6 <
.//< =
OrderNumber//= H
)//H I
)//I J
{00 
amazonFileKey11 )
=11* +
$"11, .
{11. /
DateTime11/ 7
.117 8
Now118 ;
:11; <
yyyyMMddHHmmss11< J
}11J K
_11K L
{11L M
fileContent11M X
.11X Y
FileName11Y a
}11a b
"11b c
;11c d
S3FileManager22 )
.22) *
Upload22* 0
(220 1
amazonFileKey221 >
,22> ?
filePath22@ H
)22H I
;22I J
}33 
else44 
if44 
(44  !
!44! "
string44" (
.44( )
IsNullOrEmpty44) 6
(446 7
fileVm447 =
.44= >
SegmentNumber44> K
)44K L
)44L M
{55 
amazonFileKey66 )
=66* +
$"66, .
{66. /
fileVm66/ 5
.665 6
OrderNumber666 A
}66A B
/66B C
{66C D
fileVm66D J
.66J K
SegmentNumber66K X
}66X Y
	_html.zip66Y b
"66b c
;66c d
S3FileManager77 )
.77) *
Upload77* 0
(770 1
amazonFileKey771 >
,77> ?
filePath77@ H
,77H I
true77J N
,77N O
true77P T
)77T U
;77U V
}88 
else99 
{:: 
switch;; "
(;;# $
fileVm;;$ *
.;;* +
FileType;;+ 3
);;3 4
{<< 
case==  $
$str==% ;
:==; <
amazonFileKey>>$ 1
=>>2 3
string>>4 :
.>>: ;
Format>>; A
(>>A B
$str>>B T
,>>T U
fileVm>>V \
.>>\ ]
OrderNumber>>] h
)>>h i
;>>i j
break??$ )
;??) *
case@@  $
$str@@% 9
:@@9 :
amazonFileKeyAA$ 1
=AA2 3
stringAA4 :
.AA: ;
FormatAA; A
(AAA B
$strAAB R
,AAR S
fileVmAAT Z
.AAZ [
OrderNumberAA[ f
)AAf g
;AAg h
breakBB$ )
;BB) *
caseCC  $
$strCC% :
:CC: ;
amazonFileKeyDD$ 1
=DD2 3
stringDD4 :
.DD: ;
FormatDD; A
(DDA B
$strDDB S
,DDS T
fileVmDDU [
.DD[ \
OrderNumberDD\ g
)DDg h
;DDh i
breakEE$ )
;EE) *
caseFF  $
$strFF% :
:FF: ;
amazonFileKeyGG$ 1
=GG2 3
stringGG4 :
.GG: ;
FormatGG; A
(GGA B
$strGGB S
,GGS T
fileVmGGU [
.GG[ \
OrderNumberGG\ g
)GGg h
;GGh i
breakHH$ )
;HH) *
caseII  $
$strII% 9
:II9 :
amazonFileKeyJJ$ 1
=JJ2 3
stringJJ4 :
.JJ: ;
FormatJJ; A
(JJA B
$strJJB U
,JJU V
fileVmJJW ]
.JJ] ^
OrderNumberJJ^ i
,JJi j
PathJJk o
.JJo p
GetExtensionJJp |
(JJ| }
filePath	JJ} Ö
)
JJÖ Ü
)
JJÜ á
;
JJá à
breakKK$ )
;KK) *
caseLL  $
$strLL% =
:LL= >
amazonFileKeyMM$ 1
=MM2 3
stringMM4 :
.MM: ;
FormatMM; A
(MMA B
$strMMB Z
,MMZ [
fileVmMM\ b
.MMb c
OrderNumberMMc n
,MMn o
PathMMp t
.MMt u
GetExtension	MMu Å
(
MMÅ Ç
filePath
MMÇ ä
)
MMä ã
)
MMã å
;
MMå ç
breakNN$ )
;NN) *
caseOO  $
$strOO% 6
:OO6 7
amazonFileKeyPP$ 1
=PP2 3
stringPP4 :
.PP: ;
FormatPP; A
(PPA B
$strPPB S
,PPS T
fileVmPPU [
.PP[ \
OrderNumberPP\ g
,PPg h
PathPPi m
.PPm n
GetExtensionPPn z
(PPz {
filePath	PP{ É
)
PPÉ Ñ
)
PPÑ Ö
;
PPÖ Ü
breakQQ$ )
;QQ) *
}RR 
S3FileManagerSS )
.SS) *
UploadSS* 0
(SS0 1
amazonFileKeySS1 >
,SS> ?
filePathSS@ H
,SSH I
trueSSJ N
,SSN O
trueSSP T
)SST U
;SSU V
}TT 
ifWW 
(WW 
SystemWW "
.WW" #
IOWW# %
.WW% &
FileWW& *
.WW* +
ExistsWW+ 1
(WW1 2
filePathWW2 :
)WW: ;
)WW; <
SystemXX "
.XX" #
IOXX# %
.XX% &
FileXX& *
.XX* +
DeleteXX+ 1
(XX1 2
filePathXX2 :
)XX: ;
;XX; <
}YY 
}ZZ 
return\\ 
Json\\ 
(\\ 
new\\ 
JsonResponse\\  ,
(\\, -
)\\- .
{\\/ 0
IsSucess\\1 9
=\\: ;
true\\< @
,\\@ A
Result\\B H
=\\I J
amazonFileKey\\K X
}\\Y Z
)\\Z [
;\\[ \
}]] 
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^  
{__ 
return`` 
Json`` 
(`` 
new`` 
JsonResponse``  ,
(``, -
)``- .
{``/ 0
IsSucess``1 9
=``: ;
false``< A
,``A B
ErrorMessage``C O
=``P Q
$str``R b
+``c d
ex``e g
.``g h
Message``h o
}``p q
)``q r
;``r s
}aa 
}bb 	
[dd 	
HttpGetdd	 
]dd 
publicee 
ActionResultee 
DownloadFileee (
(ee( )
UploadFileVMee) 5
fileVmee6 <
)ee< =
{ff 	
stringgg 
filePathgg 
=gg 
Pathgg "
.gg" #
Combinegg# *
(gg* +

UploadPathgg+ 5
,gg5 6
fileVmgg7 =
.gg= >
FileNamegg> F
)ggF G
;ggG H
ifhh 
(hh 
fileVmhh 
.hh 
FileTypehh 
==hh  "
$strhh# 0
)hh0 1
{ii 
filePathjj 
=jj 
Pathjj 
.jj  
Combinejj  '
(jj' (

ImagesPathjj( 2
,jj2 3
fileVmjj4 :
.jj: ;
FileNamejj; C
)jjC D
;jjD E
}kk 
elsell 
{mm 
S3FileManagernn 
.nn 
Downloadnn &
(nn& '
fileVmnn' -
.nn- .
FileNamenn. 6
,nn6 7
filePathnn8 @
)nn@ A
;nnA B
}oo 
returnpp 
Filepp 
(pp 
filePathpp  
,pp  !
$strpp" ,
,pp, -
fileVmpp. 4
.pp4 5
FileNamepp5 =
)pp= >
;pp> ?
}qq 	
[ss 	
HttpPostss	 
]ss 
publictt 

JsonResulttt 

DeleteFilett $
(tt$ %
UploadFileVMtt% 1
fileVmtt2 8
)tt8 9
{uu 	
tryvv 
{ww 
ifxx 
(xx 
fileVmxx 
.xx 
FileTypexx #
==xx$ &
$strxx' 4
)xx4 5
{yy 
stringzz 
filePathzz #
=zz$ %
Pathzz& *
.zz* +
Combinezz+ 2
(zz2 3

ImagesPathzz3 =
,zz= >
fileVmzz? E
.zzE F
FileNamezzF N
)zzN O
;zzO P
if{{ 
({{ 
System{{ 
.{{ 
IO{{ !
.{{! "
File{{" &
.{{& '
Exists{{' -
({{- .
filePath{{. 6
){{6 7
){{7 8
System|| 
.|| 
IO|| !
.||! "
File||" &
.||& '
Delete||' -
(||- .
filePath||. 6
)||6 7
;||7 8
}}} 
else~~ 
{ 
S3FileManager
ÄÄ !
.
ÄÄ! "
Delete
ÄÄ" (
(
ÄÄ( )
fileVm
ÄÄ) /
.
ÄÄ/ 0
FileName
ÄÄ0 8
)
ÄÄ8 9
;
ÄÄ9 :
}
ÅÅ 
return
ÇÇ 
Json
ÇÇ 
(
ÇÇ 
new
ÇÇ 
JsonResponse
ÇÇ  ,
(
ÇÇ, -
)
ÇÇ- .
{
ÇÇ/ 0
IsSucess
ÇÇ0 8
=
ÇÇ9 :
true
ÇÇ; ?
}
ÇÇ? @
)
ÇÇ@ A
;
ÇÇA B
}
ÉÉ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÖÖ 
return
ÜÜ 
Json
ÜÜ 
(
ÜÜ 
new
ÜÜ 
JsonResponse
ÜÜ  ,
(
ÜÜ, -
)
ÜÜ- .
{
ÜÜ/ 0
IsSucess
ÜÜ0 8
=
ÜÜ9 :
false
ÜÜ; @
,
ÜÜ@ A
ErrorMessage
ÜÜB N
=
ÜÜO P
$str
ÜÜQ g
+
ÜÜh i
ex
ÜÜj l
.
ÜÜl m
Message
ÜÜm t
}
ÜÜu v
)
ÜÜv w
;
ÜÜw x
}
áá 
}
àà 	
}
ââ 
}ää €4
GE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\HomeController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
HomeController 
:  !
BaseController" 0
{ 
public 
ActionResult 
Index !
(! "
)" #
{ 	
return 
RedirectToAction #
(# $
$str$ +
,+ ,
$str- 8
)8 9
;9 :
} 	
public 
ActionResult 
Settings $
($ %
)% &
{ 	
UserProfileVM 
profile !
=" #
null$ (
;( )
if 
( 
LoggedInUser 
== 
null  $
)$ %
return& ,
View- 1
(1 2
$str2 <
,< =
(> ?
UserProfileVM? L
)L M
nullN R
)R S
;S T
if 
( 
string 
. 
IsNullOrEmpty $
($ %
LoggedInUser% 1
?1 2
.2 3
ApiKey3 9
)9 :
): ;
{   
var!! 
user!! 
=!! 
Db!! 
.!! 
Users!! #
.!!# $
FirstOrDefault!!$ 2
(!!2 3
x!!3 4
=>!!5 7
x!!8 9
.!!9 :
Id!!: <
==!!= ?
LoggedInUser!!@ L
.!!L M
Id!!M O
)!!O P
;!!P Q
if"" 
("" 
user"" 
!="" 
null""  
)""  !
user""" &
.""& '
ApiKey""' -
="". /
KeyGenerator""0 <
.""< =
GetUniqueKey""= I
(""I J
$num""J L
)""L M
;""M N
Db## 
.## 
SaveChanges## 
(## 
)##  
;##  !
SetupLoggedInUser$$ !
($$! "
LoggedInUser$$" .
.$$. /
UserName$$/ 7
)$$7 8
;$$8 9
}%% 
profile'' 
='' 
new'' 
UserProfileVM'' '
(''' (
)''( )
{(( 
UserName)) 
=)) 
LoggedInUser)) '
.))' (
UserName))( 0
,))0 1
	FirstName** 
=** 
LoggedInUser** (
.**( )
	FirstName**) 2
,**2 3
LastName++ 
=++ 
LoggedInUser++ '
.++' (
LastName++( 0
,++0 1
Email,, 
=,, 
LoggedInUser,, $
.,,$ %
Email,,% *
,,,* +
CompanyName-- 
=-- 
LoggedInUser-- *
.--* +
CompanyName--+ 6
,--6 7

WhiteLabel.. 
=.. 
LoggedInUser.. )
...) *

WhiteLabel..* 4
,..4 5
CompanyLogo// 
=// 
LoggedInUser// *
.//* +
CompanyLogo//+ 6
,//6 7
ReportTemplate00 
=00  
LoggedInUser00! -
.00- .
ReportTemplate00. <
,00< =
	IsUsesApi11 
=11 
LoggedInUser11 (
.11( )
	IsUsesApi11) 2
,112 3
ApiKey22 
=22 
LoggedInUser22 %
.22% &
ApiKey22& ,
,22, -
}33 
;33 
ViewBag55 
.55 
ReportTemplate55 "
=55# $
new55% (

SelectList55) 3
(553 4
ReportTemplates554 C
,55C D
$str55E L
,55L M
$str55N T
,55T U
profile55V ]
.55] ^
ReportTemplate55^ l
)55l m
;55m n
return77 
View77 
(77 
$str77 "
,77" #
profile77$ +
)77+ ,
;77, -
}88 	
[:: 	
HttpPost::	 
]:: 
public;; 
ActionResult;; 
Settings;; $
(;;$ %
UserProfileVM;;% 2
profile;;3 :
);;: ;
{<< 	
var== 
user== 
=== 
Db== 
.== 
Users== 
.==  
FirstOrDefault==  .
(==. /
x==/ 0
=>==1 3
x==4 5
.==5 6
Id==6 8
====9 ;
LoggedInUser==< H
.==H I
Id==I K
)==K L
;==L M
if>> 
(>> 
user>> 
==>> 
null>> 
)>> 
return>> $
View>>% )
(>>) *
$str>>* 1
)>>1 2
;>>2 3
user@@ 
.@@ 
	FirstName@@ 
=@@ 
profile@@ $
.@@$ %
	FirstName@@% .
;@@. /
userAA 
.AA 
LastNameAA 
=AA 
profileAA #
.AA# $
LastNameAA$ ,
;AA, -
userBB 
.BB 
EmailBB 
=BB 
profileBB  
.BB  !
EmailBB! &
;BB& '
userCC 
.CC 
CompanyNameCC 
=CC 
profileCC &
.CC& '
CompanyNameCC' 2
;CC2 3
userDD 
.DD 

WhiteLabelDD 
=DD 
profileDD %
.DD% &

WhiteLabelDD& 0
;DD0 1
userEE 
.EE 
CompanyLogoEE 
=EE 
profileEE &
.EE& '
CompanyLogoEE' 2
;EE2 3
userFF 
.FF 
ReportTemplateFF 
=FF  !
profileFF" )
.FF) *
ReportTemplateFF* 8
;FF8 9
DbGG 
.GG 
SaveChangesGG 
(GG 
)GG 
;GG 
SetupLoggedInUserII 
(II 
LoggedInUserII *
.II* +
UserNameII+ 3
)II3 4
;II4 5
ViewBagKK 
.KK 
ReportTemplateKK "
=KK# $
newKK% (

SelectListKK) 3
(KK3 4
ReportTemplatesKK4 C
,KKC D
$strKKE L
,KKL M
$strKKM S
,KKS T
profileKKU \
.KK\ ]
ReportTemplateKK] k
)KKk l
;KKl m
TempDataLL 
[LL 
$strLL 
]LL 
=LL  !
$strLL" I
;LLI J
returnMM 
RedirectToActionMM #
(MM# $
$strMM$ .
)MM. /
;MM/ 0
}NN 	
}RR 
}SS „¿
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\CreativeController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
CreativeController #
:$ %
BaseController& 4
{ 
public 
ActionResult 
Index !
(! "
Guid" &
id' )
)) *
{ 	
var 
campaign 
= 
Db 
. 
	Campaigns '
. 
Include 
( 
c 
=> 
c 
.  
Assets  &
)& '
. 
Include 
( 
c 
=> 
c 
.  
Testing  '
)' (
. 
Include 
( 
c 
=> 
c 
.  
Approved  (
)( )
. 
Include 
( 
c 
=> 
c 
.  
Creative  (
)( )
.   
FirstOrDefault   
(    
c    !
=>  " $
c  % &
.  & '
Id  ' )
==  * ,
id  - /
)  / 0
;  0 1
Session"" 
["" 
$str"" 
]"" 
="" 
id"" 
;"" 
Session## 
[## 
$str## !
]##! "
=### $
campaign##% -
.##- .
OrderNumber##. 9
;##9 :
var%% 
creative%% 
=%% 
new%% 

CreativeVM%% )
(%%) *
)%%* +
{&& 

CampaignId'' 
='' 
campaign'' %
.''% &
Id''& (
.''( )
ToString'') 1
(''1 2
)''2 3
,''3 4
OrderNumber(( 
=(( 
campaign(( &
.((& '
OrderNumber((' 2
,((2 3
CampaignName)) 
=)) 
campaign)) '
.))' (
Testing))( /
.))/ 0
CampaignName))0 <
,))< =
FromLine** 
=** 
campaign** #
.**# $
Testing**$ +
.**+ ,
FromLine**, 4
,**4 5
SubjectLine++ 
=++ 
campaign++ &
.++& '
Testing++' .
.++. /
SubjectLine++/ :
,++: ;
TestSeedFile,, 
=,, 
campaign,, '
.,,' (
Assets,,( .
.,,. /
TestSeedFile,,/ ;
,,,; <
LiveSeedFile-- 
=-- 
campaign-- '
.--' (
Assets--( .
.--. /
LiveSeedFile--/ ;
,--; <
	Creatives.. 
=.. 
campaign.. $
...$ %
Creative..% -
?..- .
.... /
CreativeHtml../ ;
,..; <

TestEmails// 
=// 
new//  
List//! %
<//% &
SelectItemPair//& 4
>//4 5
(//5 6
)//6 7
,//7 8

LiveEmails00 
=00 
new00  
List00! %
<00% &
SelectItemPair00& 4
>004 5
(005 6
)006 7
}11 
;11 
if33 
(33 
!33 
string33 
.33 
IsNullOrEmpty33 %
(33% &
campaign33& .
.33. /
Assets33/ 5
.335 6
TestSeedFile336 B
)33B C
)33C D
{44 
string55 
filePath55 
=55  !
Path55" &
.55& '
Combine55' .
(55. /

UploadPath55/ 9
,559 :
campaign55; C
.55C D
Assets55D J
.55J K
TestSeedFile55K W
)55W X
;55X Y
if66 
(66 
!66 
System66 
.66 
IO66 
.66 
File66 "
.66" #
Exists66# )
(66) *
filePath66* 2
)662 3
&&664 6
!667 8
string668 >
.66> ?
IsNullOrEmpty66? L
(66L M
campaign66M U
.66U V
Assets66V \
.66\ ]
TestSeedFile66] i
)66i j
)66j k
S3FileManager77 !
.77! "
Download77" *
(77* +
campaign77+ 3
.773 4
Assets774 :
.77: ;
TestSeedFile77; G
,77G H
filePath77I Q
)77Q R
;77R S
creative88 
.88 

TestEmails88 #
=88$ %
CreativeUtility88& 5
.885 6

ReadEmails886 @
(88@ A
filePath88A I
)88I J
;88J K
}99 
if;; 
(;; 
!;; 
string;; 
.;; 
IsNullOrEmpty;; %
(;;% &
campaign;;& .
.;;. /
Assets;;/ 5
.;;5 6
LiveSeedFile;;6 B
);;B C
);;C D
{<< 
string== 
filePathLive== #
===$ %
Path==& *
.==* +
Combine==+ 2
(==2 3

UploadPath==3 =
,=== >
campaign==? G
.==G H
Assets==H N
.==N O
LiveSeedFile==O [
)==[ \
;==\ ]
if>> 
(>> 
!>> 
System>> 
.>> 
IO>> 
.>> 
File>> #
.>># $
Exists>>$ *
(>>* +
filePathLive>>+ 7
)>>7 8
&&>>9 ;
!>>< =
string>>= C
.>>C D
IsNullOrEmpty>>D Q
(>>Q R
campaign>>R Z
.>>Z [
Assets>>[ a
.>>a b
LiveSeedFile>>b n
)>>n o
)>>o p
S3FileManager?? !
.??! "
Download??" *
(??* +
campaign??+ 3
.??3 4
Assets??4 :
.??: ;
LiveSeedFile??; G
,??G H
filePathLive??I U
)??U V
;??V W
creative@@ 
.@@ 

LiveEmails@@ #
=@@$ %
CreativeUtility@@& 5
.@@5 6

ReadEmails@@6 @
(@@@ A
filePathLive@@A M
)@@M N
;@@N O
}AA 
SessionCC 
[CC 
$strCC "
]CC" #
=CC$ %
campaignCC& .
.CC. /
AssetsCC/ 5
.CC5 6
TestSeedFileCC6 B
;CCB C
SessionDD 
[DD 
$strDD !
]DD! "
=DD# $
campaignDD% -
.DD- .
AssetsDD. 4
.DD4 5
TestSeedUrlDD5 @
;DD@ A
SessionEE 
[EE 
$strEE "
]EE" #
=EE$ %
campaignEE& .
.EE. /
AssetsEE/ 5
.EE5 6
LiveSeedFileEE6 B
;EEB C
SessionFF 
[FF 
$strFF !
]FF! "
=FF# $
campaignFF% -
.FF- .
AssetsFF. 4
.FF4 5
LiveSeedUrlFF5 @
;FF@ A
returnGG 
ViewGG 
(GG 
creativeGG  
)GG  !
;GG! "
}HH 	
[JJ 	
HttpPostJJ	 
]JJ 
[KK 	
ValidateInputKK	 
(KK 
falseKK 
)KK 
]KK 
[LL 	
MultipleButtonLL	 
(LL 
NameLL 
=LL 
$strLL '
,LL' (
ArgumentLL) 1
=LL2 3
$strLL4 :
)LL: ;
]LL; <
publicMM 
ActionResultMM 
SaveMM  
(MM  !

CreativeVMMM! +
modelMM, 1
)MM1 2
{NN 	
tryOO 
{PP 
varQQ 
alreayQQ 
=QQ 
DbQQ 
.QQ  
CampaignCreativesQQ  1
.QQ1 2
FirstOrDefaultQQ2 @
(QQ@ A
xQQA B
=>QQC E
xQQF G
.QQG H

CampaignIdQQH R
.QQR S
ToStringQQS [
(QQ[ \
)QQ\ ]
==QQ^ `
modelQQa f
.QQf g

CampaignIdQQg q
)QQq r
;QQr s
ifRR 
(RR 
alreayRR 
==RR 
nullRR "
)RR" #
{SS 
varTT 

creativeIdTT "
=TT# $
GuidTT% )
.TT) *
NewGuidTT* 1
(TT1 2
)TT2 3
;TT3 4
alreayUU 
=UU 
newUU  
CampaignCreativeUU! 1
(UU1 2
)UU2 3
{VV 
IdWW 
=WW 

creativeIdWW '
,WW' (
	CreatedAtXX !
=XX" #
DateTimeXX$ ,
.XX, -
NowXX- 0
,XX0 1

CampaignIdYY "
=YY# $
GuidYY% )
.YY) *
ParseYY* /
(YY/ 0
modelYY0 5
.YY5 6

CampaignIdYY6 @
)YY@ A
,YYA B
CreativeHtmlZZ $
=ZZ% &
modelZZ' ,
.ZZ, -
	CreativesZZ- 6
}[[ 
;[[ 
Db\\ 
.\\ 
CampaignCreatives\\ (
.\\( )
Add\\) ,
(\\, -
alreay\\- 3
)\\3 4
;\\4 5
var]] 
campaign]]  
=]]! "
Db]]# %
.]]% &
	Campaigns]]& /
.]]/ 0
FirstOrDefault]]0 >
(]]> ?
c]]? @
=>]]A C
c]]D E
.]]E F
Id]]F H
.]]H I
ToString]]I Q
(]]Q R
)]]R S
==]]T V
model]]W \
.]]\ ]

CampaignId]]] g
)]]g h
;]]h i
campaign^^ 
.^^ 

CreativeId^^ '
=^^( )

creativeId^^* 4
;^^4 5
}__ 
else`` 
{aa 
alreaybb 
.bb 
CreativeHtmlbb '
=bb( )
modelbb* /
.bb/ 0
	Creativesbb0 9
;bb9 :
}cc 
Dbdd 
.dd 
SaveChangesdd 
(dd 
)dd  
;dd  !
TempDataee 
[ee 
$stree "
]ee" #
=ee$ %
$stree& N
;eeN O
}ff 
catchgg 
(gg 
	Exceptiongg 
exgg 
)gg  
{hh 
TempDataii 
[ii 
$strii  
]ii  !
=ii" #
$strii$ D
+iiE F
stringiiG M
.iiM N
JoiniiN R
(iiR S
$striiS Z
,iiZ [
exii\ ^
.ii^ _
Messageii_ f
)iif g
;iig h
}jj 
returnkk 
RedirectToActionkk #
(kk# $
$strkk$ +
,kk+ ,
newkk- 0
{kk1 2
idkk3 5
=kk6 7
modelkk8 =
.kk= >

CampaignIdkk> H
}kkI J
)kkJ K
;kkK L
}ll 	
publicnn 
ActionResultnn 
	AddToListnn %
(nn% &
stringnn& ,
listnn- 1
,nn1 2
stringnn3 9
emailnn: ?
)nn? @
{oo 	
trypp 
{qq 
switchrr 
(rr 
listrr 
)rr 
{ss 
casett 
$strtt 
:tt  
stringuu 
filePathuu '
=uu( )
Pathuu* .
.uu. /
Combineuu/ 6
(uu6 7

UploadPathuu7 A
,uuA B
(uuC D
stringuuD J
)uuJ K
SessionuuK R
[uuR S
$struuS a
]uua b
)uub c
;uuc d
newvv 
CreativeUtilityvv +
(vv+ ,
)vv, -
.vv- .
Addvv. 1
(vv1 2
filePathvv2 :
,vv: ;
emailvv< A
)vvA B
;vvB C
S3FileManagerww %
.ww% &
Uploadww& ,
(ww, -
(ww- .
stringww. 4
)ww4 5
Sessionww5 <
[ww< =
$strww= J
]wwJ K
,wwK L
filePathwwM U
,wwU V
truewwW [
)ww[ \
;ww\ ]
breakxx 
;xx 
caseyy 
$stryy 
:yy  
stringzz 
filePathLivezz +
=zz, -
Pathzz. 2
.zz2 3
Combinezz3 :
(zz: ;

UploadPathzz; E
,zzE F
(zzG H
stringzzH N
)zzN O
SessionzzO V
[zzV W
$strzzW f
]zzf g
)zzg h
;zzh i
new{{ 
CreativeUtility{{ +
({{+ ,
){{, -
.{{- .
Add{{. 1
({{1 2
filePathLive{{2 >
,{{> ?
email{{@ E
){{E F
;{{F G
S3FileManager|| %
.||% &
Upload||& ,
(||, -
(||- .
string||. 4
)||4 5
Session||5 <
[||< =
$str||= J
]||J K
,||K L
filePathLive||M Y
,||Y Z
true||[ _
)||_ `
;||` a
break}} 
;}} 
}~~ 
return 
Json 
( 
new 
JsonResponse  ,
(, -
)- .
{/ 0
IsSucess0 8
=9 :
true; ?
}? @
)@ A
;A B
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÇÇ 
return
ÉÉ 
Json
ÉÉ 
(
ÉÉ 
new
ÉÉ 
JsonResponse
ÉÉ  ,
(
ÉÉ, -
)
ÉÉ- .
{
ÉÉ/ 0
IsSucess
ÉÉ0 8
=
ÉÉ9 :
false
ÉÉ; @
,
ÉÉ@ A
ErrorMessage
ÉÉB N
=
ÉÉO P
ex
ÉÉQ S
.
ÉÉS T
Message
ÉÉT [
}
ÉÉ[ \
)
ÉÉ\ ]
;
ÉÉ] ^
}
ÑÑ 
}
ÖÖ 	
public
áá 
ActionResult
áá 
DeleteFromList
áá *
(
áá* +
string
áá+ 1
list
áá2 6
,
áá6 7
string
áá8 >
email
áá? D
)
ááD E
{
àà 	
try
ââ 
{
ää 
switch
ãã 
(
ãã 
list
ãã 
)
ãã 
{
åå 
case
çç 
$str
çç 
:
çç  
string
éé 
filePath
éé '
=
éé( )
Path
éé* .
.
éé. /
Combine
éé/ 6
(
éé6 7

UploadPath
éé7 A
,
ééA B
(
ééC D
string
ééD J
)
ééJ K
Session
ééK R
[
ééR S
$str
ééS a
]
ééa b
)
ééb c
;
ééc d
new
èè 
CreativeUtility
èè +
(
èè+ ,
)
èè, -
.
èè- .
Remove
èè. 4
(
èè4 5
filePath
èè5 =
,
èè= >
email
èè? D
)
èèD E
;
èèE F
S3FileManager
êê %
.
êê% &
Upload
êê& ,
(
êê, -
(
êê- .
string
êê. 4
)
êê4 5
Session
êê5 <
[
êê< =
$str
êê= J
]
êêJ K
,
êêK L
filePath
êêM U
,
êêU V
true
êêW [
)
êê[ \
;
êê\ ]
break
ëë 
;
ëë 
case
íí 
$str
íí 
:
íí  
string
ìì 
filePathLive
ìì +
=
ìì, -
Path
ìì. 2
.
ìì2 3
Combine
ìì3 :
(
ìì: ;

UploadPath
ìì; E
,
ììE F
(
ììG H
string
ììH N
)
ììN O
Session
ììO V
[
ììV W
$str
ììW f
]
ììf g
)
ììg h
;
ììh i
new
îî 
CreativeUtility
îî +
(
îî+ ,
)
îî, -
.
îî- .
Remove
îî. 4
(
îî4 5
filePathLive
îî5 A
,
îîA B
email
îîC H
)
îîH I
;
îîI J
S3FileManager
ïï %
.
ïï% &
Upload
ïï& ,
(
ïï, -
(
ïï- .
string
ïï. 4
)
ïï4 5
Session
ïï5 <
[
ïï< =
$str
ïï= J
]
ïïJ K
,
ïïK L
filePathLive
ïïM Y
,
ïïY Z
true
ïï[ _
)
ïï_ `
;
ïï` a
break
ññ 
;
ññ 
}
óó 
return
òò 
Json
òò 
(
òò 
new
òò 
JsonResponse
òò  ,
(
òò, -
)
òò- .
{
òò/ 0
IsSucess
òò1 9
=
òò: ;
true
òò< @
}
òòA B
)
òòB C
;
òòC D
}
ôô 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
õõ 
return
úú 
Json
úú 
(
úú 
new
úú 
JsonResponse
úú  ,
(
úú, -
)
úú- .
{
úú/ 0
IsSucess
úú1 9
=
úú: ;
false
úú< A
,
úúA B
ErrorMessage
úúC O
=
úúP Q
ex
úúR T
.
úúT U
Message
úúU \
}
úú] ^
)
úú^ _
;
úú_ `
}
ùù 
}
ûû 	
[
†† 	
HttpPost
††	 
]
†† 
[
°° 	
ValidateInput
°°	 
(
°° 
false
°° 
)
°° 
]
°° 
[
¢¢ 	
MultipleButton
¢¢	 
(
¢¢ 
Name
¢¢ 
=
¢¢ 
$str
¢¢ '
,
¢¢' (
Argument
¢¢) 1
=
¢¢2 3
$str
¢¢4 >
)
¢¢> ?
]
¢¢? @
public
££ 
ActionResult
££ 
TestSend
££ $
(
££$ %

CreativeVM
££% /
model
££0 5
)
££5 6
{
§§ 	
try
•• 
{
¶¶ 
string
ßß 
filePath
ßß 
=
ßß  !
Path
ßß" &
.
ßß& '
Combine
ßß' .
(
ßß. /

UploadPath
ßß/ 9
,
ßß9 :
(
ßß; <
string
ßß< B
)
ßßB C
Session
ßßC J
[
ßßJ K
$str
ßßK Y
]
ßßY Z
)
ßßZ [
;
ßß[ \
string
®® 
filePathLive
®® #
=
®®$ %
Path
®®& *
.
®®* +
Combine
®®+ 2
(
®®2 3

UploadPath
®®3 =
,
®®= >
(
®®? @
string
®®@ F
)
®®F G
Session
®®G N
[
®®N O
$str
®®O ^
]
®®^ _
)
®®_ `
;
®®` a
model
©© 
.
©© 

TestEmails
©©  
=
©©! "
CreativeUtility
©©# 2
.
©©2 3

ReadEmails
©©3 =
(
©©= >
filePath
©©> F
)
©©F G
;
©©G H
model
™™ 
.
™™ 

LiveEmails
™™  
=
™™! "
CreativeUtility
™™# 2
.
™™2 3

ReadEmails
™™3 =
(
™™= >
filePathLive
™™> J
)
™™J K
;
™™K L
BackgroundJob
¨¨ 
.
¨¨ 
Enqueue
¨¨ %
(
¨¨% &
(
¨¨& '
)
¨¨' (
=>
¨¨) + 
MailChimpProcessor
¨¨, >
.
¨¨> ?
TestSend
¨¨? G
(
¨¨G H
model
¨¨H M
)
¨¨M N
)
¨¨N O
;
¨¨O P
TempData
≠≠ 
[
≠≠ 
$str
≠≠ "
]
≠≠" #
=
≠≠$ %
$str
≠≠& X
;
≠≠X Y
}
ÆÆ 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
∞∞ 
TempData
±± 
[
±± 
$str
±±  
]
±±  !
=
±±" #
$str
±±$ D
+
±±E F
string
±±G M
.
±±M N
Join
±±N R
(
±±R S
$str
±±S Z
,
±±Z [
ex
±±\ ^
.
±±^ _
Message
±±_ f
)
±±f g
;
±±g h
}
≤≤ 
return
≥≥ 
RedirectToAction
≥≥ #
(
≥≥# $
$str
≥≥$ +
,
≥≥+ ,
new
≥≥- 0
{
≥≥1 2
id
≥≥2 4
=
≥≥4 5
model
≥≥6 ;
.
≥≥; <

CampaignId
≥≥< F
}
≥≥F G
)
≥≥G H
;
≥≥H I
}
¥¥ 	
[
∂∂ 	
HttpPost
∂∂	 
]
∂∂ 
[
∑∑ 	
ValidateInput
∑∑	 
(
∑∑ 
false
∑∑ 
)
∑∑ 
]
∑∑ 
[
∏∏ 	
MultipleButton
∏∏	 
(
∏∏ 
Name
∏∏ 
=
∏∏ 
$str
∏∏ '
,
∏∏' (
Argument
∏∏) 1
=
∏∏2 3
$str
∏∏4 C
)
∏∏C D
]
∏∏D E
public
ππ 
ActionResult
ππ 
QuickTestSend
ππ )
(
ππ) *

CreativeVM
ππ* 4
model
ππ5 :
)
ππ: ;
{
∫∫ 	
try
ªª 
{
ºº  
MailChimpProcessor
ΩΩ "
.
ΩΩ" #
QucikTestSend
ΩΩ# 0
(
ΩΩ0 1
model
ΩΩ1 6
)
ΩΩ6 7
;
ΩΩ7 8
TempData
ææ 
[
ææ 
$str
ææ "
]
ææ" #
=
ææ$ %
$str
ææ& N
;
ææN O
}
øø 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
¡¡ 
TempData
¬¬ 
[
¬¬ 
$str
¬¬  
]
¬¬  !
=
¬¬" #
$str
¬¬$ D
+
¬¬E F
string
¬¬G M
.
¬¬M N
Join
¬¬N R
(
¬¬R S
$str
¬¬S Z
,
¬¬Z [
ex
¬¬\ ^
.
¬¬^ _
Message
¬¬_ f
)
¬¬f g
;
¬¬g h
}
√√ 
return
ƒƒ 
RedirectToAction
ƒƒ #
(
ƒƒ# $
$str
ƒƒ$ +
,
ƒƒ+ ,
new
ƒƒ- 0
{
ƒƒ1 2
id
ƒƒ3 5
=
ƒƒ6 7
model
ƒƒ8 =
.
ƒƒ= >

CampaignId
ƒƒ> H
}
ƒƒI J
)
ƒƒJ K
;
ƒƒK L
}
≈≈ 	
public
«« 

JsonResult
«« !
RefreshMailChimpLog
«« -
(
««- .
string
««. 4
OrderNumber
««5 @
)
««@ A
{
»» 	
try
…… 
{
   
if
ÀÀ 
(
ÀÀ 
OrderNumber
ÀÀ 
==
ÀÀ  "
null
ÀÀ# '
)
ÀÀ' (
{
ÃÃ 
throw
ÕÕ 
new
ÕÕ 
AdsException
ÕÕ *
(
ÕÕ* +
$str
ÕÕ+ A
)
ÕÕA B
;
ÕÕB C
}
ŒŒ 
var
–– 
messages
–– 
=
–– 
Db
–– !
.
––! "

SystemLogs
––" ,
.
––, -
Where
––- 2
(
––2 3
x
––3 4
=>
––5 7
x
––8 9
.
––9 :
OrderNumber
––: E
==
––F H
OrderNumber
––I T
&&
––U W
x
––X Y
.
––Y Z
LogType
––Z a
==
––b d
(
––e f
int
––f i
)
––i j
LogType
––j q
.
––q r
	MailChimp
––r {
)
––{ |
.
—— 
OrderByDescending
—— &
(
——& '
x
——' (
=>
——) +
x
——, -
.
——- .
	CreatedAt
——. 7
)
——7 8
.
““ 
Select
““ 
(
““ 
x
““ 
=>
““  
new
““! $
{
““% &
	CreatedAt
““' 0
=
““1 2
x
““3 4
.
““4 5
	CreatedAt
““5 >
.
““> ?
ToString
““? G
(
““G H
)
““H I
,
““I J
Message
““K R
=
““S T
x
““U V
.
““V W
Message
““W ^
}
““_ `
)
““` a
.
”” 
ToList
”” 
(
”” 
)
”” 
;
”” 
return
’’ 
Json
’’ 
(
’’ 
new
’’ 
JsonResponse
’’  ,
(
’’, -
)
’’- .
{
’’/ 0
IsSucess
’’1 9
=
’’: ;
true
’’< @
,
’’@ A
Result
’’B H
=
’’I J
messages
’’K S
}
’’T U
)
’’U V
;
’’V W
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 
return
ŸŸ 
Json
ŸŸ 
(
ŸŸ 
new
ŸŸ 
JsonResponse
ŸŸ  ,
(
ŸŸ, -
)
ŸŸ- .
{
ŸŸ/ 0
IsSucess
ŸŸ1 9
=
ŸŸ: ;
false
ŸŸ< A
,
ŸŸA B
ErrorMessage
ŸŸC O
=
ŸŸP Q
ex
ŸŸR T
.
ŸŸT U
Message
ŸŸU \
}
ŸŸ] ^
)
ŸŸ^ _
;
ŸŸ_ `
}
⁄⁄ 
}
€€ 	
}
‹‹ 
}›› Âé
IE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\ManageController.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Controllers

 !
{ 
public 

class 
ManageController !
:" #

Controller$ .
{ 
private $
ApplicationSignInManager (
_signInManager) 7
;7 8
private "
ApplicationUserManager &
_userManager' 3
;3 4
public 
ManageController 
(  
)  !
{ 	
} 	
public 
ManageController 
(  "
ApplicationUserManager  6
userManager7 B
,B C$
ApplicationSignInManagerD \
signInManager] j
)j k
{ 	
UserManager 
= 
userManager %
;% &
SignInManager 
= 
signInManager )
;) *
} 	
public $
ApplicationSignInManager '
SignInManager( 5
{ 	
get 
{ 
return   
_signInManager   %
??  & (
HttpContext  ) 4
.  4 5
GetOwinContext  5 C
(  C D
)  D E
.  E F
Get  F I
<  I J$
ApplicationSignInManager  J b
>  b c
(  c d
)  d e
;  e f
}!! 
private"" 
set"" 
{## 
_signInManager$$ 
=$$  
value$$! &
;$$& '
}%% 
}&& 	
public(( "
ApplicationUserManager(( %
UserManager((& 1
{)) 	
get** 
{++ 
return,, 
_userManager,, #
??,,$ &
HttpContext,,' 2
.,,2 3
GetOwinContext,,3 A
(,,A B
),,B C
.,,C D
GetUserManager,,D R
<,,R S"
ApplicationUserManager,,S i
>,,i j
(,,j k
),,k l
;,,l m
}-- 
private.. 
set.. 
{// 
_userManager00 
=00 
value00 $
;00$ %
}11 
}22 	
public66 
async66 
Task66 
<66 
ActionResult66 &
>66& '
Index66( -
(66- .
ManageMessageId66. =
?66= >
message66? F
)66F G
{77 	
ViewBag88 
.88 
StatusMessage88 !
=88" #
message99 
==99 
ManageMessageId99 *
.99* +!
ChangePasswordSuccess99+ @
?99A B
$str99C d
::: 
message:: 
==:: 
ManageMessageId:: ,
.::, -
SetPasswordSuccess::- ?
?::@ A
$str::B _
:;; 
message;; 
==;; 
ManageMessageId;; ,
.;;, -
SetTwoFactorSuccess;;- @
?;;A B
$str;;C z
:<< 
message<< 
==<< 
ManageMessageId<< ,
.<<, -
Error<<- 2
?<<3 4
$str<<5 M
:== 
message== 
==== 
ManageMessageId== ,
.==, -
AddPhoneSuccess==- <
?=== >
$str==? ]
:>> 
message>> 
==>> 
ManageMessageId>> ,
.>>, -
RemovePhoneSuccess>>- ?
?>>@ A
$str>>B b
:?? 
$str?? 
;?? 
varAA 
userIdAA 
=AA 
UserAA 
.AA 
IdentityAA &
.AA& '
	GetUserIdAA' 0
(AA0 1
)AA1 2
;AA2 3
varBB 
modelBB 
=BB 
newBB 
IndexViewModelBB *
{CC 
HasPasswordDD 
=DD 
HasPasswordDD )
(DD) *
)DD* +
,DD+ ,
PhoneNumberEE 
=EE 
awaitEE #
UserManagerEE$ /
.EE/ 0
GetPhoneNumberAsyncEE0 C
(EEC D
userIdEED J
)EEJ K
,EEK L
	TwoFactorFF 
=FF 
awaitFF !
UserManagerFF" -
.FF- .$
GetTwoFactorEnabledAsyncFF. F
(FFF G
userIdFFG M
)FFM N
,FFN O
LoginsGG 
=GG 
awaitGG 
UserManagerGG *
.GG* +
GetLoginsAsyncGG+ 9
(GG9 :
userIdGG: @
)GG@ A
,GGA B
BrowserRememberedHH !
=HH" #
awaitHH$ )!
AuthenticationManagerHH* ?
.HH? @+
TwoFactorBrowserRememberedAsyncHH@ _
(HH_ `
userIdHH` f
)HHf g
}II 
;II 
returnJJ 
ViewJJ 
(JJ 
modelJJ 
)JJ 
;JJ 
}KK 	
[OO 	
HttpPostOO	 
]OO 
[PP 	$
ValidateAntiForgeryTokenPP	 !
]PP! "
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
ActionResultQQ &
>QQ& '
RemoveLoginQQ( 3
(QQ3 4
stringQQ4 :
loginProviderQQ; H
,QQH I
stringQQJ P
providerKeyQQQ \
)QQ\ ]
{RR 	
ManageMessageIdSS 
?SS 
messageSS $
;SS$ %
varTT 
resultTT 
=TT 
awaitTT 
UserManagerTT *
.TT* +
RemoveLoginAsyncTT+ ;
(TT; <
UserTT< @
.TT@ A
IdentityTTA I
.TTI J
	GetUserIdTTJ S
(TTS T
)TTT U
,TTU V
newTTW Z
UserLoginInfoTT[ h
(TTh i
loginProviderTTi v
,TTv w
providerKey	TTx É
)
TTÉ Ñ
)
TTÑ Ö
;
TTÖ Ü
ifUU 
(UU 
resultUU 
.UU 
	SucceededUU  
)UU  !
{VV 
varWW 
userWW 
=WW 
awaitWW  
UserManagerWW! ,
.WW, -
FindByIdAsyncWW- :
(WW: ;
UserWW; ?
.WW? @
IdentityWW@ H
.WWH I
	GetUserIdWWI R
(WWR S
)WWS T
)WWT U
;WWU V
ifXX 
(XX 
userXX 
!=XX 
nullXX  
)XX  !
{YY 
awaitZZ 
SignInManagerZZ '
.ZZ' (
SignInAsyncZZ( 3
(ZZ3 4
userZZ4 8
,ZZ8 9
isPersistentZZ: F
:ZZF G
falseZZH M
,ZZM N
rememberBrowserZZO ^
:ZZ^ _
falseZZ` e
)ZZe f
;ZZf g
}[[ 
message\\ 
=\\ 
ManageMessageId\\ )
.\\) *
RemoveLoginSuccess\\* <
;\\< =
}]] 
else^^ 
{__ 
message`` 
=`` 
ManageMessageId`` )
.``) *
Error``* /
;``/ 0
}aa 
returnbb 
RedirectToActionbb #
(bb# $
$strbb$ 2
,bb2 3
newbb4 7
{bb8 9
Messagebb: A
=bbB C
messagebbD K
}bbL M
)bbM N
;bbN O
}cc 	
publicgg 
ActionResultgg 
AddPhoneNumbergg *
(gg* +
)gg+ ,
{hh 	
returnii 
Viewii 
(ii 
)ii 
;ii 
}jj 	
[nn 	
HttpPostnn	 
]nn 
[oo 	$
ValidateAntiForgeryTokenoo	 !
]oo! "
publicpp 
asyncpp 
Taskpp 
<pp 
ActionResultpp &
>pp& '
AddPhoneNumberpp( 6
(pp6 7#
AddPhoneNumberViewModelpp7 N
modelppO T
)ppT U
{qq 	
ifrr 
(rr 
!rr 

ModelStaterr 
.rr 
IsValidrr #
)rr# $
{ss 
returntt 
Viewtt 
(tt 
modeltt !
)tt! "
;tt" #
}uu 
varww 
codeww 
=ww 
awaitww 
UserManagerww (
.ww( )/
#GenerateChangePhoneNumberTokenAsyncww) L
(wwL M
UserwwM Q
.wwQ R
IdentitywwR Z
.wwZ [
	GetUserIdww[ d
(wwd e
)wwe f
,wwf g
modelwwh m
.wwm n
Numberwwn t
)wwt u
;wwu v
ifxx 
(xx 
UserManagerxx 
.xx 

SmsServicexx &
!=xx' )
nullxx* .
)xx. /
{yy 
varzz 
messagezz 
=zz 
newzz !
IdentityMessagezz" 1
{{{ 
Destination|| 
=||  !
model||" '
.||' (
Number||( .
,||. /
Body}} 
=}} 
$str}} 4
+}}5 6
code}}7 ;
}~~ 
;~~ 
await 
UserManager !
.! "

SmsService" ,
., -
	SendAsync- 6
(6 7
message7 >
)> ?
;? @
}
ÄÄ 
return
ÅÅ 
RedirectToAction
ÅÅ #
(
ÅÅ# $
$str
ÅÅ$ 7
,
ÅÅ7 8
new
ÅÅ9 <
{
ÅÅ= >
PhoneNumber
ÅÅ? J
=
ÅÅK L
model
ÅÅM R
.
ÅÅR S
Number
ÅÅS Y
}
ÅÅZ [
)
ÅÅ[ \
;
ÅÅ\ ]
}
ÇÇ 	
[
ÜÜ 	
HttpPost
ÜÜ	 
]
ÜÜ 
[
áá 	&
ValidateAntiForgeryToken
áá	 !
]
áá! "
public
àà 
async
àà 
Task
àà 
<
àà 
ActionResult
àà &
>
àà& '+
EnableTwoFactorAuthentication
àà( E
(
ààE F
)
ààF G
{
ââ 	
await
ää 
UserManager
ää 
.
ää &
SetTwoFactorEnabledAsync
ää 6
(
ää6 7
User
ää7 ;
.
ää; <
Identity
ää< D
.
ääD E
	GetUserId
ääE N
(
ääN O
)
ääO P
,
ääP Q
true
ääR V
)
ääV W
;
ääW X
var
ãã 
user
ãã 
=
ãã 
await
ãã 
UserManager
ãã (
.
ãã( )
FindByIdAsync
ãã) 6
(
ãã6 7
User
ãã7 ;
.
ãã; <
Identity
ãã< D
.
ããD E
	GetUserId
ããE N
(
ããN O
)
ããO P
)
ããP Q
;
ããQ R
if
åå 
(
åå 
user
åå 
!=
åå 
null
åå 
)
åå 
{
çç 
await
éé 
SignInManager
éé #
.
éé# $
SignInAsync
éé$ /
(
éé/ 0
user
éé0 4
,
éé4 5
isPersistent
éé6 B
:
ééB C
false
ééD I
,
ééI J
rememberBrowser
ééK Z
:
ééZ [
false
éé\ a
)
ééa b
;
ééb c
}
èè 
return
êê 
RedirectToAction
êê #
(
êê# $
$str
êê$ +
,
êê+ ,
$str
êê- 5
)
êê5 6
;
êê6 7
}
ëë 	
[
ïï 	
HttpPost
ïï	 
]
ïï 
[
ññ 	&
ValidateAntiForgeryToken
ññ	 !
]
ññ! "
public
óó 
async
óó 
Task
óó 
<
óó 
ActionResult
óó &
>
óó& ',
DisableTwoFactorAuthentication
óó( F
(
óóF G
)
óóG H
{
òò 	
await
ôô 
UserManager
ôô 
.
ôô &
SetTwoFactorEnabledAsync
ôô 6
(
ôô6 7
User
ôô7 ;
.
ôô; <
Identity
ôô< D
.
ôôD E
	GetUserId
ôôE N
(
ôôN O
)
ôôO P
,
ôôP Q
false
ôôR W
)
ôôW X
;
ôôX Y
var
öö 
user
öö 
=
öö 
await
öö 
UserManager
öö (
.
öö( )
FindByIdAsync
öö) 6
(
öö6 7
User
öö7 ;
.
öö; <
Identity
öö< D
.
ööD E
	GetUserId
ööE N
(
ööN O
)
ööO P
)
ööP Q
;
ööQ R
if
õõ 
(
õõ 
user
õõ 
!=
õõ 
null
õõ 
)
õõ 
{
úú 
await
ùù 
SignInManager
ùù #
.
ùù# $
SignInAsync
ùù$ /
(
ùù/ 0
user
ùù0 4
,
ùù4 5
isPersistent
ùù6 B
:
ùùB C
false
ùùD I
,
ùùI J
rememberBrowser
ùùK Z
:
ùùZ [
false
ùù\ a
)
ùùa b
;
ùùb c
}
ûû 
return
üü 
RedirectToAction
üü #
(
üü# $
$str
üü$ +
,
üü+ ,
$str
üü- 5
)
üü5 6
;
üü6 7
}
†† 	
public
§§ 
async
§§ 
Task
§§ 
<
§§ 
ActionResult
§§ &
>
§§& '
VerifyPhoneNumber
§§( 9
(
§§9 :
string
§§: @
phoneNumber
§§A L
)
§§L M
{
•• 	
var
¶¶ 
code
¶¶ 
=
¶¶ 
await
¶¶ 
UserManager
¶¶ (
.
¶¶( )1
#GenerateChangePhoneNumberTokenAsync
¶¶) L
(
¶¶L M
User
¶¶M Q
.
¶¶Q R
Identity
¶¶R Z
.
¶¶Z [
	GetUserId
¶¶[ d
(
¶¶d e
)
¶¶e f
,
¶¶f g
phoneNumber
¶¶h s
)
¶¶s t
;
¶¶t u
return
®® 
phoneNumber
®® 
==
®® !
null
®®" &
?
®®' (
View
®®) -
(
®®- .
$str
®®. 5
)
®®5 6
:
®®7 8
View
®®9 =
(
®®= >
new
®®> A(
VerifyPhoneNumberViewModel
®®B \
{
®®] ^
PhoneNumber
®®_ j
=
®®k l
phoneNumber
®®m x
}
®®y z
)
®®z {
;
®®{ |
}
©© 	
[
≠≠ 	
HttpPost
≠≠	 
]
≠≠ 
[
ÆÆ 	&
ValidateAntiForgeryToken
ÆÆ	 !
]
ÆÆ! "
public
ØØ 
async
ØØ 
Task
ØØ 
<
ØØ 
ActionResult
ØØ &
>
ØØ& '
VerifyPhoneNumber
ØØ( 9
(
ØØ9 :(
VerifyPhoneNumberViewModel
ØØ: T
model
ØØU Z
)
ØØZ [
{
∞∞ 	
if
±± 
(
±± 
!
±± 

ModelState
±± 
.
±± 
IsValid
±± #
)
±±# $
{
≤≤ 
return
≥≥ 
View
≥≥ 
(
≥≥ 
model
≥≥ !
)
≥≥! "
;
≥≥" #
}
¥¥ 
var
µµ 
result
µµ 
=
µµ 
await
µµ 
UserManager
µµ *
.
µµ* +$
ChangePhoneNumberAsync
µµ+ A
(
µµA B
User
µµB F
.
µµF G
Identity
µµG O
.
µµO P
	GetUserId
µµP Y
(
µµY Z
)
µµZ [
,
µµ[ \
model
µµ] b
.
µµb c
PhoneNumber
µµc n
,
µµn o
model
µµp u
.
µµu v
Code
µµv z
)
µµz {
;
µµ{ |
if
∂∂ 
(
∂∂ 
result
∂∂ 
.
∂∂ 
	Succeeded
∂∂  
)
∂∂  !
{
∑∑ 
var
∏∏ 
user
∏∏ 
=
∏∏ 
await
∏∏  
UserManager
∏∏! ,
.
∏∏, -
FindByIdAsync
∏∏- :
(
∏∏: ;
User
∏∏; ?
.
∏∏? @
Identity
∏∏@ H
.
∏∏H I
	GetUserId
∏∏I R
(
∏∏R S
)
∏∏S T
)
∏∏T U
;
∏∏U V
if
ππ 
(
ππ 
user
ππ 
!=
ππ 
null
ππ  
)
ππ  !
{
∫∫ 
await
ªª 
SignInManager
ªª '
.
ªª' (
SignInAsync
ªª( 3
(
ªª3 4
user
ªª4 8
,
ªª8 9
isPersistent
ªª: F
:
ªªF G
false
ªªH M
,
ªªM N
rememberBrowser
ªªO ^
:
ªª^ _
false
ªª` e
)
ªªe f
;
ªªf g
}
ºº 
return
ΩΩ 
RedirectToAction
ΩΩ '
(
ΩΩ' (
$str
ΩΩ( /
,
ΩΩ/ 0
new
ΩΩ1 4
{
ΩΩ5 6
Message
ΩΩ7 >
=
ΩΩ? @
ManageMessageId
ΩΩA P
.
ΩΩP Q
AddPhoneSuccess
ΩΩQ `
}
ΩΩa b
)
ΩΩb c
;
ΩΩc d
}
ææ 

ModelState
¿¿ 
.
¿¿ 
AddModelError
¿¿ $
(
¿¿$ %
$str
¿¿% '
,
¿¿' (
$str
¿¿) A
)
¿¿A B
;
¿¿B C
return
¡¡ 
View
¡¡ 
(
¡¡ 
model
¡¡ 
)
¡¡ 
;
¡¡ 
}
¬¬ 	
[
∆∆ 	
HttpPost
∆∆	 
]
∆∆ 
[
«« 	&
ValidateAntiForgeryToken
««	 !
]
««! "
public
»» 
async
»» 
Task
»» 
<
»» 
ActionResult
»» &
>
»»& '
RemovePhoneNumber
»»( 9
(
»»9 :
)
»»: ;
{
…… 	
var
   
result
   
=
   
await
   
UserManager
   *
.
  * +!
SetPhoneNumberAsync
  + >
(
  > ?
User
  ? C
.
  C D
Identity
  D L
.
  L M
	GetUserId
  M V
(
  V W
)
  W X
,
  X Y
null
  Z ^
)
  ^ _
;
  _ `
if
ÀÀ 
(
ÀÀ 
!
ÀÀ 
result
ÀÀ 
.
ÀÀ 
	Succeeded
ÀÀ !
)
ÀÀ! "
{
ÃÃ 
return
ÕÕ 
RedirectToAction
ÕÕ '
(
ÕÕ' (
$str
ÕÕ( /
,
ÕÕ/ 0
new
ÕÕ1 4
{
ÕÕ5 6
Message
ÕÕ7 >
=
ÕÕ? @
ManageMessageId
ÕÕA P
.
ÕÕP Q
Error
ÕÕQ V
}
ÕÕW X
)
ÕÕX Y
;
ÕÕY Z
}
ŒŒ 
var
œœ 
user
œœ 
=
œœ 
await
œœ 
UserManager
œœ (
.
œœ( )
FindByIdAsync
œœ) 6
(
œœ6 7
User
œœ7 ;
.
œœ; <
Identity
œœ< D
.
œœD E
	GetUserId
œœE N
(
œœN O
)
œœO P
)
œœP Q
;
œœQ R
if
–– 
(
–– 
user
–– 
!=
–– 
null
–– 
)
–– 
{
—— 
await
““ 
SignInManager
““ #
.
““# $
SignInAsync
““$ /
(
““/ 0
user
““0 4
,
““4 5
isPersistent
““6 B
:
““B C
false
““D I
,
““I J
rememberBrowser
““K Z
:
““Z [
false
““\ a
)
““a b
;
““b c
}
”” 
return
‘‘ 
RedirectToAction
‘‘ #
(
‘‘# $
$str
‘‘$ +
,
‘‘+ ,
new
‘‘- 0
{
‘‘1 2
Message
‘‘3 :
=
‘‘; <
ManageMessageId
‘‘= L
.
‘‘L M 
RemovePhoneSuccess
‘‘M _
}
‘‘` a
)
‘‘a b
;
‘‘b c
}
’’ 	
public
ŸŸ 
ActionResult
ŸŸ 
ChangePassword
ŸŸ *
(
ŸŸ* +
)
ŸŸ+ ,
{
⁄⁄ 	
return
€€ 
View
€€ 
(
€€ 
)
€€ 
;
€€ 
}
‹‹ 	
[
‡‡ 	
HttpPost
‡‡	 
]
‡‡ 
[
·· 	&
ValidateAntiForgeryToken
··	 !
]
··! "
public
‚‚ 
async
‚‚ 
Task
‚‚ 
<
‚‚ 
ActionResult
‚‚ &
>
‚‚& '
ChangePassword
‚‚( 6
(
‚‚6 7%
ChangePasswordViewModel
‚‚7 N
model
‚‚O T
)
‚‚T U
{
„„ 	
if
‰‰ 
(
‰‰ 
!
‰‰ 

ModelState
‰‰ 
.
‰‰ 
IsValid
‰‰ #
)
‰‰# $
{
ÂÂ 
return
ÊÊ 
View
ÊÊ 
(
ÊÊ 
model
ÊÊ !
)
ÊÊ! "
;
ÊÊ" #
}
ÁÁ 
var
ËË 
result
ËË 
=
ËË 
await
ËË 
UserManager
ËË *
.
ËË* +!
ChangePasswordAsync
ËË+ >
(
ËË> ?
User
ËË? C
.
ËËC D
Identity
ËËD L
.
ËËL M
	GetUserId
ËËM V
(
ËËV W
)
ËËW X
,
ËËX Y
model
ËËZ _
.
ËË_ `
OldPassword
ËË` k
,
ËËk l
model
ËËm r
.
ËËr s
NewPassword
ËËs ~
)
ËË~ 
;ËË Ä
if
ÈÈ 
(
ÈÈ 
result
ÈÈ 
.
ÈÈ 
	Succeeded
ÈÈ  
)
ÈÈ  !
{
ÍÍ 
var
ÎÎ 
user
ÎÎ 
=
ÎÎ 
await
ÎÎ  
UserManager
ÎÎ! ,
.
ÎÎ, -
FindByIdAsync
ÎÎ- :
(
ÎÎ: ;
User
ÎÎ; ?
.
ÎÎ? @
Identity
ÎÎ@ H
.
ÎÎH I
	GetUserId
ÎÎI R
(
ÎÎR S
)
ÎÎS T
)
ÎÎT U
;
ÎÎU V
if
ÏÏ 
(
ÏÏ 
user
ÏÏ 
!=
ÏÏ 
null
ÏÏ  
)
ÏÏ  !
{
ÌÌ 
await
ÓÓ 
SignInManager
ÓÓ '
.
ÓÓ' (
SignInAsync
ÓÓ( 3
(
ÓÓ3 4
user
ÓÓ4 8
,
ÓÓ8 9
isPersistent
ÓÓ: F
:
ÓÓF G
false
ÓÓH M
,
ÓÓM N
rememberBrowser
ÓÓO ^
:
ÓÓ^ _
false
ÓÓ` e
)
ÓÓe f
;
ÓÓf g
}
ÔÔ 
return
 
RedirectToAction
 '
(
' (
$str
( /
,
/ 0
new
1 4
{
5 6
Message
7 >
=
? @
ManageMessageId
A P
.
P Q#
ChangePasswordSuccess
Q f
}
g h
)
h i
;
i j
}
ÒÒ 
	AddErrors
ÚÚ 
(
ÚÚ 
result
ÚÚ 
)
ÚÚ 
;
ÚÚ 
return
ÛÛ 
View
ÛÛ 
(
ÛÛ 
model
ÛÛ 
)
ÛÛ 
;
ÛÛ 
}
ÙÙ 	
public
¯¯ 
ActionResult
¯¯ 
SetPassword
¯¯ '
(
¯¯' (
)
¯¯( )
{
˘˘ 	
return
˙˙ 
View
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 	
[
ˇˇ 	
HttpPost
ˇˇ	 
]
ˇˇ 
[
ÄÄ 	&
ValidateAntiForgeryToken
ÄÄ	 !
]
ÄÄ! "
public
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
<
ÅÅ 
ActionResult
ÅÅ &
>
ÅÅ& '
SetPassword
ÅÅ( 3
(
ÅÅ3 4"
SetPasswordViewModel
ÅÅ4 H
model
ÅÅI N
)
ÅÅN O
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 

ModelState
ÉÉ 
.
ÉÉ 
IsValid
ÉÉ "
)
ÉÉ" #
{
ÑÑ 
var
ÖÖ 
result
ÖÖ 
=
ÖÖ 
await
ÖÖ "
UserManager
ÖÖ# .
.
ÖÖ. /
AddPasswordAsync
ÖÖ/ ?
(
ÖÖ? @
User
ÖÖ@ D
.
ÖÖD E
Identity
ÖÖE M
.
ÖÖM N
	GetUserId
ÖÖN W
(
ÖÖW X
)
ÖÖX Y
,
ÖÖY Z
model
ÖÖ[ `
.
ÖÖ` a
NewPassword
ÖÖa l
)
ÖÖl m
;
ÖÖm n
if
ÜÜ 
(
ÜÜ 
result
ÜÜ 
.
ÜÜ 
	Succeeded
ÜÜ $
)
ÜÜ$ %
{
áá 
var
àà 
user
àà 
=
àà 
await
àà $
UserManager
àà% 0
.
àà0 1
FindByIdAsync
àà1 >
(
àà> ?
User
àà? C
.
ààC D
Identity
ààD L
.
ààL M
	GetUserId
ààM V
(
ààV W
)
ààW X
)
ààX Y
;
ààY Z
if
ââ 
(
ââ 
user
ââ 
!=
ââ 
null
ââ  $
)
ââ$ %
{
ää 
await
ãã 
SignInManager
ãã +
.
ãã+ ,
SignInAsync
ãã, 7
(
ãã7 8
user
ãã8 <
,
ãã< =
isPersistent
ãã> J
:
ããJ K
false
ããL Q
,
ããQ R
rememberBrowser
ããS b
:
ããb c
false
ããd i
)
ããi j
;
ããj k
}
åå 
return
çç 
RedirectToAction
çç +
(
çç+ ,
$str
çç, 3
,
çç3 4
new
çç5 8
{
çç9 :
Message
çç; B
=
ççC D
ManageMessageId
ççE T
.
ççT U 
SetPasswordSuccess
ççU g
}
ççh i
)
ççi j
;
ççj k
}
éé 
	AddErrors
èè 
(
èè 
result
èè  
)
èè  !
;
èè! "
}
êê 
return
ìì 
View
ìì 
(
ìì 
model
ìì 
)
ìì 
;
ìì 
}
îî 	
public
òò 
async
òò 
Task
òò 
<
òò 
ActionResult
òò &
>
òò& '
ManageLogins
òò( 4
(
òò4 5
ManageMessageId
òò5 D
?
òòD E
message
òòF M
)
òòM N
{
ôô 	
ViewBag
öö 
.
öö 
StatusMessage
öö !
=
öö" #
message
õõ 
==
õõ 
ManageMessageId
õõ *
.
õõ* + 
RemoveLoginSuccess
õõ+ =
?
õõ> ?
$str
õõ@ a
:
úú 
message
úú 
==
úú 
ManageMessageId
úú ,
.
úú, -
Error
úú- 2
?
úú3 4
$str
úú5 M
:
ùù 
$str
ùù 
;
ùù 
var
ûû 
user
ûû 
=
ûû 
await
ûû 
UserManager
ûû (
.
ûû( )
FindByIdAsync
ûû) 6
(
ûû6 7
User
ûû7 ;
.
ûû; <
Identity
ûû< D
.
ûûD E
	GetUserId
ûûE N
(
ûûN O
)
ûûO P
)
ûûP Q
;
ûûQ R
if
üü 
(
üü 
user
üü 
==
üü 
null
üü 
)
üü 
{
†† 
return
°° 
View
°° 
(
°° 
$str
°° #
)
°°# $
;
°°$ %
}
¢¢ 
var
££ 

userLogins
££ 
=
££ 
await
££ "
UserManager
££# .
.
££. /
GetLoginsAsync
££/ =
(
££= >
User
££> B
.
££B C
Identity
££C K
.
££K L
	GetUserId
££L U
(
££U V
)
££V W
)
££W X
;
££X Y
var
§§ 
otherLogins
§§ 
=
§§ #
AuthenticationManager
§§ 3
.
§§3 4,
GetExternalAuthenticationTypes
§§4 R
(
§§R S
)
§§S T
.
§§T U
Where
§§U Z
(
§§Z [
auth
§§[ _
=>
§§` b

userLogins
§§c m
.
§§m n
All
§§n q
(
§§q r
ul
§§r t
=>
§§u w
auth
§§x |
.
§§| }!
AuthenticationType§§} è
!=§§ê í
ul§§ì ï
.§§ï ñ
LoginProvider§§ñ £
)§§£ §
)§§§ •
.§§• ¶
ToList§§¶ ¨
(§§¨ ≠
)§§≠ Æ
;§§Æ Ø
ViewBag
•• 
.
•• 
ShowRemoveButton
•• $
=
••% &
user
••' +
.
••+ ,
PasswordHash
••, 8
!=
••9 ;
null
••< @
||
••A C

userLogins
••D N
.
••N O
Count
••O T
>
••U V
$num
••W X
;
••X Y
return
¶¶ 
View
¶¶ 
(
¶¶ 
new
¶¶ #
ManageLoginsViewModel
¶¶ 1
{
ßß 
CurrentLogins
®® 
=
®® 

userLogins
®®  *
,
®®* +
OtherLogins
©© 
=
©© 
otherLogins
©© )
}
™™ 
)
™™ 
;
™™ 
}
´´ 	
[
ØØ 	
HttpPost
ØØ	 
]
ØØ 
[
∞∞ 	&
ValidateAntiForgeryToken
∞∞	 !
]
∞∞! "
public
±± 
ActionResult
±± 
	LinkLogin
±± %
(
±±% &
string
±±& ,
provider
±±- 5
)
±±5 6
{
≤≤ 	
return
¥¥ 
new
¥¥ 
AccountController
¥¥ (
.
¥¥( )
ChallengeResult
¥¥) 8
(
¥¥8 9
provider
¥¥9 A
,
¥¥A B
Url
¥¥C F
.
¥¥F G
Action
¥¥G M
(
¥¥M N
$str
¥¥N a
,
¥¥a b
$str
¥¥c k
)
¥¥k l
,
¥¥l m
User
¥¥n r
.
¥¥r s
Identity
¥¥s {
.
¥¥{ |
	GetUserId¥¥| Ö
(¥¥Ö Ü
)¥¥Ü á
)¥¥á à
;¥¥à â
}
µµ 	
public
ππ 
async
ππ 
Task
ππ 
<
ππ 
ActionResult
ππ &
>
ππ& '
LinkLoginCallback
ππ( 9
(
ππ9 :
)
ππ: ;
{
∫∫ 	
var
ªª 
	loginInfo
ªª 
=
ªª 
await
ªª !#
AuthenticationManager
ªª" 7
.
ªª7 8'
GetExternalLoginInfoAsync
ªª8 Q
(
ªªQ R
XsrfKey
ªªR Y
,
ªªY Z
User
ªª[ _
.
ªª_ `
Identity
ªª` h
.
ªªh i
	GetUserId
ªªi r
(
ªªr s
)
ªªs t
)
ªªt u
;
ªªu v
if
ºº 
(
ºº 
	loginInfo
ºº 
==
ºº 
null
ºº !
)
ºº! "
{
ΩΩ 
return
ææ 
RedirectToAction
ææ '
(
ææ' (
$str
ææ( 6
,
ææ6 7
new
ææ8 ;
{
ææ< =
Message
ææ> E
=
ææF G
ManageMessageId
ææH W
.
ææW X
Error
ææX ]
}
ææ^ _
)
ææ_ `
;
ææ` a
}
øø 
var
¿¿ 
result
¿¿ 
=
¿¿ 
await
¿¿ 
UserManager
¿¿ *
.
¿¿* +
AddLoginAsync
¿¿+ 8
(
¿¿8 9
User
¿¿9 =
.
¿¿= >
Identity
¿¿> F
.
¿¿F G
	GetUserId
¿¿G P
(
¿¿P Q
)
¿¿Q R
,
¿¿R S
	loginInfo
¿¿T ]
.
¿¿] ^
Login
¿¿^ c
)
¿¿c d
;
¿¿d e
return
¡¡ 
result
¡¡ 
.
¡¡ 
	Succeeded
¡¡ #
?
¡¡$ %
RedirectToAction
¡¡& 6
(
¡¡6 7
$str
¡¡7 E
)
¡¡E F
:
¡¡G H
RedirectToAction
¡¡I Y
(
¡¡Y Z
$str
¡¡Z h
,
¡¡h i
new
¡¡j m
{
¡¡n o
Message
¡¡p w
=
¡¡x y
ManageMessageId¡¡z â
.¡¡â ä
Error¡¡ä è
}¡¡ê ë
)¡¡ë í
;¡¡í ì
}
¬¬ 	
	protected
ƒƒ 
override
ƒƒ 
void
ƒƒ 
Dispose
ƒƒ  '
(
ƒƒ' (
bool
ƒƒ( ,
	disposing
ƒƒ- 6
)
ƒƒ6 7
{
≈≈ 	
if
∆∆ 
(
∆∆ 
	disposing
∆∆ 
&&
∆∆ 
_userManager
∆∆ )
!=
∆∆* ,
null
∆∆- 1
)
∆∆1 2
{
«« 
_userManager
»» 
.
»» 
Dispose
»» $
(
»»$ %
)
»»% &
;
»»& '
_userManager
…… 
=
…… 
null
…… #
;
……# $
}
   
base
ÃÃ 
.
ÃÃ 
Dispose
ÃÃ 
(
ÃÃ 
	disposing
ÃÃ "
)
ÃÃ" #
;
ÃÃ# $
}
ÕÕ 	
private
—— 
const
—— 
string
—— 
XsrfKey
—— $
=
——% &
$str
——' /
;
——/ 0
private
”” $
IAuthenticationManager
”” &#
AuthenticationManager
””' <
{
‘‘ 	
get
’’ 
{
÷÷ 
return
◊◊ 
HttpContext
◊◊ "
.
◊◊" #
GetOwinContext
◊◊# 1
(
◊◊1 2
)
◊◊2 3
.
◊◊3 4
Authentication
◊◊4 B
;
◊◊B C
}
ÿÿ 
}
ŸŸ 	
private
€€ 
void
€€ 
	AddErrors
€€ 
(
€€ 
IdentityResult
€€ -
result
€€. 4
)
€€4 5
{
‹‹ 	
foreach
›› 
(
›› 
var
›› 
error
›› 
in
›› !
result
››" (
.
››( )
Errors
››) /
)
››/ 0
{
ﬁﬁ 

ModelState
ﬂﬂ 
.
ﬂﬂ 
AddModelError
ﬂﬂ (
(
ﬂﬂ( )
$str
ﬂﬂ) +
,
ﬂﬂ+ ,
error
ﬂﬂ- 2
)
ﬂﬂ2 3
;
ﬂﬂ3 4
}
‡‡ 
}
·· 	
private
„„ 
bool
„„ 
HasPassword
„„  
(
„„  !
)
„„! "
{
‰‰ 	
var
ÂÂ 
user
ÂÂ 
=
ÂÂ 
UserManager
ÂÂ "
.
ÂÂ" #
FindById
ÂÂ# +
(
ÂÂ+ ,
User
ÂÂ, 0
.
ÂÂ0 1
Identity
ÂÂ1 9
.
ÂÂ9 :
	GetUserId
ÂÂ: C
(
ÂÂC D
)
ÂÂD E
)
ÂÂE F
;
ÂÂF G
if
ÊÊ 
(
ÊÊ 
user
ÊÊ 
!=
ÊÊ 
null
ÊÊ 
)
ÊÊ 
{
ÁÁ 
return
ËË 
user
ËË 
.
ËË 
PasswordHash
ËË (
!=
ËË) +
null
ËË, 0
;
ËË0 1
}
ÈÈ 
return
ÍÍ 
false
ÍÍ 
;
ÍÍ 
}
ÎÎ 	
private
ÌÌ 
bool
ÌÌ 
HasPhoneNumber
ÌÌ #
(
ÌÌ# $
)
ÌÌ$ %
{
ÓÓ 	
var
ÔÔ 
user
ÔÔ 
=
ÔÔ 
UserManager
ÔÔ "
.
ÔÔ" #
FindById
ÔÔ# +
(
ÔÔ+ ,
User
ÔÔ, 0
.
ÔÔ0 1
Identity
ÔÔ1 9
.
ÔÔ9 :
	GetUserId
ÔÔ: C
(
ÔÔC D
)
ÔÔD E
)
ÔÔE F
;
ÔÔF G
if
 
(
 
user
 
!=
 
null
 
)
 
{
ÒÒ 
return
ÚÚ 
user
ÚÚ 
.
ÚÚ 
PhoneNumber
ÚÚ '
!=
ÚÚ( *
null
ÚÚ+ /
;
ÚÚ/ 0
}
ÛÛ 
return
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ıı 	
public
˜˜ 
enum
˜˜ 
ManageMessageId
˜˜ #
{
¯¯ 	
AddPhoneSuccess
˘˘ 
,
˘˘ #
ChangePasswordSuccess
˙˙ !
,
˙˙! "!
SetTwoFactorSuccess
˚˚ 
,
˚˚   
SetPasswordSuccess
¸¸ 
,
¸¸  
RemoveLoginSuccess
˝˝ 
,
˝˝  
RemovePhoneSuccess
˛˛ 
,
˛˛ 
Error
ˇˇ 
}
ÄÄ 	
}
ÉÉ 
}ÑÑ »¶
JE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\TestingController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
TestingController "
:# $
BaseController% 3
{ 
public 
ActionResult 
Index !
(! "
Guid" &
?& '
id( *
)* +
{ 	
var 
campaign 
= 
Db 
. 
	Campaigns '
. 
Include 
( 
c 
=> 
c 
.  
Assets  &
)& '
. 
Include 
( 
c 
=> 
c 
.  
Testing  '
)' (
. 
FirstOrDefault 
(  
c  !
=>" $
c% &
.& '
Id' )
==* ,
id- /
)/ 0
;0 1
if 
( 
campaign 
== 
null  
)  !
return" (
View) -
(- .
$str. 5
)5 6
;6 7
Session 
[ 
$str 
] 
= 
id 
; 
Session 
[ 
$str !
]! "
=# $
campaign% -
.- .
OrderNumber. 9
;9 :
if   
(   
campaign   
.   
Testing    
==  ! #
null  $ (
)  ( )
{!! 
campaign"" 
."" 
Assets"" 
.""  

ZipCodeUrl""  *
=""+ ,
$"""- //
#http://www.digitaldynamixs.net/ep2/""/ R
{""R S
campaign""S [
.""[ \
OrderNumber""\ g
}""g h
/""h i
{""i j
campaign""j r
.""r s
OrderNumber""s ~
}""~ 
zip.csv	"" Ü
"
""Ü á
;
""á à
campaign## 
.## 
Assets## 
.##  
CreativeUrl##  +
=##, -
$"##- //
#http://www.digitaldynamixs.net/ep2/##/ R
{##R S
campaign##S [
.##[ \
OrderNumber##\ g
}##g h
/##h i
{##i j
campaign##j r
.##r s
OrderNumber##s ~
}##~ 
.htm	## É
"
##É Ñ
;
##Ñ Ö
var%% 
	testingId%% 
=%% 
Guid%%  $
.%%$ %
NewGuid%%% ,
(%%, -
)%%- .
;%%. /
var&& 
testing&& 
=&& 
new&& !
CampaignTesting&&" 1
(&&1 2
)&&2 3
{'' 
Id(( 
=(( 
	testingId(( "
,((" #

CampaignId)) 
=))  
campaign))! )
.))) *
Id))* ,
,)), -
	CreatedAt** 
=** 
DateTime**  (
.**( )
Now**) ,
,**, -
	CreatedBy++ 
=++ 
campaign++  (
.++( )
	CreatedBy++) 2
,++2 3
CampaignName,,  
=,,! "
campaign,,# +
.,,+ ,
CampaignName,,, 8
,,,8 9

WhiteLabel-- 
=--  
campaign--! )
.--) *

WhiteLabel--* 4
,--4 5
ReBroadCast.. 
=..  !
campaign.." *
...* +
ReBroadCast..+ 6
,..6 7
ReBroadcastDate// #
=//$ %
campaign//& .
.//. /
ReBroadcastDate/// >
,//> ?
FromLine00 
=00 
campaign00 '
.00' (
FromLine00( 0
,000 1
SubjectLine11 
=11  !
campaign11" *
.11* +
SubjectLine11+ 6
,116 7
TestingUrgency33 "
=33# $
campaign33% -
.33- .
TestingUrgency33. <
,33< =

DeployDate44 
=44  
campaign44! )
.44) *
BroadcastDate44* 7
,447 8

GeoDetails55 
=55  
campaign55! )
.55) *

GeoDetails55* 4
,554 5
Demographics66  
=66! "
campaign66# +
.66+ ,
Demographics66, 8
,668 9
Quantity77 
=77 
campaign77 '
.77' (
Quantity77( 0
,770 1
SpecialInstructions88 '
=88( )
campaign88* 2
.882 3
SpecialInstructions883 F
,88F G
IsOpenPixel:: 
=::  !
campaign::" *
.::* +
IsOpenPixel::+ 6
,::6 7
OpenPixelUrl;;  
=;;! "
campaign;;# +
.;;+ ,
OpenPixelUrl;;, 8
,;;8 9
	OpenGoals<< 
=<< 
campaign<<  (
.<<( )
Quantity<<) 1
*<<2 3
$num<<4 6
/<<7 8
$num<<9 <
,<<< =

ClickGoals== 
===  
campaign==! )
.==) *
Quantity==* 2
*==3 4
$num==5 7
/==8 9
$num==: =
,=== >
DataFileQuantity>> $
=>>% &
campaign>>' /
.>>/ 0
DataFileQuantity>>0 @
,>>@ A
IsOmniOrderAA 
=AA  !
campaignAA" *
.AA* +
IsOmniOrderAA+ 6
,AA6 7
OmniDeployDateBB "
=BB# $
campaignBB% -
.BB- .
OmniDeployDateBB. <
,BB< =
ImpressionsCC 
=CC  !
campaignCC" *
.CC* +
ImpressionsCC+ 6
,CC6 7
ChannelTypesDD  
=DD! "
campaignDD# +
.DD+ ,
ChannelTypesDD, 8
,DD8 9
}FF 
;FF 
DbGG 
.GG 
CampaignsTestingGG #
.GG# $
AddGG$ '
(GG' (
testingGG( /
)GG/ 0
;GG0 1
DbHH 
.HH 
SaveChangesHH 
(HH 
)HH  
;HH  !
campaignJJ 
.JJ 
	TestingIdJJ "
=JJ# $
	testingIdJJ% .
;JJ. /
DbKK 
.KK 
SaveChangesKK 
(KK 
)KK  
;KK  !
}LL 
campaignMM 
.MM 
StatusMM 
=MM 
(MM 
intMM "
)MM" #
CampaignStatusMM# 1
.MM1 2
TestingMM2 9
;MM9 :
DbNN 
.NN 
SaveChangesNN 
(NN 
)NN 
;NN 
returnOO 
RedirectToActionOO #
(OO# $
$strOO$ 1
,OO1 2
$strOO3 <
,OO< =
newOO> A
{OOB C
idOOD F
=OOG H
campaignOOI Q
.OOQ R
	TestingIdOOR [
}OO\ ]
)OO] ^
;OO^ _
}PP 	
staticSS 
charSS 
c1SS 
;SS 
publicTT 
ActionResultTT 
EditTestingTT '
(TT' (
GuidTT( ,
?TT, -
idTT. 0
)TT0 1
{UU 	
varVV 
campaignTestingVV 
=VV  !
DbVV" $
.VV$ %
CampaignsTestingVV% 5
.VV5 6
FirstOrDefaultVV6 D
(VVD E
cVVE F
=>VVG I
cVVJ K
.VVK L
IdVVL N
==VVO Q
idVVR T
)VVT U
;VVU V
ifXX 
(XX 
campaignTestingXX 
==XX  "
nullXX# '
)XX' (
{YY 
throwZZ 
newZZ 
HttpExceptionZZ '
(ZZ' (
$numZZ( +
,ZZ+ ,
$strZZ- 8
)ZZ8 9
;ZZ9 :
}[[ 

TinyMapper]] 
.]] 
Bind]] 
<]] 
CampaignTesting]] +
,]]+ ,
CampaignTestingVM]]- >
>]]> ?
(]]? @
config]]@ F
=>]]G I
{^^ 
config__ 
.__ 
Ignore__ 
(__ 
x__ 
=>__  "
x__# $
.__$ %
ChannelTypes__% 1
)__1 2
;__2 3
}`` 
)`` 
;`` 
varbb 
campaignTestingVmbb !
=bb" #

TinyMapperbb$ .
.bb. /
Mapbb/ 2
<bb2 3
CampaignTestingVMbb3 D
>bbD E
(bbE F
campaignTestingbbF U
)bbU V
;bbV W
Campaigncc 
campaigncc 
=cc 
Dbcc  "
.cc" #
	Campaignscc# ,
.dd 
Includedd 
(dd 
xdd 
=>dd  
xdd! "
.dd" #
Assetsdd# )
)dd) *
.ee 
Includeee 
(ee 
xee 
=>ee  
xee! "
.ee" #
Segmentsee# +
)ee+ ,
.ff 
FirstOrDefaultff "
(ff" #
xff# $
=>ff% '
xff( )
.ff) *
Idff* ,
==ff- /
campaignTestingff0 ?
.ff? @

CampaignIdff@ J
)ffJ K
;ffK L
campaignTestingVmgg 
.gg 
OrderNumbergg )
=gg* +
campaigngg, 4
.gg4 5
OrderNumbergg5 @
;gg@ A
ifhh 
(hh 
campaignhh 
.hh 
Assetshh 
==hh  "
nullhh# '
)hh' (
{ii 
varjj 
assetIdjj 
=jj 
Guidjj "
.jj" #
NewGuidjj# *
(jj* +
)jj+ ,
;jj, -
Dbkk 
.kk 
CampaignAssetskk !
.kk! "
Addkk" %
(kk% &
newkk& )
CampaignAssetkk* 7
(kk7 8
)kk8 9
{ll 
Idmm 
=mm 
assetIdmm  
,mm  !

CampaignIdnn 
=nn  
campaignnn! )
.nn) *
Idnn* ,
,nn, -
	CreatedAtoo 
=oo 
DateTimeoo  (
.oo( )
Nowoo) ,
}pp 
)pp 
;pp 
campaignqq 
.qq 
AssetsIdqq !
=qq" #
assetIdqq$ +
;qq+ ,
Dbrr 
.rr 
SaveChangesrr 
(rr 
)rr  
;rr  !
campaignss 
=ss 
Dbss 
.ss 
	Campaignsss '
.tt 
Includett 
(tt 
xtt 
=>tt  
xtt! "
.tt" #
Assetstt# )
)tt) *
.uu 
Includeuu 
(uu 
xuu 
=>uu  
xuu! "
.uu" #
Segmentsuu# +
)uu+ ,
.vv 
FirstOrDefaultvv "
(vv" #
xvv# $
=>vv% '
xvv( )
.vv) *
Idvv* ,
==vv- /
campaignTestingvv0 ?
.vv? @

CampaignIdvv@ J
)vvJ K
;vvK L
}ww 
campaignTestingVmxx 
.xx 
Assetsxx $
=xx% &
campaignxx' /
.xx/ 0
Assetsxx0 6
;xx6 7
c1yy 
=yy 
$charyy 
;yy 
foreachzz 
(zz 
varzz 
segmentzz  
inzz! #
campaignzz$ ,
.zz, -
Segmentszz- 5
.zz5 6
OrderByzz6 =
(zz= >
xzz> ?
=>zz@ B
xzzC D
.zzD E
SegmentNumberzzE R
)zzR S
)zzS T
{{{ 
var|| 
	segmentVm|| 
=|| 

TinyMapper||  *
.||* +
Map||+ .
<||. /
CampaignSegmentVM||/ @
>||@ A
(||A B
segment||B I
)||I J
;||J K
campaignTestingVm}} !
.}}! "
Segments}}" *
.}}* +
Add}}+ .
(}}. /
	segmentVm}}/ 8
)}}8 9
;}}9 :
c1~~ 
=~~ 
segment~~ 
.~~ 
SegmentNumber~~ *
.~~* +
Replace~~+ 2
(~~2 3
campaignTestingVm~~3 D
.~~D E
OrderNumber~~E P
,~~P Q
string~~R X
.~~X Y
Empty~~Y ^
)~~^ _
.~~_ `
ToCharArray~~` k
(~~k l
)~~l m
.~~m n
Select~~n t
(~~t u
x~~u v
=>~~w y
++~~z |
x~~| }
)~~} ~
.~~~ 
FirstOrDefault	~~ ç
(
~~ç é
)
~~é è
;
~~è ê
} 
campaignTestingVm
ÄÄ 
.
ÄÄ 
ChannelTypes
ÄÄ *
=
ÄÄ+ ,
string
ÄÄ- 3
.
ÄÄ3 4
IsNullOrEmpty
ÄÄ4 A
(
ÄÄA B
campaignTesting
ÄÄB Q
.
ÄÄQ R
ChannelTypes
ÄÄR ^
)
ÄÄ^ _
?
ÄÄ` a
new
ÄÄb e
List
ÄÄf j
<
ÄÄj k
ChannelType
ÄÄk v
>
ÄÄv w
{
ÄÄx y
}
ÄÄz {
:
ÄÄ| }
campaignTesting
ÅÅ 
.
ÅÅ  
ChannelTypes
ÅÅ  ,
.
ÇÇ 
Split
ÇÇ 
(
ÇÇ 
$str
ÇÇ 
.
ÇÇ 
ToCharArray
ÇÇ *
(
ÇÇ* +
)
ÇÇ+ ,
)
ÇÇ, -
.
ÉÉ 
Select
ÉÉ 
(
ÉÉ 
x
ÉÉ 
=>
ÉÉ  
(
ÉÉ! "
ChannelType
ÉÉ" -
)
ÉÉ- .
System
ÉÉ. 4
.
ÉÉ4 5
Enum
ÉÉ5 9
.
ÉÉ9 :
Parse
ÉÉ: ?
(
ÉÉ? @
typeof
ÉÉ@ F
(
ÉÉF G
ChannelType
ÉÉG R
)
ÉÉR S
,
ÉÉS T
x
ÉÉT U
)
ÉÉU V
)
ÉÉV W
.
ÉÉW X
ToList
ÉÉX ^
(
ÉÉ^ _
)
ÉÉ_ `
;
ÉÉ` a
ViewBag
ÑÑ 
.
ÑÑ 
TestingUrgency
ÑÑ "
=
ÑÑ# $
new
ÑÑ% (

SelectList
ÑÑ) 3
(
ÑÑ3 4

EnumHelper
ÑÑ4 >
.
ÑÑ> ?
GetEnumTextValues
ÑÑ? P
(
ÑÑP Q
typeof
ÑÑQ W
(
ÑÑW X
TestingUrgency
ÑÑX f
)
ÑÑf g
)
ÑÑg h
,
ÑÑh i
$str
ÑÑj q
,
ÑÑq r
$str
ÖÖ 
,
ÖÖ 
campaignTestingVm
ÖÖ )
.
ÖÖ) *
TestingUrgency
ÖÖ* 8
)
ÖÖ8 9
;
ÖÖ9 :
ViewBag
ÜÜ 
.
ÜÜ 

WhiteLabel
ÜÜ 
=
ÜÜ  
new
ÜÜ! $

SelectList
ÜÜ% /
(
ÜÜ/ 0
CustomersList
ÜÜ0 =
,
ÜÜ= >
$str
ÜÜ? F
,
ÜÜF G
$str
ÜÜH N
,
ÜÜN O
campaignTestingVm
ÜÜP a
.
ÜÜa b

WhiteLabel
ÜÜb l
)
ÜÜl m
;
ÜÜm n
return
áá 
View
áá 
(
áá 
campaignTestingVm
áá )
)
áá) *
;
áá* +
}
àà 	
public
ää 
ActionResult
ää 

NewSegment
ää &
(
ää& '
string
ää' -
orderNumber
ää. 9
)
ää9 :
{
ãã 	
var
çç 
segment
çç 
=
çç 
new
çç 
CampaignSegment
çç -
(
çç- .
)
çç. /
{
éé 
Id
èè 
=
èè 
Guid
èè 
.
èè 
NewGuid
èè !
(
èè! "
)
èè" #
,
èè# $
	CreatedAt
êê 
=
êê 
DateTime
êê $
.
êê$ %
Now
êê% (
,
êê( )
SegmentNumber
ëë 
=
ëë 
orderNumber
ëë  +
+
ëë, -
c1
ëë. 0
++
ëë0 2
}
íí 
;
íí 
return
ìì 
PartialView
ìì 
(
ìì 
$str
ìì J
,
ììJ K
segment
ììL S
)
ììS T
;
ììT U
}
îî 	
[
óó 	
HttpPost
óó	 
]
óó 
[
òò 	&
ValidateAntiForgeryToken
òò	 !
]
òò! "
[
ôô 	
MultipleButton
ôô	 
(
ôô 
Name
ôô 
=
ôô 
$str
ôô '
,
ôô' (
Argument
ôô) 1
=
ôô2 3
$str
ôô4 A
)
ôôA B
]
ôôB C
public
öö 
ActionResult
öö 
EditTesting
öö '
(
öö' (
[
öö( )
Bind
öö) -
(
öö- .
Include
öö. 5
=
öö6 7
$strõõ Ω
)
úú 
]
úú 
CampaignTestingVM
úú  
campaignTestingVm
úú! 2
)
úú2 3
{
ùù 	
if
ûû 
(
ûû 

ModelState
ûû 
.
ûû 
IsValid
ûû "
)
ûû" #
{
üü 

TinyMapper
°° 
.
°° 
Bind
°° 
<
°°  
CampaignTestingVM
°°  1
,
°°1 2
CampaignTesting
°°3 B
>
°°B C
(
°°C D
config
°°D J
=>
°°K M
{
¢¢ 
config
££ 
.
££ 
Ignore
££ !
(
££! "
x
££" #
=>
££$ &
x
££' (
.
££( )
ChannelTypes
££) 5
)
££5 6
;
££6 7
config
§§ 
.
§§ 
Ignore
§§ !
(
§§! "
x
§§" #
=>
§§$ &
x
§§' (
.
§§( )
Assets
§§) /
)
§§/ 0
;
§§0 1
config
•• 
.
•• 
Ignore
•• !
(
••! "
x
••" #
=>
••$ &
x
••' (
.
••( )
Segments
••) 1
)
••1 2
;
••2 3
}
¶¶ 
)
¶¶ 
;
¶¶ 
var
ßß 
campaignTesting
ßß #
=
ßß$ %

TinyMapper
ßß& 0
.
ßß0 1
Map
ßß1 4
<
ßß4 5
CampaignTesting
ßß5 D
>
ßßD E
(
ßßE F
campaignTestingVm
ßßF W
)
ßßW X
;
ßßX Y
campaignTesting
®® 
.
®®  
ChannelTypes
®®  ,
=
®®- .
campaignTestingVm
®®/ @
.
®®@ A
ChannelTypes
®®A M
==
®®N P
null
®®Q U
?
®®V W
null
®®X \
:
®®] ^
string
©© 
.
©© 
Join
©© 
(
©©  
$str
©©  #
,
©©# $
campaignTestingVm
©©% 6
.
©©6 7
ChannelTypes
©©7 C
)
©©C D
;
©©D E
Db
™™ 
.
™™ 
Entry
™™ 
(
™™ 
campaignTesting
™™ (
)
™™( )
.
™™) *
State
™™* /
=
™™0 1
EntityState
™™2 =
.
™™= >
Modified
™™> F
;
™™F G
Db
´´ 
.
´´ 
SaveChanges
´´ 
(
´´ 
)
´´  
;
´´  !
var
ÆÆ 
campaignAssets
ÆÆ "
=
ÆÆ# $
Db
ÆÆ% '
.
ÆÆ' (
CampaignAssets
ÆÆ( 6
.
ÆÆ6 7
FirstOrDefault
ÆÆ7 E
(
ÆÆE F
x
ÆÆF G
=>
ÆÆH J
x
ÆÆK L
.
ÆÆL M

CampaignId
ÆÆM W
==
ÆÆX Z
campaignTestingVm
ÆÆ[ l
.
ÆÆl m

CampaignId
ÆÆm w
)
ÆÆw x
;
ÆÆx y
campaignAssets
ØØ 
.
ØØ 
CreativeFiles
ØØ ,
=
ØØ- .
campaignTestingVm
ØØ/ @
.
ØØ@ A
Assets
ØØA G
.
ØØG H
CreativeFiles
ØØH U
;
ØØU V
campaignAssets
∞∞ 
.
∞∞ 
CreativeUrl
∞∞ *
=
∞∞+ ,
campaignTestingVm
∞∞- >
.
∞∞> ?
Assets
∞∞? E
.
∞∞E F
CreativeUrl
∞∞F Q
;
∞∞Q R
campaignAssets
±± 
.
±± 
ZipCodeFile
±± *
=
±±+ ,
campaignTestingVm
±±- >
.
±±> ?
Assets
±±? E
.
±±E F
ZipCodeFile
±±F Q
;
±±Q R
campaignAssets
≤≤ 
.
≤≤ 

ZipCodeUrl
≤≤ )
=
≤≤* +
campaignTestingVm
≤≤, =
.
≤≤= >
Assets
≤≤> D
.
≤≤D E

ZipCodeUrl
≤≤E O
;
≤≤O P
campaignAssets
≥≥ 
.
≥≥ 
TestSeedFile
≥≥ +
=
≥≥, -
campaignTestingVm
≥≥. ?
.
≥≥? @
Assets
≥≥@ F
.
≥≥F G
TestSeedFile
≥≥G S
;
≥≥S T
campaignAssets
¥¥ 
.
¥¥ 
LiveSeedFile
¥¥ +
=
¥¥, -
campaignTestingVm
¥¥. ?
.
¥¥? @
Assets
¥¥@ F
.
¥¥F G
LiveSeedFile
¥¥G S
;
¥¥S T
Db
µµ 
.
µµ 
Entry
µµ 
(
µµ 
campaignAssets
µµ '
)
µµ' (
.
µµ( )
State
µµ) .
=
µµ/ 0
EntityState
µµ1 <
.
µµ< =
Modified
µµ= E
;
µµE F
Db
∂∂ 
.
∂∂ 
SaveChanges
∂∂ 
(
∂∂ 
)
∂∂  
;
∂∂  !
if
ππ 
(
ππ 
campaignTestingVm
ππ $
.
ππ$ %
Segments
ππ% -
!=
ππ. 0
null
ππ1 5
)
ππ5 6
foreach
∫∫ 
(
∫∫ 
var
∫∫ 
	segmentVm
∫∫ &
in
∫∫' )
campaignTestingVm
∫∫* ;
.
∫∫; <
Segments
∫∫< D
)
∫∫D E
{
ªª 
var
ºº 
segment
ºº 
=
ºº  !
Db
ºº" $
.
ºº$ %
CampaignSegments
ºº% 5
.
ºº5 6
FirstOrDefault
ºº6 D
(
ººD E
x
ººE F
=>
ººG I
x
ººJ K
.
ººK L
Id
ººL N
==
ººO Q
	segmentVm
ººR [
.
ºº[ \
Id
ºº\ ^
)
ºº^ _
;
ºº_ `
if
ΩΩ 
(
ΩΩ 
segment
ΩΩ 
==
ΩΩ  "
null
ΩΩ# '
)
ΩΩ' (
{
ææ 
segment
øø 
=
øø  !
new
øø" %
CampaignSegment
øø& 5
(
øø5 6
)
øø6 7
{
¿¿ 
Id
¡¡ 
=
¡¡  
Guid
¡¡! %
.
¡¡% &
NewGuid
¡¡& -
(
¡¡- .
)
¡¡. /
,
¡¡/ 0
	CreatedAt
¬¬ %
=
¬¬& '
DateTime
¬¬( 0
.
¬¬0 1
Now
¬¬1 4
,
¬¬4 5

CampaignId
√√ &
=
√√' (
campaignTestingVm
√√) :
.
√√: ;

CampaignId
√√; E
,
√√E F
OrderNumber
ƒƒ '
=
ƒƒ( )
campaignTestingVm
ƒƒ* ;
.
ƒƒ; <
OrderNumber
ƒƒ< G
,
ƒƒG H
SegmentNumber
≈≈ )
=
≈≈* +
	segmentVm
≈≈, 5
.
≈≈5 6
SegmentNumber
≈≈6 C
}
∆∆ 
;
∆∆ 
Db
«« 
.
«« 
CampaignSegments
«« +
.
««+ ,
Add
««, /
(
««/ 0
segment
««0 7
)
««7 8
;
««8 9
Db
»» 
.
»» 
SaveChanges
»» &
(
»»& '
)
»»' (
;
»»( )
}
…… 
segment
   
.
   
SubjectLine
   '
=
  ( )
	segmentVm
  * 3
.
  3 4
SubjectLine
  4 ?
;
  ? @
segment
ÀÀ 
.
ÀÀ 
FromLine
ÀÀ $
=
ÀÀ% &
	segmentVm
ÀÀ' 0
.
ÀÀ0 1
FromLine
ÀÀ1 9
;
ÀÀ9 :
segment
ÃÃ 
.
ÃÃ 

WhiteLabel
ÃÃ &
=
ÃÃ' (
	segmentVm
ÃÃ) 2
.
ÃÃ2 3

WhiteLabel
ÃÃ3 =
;
ÃÃ= >
segment
ÕÕ 
.
ÕÕ 
Quantity
ÕÕ $
=
ÕÕ% &
	segmentVm
ÕÕ' 0
.
ÕÕ0 1
Quantity
ÕÕ1 9
;
ÕÕ9 :
segment
ŒŒ 
.
ŒŒ 
DeploymentDate
ŒŒ *
=
ŒŒ+ ,
	segmentVm
ŒŒ- 6
.
ŒŒ6 7
DeploymentDate
ŒŒ7 E
;
ŒŒE F
segment
œœ 
.
œœ 
CreativeFiles
œœ )
=
œœ* +
	segmentVm
œœ, 5
.
œœ5 6
CreativeFiles
œœ6 C
;
œœC D
segment
–– 
.
–– 
FirstRangeStart
–– +
=
––, -
	segmentVm
––. 7
.
––7 8
FirstRangeStart
––8 G
;
––G H
segment
—— 
.
—— 
FirstRangeEnd
—— )
=
——* +
	segmentVm
——, 5
.
——5 6
FirstRangeEnd
——6 C
;
——C D
segment
““ 
.
““ 
SecondRangeStart
““ ,
=
““- .
	segmentVm
““/ 8
.
““8 9
SecondRangeStart
““9 I
;
““I J
segment
”” 
.
”” 
SecondRangeEnd
”” *
=
””+ ,
	segmentVm
””- 6
.
””6 7
SecondRangeEnd
””7 E
;
””E F
segment
‘‘ 
.
‘‘ 
ThirdRangeStart
‘‘ +
=
‘‘, -
	segmentVm
‘‘. 7
.
‘‘7 8
ThirdRangeStart
‘‘8 G
;
‘‘G H
segment
’’ 
.
’’ 
ThirdRangeEnd
’’ )
=
’’* +
	segmentVm
’’, 5
.
’’5 6
ThirdRangeEnd
’’6 C
;
’’C D
Db
÷÷ 
.
÷÷ 
Entry
÷÷ 
(
÷÷ 
segment
÷÷ $
)
÷÷$ %
.
÷÷% &
State
÷÷& +
=
÷÷, -
EntityState
÷÷. 9
.
÷÷9 :
Modified
÷÷: B
;
÷÷B C
Db
◊◊ 
.
◊◊ 
SaveChanges
◊◊ "
(
◊◊" #
)
◊◊# $
;
◊◊$ %
}
ÿÿ 
TempData
⁄⁄ 
[
⁄⁄ 
$str
⁄⁄ "
]
⁄⁄" #
=
⁄⁄$ %
$str
⁄⁄& H
;
⁄⁄H I
}
€€ 
else
‹‹ 
{
›› 
var
ﬁﬁ 
	errorList
ﬁﬁ 
=
ﬁﬁ 
(
ﬁﬁ  !
from
ﬁﬁ! %
item
ﬁﬁ& *
in
ﬁﬁ+ -

ModelState
ﬁﬁ. 8
.
ﬁﬁ8 9
Values
ﬁﬁ9 ?
from
ﬂﬂ! %
error
ﬂﬂ& +
in
ﬂﬂ, .
item
ﬂﬂ/ 3
.
ﬂﬂ3 4
Errors
ﬂﬂ4 :
select
‡‡! '
error
‡‡( -
.
‡‡- .
ErrorMessage
‡‡. :
)
‡‡: ;
.
‡‡; <
ToList
‡‡< B
(
‡‡B C
)
‡‡C D
;
‡‡D E
TempData
·· 
[
·· 
$str
··  
]
··  !
=
··" #
$str
··$ D
+
··E F
string
··G M
.
··M N
Join
··N R
(
··R S
$str
··S Z
,
··Z [
	errorList
··\ e
)
··e f
;
··f g
}
‚‚ 
ViewBag
„„ 
.
„„ 
TestingUrgency
„„ "
=
„„# $
new
„„% (

SelectList
„„) 3
(
„„3 4

EnumHelper
„„4 >
.
„„> ?
GetEnumTextValues
„„? P
(
„„P Q
typeof
„„Q W
(
„„W X
TestingUrgency
„„X f
)
„„f g
)
„„g h
,
„„h i
$str
„„j q
,
„„q r
$str
‰‰ 
,
‰‰ 
campaignTestingVm
‰‰ )
.
‰‰) *
TestingUrgency
‰‰* 8
)
‰‰8 9
;
‰‰9 :
ViewBag
ÂÂ 
.
ÂÂ 

WhiteLabel
ÂÂ 
=
ÂÂ  
new
ÂÂ! $

SelectList
ÂÂ% /
(
ÂÂ/ 0
CustomersList
ÂÂ0 =
,
ÂÂ= >
$str
ÂÂ? F
,
ÂÂF G
$str
ÂÂH N
,
ÂÂN O
campaignTestingVm
ÂÂP a
.
ÂÂa b

WhiteLabel
ÂÂb l
)
ÂÂl m
;
ÂÂm n
return
ÊÊ 
View
ÊÊ 
(
ÊÊ 
$str
ÊÊ %
,
ÊÊ% &
campaignTestingVm
ÊÊ' 8
)
ÊÊ8 9
;
ÊÊ9 :
}
ÁÁ 	
public
ÈÈ 
ActionResult
ÈÈ 
ApproveSegment
ÈÈ *
(
ÈÈ* +
Guid
ÈÈ+ /
?
ÈÈ/ 0
Id
ÈÈ1 3
)
ÈÈ3 4
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
var
ÌÌ 
segment
ÌÌ 
=
ÌÌ 
Db
ÌÌ  
.
ÌÌ  !
CampaignSegments
ÌÌ! 1
.
ÌÌ1 2
FirstOrDefault
ÌÌ2 @
(
ÌÌ@ A
x
ÌÌA B
=>
ÌÌC E
x
ÌÌF G
.
ÌÌG H
Id
ÌÌH J
==
ÌÌK M
Id
ÌÌN P
)
ÌÌP Q
;
ÌÌQ R
segment
ÓÓ 
.
ÓÓ 
SegmentStatus
ÓÓ %
=
ÓÓ& '
(
ÓÓ( )
int
ÓÓ) ,
)
ÓÓ, -
SegmentStatus
ÓÓ- :
.
ÓÓ: ;
Approved
ÓÓ; C
;
ÓÓC D
segment
ÔÔ 
.
ÔÔ 
DateApproved
ÔÔ $
=
ÔÔ% &
DateTime
ÔÔ' /
.
ÔÔ/ 0
Now
ÔÔ0 3
;
ÔÔ3 4
Db
 
.
 
SaveChanges
 
(
 
)
  
;
  !
return
ÒÒ 
Json
ÒÒ 
(
ÒÒ 
new
ÒÒ 
JsonResponse
ÒÒ  ,
(
ÒÒ, -
)
ÒÒ- .
{
ÒÒ/ 0
IsSucess
ÒÒ1 9
=
ÒÒ: ;
true
ÒÒ< @
}
ÒÒA B
,
ÒÒB C!
JsonRequestBehavior
ÒÒD W
.
ÒÒW X
AllowGet
ÒÒX `
)
ÒÒ` a
;
ÒÒa b
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÙÙ 
return
ıı 
Json
ıı 
(
ıı 
new
ıı 
JsonResponse
ıı  ,
(
ıı, -
)
ıı- .
{
ıı/ 0
IsSucess
ıı1 9
=
ıı: ;
false
ıı< A
,
ııA B
ErrorMessage
ııC O
=
ııP Q
ex
ııR T
.
ııT U
Message
ııU \
}
ıı] ^
,
ıı^ _!
JsonRequestBehavior
ıı` s
.
ııs t
AllowGet
ııt |
)
ıı| }
;
ıı} ~
}
ˆˆ 
}
˜˜ 	
[
˘˘ 	
HttpPost
˘˘	 
]
˘˘ 
[
˙˙ 	&
ValidateAntiForgeryToken
˙˙	 !
]
˙˙! "
[
˚˚ 	
MultipleButton
˚˚	 
(
˚˚ 
Name
˚˚ 
=
˚˚ 
$str
˚˚ '
,
˚˚' (
Argument
˚˚) 1
=
˚˚2 3
$str
˚˚4 =
)
˚˚= >
]
˚˚> ?
public
¸¸ 
ActionResult
¸¸ 
Approve
¸¸ #
(
¸¸# $
[
¸¸$ %
Bind
¸¸% )
(
¸¸) *
Include
¸¸* 1
=
¸¸2 3
$str¸¸4 ‹
)¸¸‹ ›
]¸¸› ﬁ!
CampaignTestingVM¸¸ﬁ Ô!
campaignTestingVm¸¸ Å
)¸¸Å Ç
{
˝˝ 	
if
˛˛ 
(
˛˛ 

ModelState
˛˛ 
.
˛˛ 
IsValid
˛˛ "
)
˛˛" #
{
ˇˇ 
return
ÄÄ 
RedirectToAction
ÄÄ '
(
ÄÄ' (
$str
ÄÄ( /
,
ÄÄ/ 0
$str
ÄÄ1 ;
,
ÄÄ; <
new
ÄÄ= @
{
ÄÄA B
id
ÄÄC E
=
ÄÄF G
Session
ÄÄH O
[
ÄÄO P
$str
ÄÄP T
]
ÄÄT U
}
ÄÄV W
)
ÄÄW X
;
ÄÄX Y
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
var
ÑÑ 
	errorList
ÑÑ 
=
ÑÑ 
(
ÑÑ  !
from
ÑÑ! %
item
ÑÑ& *
in
ÑÑ+ -

ModelState
ÑÑ. 8
.
ÑÑ8 9
Values
ÑÑ9 ?
from
ÖÖ! %
error
ÖÖ& +
in
ÖÖ, .
item
ÖÖ/ 3
.
ÖÖ3 4
Errors
ÖÖ4 :
select
ÜÜ! '
error
ÜÜ( -
.
ÜÜ- .
ErrorMessage
ÜÜ. :
)
ÜÜ: ;
.
ÜÜ; <
ToList
ÜÜ< B
(
ÜÜB C
)
ÜÜC D
;
ÜÜD E
TempData
áá 
[
áá 
$str
áá  
]
áá  !
=
áá" #
$str
áá$ D
+
ááE F
string
ááG M
.
ááM N
Join
ááN R
(
ááR S
$str
ááS Z
,
ááZ [
	errorList
áá\ e
)
ááe f
;
ááf g
}
àà 
ViewBag
ââ 
.
ââ 
TestingUrgency
ââ "
=
ââ# $
new
ââ% (

SelectList
ââ) 3
(
ââ3 4

EnumHelper
ââ4 >
.
ââ> ?
GetEnumTextValues
ââ? P
(
ââP Q
typeof
ââQ W
(
ââW X
TestingUrgency
ââX f
)
ââf g
)
ââg h
,
ââh i
$str
ââj q
,
ââq r
$str
ää 
,
ää 
campaignTestingVm
ää )
.
ää) *
TestingUrgency
ää* 8
)
ää8 9
;
ää9 :
return
ãã 
View
ãã 
(
ãã 
$str
ãã %
,
ãã% &
campaignTestingVm
ãã' 8
)
ãã8 9
;
ãã9 :
}
åå 	
[
éé 	
HttpPost
éé	 
]
éé 
[
èè 	&
ValidateAntiForgeryToken
èè	 !
]
èè! "
[
êê 	
MultipleButton
êê	 
(
êê 
Name
êê 
=
êê 
$str
êê '
,
êê' (
Argument
êê) 1
=
êê2 3
$str
êê4 B
)
êêB C
]
êêC D
public
ëë 
ActionResult
ëë 
ProcessFiles
ëë (
(
ëë( )
[
ëë) *
Bind
ëë* .
(
ëë. /
Include
ëë/ 6
=
ëë7 8
$str
ëë9 T
)
ëëT U
]
ëëU V
CampaignTestingVM
ëëW h
campaignTestingVm
ëëi z
)
ëëz {
{
íí 	
var
ìì 
campaign
ìì 
=
ìì 
Db
ìì 
.
ìì 
	Campaigns
ìì '
.
ìì' (
FirstOrDefault
ìì( 6
(
ìì6 7
x
ìì7 8
=>
ìì9 ;
x
ìì< =
.
ìì= >
Id
ìì> @
==
ììA C
campaignTestingVm
ììD U
.
ììU V

CampaignId
ììV `
)
ìì` a
;
ììa b
BackgroundJob
îî 
.
îî 
Enqueue
îî !
(
îî! "
(
îî" #
)
îî# $
=>
îî% '
FileProcessor
îî( 5
.
îî5 6$
ProcessAssetUpdateUrls
îî6 L
(
îîL M

UploadPath
îîM W
,
îîW X
campaign
îîY a
.
îîa b
OrderNumber
îîb m
)
îîm n
)
îîn o
;
îîo p
TempData
ññ 
[
ññ 
$str
ññ 
]
ññ 
=
ññ  !
$str
ññ" Q
;
ññQ R
return
óó 
RedirectToAction
óó #
(
óó# $
$str
óó$ 1
,
óó1 2
new
óó3 6
{
óó7 8
id
óó9 ;
=
óó< =
campaignTestingVm
óó> O
.
óóO P
Id
óóP R
}
óóS T
)
óóT U
;
óóU V
}
òò 	
[
öö 	
HttpPost
öö	 
]
öö 
[
õõ 	&
ValidateAntiForgeryToken
õõ	 !
]
õõ! "
[
úú 	
MultipleButton
úú	 
(
úú 
Name
úú 
=
úú 
$str
úú '
,
úú' (
Argument
úú) 1
=
úú2 3
$str
úú4 K
)
úúK L
]
úúL M
public
ùù 
ActionResult
ùù #
FetchProcessDataFiles
ùù 1
(
ùù1 2
[
ùù2 3
Bind
ùù3 7
(
ùù7 8
Include
ùù8 ?
=
ùù@ A
$strùùB Ñ
)ùùÑ Ö
]ùùÖ Ü!
CampaignTestingVMùùá ò!
campaignTestingVmùùô ™
)ùù™ ´
{
ûû 	
try
üü 
{
†† 
var
°° 
campaign
°° 
=
°° 
Db
°° !
.
°°! "
	Campaigns
°°" +
.
¢¢ 
Include
¢¢ 
(
¢¢ 
x
¢¢ 
=>
¢¢ 
x
¢¢ 
.
¢¢  
Assets
¢¢  &
)
¢¢& '
.
££ 
Include
££ 
(
££ 
x
££ 
=>
££ 
x
££ 
.
££  
Segments
££  (
)
££( )
.
§§ 
FirstOrDefault
§§ 
(
§§  
x
§§  !
=>
§§" $
x
§§% &
.
§§& '
Id
§§' )
==
§§* ,
campaignTestingVm
§§- >
.
§§> ?

CampaignId
§§? I
)
§§I J
;
§§J K
if
¶¶ 
(
¶¶ 
campaign
¶¶ 
.
¶¶ 
Segments
¶¶ $
.
¶¶$ %
Count
¶¶% *
==
¶¶+ -
$num
¶¶. /
)
¶¶/ 0
throw
ßß 
new
ßß 
AdsException
ßß *
(
ßß* +
$str
ßß+ H
)
ßßH I
;
ßßI J
BackgroundJob
©© 
.
©© 
Enqueue
©© %
(
©©% &
(
©©& '
)
©©' (
=>
©©) +
DataFileProcessor
©©, =
.
©©= >
FetchSQLDataFile
©©> N
(
©©N O

UploadPath
©©O Y
,
©©Y Z
campaign
©©[ c
.
©©c d
OrderNumber
©©d o
,
©©o p
campaign
©©q y
.
©©y z
Assets©©z Ä
.©©Ä Å
ZipCodeFile©©Å å
,©©å ç!
campaignTestingVm©©é ü
.©©ü † 
DataFileQuantity©©† ∞
)©©∞ ±
)©©± ≤
;©©≤ ≥
TempData
´´ 
[
´´ 
$str
´´ "
]
´´" #
=
´´$ %
$str
´´& i
;
´´i j
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
ex
≠≠ 
)
≠≠  
{
ÆÆ 
TempData
ØØ 
[
ØØ 
$str
ØØ  
]
ØØ  !
=
ØØ" #
ex
ØØ$ &
.
ØØ& '
Message
ØØ' .
;
ØØ. /
}
∞∞ 
return
±± 
RedirectToAction
±± #
(
±±# $
$str
±±$ 1
,
±±1 2
new
±±3 6
{
±±7 8
id
±±9 ;
=
±±< =
campaignTestingVm
±±> O
.
±±O P
Id
±±P R
}
±±S T
)
±±T U
;
±±U V
}
≤≤ 	
}
¥¥ 
}µµ õ∆
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Controllers\TrackingController.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Controllers !
{ 
[ 
	Authorize 
] 
public 

class 
TrackingController #
:$ %
BaseController& 4
{ 
public 
ActionResult 
Index !
(! "
CampaignSearchVM" 2
sc3 5
)5 6
{ 	
ViewBag 
. 
CurrentSort 
=  !
sc" $
.$ %
	sortOrder% .
;. /
ViewBag 
.  
CampaignNameSortParm (
=) *
sc+ -
.- .
	sortOrder. 7
==8 :
$str; I
?J K
$strL _
:` a
$strb p
;p q
ViewBag 
. !
BroadcastDateSortParm )
=* +
sc, .
.. /
	sortOrder/ 8
==9 ;
$str< K
?L M
$strN b
:c d
$stre t
;t u
ViewBag 
. 
CreatedBySortParm %
=& '
sc( *
.* +
	sortOrder+ 4
==5 7
$str8 C
?D E
$strF V
:W X
$strY d
;d e
ViewBag 
. 
StatusSortParm "
=# $
sc% '
.' (
	sortOrder( 1
==2 4
$str5 =
?> ?
$str@ M
:N O
$strP X
;X Y
ViewBag 
. 
OrderNumberSortParm '
=( )
sc* ,
., -
	sortOrder- 6
==7 9
$str: G
?H I
$strJ \
:] ^
$str_ l
;l m
var 
	campagins 
= 
Db 
. 
	Campaigns (
.   
Include   
(   
x   
=>   
x   
.    
Approved    (
)  ( )
.!! 
Include!! 
(!! 
x!! 
=>!! 
x!! 
.!!  
ProDatas!!  (
)!!( )
."" 
Include"" 
("" 
x"" 
=>"" 
x"" 
.""  
	Trackings""  )
)"") *
.## 
OrderByDescending## "
(##" #
x### $
=>##% '
x##( )
.##) *
	CreatedAt##* 3
)##3 4
.$$ 
Where$$ 
($$ 
x$$ 
=>$$ 
x$$ 
.$$ 
Status$$ $
==$$% '
($$( )
int$$) ,
)$$, -
CampaignStatus$$- ;
.$$; <

Monitoring$$< F
)$$F G
.%% 
ToList%% 
(%% 
)%% 
;%% 
switch'' 
('' 
sc'' 
.'' 
	sortOrder''  
)''  !
{(( 
case)) 
$str)) #
:))# $
	campagins** 
=** 
	campagins**  )
.**) *
OrderBy*** 1
(**1 2
s**2 3
=>**4 6
s**7 8
.**8 9
CampaignName**9 E
)**E F
.**F G
ToList**G M
(**M N
)**N O
;**O P
break++ 
;++ 
case,, 
$str,, (
:,,( )
	campagins-- 
=-- 
	campagins--  )
.--) *
OrderByDescending--* ;
(--; <
s--< =
=>--> @
s--A B
.--B C
CampaignName--C O
)--O P
.--P Q
ToList--Q W
(--W X
)--X Y
;--Y Z
break.. 
;.. 
case// 
$str// $
://$ %
	campagins00 
=00 
	campagins00  )
.00) *
OrderBy00* 1
(001 2
s002 3
=>004 6
s007 8
.008 9
BroadcastDate009 F
)00F G
.00G H
ToList00H N
(00N O
)00O P
;00P Q
break11 
;11 
case22 
$str22 )
:22) *
	campagins33 
=33 
	campagins33  )
.33) *
OrderByDescending33* ;
(33; <
s33< =
=>33> @
s33A B
.33B C
BroadcastDate33C P
)33P Q
.33Q R
ToList33R X
(33X Y
)33Y Z
;33Z [
break44 
;44 
case55 
$str55  
:55  !
	campagins66 
=66 
	campagins66  )
.66) *
OrderBy66* 1
(661 2
s662 3
=>664 6
s667 8
.668 9
	CreatedBy669 B
)66B C
.66C D
ToList66D J
(66J K
)66K L
;66L M
break77 
;77 
case88 
$str88 %
:88% &
	campagins99 
=99 
	campagins99  )
.99) *
OrderByDescending99* ;
(99; <
s99< =
=>99> @
s99A B
.99B C
	CreatedBy99C L
)99L M
.99M N
ToList99N T
(99T U
)99U V
;99V W
break:: 
;:: 
case;; 
$str;; 
:;; 
	campagins<< 
=<< 
	campagins<<  )
.<<) *
OrderBy<<* 1
(<<1 2
s<<2 3
=><<4 6
s<<7 8
.<<8 9
Status<<9 ?
)<<? @
.<<@ A
ToList<<A G
(<<G H
)<<H I
;<<I J
break== 
;== 
case>> 
$str>> "
:>>" #
	campagins?? 
=?? 
	campagins??  )
.??) *
OrderByDescending??* ;
(??; <
s??< =
=>??> @
s??A B
.??B C
Status??C I
)??I J
.??J K
ToList??K Q
(??Q R
)??R S
;??S T
break@@ 
;@@ 
caseAA 
$strAA "
:AA" #
	campaginsBB 
=BB 
	campaginsBB  )
.BB) *
OrderByBB* 1
(BB1 2
sBB2 3
=>BB4 6
sBB7 8
.BB8 9
OrderNumberBB9 D
)BBD E
.BBE F
ToListBBF L
(BBL M
)BBM N
;BBN O
breakCC 
;CC 
caseDD 
$strDD '
:DD' (
	campaginsEE 
=EE 
	campaginsEE  )
.EE) *
OrderByDescendingEE* ;
(EE; <
sEE< =
=>EE> @
sEEA B
.EEB C
OrderNumberEEC N
)EEN O
.EEO P
ToListEEP V
(EEV W
)EEW X
;EEX Y
breakFF 
;FF 
defaultGG 
:GG 
	campaginsHH 
=HH 
	campaginsHH  )
.HH) *
OrderByDescendingHH* ;
(HH; <
sHH< =
=>HH> @
sHHA B
.HHB C
	CreatedAtHHC L
)HHL M
.HHM N
ToListHHN T
(HHT U
)HHU V
;HHV W
breakII 
;II 
}JJ 
ViewBagLL 
.LL 

SearchTypeLL 
=LL  
scLL! #
.LL# $

searchTypeLL$ .
;LL. /
switchMM 
(MM 
scMM 
.MM 

searchTypeMM !
)MM! "
{NN 
caseOO 
$strOO 
:OO 
ifPP 
(PP 
!PP 
stringPP 
.PP  
IsNullOrEmptyPP  -
(PP- .
scPP. 0
.PP0 1
basicStringPP1 <
)PP< =
)PP= >
{QQ 
	campaginsRR !
=RR" #
	campaginsRR$ -
.RR- .
WhereRR. 3
(RR3 4
sRR4 5
=>RR6 8
sSS 
.SS 
OrderNumberSS %
.SS% &
EqualsSS& ,
(SS, -
scSS- /
.SS/ 0
basicStringSS0 ;
)SS; <
||SS= ?
sTT 
.TT $
ReBroadcastedOrderNumberTT 2
==TT3 5
scTT6 8
.TT8 9
basicStringTT9 D
||TTE G
sUU 
.UU 
CampaignNameUU &
.UU& '
IndexOfUU' .
(UU. /
scUU/ 1
.UU1 2
basicStringUU2 =
,UU= >
StringComparisonUU? O
.UUO P&
InvariantCultureIgnoreCaseUUP j
)UUj k
>=UUl n
$numUUo p
)UUp q
.UUq r
ToListUUr x
(UUx y
)UUy z
;UUz {
ViewBagVV 
.VV  
BasicStringSearchedVV  3
=VV4 5
scVV6 8
.VV8 9
basicStringVV9 D
;VVD E
}WW 
elseXX 
ifXX 
(XX 
!XX 
stringXX $
.XX$ %
IsNullOrEmptyXX% 2
(XX2 3
scXX3 5
.XX5 6
basicStatusXX6 A
)XXA B
)XXB C
{YY 
intZZ 
statusZZ "
=ZZ# $
intZZ% (
.ZZ( )
ParseZZ) .
(ZZ. /
scZZ/ 1
.ZZ1 2
basicStatusZZ2 =
)ZZ= >
;ZZ> ?
if[[ 
([[ 
status[[ "
==[[# %
([[& '
int[[' *
)[[* +
CampaignStatus[[+ 9
.[[9 :
Rebroadcasted[[: G
)[[G H
	campagins\\ %
=\\& '
	campagins\\( 1
.\\1 2
Where\\2 7
(\\7 8
s\\8 9
=>\\: <
s\\= >
.\\> ?
ReBroadcasted\\? L
)\\L M
.\\M N
ToList\\N T
(\\T U
)\\U V
;\\V W
else]] 
if]] 
(]]  !
status]]! '
==]]( *
(]]+ ,
int]], /
)]]/ 0
CampaignStatus]]0 >
.]]> ?
NotRebroadcasted]]? O
)]]O P
	campagins^^ %
=^^& '
	campagins^^( 1
.^^1 2
Where^^2 7
(^^7 8
s^^8 9
=>^^: <
s^^= >
.^^> ?
ReBroadCast^^? J
&&^^K M
!^^N O
s^^O P
.^^P Q
ReBroadcasted^^Q ^
)^^^ _
.^^_ `
ToList^^` f
(^^f g
)^^g h
;^^h i
else__ 
	campagins`` %
=``& '
	campagins``( 1
.``1 2
Where``2 7
(``7 8
s``8 9
=>``: <
s``= >
.``> ?
Status``? E
==``F H
status``I O
)``O P
.``P Q
ToList``Q W
(``W X
)``X Y
;``Y Z
ViewBagaa 
.aa  
BasicStatusSearchedaa  3
=aa4 5
scaa6 8
.aa8 9
basicStatusaa9 D
;aaD E
}bb 
elsecc 
ifcc 
(cc 
!cc 
stringcc $
.cc$ %
IsNullOrEmptycc% 2
(cc2 3
sccc3 5
.cc5 6
basicOrderNumbercc6 F
)ccF G
)ccG H
{dd 
	campaginsee !
=ee" #
	campaginsee$ -
.ee- .
Whereee. 3
(ee3 4
see4 5
=>ee6 8
see9 :
.ee: ;
Idee; =
.ee= >
ToStringee> F
(eeF G
)eeG H
.eeH I
EqualseeI O
(eeO P
sceeP R
.eeR S
basicOrderNumbereeS c
)eec d
)eed e
.eee f
ToListeef l
(eel m
)eem n
;een o
}ff 
breakgg 
;gg 
casehh 
$strhh 
:hh  
ifii 
(ii 
!ii 
stringii 
.ii  
IsNullOrEmptyii  -
(ii- .
scii. 0
.ii0 1
advancedStatusii1 ?
)ii? @
)ii@ A
{jj 
intkk 
statuskk "
=kk# $
intkk% (
.kk( )
Parsekk) .
(kk. /
sckk/ 1
.kk1 2
advancedStatuskk2 @
)kk@ A
;kkA B
ifll 
(ll 
statusll "
==ll# %
(ll& '
intll' *
)ll* +
CampaignStatusll+ 9
.ll9 :
Rebroadcastedll: G
)llG H
	campaginsmm %
=mm& '
	campaginsmm( 1
.mm1 2
Wheremm2 7
(mm7 8
smm8 9
=>mm: <
smm= >
.mm> ?
OrderNumbermm? J
.mmJ K
EndsWithmmK S
(mmS T
$strmmT Y
)mmY Z
)mmZ [
.mm[ \
ToListmm\ b
(mmb c
)mmc d
;mmd e
elsenn 
	campaginsoo %
=oo& '
	campaginsoo( 1
.oo1 2
Whereoo2 7
(oo7 8
soo8 9
=>oo: <
soo= >
.oo> ?
Statusoo? E
==ooF H
statusooI O
)ooO P
.ooP Q
ToListooQ W
(ooW X
)ooX Y
;ooY Z
ViewBagpp 
.pp  "
AdvancedStatusSearchedpp  6
=pp7 8
scpp9 ;
.pp; <
advancedStatuspp< J
;ppJ K
}qq 
ifrr 
(rr 
!rr 
stringrr 
.rr  
IsNullOrEmptyrr  -
(rr- .
scrr. 0
.rr0 1
advancedUserrr1 =
)rr= >
)rr> ?
{ss 
	campaginstt !
=tt" #
	campaginstt$ -
.tt- .
Wherett. 3
(tt3 4
stt4 5
=>tt6 8
stt9 :
.tt: ;
	CreatedBytt; D
==ttE G
scttH J
.ttJ K
advancedUserttK W
)ttW X
.ttX Y
ToListttY _
(tt_ `
)tt` a
;tta b
ViewBaguu 
.uu   
AdvancedUserSearcheduu  4
=uu5 6
scuu7 9
.uu9 :
advancedUseruu: F
;uuF G
}vv 
ifxx 
(xx 
!xx 
stringxx 
.xx  
IsNullOrEmptyxx  -
(xx- .
scxx. 0
.xx0 1
campaignNamexx1 =
)xx= >
)xx> ?
{yy 
sczz 
.zz 
campaignNamezz '
=zz( )
sczz* ,
.zz, -
campaignNamezz- 9
.zz9 :
ToLowerInvariantzz: J
(zzJ K
)zzK L
;zzL M
	campagins{{ !
={{" #
	campagins{{$ -
.{{- .
Where{{. 3
({{3 4
s{{4 5
=>{{6 8
s{{9 :
.{{: ;
CampaignName{{; G
.{{G H
IndexOf{{H O
({{O P
sc{{P R
.{{R S
campaignName{{S _
,{{_ `
StringComparison{{a q
.{{q r%
CurrentCultureIgnoreCase	{{r ä
)
{{ä ã
>=
{{å é
$num
{{è ê
)
{{ê ë
.
{{ë í
ToList
{{í ò
(
{{ò ô
)
{{ô ö
;
{{ö õ
ViewBag|| 
.||  
CampaignName||  ,
=||- .
sc||/ 1
.||1 2
campaignName||2 >
;||> ?
}}} 
if 
( 
! 
string 
.  
IsNullOrEmpty  -
(- .
sc. 0
.0 1
isTested1 9
)9 :
): ;
{
ÄÄ 
bool
ÅÅ 
isTested
ÅÅ %
=
ÅÅ& '
bool
ÅÅ( ,
.
ÅÅ, -
Parse
ÅÅ- 2
(
ÅÅ2 3
sc
ÅÅ3 5
.
ÅÅ5 6
isTested
ÅÅ6 >
)
ÅÅ> ?
;
ÅÅ? @
	campagins
ÇÇ !
=
ÇÇ" #
	campagins
ÇÇ$ -
.
ÇÇ- .
Where
ÇÇ. 3
(
ÇÇ3 4
s
ÇÇ4 5
=>
ÇÇ6 8
s
ÇÇ9 :
.
ÇÇ: ;
Testing
ÇÇ; B
!=
ÇÇC E
null
ÇÇF J
&&
ÉÉ6 8
s
ÉÉ9 :
.
ÉÉ: ;
Testing
ÉÉ; B
?
ÉÉB C
.
ÉÉC D
IsTested
ÉÉD L
==
ÉÉM O
isTested
ÉÉP X
)
ÉÉX Y
.
ÉÉY Z
ToList
ÉÉZ `
(
ÉÉ` a
)
ÉÉa b
;
ÉÉb c
ViewBag
ÑÑ 
.
ÑÑ  
IsTested
ÑÑ  (
=
ÑÑ) *
sc
ÑÑ+ -
.
ÑÑ- .
isTested
ÑÑ. 6
;
ÑÑ6 7
}
ÖÖ 
if
áá 
(
áá 
!
áá 
string
áá 
.
áá  
IsNullOrEmpty
áá  -
(
áá- .
sc
áá. 0
.
áá0 1
orderedFrom
áá1 <
)
áá< =
)
áá= >
{
àà 
DateTime
ââ  
dateFrom
ââ! )
=
ââ* +
DateTime
ââ, 4
.
ââ4 5

ParseExact
ââ5 ?
(
ââ? @
sc
ââ@ B
.
ââB C
orderedFrom
ââC N
,
ââN O
$str
ââP \
,
ââ\ ]
CultureInfo
ââ^ i
.
ââi j
InvariantCulture
ââj z
)
ââz {
;
ââ{ |
	campagins
ää !
=
ää" #
	campagins
ää$ -
.
ää- .
Where
ää. 3
(
ää3 4
s
ää4 5
=>
ää6 8
s
ää9 :
.
ää: ;
	CreatedAt
ää; D
.
ääD E
Date
ääE I
>=
ääJ L
dateFrom
ääM U
.
ääU V
Date
ääV Z
)
ääZ [
.
ää[ \
ToList
ää\ b
(
ääb c
)
ääc d
;
ääd e
ViewBag
ãã 
.
ãã  
OrderedFrom
ãã  +
=
ãã, -
sc
ãã. 0
.
ãã0 1
orderedFrom
ãã1 <
;
ãã< =
}
åå 
if
éé 
(
éé 
!
éé 
string
éé 
.
éé  
IsNullOrEmpty
éé  -
(
éé- .
sc
éé. 0
.
éé0 1
	orderedTo
éé1 :
)
éé: ;
)
éé; <
{
èè 
DateTime
êê  
dateTo
êê! '
=
êê( )
DateTime
êê* 2
.
êê2 3

ParseExact
êê3 =
(
êê= >
sc
êê> @
.
êê@ A
	orderedTo
êêA J
,
êêJ K
$str
êêL X
,
êêX Y
CultureInfo
êêZ e
.
êêe f
InvariantCulture
êêf v
)
êêv w
;
êêw x
	campagins
ëë !
=
ëë" #
	campagins
ëë$ -
.
ëë- .
Where
ëë. 3
(
ëë3 4
s
ëë4 5
=>
ëë6 8
s
ëë9 :
.
ëë: ;
	CreatedAt
ëë; D
.
ëëD E
Date
ëëE I
<=
ëëJ L
dateTo
ëëM S
.
ëëS T
Date
ëëT X
)
ëëX Y
.
ëëY Z
ToList
ëëZ `
(
ëë` a
)
ëëa b
;
ëëb c
ViewBag
íí 
.
íí  
	OrderedTo
íí  )
=
íí* +
sc
íí, .
.
íí. /
	orderedTo
íí/ 8
;
íí8 9
}
ìì 
if
ïï 
(
ïï 
!
ïï 
string
ïï 
.
ïï  
IsNullOrEmpty
ïï  -
(
ïï- .
sc
ïï. 0
.
ïï0 1
broadcastFrom
ïï1 >
)
ïï> ?
)
ïï? @
{
ññ 
DateTime
óó  
dateFrom
óó! )
=
óó* +
DateTime
óó, 4
.
óó4 5

ParseExact
óó5 ?
(
óó? @
sc
óó@ B
.
óóB C
broadcastFrom
óóC P
,
óóP Q
$str
óóR ^
,
óó^ _
CultureInfo
óó` k
.
óók l
InvariantCulture
óól |
)
óó| }
;
óó} ~
	campagins
òò !
=
òò" #
	campagins
òò$ -
.
òò- .
Where
òò. 3
(
òò3 4
s
òò4 5
=>
òò6 8
s
òò9 :
.
òò: ;
BroadcastDate
òò; H
?
òòH I
.
òòI J
Date
òòJ N
>=
òòO Q
dateFrom
òòR Z
.
òòZ [
Date
òò[ _
)
òò_ `
.
òò` a
ToList
òòa g
(
òòg h
)
òòh i
;
òòi j
ViewBag
ôô 
.
ôô  
BroadcastFrom
ôô  -
=
ôô. /
sc
ôô0 2
.
ôô2 3
broadcastFrom
ôô3 @
;
ôô@ A
}
öö 
if
úú 
(
úú 
!
úú 
string
úú 
.
úú  
IsNullOrEmpty
úú  -
(
úú- .
sc
úú. 0
.
úú0 1
broadcastTo
úú1 <
)
úú< =
)
úú= >
{
ùù 
DateTime
ûû  
dateTo
ûû! '
=
ûû( )
DateTime
ûû* 2
.
ûû2 3

ParseExact
ûû3 =
(
ûû= >
sc
ûû> @
.
ûû@ A
broadcastTo
ûûA L
,
ûûL M
$str
ûûN Z
,
ûûZ [
CultureInfo
ûû\ g
.
ûûg h
InvariantCulture
ûûh x
)
ûûx y
;
ûûy z
	campagins
üü !
=
üü" #
	campagins
üü$ -
.
üü- .
Where
üü. 3
(
üü3 4
s
üü4 5
=>
üü6 8
s
üü9 :
.
üü: ;
BroadcastDate
üü; H
?
üüH I
.
üüI J
Date
üüJ N
<=
üüO Q
dateTo
üüR X
.
üüX Y
Date
üüY ]
)
üü] ^
.
üü^ _
ToList
üü_ e
(
üüe f
)
üüf g
;
üüg h
ViewBag
†† 
.
††  
BroadcastTo
††  +
=
††, -
sc
††. 0
.
††0 1
broadcastTo
††1 <
;
††< =
}
°° 
break
¢¢ 
;
¢¢ 
}
££ 
if
•• 
(
•• 
LoggedInUser
•• 
!=
•• 
null
••  $
&&
••% '
!
••( )
IsAdmin
••) 0
)
••0 1
{
¶¶ 
	campagins
ßß 
=
ßß 
	campagins
ßß %
.
ßß% &
Where
ßß& +
(
ßß+ ,
s
ßß, -
=>
ßß. 0
s
ßß1 2
.
ßß2 3
	CreatedBy
ßß3 <
==
ßß= ?
LoggedInUser
ßß@ L
.
ßßL M
UserName
ßßM U
)
ßßU V
.
ßßV W
ToList
ßßW ]
(
ßß] ^
)
ßß^ _
;
ßß_ `
}
®® 
ViewBag
™™ 
.
™™ 
BasicOrderNumber
™™ $
=
™™% &
OrderNumberList
™™' 6
;
™™6 7
ViewBag
´´ 
.
´´ 
BasicStatus
´´ 
=
´´  !

StatusList
´´" ,
;
´´, -
ViewBag
¨¨ 
.
¨¨ 
AdvancedStatus
¨¨ "
=
¨¨# $

StatusList
¨¨% /
;
¨¨/ 0
ViewBag
≠≠ 
.
≠≠ 
AdvancedUser
≠≠  
=
≠≠! "
	UsersList
≠≠# ,
;
≠≠, -
var
ØØ 
trackingVms
ØØ 
=
ØØ 
new
ØØ !
List
ØØ" &
<
ØØ& ' 
CampaignTrackingVm
ØØ' 9
>
ØØ9 :
(
ØØ: ;
)
ØØ; <
;
ØØ< =
foreach
∞∞ 
(
∞∞ 
var
∞∞ 
campaign
∞∞ !
in
∞∞" $
	campagins
∞∞% .
)
∞∞. /
{
±± 
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
campaignTracking
≤≤ -
in
≤≤. 0
campaign
≤≤1 9
.
≤≤9 :
	Trackings
≤≤: C
)
≤≤C D
{
≥≥ 
var
¥¥ 
model
¥¥ 
=
¥¥  
CampaignTrackingVm
¥¥  2
.
¥¥2 3"
FromCampaignTracking
¥¥3 G
(
¥¥G H
campaign
¥¥H P
,
¥¥P Q
campaignTracking
¥¥R b
)
¥¥b c
;
¥¥c d
trackingVms
µµ 
.
µµ  
Add
µµ  #
(
µµ# $
model
µµ$ )
)
µµ) *
;
µµ* +
}
∂∂ 
}
∑∑ 
ViewBag
ππ 
.
ππ 
Status
ππ 
=
ππ 

StatusList
ππ '
;
ππ' (
ViewBag
∫∫ 
.
∫∫ 
SearchStatus
∫∫  
=
∫∫! "

StatusList
∫∫# -
;
∫∫- .
int
ΩΩ 

pageNumber
ΩΩ 
=
ΩΩ 
(
ΩΩ 
sc
ΩΩ  
.
ΩΩ  !
page
ΩΩ! %
??
ΩΩ& (
$num
ΩΩ) *
)
ΩΩ* +
;
ΩΩ+ ,
return
ææ 
View
ææ 
(
ææ 
trackingVms
ææ #
.
ææ# $
OrderBy
ææ$ +
(
ææ+ ,
x
ææ, -
=>
ææ. 0
x
ææ1 2
.
ææ2 3
OrderNumber
ææ3 >
)
ææ> ?
.
ææ? @
ToPagedList
ææ@ K
(
ææK L

pageNumber
ææL V
,
ææV W
PageSize
ææX `
)
ææ` a
)
ææa b
;
ææb c
}
øø 	
public
¡¡ 
ActionResult
¡¡ 
Report
¡¡ "
(
¡¡" #
Guid
¡¡# '
?
¡¡' (
id
¡¡) +
)
¡¡+ ,
{
¬¬ 	
if
√√ 
(
√√ 
id
√√ 
==
√√ 
null
√√ 
)
√√ 
{
ƒƒ 
throw
≈≈ 
new
≈≈ 
HttpException
≈≈ '
(
≈≈' (
$num
≈≈( +
,
≈≈+ ,
$str
≈≈- :
)
≈≈: ;
;
≈≈; <
}
∆∆ 
Campaign
«« 
campaign
«« 
=
«« 
Db
««  "
.
««" #
	Campaigns
««# ,
.
»» 
Include
»» 
(
»» 
x
»» 
=>
»» 
x
»» 
.
»»  
Approved
»»  (
)
»»( )
.
…… 
Include
…… 
(
…… 
x
…… 
=>
…… 
x
…… 
.
……  
ProDatas
……  (
)
……( )
.
   
Include
   
(
   
x
   
=>
   
x
   
.
    
	Trackings
    )
)
  ) *
.
ÀÀ 
FirstOrDefault
ÀÀ 
(
ÀÀ  
x
ÀÀ  !
=>
ÀÀ" $
x
ÀÀ% &
.
ÀÀ& '
Id
ÀÀ' )
==
ÀÀ* ,
id
ÀÀ- /
)
ÀÀ/ 0
;
ÀÀ0 1
if
ÃÃ 
(
ÃÃ 
campaign
ÃÃ 
==
ÃÃ 
null
ÃÃ  
)
ÃÃ  !
{
ÕÕ 
throw
ŒŒ 
new
ŒŒ 
HttpException
ŒŒ '
(
ŒŒ' (
$num
ŒŒ( +
,
ŒŒ+ ,
$str
ŒŒ- 8
)
ŒŒ8 9
;
ŒŒ9 :
}
œœ 
if
–– 
(
–– 
campaign
–– 
.
–– 
Approved
–– !
==
––" $
null
––% )
)
––) *
{
—— 
TempData
““ 
[
““ 
$str
““  
]
““  !
=
““" #
$str
““$ `
;
““` a
return
”” 
RedirectToAction
”” '
(
””' (
$str
””( /
,
””/ 0
$str
””1 <
)
””< =
;
””= >
}
‘‘ 
var
’’ 
trackingVms
’’ 
=
’’ 
new
’’ !
List
’’" &
<
’’& ' 
CampaignTrackingVm
’’' 9
>
’’9 :
(
’’: ;
)
’’; <
;
’’< =
foreach
÷÷ 
(
÷÷ 
var
÷÷ 
campaignTracking
÷÷ )
in
÷÷* ,
campaign
÷÷- 5
.
÷÷5 6
	Trackings
÷÷6 ?
)
÷÷? @
{
◊◊ 
var
ÿÿ 
model
ÿÿ 
=
ÿÿ  
CampaignTrackingVm
ÿÿ .
.
ÿÿ. /"
FromCampaignTracking
ÿÿ/ C
(
ÿÿC D
campaign
ÿÿD L
,
ÿÿL M
campaignTracking
ÿÿN ^
)
ÿÿ^ _
;
ÿÿ_ `
trackingVms
ŸŸ 
.
ŸŸ 
Add
ŸŸ 
(
ŸŸ  
model
ŸŸ  %
)
ŸŸ% &
;
ŸŸ& '
}
⁄⁄ 
trackingVms
€€ 
=
€€ 
trackingVms
€€ %
.
€€% &
OrderBy
€€& -
(
€€- .
x
€€. /
=>
€€0 2
x
€€3 4
.
€€4 5
OrderNumber
€€5 @
)
€€@ A
.
€€A B
ToList
€€B H
(
€€H I
)
€€I J
;
€€J K
return
‹‹ 
View
‹‹ 
(
‹‹ 
trackingVms
‹‹ #
)
‹‹# $
;
‹‹$ %
}
›› 	
public
ﬂﬂ 
ActionResult
ﬂﬂ 
DownloadReport
ﬂﬂ *
(
ﬂﬂ* +
Guid
ﬂﬂ+ /
?
ﬂﬂ/ 0
id
ﬂﬂ1 3
,
ﬂﬂ3 4
Guid
ﬂﬂ5 9
?
ﬂﬂ9 :

trackingId
ﬂﬂ; E
)
ﬂﬂE F
{
‡‡ 	
if
·· 
(
·· 
id
·· 
==
·· 
null
·· 
)
·· 
{
‚‚ 
throw
„„ 
new
„„ 
HttpException
„„ '
(
„„' (
$num
„„( +
,
„„+ ,
$str
„„- :
)
„„: ;
;
„„; <
}
‰‰ 
Campaign
ÂÂ 
campaign
ÂÂ 
=
ÂÂ 
Db
ÂÂ  "
.
ÂÂ" #
	Campaigns
ÂÂ# ,
.
ÊÊ 
Include
ÊÊ 
(
ÊÊ 
x
ÊÊ 
=>
ÊÊ 
x
ÊÊ 
.
ÊÊ  
Assets
ÊÊ  &
)
ÊÊ& '
.
ÁÁ 
Include
ÁÁ 
(
ÁÁ 
x
ÁÁ 
=>
ÁÁ 
x
ÁÁ 
.
ÁÁ  
Segments
ÁÁ  (
)
ÁÁ( )
.
ËË 
Include
ËË 
(
ËË 
x
ËË 
=>
ËË 
x
ËË 
.
ËË  
ProDatas
ËË  (
)
ËË( )
.
ÈÈ 
Include
ÈÈ 
(
ÈÈ 
x
ÈÈ 
=>
ÈÈ 
x
ÈÈ 
.
ÈÈ  
Testing
ÈÈ  '
)
ÈÈ' (
.
ÍÍ 
Include
ÍÍ 
(
ÍÍ 
x
ÍÍ 
=>
ÍÍ 
x
ÍÍ 
.
ÍÍ  
Approved
ÍÍ  (
)
ÍÍ( )
.
ÎÎ 
Include
ÎÎ 
(
ÎÎ 
x
ÎÎ 
=>
ÎÎ 
x
ÎÎ 
.
ÎÎ  
	Trackings
ÎÎ  )
)
ÎÎ) *
.
ÏÏ 
FirstOrDefault
ÏÏ 
(
ÏÏ  
x
ÏÏ  !
=>
ÏÏ" $
x
ÏÏ% &
.
ÏÏ& '
Id
ÏÏ' )
==
ÏÏ* ,
id
ÏÏ- /
)
ÏÏ/ 0
;
ÏÏ0 1
if
ÌÌ 
(
ÌÌ 
campaign
ÌÌ 
==
ÌÌ 
null
ÌÌ  
)
ÌÌ  !
{
ÓÓ 
throw
ÔÔ 
new
ÔÔ 
HttpException
ÔÔ '
(
ÔÔ' (
$num
ÔÔ( +
,
ÔÔ+ ,
$str
ÔÔ- 8
)
ÔÔ8 9
;
ÔÔ9 :
}
 
if
ÒÒ 
(
ÒÒ 
campaign
ÒÒ 
.
ÒÒ 
Approved
ÒÒ !
==
ÒÒ" $
null
ÒÒ% )
)
ÒÒ) *
{
ÚÚ 
TempData
ÛÛ 
[
ÛÛ 
$str
ÛÛ  
]
ÛÛ  !
=
ÛÛ" #
$str
ÛÛ$ `
;
ÛÛ` a
return
ÙÙ 
RedirectToAction
ÙÙ '
(
ÙÙ' (
$str
ÙÙ( /
,
ÙÙ/ 0
$str
ÙÙ1 <
)
ÙÙ< =
;
ÙÙ= >
}
ıı 
var
˜˜ 
campaignTracking
˜˜  
=
˜˜! "
campaign
˜˜# +
.
˜˜+ ,
	Trackings
˜˜, 5
.
˜˜5 6
FirstOrDefault
˜˜6 D
(
˜˜D E
x
˜˜E F
=>
˜˜G I
x
˜˜J K
.
˜˜K L
Id
˜˜L N
==
˜˜O Q

trackingId
˜˜R \
)
˜˜\ ]
;
˜˜] ^
if
¯¯ 
(
¯¯ 
campaignTracking
¯¯  
==
¯¯! #
null
¯¯$ (
)
¯¯( )
{
˘˘ 
TempData
˙˙ 
[
˙˙ 
$str
˙˙  
]
˙˙  !
=
˙˙" #
$str
˙˙$ A
;
˙˙A B
return
˚˚ 
RedirectToAction
˚˚ '
(
˚˚' (
$str
˚˚( /
,
˚˚/ 0
$str
˚˚1 <
)
˚˚< =
;
˚˚= >
}
¸¸ 
var
˝˝ 
model
˝˝ 
=
˝˝  
CampaignTrackingVm
˝˝ *
.
˝˝* +"
FromCampaignTracking
˝˝+ ?
(
˝˝? @
campaign
˝˝@ H
,
˝˝H I
campaignTracking
˝˝J Z
)
˝˝Z [
;
˝˝[ \
string
ˇˇ 
creativeUrl
ˇˇ 
=
ˇˇ  
campaign
ˇˇ! )
.
ˇˇ) *
Assets
ˇˇ* 0
.
ˇˇ0 1
CreativeUrl
ˇˇ1 <
,
ˇˇ< =
imagePathTemp
ÄÄ 
=
ÄÄ 
$"
ÄÄ  "
{
ÄÄ" #

UploadPath
ÄÄ# -
}
ÄÄ- .
\\
ÄÄ. 0
{
ÄÄ0 1
model
ÄÄ1 6
.
ÄÄ6 7
OrderNumber
ÄÄ7 B
}
ÄÄB C
t.png
ÄÄC H
"
ÄÄH I
,
ÄÄI J
	imagePath
ÅÅ 
=
ÅÅ 
$"
ÅÅ 
{
ÅÅ 

UploadPath
ÅÅ )
}
ÅÅ) *
\\
ÅÅ* ,
{
ÅÅ, -
model
ÅÅ- 2
.
ÅÅ2 3
OrderNumber
ÅÅ3 >
}
ÅÅ> ?
.png
ÅÅ? C
"
ÅÅC D
,
ÅÅD E
fileName
ÇÇ 
=
ÇÇ 
$"
ÇÇ 
{
ÇÇ 
model
ÇÇ #
.
ÇÇ# $
OrderNumber
ÇÇ$ /
}
ÇÇ/ 0
.xlsx
ÇÇ0 5
"
ÇÇ5 6
,
ÇÇ6 7
filePath
ÉÉ 
=
ÉÉ 
Path
ÉÉ 
.
ÉÉ  
Combine
ÉÉ  '
(
ÉÉ' (
DownloadPath
ÉÉ( 4
,
ÉÉ4 5
fileName
ÉÉ6 >
)
ÉÉ> ?
;
ÉÉ? @
string
ÖÖ 
logoFilePath
ÖÖ 
=
ÖÖ  !
!
ÖÖ" #
string
ÖÖ# )
.
ÖÖ) *
IsNullOrEmpty
ÖÖ* 7
(
ÖÖ7 8
LoggedInUser
ÖÖ8 D
?
ÖÖD E
.
ÖÖE F
CompanyLogo
ÖÖF Q
)
ÖÖQ R
?
ÜÜ 
$"
ÜÜ 
{
ÜÜ 

ImagesPath
ÜÜ 
}
ÜÜ  
\\
ÜÜ  "
{
ÜÜ" #
LoggedInUser
ÜÜ# /
.
ÜÜ/ 0
CompanyLogo
ÜÜ0 ;
}
ÜÜ; <
"
ÜÜ< =
:
áá 
$"
áá 
{
áá 

ImagesPath
áá 
}
áá  
\\logo1.png
áá  +
"
áá+ ,
;
áá, -
var
ââ 
helper
ââ 
=
ââ 
new
ââ 
ImageHelper
ââ (
(
ââ( )
creativeUrl
ââ) 4
,
ââ4 5
imagePathTemp
ââ6 C
)
ââC D
;
ââD E
if
ää 
(
ää 
!
ää 
System
ää 
.
ää 
IO
ää 
.
ää 
File
ää 
.
ää  
Exists
ää  &
(
ää& '
	imagePath
ää' 0
)
ää0 1
)
ää1 2
{
ãã 
helper
åå 
.
åå 
Capture
åå 
(
åå 
)
åå  
;
åå  !
if
çç 
(
çç 
System
çç 
.
çç 
IO
çç 
.
çç 
File
çç "
.
çç" #
Exists
çç# )
(
çç) *
imagePathTemp
çç* 7
)
çç7 8
)
çç8 9
helper
éé 
.
éé 
ResizeImage
éé &
(
éé& '
imagePathTemp
éé' 4
,
éé4 5
	imagePath
éé6 ?
,
éé? @
$num
ééA D
,
ééD E
$num
ééF I
,
ééI J
true
ééK O
)
ééO P
;
ééP Q
if
èè 
(
èè 
System
èè 
.
èè 
IO
èè 
.
èè 
File
èè "
.
èè" #
Exists
èè# )
(
èè) *
imagePathTemp
èè* 7
)
èè7 8
)
èè8 9
System
êê 
.
êê 
IO
êê 
.
êê 
File
êê "
.
êê" #
Delete
êê# )
(
êê) *
imagePathTemp
êê* 7
)
êê7 8
;
êê8 9
}
ëë 
string
ìì 
templateFile
ìì 
;
ìì  
if
îî 
(
îî 
LoggedInUser
îî 
?
îî 
.
îî 
ReportTemplate
îî ,
==
îî- /
$str
îî0 3
||
îî4 6
string
îî7 =
.
îî= >
IsNullOrEmpty
îî> K
(
îîK L
LoggedInUser
îîL X
?
îîX Y
.
îîY Z
ReportTemplate
îîZ h
)
îîh i
)
îîi j
templateFile
ïï 
=
ïï 
$"
ïï !(
~/Templates/Tracking1.xlsx
ïï! ;
"
ïï; <
;
ïï< =
else
ññ 
templateFile
óó 
=
óó 
$"
óó !(
~/Templates/Tracking2.xlsx
óó! ;
"
óó; <
;
óó< =
string
ôô 
logoResized
ôô 
=
ôô  
$"
ôô! #
{
ôô# $

ImagesPath
ôô$ .
}
ôô. /
\\logoResized.png
ôô/ @
"
ôô@ A
;
ôôA B
if
öö 
(
öö 
templateFile
öö 
==
öö 
$"
öö  "(
~/Templates/Tracking1.xlsx
öö" <
"
öö< =
)
öö= >
{
õõ 
helper
úú 
.
úú 
ResizeImage
úú "
(
úú" #
logoFilePath
úú# /
,
úú/ 0
logoResized
úú1 <
,
úú< =
$num
úú> A
,
úúA B
$num
úúC F
,
úúF G
true
úúH L
)
úúL M
;
úúM N
TrackingReports
ùù 
.
ùù  
GenerateTemplate1
ùù  1
(
ùù1 2
model
ùù2 7
,
ùù7 8
Server
ùù9 ?
.
ùù? @
MapPath
ùù@ G
(
ùùG H
templateFile
ùùH T
)
ùùT U
,
ùùU V
logoResized
ùùW b
,
ùùb c
	imagePath
ùùd m
,
ùùm n
filePath
ùùo w
)
ùùw x
;
ùùx y
}
ûû 
else
üü 
{
†† 
helper
°° 
.
°° 
ResizeImage
°° "
(
°°" #
logoFilePath
°°# /
,
°°/ 0
logoResized
°°1 <
,
°°< =
$num
°°> A
,
°°A B
$num
°°C E
,
°°E F
true
°°G K
)
°°K L
;
°°L M
TrackingReports
¢¢ 
.
¢¢  
GenerateTemplate2
¢¢  1
(
¢¢1 2
model
¢¢2 7
,
¢¢7 8
Server
¢¢9 ?
.
¢¢? @
MapPath
¢¢@ G
(
¢¢G H
templateFile
¢¢H T
)
¢¢T U
,
¢¢U V
logoResized
¢¢W b
,
¢¢b c
	imagePath
¢¢d m
,
¢¢m n
filePath
¢¢o w
)
¢¢w x
;
¢¢x y
}
££ 
return
•• 
File
•• 
(
•• 
filePath
••  
,
••  !
$str
••" e
,
••e f
fileName
••g o
)
••o p
;
••p q
}
¶¶ 	
public
®® 

JsonResult
®® 
RefreshProData
®® (
(
®®( )
string
®®) /
orderNumber
®®0 ;
)
®®; <
{
©© 	
try
™™ 
{
´´ 
if
¨¨ 
(
¨¨ 
orderNumber
¨¨ 
==
¨¨  "
null
¨¨# '
)
¨¨' (
{
≠≠ 
throw
ÆÆ 
new
ÆÆ 
AdsException
ÆÆ *
(
ÆÆ* +
$str
ÆÆ+ A
)
ÆÆA B
;
ÆÆB C
}
ØØ 
Campaign
±± 
campaign
±± !
=
±±" #
Db
±±$ &
.
±±& '
	Campaigns
±±' 0
.
≤≤ 
Include
≤≤ 
(
≤≤ 
x
≤≤ 
=>
≤≤ !
x
≤≤" #
.
≤≤# $
Approved
≤≤$ ,
)
≤≤, -
.
≥≥ 
Include
≥≥ 
(
≥≥ 
x
≥≥ 
=>
≥≥ !
x
≥≥" #
.
≥≥# $
Segments
≥≥$ ,
)
≥≥, -
.
¥¥ 
Include
¥¥ 
(
¥¥ 
x
¥¥ 
=>
¥¥ !
x
¥¥" #
.
¥¥# $
	Trackings
¥¥$ -
)
¥¥- .
.
µµ 
Where
µµ 
(
µµ 
x
µµ 
=>
µµ 
x
µµ  !
.
µµ! "
Status
µµ" (
==
µµ) +
(
µµ, -
int
µµ- 0
)
µµ0 1
CampaignStatus
µµ1 ?
.
µµ? @

Monitoring
µµ@ J
||
µµK M
x
µµN O
.
µµO P
Segments
µµP X
.
µµX Y
Any
µµY \
(
µµ\ ]
s
µµ] ^
=>
µµ_ a
s
µµb c
.
µµc d
SegmentStatus
µµd q
==
µµr t
(
µµu v
int
µµv y
)
µµy z
SegmentStatusµµz á
.µµá à

Monitoringµµà í
)µµí ì
)µµì î
.
∂∂ 
Where
∂∂ 
(
∂∂ 
x
∂∂ 
=>
∂∂ 
x
∂∂  !
.
∂∂! "
Approved
∂∂" *
!=
∂∂+ -
null
∂∂. 2
)
∂∂2 3
.
∑∑ 
FirstOrDefault
∑∑ #
(
∑∑# $
x
∑∑$ %
=>
∑∑& (
x
∑∑) *
.
∑∑* +
OrderNumber
∑∑+ 6
==
∑∑7 9
orderNumber
∑∑: E
)
∑∑E F
;
∑∑F G
if
∫∫ 
(
∫∫ 
campaign
∫∫ 
!=
∫∫ 
null
∫∫ #
)
∫∫# $
ProDataApiManager
ªª %
.
ªª% &%
FetchAndUpdateTrackings
ªª& =
(
ªª= >
Db
ªª> @
,
ªª@ A
campaign
ªªB J
)
ªªJ K
;
ªªK L
return
¿¿ 
Json
¿¿ 
(
¿¿ 
new
¿¿ 
JsonResponse
¿¿  ,
(
¿¿, -
)
¿¿- .
{
¿¿/ 0
IsSucess
¿¿1 9
=
¿¿: ;
true
¿¿< @
}
¿¿A B
)
¿¿B C
;
¿¿C D
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
√√ 
return
ƒƒ 
Json
ƒƒ 
(
ƒƒ 
new
ƒƒ 
JsonResponse
ƒƒ  ,
(
ƒƒ, -
)
ƒƒ- .
{
ƒƒ/ 0
IsSucess
ƒƒ1 9
=
ƒƒ: ;
false
ƒƒ< A
,
ƒƒA B
ErrorMessage
ƒƒC O
=
ƒƒP Q
ex
ƒƒR T
.
ƒƒT U
Message
ƒƒU \
}
ƒƒ] ^
)
ƒƒ^ _
;
ƒƒ_ `
}
≈≈ 
}
∆∆ 	
}
»» 
}…… Ü@
8E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Global.asax.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

class 
MvcApplication 
:  !
HttpApplication" 1
{ 
	protected 
void 
Application_Start (
(( )
)) *
{ 	
AreaRegistration 
. 
RegisterAllAreas -
(- .
). /
;/ 0
GlobalConfiguration 
.  
	Configure  )
() *
WebApiConfig* 6
.6 7
Register7 ?
)? @
;@ A
FilterConfig 
. !
RegisterGlobalFilters .
(. /
GlobalFilters/ <
.< =
Filters= D
)D E
;E F
RouteConfig 
. 
RegisterRoutes &
(& '

RouteTable' 1
.1 2
Routes2 8
)8 9
;9 :
BundleConfig 
. 
RegisterBundles (
(( )
BundleTable) 4
.4 5
Bundles5 <
)< =
;= > 
HangfireBootstrapper  
.  !
Instance! )
.) *
Start* /
(/ 0
)0 1
;1 2
} 	
	protected   
void   
Application_End   &
(  & '
object  ' -
sender  . 4
,  4 5
	EventArgs  6 ?
e  @ A
)  A B
{!! 	 
HangfireBootstrapper""  
.""  !
Instance""! )
."") *
Stop""* .
("". /
)""/ 0
;""0 1
}## 	
	protected%% 
void%% 
Application_Error%% (
(%%( )
object%%) /
sender%%0 6
,%%6 7
	EventArgs%%8 A
e%%B C
)%%C D
{&& 	
var'' 
httpContext'' 
='' 
('' 
(''  
MvcApplication''  .
)''. /
sender''/ 5
)''5 6
.''6 7
Context''7 >
;''> ?
var(( 
currentController(( !
=((" #
$str(($ '
;((' (
var)) 
currentAction)) 
=)) 
$str))  #
;))# $
var** 
currentRouteData**  
=**! "

RouteTable**# -
.**- .
Routes**. 4
.**4 5
GetRouteData**5 A
(**A B
new**B E
HttpContextWrapper**F X
(**X Y
httpContext**Y d
)**d e
)**e f
;**f g
if,, 
(,, 
currentRouteData,,  
!=,,! #
null,,$ (
),,( )
{-- 
if.. 
(.. 
currentRouteData.. $
...$ %
Values..% +
[..+ ,
$str.., 8
]..8 9
!=..: <
null..= A
&&..B D
!..E F
string..F L
...L M
IsNullOrEmpty..M Z
(..Z [
currentRouteData..[ k
...k l
Values..l r
[..r s
$str..s 
]	.. Ä
.
..Ä Å
ToString
..Å â
(
..â ä
)
..ä ã
)
..ã å
)
..å ç
{// 
currentController00 %
=00& '
currentRouteData00( 8
.008 9
Values009 ?
[00? @
$str00@ L
]00L M
.00M N
ToString00N V
(00V W
)00W X
;00X Y
}11 
if33 
(33 
currentRouteData33 $
.33$ %
Values33% +
[33+ ,
$str33, 4
]334 5
!=336 8
null339 =
&&33> @
!33A B
string33B H
.33H I
IsNullOrEmpty33I V
(33V W
currentRouteData33W g
.33g h
Values33h n
[33n o
$str33o w
]33w x
.33x y
ToString	33y Å
(
33Å Ç
)
33Ç É
)
33É Ñ
)
33Ñ Ö
{44 
currentAction55 !
=55" #
currentRouteData55$ 4
.554 5
Values555 ;
[55; <
$str55< D
]55D E
.55E F
ToString55F N
(55N O
)55O P
;55P Q
}66 
}77 
var88 
ex88 
=88 
Server88 
.88 
GetLastError88 (
(88( )
)88) *
;88* +
try:: 
{;; 
EmailHelper<< 
.<< 
SendErrorEmail<< *
(<<* + 
ConfigurationManager<<+ ?
.<<? @
AppSettings<<@ K
[<<K L
$str<<L _
]<<_ `
,<<` a
ex<<b d
,<<d e
currentController<<f w
,<<w x
currentAction== !
)==! "
;==" #
}>> 
catch?? 
(?? 
	Exception?? 
exx??  
)??  !
{@@ 
}AA 
varCC 
	routeDataCC 
=CC 
newCC 
	RouteDataCC  )
(CC) *
)CC* +
;CC+ ,
varDD 
actionDD 
=DD 
$strDD '
;DD' (
ifFF 
(FF 
exFF 
isFF 
HttpExceptionFF #
)FF# $
{GG 
varHH 
httpExHH 
=HH 
exHH 
asHH  "
HttpExceptionHH# 0
;HH0 1
switchJJ 
(JJ 
httpExJJ 
.JJ 
GetHttpCodeJJ *
(JJ* +
)JJ+ ,
)JJ, -
{KK 
caseLL 
$numLL 
:LL 
actionMM 
=MM  
$strMM! -
;MM- .
breakNN 
;NN 
caseOO 
$numOO 
:OO 
actionPP 
=PP  
$strPP! +
;PP+ ,
breakQQ 
;QQ 
}SS 
}TT 
httpContextVV 
.VV 

ClearErrorVV "
(VV" #
)VV# $
;VV$ %
httpContextWW 
.WW 
ResponseWW  
.WW  !
ClearWW! &
(WW& '
)WW' (
;WW( )
httpContextXX 
.XX 
ResponseXX  
.XX  !

StatusCodeXX! +
=XX, -
exXX. 0
isXX1 3
HttpExceptionXX4 A
?XXB C
(XXD E
(XXE F
HttpExceptionXXF S
)XXS T
exXXT V
)XXV W
.XXW X
GetHttpCodeXXX c
(XXc d
)XXd e
:XXf g
$numXXh k
;XXk l
httpContextYY 
.YY 
ResponseYY  
.YY  !"
TrySkipIisCustomErrorsYY! 7
=YY8 9
trueYY: >
;YY> ?
	routeData[[ 
.[[ 
Values[[ 
[[[ 
$str[[ )
][[) *
=[[+ ,
$str[[- 4
;[[4 5
	routeData\\ 
.\\ 
Values\\ 
[\\ 
$str\\ %
]\\% &
=\\' (
action\\) /
;\\/ 0
	routeData]] 
.]] 
Values]] 
[]] 
$str]] (
]]]( )
=]]* +
new]], /
HandleErrorInfo]]0 ?
(]]? @
ex]]@ B
,]]B C
currentController]]D U
,]]U V
currentAction]]W d
)]]d e
;]]e f
IController__ 
errorController__ '
=__( )
new__* -
ErrorController__. =
(__= >
)__> ?
;__? @
HttpContextWrapper`` 
wrapper`` &
=``' (
new``) ,
HttpContextWrapper``- ?
(``? @
httpContext``@ K
)``K L
;``L M
varaa 
rcaa 
=aa 
newaa 
RequestContextaa '
(aa' (
wrapperaa( /
,aa/ 0
	routeDataaa1 :
)aa: ;
;aa; <
errorControllerbb 
.bb 
Executebb #
(bb# $
rcbb$ &
)bb& '
;bb' (
}cc 	
}dd 
}ee ˚
KE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\AjaxAuthorizeAttribute.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class "
AjaxAuthorizeAttribute '
:( )
AuthorizeAttribute* <
{ 
	protected 
override 
void %
HandleUnauthorizedRequest  9
(9 : 
AuthorizationContext: N
contextO V
)V W
{ 	
if		 
(		 
context		 
.		 
HttpContext		 #
.		# $
Request		$ +
.		+ ,
IsAjaxRequest		, 9
(		9 :
)		: ;
)		; <
{

 
var 
	urlHelper 
= 
new  #
	UrlHelper$ -
(- .
context. 5
.5 6
RequestContext6 D
)D E
;E F
context 
. 
HttpContext #
.# $
Response$ ,
., -

StatusCode- 7
=8 9
$num: =
;= >
context 
. 
Result 
=  
new! $

JsonResult% /
{ 
Data 
= 
new 
{ 
Error 
= 
$str  /
,/ 0
LogOnUrl  
=! "
	urlHelper# ,
., -
Action- 3
(3 4
$str4 ;
,; <
$str= F
)F G
} 
, 
JsonRequestBehavior '
=( )
JsonRequestBehavior* =
.= >
AllowGet> F
} 
; 
} 
else 
{ 
base 
. %
HandleUnauthorizedRequest .
(. /
context/ 6
)6 7
;7 8
} 
} 	
} 
} °
BE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\AuthorizeRole.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public		 

class		 
AuthorizeRole		 
:		  !
ActionFilterAttribute		! 6
{

 
public 
string 
Roles 
{ 
get !
;! "
set# &
;& '
}( )
public 
override 
void 
OnActionExecuting .
(. /"
ActionExecutingContext/ E
filterContextF S
)S T
{ 	
bool 
	IfAllowed 
= 
false "
;" #
try 
{ 
var 
userIdentity  
=! "
filterContext# 0
.0 1
HttpContext1 <
.< =
User= A
.A B
IdentityB J
asK M
ClaimsIdentityN \
;\ ]
var 
roles 
= 
userIdentity (
.( )
Claims) /
./ 0
Where0 5
(5 6
x6 7
=>8 :
x; <
.< =
Type= A
==B D

ClaimTypesE O
.O P
RoleP T
)T U
.U V
SelectV \
(\ ]
claim] b
=>c e
claime j
.j k
Valuek p
)p q
.q r
ToArrayr y
(y z
)z {
;{ |
var 
	rolesList 
= 
Roles  %
.% &
Split& +
(+ ,
$str, /
./ 0
ToCharArray0 ;
(; <
)< =
,= >
StringSplitOptions? Q
.Q R
RemoveEmptyEntriesR d
)d e
;e f
foreach 
( 
var 
requestedRole *
in+ -
	rolesList. 7
)7 8
{ 
if   
(   
roles   
.   
Contains   &
(  & '
requestedRole  ' 4
)  4 5
)  5 6
{!! 
	IfAllowed"" !
=""" #
true""$ (
;""( )
break## 
;## 
}$$ 
}%% 
if'' 
('' 
	IfAllowed'' 
)'' 
{(( 
base)) 
.)) 
OnActionExecuting)) *
())* +
filterContext))+ 8
)))8 9
;))9 :
return** 
;** 
}++ 
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)-- 
{.. 
}00 
filterContext33 
.33 
Result33  
=33! "
new44 !
RedirectToRouteResult44 -
(44- .
new44. 1 
RouteValueDictionary442 F
{55 
{66 
$str66 "
,66" #
$str66$ 3
}664 5
,665 6
{77 
$str77 &
,77& '
$str77( /
}770 1
,771 2
}88 
)88 
;88 
return99 
;99 
}:: 	
};; 
}<< ¢
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\AuthorizeClaim.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public		 

class		 
AuthorizeClaim		 
:		  !!
ActionFilterAttribute		" 7
{

 
public 
string 
Claims 
{ 
get "
;" #
set$ '
;' (
}) *
public 
override 
void 
OnActionExecuting .
(. /"
ActionExecutingContext/ E
filterContextF S
)S T
{ 	
bool 
	IfAllowed 
= 
false "
;" #
try 
{ 
var 
userIdentity  
=! "
filterContext# 0
.0 1
HttpContext1 <
.< =
User= A
.A B
IdentityB J
asK M
ClaimsIdentityN \
;\ ]
var 
claims 
= 
userIdentity )
.) *
Claims* 0
.0 1
Where1 6
(6 7
x7 8
=>9 ;
x< =
.= >
Type> B
==C E

ClaimTypesF P
.P Q
UserDataQ Y
)Y Z
.Z [
Select[ a
(a b
claimb g
=>h j
claimk p
.p q
Valueq v
)v w
.w x
ToListx ~
(~ 
)	 Ä
;
Ä Å
var 

claimsList 
=  
Claims! '
.' (
Split( -
(- .
$str. 1
.1 2
ToCharArray2 =
(= >
)> ?
,? @
StringSplitOptionsA S
.S T
RemoveEmptyEntriesT f
)f g
;g h
foreach 
( 
var 
requestedClaim +
in, .

claimsList/ 9
)9 :
{   
if!! 
(!! 
claims!! 
.!! 
Contains!! '
(!!' (
requestedClaim!!( 6
)!!6 7
)!!7 8
{"" 
	IfAllowed## !
=##" #
true##$ (
;##( )
break$$ 
;$$ 
}%% 
}&& 
if(( 
((( 
	IfAllowed(( 
)(( 
{)) 
base** 
.** 
OnActionExecuting** *
(*** +
filterContext**+ 8
)**8 9
;**9 :
return++ 
;++ 
},, 
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
).. 
{// 
}11 
filterContext44 
.44 
Result44  
=44! "
new55 !
RedirectToRouteResult55 -
(55- .
new55. 1 
RouteValueDictionary552 F
{66 
{77 
$str77 "
,77" #
$str77$ 3
}774 5
,775 6
{88 
$str88 &
,88& '
$str88( /
}880 1
}99 
)99 
;99 
return:: 
;:: 
};; 	
}<< 
}== è≈
>E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\CsvHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 
CsvFile 
: 
IDisposable &
{ 
public 
static 
CsvDefinition # 
DefaultCsvDefinition$ 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
static 
bool 

UseLambdas %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
static 
bool 
UseTasks #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
static 
bool 
FastIndexOfAny )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
static 
CsvFile 
( 
) 
{ 	 
DefaultCsvDefinition%%  
=%%! "
new%%# &
CsvDefinition%%' 4
{&& 
	EndOfLine'' 
='' 
$str'' "
,''" #
FieldSeparator(( 
=((  
$char((! $
,(($ %
TextQualifier)) 
=)) 
$char))  #
}** 
;** 

UseLambdas++ 
=++ 
true++ 
;++ 
UseTasks,, 
=,, 
true,, 
;,, 
FastIndexOfAny-- 
=-- 
true-- !
;--! "
}.. 	
internal22 
	protected22 
Stream22 !

BaseStream22" ,
;22, -
	protected33 
static33 
DateTime33 !
DateTimeZero33" .
=33/ 0
new331 4
DateTime335 =
(33= >
)33> ?
;33? @
public66 
static66 
IEnumerable66 !
<66! "
T66" #
>66# $
Read66% )
<66) *
T66* +
>66+ ,
(66, -
	CsvSource66- 6
	csvSource667 @
)66@ A
where66B G
T66H I
:66J K
new66L O
(66O P
)66P Q
{77 	
var88 
csvFileReader88 
=88 
new88  #
CsvFileReader88$ 1
<881 2
T882 3
>883 4
(884 5
	csvSource885 >
)88> ?
;88? @
return99 
(99 
IEnumerable99 
<99  
T99  !
>99! "
)99" #
csvFileReader99# 0
;990 1
}:: 	
public<< 
char<< 
FieldSeparator<< "
{<<# $
get<<% (
;<<( )
private<<* 1
set<<2 5
;<<5 6
}<<7 8
public== 
char== 
TextQualifier== !
{==" #
get==$ '
;==' (
private==) 0
set==1 4
;==4 5
}==6 7
public>> 
IEnumerable>> 
<>> 
String>> !
>>>! "
Columns>># *
{>>+ ,
get>>- 0
;>>0 1
private>>2 9
set>>: =
;>>= >
}>>? @
public@@ 
void@@ 
Dispose@@ 
(@@ 
)@@ 
{AA 	
DisposeBB 
(BB 
trueBB 
)BB 
;BB 
}CC 	
	protectedEE 
virtualEE 
voidEE 
DisposeEE &
(EE& '
boolEE' +
	disposingEE, 5
)EE5 6
{FF 	
}II 	
}JJ 
publicLL 

classLL 
CsvFileLL 
<LL 
TLL 
>LL 
:LL 
CsvFileLL %
{MM 
privateNN 
readonlyNN 
charNN 
fieldSeparatorNN ,
;NN, -
privateOO 
readonlyOO 
stringOO "
fieldSeparatorAsStringOO  6
;OO6 7
privatePP 
readonlyPP 
charPP 
[PP 
]PP  
invalidCharsInFieldsPP  4
;PP4 5
privateQQ 
readonlyQQ 
StreamWriterQQ %
streamWriterQQ& 2
;QQ2 3
privateRR 
readonlyRR 
charRR 
textQualifierRR +
;RR+ ,
privateSS 
readonlySS 
StringSS 
[SS  
]SS  !
columnsSS" )
;SS) *
privateTT 
FuncTT 
<TT 
TTT 
,TT 
objectTT 
>TT 
[TT  
]TT  !
gettersTT" )
;TT) *
readonlyUU 
boolUU 
[UU 
]UU !
isInvalidCharInFieldsUU -
;UU- .
privateWW 
intWW 
linesToWriteWW  
;WW  !
privateXX 
readonlyXX 
BlockingCollectionXX +
<XX+ ,
stringXX, 2
>XX2 3
csvLinesToWriteXX4 C
=XXD E
newXXF I
BlockingCollectionXXJ \
<XX\ ]
stringXX] c
>XXc d
(XXd e
$numXXe i
)XXi j
;XXj k
privateYY 
readonlyYY 
ThreadYY 
writeCsvLinesTaskYY  1
;YY1 2
privateZZ 
TaskZZ 
addAsyncTaskZZ !
;ZZ! "
public]] 
CsvFile]] 
(]] 
CsvDestination]] %
csvDestination]]& 4
)]]4 5
:^^ 
this^^ 
(^^ 
csvDestination^^ !
,^^! "
null^^# '
)^^' (
{__ 	
}`` 	
publicbb 
CsvFilebb 
(bb 
)bb 
{cc 	
}dd 	
publicff 
CsvFileff 
(ff 
CsvDestinationff %
csvDestinationff& 4
,ff4 5
CsvDefinitionff6 C
csvDefinitionffD Q
)ffQ R
{gg 	
ifhh 
(hh 
csvDefinitionhh 
==hh  
nullhh! %
)hh% &
csvDefinitionii 
=ii  
DefaultCsvDefinitionii  4
;ii4 5
thisjj 
.jj 
columnsjj 
=jj 
(jj 
csvDefinitionjj )
.jj) *
Columnsjj* 1
??jj2 4
InferColumnsjj5 A
(jjA B
typeofjjB H
(jjH I
TjjI J
)jjJ K
)jjK L
)jjL M
.jjM N
ToArrayjjN U
(jjU V
)jjV W
;jjW X
thiskk 
.kk 
fieldSeparatorkk 
=kk  !
csvDefinitionkk" /
.kk/ 0
FieldSeparatorkk0 >
;kk> ?
thisll 
.ll "
fieldSeparatorAsStringll '
=ll( )
thisll* .
.ll. /
fieldSeparatorll/ =
.ll= >
ToStringll> F
(llF G
CultureInfollG R
.llR S
InvariantCulturellS c
)llc d
;lld e
thismm 
.mm 
textQualifiermm 
=mm  
csvDefinitionmm! .
.mm. /
TextQualifiermm/ <
;mm< =
thisnn 
.nn 
streamWriternn 
=nn 
csvDestinationnn  .
.nn. /
StreamWriternn/ ;
;nn; <
thispp 
.pp  
invalidCharsInFieldspp %
=pp& '
newpp( +
[pp+ ,
]pp, -
{pp. /
$charpp0 4
,pp4 5
$charpp6 :
,pp: ;
thispp< @
.pp@ A
textQualifierppA N
,ppN O
thisppP T
.ppT U
fieldSeparatorppU c
}ppd e
;ppe f
thisqq 
.qq !
isInvalidCharInFieldsqq &
=qq' (
newqq) ,
boolqq- 1
[qq1 2
$numqq2 5
]qq5 6
;qq6 7
foreachss 
(ss 
varss 
css 
inss 
thisss "
.ss" # 
invalidCharsInFieldsss# 7
)ss7 8
{tt 
thisuu 
.uu !
isInvalidCharInFieldsuu *
[uu* +
cuu+ ,
]uu, -
=uu. /
trueuu0 4
;uu4 5
}vv 
thisww 
.ww 
WriteHeaderww 
(ww 
)ww 
;ww 
thisyy 
.yy 
CreateGettersyy 
(yy 
)yy  
;yy  !
if{{ 
({{ 
CsvFile{{ 
.{{ 
UseTasks{{  
){{  !
{|| 
writeCsvLinesTask}} !
=}}" #
new}}$ '
Thread}}( .
(}}. /
(}}/ 0
o}}0 1
)}}1 2
=>}}3 5
this}}6 :
.}}: ;
WriteCsvLines}}; H
(}}H I
)}}I J
)}}J K
;}}K L
writeCsvLinesTask~~ !
.~~! "
Start~~" '
(~~' (
)~~( )
;~~) *
} 
this
ÄÄ 
.
ÄÄ 
addAsyncTask
ÄÄ 
=
ÄÄ 
Task
ÄÄ  $
.
ÄÄ$ %
Factory
ÄÄ% ,
.
ÄÄ, -
StartNew
ÄÄ- 5
(
ÄÄ5 6
(
ÄÄ6 7
)
ÄÄ7 8
=>
ÄÄ9 ;
{
ÄÄ< =
}
ÄÄ> ?
)
ÄÄ? @
;
ÄÄ@ A
}
ÑÑ 	
	protected
ÜÜ 
override
ÜÜ 
void
ÜÜ 
Dispose
ÜÜ  '
(
ÜÜ' (
bool
ÜÜ( ,
	disposing
ÜÜ- 6
)
ÜÜ6 7
{
áá 	
if
àà 
(
àà 
	disposing
àà 
)
àà 
{
ââ 
addAsyncTask
çç 
.
çç 
Wait
çç !
(
çç! "
)
çç" #
;
çç# $
if
éé 
(
éé 
csvLinesToWrite
éé #
!=
éé$ &
null
éé' +
)
éé+ ,
{
èè 
csvLinesToWrite
êê #
.
êê# $
CompleteAdding
êê$ 2
(
êê2 3
)
êê3 4
;
êê4 5
}
ëë 
if
íí 
(
íí 
writeCsvLinesTask
íí %
!=
íí& (
null
íí) -
)
íí- .
writeCsvLinesTask
ìì %
.
ìì% &
Join
ìì& *
(
ìì* +
)
ìì+ ,
;
ìì, -
this
ïï 
.
ïï 
streamWriter
ïï !
.
ïï! "
Close
ïï" '
(
ïï' (
)
ïï( )
;
ïï) *
}
ññ 
}
óó 	
	protected
ôô 
static
ôô 
IEnumerable
ôô $
<
ôô$ %
string
ôô% +
>
ôô+ ,
InferColumns
ôô- 9
(
ôô9 :
Type
ôô: >

recordType
ôô? I
)
ôôI J
{
öö 	
var
õõ 
columns
õõ 
=
õõ 

recordType
õõ $
.
úú 
GetProperties
úú 
(
úú 
BindingFlags
úú +
.
úú+ ,
Public
úú, 2
|
úú3 4
BindingFlags
úú5 A
.
úúA B
Instance
úúB J
)
úúJ K
.
ùù 
Where
ùù 
(
ùù 
pi
ùù 
=>
ùù 
pi
ùù 
.
ùù   
GetIndexParameters
ùù  2
(
ùù2 3
)
ùù3 4
.
ùù4 5
Length
ùù5 ;
==
ùù< >
$num
ùù? @
&&
ûû 
pi
ûû 
.
ûû 
GetSetMethod
ûû &
(
ûû& '
)
ûû' (
!=
ûû) +
null
ûû, 0
&&
üü 
!
üü 
	Attribute
üü !
.
üü! "
	IsDefined
üü" +
(
üü+ ,
pi
üü, .
,
üü. /
typeof
üü0 6
(
üü6 7(
CsvIgnorePropertyAttribute
üü7 Q
)
üüQ R
)
üüR S
)
üüS T
.
†† 
Select
†† 
(
†† 
pi
†† 
=>
†† 
pi
††  
.
††  !
Name
††! %
)
††% &
.
°° 
Concat
°° 
(
°° 

recordType
°° "
.
¢¢ 
	GetFields
¢¢ 
(
¢¢ 
BindingFlags
¢¢ +
.
¢¢+ ,
Public
¢¢, 2
|
¢¢3 4
BindingFlags
¢¢5 A
.
¢¢A B
Instance
¢¢B J
)
¢¢J K
.
££ 
Where
££ 
(
££ 
fi
££ 
=>
££  
!
££! "
	Attribute
££" +
.
££+ ,
	IsDefined
££, 5
(
££5 6
fi
££6 8
,
££8 9
typeof
££: @
(
££@ A(
CsvIgnorePropertyAttribute
££A [
)
££[ \
)
££\ ]
)
££] ^
.
§§ 
Select
§§ 
(
§§ 
fi
§§ 
=>
§§ !
fi
§§" $
.
§§$ %
Name
§§% )
)
§§) *
)
§§* +
.
•• 
ToList
•• 
(
•• 
)
•• 
;
•• 
return
¶¶ 
columns
¶¶ 
;
¶¶ 
}
ßß 	
private
™™ 
void
™™ 
WriteCsvLines
™™ "
(
™™" #
)
™™# $
{
´´ 	
int
¨¨ 
written
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
csvLine
≠≠  
in
≠≠! #
csvLinesToWrite
≠≠$ 3
.
≠≠3 4$
GetConsumingEnumerable
≠≠4 J
(
≠≠J K
)
≠≠K L
)
≠≠L M
{
ÆÆ 
this
ØØ 
.
ØØ 
streamWriter
ØØ !
.
ØØ! "
	WriteLine
ØØ" +
(
ØØ+ ,
csvLine
ØØ, 3
)
ØØ3 4
;
ØØ4 5
written
∞∞ 
++
∞∞ 
;
∞∞ 
}
±± 
Interlocked
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
ref
≤≤ 
this
≤≤  $
.
≤≤$ %
linesToWrite
≤≤% 1
,
≤≤1 2
-
≤≤3 4
written
≤≤4 ;
)
≤≤; <
;
≤≤< =
}
≥≥ 	
public
∑∑ 
void
∑∑ 
Append
∑∑ 
(
∑∑ 
T
∑∑ 
record
∑∑ #
)
∑∑# $
{
∏∏ 	
if
∫∫ 
(
∫∫ 
CsvFile
∫∫ 
.
∫∫ 
UseTasks
∫∫  
)
∫∫  !
{
ªª 
var
ææ 
linesWaiting
ææ  
=
ææ! "
Interlocked
ææ# .
.
ææ. /
	Increment
ææ/ 8
(
ææ8 9
ref
ææ9 <
this
ææ= A
.
ææA B
linesToWrite
ææB N
)
ææN O
;
ææO P
Action
øø 
<
øø 
Task
øø 
>
øø 
	addRecord
øø &
=
øø' (
(
øø) *
t
øø* +
)
øø+ ,
=>
øø- /
{
¿¿ 
var
¡¡ 
csvLine
¡¡ 
=
¡¡  !
this
¡¡" &
.
¡¡& '
ToCsv
¡¡' ,
(
¡¡, -
record
¡¡- 3
)
¡¡3 4
;
¡¡4 5
this
¬¬ 
.
¬¬ 
csvLinesToWrite
¬¬ (
.
¬¬( )
Add
¬¬) ,
(
¬¬, -
csvLine
¬¬- 4
)
¬¬4 5
;
¬¬5 6
}
√√ 
;
√√ 
if
≈≈ 
(
≈≈ 
linesWaiting
≈≈  
<
≈≈! "
$num
≈≈# (
)
≈≈( )
this
∆∆ 
.
∆∆ 
addAsyncTask
∆∆ %
=
∆∆& '
this
∆∆( ,
.
∆∆, -
addAsyncTask
∆∆- 9
.
∆∆9 :
ContinueWith
∆∆: F
(
∆∆F G
	addRecord
∆∆G P
)
∆∆P Q
;
∆∆Q R
else
«« 
	addRecord
»» 
(
»» 
null
»» "
)
»»" #
;
»»# $
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
var
œœ 
csvLine
œœ 
=
œœ 
this
œœ "
.
œœ" #
ToCsv
œœ# (
(
œœ( )
record
œœ) /
)
œœ/ 0
;
œœ0 1
this
–– 
.
–– 
streamWriter
–– !
.
––! "
	WriteLine
––" +
(
––+ ,
csvLine
––, 3
)
––3 4
;
––4 5
}
—— 
}
““ 	
private
‘‘ 
static
‘‘ 
Func
‘‘ 
<
‘‘ 
T
‘‘ 
,
‘‘ 
object
‘‘ %
>
‘‘% &

FindGetter
‘‘' 1
(
‘‘1 2
string
‘‘2 8
c
‘‘9 :
,
‘‘: ;
bool
‘‘< @
staticMember
‘‘A M
)
‘‘M N
{
’’ 	
var
÷÷ 
flags
÷÷ 
=
÷÷ 
BindingFlags
÷÷ $
.
÷÷$ %
Public
÷÷% +
|
÷÷, -
BindingFlags
÷÷. :
.
÷÷: ;
	NonPublic
÷÷; D
|
÷÷E F
BindingFlags
÷÷G S
.
÷÷S T

IgnoreCase
÷÷T ^
|
÷÷_ `
(
÷÷a b
staticMember
÷÷b n
?
÷÷o p
BindingFlags
÷÷q }
.
÷÷} ~
Static÷÷~ Ñ
:÷÷Ö Ü
BindingFlags÷÷á ì
.÷÷ì î
Instance÷÷î ú
)÷÷ú ù
;÷÷ù û
Func
◊◊ 
<
◊◊ 
T
◊◊ 
,
◊◊ 
object
◊◊ 
>
◊◊ 
func
◊◊  
=
◊◊! "
null
◊◊# '
;
◊◊' (
PropertyInfo
ÿÿ 
pi
ÿÿ 
=
ÿÿ 
typeof
ÿÿ $
(
ÿÿ$ %
T
ÿÿ% &
)
ÿÿ& '
.
ÿÿ' (
GetProperty
ÿÿ( 3
(
ÿÿ3 4
c
ÿÿ4 5
,
ÿÿ5 6
flags
ÿÿ7 <
)
ÿÿ< =
;
ÿÿ= >
	FieldInfo
ŸŸ 
fi
ŸŸ 
=
ŸŸ 
typeof
ŸŸ !
(
ŸŸ! "
T
ŸŸ" #
)
ŸŸ# $
.
ŸŸ$ %
GetField
ŸŸ% -
(
ŸŸ- .
c
ŸŸ. /
,
ŸŸ/ 0
flags
ŸŸ1 6
)
ŸŸ6 7
;
ŸŸ7 8
if
€€ 
(
€€ 
CsvFile
€€ 
.
€€ 

UseLambdas
€€ "
)
€€" #
{
‹‹ 

Expression
›› 
expr
›› 
=
››  !
null
››" &
;
››& '!
ParameterExpression
ﬁﬁ #
	parameter
ﬁﬁ$ -
=
ﬁﬁ. /

Expression
ﬁﬁ0 :
.
ﬁﬁ: ;
	Parameter
ﬁﬁ; D
(
ﬁﬁD E
typeof
ﬁﬁE K
(
ﬁﬁK L
T
ﬁﬁL M
)
ﬁﬁM N
,
ﬁﬁN O
$str
ﬁﬁP S
)
ﬁﬁS T
;
ﬁﬁT U
Type
ﬂﬂ 
type
ﬂﬂ 
=
ﬂﬂ 
null
ﬂﬂ  
;
ﬂﬂ  !
if
·· 
(
·· 
pi
·· 
!=
·· 
null
·· 
)
·· 
{
‚‚ 
type
„„ 
=
„„ 
pi
„„ 
.
„„ 
PropertyType
„„ *
;
„„* +
expr
‰‰ 
=
‰‰ 

Expression
‰‰ %
.
‰‰% &
Property
‰‰& .
(
‰‰. /
	parameter
‰‰/ 8
,
‰‰8 9
pi
‰‰: <
.
‰‰< =
Name
‰‰= A
)
‰‰A B
;
‰‰B C
}
ÂÂ 
else
ÊÊ 
if
ÊÊ 
(
ÊÊ 
fi
ÊÊ 
!=
ÊÊ 
null
ÊÊ #
)
ÊÊ# $
{
ÁÁ 
type
ËË 
=
ËË 
fi
ËË 
.
ËË 
	FieldType
ËË '
;
ËË' (
expr
ÈÈ 
=
ÈÈ 

Expression
ÈÈ %
.
ÈÈ% &
Field
ÈÈ& +
(
ÈÈ+ ,
	parameter
ÈÈ, 5
,
ÈÈ5 6
fi
ÈÈ7 9
.
ÈÈ9 :
Name
ÈÈ: >
)
ÈÈ> ?
;
ÈÈ? @
}
ÍÍ 
if
ÎÎ 
(
ÎÎ 
expr
ÎÎ 
!=
ÎÎ 
null
ÎÎ  
)
ÎÎ  !
{
ÏÏ 

Expression
ÌÌ 
<
ÌÌ 
Func
ÌÌ #
<
ÌÌ# $
T
ÌÌ$ %
,
ÌÌ% &
object
ÌÌ' -
>
ÌÌ- .
>
ÌÌ. /
lambda
ÌÌ0 6
;
ÌÌ6 7
if
ÓÓ 
(
ÓÓ 
type
ÓÓ 
.
ÓÓ 
IsValueType
ÓÓ (
)
ÓÓ( )
{
ÔÔ 
lambda
 
=
  

Expression
! +
.
+ ,
Lambda
, 2
<
2 3
Func
3 7
<
7 8
T
8 9
,
9 :
object
; A
>
A B
>
B C
(
C D

Expression
D N
.
N O
TypeAs
O U
(
U V
expr
V Z
,
Z [
typeof
\ b
(
b c
object
c i
)
i j
)
j k
,
k l
	parameter
m v
)
v w
;
w x
}
ÒÒ 
else
ÚÚ 
{
ÛÛ 
lambda
ÙÙ 
=
ÙÙ  

Expression
ÙÙ! +
.
ÙÙ+ ,
Lambda
ÙÙ, 2
<
ÙÙ2 3
Func
ÙÙ3 7
<
ÙÙ7 8
T
ÙÙ8 9
,
ÙÙ9 :
object
ÙÙ; A
>
ÙÙA B
>
ÙÙB C
(
ÙÙC D
expr
ÙÙD H
,
ÙÙH I
	parameter
ÙÙJ S
)
ÙÙS T
;
ÙÙT U
}
ıı 
func
ˆˆ 
=
ˆˆ 
lambda
ˆˆ !
.
ˆˆ! "
Compile
ˆˆ" )
(
ˆˆ) *
)
ˆˆ* +
;
ˆˆ+ ,
}
˜˜ 
}
¯¯ 
else
˘˘ 
{
˙˙ 
if
˚˚ 
(
˚˚ 
pi
˚˚ 
!=
˚˚ 
null
˚˚ 
)
˚˚ 
func
¸¸ 
=
¸¸ 
o
¸¸ 
=>
¸¸ 
pi
¸¸  "
.
¸¸" #
GetValue
¸¸# +
(
¸¸+ ,
o
¸¸, -
,
¸¸- .
null
¸¸/ 3
)
¸¸3 4
;
¸¸4 5
else
˝˝ 
if
˝˝ 
(
˝˝ 
fi
˝˝ 
!=
˝˝ 
null
˝˝ #
)
˝˝# $
func
˛˛ 
=
˛˛ 
o
˛˛ 
=>
˛˛ 
fi
˛˛  "
.
˛˛" #
GetValue
˛˛# +
(
˛˛+ ,
o
˛˛, -
)
˛˛- .
;
˛˛. /
}
ˇˇ 
return
ÄÄ 
func
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
void
ÉÉ 
CreateGetters
ÉÉ "
(
ÉÉ" #
)
ÉÉ# $
{
ÑÑ 	
var
ÖÖ 
list
ÖÖ 
=
ÖÖ 
new
ÖÖ 
List
ÖÖ 
<
ÖÖ  
Func
ÖÖ  $
<
ÖÖ$ %
T
ÖÖ% &
,
ÖÖ& '
object
ÖÖ( .
>
ÖÖ. /
>
ÖÖ/ 0
(
ÖÖ0 1
)
ÖÖ1 2
;
ÖÖ2 3
foreach
áá 
(
áá 
var
áá 

columnName
áá #
in
áá$ &
columns
áá' .
)
áá. /
{
àà 
Func
ââ 
<
ââ 
T
ââ 
,
ââ 
Object
ââ 
>
ââ 
func
ââ  $
=
ââ% &
null
ââ' +
;
ââ+ ,
var
ää 
propertyName
ää  
=
ää! "
(
ää# $

columnName
ää$ .
.
ää. /
IndexOf
ää/ 6
(
ää6 7
$char
ää7 :
)
ää: ;
<
ää< =
$num
ää> ?
?
ää@ A

columnName
ääB L
:
ääM N

columnName
ääO Y
.
ääY Z
Replace
ääZ a
(
ääa b
$str
ääb e
,
ääe f
$str
ääg i
)
ääi j
)
ääj k
;
ääk l
func
ãã 
=
ãã 

FindGetter
ãã !
(
ãã! "

columnName
ãã" ,
,
ãã, -
false
ãã. 3
)
ãã3 4
??
ãã5 7

FindGetter
ãã8 B
(
ããB C

columnName
ããC M
,
ããM N
true
ããO S
)
ããS T
;
ããT U
list
çç 
.
çç 
Add
çç 
(
çç 
func
çç 
)
çç 
;
çç 
}
éé 
this
èè 
.
èè 
getters
èè 
=
èè 
list
èè 
.
èè  
ToArray
èè  '
(
èè' (
)
èè( )
;
èè) *
}
êê 	
private
íí 
string
íí 
ToCsv
íí 
(
íí 
T
íí 
record
íí %
)
íí% &
{
ìì 	
if
îî 
(
îî 
record
îî 
==
îî 
null
îî 
)
îî 
throw
ïï 
new
ïï 
AdsException
ïï &
(
ïï& '
$str
ïï' 7
,
ïï7 8
$str
ïï9 A
)
ïïA B
;
ïïB C
string
óó 
[
óó 
]
óó 

csvStrings
óó 
=
óó  !
new
óó" %
string
óó& ,
[
óó, -
getters
óó- 4
.
óó4 5
Length
óó5 ;
]
óó; <
;
óó< =
for
ôô 
(
ôô 
int
ôô 
i
ôô 
=
ôô 
$num
ôô 
;
ôô 
i
ôô 
<
ôô 
getters
ôô  '
.
ôô' (
Length
ôô( .
;
ôô. /
i
ôô0 1
++
ôô1 3
)
ôô3 4
{
öö 
var
õõ 
getter
õõ 
=
õõ 
getters
õõ $
[
õõ$ %
i
õõ% &
]
õõ& '
;
õõ' (
object
úú 

fieldValue
úú !
=
úú" #
getter
úú$ *
==
úú+ -
null
úú. 2
?
úú3 4
null
úú5 9
:
úú: ;
getter
úú< B
(
úúB C
record
úúC I
)
úúI J
;
úúJ K

csvStrings
ùù 
[
ùù 
i
ùù 
]
ùù 
=
ùù 
this
ùù  $
.
ùù$ %
ToCsvString
ùù% 0
(
ùù0 1

fieldValue
ùù1 ;
)
ùù; <
;
ùù< =
}
ûû 
return
üü 
string
üü 
.
üü 
Join
üü 
(
üü 
this
üü #
.
üü# $$
fieldSeparatorAsString
üü$ :
,
üü: ;

csvStrings
üü< F
)
üüF G
;
üüG H
}
°° 	
private
££ 
string
££ 
ToCsvString
££ "
(
££" #
object
££# )
o
££* +
)
££+ ,
{
§§ 	
if
•• 
(
•• 
o
•• 
!=
•• 
null
•• 
)
•• 
{
¶¶ 
string
ßß 
valueString
ßß "
=
ßß# $
o
ßß% &
as
ßß' )
string
ßß* 0
??
ßß1 3
Convert
ßß4 ;
.
ßß; <
ToString
ßß< D
(
ßßD E
o
ßßE F
,
ßßF G
CultureInfo
ßßH S
.
ßßS T
CurrentUICulture
ßßT d
)
ßßd e
;
ßße f
if
®® 
(
®® 
RequiresQuotes
®® "
(
®®" #
valueString
®®# .
)
®®. /
)
®®/ 0
{
©© 
var
™™ 
csvLine
™™ 
=
™™  !
new
™™" %
StringBuilder
™™& 3
(
™™3 4
)
™™4 5
;
™™5 6
csvLine
´´ 
.
´´ 
Append
´´ "
(
´´" #
this
´´# '
.
´´' (
textQualifier
´´( 5
)
´´5 6
;
´´6 7
foreach
¨¨ 
(
¨¨ 
char
¨¨ !
c
¨¨" #
in
¨¨$ &
valueString
¨¨' 2
)
¨¨2 3
{
≠≠ 
if
ÆÆ 
(
ÆÆ 
c
ÆÆ 
==
ÆÆ  
this
ÆÆ! %
.
ÆÆ% &
textQualifier
ÆÆ& 3
)
ÆÆ3 4
csvLine
ØØ #
.
ØØ# $
Append
ØØ$ *
(
ØØ* +
c
ØØ+ ,
)
ØØ, -
;
ØØ- .
csvLine
±± 
.
±±  
Append
±±  &
(
±±& '
c
±±' (
)
±±( )
;
±±) *
}
≤≤ 
csvLine
≥≥ 
.
≥≥ 
Append
≥≥ "
(
≥≥" #
this
≥≥# '
.
≥≥' (
textQualifier
≥≥( 5
)
≥≥5 6
;
≥≥6 7
return
¥¥ 
csvLine
¥¥ "
.
¥¥" #
ToString
¥¥# +
(
¥¥+ ,
)
¥¥, -
;
¥¥- .
}
µµ 
else
∂∂ 
return
∑∑ 
valueString
∑∑ &
;
∑∑& '
}
∏∏ 
return
ππ 
string
ππ 
.
ππ 
Empty
ππ 
;
ππ  
}
∫∫ 	
private
ºº 
bool
ºº 
RequiresQuotes
ºº #
(
ºº# $
string
ºº$ *
valueString
ºº+ 6
)
ºº6 7
{
ΩΩ 	
if
ææ 
(
ææ 
CsvFile
ææ 
.
ææ 
FastIndexOfAny
ææ &
)
ææ& '
{
øø 
var
¿¿ 
len
¿¿ 
=
¿¿ 
valueString
¿¿ %
.
¿¿% &
Length
¿¿& ,
;
¿¿, -
for
¡¡ 
(
¡¡ 
int
¡¡ 
i
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
i
¡¡  !
<
¡¡" #
len
¡¡$ '
;
¡¡' (
i
¡¡) *
++
¡¡* ,
)
¡¡, -
{
¬¬ 
char
√√ 
c
√√ 
=
√√ 
valueString
√√ (
[
√√( )
i
√√) *
]
√√* +
;
√√+ ,
if
ƒƒ 
(
ƒƒ 
c
ƒƒ 
<=
ƒƒ 
$num
ƒƒ  
&&
ƒƒ! #
this
ƒƒ$ (
.
ƒƒ( )#
isInvalidCharInFields
ƒƒ) >
[
ƒƒ> ?
c
ƒƒ? @
]
ƒƒ@ A
)
ƒƒA B
return
≈≈ 
true
≈≈ #
;
≈≈# $
}
∆∆ 
return
«« 
false
«« 
;
«« 
}
»» 
else
…… 
{
   
return
ÀÀ 
valueString
ÀÀ "
.
ÀÀ" #

IndexOfAny
ÀÀ# -
(
ÀÀ- .
this
ÀÀ. 2
.
ÀÀ2 3"
invalidCharsInFields
ÀÀ3 G
)
ÀÀG H
>=
ÀÀI K
$num
ÀÀL M
;
ÀÀM N
}
ÃÃ 
}
ÕÕ 	
private
œœ 
void
œœ 
WriteHeader
œœ  
(
œœ  !
)
œœ! "
{
–– 	
var
—— 
csvLine
—— 
=
—— 
new
—— 
StringBuilder
—— +
(
——+ ,
)
——, -
;
——- .
for
““ 
(
““ 
int
““ 
i
““ 
=
““ 
$num
““ 
;
““ 
i
““ 
<
““ 
this
““  $
.
““$ %
columns
““% ,
.
““, -
Length
““- 3
;
““3 4
i
““5 6
++
““6 8
)
““8 9
{
”” 
if
‘‘ 
(
‘‘ 
i
‘‘ 
>
‘‘ 
$num
‘‘ 
)
‘‘ 
csvLine
’’ 
.
’’ 
Append
’’ "
(
’’" #
this
’’# '
.
’’' (
fieldSeparator
’’( 6
)
’’6 7
;
’’7 8
csvLine
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
this
÷÷ #
.
÷÷# $
ToCsvString
÷÷$ /
(
÷÷/ 0
this
÷÷0 4
.
÷÷4 5
columns
÷÷5 <
[
÷÷< =
i
÷÷= >
]
÷÷> ?
)
÷÷? @
)
÷÷@ A
;
÷÷A B
}
◊◊ 
this
ÿÿ 
.
ÿÿ 
streamWriter
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ '
(
ÿÿ' (
csvLine
ÿÿ( /
.
ÿÿ/ 0
ToString
ÿÿ0 8
(
ÿÿ8 9
)
ÿÿ9 :
)
ÿÿ: ;
;
ÿÿ; <
}
ŸŸ 	
}
⁄⁄ 
internal
‹‹ 
class
‹‹ 
CsvFileReader
‹‹  
<
‹‹  !
T
‹‹! "
>
‹‹" #
:
‹‹$ %
CsvFile
‹‹& -
,
‹‹- .
IEnumerable
‹‹/ :
<
‹‹: ;
T
‹‹; <
>
‹‹< =
,
‹‹= >
IEnumerator
‹‹? J
<
‹‹J K
T
‹‹K L
>
‹‹L M
where
›› 

T
›› 
:
›› 
new
›› 
(
›› 
)
›› 
{
ﬁﬁ 
private
ﬂﬂ 
readonly
ﬂﬂ 

Dictionary
ﬂﬂ #
<
ﬂﬂ# $
Type
ﬂﬂ$ (
,
ﬂﬂ( )
List
ﬂﬂ* .
<
ﬂﬂ. /
Action
ﬂﬂ/ 5
<
ﬂﬂ5 6
T
ﬂﬂ6 7
,
ﬂﬂ7 8
String
ﬂﬂ9 ?
>
ﬂﬂ? @
>
ﬂﬂ@ A
>
ﬂﬂA B

allSetters
ﬂﬂC M
=
ﬂﬂN O
new
ﬂﬂP S

Dictionary
ﬂﬂT ^
<
ﬂﬂ^ _
Type
ﬂﬂ_ c
,
ﬂﬂc d
List
ﬂﬂe i
<
ﬂﬂi j
Action
ﬂﬂj p
<
ﬂﬂp q
T
ﬂﬂq r
,
ﬂﬂr s
String
ﬂﬂt z
>
ﬂﬂz {
>
ﬂﬂ{ |
>
ﬂﬂ| }
(
ﬂﬂ} ~
)
ﬂﬂ~ 
;ﬂﬂ Ä
private
‡‡ 
string
‡‡ 
[
‡‡ 
]
‡‡ 
columns
‡‡  
;
‡‡  !
private
·· 
char
·· 
curChar
·· 
;
·· 
private
‚‚ 
int
‚‚ 
len
‚‚ 
;
‚‚ 
private
„„ 
string
„„ 
line
„„ 
;
„„ 
private
‰‰ 
int
‰‰ 
pos
‰‰ 
;
‰‰ 
private
ÂÂ 
T
ÂÂ 
record
ÂÂ 
;
ÂÂ 
private
ÊÊ 
readonly
ÊÊ 
char
ÊÊ 
fieldSeparator
ÊÊ ,
;
ÊÊ, -
private
ÁÁ 
readonly
ÁÁ 

TextReader
ÁÁ #

textReader
ÁÁ$ .
;
ÁÁ. /
private
ËË 
readonly
ËË 
char
ËË 
textQualifier
ËË +
;
ËË+ ,
private
ÈÈ 
readonly
ÈÈ 
StringBuilder
ÈÈ &
parseFieldResult
ÈÈ' 7
=
ÈÈ8 9
new
ÈÈ: =
StringBuilder
ÈÈ> K
(
ÈÈK L
)
ÈÈL M
;
ÈÈM N
public
ÎÎ 
CsvFileReader
ÎÎ 
(
ÎÎ 
	CsvSource
ÎÎ &
	csvSource
ÎÎ' 0
)
ÎÎ0 1
:
ÏÏ 
this
ÏÏ 
(
ÏÏ 
	csvSource
ÏÏ 
,
ÏÏ 
null
ÏÏ "
)
ÏÏ" #
{
ÌÌ 	
}
ÓÓ 	
public
 
CsvFileReader
 
(
 
	CsvSource
 &
	csvSource
' 0
,
0 1
CsvDefinition
2 ?
csvDefinition
@ M
)
M N
{
ÒÒ 	
var
ÚÚ 
streamReader
ÚÚ 
=
ÚÚ 
	csvSource
ÚÚ (
.
ÚÚ( )

TextReader
ÚÚ) 3
as
ÚÚ4 6
StreamReader
ÚÚ7 C
;
ÚÚC D
if
ÛÛ 
(
ÛÛ 
streamReader
ÛÛ 
!=
ÛÛ 
null
ÛÛ  $
)
ÛÛ$ %
this
ÙÙ 
.
ÙÙ 

BaseStream
ÙÙ 
=
ÙÙ  !
streamReader
ÙÙ" .
.
ÙÙ. /

BaseStream
ÙÙ/ 9
;
ÙÙ9 :
if
ıı 
(
ıı 
csvDefinition
ıı 
==
ıı  
null
ıı! %
)
ıı% &
csvDefinition
ˆˆ 
=
ˆˆ "
DefaultCsvDefinition
ˆˆ  4
;
ˆˆ4 5
this
˜˜ 
.
˜˜ 
fieldSeparator
˜˜ 
=
˜˜  !
csvDefinition
˜˜" /
.
˜˜/ 0
FieldSeparator
˜˜0 >
;
˜˜> ?
this
¯¯ 
.
¯¯ 
textQualifier
¯¯ 
=
¯¯  
csvDefinition
¯¯! .
.
¯¯. /
TextQualifier
¯¯/ <
;
¯¯< =
this
˙˙ 
.
˙˙ 

textReader
˙˙ 
=
˙˙ 
	csvSource
˙˙ '
.
˙˙' (

TextReader
˙˙( 2
;
˙˙2 3
this
˝˝ 
.
˝˝ 

ReadHeader
˝˝ 
(
˝˝ 
csvDefinition
˝˝ )
.
˝˝) *
Header
˝˝* 0
)
˝˝0 1
;
˝˝1 2
}
ˇˇ 	
public
ÅÅ 
T
ÅÅ 
Current
ÅÅ 
{
ÇÇ 	
get
ÉÉ 
{
ÉÉ 
return
ÉÉ 
this
ÉÉ 
.
ÉÉ 
record
ÉÉ $
;
ÉÉ$ %
}
ÉÉ& '
}
ÑÑ 	
public
ÜÜ 
bool
ÜÜ 
Eof
ÜÜ 
{
áá 	
get
àà 
{
àà 
return
àà 
this
àà 
.
àà 
line
àà "
==
àà# %
null
àà& *
;
àà* +
}
àà, -
}
ââ 	
object
ãã 
IEnumerator
ãã 
.
ãã 
Current
ãã "
{
åå 	
get
çç 
{
çç 
return
çç 
this
çç 
.
çç 
Current
çç %
;
çç% &
}
çç' (
}
éé 	
	protected
êê 
override
êê 
void
êê 
Dispose
êê  '
(
êê' (
bool
êê( ,
	disposing
êê- 6
)
êê6 7
{
ëë 	
if
íí 
(
íí 
	disposing
íí 
)
íí 
{
ìì 
this
ññ 
.
ññ 

textReader
ññ 
.
ññ  
Dispose
ññ  '
(
ññ' (
)
ññ( )
;
ññ) *
}
óó 
}
òò 	
IEnumerator
öö 
IEnumerable
öö 
.
öö  
GetEnumerator
öö  -
(
öö- .
)
öö. /
{
õõ 	
return
úú 
this
úú 
.
úú 
GetEnumerator
úú %
(
úú% &
)
úú& '
;
úú' (
}
ùù 	
public
üü 
IEnumerator
üü 
<
üü 
T
üü 
>
üü 
GetEnumerator
üü +
(
üü+ ,
)
üü, -
{
†† 	
return
°° 
this
°° 
;
°° 
}
¢¢ 	
public
§§ 
bool
§§ 
MoveNext
§§ 
(
§§ 
)
§§ 
{
•• 	
this
¶¶ 
.
¶¶ 
ReadNextLine
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶  
if
ßß 
(
ßß 
this
ßß 
.
ßß 
line
ßß 
==
ßß 
null
ßß !
&&
ßß" $
(
ßß% &
this
ßß& *
.
ßß* +
line
ßß+ /
=
ßß0 1
this
ßß2 6
.
ßß6 7

textReader
ßß7 A
.
ßßA B
ReadLine
ßßB J
(
ßßJ K
)
ßßK L
)
ßßL M
==
ßßN P
null
ßßQ U
)
ßßU V
{
®® 
this
©© 
.
©© 
record
©© 
=
©© 
default
©© %
(
©©% &
T
©©& '
)
©©' (
;
©©( )
}
™™ 
else
´´ 
{
¨¨ 
this
≠≠ 
.
≠≠ 
record
≠≠ 
=
≠≠ 
new
≠≠ !
T
≠≠" #
(
≠≠# $
)
≠≠$ %
;
≠≠% &
Type
ÆÆ 

recordType
ÆÆ 
=
ÆÆ  !
typeof
ÆÆ" (
(
ÆÆ( )
T
ÆÆ) *
)
ÆÆ* +
;
ÆÆ+ ,
List
ØØ 
<
ØØ 
Action
ØØ 
<
ØØ 
T
ØØ 
,
ØØ 
String
ØØ %
>
ØØ% &
>
ØØ& '
setters
ØØ( /
;
ØØ/ 0
if
∞∞ 
(
∞∞ 
!
∞∞ 
this
∞∞ 
.
∞∞ 

allSetters
∞∞ $
.
∞∞$ %
TryGetValue
∞∞% 0
(
∞∞0 1

recordType
∞∞1 ;
,
∞∞; <
out
∞∞= @
setters
∞∞A H
)
∞∞H I
)
∞∞I J
{
±± 
setters
≤≤ 
=
≤≤ 
this
≤≤ "
.
≤≤" #
CreateSetters
≤≤# 0
(
≤≤0 1
)
≤≤1 2
;
≤≤2 3
this
≥≥ 
.
≥≥ 

allSetters
≥≥ #
[
≥≥# $

recordType
≥≥$ .
]
≥≥. /
=
≥≥0 1
setters
≥≥2 9
;
≥≥9 :
}
¥¥ 
var
∂∂ 
fieldValues
∂∂ 
=
∂∂  !
new
∂∂" %
string
∂∂& ,
[
∂∂, -
setters
∂∂- 4
.
∂∂4 5
Count
∂∂5 :
]
∂∂: ;
;
∂∂; <
for
∑∑ 
(
∑∑ 
int
∑∑ 
i
∑∑ 
=
∑∑ 
$num
∑∑ 
;
∑∑ 
i
∑∑  !
<
∑∑" #
setters
∑∑$ +
.
∑∑+ ,
Count
∑∑, 1
;
∑∑1 2
i
∑∑3 4
++
∑∑4 6
)
∑∑6 7
{
∏∏ 
fieldValues
ππ 
[
ππ  
i
ππ  !
]
ππ! "
=
ππ# $
this
ππ% )
.
ππ) *

ParseField
ππ* 4
(
ππ4 5
)
ππ5 6
;
ππ6 7
if
∫∫ 
(
∫∫ 
this
∫∫ 
.
∫∫ 
curChar
∫∫ $
==
∫∫% '
this
∫∫( ,
.
∫∫, -
fieldSeparator
∫∫- ;
)
∫∫; <
this
ªª 
.
ªª 
NextChar
ªª %
(
ªª% &
)
ªª& '
;
ªª' (
else
ºº 
break
ΩΩ 
;
ΩΩ 
}
ææ 
for
øø 
(
øø 
int
øø 
i
øø 
=
øø 
$num
øø 
;
øø 
i
øø  !
<
øø" #
setters
øø$ +
.
øø+ ,
Count
øø, 1
;
øø1 2
i
øø3 4
++
øø4 6
)
øø6 7
{
¿¿ 
var
¡¡ 
setter
¡¡ 
=
¡¡  
setters
¡¡! (
[
¡¡( )
i
¡¡) *
]
¡¡* +
;
¡¡+ ,
if
¬¬ 
(
¬¬ 
setter
¬¬ 
!=
¬¬ !
null
¬¬" &
)
¬¬& '
{
√√ 
setter
ƒƒ 
(
ƒƒ 
this
ƒƒ #
.
ƒƒ# $
record
ƒƒ$ *
,
ƒƒ* +
fieldValues
ƒƒ, 7
[
ƒƒ7 8
i
ƒƒ8 9
]
ƒƒ9 :
)
ƒƒ: ;
;
ƒƒ; <
}
≈≈ 
}
∆∆ 
}
«« 
return
»» 
(
»» 
this
»» 
.
»» 
record
»» 
!=
»»  "
null
»»# '
)
»»' (
;
»»( )
}
…… 	
public
ÃÃ 
void
ÃÃ 
Reset
ÃÃ 
(
ÃÃ 
)
ÃÃ 
{
ÕÕ 	
throw
ŒŒ 
new
ŒŒ %
NotImplementedException
ŒŒ -
(
ŒŒ- .
$str
ŒŒ. W
)
ŒŒW X
;
ŒŒX Y
}
œœ 	
private
—— 
static
—— 
Action
—— 
<
—— 
T
—— 
,
——  
string
——! '
>
——' ( 
EmitSetValueAction
——) ;
(
——; <

MemberInfo
——< F
mi
——G I
,
——I J
Func
——K O
<
——O P
string
——P V
,
——V W
object
——X ^
>
——^ _
func
——` d
)
——d e
{
““ 	!
ParameterExpression
”” 
paramExpObj
””  +
=
””, -

Expression
””. 8
.
””8 9
	Parameter
””9 B
(
””B C
typeof
””C I
(
””I J
object
””J P
)
””P Q
,
””Q R
$str
””S X
)
””X Y
;
””Y Z!
ParameterExpression
‘‘ 
	paramExpT
‘‘  )
=
‘‘* +

Expression
‘‘, 6
.
‘‘6 7
	Parameter
‘‘7 @
(
‘‘@ A
typeof
‘‘A G
(
‘‘G H
T
‘‘H I
)
‘‘I J
,
‘‘J K
$str
‘‘L V
)
‘‘V W
;
‘‘W X
{
÷÷ 
var
◊◊ 
pi
◊◊ 
=
◊◊ 
mi
◊◊ 
as
◊◊ 
PropertyInfo
◊◊ +
;
◊◊+ ,
if
ÿÿ 
(
ÿÿ 
pi
ÿÿ 
!=
ÿÿ 
null
ÿÿ 
)
ÿÿ 
{
ŸŸ 
if
€€ 
(
€€ 
CsvFile
€€ 
.
€€  

UseLambdas
€€  *
)
€€* +
{
‹‹ 
var
›› 
callExpr
›› $
=
››% &

Expression
››' 1
.
››1 2
Call
››2 6
(
››6 7
	paramExpT
ﬁﬁ %
,
ﬁﬁ% &
pi
ﬂﬂ 
.
ﬂﬂ 
GetSetMethod
ﬂﬂ +
(
ﬂﬂ+ ,
)
ﬂﬂ, -
,
ﬂﬂ- .

Expression
‡‡ &
.
‡‡& '
ConvertChecked
‡‡' 5
(
‡‡5 6
paramExpObj
‡‡6 A
,
‡‡A B
pi
‡‡C E
.
‡‡E F
PropertyType
‡‡F R
)
‡‡R S
)
‡‡S T
;
‡‡T U
var
·· 
setter
·· "
=
··# $

Expression
··% /
.
··/ 0
Lambda
··0 6
<
··6 7
Action
··7 =
<
··= >
T
··> ?
,
··? @
object
··A G
>
··G H
>
··H I
(
··I J
callExpr
‚‚ $
,
‚‚$ %
	paramExpT
„„ %
,
„„% &
paramExpObj
‰‰ '
)
‰‰' (
.
‰‰( )
Compile
‰‰) 0
(
‰‰0 1
)
‰‰1 2
;
‰‰2 3
return
ÂÂ 
(
ÂÂ  
o
ÂÂ  !
,
ÂÂ! "
s
ÂÂ# $
)
ÂÂ$ %
=>
ÂÂ& (
setter
ÂÂ) /
(
ÂÂ/ 0
o
ÂÂ0 1
,
ÂÂ1 2
func
ÂÂ3 7
(
ÂÂ7 8
s
ÂÂ8 9
)
ÂÂ9 :
)
ÂÂ: ;
;
ÂÂ; <
}
ÊÊ 
return
ËË 
(
ËË 
o
ËË 
,
ËË 
v
ËË  
)
ËË  !
=>
ËË" $
pi
ËË% '
.
ËË' (
SetValue
ËË( 0
(
ËË0 1
o
ËË1 2
,
ËË2 3
(
ËË4 5
object
ËË5 ;
)
ËË; <
func
ËË< @
(
ËË@ A
v
ËËA B
)
ËËB C
,
ËËC D
null
ËËE I
)
ËËI J
;
ËËJ K
}
ÍÍ 
}
ÎÎ 
{
ÏÏ 
var
ÌÌ 
fi
ÌÌ 
=
ÌÌ 
mi
ÌÌ 
as
ÌÌ 
	FieldInfo
ÌÌ (
;
ÌÌ( )
if
ÓÓ 
(
ÓÓ 
fi
ÓÓ 
!=
ÓÓ 
null
ÓÓ 
)
ÓÓ 
{
ÔÔ 
if
ÒÒ 
(
ÒÒ 
CsvFile
ÒÒ 
.
ÒÒ  

UseLambdas
ÒÒ  *
)
ÒÒ* +
{
ÚÚ 
var
ıı 
valueExp
ıı $
=
ıı% &

Expression
ıı' 1
.
ıı1 2
ConvertChecked
ıı2 @
(
ıı@ A
paramExpObj
ııA L
,
ııL M
fi
ııN P
.
ııP Q
	FieldType
ııQ Z
)
ııZ [
;
ıı[ \
MemberExpression
˘˘ (
fieldExp
˘˘) 1
=
˘˘2 3

Expression
˘˘4 >
.
˘˘> ?
Field
˘˘? D
(
˘˘D E
	paramExpT
˘˘E N
,
˘˘N O
fi
˘˘P R
)
˘˘R S
;
˘˘S T
BinaryExpression
˙˙ (
	assignExp
˙˙) 2
=
˙˙3 4

Expression
˙˙5 ?
.
˙˙? @
Assign
˙˙@ F
(
˙˙F G
fieldExp
˙˙G O
,
˙˙O P
valueExp
˙˙Q Y
)
˙˙Y Z
;
˙˙Z [
var
¸¸ 
setter
¸¸ "
=
¸¸# $

Expression
¸¸% /
.
¸¸/ 0
Lambda
¸¸0 6
<
¸¸6 7
Action
¸¸7 =
<
¸¸= >
T
¸¸> ?
,
¸¸? @
object
¸¸A G
>
¸¸G H
>
¸¸H I
(
˝˝ 
	assignExp
˝˝ &
,
˝˝& '
	paramExpT
˝˝( 1
,
˝˝1 2
paramExpObj
˝˝3 >
)
˝˝> ?
.
˝˝? @
Compile
˝˝@ G
(
˝˝G H
)
˝˝H I
;
˝˝I J
return
ˇˇ 
(
ˇˇ  
o
ˇˇ  !
,
ˇˇ! "
s
ˇˇ# $
)
ˇˇ$ %
=>
ˇˇ& (
setter
ˇˇ) /
(
ˇˇ/ 0
o
ˇˇ0 1
,
ˇˇ1 2
func
ˇˇ3 7
(
ˇˇ7 8
s
ˇˇ8 9
)
ˇˇ9 :
)
ˇˇ: ;
;
ˇˇ; <
}
ÄÄ 
return
ÇÇ 
(
ÇÇ 
(
ÇÇ 
o
ÇÇ 
,
ÇÇ 
v
ÇÇ  !
)
ÇÇ! "
=>
ÇÇ# %
fi
ÇÇ& (
.
ÇÇ( )
SetValue
ÇÇ) 1
(
ÇÇ1 2
o
ÇÇ2 3
,
ÇÇ3 4
func
ÇÇ5 9
(
ÇÇ9 :
v
ÇÇ: ;
)
ÇÇ; <
)
ÇÇ< =
)
ÇÇ= >
;
ÇÇ> ?
}
ÉÉ 
}
ÑÑ 
throw
ÖÖ 
new
ÖÖ %
NotImplementedException
ÖÖ -
(
ÖÖ- .
)
ÖÖ. /
;
ÖÖ/ 0
}
ÜÜ 	
private
àà 
static
àà 
Action
àà 
<
àà 
T
àà 
,
àà  
string
àà! '
>
àà' (

FindSetter
àà) 3
(
àà3 4
string
àà4 :
c
àà; <
,
àà< =
bool
àà> B
staticMember
ààC O
)
ààO P
{
ââ 	
var
ää 
flags
ää 
=
ää 
BindingFlags
ää $
.
ää$ %
Public
ää% +
|
ää, -
BindingFlags
ää. :
.
ää: ;
	NonPublic
ää; D
|
ääE F
BindingFlags
ääG S
.
ääS T

IgnoreCase
ääT ^
|
ää_ `
(
ääa b
staticMember
ääb n
?
ääo p
BindingFlags
ääq }
.
ää} ~
Staticää~ Ñ
:ääÖ Ü
BindingFlagsääá ì
.ääì î
Instanceääî ú
)ääú ù
;ääù û
Action
ãã 
<
ãã 
T
ãã 
,
ãã 
string
ãã 
>
ãã 
action
ãã $
=
ãã% &
null
ãã' +
;
ãã+ ,
PropertyInfo
åå 
pi
åå 
=
åå 
typeof
åå $
(
åå$ %
T
åå% &
)
åå& '
.
åå' (
GetProperty
åå( 3
(
åå3 4
c
åå4 5
,
åå5 6
flags
åå7 <
)
åå< =
;
åå= >
if
çç 
(
çç 
pi
çç 
!=
çç 
null
çç 
)
çç 
{
éé 
var
èè 
pFunc
èè 
=
èè 
StringToObject
èè *
(
èè* +
pi
èè+ -
.
èè- .
PropertyType
èè. :
)
èè: ;
;
èè; <
action
êê 
=
êê  
EmitSetValueAction
êê +
(
êê+ ,
pi
êê, .
,
êê. /
pFunc
êê0 5
)
êê5 6
;
êê6 7
}
ëë 
	FieldInfo
íí 
fi
íí 
=
íí 
typeof
íí !
(
íí! "
T
íí" #
)
íí# $
.
íí$ %
GetField
íí% -
(
íí- .
c
íí. /
,
íí/ 0
flags
íí1 6
)
íí6 7
;
íí7 8
if
ìì 
(
ìì 
fi
ìì 
!=
ìì 
null
ìì 
)
ìì 
{
îî 
var
ïï 
fFunc
ïï 
=
ïï 
StringToObject
ïï *
(
ïï* +
fi
ïï+ -
.
ïï- .
	FieldType
ïï. 7
)
ïï7 8
;
ïï8 9
action
ññ 
=
ññ  
EmitSetValueAction
ññ +
(
ññ+ ,
fi
ññ, .
,
ññ. /
fFunc
ññ0 5
)
ññ5 6
;
ññ6 7
}
óó 
return
òò 
action
òò 
;
òò 
}
ôô 	
private
õõ 
static
õõ 
Func
õõ 
<
õõ 
string
õõ "
,
õõ" #
object
õõ$ *
>
õõ* +
StringToObject
õõ, :
(
õõ: ;
Type
õõ; ?
propertyType
õõ@ L
)
õõL M
{
úú 	
if
ùù 
(
ùù 
propertyType
ùù 
==
ùù 
typeof
ùù  &
(
ùù& '
string
ùù' -
)
ùù- .
)
ùù. /
return
ûû 
(
ûû 
s
ûû 
)
ûû 
=>
ûû 
s
ûû 
??
ûû  "
String
ûû# )
.
ûû) *
Empty
ûû* /
;
ûû/ 0
else
üü 
if
üü 
(
üü 
propertyType
üü !
==
üü" $
typeof
üü% +
(
üü+ ,
Int32
üü, 1
)
üü1 2
)
üü2 3
return
†† 
(
†† 
s
†† 
)
†† 
=>
†† 
String
†† $
.
††$ %
IsNullOrEmpty
††% 2
(
††2 3
s
††3 4
)
††4 5
?
††6 7
$num
††8 9
:
††: ;
Int32
††< A
.
††A B
Parse
††B G
(
††G H
s
††H I
)
††I J
;
††J K
if
°° 
(
°° 
propertyType
°° 
==
°° 
typeof
°°  &
(
°°& '
DateTime
°°' /
)
°°/ 0
)
°°0 1
return
¢¢ 
(
¢¢ 
s
¢¢ 
)
¢¢ 
=>
¢¢ 
String
¢¢ $
.
¢¢$ %
IsNullOrEmpty
¢¢% 2
(
¢¢2 3
s
¢¢3 4
)
¢¢4 5
?
¢¢6 7
DateTimeZero
¢¢8 D
:
¢¢E F
DateTime
¢¢G O
.
¢¢O P
Parse
¢¢P U
(
¢¢U V
s
¢¢V W
)
¢¢W X
;
¢¢X Y
else
££ 
throw
§§ 
new
§§ %
NotImplementedException
§§ 1
(
§§1 2
)
§§2 3
;
§§3 4
}
•• 	
private
ßß 
List
ßß 
<
ßß 
Action
ßß 
<
ßß 
T
ßß 
,
ßß 
string
ßß %
>
ßß% &
>
ßß& '
CreateSetters
ßß( 5
(
ßß5 6
)
ßß6 7
{
®® 	
var
©© 
list
©© 
=
©© 
new
©© 
List
©© 
<
©©  
Action
©©  &
<
©©& '
T
©©' (
,
©©( )
string
©©* 0
>
©©0 1
>
©©1 2
(
©©2 3
)
©©3 4
;
©©4 5
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
$num
™™ 
;
™™ 
i
™™ 
<
™™ 
this
™™  $
.
™™$ %
columns
™™% ,
.
™™, -
Length
™™- 3
;
™™3 4
i
™™5 6
++
™™6 8
)
™™8 9
{
´´ 
string
¨¨ 

columnName
¨¨ !
=
¨¨" #
this
¨¨$ (
.
¨¨( )
columns
¨¨) 0
[
¨¨0 1
i
¨¨1 2
]
¨¨2 3
;
¨¨3 4
Action
≠≠ 
<
≠≠ 
T
≠≠ 
,
≠≠ 
string
≠≠  
>
≠≠  !
action
≠≠" (
=
≠≠) *
null
≠≠+ /
;
≠≠/ 0
if
ÆÆ 
(
ÆÆ 

columnName
ÆÆ 
.
ÆÆ 
IndexOf
ÆÆ &
(
ÆÆ& '
$char
ÆÆ' *
)
ÆÆ* +
>=
ÆÆ, .
$num
ÆÆ/ 0
)
ÆÆ0 1

columnName
ØØ 
=
ØØ  

columnName
ØØ! +
.
ØØ+ ,
Replace
ØØ, 3
(
ØØ3 4
$str
ØØ4 7
,
ØØ7 8
$str
ØØ9 ;
)
ØØ; <
;
ØØ< =
action
∞∞ 
=
∞∞ 

FindSetter
∞∞ #
(
∞∞# $

columnName
∞∞$ .
,
∞∞. /
false
∞∞0 5
)
∞∞5 6
??
∞∞7 9

FindSetter
∞∞: D
(
∞∞D E

columnName
∞∞E O
,
∞∞O P
true
∞∞Q U
)
∞∞U V
;
∞∞V W
list
≤≤ 
.
≤≤ 
Add
≤≤ 
(
≤≤ 
action
≤≤ 
)
≤≤  
;
≤≤  !
}
≥≥ 
return
¥¥ 
list
¥¥ 
;
¥¥ 
}
µµ 	
private
∑∑ 
void
∑∑ 
NextChar
∑∑ 
(
∑∑ 
)
∑∑ 
{
∏∏ 	
if
ππ 
(
ππ 
this
ππ 
.
ππ 
pos
ππ 
<
ππ 
this
ππ 
.
ππ  
len
ππ  #
)
ππ# $
{
∫∫ 
this
ªª 
.
ªª 
pos
ªª 
++
ªª 
;
ªª 
this
ºº 
.
ºº 
curChar
ºº 
=
ºº 
this
ºº #
.
ºº# $
pos
ºº$ '
<
ºº( )
this
ºº* .
.
ºº. /
len
ºº/ 2
?
ºº3 4
this
ºº5 9
.
ºº9 :
line
ºº: >
[
ºº> ?
this
ºº? C
.
ººC D
pos
ººD G
]
ººG H
:
ººI J
$char
ººK O
;
ººO P
}
ΩΩ 
}
ææ 	
private
¿¿ 
void
¿¿ 
ParseEndOfLine
¿¿ #
(
¿¿# $
)
¿¿$ %
{
¡¡ 	
throw
¬¬ 
new
¬¬ %
NotImplementedException
¬¬ -
(
¬¬- .
)
¬¬. /
;
¬¬/ 0
}
√√ 	
private
∆∆ 
string
∆∆ 

ParseField
∆∆ !
(
∆∆! "
)
∆∆" #
{
«« 	
parseFieldResult
»» 
.
»» 
Length
»» #
=
»»$ %
$num
»»& '
;
»»' (
if
…… 
(
…… 
this
…… 
.
…… 
line
…… 
==
…… 
null
…… !
||
……" $
this
……% )
.
……) *
pos
……* -
>=
……. 0
this
……1 5
.
……5 6
len
……6 9
)
……9 :
return
   
null
   
;
   
while
ÀÀ 
(
ÀÀ 
this
ÀÀ 
.
ÀÀ 
curChar
ÀÀ 
==
ÀÀ  "
$char
ÀÀ# &
||
ÀÀ' )
this
ÀÀ* .
.
ÀÀ. /
curChar
ÀÀ/ 6
==
ÀÀ7 9
$char
ÀÀ: >
)
ÀÀ> ?
{
ÃÃ 
this
ÕÕ 
.
ÕÕ 
NextChar
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ  
}
ŒŒ 
if
œœ 
(
œœ 
this
œœ 
.
œœ 
curChar
œœ 
==
œœ 
this
œœ  $
.
œœ$ %
textQualifier
œœ% 2
)
œœ2 3
{
–– 
this
—— 
.
—— 
NextChar
—— 
(
—— 
)
—— 
;
——  
while
““ 
(
““ 
this
““ 
.
““ 
curChar
““ #
!=
““$ &
$num
““' (
)
““( )
{
”” 
if
‘‘ 
(
‘‘ 
this
‘‘ 
.
‘‘ 
curChar
‘‘ $
==
‘‘% '
this
‘‘( ,
.
‘‘, -
textQualifier
‘‘- :
)
‘‘: ;
{
’’ 
this
÷÷ 
.
÷÷ 
NextChar
÷÷ %
(
÷÷% &
)
÷÷& '
;
÷÷' (
if
◊◊ 
(
◊◊ 
this
◊◊  
.
◊◊  !
curChar
◊◊! (
==
◊◊) +
this
◊◊, 0
.
◊◊0 1
textQualifier
◊◊1 >
)
◊◊> ?
{
ÿÿ 
this
ŸŸ  
.
ŸŸ  !
NextChar
ŸŸ! )
(
ŸŸ) *
)
ŸŸ* +
;
ŸŸ+ ,
parseFieldResult
⁄⁄ ,
.
⁄⁄, -
Append
⁄⁄- 3
(
⁄⁄3 4
this
⁄⁄4 8
.
⁄⁄8 9
textQualifier
⁄⁄9 F
)
⁄⁄F G
;
⁄⁄G H
}
€€ 
else
‹‹ 
return
›› "
parseFieldResult
››# 3
.
››3 4
ToString
››4 <
(
››< =
)
››= >
;
››> ?
}
ﬁﬁ 
else
ﬂﬂ 
if
ﬂﬂ 
(
ﬂﬂ 
this
ﬂﬂ !
.
ﬂﬂ! "
curChar
ﬂﬂ" )
==
ﬂﬂ* ,
$char
ﬂﬂ- 1
)
ﬂﬂ1 2
{
‡‡ 
if
·· 
(
·· 
this
··  
.
··  !
line
··! %
==
··& (
null
··) -
)
··- .
return
‚‚ "
parseFieldResult
‚‚# 3
.
‚‚3 4
ToString
‚‚4 <
(
‚‚< =
)
‚‚= >
;
‚‚> ?
this
„„ 
.
„„ 
ReadNextLine
„„ )
(
„„) *
)
„„* +
;
„„+ ,
}
‰‰ 
else
ÂÂ 
{
ÊÊ 
parseFieldResult
ÁÁ (
.
ÁÁ( )
Append
ÁÁ) /
(
ÁÁ/ 0
this
ÁÁ0 4
.
ÁÁ4 5
curChar
ÁÁ5 <
)
ÁÁ< =
;
ÁÁ= >
this
ËË 
.
ËË 
NextChar
ËË %
(
ËË% &
)
ËË& '
;
ËË' (
}
ÈÈ 
}
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
while
ÓÓ 
(
ÓÓ 
this
ÓÓ 
.
ÓÓ 
curChar
ÓÓ #
!=
ÓÓ$ &
$num
ÓÓ' (
&&
ÓÓ) +
this
ÓÓ, 0
.
ÓÓ0 1
curChar
ÓÓ1 8
!=
ÓÓ9 ;
this
ÓÓ< @
.
ÓÓ@ A
fieldSeparator
ÓÓA O
&&
ÓÓP R
this
ÓÓS W
.
ÓÓW X
curChar
ÓÓX _
!=
ÓÓ` b
$char
ÓÓc g
&&
ÓÓh j
this
ÓÓk o
.
ÓÓo p
curChar
ÓÓp w
!=
ÓÓx z
$char
ÓÓ{ 
)ÓÓ Ä
{
ÔÔ 
parseFieldResult
 $
.
$ %
Append
% +
(
+ ,
this
, 0
.
0 1
curChar
1 8
)
8 9
;
9 :
this
ÒÒ 
.
ÒÒ 
NextChar
ÒÒ !
(
ÒÒ! "
)
ÒÒ" #
;
ÒÒ# $
}
ÚÚ 
}
ÛÛ 
return
ÙÙ 
parseFieldResult
ÙÙ #
.
ÙÙ# $
ToString
ÙÙ$ ,
(
ÙÙ, -
)
ÙÙ- .
;
ÙÙ. /
}
ıı 	
private
˜˜ 
void
˜˜ 

ReadHeader
˜˜ 
(
˜˜  
string
˜˜  &
header
˜˜' -
)
˜˜- .
{
¯¯ 	
if
˘˘ 
(
˘˘ 
header
˘˘ 
==
˘˘ 
null
˘˘ 
)
˘˘ 
{
˙˙ 
this
˚˚ 
.
˚˚ 
ReadNextLine
˚˚ !
(
˚˚! "
)
˚˚" #
;
˚˚# $
}
¸¸ 
else
˝˝ 
{
˛˛ 
this
ÅÅ 
.
ÅÅ 
line
ÅÅ 
=
ÅÅ 
header
ÅÅ "
;
ÅÅ" #
this
ÇÇ 
.
ÇÇ 
pos
ÇÇ 
=
ÇÇ 
-
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
this
ÉÉ 
.
ÉÉ 
len
ÉÉ 
=
ÉÉ 
this
ÉÉ 
.
ÉÉ  
line
ÉÉ  $
.
ÉÉ$ %
Length
ÉÉ% +
;
ÉÉ+ ,
this
ÑÑ 
.
ÑÑ 
NextChar
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ  
}
ÖÖ 
var
áá 
readColumns
áá 
=
áá 
new
áá !
List
áá" &
<
áá& '
string
áá' -
>
áá- .
(
áá. /
)
áá/ 0
;
áá0 1
string
àà 

columnName
àà 
;
àà 
while
ââ 
(
ââ 
(
ââ 

columnName
ââ 
=
ââ  
this
ââ! %
.
ââ% &

ParseField
ââ& 0
(
ââ0 1
)
ââ1 2
)
ââ2 3
!=
ââ4 6
null
ââ7 ;
)
ââ; <
{
ää 
readColumns
ãã 
.
ãã 
Add
ãã 
(
ãã  

columnName
ãã  *
)
ãã* +
;
ãã+ ,
if
åå 
(
åå 
this
åå 
.
åå 
curChar
åå  
==
åå! #
this
åå$ (
.
åå( )
fieldSeparator
åå) 7
)
åå7 8
this
çç 
.
çç 
NextChar
çç !
(
çç! "
)
çç" #
;
çç# $
else
éé 
break
èè 
;
èè 
}
êê 
this
ëë 
.
ëë 
columns
ëë 
=
ëë 
readColumns
ëë &
.
ëë& '
ToArray
ëë' .
(
ëë. /
)
ëë/ 0
;
ëë0 1
}
íí 	
private
îî 
void
îî 
ReadNextLine
îî !
(
îî! "
)
îî" #
{
ïï 	
this
ññ 
.
ññ 
line
ññ 
=
ññ 
this
ññ 
.
ññ 

textReader
ññ '
.
ññ' (
ReadLine
ññ( 0
(
ññ0 1
)
ññ1 2
;
ññ2 3
this
óó 
.
óó 
pos
óó 
=
óó 
-
óó 
$num
óó 
;
óó 
if
òò 
(
òò 
this
òò 
.
òò 
line
òò 
==
òò 
null
òò !
)
òò! "
{
ôô 
this
öö 
.
öö 
len
öö 
=
öö 
$num
öö 
;
öö 
this
õõ 
.
õõ 
curChar
õõ 
=
õõ 
$char
õõ #
;
õõ# $
}
úú 
else
ùù 
{
ûû 
this
üü 
.
üü 
len
üü 
=
üü 
this
üü 
.
üü  
line
üü  $
.
üü$ %
Length
üü% +
;
üü+ ,
this
†† 
.
†† 
NextChar
†† 
(
†† 
)
†† 
;
††  
}
°° 
}
¢¢ 	
}
££ 
public
•• 

class
•• 
CsvDefinition
•• 
{
¶¶ 
public
ßß 
string
ßß 
Header
ßß 
{
ßß 
get
ßß "
;
ßß" #
set
ßß$ '
;
ßß' (
}
ßß) *
public
®® 
char
®® 
FieldSeparator
®® "
{
®®# $
get
®®% (
;
®®( )
set
®®* -
;
®®- .
}
®®/ 0
public
©© 
char
©© 
TextQualifier
©© !
{
©©" #
get
©©$ '
;
©©' (
set
©©) ,
;
©©, -
}
©©. /
public
™™ 
IEnumerable
™™ 
<
™™ 
String
™™ !
>
™™! "
Columns
™™# *
{
™™+ ,
get
™™- 0
;
™™0 1
set
™™2 5
;
™™5 6
}
™™7 8
public
´´ 
string
´´ 
	EndOfLine
´´ 
{
´´  !
get
´´" %
;
´´% &
set
´´' *
;
´´* +
}
´´, -
public
≠≠ 
CsvDefinition
≠≠ 
(
≠≠ 
)
≠≠ 
{
ÆÆ 	
if
ØØ 
(
ØØ 
CsvFile
ØØ 
.
ØØ "
DefaultCsvDefinition
ØØ ,
!=
ØØ- /
null
ØØ0 4
)
ØØ4 5
{
∞∞ 
FieldSeparator
±± 
=
±±  
CsvFile
±±! (
.
±±( )"
DefaultCsvDefinition
±±) =
.
±±= >
FieldSeparator
±±> L
;
±±L M
TextQualifier
≤≤ 
=
≤≤ 
CsvFile
≤≤  '
.
≤≤' ("
DefaultCsvDefinition
≤≤( <
.
≤≤< =
TextQualifier
≤≤= J
;
≤≤J K
	EndOfLine
≥≥ 
=
≥≥ 
CsvFile
≥≥ #
.
≥≥# $"
DefaultCsvDefinition
≥≥$ 8
.
≥≥8 9
	EndOfLine
≥≥9 B
;
≥≥B C
}
¥¥ 
}
µµ 	
}
∂∂ 
public
∏∏ 

class
∏∏ 
	CsvSource
∏∏ 
{
ππ 
public
∫∫ 
readonly
∫∫ 

TextReader
∫∫ "

TextReader
∫∫# -
;
∫∫- .
public
ºº 
static
ºº 
implicit
ºº 
operator
ºº '
	CsvSource
ºº( 1
(
ºº1 2
CsvFile
ºº2 9
csvFile
ºº: A
)
ººA B
{
ΩΩ 	
return
ææ 
new
ææ 
	CsvSource
ææ  
(
ææ  !
csvFile
ææ! (
)
ææ( )
;
ææ) *
}
øø 	
public
¡¡ 
static
¡¡ 
implicit
¡¡ 
operator
¡¡ '
	CsvSource
¡¡( 1
(
¡¡1 2
string
¡¡2 8
path
¡¡9 =
)
¡¡= >
{
¬¬ 	
return
√√ 
new
√√ 
	CsvSource
√√  
(
√√  !
path
√√! %
)
√√% &
;
√√& '
}
ƒƒ 	
public
∆∆ 
static
∆∆ 
implicit
∆∆ 
operator
∆∆ '
	CsvSource
∆∆( 1
(
∆∆1 2

TextReader
∆∆2 <

textReader
∆∆= G
)
∆∆G H
{
«« 	
return
»» 
new
»» 
	CsvSource
»»  
(
»»  !

textReader
»»! +
)
»»+ ,
;
»», -
}
…… 	
public
ÀÀ 
	CsvSource
ÀÀ 
(
ÀÀ 

TextReader
ÀÀ #

textReader
ÀÀ$ .
)
ÀÀ. /
{
ÃÃ 	
this
ÕÕ 
.
ÕÕ 

TextReader
ÕÕ 
=
ÕÕ 

textReader
ÕÕ (
;
ÕÕ( )
}
ŒŒ 	
public
–– 
	CsvSource
–– 
(
–– 
Stream
–– 
stream
––  &
)
––& '
{
—— 	
this
““ 
.
““ 

TextReader
““ 
=
““ 
new
““ !
StreamReader
““" .
(
““. /
stream
““/ 5
)
““5 6
;
““6 7
}
”” 	
public
’’ 
	CsvSource
’’ 
(
’’ 
string
’’ 
path
’’  $
)
’’$ %
{
÷÷ 	
this
◊◊ 
.
◊◊ 

TextReader
◊◊ 
=
◊◊ 
new
◊◊ !
StreamReader
◊◊" .
(
◊◊. /
path
◊◊/ 3
)
◊◊3 4
;
◊◊4 5
}
ÿÿ 	
public
⁄⁄ 
	CsvSource
⁄⁄ 
(
⁄⁄ 
CsvFile
⁄⁄  
csvFile
⁄⁄! (
)
⁄⁄( )
{
€€ 	
this
‹‹ 
.
‹‹ 

TextReader
‹‹ 
=
‹‹ 
new
‹‹ !
StreamReader
‹‹" .
(
‹‹. /
csvFile
‹‹/ 6
.
‹‹6 7

BaseStream
‹‹7 A
)
‹‹A B
;
‹‹B C
}
›› 	
}
ﬁﬁ 
public
‡‡ 

class
‡‡ 
CsvDestination
‡‡ 
{
·· 
private
‚‚ 
StreamWriter
‚‚ 
streamWriter
‚‚ )
;
‚‚) *
public
‰‰ 
StreamWriter
‰‰ 
StreamWriter
‰‰ (
{
ÂÂ 	
get
ÊÊ 
{
ÊÊ 
return
ÊÊ 
streamWriter
ÊÊ %
;
ÊÊ% &
}
ÊÊ' (
}
ÁÁ 	
public
ÈÈ 
static
ÈÈ 
implicit
ÈÈ 
operator
ÈÈ '
CsvDestination
ÈÈ( 6
(
ÈÈ6 7
string
ÈÈ7 =
path
ÈÈ> B
)
ÈÈB C
{
ÍÍ 	
return
ÎÎ 
new
ÎÎ 
CsvDestination
ÎÎ %
(
ÎÎ% &
path
ÎÎ& *
)
ÎÎ* +
;
ÎÎ+ ,
}
ÏÏ 	
private
ÌÌ 
CsvDestination
ÌÌ 
(
ÌÌ 
StreamWriter
ÌÌ +
streamWriter
ÌÌ, 8
)
ÌÌ8 9
{
ÓÓ 	
this
ÔÔ 
.
ÔÔ 
streamWriter
ÔÔ 
=
ÔÔ 
streamWriter
ÔÔ  ,
;
ÔÔ, -
}
 	
private
ÚÚ 
CsvDestination
ÚÚ 
(
ÚÚ 
Stream
ÚÚ %
stream
ÚÚ& ,
)
ÚÚ, -
{
ÛÛ 	
this
ÙÙ 
.
ÙÙ 
streamWriter
ÙÙ 
=
ÙÙ 
new
ÙÙ  #
StreamWriter
ÙÙ$ 0
(
ÙÙ0 1
stream
ÙÙ1 7
)
ÙÙ7 8
;
ÙÙ8 9
}
ıı 	
public
˜˜ 
CsvDestination
˜˜ 
(
˜˜ 
string
˜˜ $
fullName
˜˜% -
)
˜˜- .
{
¯¯ 	
FixCsvFileName
˘˘ 
(
˘˘ 
ref
˘˘ 
fullName
˘˘ '
)
˘˘' (
;
˘˘( )
this
˙˙ 
.
˙˙ 
streamWriter
˙˙ 
=
˙˙ 
new
˙˙  #
StreamWriter
˙˙$ 0
(
˙˙0 1
fullName
˙˙1 9
)
˙˙9 :
;
˙˙: ;
}
˚˚ 	
private
˝˝ 
static
˝˝ 
void
˝˝ 
FixCsvFileName
˝˝ *
(
˝˝* +
ref
˝˝+ .
string
˝˝/ 5
fullName
˝˝6 >
)
˝˝> ?
{
˛˛ 	
fullName
ˇˇ 
=
ˇˇ 
Path
ˇˇ 
.
ˇˇ 
GetFullPath
ˇˇ '
(
ˇˇ' (
fullName
ˇˇ( 0
)
ˇˇ0 1
;
ˇˇ1 2
var
ÄÄ 
path
ÄÄ 
=
ÄÄ 
Path
ÄÄ 
.
ÄÄ 
GetDirectoryName
ÄÄ ,
(
ÄÄ, -
fullName
ÄÄ- 5
)
ÄÄ5 6
;
ÄÄ6 7
if
ÅÅ 
(
ÅÅ 
path
ÅÅ 
!=
ÅÅ 
null
ÅÅ 
&&
ÅÅ 
!
ÅÅ  !
	Directory
ÅÅ! *
.
ÅÅ* +
Exists
ÅÅ+ 1
(
ÅÅ1 2
path
ÅÅ2 6
)
ÅÅ6 7
)
ÅÅ7 8
	Directory
ÇÇ 
.
ÇÇ 
CreateDirectory
ÇÇ )
(
ÇÇ) *
path
ÇÇ* .
)
ÇÇ. /
;
ÇÇ/ 0
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
String
ÉÉ 
.
ÉÉ 
Equals
ÉÉ 
(
ÉÉ 
Path
ÉÉ #
.
ÉÉ# $
GetExtension
ÉÉ$ 0
(
ÉÉ0 1
fullName
ÉÉ1 9
)
ÉÉ9 :
,
ÉÉ: ;
$str
ÉÉ< B
)
ÉÉB C
)
ÉÉC D
fullName
ÑÑ 
+=
ÑÑ 
$str
ÑÑ "
;
ÑÑ" #
}
ÖÖ 	
}
ÜÜ 
public
àà 

static
àà 
class
àà #
CsvFileLinqExtensions
àà -
{
ââ 
public
ää 
static
ää 
void
ää 
ToCsv
ää  
<
ää  !
T
ää! "
>
ää" #
(
ää# $
this
ää$ (
IEnumerable
ää) 4
<
ää4 5
T
ää5 6
>
ää6 7
source
ää8 >
,
ää> ?
CsvDestination
ää@ N
csvDestination
ääO ]
)
ää] ^
{
ãã 	
source
åå 
.
åå 
ToCsv
åå 
(
åå 
csvDestination
åå '
,
åå' (
null
åå) -
)
åå- .
;
åå. /
}
çç 	
public
èè 
static
èè 
void
èè 
ToCsv
èè  
<
èè  !
T
èè! "
>
èè" #
(
èè# $
this
èè$ (
IEnumerable
èè) 4
<
èè4 5
T
èè5 6
>
èè6 7
source
èè8 >
,
èè> ?
CsvDestination
èè@ N
csvDestination
èèO ]
,
èè] ^
CsvDefinition
èè_ l
csvDefinition
èèm z
)
èèz {
{
êê 	
using
ëë 
(
ëë 
var
ëë 
csvFile
ëë 
=
ëë  
new
ëë! $
CsvFile
ëë% ,
<
ëë, -
T
ëë- .
>
ëë. /
(
ëë/ 0
csvDestination
ëë0 >
,
ëë> ?
csvDefinition
ëë@ M
)
ëëM N
)
ëëN O
{
íí 
foreach
ìì 
(
ìì 
var
ìì 
record
ìì #
in
ìì$ &
source
ìì' -
)
ìì- .
{
îî 
csvFile
ïï 
.
ïï 
Append
ïï "
(
ïï" #
record
ïï# )
)
ïï) *
;
ïï* +
}
ññ 
}
óó 
}
òò 	
}
öö 
public
úú 

class
úú (
CsvIgnorePropertyAttribute
úú +
:
úú, -
	Attribute
úú. 7
{
ùù 
public
ûû 
override
ûû 
string
ûû 
ToString
ûû '
(
ûû' (
)
ûû( )
{
üü 	
return
†† 
$str
†† $
;
††$ %
}
°° 	
}
¢¢ 
}ßß å
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\EmailChecker.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{		 
public

 

class

 
EmailChecker

 
{ 
private 
static 
bool 
invalid #
=$ %
false& +
;+ ,
public 
static 
bool 
IsValidEmail '
(' (
string( .
strIn/ 4
)4 5
{ 	
invalid 
= 
false 
; 
if 
( 
string 
. 
IsNullOrEmpty $
($ %
strIn% *
)* +
)+ ,
return 
false 
; 
try 
{ 
strIn 
= 
Regex 
. 
Replace %
(% &
strIn& +
,+ ,
$str- 8
,8 9
DomainMapper: F
,F G
RegexOptions& 2
.2 3
None3 7
,7 8
TimeSpan9 A
.A B
FromMillisecondsB R
(R S
$numS V
)V W
)W X
;X Y
} 
catch 
( &
RegexMatchTimeoutException -
)- .
{ 
return 
false 
; 
} 
try   
{!! 
return"" 
Regex"" 
."" 
IsMatch"" $
(""$ %
strIn""% *
,""* +
$str## y
+##z {
$str$$ {
,$${ |
RegexOptions%% "
.%%" #

IgnoreCase%%# -
,%%- .
TimeSpan%%/ 7
.%%7 8
FromMilliseconds%%8 H
(%%H I
$num%%I L
)%%L M
)%%M N
;%%N O
}&& 
catch'' 
('' &
RegexMatchTimeoutException'' -
)''- .
{(( 
return)) 
false)) 
;)) 
}** 
}++ 	
private-- 
static-- 
string-- 
DomainMapper-- *
(--* +
Match--+ 0
match--1 6
)--6 7
{.. 	

IdnMapping00 
idn00 
=00 
new00  

IdnMapping00! +
(00+ ,
)00, -
;00- .
string22 

domainName22 
=22 
match22  %
.22% &
Groups22& ,
[22, -
$num22- .
]22. /
.22/ 0
Value220 5
;225 6
try33 
{44 

domainName55 
=55 
idn55  
.55  !
GetAscii55! )
(55) *

domainName55* 4
)554 5
;555 6
}66 
catch77 
(77 
ArgumentException77 $
)77$ %
{88 
invalid99 
=99 
true99 
;99 
}:: 
return;; 
match;; 
.;; 
Groups;; 
[;;  
$num;;  !
];;! "
.;;" #
Value;;# (
+;;) *

domainName;;+ 5
;;;5 6
}<< 	
}== 
}>> ˝
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\ExcelUtility.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 
ExcelUtility 
{ 
public 
static 
int 
GetRow  
(  !
int! $

itemNumber% /
)/ 0
{ 	
int 
	rowNumber 
= 
$num 
; 
int 
firstStartingRow  
=! "
$num# $
;$ %
int		 
secondStartingRow		 !
=		" #
$num		$ &
;		& '
if 
( 

itemNumber 
<= 
$num  
)  !
	rowNumber 
= 

itemNumber &
+' (
firstStartingRow) 9
;9 :
if 
( 

itemNumber 
> 
$num 
&&  "

itemNumber# -
<. /
$num0 3
)3 4
	rowNumber 
= 

itemNumber &
+' (
firstStartingRow) 9
-: ;
$num< >
;> ?
if 
( 

itemNumber 
> 
$num  
&&! #

itemNumber$ .
<=/ 1
$num2 5
)5 6
	rowNumber 
= 

itemNumber &
-' (
$num) ,
+- .
secondStartingRow/ @
;@ A
if 
( 

itemNumber 
> 
$num  
)  !
	rowNumber 
= 

itemNumber &
-' (
$num) ,
+- .
secondStartingRow/ @
-A B
$numC E
;E F
return 
	rowNumber 
; 
} 	
public 
static 
string 
	GetColumn &
(& '
int' *

itemNumber+ 5
,5 6
string7 =

columnName> H
)H I
{ 	
string 
columnNumber 
=  !
string" (
.( )
Empty) .
;. /
if 
( 
( 

itemNumber 
<= 
$num !
)! "
||# %
(& '

itemNumber' 1
>2 3
$num4 7
&&8 :

itemNumber; E
<=F H
$numI L
)L M
)M N
{ 
columnNumber   
=   

columnName   )
.  ) *
Equals  * 0
(  0 1
$str  1 7
)  7 8
?  9 :
$str  ; >
:  ? @
(  A B

columnName  B L
.  L M
Equals  M S
(  S T
$str  T ^
)  ^ _
?  ` a
$str  b e
:  f g
$str  h k
)  k l
;  l m
}!! 
if## 
(## 
(## 

itemNumber## 
>## 
$num##  
&&##! #

itemNumber##$ .
<##/ 0
$num##1 4
)##4 5
||##6 8
(##9 :

itemNumber##: D
>##E F
$num##G J
)##J K
)##K L
{$$ 
columnNumber%% 
=%% 

columnName%% )
.%%) *
Equals%%* 0
(%%0 1
$str%%1 7
)%%7 8
?%%9 :
$str%%; >
:%%? @
(%%A B

columnName%%B L
.%%L M
Equals%%M S
(%%S T
$str%%T ^
)%%^ _
?%%` a
$str%%b e
:%%f g
$str%%h k
)%%k l
;%%l m
}&& 
return'' 
columnNumber'' 
;''  
}(( 	
})) 
}** ¨v
FE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\Helpers\FileManager.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Async

 
.

 
Helpers

 #
{ 
public 

class 
FileManager 
{ 
static 
string 
OptOut 
= 
$str	 À
;
À Ã
static 
string 
ViewInBrowser #
=$ %
$str	& ô
;
ô ö
static 
string 
_orderNumber "
;" #
static 
bool 
_isAddOptout  
;  !
static 
bool 
_isAddViewinBrowser '
;' (
static 
string 
serverPrefix "
=# $
string% +
.+ ,
Format, 2
(2 3
$str3 R
,R S
S3FileManagerT a
.a b
bucketb h
)h i
;i j
public 
static 
HtmlProcessResult '
ProcessHtmlZip( 6
(6 7
string7 =

UploadPath> H
,H I
stringJ P
zipFilePathQ \
,\ ]
string^ d
orderNumbere p
,p q
boolr v
isAddOptout	w Ç
,
Ç É
bool
Ñ à 
isAddViewinBrowser
â õ
)
õ ú
{ 	
_orderNumber 
= 
orderNumber &
;& '
_isAddOptout 
= 
isAddOptout &
;& '
_isAddViewinBrowser 
=  !
isAddViewinBrowser" 4
;4 5
var 
	directory 
= 
string "
." #
Format# )
() *
$str* 4
,4 5

UploadPath6 @
,@ A
orderNumberB M
)M N
;N O
if 
( 
! 
	Directory 
. 
Exists !
(! "
	directory" +
)+ ,
), -
{ 
	Directory 
. 
CreateDirectory )
() *
	directory* 3
)3 4
;4 5
}   
ZipFile!! 
.!! 
ExtractToDirectory!! &
(!!& '
zipFilePath!!' 2
,!!2 3
	directory!!4 =
)!!= >
;!!> ?
var$$ 

imagesLive$$ 
=$$ 
string$$ #
.$$# $
Format$$$ *
($$* +
$str$$+ 7
,$$7 8
orderNumber$$9 D
)$$D E
;$$E F
string%% 
htmlFileName%% 
=%%  !
string%%" (
.%%( )
Format%%) /
(%%/ 0
$str%%0 9
,%%9 :
orderNumber%%; F
)%%F G
;%%G H
string&& 
htmlFileKey&& 
=&&  
string&&! '
.&&' (
Format&&( .
(&&. /
$str&&/ <
,&&< =
orderNumber&&> I
)&&I J
;&&J K
string'' 
htmlFilePath'' 
=''  !
string''" (
.''( )
Format'') /
(''/ 0
$str''0 :
,'': ;
	directory''< E
,''E F
htmlFileName''G S
)''S T
;''T U
string)) 
htmlFile)) 
=)) 
	Directory)) '
.))' (
EnumerateFiles))( 6
())6 7
	directory))7 @
)))@ A
.))A B
FirstOrDefault))B P
())P Q
x))Q R
=>))S U
x))V W
.))W X
EndsWith))X `
())` a
$str))a f
)))f g
||))h j
x))k l
.))l m
EndsWith))m u
())u v
$str))v |
)))| }
)))} ~
;))~ 
if** 
(** 
string** 
.** 
IsNullOrEmpty** #
(**# $
htmlFile**$ ,
)**, -
)**- .
throw++ 
new++ 
AdsException++ &
(++& '
$str++' 7
)++7 8
;++8 9
UploadFileStatus-- 
status-- #
=--$ %
ProcessHtml--& 1
(--1 2
htmlFile--2 :
,--: ;
htmlFilePath--< H
)--H I
;--I J
S3FileManager00 
.00 
CreateDirectory00 )
(00) *
orderNumber00* 5
)005 6
;006 7
S3FileManager33 
.33 
Upload33  
(33  !
htmlFileKey33! ,
,33, -
htmlFilePath33. :
,33: ;
true33< @
)33@ A
;33A B
string44 
filePathLive44 
=44  !
string44" (
.44( )
Format44) /
(44/ 0
$str440 8
,448 9
serverPrefix44: F
,44F G
htmlFileKey44H S
)44S T
;44T U
S3FileManager77 
.77 
CreateDirectory77 )
(77) *

imagesLive77* 4
)774 5
;775 6
var:: 
images:: 
=:: 
	Directory:: "
.::" # 
EnumerateDirectories::# 7
(::7 8
	directory::8 A
)::A B
.::B C
FirstOrDefault::C Q
(::Q R
)::R S
;::S T
if;; 
(;; 
images;; 
!=;; 
null;; 
);; 
foreach<< 
(<< 
var<< 
imgFile<<  
in<<! #
	Directory<<$ -
.<<- .
EnumerateFiles<<. <
(<<< =
images<<= C
)<<C D
)<<D E
{== 
var>> 
	imageLive>> 
=>> 
string>>  &
.>>& '
Format>>' -
(>>- .
$str>>. 7
,>>7 8

imagesLive>>9 C
,>>C D
new>>E H
FileInfo>>I Q
(>>Q R
imgFile>>R Y
)>>Y Z
.>>Z [
Name>>[ _
)>>_ `
;>>` a
S3FileManager?? 
.?? 
Upload?? $
(??$ %
	imageLive??% .
,??. /
imgFile??0 7
,??7 8
true??9 =
)??= >
;??> ?
}@@ 
newCC 
DirectoryInfoCC 
(CC 
	directoryCC '
)CC' (
.CC( )
DeleteCC) /
(CC/ 0
trueCC0 4
)CC4 5
;CC5 6
returnEE 
newEE 
HtmlProcessResultEE (
(EE( )
)EE) *
{EE+ ,
StatusEE, 2
=EE3 4
statusEE5 ;
,EE; <
filePathLiveEE= I
=EEJ K
filePathLiveEEL X
}EEX Y
;EEY Z
}FF 	
publicHH 
staticHH 
UploadFileStatusHH &
ProcessHtmlHH' 2
(HH2 3
stringHH3 9
htmlFileHH: B
,HHB C
stringHHD J
outputFilePathHHK Y
)HHY Z
{II 	
stringJJ 

imagesPathJJ 
=JJ 
stringJJ  &
.JJ& '
FormatJJ' -
(JJ- .
$strJJ. >
,JJ> ?
serverPrefixJJ@ L
,JJL M
_orderNumberJJN Z
)JJZ [
;JJ[ \
HtmlDocumentLL 
docLL 
=LL 
newLL "
HtmlDocumentLL# /
(LL/ 0
)LL0 1
;LL1 2
docMM 
.MM 
LoadMM 
(MM 
htmlFileMM 
)MM 
;MM 
varNN 
allSrcsNN 
=NN 
docNN 
.NN 
DocumentNodeNN *
.NN* +
SelectNodesNN+ 6
(NN6 7
$strNN7 D
)NND E
;NNE F
boolOO 
alreadyHostedOO 
=OO  
falseOO! &
;OO& '
foreachPP 
(PP 
HtmlNodePP 
nodePP "
inPP# %
allSrcsPP& -
)PP- .
{QQ 
varRR 
srcRR 
=RR 
nodeRR 
.RR 

AttributesRR )
[RR) *
$strRR* /
]RR/ 0
.RR0 1
ValueRR1 6
;RR6 7
ifTT 
(TT 
srcTT 
.TT 
ContainsTT  
(TT  !
$strTT! *
)TT* +
)TT+ ,
{UU 
alreadyHostedVV !
=VV" #
trueVV$ (
;VV( )
breakWW 
;WW 
;WW 
}XX 
elseYY 
{ZZ 
var]] 
srcs]] 
=]] 
src]] "
.]]" #
Split]]# (
(]]( )
$str]]) ,
.]], -
ToCharArray]]- 8
(]]8 9
)]]9 :
)]]: ;
;]]; <
string^^ 
imgFileName^^ &
=^^' (
srcs^^) -
.^^- .
Length^^. 4
>^^5 6
$num^^7 8
?^^9 :
srcs^^; ?
[^^? @
$num^^@ A
]^^A B
:^^C D
string^^E K
.^^K L
Empty^^L Q
;^^Q R
src__ 
=__ 
string__  
.__  !
Format__! '
(__' (
$str__( 0
,__0 1

imagesPath__2 <
,__< =
imgFileName__> I
)__I J
;__J K
}`` 
nodeaa 
.aa 
SetAttributeValueaa &
(aa& '
$straa' ,
,aa, -
srcaa. 1
)aa1 2
;aa2 3
}bb 
HtmlNodedd 
bodydd 
=dd 
docdd 
.dd  
DocumentNodedd  ,
.dd, -
SelectSingleNodedd- =
(dd= >
$strdd> F
)ddF G
;ddG H
ifee 
(ee 
_isAddViewinBrowseree #
)ee# $
{ff 
HtmlNodegg 
newNodegg  
=gg! "
HtmlNodegg# +
.gg+ ,

CreateNodegg, 6
(gg6 7
ViewInBrowsergg7 D
)ggD E
;ggE F
bodyhh 
.hh 
PrependChildhh !
(hh! "
newNodehh" )
)hh) *
;hh* +
}ii 
ifjj 
(jj 
_isAddOptoutjj 
)jj 
{kk 
HtmlNodell 
newNodell  
=ll! "
HtmlNodell# +
.ll+ ,

CreateNodell, 6
(ll6 7
OptOutll7 =
)ll= >
;ll> ?
bodymm 
.mm 
AppendChildmm  
(mm  !
newNodemm! (
)mm( )
;mm) *
}nn 
docpp 
.pp 
Savepp 
(pp 
outputFilePathpp #
)pp# $
;pp$ %
returnrr 
alreadyHostedrr  
?rr! "
UploadFileStatusrr# 3
.rr3 4
HostedWithOutImagesrr4 G
:rrH I
UploadFileStatusrrK [
.rr[ \
HostedWithImagesrr\ l
;rrl m
}ss 	
publicuu 
staticuu 
stringuu 
GetFilePathLiveuu ,
(uu, -
UploadFileTypeuu- ;
uploadFileTypeuu< J
,uuJ K
stringuuL R
orderNumberuuS ^
,uu^ _
stringuu` f
	extensionuug p
=uuq r
$struus u
,uuu v
stringuuw }
segmentNumber	uu~ ã
=
uuå ç
$str
uué ê
)
uuê ë
{vv 	
stringww 
fileNameww 
=ww 
$strww  
;ww  !
switchxx 
(xx 
uploadFileTypexx "
)xx" #
{yy 
casezz 
UploadFileTypezz '
.zz' (
ZipFilezz( /
:zz/ 0
fileName{{  
={{! "
string{{# )
.{{) *
Format{{* 0
({{0 1
$str{{1 D
,{{D E
serverPrefix{{F R
,{{R S
orderNumber{{T _
){{_ `
;{{` a
break|| 
;|| 
case}} 
UploadFileType}} '
.}}' (
TestSeedFile}}( 4
:}}4 5
fileName~~  
=~~! "
string~~# )
.~~) *
Format~~* 0
(~~0 1
$str~~1 E
,~~E F
serverPrefix~~G S
,~~S T
orderNumber~~U `
)~~` a
;~~a b
break 
; 
case
ÄÄ 
UploadFileType
ÄÄ '
.
ÄÄ' (
LiveSeedFile
ÄÄ( 4
:
ÄÄ4 5
fileName
ÅÅ  
=
ÅÅ! "
string
ÅÅ# )
.
ÅÅ) *
Format
ÅÅ* 0
(
ÅÅ0 1
$str
ÅÅ1 E
,
ÅÅE F
serverPrefix
ÅÅG S
,
ÅÅS T
orderNumber
ÅÅU `
)
ÅÅ` a
;
ÅÅa b
break
ÇÇ 
;
ÇÇ 
case
ÉÉ 
UploadFileType
ÉÉ '
.
ÉÉ' (
SuppressionFile
ÉÉ( 7
:
ÉÉ7 8
fileName
ÑÑ  
=
ÑÑ! "
string
ÑÑ# )
.
ÑÑ) *
Format
ÑÑ* 0
(
ÑÑ0 1
$str
ÑÑ1 E
,
ÑÑE F
serverPrefix
ÑÑG S
,
ÑÑS T
orderNumber
ÑÑU `
)
ÑÑ` a
;
ÑÑa b
break
ÖÖ 
;
ÖÖ 
case
ÜÜ 
UploadFileType
ÜÜ '
.
ÜÜ' (
BannersFile
ÜÜ( 3
:
ÜÜ3 4
fileName
áá $
=
áá% &
string
áá' -
.
áá- .
Format
áá. 4
(
áá4 5
$str
áá5 H
,
ááH I
serverPrefix
ááJ V
,
ááV W
orderNumber
ááX c
,
áác d
	extension
ááe n
)
áán o
;
ááo p
break
àà 
;
àà 
case
ââ 
UploadFileType
ââ '
.
ââ' (
BannersLinksFile
ââ( 8
:
ââ8 9
fileName
ää $
=
ää% &
string
ää' -
.
ää- .
Format
ää. 4
(
ää4 5
$str
ää5 M
,
ääM N
serverPrefix
ääO [
,
ää[ \
orderNumber
ää] h
,
ääh i
	extension
ääj s
)
ääs t
;
äät u
break
ãã 
;
ãã 
case
åå 
UploadFileType
åå '
.
åå' (
MiscFile
åå( 0
:
åå0 1
fileName
çç  
=
çç! "
string
çç# )
.
çç) *
Format
çç* 0
(
çç0 1
$str
çç1 B
,
ççB C
serverPrefix
ççD P
,
ççP Q
orderNumber
ççR ]
,
çç] ^
	extension
çç_ h
)
ççh i
;
ççi j
break
éé 
;
éé 
case
èè 
UploadFileType
èè '
.
èè' (
DataFile
èè( 0
:
èè0 1
fileName
êê  
=
êê! "
string
êê# )
.
êê) *
Format
êê* 0
(
êê0 1
$str
êê1 E
,
êêE F
serverPrefix
êêG S
,
êêS T
orderNumber
êêU `
,
êê` a
segmentNumber
êêb o
)
êêo p
;
êêp q
break
ëë 
;
ëë 
}
íí 
return
ìì 
fileName
ìì 
;
ìì 
}
îî 	
}
ïï 
}ññ Öf
IE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\Helpers\FileManagerFTP.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Async

 
.

 
Helpers

 #
{ 
public 

class 
FileManagerFTP 
{ 
static 
string 
OptOut 
= 
$str	 À
;
À Ã
static 
string 
ViewInBrowser #
=$ %
$str	& ô
;
ô ö
private 
static 
string 
_orderNumber *
;* +
private 
static 
bool 
_isAddOptout (
;( )
private 
static 
bool 
_isAddViewinBrowser /
;/ 0
public 
static 
HtmlProcessResult '
ProcessHtmlZip( 6
(6 7
string7 =

UploadPath> H
,H I
stringJ P
zipFilePathQ \
,\ ]
string^ d
orderNumbere p
,p q
boolr v
isAddOptout	w Ç
,
Ç É
bool
Ñ à 
isAddViewinBrowser
â õ
)
õ ú
{ 	
_orderNumber 
= 
orderNumber &
;& '
_isAddOptout 
= 
isAddOptout &
;& '
_isAddViewinBrowser 
=  !
isAddViewinBrowser" 4
;4 5
FileUploader 
uploader !
=" #
new$ '
FileUploader( 4
(4 5
)5 6
;6 7
var 
	directory 
= 
$" 
{ 

UploadPath )
}) *
\\* ,
{, -
orderNumber- 8
}8 9
temp9 =
"= >
;> ?
if 
( 
	Directory 
. 
Exists  
(  !
	directory! *
)* +
)+ ,
{ 
new 
DirectoryInfo !
(! "
	directory" +
)+ ,
., -
Delete- 3
(3 4
true4 8
)8 9
;9 :
}   
else!! 
{"" 
	Directory## 
.## 
CreateDirectory## )
(##) *
	directory##* 3
)##3 4
;##4 5
}$$ 
ZipFile%% 
.%% 
ExtractToDirectory%% &
(%%& '
zipFilePath%%' 2
,%%2 3
	directory%%4 =
)%%= >
;%%> ?
string(( 
htmlFileName(( 
=((  !
$"((" $
{(($ %
orderNumber((% 0
}((0 1
.htm((1 5
"((5 6
;((6 7
string)) 
htmlFilePath)) 
=))  !
$"))" $
{))$ %
	directory))% .
})). /
\\))/ 1
{))1 2
htmlFileName))2 >
}))> ?
"))? @
;))@ A
string++ 
htmlFile++ 
=++ 
	Directory++ '
.++' (
EnumerateFiles++( 6
(++6 7
	directory++7 @
)++@ A
.++A B
FirstOrDefault++B P
(++P Q
x++Q R
=>++S U
x++V W
.++W X
EndsWith++X `
(++` a
$str++a f
)++f g
||++h j
x++k l
.++l m
EndsWith++m u
(++u v
$str++v |
)++| }
)++} ~
;++~ 
if,, 
(,, 
string,, 
.,, 
IsNullOrEmpty,, #
(,,# $
htmlFile,,$ ,
),,, -
),,- .
throw-- 
new-- 
AdsException-- &
(--& '
$str--' 7
)--7 8
;--8 9
UploadFileStatus// 
status// #
=//$ %
ProcessHtml//& 1
(//1 2
htmlFile//2 :
,//: ;
htmlFilePath//< H
)//H I
;//I J
uploader22 
.22 
CreateDirectory22 $
(22$ %
orderNumber22% 0
)220 1
;221 2
string55 
filePathLive55 
=55  !
uploader55" *
.55* +
Upload55+ 1
(551 2
orderNumber552 =
,55= >
htmlFileName55? K
,55K L
htmlFilePath55M Y
)55Y Z
;55Z [
var88 

imagesLive88 
=88 
$"88 
{88  
orderNumber88  +
}88+ ,
/88, -
{88- .
orderNumber88. 9
}889 :
img88: =
"88= >
;88> ?
uploader99 
.99 
CreateDirectory99 $
(99$ %

imagesLive99% /
)99/ 0
;990 1
var<< 
images<< 
=<< 
	Directory<< "
.<<" # 
EnumerateDirectories<<# 7
(<<7 8
	directory<<8 A
)<<A B
.<<B C
FirstOrDefault<<C Q
(<<Q R
)<<R S
;<<S T
if== 
(== 
images== 
!=== 
null== 
)== 
foreach>> 
(>> 
var>> 
imgFile>> $
in>>% '
	Directory>>( 1
.>>1 2
EnumerateFiles>>2 @
(>>@ A
images>>A G
)>>G H
)>>H I
{?? 
var@@ 
file@@ 
=@@ 
new@@ "
FileInfo@@# +
(@@+ ,
imgFile@@, 3
)@@3 4
;@@4 5
uploaderAA 
.AA 
UploadAA #
(AA# $

imagesLiveAA$ .
,AA. /
fileAA0 4
.AA4 5
NameAA5 9
,AA9 :
imgFileAA; B
)AAB C
;AAC D
}BB 
newEE 
DirectoryInfoEE 
(EE 
	directoryEE '
)EE' (
.EE( )
DeleteEE) /
(EE/ 0
trueEE0 4
)EE4 5
;EE5 6
returnGG 
newGG 
HtmlProcessResultGG (
(GG( )
)GG) *
{GG+ ,
StatusGG, 2
=GG3 4
statusGG5 ;
,GG; <
filePathLiveGG= I
=GGJ K
filePathLiveGGL X
}GGX Y
;GGY Z
}HH 	
publicJJ 
staticJJ 
UploadFileStatusJJ &
ProcessHtmlJJ' 2
(JJ2 3
stringJJ3 9
htmlFileJJ: B
,JJB C
stringJJD J
outputFilePathJJK Y
)JJY Z
{KK 	
stringLL 

imagesPathLL 
=LL 
stringLL  &
.LL& '
FormatLL' -
(LL- .
$strLL. ^
,LL^ _
_orderNumberLL` l
)LLl m
;LLm n
HtmlDocumentNN 
docNN 
=NN 
newNN "
HtmlDocumentNN# /
(NN/ 0
)NN0 1
;NN1 2
docOO 
.OO 
LoadOO 
(OO 
htmlFileOO 
)OO 
;OO 
varPP 
allSrcsPP 
=PP 
docPP 
.PP 
DocumentNodePP *
.PP* +
SelectNodesPP+ 6
(PP6 7
$strPP7 D
)PPD E
;PPE F
boolQQ 
alreadyHostedQQ 
=QQ  
falseQQ! &
;QQ& '
foreachRR 
(RR 
HtmlNodeRR 
nodeRR "
inRR# %
allSrcsRR& -
)RR- .
{SS 
varTT 
srcTT 
=TT 
nodeTT 
.TT 

AttributesTT )
[TT) *
$strTT* /
]TT/ 0
.TT0 1
ValueTT1 6
;TT6 7
ifVV 
(VV 
srcVV 
.VV 
ContainsVV  
(VV  !
$strVV! *
)VV* +
)VV+ ,
{WW 
alreadyHostedXX !
=XX" #
trueXX$ (
;XX( )
breakYY 
;YY 
;YY 
}ZZ 
else[[ 
{\\ 
var__ 
srcs__ 
=__ 
src__ "
.__" #
Split__# (
(__( )
$str__) ,
.__, -
ToCharArray__- 8
(__8 9
)__9 :
)__: ;
;__; <
string`` 
imgFileName`` &
=``' (
srcs``) -
.``- .
Length``. 4
>``5 6
$num``7 8
?``9 :
srcs``; ?
[``? @
$num``@ A
]``A B
:``C D
string``E K
.``K L
Empty``L Q
;``Q R
srcaa 
=aa 
stringaa  
.aa  !
Formataa! '
(aa' (
$straa( 0
,aa0 1

imagesPathaa2 <
,aa< =
imgFileNameaa> I
)aaI J
;aaJ K
}bb 
nodecc 
.cc 
SetAttributeValuecc &
(cc& '
$strcc' ,
,cc, -
srccc. 1
)cc1 2
;cc2 3
}dd 
HtmlNodeff 
bodyff 
=ff 
docff 
.ff  
DocumentNodeff  ,
.ff, -
SelectSingleNodeff- =
(ff= >
$strff> F
)ffF G
;ffG H
ifgg 
(gg 
_isAddViewinBrowsergg #
)gg# $
{hh 
HtmlNodeii 
newNodeii  
=ii! "
HtmlNodeii# +
.ii+ ,

CreateNodeii, 6
(ii6 7
ViewInBrowserii7 D
)iiD E
;iiE F
bodyjj 
.jj 
PrependChildjj !
(jj! "
newNodejj" )
)jj) *
;jj* +
}kk 
ifll 
(ll 
_isAddOptoutll 
)ll 
{mm 
HtmlNodenn 
newNodenn  
=nn! "
HtmlNodenn# +
.nn+ ,

CreateNodenn, 6
(nn6 7
OptOutnn7 =
)nn= >
;nn> ?
bodyoo 
.oo 
AppendChildoo  
(oo  !
newNodeoo! (
)oo( )
;oo) *
}pp 
docrr 
.rr 
Saverr 
(rr 
outputFilePathrr #
)rr# $
;rr$ %
returntt 
alreadyHostedtt  
?tt! "
UploadFileStatustt# 3
.tt3 4
HostedWithOutImagestt4 G
:ttH I
UploadFileStatusttK [
.tt[ \
HostedWithImagestt\ l
;ttl m
}uu 	
publicww 
staticww 
stringww 

UploadFileww '
(ww' (
UploadFileTypeww( 6
uploadFileTypeww7 E
,wwE F
stringwwG M
filePathwwN V
,wwV W
stringwwX ^
orderNumberww_ j
)wwj k
{xx 	
FileUploaderyy 
uploaderyy !
=yy" #
newyy$ '
FileUploaderyy( 4
(yy4 5
)yy5 6
;yy6 7
uploader|| 
.|| 
CreateDirectory|| $
(||$ %
orderNumber||% 0
)||0 1
;||1 2
string~~ 
fileName~~ 
=~~ 
$str~~  
;~~  !
switch 
( 
uploadFileType "
)" #
{
ÄÄ 
case
ÅÅ 
UploadFileType
ÅÅ '
.
ÅÅ' (
ZipFile
ÅÅ( /
:
ÅÅ/ 0
fileName
ÇÇ  
=
ÇÇ! "
string
ÇÇ# )
.
ÇÇ) *
Format
ÇÇ* 0
(
ÇÇ0 1
$str
ÇÇ1 =
,
ÇÇ= >
orderNumber
ÇÇ? J
)
ÇÇJ K
;
ÇÇK L
break
ÉÉ 
;
ÉÉ 
case
ÑÑ 
UploadFileType
ÑÑ '
.
ÑÑ' (
TestSeedFile
ÑÑ( 4
:
ÑÑ4 5
fileName
ÖÖ  
=
ÖÖ! "
string
ÖÖ# )
.
ÖÖ) *
Format
ÖÖ* 0
(
ÖÖ0 1
$str
ÖÖ1 >
,
ÖÖ> ?
orderNumber
ÖÖ@ K
)
ÖÖK L
;
ÖÖL M
break
ÜÜ 
;
ÜÜ 
case
áá 
UploadFileType
áá '
.
áá' (
LiveSeedFile
áá( 4
:
áá4 5
fileName
àà  
=
àà! "
string
àà# )
.
àà) *
Format
àà* 0
(
àà0 1
$str
àà1 >
,
àà> ?
orderNumber
àà@ K
)
ààK L
;
ààL M
break
ââ 
;
ââ 
case
ää 
UploadFileType
ää '
.
ää' (
SuppressionFile
ää( 7
:
ää7 8
fileName
ãã  
=
ãã! "
string
ãã# )
.
ãã) *
Format
ãã* 0
(
ãã0 1
$str
ãã1 >
,
ãã> ?
orderNumber
ãã@ K
)
ããK L
;
ããL M
break
åå 
;
åå 
}
çç 
return
éé 
uploader
éé 
.
éé 
Upload
éé "
(
éé" #
orderNumber
éé# .
,
éé. /
fileName
éé0 8
,
éé8 9
filePath
éé: B
)
ééB C
;
ééC D
}
èè 	
}
êê 
}ëë èè
@E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\FileProcessor.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Async 
{ 
public 

static 
class 
FileProcessor %
{ 
public 
static 
void 
ProcessNewOrder *
(* +
string+ 1
orderNumber2 =
,= >
string? E
userNameF N
)N O
{ 	
using 
( 
var 
db 
= 
new 
WfpictContext  -
(- .
). /
)/ 0
{ 
var 
campaign 
= 
db !
.! "
	Campaigns" +
.+ ,
Include, 3
(3 4
x4 5
=>6 8
x9 :
.: ;
Assets; A
)A B
.B C
IncludeC J
(J K
xK L
=>M O
xP Q
.Q R
SegmentsR Z
)Z [
.! "
FirstOrDefault" 0
(0 1
x1 2
=>3 5
x6 7
.7 8
OrderNumber8 C
==D F
orderNumberG R
)R S
;S T
var 
user 
= 
db 
. 
Users #
.# $
FirstOrDefault$ 2
(2 3
x3 4
=>5 7
x8 9
.9 :
UserName: B
==C E
userNameF N
)N O
;O P
var 
ads 
= 
db 
. 
Vendors $
.$ %
FirstOrDefault% 3
(3 4
x4 5
=>6 8
x9 :
.: ;
Name; ?
.? @
Contains@ H
(H I
$strI N
)N O
)O P
;P Q
if 
( 
! 
string 
. 
IsNullOrEmpty )
() *
campaign* 2
.2 3
Assets3 9
.9 :
CreativeFiles: G
)G H
)H I
{ 
string 
amazonFileKey (
=) *
string+ 1
.1 2
Format2 8
(8 9
$str9 K
,K L
campaignM U
.U V
OrderNumberV a
)a b
;b c
S3FileManager !
.! "
Move" &
(& '
campaign' /
./ 0
Assets0 6
.6 7
CreativeFiles7 D
,D E
amazonFileKeyF S
,S T
campaignU ]
.] ^
OrderNumber^ i
,i j
truek o
)o p
;p q
campaign 
. 
Assets #
.# $
CreativeFiles$ 1
=2 3
amazonFileKey4 A
;A B
	LogHelper   
.   
AddLog   $
(  $ %
db  % '
,  ' (
LogType  ) 0
.  0 1
FileProcessing  1 ?
,  ? @
orderNumber  A L
,  L M
$str  N g
+  h i
amazonFileKey  j w
)  w x
;  x y
}!! 
if"" 
("" 
!"" 
string"" 
."" 
IsNullOrEmpty"" )
("") *
campaign""* 2
.""2 3
Assets""3 9
.""9 :
ZipCodeFile"": E
)""E F
)""F G
{## 
string$$ 
amazonFileKey$$ (
=$$) *
string$$+ 1
.$$1 2
Format$$2 8
($$8 9
$str$$9 I
,$$I J
campaign$$K S
.$$S T
OrderNumber$$T _
)$$_ `
;$$` a
S3FileManager%% !
.%%! "
Move%%" &
(%%& '
campaign%%' /
.%%/ 0
Assets%%0 6
.%%6 7
ZipCodeFile%%7 B
,%%B C
amazonFileKey%%D Q
,%%Q R
campaign%%S [
.%%[ \
OrderNumber%%\ g
,%%g h
true%%i m
)%%m n
;%%n o
campaign&& 
.&& 
Assets&& #
.&&# $
ZipCodeFile&&$ /
=&&0 1
amazonFileKey&&2 ?
;&&? @
	LogHelper'' 
.'' 
AddLog'' $
(''$ %
db''% '
,''' (
LogType'') 0
.''0 1
FileProcessing''1 ?
,''? @
orderNumber''A L
,''L M
$str''N e
+''f g
amazonFileKey''h u
)''u v
;''v w
}(( 
if)) 
()) 
!)) 
string)) 
.)) 
IsNullOrEmpty)) )
())) *
campaign))* 2
.))2 3
Assets))3 9
.))9 :
TestSeedFile)): F
)))F G
)))G H
{** 
string++ 
amazonFileKey++ (
=++) *
string+++ 1
.++1 2
Format++2 8
(++8 9
$str++9 J
,++J K
campaign++L T
.++T U
OrderNumber++U `
)++` a
;++a b
S3FileManager,, !
.,,! "
Move,," &
(,,& '
campaign,,' /
.,,/ 0
Assets,,0 6
.,,6 7
TestSeedFile,,7 C
,,,C D
amazonFileKey,,E R
,,,R S
campaign,,T \
.,,\ ]
OrderNumber,,] h
,,,h i
true,,j n
),,n o
;,,o p
campaign-- 
.-- 
Assets-- #
.--# $
TestSeedFile--$ 0
=--1 2
amazonFileKey--3 @
;--@ A
	LogHelper.. 
... 
AddLog.. $
(..$ %
db..% '
,..' (
LogType..) 0
...0 1
FileProcessing..1 ?
,..? @
orderNumber..A L
,..L M
$str..N f
+..g h
amazonFileKey..i v
)..v w
;..w x
}// 
if00 
(00 
!00 
string00 
.00 
IsNullOrEmpty00 )
(00) *
campaign00* 2
.002 3
Assets003 9
.009 :
LiveSeedFile00: F
)00F G
)00G H
{11 
string22 
amazonFileKey22 (
=22) *
string22+ 1
.221 2
Format222 8
(228 9
$str229 J
,22J K
campaign22L T
.22T U
OrderNumber22U `
)22` a
;22a b
S3FileManager33 !
.33! "
Move33" &
(33& '
campaign33' /
.33/ 0
Assets330 6
.336 7
LiveSeedFile337 C
,33C D
amazonFileKey33E R
,33R S
campaign33T \
.33\ ]
OrderNumber33] h
,33h i
true33j n
)33n o
;33o p
campaign44 
.44 
Assets44 #
.44# $
LiveSeedFile44$ 0
=441 2
amazonFileKey443 @
;44@ A
	LogHelper55 
.55 
AddLog55 $
(55$ %
db55% '
,55' (
LogType55) 0
.550 1
FileProcessing551 ?
,55? @
orderNumber55A L
,55L M
$str55N f
+55g h
amazonFileKey55i v
)55v w
;55w x
}66 
if77 
(77 
!77 
string77 
.77 
IsNullOrEmpty77 )
(77) *
campaign77* 2
.772 3
Assets773 9
.779 :
SuppressionFile77: I
)77I J
)77J K
{88 
string99 
amazonFileKey99 (
=99) *
string99+ 1
.991 2
Format992 8
(998 9
$str999 J
,99J K
campaign99L T
.99T U
OrderNumber99U `
)99` a
;99a b
S3FileManager:: !
.::! "
Move::" &
(::& '
campaign::' /
.::/ 0
Assets::0 6
.::6 7
SuppressionFile::7 F
,::F G
amazonFileKey::H U
,::U V
campaign::W _
.::_ `
OrderNumber::` k
,::k l
true::m q
)::q r
;::r s
campaign;; 
.;; 
Assets;; #
.;;# $
SuppressionFile;;$ 3
=;;4 5
amazonFileKey;;6 C
;;;C D
	LogHelper<< 
.<< 
AddLog<< $
(<<$ %
db<<% '
,<<' (
LogType<<) 0
.<<0 1
FileProcessing<<1 ?
,<<? @
orderNumber<<A L
,<<L M
$str<<N i
+<<j k
amazonFileKey<<l y
)<<y z
;<<z {
}== 
if>> 
(>> 
!>> 
string>> 
.>> 
IsNullOrEmpty>> )
(>>) *
campaign>>* 2
.>>2 3
Assets>>3 9
.>>9 :
BannersFile>>: E
)>>E F
)>>F G
{?? 
string@@ 
amazonFileKey@@ (
=@@) *
string@@+ 1
.@@1 2
Format@@2 8
(@@8 9
$str@@9 L
,@@L M
campaign@@N V
.@@V W
OrderNumber@@W b
,@@b c
Path@@d h
.@@h i
GetExtension@@i u
(@@u v
campaign@@v ~
.@@~ 
Assets	@@ Ö
.
@@Ö Ü
BannersFile
@@Ü ë
)
@@ë í
)
@@í ì
;
@@ì î
S3FileManagerAA !
.AA! "
MoveAA" &
(AA& '
campaignAA' /
.AA/ 0
AssetsAA0 6
.AA6 7
BannersFileAA7 B
,AAB C
amazonFileKeyAAD Q
,AAQ R
campaignAAS [
.AA[ \
OrderNumberAA\ g
,AAg h
trueAAi m
)AAm n
;AAn o
campaignBB 
.BB 
AssetsBB #
.BB# $
BannersFileBB$ /
=BB0 1
amazonFileKeyBB2 ?
;BB? @
	LogHelperCC 
.CC 
AddLogCC $
(CC$ %
dbCC% '
,CC' (
LogTypeCC) 0
.CC0 1
FileProcessingCC1 ?
,CC? @
orderNumberCCA L
,CCL M
$strCCN e
+CCf g
amazonFileKeyCCh u
)CCu v
;CCv w
}DD 
ifEE 
(EE 
!EE 
stringEE 
.EE 
IsNullOrEmptyEE )
(EE) *
campaignEE* 2
.EE2 3
AssetsEE3 9
.EE9 :
BannerLinksFileEE: I
)EEI J
)EEJ K
{FF 
stringGG 
amazonFileKeyGG (
=GG) *
stringGG+ 1
.GG1 2
FormatGG2 8
(GG8 9
$strGG9 Q
,GGQ R
campaignGGS [
.GG[ \
OrderNumberGG\ g
,GGg h
PathGGi m
.GGm n
GetExtensionGGn z
(GGz {
campaign	GG{ É
.
GGÉ Ñ
Assets
GGÑ ä
.
GGä ã
BannerLinksFile
GGã ö
)
GGö õ
)
GGõ ú
;
GGú ù
S3FileManagerHH !
.HH! "
MoveHH" &
(HH& '
campaignHH' /
.HH/ 0
AssetsHH0 6
.HH6 7
BannerLinksFileHH7 F
,HHF G
amazonFileKeyHHH U
,HHU V
campaignHHW _
.HH_ `
OrderNumberHH` k
,HHk l
trueHHm q
)HHq r
;HHr s
campaignII 
.II 
AssetsII #
.II# $
BannerLinksFileII$ 3
=II4 5
amazonFileKeyII6 C
;IIC D
	LogHelperJJ 
.JJ 
AddLogJJ $
(JJ$ %
dbJJ% '
,JJ' (
LogTypeJJ) 0
.JJ0 1
FileProcessingJJ1 ?
,JJ? @
orderNumberJJA L
,JJL M
$strJJN i
+JJj k
amazonFileKeyJJl y
)JJy z
;JJz {
}KK 
ifLL 
(LL 
!LL 
stringLL 
.LL 
IsNullOrEmptyLL )
(LL) *
campaignLL* 2
.LL2 3
AssetsLL3 9
.LL9 :
MiscFileLL: B
)LLB C
)LLC D
{MM 
stringNN 
amazonFileKeyNN (
=NN) *
stringNN+ 1
.NN1 2
FormatNN2 8
(NN8 9
$strNN9 J
,NNJ K
campaignNNL T
.NNT U
OrderNumberNNU `
,NN` a
PathNNb f
.NNf g
GetExtensionNNg s
(NNs t
campaignNNt |
.NN| }
Assets	NN} É
.
NNÉ Ñ
MiscFile
NNÑ å
)
NNå ç
)
NNç é
;
NNé è
S3FileManagerOO !
.OO! "
MoveOO" &
(OO& '
campaignOO' /
.OO/ 0
AssetsOO0 6
.OO6 7
MiscFileOO7 ?
,OO? @
amazonFileKeyOOA N
,OON O
campaignOOP X
.OOX Y
OrderNumberOOY d
,OOd e
trueOOf j
)OOj k
;OOk l
campaignPP 
.PP 
AssetsPP #
.PP# $
MiscFilePP$ ,
=PP- .
amazonFileKeyPP/ <
;PP< =
	LogHelperQQ 
.QQ 
AddLogQQ $
(QQ$ %
dbQQ% '
,QQ' (
LogTypeQQ) 0
.QQ0 1
FileProcessingQQ1 ?
,QQ? @
orderNumberQQA L
,QQL M
$strQQN b
+QQc d
amazonFileKeyQQe r
)QQr s
;QQs t
}RR 
foreachTT 
(TT 
varTT 
segmentTT $
inTT% '
campaignTT( 0
.TT0 1
SegmentsTT1 9
)TT9 :
{UU 
stringVV 
amazonFileKeyVV (
=VV) *
stringVV+ 1
.VV1 2
FormatVV2 8
(VV8 9
$strVV9 K
,VVK L
campaignVVM U
.VVU V
OrderNumberVVV a
,VVa b
segmentVVc j
.VVj k
SegmentNumberVVk x
)VVx y
;VVy z
S3FileManagerWW !
.WW! "
MoveWW" &
(WW& '
segmentWW' .
.WW. /
CreativeFilesWW/ <
,WW< =
amazonFileKeyWW> K
,WWK L
campaignWWM U
.WWU V
OrderNumberWWV a
,WWa b
trueWWc g
)WWg h
;WWh i
segmentXX 
.XX 
CreativeFilesXX )
=XX* +
amazonFileKeyXX, 9
;XX9 :
	LogHelperYY 
.YY 
AddLogYY $
(YY$ %
dbYY% '
,YY' (
LogTypeYY) 0
.YY0 1
FileProcessingYY1 ?
,YY? @
orderNumberYYA L
,YYL M
$strYYN Y
+YYZ [
segmentYY\ c
.YYc d
SegmentNumberYYd q
+YYr s
$str	YYt é
+
YYè ê
amazonFileKey
YYë û
)
YYû ü
;
YYü †
}ZZ 
db\\ 
.\\ 
SaveChanges\\ 
(\\ 
)\\  
;\\  !
EmailHelper^^ 
.^^ "
SendOrderEmailToClient^^ 2
(^^2 3
campaign^^3 ;
,^^; <
user^^= A
,^^A B
ads^^C F
?^^F G
.^^G H
CcEmails^^H P
)^^P Q
;^^Q R
	LogHelper`` 
.`` 
AddLog``  
(``  !
db``! #
,``# $
LogType``% ,
.``, -
Orders``- 3
,``3 4
campaign``5 =
.``= >
OrderNumber``> I
,``I J
$str``K W
+``X Y
campaign``Z b
.``b c
CampaignName``c o
+``p q
$str	``r ¢
+
``£ §
campaign
``• ≠
.
``≠ Æ 
RepresentativeName
``Æ ¿
)
``¿ ¡
;
``¡ ¬
}aa 
}bb 	
publicdd 
staticdd 
voiddd "
ProcessAssetUpdateUrlsdd 1
(dd1 2
stringdd2 8

uploadPathdd9 C
,ddC D
stringddE K
orderNumberddL W
)ddW X
{ee 	
usingff 
(ff 
varff 
dbff 
=ff 
newff 
WfpictContextff  -
(ff- .
)ff. /
)ff/ 0
{gg 
varhh 
campaignhh 
=hh 
dbhh !
.hh! "
	Campaignshh" +
.hh+ ,
Includehh, 3
(hh3 4
xhh4 5
=>hh6 8
xhh9 :
.hh: ;
Assetshh; A
)hhA B
.hhB C
FirstOrDefaulthhC Q
(hhQ R
xhhR S
=>hhT V
xhhW X
.hhX Y
OrderNumberhhY d
==hhe g
orderNumberhhh s
)hhs t
;hht u
varjj 
	directoryjj 
=jj 
stringjj  &
.jj& '
Formatjj' -
(jj- .
$strjj. 8
,jj8 9

uploadPathjj: D
,jjD E
campaignjjF N
.jjN O
OrderNumberjjO Z
)jjZ [
;jj[ \
ifkk 
(kk 
!kk 
	Directorykk 
.kk 
Existskk %
(kk% &
	directorykk& /
)kk/ 0
)kk0 1
	Directorykk2 ;
.kk; <
CreateDirectorykk< K
(kkK L
	directorykkL U
)kkU V
;kkV W
trynn 
{oo 
ifpp 
(pp 
!pp 
stringpp 
.pp  
IsNullOrEmptypp  -
(pp- .
campaignpp. 6
.pp6 7
Assetspp7 =
.pp= >
CreativeFilespp> K
)ppK L
)ppL M
{qq 
stringrr 
filePathrr '
=rr( )
Pathrr* .
.rr. /
Combinerr/ 6
(rr6 7

uploadPathrr7 A
,rrA B
campaignrrC K
.rrK L
AssetsrrL R
.rrR S
CreativeFilesrrS `
)rr` a
;rra b
S3FileManagerss %
.ss% &
Downloadss& .
(ss. /
campaignss/ 7
.ss7 8
Assetsss8 >
.ss> ?
CreativeFilesss? L
,ssL M
filePathssN V
)ssV W
;ssW X
vartt 
resulttt "
=tt# $
FileManagertt% 0
.tt0 1
ProcessHtmlZiptt1 ?
(tt? @

uploadPathtt@ J
,ttJ K
filePathttL T
,ttT U
campaignttV ^
.tt^ _
OrderNumbertt_ j
,ttj k
campaignttl t
.ttt u
IsAddOptOut	ttu Ä
,
ttÄ Å
campaign
ttÇ ä
.
ttä ã 
IsAddViewInBrowser
ttã ù
)
ttù û
;
ttû ü
campaignuu  
.uu  !
Assetsuu! '
.uu' (
CreativeUrluu( 3
=uu4 5
resultuu6 <
.uu< =
filePathLiveuu= I
;uuI J
campaignvv  
.vv  !
Assetsvv! '
.vv' (
CreativeStatusvv( 6
=vv7 8
(vv9 :
intvv: =
)vv= >
resultvv> D
.vvD E
StatusvvE K
;vvK L
	LogHelperww !
.ww! "
AddLogww" (
(ww( )
dbww) +
,ww+ ,
LogTypeww- 4
.ww4 5
FileProcessingww5 C
,wwC D
orderNumberwwE P
,wwP Q
$strwwR m
+wwn o
campaignwwp x
.wwx y
Assetswwy 
.	ww Ä
CreativeUrl
wwÄ ã
+
wwå ç
$str
wwé ö
+
wwõ ú
System
wwù £
.
ww£ §
Enum
ww§ ®
.
ww® ©
GetName
ww© ∞
(
ww∞ ±
typeof
ww± ∑
(
ww∑ ∏
UploadFileStatus
ww∏ »
)
ww» …
,
ww…  
campaign
wwÀ ”
.
ww” ‘
Assets
ww‘ ⁄
.
ww⁄ €
CreativeStatus
ww€ È
)
wwÈ Í
)
wwÍ Î
;
wwÎ Ï
}xx 
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
campaign|| 
.|| 
Assets|| #
.||# $
CreativeStatus||$ 2
=||3 4
(||5 6
int||6 9
)||9 :
UploadFileStatus||: J
.||J K
Failed||K Q
;||Q R
	LogHelper}} 
.}} 
AddError}} &
(}}& '
db}}' )
,}}) *
LogType}}+ 2
.}}2 3
FileProcessing}}3 A
,}}A B
orderNumber}}C N
,}}N O
$str}}P s
+}}t u
ex}}v x
.}}x y
Message	}}y Ä
+
}}Å Ç
$str
}}É è
+
}}ê ë
System
}}í ò
.
}}ò ô
Enum
}}ô ù
.
}}ù û
GetName
}}û •
(
}}• ¶
typeof
}}¶ ¨
(
}}¨ ≠
UploadFileStatus
}}≠ Ω
)
}}Ω æ
,
}}æ ø
campaign
}}¿ »
.
}}» …
Assets
}}… œ
.
}}œ –
CreativeStatus
}}– ﬁ
)
}}ﬁ ﬂ
)
}}ﬂ ‡
;
}}‡ ·
}~~ 
db 
. 
SaveChanges 
( 
)  
;  !
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
string
ÅÅ 
.
ÅÅ 
IsNullOrEmpty
ÅÅ )
(
ÅÅ) *
campaign
ÅÅ* 2
.
ÅÅ2 3
Assets
ÅÅ3 9
.
ÅÅ9 :
ZipCodeFile
ÅÅ: E
)
ÅÅE F
)
ÅÅF G
{
ÇÇ 
campaign
ÑÑ 
.
ÑÑ 
Assets
ÑÑ #
.
ÑÑ# $

ZipCodeUrl
ÑÑ$ .
=
ÑÑ/ 0
FileManager
ÑÑ1 <
.
ÑÑ< =
GetFilePathLive
ÑÑ= L
(
ÑÑL M
UploadFileType
ÑÑM [
.
ÑÑ[ \
ZipFile
ÑÑ\ c
,
ÑÑc d
campaign
ÖÖ  
.
ÖÖ  !
OrderNumber
ÖÖ! ,
)
ÖÖ, -
;
ÖÖ- .
campaign
ÜÜ 
.
ÜÜ 
Assets
ÜÜ #
.
ÜÜ# $
ZipCodeStatus
ÜÜ$ 1
=
ÜÜ2 3
(
ÜÜ4 5
int
ÜÜ5 8
)
ÜÜ8 9
UploadFileStatus
ÜÜ: J
.
ÜÜJ K
	Completed
ÜÜK T
;
ÜÜT U
	LogHelper
áá 
.
áá 
AddLog
áá $
(
áá$ %
db
áá% '
,
áá' (
LogType
áá) 0
.
áá0 1
FileProcessing
áá1 ?
,
áá? @
orderNumber
ááA L
,
ááL M
$str
àà 1
+
àà2 3
campaign
àà4 <
.
àà< =
Assets
àà= C
.
ààC D

ZipCodeUrl
ààD N
+
ààO P
$str
ààQ ]
+
àà^ _
System
ââ 
.
ââ 
Enum
ââ #
.
ââ# $
GetName
ââ$ +
(
ââ+ ,
typeof
ââ, 2
(
ââ2 3
UploadFileStatus
ââ3 C
)
ââC D
,
ââD E
campaign
ââF N
.
ââN O
Assets
ââO U
.
ââU V
ZipCodeStatus
ââV c
)
ââc d
)
ââd e
;
ââe f
}
ää 
if
çç 
(
çç 
!
çç 
string
çç 
.
çç 
IsNullOrEmpty
çç )
(
çç) *
campaign
çç* 2
.
çç2 3
Assets
çç3 9
.
çç9 :
TestSeedFile
çç: F
)
ççF G
)
ççG H
{
éé 
campaign
èè 
.
èè 
Assets
èè #
.
èè# $
TestSeedUrl
èè$ /
=
èè0 1
FileManager
èè2 =
.
èè= >
GetFilePathLive
èè> M
(
èèM N
UploadFileType
èèN \
.
èè\ ]
TestSeedFile
èè] i
,
èèi j
campaign
êê  
.
êê  !
OrderNumber
êê! ,
)
êê, -
;
êê- .
campaign
ëë 
.
ëë 
Assets
ëë #
.
ëë# $
TestSeedStatus
ëë$ 2
=
ëë3 4
(
ëë5 6
int
ëë6 9
)
ëë9 :
UploadFileStatus
ëë; K
.
ëëK L
	Completed
ëëL U
;
ëëU V
	LogHelper
íí 
.
íí 
AddLog
íí $
(
íí$ %
db
íí% '
,
íí' (
LogType
íí) 0
.
íí0 1
FileProcessing
íí1 ?
,
íí? @
orderNumber
ííA L
,
ííL M
$str
ìì 2
+
ìì3 4
campaign
ìì5 =
.
ìì= >
Assets
ìì> D
.
ììD E
TestSeedUrl
ììE P
+
ììQ R
$str
ììS _
+
ìì` a
System
îî 
.
îî 
Enum
îî "
.
îî" #
GetName
îî# *
(
îî* +
typeof
îî+ 1
(
îî1 2
UploadFileStatus
îî2 B
)
îîB C
,
îîC D
campaign
îîE M
.
îîM N
Assets
îîN T
.
îîT U
TestSeedStatus
îîU c
)
îîc d
)
îîd e
;
îîe f
}
ïï 
if
òò 
(
òò 
!
òò 
string
òò 
.
òò 
IsNullOrEmpty
òò )
(
òò) *
campaign
òò* 2
.
òò2 3
Assets
òò3 9
.
òò9 :
LiveSeedFile
òò: F
)
òòF G
)
òòG H
{
ôô 
campaign
öö 
.
öö 
Assets
öö #
.
öö# $
LiveSeedUrl
öö$ /
=
öö0 1
FileManager
öö2 =
.
öö= >
GetFilePathLive
öö> M
(
ööM N
UploadFileType
ööN \
.
öö\ ]
LiveSeedFile
öö] i
,
ööi j
campaign
õõ  
.
õõ  !
OrderNumber
õõ! ,
)
õõ, -
;
õõ- .
campaign
úú 
.
úú 
Assets
úú #
.
úú# $
LiveSeedStatus
úú$ 2
=
úú3 4
(
úú5 6
int
úú6 9
)
úú9 :
UploadFileStatus
úú; K
.
úúK L
	Completed
úúL U
;
úúU V
	LogHelper
ùù 
.
ùù 
AddLog
ùù $
(
ùù$ %
db
ùù% '
,
ùù' (
LogType
ùù) 0
.
ùù0 1
FileProcessing
ùù1 ?
,
ùù? @
orderNumber
ùùA L
,
ùùL M
$str
ûû 2
+
ûû3 4
campaign
ûû5 =
.
ûû= >
Assets
ûû> D
.
ûûD E
LiveSeedUrl
ûûE P
+
ûûQ R
$str
ûûS _
+
ûû` a
System
üü 
.
üü 
Enum
üü #
.
üü# $
GetName
üü$ +
(
üü+ ,
typeof
üü, 2
(
üü2 3
UploadFileStatus
üü3 C
)
üüC D
,
üüD E
campaign
üüF N
.
üüN O
Assets
üüO U
.
üüU V
LiveSeedStatus
üüV d
)
üüd e
)
üüe f
;
üüf g
}
†† 
if
££ 
(
££ 
!
££ 
string
££ 
.
££ 
IsNullOrEmpty
££ )
(
££) *
campaign
££* 2
.
££2 3
Assets
££3 9
.
££9 :
SuppressionFile
££: I
)
££I J
)
££J K
{
§§ 
campaign
•• 
.
•• 
Assets
•• #
.
••# $
SuppressionUrl
••$ 2
=
••3 4
FileManager
••5 @
.
••@ A
GetFilePathLive
••A P
(
••P Q
UploadFileType
••Q _
.
••_ `
SuppressionFile
••` o
,
••o p
campaign
¶¶  
.
¶¶  !
OrderNumber
¶¶! ,
)
¶¶, -
;
¶¶- .
campaign
ßß 
.
ßß 
Assets
ßß #
.
ßß# $
SuppressionStatus
ßß$ 5
=
ßß6 7
(
ßß8 9
int
ßß9 <
)
ßß< =
UploadFileStatus
ßß> N
.
ßßN O
	Completed
ßßO X
;
ßßX Y
	LogHelper
®® 
.
®® 
AddLog
®® $
(
®®$ %
db
®®% '
,
®®' (
LogType
®®) 0
.
®®0 1
FileProcessing
®®1 ?
,
®®? @
orderNumber
®®A L
,
®®L M
$str
©© 5
+
©©6 7
campaign
©©8 @
.
©©@ A
Assets
©©A G
.
©©G H
SuppressionUrl
©©H V
+
©©W X
$str
©©Y e
+
©©f g
System
™™ 
.
™™ 
Enum
™™ #
.
™™# $
GetName
™™$ +
(
™™+ ,
typeof
™™, 2
(
™™2 3
UploadFileStatus
™™3 C
)
™™C D
,
™™D E
campaign
™™F N
.
™™N O
Assets
™™O U
.
™™U V
SuppressionStatus
™™V g
)
™™g h
)
™™h i
;
™™i j
}
´´ 
db
¨¨ 
.
¨¨ 
SaveChanges
¨¨ 
(
¨¨ 
)
¨¨  
;
¨¨  !
if
ØØ 
(
ØØ 
!
ØØ 
string
ØØ 
.
ØØ 
IsNullOrEmpty
ØØ )
(
ØØ) *
campaign
ØØ* 2
.
ØØ2 3
Assets
ØØ3 9
.
ØØ9 :
BannersFile
ØØ: E
)
ØØE F
)
ØØF G
{
∞∞ 
campaign
±± 
.
±± 
Assets
±± #
.
±±# $

BannersUrl
±±$ .
=
±±/ 0
FileManager
±±1 <
.
±±< =
GetFilePathLive
±±= L
(
±±L M
UploadFileType
±±M [
.
±±[ \
BannersFile
±±\ g
,
±±g h
campaign
≤≤  
.
≤≤  !
OrderNumber
≤≤! ,
,
≤≤, -
Path
≤≤. 2
.
≤≤2 3
GetExtension
≤≤3 ?
(
≤≤? @
campaign
≤≤@ H
.
≤≤H I
Assets
≤≤I O
.
≤≤O P
BannersFile
≤≤P [
)
≤≤[ \
)
≤≤\ ]
;
≤≤] ^
campaign
≥≥ 
.
≥≥ 
Assets
≥≥ #
.
≥≥# $
BannersStatus
≥≥$ 1
=
≥≥2 3
(
≥≥4 5
int
≥≥5 8
)
≥≥8 9
UploadFileStatus
≥≥9 I
.
≥≥I J
	Completed
≥≥J S
;
≥≥S T
	LogHelper
¥¥ 
.
¥¥ 
AddLog
¥¥ $
(
¥¥$ %
db
¥¥% '
,
¥¥' (
LogType
¥¥) 0
.
¥¥0 1
FileProcessing
¥¥1 ?
,
¥¥? @
orderNumber
¥¥A L
,
¥¥L M
$str
µµ 1
+
µµ2 3
campaign
µµ4 <
.
µµ< =
Assets
µµ= C
.
µµC D

BannersUrl
µµD N
+
µµO P
$str
µµQ ]
+
µµ^ _
System
∂∂ 
.
∂∂ 
Enum
∂∂ #
.
∂∂# $
GetName
∂∂$ +
(
∂∂+ ,
typeof
∂∂, 2
(
∂∂2 3
UploadFileStatus
∂∂3 C
)
∂∂C D
,
∂∂D E
campaign
∂∂F N
.
∂∂N O
Assets
∂∂O U
.
∂∂U V
BannersStatus
∂∂V c
)
∂∂c d
)
∂∂d e
;
∂∂e f
}
∑∑ 
if
∫∫ 
(
∫∫ 
!
∫∫ 
string
∫∫ 
.
∫∫ 
IsNullOrEmpty
∫∫ )
(
∫∫) *
campaign
∫∫* 2
.
∫∫2 3
Assets
∫∫3 9
.
∫∫9 :
BannerLinksFile
∫∫: I
)
∫∫I J
)
∫∫J K
{
ªª 
campaign
ºº 
.
ºº 
Assets
ºº #
.
ºº# $
BannerLinksUrl
ºº$ 2
=
ºº3 4
FileManager
ºº5 @
.
ºº@ A
GetFilePathLive
ººA P
(
ººP Q
UploadFileType
ººQ _
.
ºº_ `
BannersLinksFile
ºº` p
,
ººp q
campaign
ΩΩ 
.
ΩΩ  
OrderNumber
ΩΩ  +
,
ΩΩ+ ,
Path
ΩΩ- 1
.
ΩΩ1 2
GetExtension
ΩΩ2 >
(
ΩΩ> ?
campaign
ΩΩ? G
.
ΩΩG H
Assets
ΩΩH N
.
ΩΩN O
BannerLinksFile
ΩΩO ^
)
ΩΩ^ _
)
ΩΩ_ `
;
ΩΩ` a
campaign
ææ 
.
ææ 
Assets
ææ #
.
ææ# $
BannerLinksStatus
ææ$ 5
=
ææ6 7
(
ææ8 9
int
ææ9 <
)
ææ< =
UploadFileStatus
ææ= M
.
ææM N
	Completed
ææN W
;
ææW X
	LogHelper
øø 
.
øø 
AddLog
øø $
(
øø$ %
db
øø% '
,
øø' (
LogType
øø) 0
.
øø0 1
FileProcessing
øø1 ?
,
øø? @
orderNumber
øøA L
,
øøL M
$str
¿¿ 5
+
¿¿6 7
campaign
¿¿8 @
.
¿¿@ A
Assets
¿¿A G
.
¿¿G H
BannerLinksUrl
¿¿H V
+
¿¿W X
$str
¿¿Y e
+
¿¿f g
System
¡¡ 
.
¡¡ 
Enum
¡¡ #
.
¡¡# $
GetName
¡¡$ +
(
¡¡+ ,
typeof
¡¡, 2
(
¡¡2 3
UploadFileStatus
¡¡3 C
)
¡¡C D
,
¡¡D E
campaign
¡¡F N
.
¡¡N O
Assets
¡¡O U
.
¡¡U V
BannerLinksStatus
¡¡V g
)
¡¡g h
)
¡¡h i
;
¡¡i j
}
¬¬ 
if
≈≈ 
(
≈≈ 
!
≈≈ 
string
≈≈ 
.
≈≈ 
IsNullOrEmpty
≈≈ )
(
≈≈) *
campaign
≈≈* 2
.
≈≈2 3
Assets
≈≈3 9
.
≈≈9 :
MiscFile
≈≈: B
)
≈≈B C
)
≈≈C D
{
∆∆ 
campaign
«« 
.
«« 
Assets
«« #
.
««# $
MiscUrl
««$ +
=
««, -
FileManager
««. 9
.
««9 :
GetFilePathLive
««: I
(
««I J
UploadFileType
««J X
.
««X Y
MiscFile
««Y a
,
««a b
campaign
»» 
.
»»  
OrderNumber
»»  +
,
»»+ ,
Path
»»- 1
.
»»1 2
GetExtension
»»2 >
(
»»> ?
campaign
»»? G
.
»»G H
Assets
»»H N
.
»»N O
MiscFile
»»O W
)
»»W X
)
»»X Y
;
»»Y Z
campaign
…… 
.
…… 
Assets
…… #
.
……# $

MiscStatus
……$ .
=
……/ 0
(
……1 2
int
……2 5
)
……5 6
UploadFileStatus
……6 F
.
……F G
	Completed
……G P
;
……P Q
	LogHelper
   
.
   
AddLog
   $
(
  $ %
db
  % '
,
  ' (
LogType
  ) 0
.
  0 1
FileProcessing
  1 ?
,
  ? @
orderNumber
  A L
,
  L M
$str
ÀÀ .
+
ÀÀ/ 0
campaign
ÀÀ1 9
.
ÀÀ9 :
Assets
ÀÀ: @
.
ÀÀ@ A
MiscUrl
ÀÀA H
+
ÀÀI J
$str
ÀÀK W
+
ÀÀX Y
System
ÃÃ 
.
ÃÃ 
Enum
ÃÃ #
.
ÃÃ# $
GetName
ÃÃ$ +
(
ÃÃ+ ,
typeof
ÃÃ, 2
(
ÃÃ2 3
UploadFileStatus
ÃÃ3 C
)
ÃÃC D
,
ÃÃD E
campaign
ÃÃF N
.
ÃÃN O
Assets
ÃÃO U
.
ÃÃU V

MiscStatus
ÃÃV `
)
ÃÃ` a
)
ÃÃa b
;
ÃÃb c
}
ÕÕ 
}
ŒŒ 
}
œœ 	
}
–– 
}—— ñ8
GE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\Helpers\FileUploader.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Async 
. 
Helpers #
{ 
public 

class 
FileUploader 
{		 
private

 
string

 
_ftpUsername

 #
;

# $
private 
string 
_ftpPassword #
;# $
private 
string 
_baseURL 
;  
private 
string 
serverPrefix #
=$ %
$str& K
;K L
public 
FileUploader 
( 
) 
{ 	
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 <
]< =
==> @
nullA E
)E F
throw 
new 
AdsException &
(& '
$str' A
)A B
;B C
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 >
]> ?
==@ B
nullC G
)G H
throw 
new 
AdsException &
(& '
$str' C
)C D
;D E
if 
(  
ConfigurationManager $
.$ %
AppSettings% 0
[0 1
$str1 >
]> ?
==@ B
nullC G
)G H
throw 
new 
AdsException &
(& '
$str' C
)C D
;D E
var 
	ftpServer 
=  
ConfigurationManager 0
.0 1
AppSettings1 <
[< =
$str= H
]H I
;I J
_ftpUsername 
=  
ConfigurationManager /
./ 0
AppSettings0 ;
[; <
$str< I
]I J
;J K
_ftpPassword 
=  
ConfigurationManager /
./ 0
AppSettings0 ;
[; <
$str< I
]I J
;J K
_baseURL 
= 
$" 
ftp:// 
{  
	ftpServer  )
}) *
/public_html/ep2/* ;
"; <
;< =
} 	
public 
bool 
DirectoryExists #
(# $
string$ *
directoryPath+ 8
)8 9
{ 	
bool   
directoryExists    
;    !
var!! 
request!! 
=!! 
(!! 
FtpWebRequest!! (
)!!( )

WebRequest!!) 3
.!!3 4
Create!!4 :
(!!: ;
directoryPath!!; H
+!!I J
$str!!K N
)!!N O
;!!O P
request"" 
."" 
Method"" 
="" 
WebRequestMethods"" .
."". /
Ftp""/ 2
.""2 3
ListDirectory""3 @
;""@ A
request## 
.## 
Credentials## 
=##  !
new##" %
NetworkCredential##& 7
(##7 8
_ftpUsername##8 D
,##D E
_ftpPassword##F R
)##R S
;##S T
try$$ 
{%% 
using&& 
(&& 
request&& 
.&& 
GetResponse&& *
(&&* +
)&&+ ,
)&&, -
{'' 
directoryExists(( #
=(($ %
true((& *
;((* +
})) 
}** 
catch++ 
(++ 
WebException++ 
ex++  "
)++" #
{,, 
directoryExists-- 
=--  !
false--" '
;--' (
}.. 
return// 
directoryExists// "
;//" #
}00 	
public22 
void22 
CreateDirectory22 #
(22# $
string22$ *
directoryName22+ 8
)228 9
{33 	
string44 
directoryPath44  
=44! "
_baseURL44# +
+44, -
directoryName44. ;
;44; <
if66 
(66 
DirectoryExists66 
(66 
directoryPath66 ,
)66, -
)66- .
return66/ 5
;665 6

WebRequest88 
request88 
=88  

WebRequest88! +
.88+ ,
Create88, 2
(882 3
directoryPath883 @
)88@ A
;88A B
request99 
.99 
Method99 
=99 
WebRequestMethods99 .
.99. /
Ftp99/ 2
.992 3
MakeDirectory993 @
;99@ A
request:: 
.:: 
Credentials:: 
=::  !
new::" %
NetworkCredential::& 7
(::7 8
_ftpUsername::8 D
,::D E
_ftpPassword::F R
)::R S
;::S T
try;; 
{<< 
var== 
resp== 
=== 
(== 
FtpWebResponse== *
)==* +
request==, 3
.==3 4
GetResponse==4 ?
(==? @
)==@ A
;==A B
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
}BB 
}CC 	
publicEE 
stringEE 
UploadEE 
(EE 
stringEE #
directoryNameEE$ 1
,EE1 2
stringEE3 9
fileNameEE: B
,EEB C
stringEED J
filePathEEK S
)EES T
{FF 	
usingGG 
(GG 
	WebClientGG 
clientGG #
=GG$ %
newGG& )
	WebClientGG* 3
(GG3 4
)GG4 5
)GG5 6
{HH 
clientII 
.II 
CredentialsII "
=II# $
newII% (
NetworkCredentialII) :
(II: ;
_ftpUsernameII; G
,IIG H
_ftpPasswordIII U
)IIU V
;IIV W
stringJJ 
filePathFtpJJ "
=JJ# $
$"JJ% '
{JJ' (
_baseURLJJ( 0
}JJ0 1
{JJ1 2
directoryNameJJ2 ?
}JJ? @
/JJ@ A
{JJA B
fileNameJJB J
}JJJ K
"JJK L
;JJL M
UriKK 
addressKK 
=KK 
newKK !
UriKK" %
(KK% &
filePathFtpKK& 1
)KK1 2
;KK2 3
clientLL 
.LL 

UploadFileLL !
(LL! "
addressLL" )
,LL) *
filePathLL+ 3
)LL3 4
;LL4 5
stringMM 
filePathLiveMM #
=MM$ %
$"MM& (
{MM( )
serverPrefixMM) 5
}MM5 6
{MM6 7
directoryNameMM7 D
}MMD E
/MME F
{MMF G
fileNameMMG O
}MMO P
"MMP Q
;MMQ R
returnNN 
filePathLiveNN #
;NN# $
}OO 
}PP 	
}QQ 
}RR åO
@E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\ImageHelper.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Helpers

 
{ 
public 

class 
ImageHelper 
{ 
private 
string 
_url 
; 
private 
string 
	_filePath  
;  !
public 
ImageHelper 
( 
string !
url" %
,% &
string' -
filePath. 6
)6 7
{ 	
_url 
= 
url 
; 
	_filePath 
= 
filePath  
;  !
} 	
public 
void 
Capture 
( 
) 
{ 	
Thread 
thread 
= 
new 
Thread  &
(& '
delegate' /
(0 1
)1 2
{ 
using 
( 

WebBrowser !
browser" )
=* +
new, /

WebBrowser0 :
(: ;
); <
)< =
{ 
browser 
. 
ScrollBarsEnabled -
=. /
false0 5
;5 6
browser 
. 
AllowNavigation +
=, -
true. 2
;2 3
browser 
. "
ScriptErrorsSuppressed 2
=3 4
true5 9
;9 :
browser 
. 
Navigate $
($ %
_url% )
)) *
;* +
browser"" 
."" 
DocumentCompleted"" -
+="". 0
new""1 43
'WebBrowserDocumentCompletedEventHandler""5 \
(""\ ]
DocumentCompleted""] n
)""n o
;""o p
while## 
(## 
browser## "
.##" #

ReadyState### -
!=##. 0 
WebBrowserReadyState##1 E
.##E F
Complete##F N
)##N O
{$$ 
System%% 
.%% 
Windows%% &
.%%& '
Forms%%' ,
.%%, -
Application%%- 8
.%%8 9
DoEvents%%9 A
(%%A B
)%%B C
;%%C D
}&& 
}'' 
}(( 
)(( 
;(( 
thread)) 
.)) 
SetApartmentState)) $
())$ %
ApartmentState))% 3
.))3 4
STA))4 7
)))7 8
;))8 9
thread** 
.** 
Start** 
(** 
)** 
;** 
thread++ 
.++ 
Join++ 
(++ 
)++ 
;++ 
},, 	
private.. 
void.. 
DocumentCompleted.. &
(..& '
object..' -
sender... 4
,..4 50
$WebBrowserDocumentCompletedEventArgs..6 Z
e..[ \
)..\ ]
{// 	

WebBrowser00 
wb00 
=00 
sender00 "
as00# %

WebBrowser00& 0
;000 1
if11 
(11 
!11 
wb11 
.11 
Document11 
.11 
Title11 "
.11" #
Equals11# )
(11) *
$str11* >
)11> ?
)11? @
{22 
int33 
scrollWidth33 
=33  !
$num33" #
;33# $
int44 
scrollHeight44  
=44! "
$num44# $
;44$ %
scrollHeight66 
=66 
wb66 !
.66! "
Document66" *
.66* +
Body66+ /
.66/ 0
ScrollRectangle660 ?
.66? @
Height66@ F
;66F G
scrollWidth77 
=77 
wb77  
.77  !
Document77! )
.77) *
Body77* .
.77. /
ScrollRectangle77/ >
.77> ?
Width77? D
;77D E
wb88 
.88 
Size88 
=88 
new88 
Size88 "
(88" #
scrollWidth88# .
,88. /
scrollHeight880 <
)88< =
;88= >
Bitmap;; 
bitmap;; 
=;; 
new;;  #
Bitmap;;$ *
(;;* +
wb;;+ -
.;;- .
Width;;. 3
,;;3 4
wb;;5 7
.;;7 8
Height;;8 >
);;> ?
;;;? @
for<< 
(<< 
int<< 
Xcount<< 
=<<  !
$num<<" #
;<<# $
Xcount<<% +
<<<, -
bitmap<<. 4
.<<4 5
Width<<5 :
;<<: ;
Xcount<<< B
++<<B D
)<<D E
for== 
(== 
int== 
Ycount== #
===$ %
$num==& '
;==' (
Ycount==) /
<==0 1
bitmap==2 8
.==8 9
Height==9 ?
;==? @
Ycount==A G
++==G I
)==I J
bitmap>> 
.>> 
SetPixel>> '
(>>' (
Xcount>>( .
,>>. /
Ycount>>0 6
,>>6 7
Color>>8 =
.>>= >
Black>>> C
)>>C D
;>>D E
wb?? 
.?? 
DrawToBitmap?? 
(??  
bitmap??  &
,??& '
new??( +
	Rectangle??, 5
(??5 6
$num??6 7
,??7 8
$num??9 :
,??: ;
wb??< >
.??> ?
Width??? D
,??D E
wb??F H
.??H I
Height??I O
)??O P
)??P Q
;??Q R
bitmap@@ 
.@@ 
Save@@ 
(@@ 
	_filePath@@ %
,@@% &
ImageFormat@@' 2
.@@2 3
Png@@3 6
)@@6 7
;@@7 8
}AA 
}BB 	
publicCC 
staticCC 
stringCC 
GetCapturedImageCC -
(CC- .
stringCC. 4
urlCC5 8
,CC8 9
stringCC: @
filePathCCA I
)CCI J
{DD 	
tryEE 
{FF 
HttpWebRequestGG 
requestGG &
=GG' (
HttpWebRequestGG) 7
.GG7 8
CreateGG8 >
(GG> ?
urlGG? B
)GGB C
asGGD F
HttpWebRequestGGG U
;GGU V
BitmapHH 
bitmapHH 
;HH 
usingII 
(II 
StreamII 
streamII $
=II% &
requestII' .
.II. /
GetResponseII/ :
(II: ;
)II; <
.II< =
GetResponseStreamII= N
(IIN O
)IIO P
)IIP Q
{JJ 
bitmapKK 
=KK 
newKK  
BitmapKK! '
(KK' (
streamKK( .
)KK. /
;KK/ 0
bitmapLL 
.LL 
SaveLL 
(LL  
filePathLL  (
)LL( )
;LL) *
}MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
}RR 
returnSS 
filePathSS 
;SS 
}TT 	
publicVV 
voidVV 
ResizeImageVV 
(VV  
stringVV  &
originalFileVV' 3
,VV3 4
stringVV5 ;
newFileVV< C
,VVC D
intVVE H
newWidthVVI Q
,VVQ R
intVVS V
	maxHeightVVW `
,VV` a
boolVVb f
onlyResizeIfWiderVVg x
)VVx y
{WW 	
SystemXX 
.XX 
DrawingXX 
.XX 
ImageXX  
fullsizeImageXX! .
=XX/ 0
SystemXX1 7
.XX7 8
DrawingXX8 ?
.XX? @
ImageXX@ E
.XXE F
FromFileXXF N
(XXN O
originalFileXXO [
)XX[ \
;XX\ ]
fullsizeImage[[ 
.[[ 

RotateFlip[[ $
([[$ %
System[[% +
.[[+ ,
Drawing[[, 3
.[[3 4
RotateFlipType[[4 B
.[[B C
Rotate180FlipNone[[C T
)[[T U
;[[U V
fullsizeImage\\ 
.\\ 

RotateFlip\\ $
(\\$ %
System\\% +
.\\+ ,
Drawing\\, 3
.\\3 4
RotateFlipType\\4 B
.\\B C
Rotate180FlipNone\\C T
)\\T U
;\\U V
if^^ 
(^^ 
onlyResizeIfWider^^ !
&&^^" $
fullsizeImage^^% 2
.^^2 3
Width^^3 8
<=^^9 ;
newWidth^^< D
)^^D E
newWidth__ 
=__ 
fullsizeImage__ (
.__( )
Width__) .
;__. /
intaa 
	newHeightaa 
=aa 
fullsizeImageaa )
.aa) *
Heightaa* 0
*aa1 2
newWidthaa3 ;
/aa< =
fullsizeImageaa> K
.aaK L
WidthaaL Q
;aaQ R
ifbb 
(bb 
	newHeightbb 
>bb 
	maxHeightbb %
)bb% &
{cc 
newWidthee 
=ee 
fullsizeImageee (
.ee( )
Widthee) .
*ee/ 0
	maxHeightee1 :
/ee; <
fullsizeImageee= J
.eeJ K
HeighteeK Q
;eeQ R
	newHeightff 
=ff 
	maxHeightff %
;ff% &
}gg 
Systemii 
.ii 
Drawingii 
.ii 
Imageii  
newImageii! )
=ii* +
fullsizeImageii, 9
.ii9 :
GetThumbnailImageii: K
(iiK L
newWidthiiL T
,iiT U
	newHeightiiV _
,ii_ `
nulliia e
,iie f
IntPtriig m
.iim n
Zeroiin r
)iir s
;iis t
fullsizeImagell 
.ll 
Disposell !
(ll! "
)ll" #
;ll# $
newImageoo 
.oo 
Saveoo 
(oo 
newFileoo !
)oo! "
;oo" #
}pp 	
}qq 
}rr †
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\KeyGenerator.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 
KeyGenerator 
{ 
public 
static 
string 
GetUniqueKey )
() *
int* -
maxSize. 5
)5 6
{		 	
char

 
[

 
]

 
chars

 
=

 
new

 
char

 #
[

# $
$num

$ &
]

& '
;

' (
chars 
= 
$str :
.: ;
ToCharArray; F
(F G
)G H
;H I
byte 
[ 
] 
data 
= 
new 
byte "
[" #
$num# $
]$ %
;% &
using 
( $
RNGCryptoServiceProvider +
crypto, 2
=3 4
new5 8$
RNGCryptoServiceProvider9 Q
(Q R
)R S
)S T
{ 
crypto 
. 
GetNonZeroBytes &
(& '
data' +
)+ ,
;, -
data 
= 
new 
byte 
[  
maxSize  '
]' (
;( )
crypto 
. 
GetNonZeroBytes &
(& '
data' +
)+ ,
;, -
} 
StringBuilder 
result  
=! "
new# &
StringBuilder' 4
(4 5
maxSize5 <
)< =
;= >
foreach 
( 
byte 
b 
in 
data #
)# $
{ 
result 
. 
Append 
( 
chars #
[# $
b$ %
%& '
(( )
chars) .
.. /
Length/ 5
)5 6
]6 7
)7 8
;8 9
} 
return 
result 
. 
ToString "
(" #
)# $
;$ %
} 	
} 
} Ê
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\ListExtensions.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

static 
class 
ListExtensions &
{ 
public		 
static		 
DataSet		 
	ToDataSet		 '
<		' (
T		( )
>		) *
(		* +
this		+ /
IList		0 5
<		5 6
T		6 7
>		7 8
list		9 =
)		= >
{

 	
var 
ds 
= 
new 
DataSet  
(  !
)! "
;" #
ds 
. 
Tables 
. 
Add 
( 
list 
. 
ToDataTable *
(* +
)+ ,
), -
;- .
return 
ds 
; 
} 	
public 
static 
	DataTable 
ToDataTable  +
<+ ,
T, -
>- .
(. /
this/ 3
IList4 9
<9 :
T: ;
>; <
list= A
)A B
{ 	
Type 
elementType 
= 
typeof %
(% &
T& '
)' (
;( )
	DataTable 
t 
= 
new 
	DataTable '
(' (
)( )
;) *
foreach 
( 
var 
propInfo !
in" $
elementType% 0
.0 1
GetProperties1 >
(> ?
)? @
)@ A
{ 
Type 
ColType 
= 
Nullable '
.' (
GetUnderlyingType( 9
(9 :
propInfo: B
.B C
PropertyTypeC O
)O P
??Q S
propInfoT \
.\ ]
PropertyType] i
;i j
t 
. 
Columns 
. 
Add 
( 
propInfo &
.& '
Name' +
,+ ,
ColType- 4
)4 5
;5 6
} 
foreach 
( 
T 
item 
in 
list #
)# $
{ 
DataRow   
row   
=   
t   
.    
NewRow    &
(  & '
)  ' (
;  ( )
foreach"" 
("" 
var"" 
propInfo"" %
in""& (
elementType"") 4
.""4 5
GetProperties""5 B
(""B C
)""C D
)""D E
{## 
row$$ 
[$$ 
propInfo$$  
.$$  !
Name$$! %
]$$% &
=$$' (
propInfo$$) 1
.$$1 2
GetValue$$2 :
($$: ;
item$$; ?
,$$? @
null$$A E
)$$E F
??$$G I
DBNull$$J P
.$$P Q
Value$$Q V
;$$V W
}%% 
t'' 
.'' 
Rows'' 
.'' 
Add'' 
('' 
row'' 
)'' 
;''  
}(( 
return)) 
t)) 
;)) 
}** 	
}++ 
}-- Ê
>E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\LogHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{		 
public

 

class

 
	LogHelper

 
{ 
public 
static 
void 
AddLog !
(! "
WfpictContext" /
db0 2
,2 3
LogType4 ;
logType< C
,C D
stringE K
OrderNumberL W
,W X
stringY _
Message` g
)g h
{ 	
Add 
( 
db 
, 
logType 
, 
	LogStatus &
.& '
Success' .
,. /
OrderNumber0 ;
,; <
Message= D
)D E
;E F
} 	
public 
static 
void 
AddError #
(# $
WfpictContext$ 1
db2 4
,4 5
LogType6 =
logType> E
,E F
stringG M
OrderNumberN Y
,Y Z
string[ a
Messageb i
)i j
{ 	
Add 
( 
db 
, 
logType 
, 
	LogStatus &
.& '
Error' ,
,, -
OrderNumber. 9
,9 :
Message; B
)B C
;C D
} 	
private 
static 
void 
Add 
(  
WfpictContext  -
db. 0
,0 1
LogType2 9
logType: A
,A B
	LogStatusC L
	logStatusM V
,V W
stringX ^
OrderNumber_ j
,j k
stringl r
Messages z
)z {
{ 	
db 
. 

SystemLogs 
. 
Add 
( 
new !
	SystemLog" +
(+ ,
), -
{ 
Id 
= 
Guid 
. 
NewGuid !
(! "
)" #
,# $
	CreatedAt 
= 
DateTime $
.$ %
Now% (
,( )
LogType 
= 
( 
int 
) 
logType &
,& '
	LogStatus 
= 
( 
int  
)  !
	logStatus! *
,* +
OrderNumber 
= 
OrderNumber )
,) *
Message 
= 
Message !
}   
)   
;   
db!! 
.!! 
SaveChanges!! 
(!! 
)!! 
;!! 
}"" 	
}## 
}$$ º
LE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\MultipleButtonAttribute.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
Method% +
,+ ,
AllowMultiple- :
=; <
false= B
,B C
	InheritedD M
=N O
trueP T
)T U
]U V
public 

class #
MultipleButtonAttribute (
:) *'
ActionNameSelectorAttribute+ F
{		 
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
Argument 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
override 
bool 
IsValidName (
(( )
ControllerContext) :
controllerContext; L
,L M
stringN T

actionNameU _
,_ `

MethodInfoa k

methodInfol v
)v w
{ 	
var 
isValidName 
= 
false #
;# $
var 
keyValue 
= 
string !
.! "
Format" (
(( )
$str) 2
,2 3
Name4 8
,8 9
Argument: B
)B C
;C D
var 
value 
= 
controllerContext )
.) *

Controller* 4
.4 5
ValueProvider5 B
.B C
GetValueC K
(K L
keyValueL T
)T U
;U V
if 
( 
value 
!= 
null 
) 
{ 
controllerContext !
.! "

Controller" ,
., -
ControllerContext- >
.> ?
	RouteData? H
.H I
ValuesI O
[O P
NameP T
]T U
=V W
ArgumentX `
;` a
isValidName 
= 
true "
;" #
} 
return 
isValidName 
; 
} 	
} 
} ó
QE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Hangfire\HangfireAuthorizationFilter.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Hangfire 
{ 
public 

class '
HangfireAuthorizationFilter ,
:- .)
IDashboardAuthorizationFilter/ L
{ 
public 
bool 
	Authorize 
( 
DashboardContext .
context/ 6
)6 7
{		 	
var 
owinContext 
= 
new !
OwinContext" -
(- .
context. 5
.5 6
GetOwinEnvironment6 H
(H I
)I J
)J K
;K L
return 
owinContext 
. 
Authentication -
.- .
User. 2
.2 3
Identity3 ;
.; <
IsAuthenticated< K
;K L
} 	
} 
} ÜÑ
FE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\ProData\ProDataApiManager.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
ProData 
{ 
public 

static 
class 
ProDataApiManager )
{ 
private 
static 
string 
_urlTracking *
=+ ,
$str- t
;t u
private 
static 
string 
_urlCreateOrder -
=. /
$str0 x
;x y
private 
static 
string 
prodataAuth )
=* +
$str, N
;N O
public 
static 
readonly 
string %
Success& -
=. /
$str0 9
;9 :
public 
static 
readonly 
string %
Error& +
=, -
$str. 5
;5 6
static 
readonly 
Random 
Random %
=& '
new( +
Random, 2
(2 3
)3 4
;4 5
public 
static 
void 
Load 
(  
)  !
{ 	
string 
json 
= 
File 
. 
ReadAllText *
(* +
$"+ -
C:\\resp.txt- 9
"9 :
): ;
;; <
ProDataResponse 
m 
= 
JsonConvert  +
.+ ,
DeserializeObject, =
<= >
ProDataResponse> M
>M N
(N O
jsonO S
)S T
;T U
} 	
public!! 
static!! 
ProDataResponse!! %
Create!!& ,
(!!, -
Campaign!!- 5
campaign!!6 >
,!!> ?
CampaignSegment!!@ O
segment!!P W
,!!W X
string!!Y _
whiteLabelDomain!!` p
)!!p q
{"" 	
ProDataRequest## 
request## "
=### $
new##% (
ProDataRequest##) 7
(##7 8
)##8 9
{$$ 
io%% 
=%% 
campaign%% 
.%% 
OrderNumber%% )
,%%) *
campaign_name&& 
=&& 
campaign&&  (
.&&( )
Approved&&) 1
.&&1 2
CampaignName&&2 >
,&&> ?
is_rebroadcast'' 
=''  
campaign''! )
.'') *
Approved''* 2
.''2 3
ReBroadCast''3 >
?''? @
$str''A D
:''E F
$str''G J
,''J K
white_label(( 
=(( 
whiteLabelDomain(( .
,((. /
creative_url)) 
=)) 
campaign)) '
.))' (
Assets))( .
.)). /
CreativeUrl))/ :
,)): ;
quantity** 
=** 
campaign** #
.**# $
Approved**$ ,
.**, -
Quantity**- 5
,**5 6
geo_type++ 
=++ 
$str++ '
,++' (
geo_url,, 
=,, 
campaign,, "
.,," #
Assets,,# )
.,,) *

ZipCodeUrl,,* 4
,,,4 5
ctr_percent-- 
=-- 
$num-- #
,--# $
subject.. 
=.. 
campaign.. "
..." #
Approved..# +
...+ ,
SubjectLine.., 7
,..7 8
	from_name// 
=// 
campaign// $
.//$ %
Approved//% -
.//- .
FromLine//. 6
,//6 7

from_email00 
=00 
campaign00 %
.00% &
RepresentativeEmail00& 9
,009 :
deploy_date11 
=11 
campaign11 &
.11& '
Approved11' /
.11/ 0

DeployDate110 :
?11: ;
.11; <
ToString11< D
(11D E
StringConstants11E T
.11T U 
DateTimeFormatDashes11U i
)11i j
,11j k
}22 
;22 
if44 
(44 
campaign44 
.44 
Approved44 !
.44! "
IsOpenPixel44" -
)44- .
{55 
request66 
.66 
is_open_pixel66 %
=66& '
$str66( +
;66+ ,
request77 
.77 
open_percent77 $
=77% &
(77' (
double77( .
)77. /
campaign77/ 7
.777 8
Approved778 @
.77@ A
	OpenGoals77A J
/77K L
campaign77M U
.77U V
Approved77V ^
.77^ _
Quantity77_ g
;77g h
request88 
.88 

open_pixel88 "
=88# $
campaign88% -
.88- .
Approved88. 6
.886 7
OpenPixelUrl887 C
;88C D
}99 
else:: 
request;; 
.;; 
is_open_pixel;; %
=;;& '
$str;;( +
;;;+ ,
if== 
(== 
segment== 
!=== 
null== 
)==  
{>> 
request?? 
.?? 
is_data_file?? $
=??% &
$str??' *
;??* +
request@@ 
.@@ 
data_file_url@@ %
=@@& '
segment@@( /
.@@/ 0
SegmentDataFileUrl@@0 B
;@@B C
requestAA 
.AA '
data_file_replacement_paramAA 3
=AA4 5
segmentAA6 =
.AA= >
SegmentNumberAA> K
;AAK L
requestBB 
.BB (
data_file_replacement_columnBB 4
=BB5 6
$strBB7 :
;BB: ;
requestCC 
.CC 
data_file_unique_ipCC +
=CC, -
$strCC. 1
;CC1 2
}DD 
elseEE 
requestFF 
.FF 
is_data_fileFF $
=FF% &
$strFF' *
;FF* +
returnHH 
CreateHH 
(HH 
requestHH !
)HH! "
;HH" #
}II 	
privateKK 
staticKK 
ProDataResponseKK &
CreateKK' -
(KK- .
ProDataRequestKK. <
requestKK= D
)KKD E
{LL 	
usingMM 
(MM 

HttpClientMM 
clientMM $
=MM% &
newMM' *

HttpClientMM+ 5
(MM5 6
)MM6 7
)MM7 8
{NN 
clientOO 
.OO 
TimeoutOO 
=OO  
TimeSpanOO! )
.OO) *
FromMinutesOO* 5
(OO5 6
$numOO6 7
)OO7 8
;OO8 9
clientPP 
.PP !
DefaultRequestHeadersPP ,
.PP, -
AddPP- 0
(PP0 1
$strPP1 E
,PPE F
prodataAuthPPG R
)PPR S
;PPS T
varQQ 
httpContentQQ 
=QQ  !
newQQ" %
StringContentQQ& 3
(QQ3 4
requestQQ4 ;
.QQ; <
ToJsonQQ< B
(QQB C
)QQC D
,QQD E
EncodingQQF N
.QQN O
UTF8QQO S
,QQS T
$strQQU g
)QQg h
;QQh i
usingRR 
(RR 
HttpResponseMessageRR *
responseRR+ 3
=RR4 5
clientRR6 <
.RR< =
	PostAsyncRR= F
(RRF G
_urlCreateOrderRRG V
,RRV W
httpContentRRX c
)RRc d
.RRd e
ResultRRe k
)RRk l
usingSS 
(SS 
HttpContentSS "
contentSS# *
=SS+ ,
responseSS- 5
.SS5 6
ContentSS6 =
)SS= >
{TT 
stringUU 
responseContentUU *
=UU+ ,
contentUU- 4
.UU4 5
ReadAsStringAsyncUU5 F
(UUF G
)UUG H
.UUH I
ResultUUI O
;UUO P
ProDataResponseVV #
proDataResponseVV$ 3
;VV3 4
tryWW 
{XX 
proDataResponseYY '
=YY( )
JsonConvertYY* 5
.YY5 6
DeserializeObjectYY6 G
<YYG H
ProDataResponseYYH W
>YYW X
(YYX Y
responseContentYYY h
)YYh i
;YYi j
}ZZ 
catch[[ 
([[ 
	Exception[[ $
ex[[% '
)[[' (
{\\ 
throw]] 
new]] !
AdsException]]" .
(]]. /
$str]]/ u
)]]u v
;]]v w
}^^ 
return`` 
proDataResponse`` *
;``* +
}aa 
}bb 
}cc 	
privategg 
staticgg 
ProDataResponsegg &
Fetchgg' ,
(gg, -
stringgg- 3
orderNumbergg4 ?
)gg? @
{hh 	
ifii 
(ii  
ConfigurationManagerii $
.ii$ %
AppSettingsii% 0
[ii0 1
$strii1 9
]ii9 :
==ii; =
$strii> E
)iiE F
{jj 
orderNumberkk 
=kk 
$strkk $
;kk$ %
}ll 
ProDataResponsenn 
proDataResponsenn +
=nn, -
nullnn. 2
;nn2 3
stringoo 
urloo 
=oo 
stringoo 
.oo  
Formatoo  &
(oo& '
_urlTrackingoo' 3
,oo3 4
orderNumberoo5 @
)oo@ A
;ooA B
usingpp 
(pp 

HttpClientpp 
clientpp $
=pp% &
newpp' *

HttpClientpp+ 5
(pp5 6
)pp6 7
)pp7 8
{qq 
clientrr 
.rr 
Timeoutrr 
=rr  
TimeSpanrr! )
.rr) *
FromMinutesrr* 5
(rr5 6
$numrr6 7
)rr7 8
;rr8 9
clientss 
.ss !
DefaultRequestHeadersss ,
.ss, -
Addss- 0
(ss0 1
$strss1 E
,ssE F
prodataAuthssG R
)ssR S
;ssS T
usingtt 
(tt 
HttpResponseMessagett *
responsett+ 3
=tt4 5
clienttt6 <
.tt< =
GetAsynctt= E
(ttE F
urlttF I
)ttI J
.ttJ K
ResultttK Q
)ttQ R
usinguu 
(uu 
HttpContentuu "
contentuu# *
=uu+ ,
responseuu- 5
.uu5 6
Contentuu6 =
)uu= >
{vv 
stringww 
responseContentww *
=ww+ ,
contentww- 4
.ww4 5
ReadAsStringAsyncww5 F
(wwF G
)wwG H
.wwH I
ResultwwI O
;wwO P
tryxx 
{yy 
proDataResponsezz '
=zz( )
JsonConvertzz* 5
.zz5 6
DeserializeObjectzz6 G
<zzG H
ProDataResponsezzH W
>zzW X
(zzX Y
responseContentzzY h
)zzh i
;zzi j
proDataResponse{{ '
.{{' (
ResponseStatus{{( 6
={{7 8!
ProDataResponseStatus{{9 N
.{{N O
Found{{O T
.{{T U
ToString{{U ]
({{] ^
){{^ _
;{{_ `
}|| 
catch}} 
(}} 
	Exception}} $
ex}}% '
)}}' (
{~~ 
if 
( 
ex 
. 
Message &
.& '
ToLowerInvariant' 7
(7 8
)8 9
.9 :
Contains: B
(B C
$strC P
)P Q
)Q R
{
ÄÄ 
proDataResponse
ÅÅ +
=
ÅÅ, -
new
ÅÅ. 1
ProDataResponse
ÅÅ2 A
(
ÅÅA B
)
ÅÅB C
{
ÇÇ 
ResponseStatus
ÉÉ  .
=
ÉÉ/ 0#
ProDataResponseStatus
ÉÉ1 F
.
ÉÉF G
NotFound
ÉÉG O
.
ÉÉO P
ToString
ÉÉP X
(
ÉÉX Y
)
ÉÉY Z
,
ÉÉZ [
ResponseMessage
ÑÑ  /
=
ÑÑ0 1
$str
ÑÑ2 M
}
ÖÖ 
;
ÖÖ 
}
ÜÜ 
else
áá 
{
àà 
proDataResponse
ââ +
=
ââ, -
new
ââ. 1
ProDataResponse
ââ2 A
(
ââA B
)
ââB C
{
ää 
ResponseStatus
ãã  .
=
ãã/ 0#
ProDataResponseStatus
ãã1 F
.
ããF G
Error
ããG L
.
ããL M
ToString
ããM U
(
ããU V
)
ããV W
,
ããW X
ResponseMessage
åå  /
=
åå0 1
$str
åå2 x
}
çç 
;
çç 
}
éé 
}
êê 
return
íí 
proDataResponse
íí *
;
íí* +
}
ìì 
}
îî 
}
ïï 	
public
óó 
static
óó 
void
óó $
FetchAndUpdateProDatas
óó 1
(
óó1 2
WfpictContext
óó2 ?
db
óó@ B
,
óóB C
string
óóD J
orderNumber
óóK V
)
óóV W
{
òò 	
var
ôô 
logs
ôô 
=
ôô 
db
ôô 
.
ôô 

SystemLogs
ôô $
.
ôô$ %
Where
ôô% *
(
ôô* +
x
ôô+ ,
=>
ôô- /
x
ôô0 1
.
ôô1 2
OrderNumber
ôô2 =
==
ôô> @
orderNumber
ôôA L
&&
ôôM O
x
ôôP Q
.
ôôQ R
LogType
ôôR Y
==
ôôZ \
(
ôô] ^
int
ôô^ a
)
ôôa b
LogType
ôôb i
.
ôôi j
ProData
ôôj q
)
ôôq r
;
ôôr s
foreach
öö 
(
öö 
var
öö 
log
öö 
in
öö 
logs
öö  $
)
öö$ %
{
õõ 
db
úú 
.
úú 

SystemLogs
úú 
.
úú 
Remove
úú $
(
úú$ %
log
úú% (
)
úú( )
;
úú) *
}
ùù 
db
ûû 
.
ûû 
SaveChanges
ûû 
(
ûû 
)
ûû 
;
ûû 
	LogHelper
†† 
.
†† 
AddLog
†† 
(
†† 
db
†† 
,
††  
LogType
††! (
.
††( )
ProData
††) 0
,
††0 1
orderNumber
††2 =
,
††= >
$"
°° "
Starting refresh at 
°° &
{
°°& '
DateTime
°°' /
.
°°/ 0
Now
°°0 3
}
°°3 4
"
°°5 6
)
°°6 7
;
°°7 8
	LogHelper
¢¢ 
.
¢¢ 
AddLog
¢¢ 
(
¢¢ 
db
¢¢ 
,
¢¢  
LogType
¢¢! (
.
¢¢( )
ProData
¢¢) 0
,
¢¢0 1
orderNumber
¢¢2 =
,
¢¢= >
$"
¢¢? A#
Deleting Old ProData 
¢¢A V
"
¢¢V W
)
¢¢W X
;
¢¢X Y
var
§§ 
campagin
§§ 
=
§§ 
db
§§ 
.
§§ 
	Campaigns
§§ '
.
§§' (
FirstOrDefault
§§( 6
(
§§6 7
x
§§7 8
=>
§§9 ;
x
§§< =
.
§§= >
OrderNumber
§§> I
==
§§J L
orderNumber
§§M X
)
§§X Y
;
§§Y Z
var
•• 
proDatas
•• 
=
•• 
db
•• 
.
•• 
ProDatas
•• &
.
••& '
Where
••' ,
(
••, -
x
••- .
=>
••/ 1
x
••2 3
.
••3 4

CampaignId
••4 >
==
••? A
campagin
••B J
.
••J K
Id
••K M
)
••M N
;
••N O
foreach
¶¶ 
(
¶¶ 
var
¶¶ 
proData
¶¶  
in
¶¶! #
proDatas
¶¶$ ,
)
¶¶, -
{
ßß 
db
®® 
.
®® 
ProDatas
®® 
.
®® 
Remove
®® "
(
®®" #
proData
®®# *
)
®®* +
;
®®+ ,
}
©© 
db
™™ 
.
™™ 
SaveChanges
™™ 
(
™™ 
)
™™ 
;
™™ 
var
¨¨ 
data
¨¨ 
=
¨¨ 
Fetch
¨¨ 
(
¨¨ 
orderNumber
¨¨ (
)
¨¨( )
;
¨¨) *
if
≠≠ 
(
≠≠ 
data
≠≠ 
.
≠≠ 
reports
≠≠ 
!=
≠≠ 
null
≠≠  $
&&
≠≠% '
data
≠≠( ,
.
≠≠, -
reports
≠≠- 4
.
≠≠4 5
report
≠≠5 ;
!=
≠≠< >
null
≠≠? C
)
≠≠C D
{
ÆÆ 
var
ØØ 
reports
ØØ 
=
ØØ 
data
ØØ "
.
ØØ" #
reports
ØØ# *
.
ØØ* +
report
ØØ+ 1
;
ØØ1 2
	LogHelper
∞∞ 
.
∞∞ 
AddLog
∞∞  
(
∞∞  !
db
∞∞! #
,
∞∞# $
LogType
∞∞% ,
.
∞∞, -
ProData
∞∞- 4
,
∞∞4 5
orderNumber
∞∞6 A
,
∞∞A B
$"
∞∞C E
{
∞∞E F
reports
∞∞F M
.
∞∞M N
Length
∞∞N T
}
∞∞T U,
 records fetched from ProData 
∞∞U s
"
∞∞s t
)
∞∞t u
;
∞∞u v
foreach
±± 
(
±± 
var
±± 
report
±± #
in
±±$ &
reports
±±' .
)
±±. /
{
≤≤ 
db
≥≥ 
.
≥≥ 
ProDatas
≥≥ 
.
≥≥  
Add
≥≥  #
(
≥≥# $
new
≥≥$ '
Data
≥≥( ,
.
≥≥, -
Entities
≥≥- 5
.
≥≥5 6
ProData
≥≥6 =
(
≥≥= >
)
≥≥> ?
{
¥¥ 
Id
µµ 
=
µµ 
Guid
µµ !
.
µµ! "
NewGuid
µµ" )
(
µµ) *
)
µµ* +
,
µµ+ ,
	CreatedAt
∂∂ !
=
∂∂" #
DateTime
∂∂$ ,
.
∂∂, -
Now
∂∂- 0
,
∂∂0 1

CampaignId
∑∑ "
=
∑∑# $
campagin
∑∑% -
.
∑∑- .
Id
∑∑. 0
,
∑∑0 1
CampaignName
∏∏ $
=
∏∏% &
report
∏∏' -
.
∏∏- .
CampaignName
∏∏. :
,
∏∏: ;
Reportsite_URL
ππ &
=
ππ' (
report
ππ) /
.
ππ/ 0
Reportsite_URL
ππ0 >
,
ππ> ?
Destination_URL
∫∫ '
=
∫∫( )
report
∫∫* 0
.
∫∫0 1
Destination_URL
∫∫1 @
,
∫∫@ A
CampaignStartDate
ªª )
=
ªª* +
report
ªª, 2
.
ªª2 3
CampaignStartDate
ªª3 D
,
ªªD E

ClickCount
ºº "
=
ºº# $
long
ºº% )
.
ºº) *
Parse
ºº* /
(
ºº/ 0
report
ºº0 6
.
ºº6 7

ClickCount
ºº7 A
)
ººA B
,
ººB C
	UniqueCnt
ΩΩ !
=
ΩΩ" #
report
ΩΩ$ *
.
ΩΩ* +
	UniqueCnt
ΩΩ+ 4
,
ΩΩ4 5
	MobileCnt
ææ !
=
ææ" #
report
ææ$ *
.
ææ* +
	MobileCnt
ææ+ 4
,
ææ4 5
ImpressionCnt
øø %
=
øø& '
report
øø( .
.
øø. /
ImpressionCnt
øø/ <
,
øø< =
IO
¿¿ 
=
¿¿ 
report
¿¿ #
.
¿¿# $
IO
¿¿$ &
}
¡¡ 
)
¡¡ 
;
¡¡ 
}
¬¬ 
db
√√ 
.
√√ 
SaveChanges
√√ 
(
√√ 
)
√√  
;
√√  !
	LogHelper
ƒƒ 
.
ƒƒ 
AddLog
ƒƒ  
(
ƒƒ  !
db
ƒƒ! #
,
ƒƒ# $
LogType
ƒƒ% ,
.
ƒƒ, -
ProData
ƒƒ- 4
,
ƒƒ4 5
orderNumber
ƒƒ6 A
,
ƒƒA B
$"
ƒƒB D0
"Refresh completed successfully at 
ƒƒD f
{
ƒƒf g
DateTime
ƒƒg o
.
ƒƒo p
Now
ƒƒp s
}
ƒƒs t
"
ƒƒu v
)
ƒƒv w
;
ƒƒw x
}
≈≈ 
else
∆∆ 
{
«« 
	LogHelper
»» 
.
»» 
AddLog
»»  
(
»»  !
db
»»! #
,
»»# $
LogType
»»% ,
.
»», -
ProData
»»- 4
,
»»4 5
orderNumber
»»6 A
,
»»A B
$"
»»C E 
Prodata response. 
»»E W
{
»»W X
data
»»X \
.
»»\ ]
ToJson
»»] c
(
»»c d
)
»»d e
}
»»e f
"
»»g h
)
»»h i
;
»»i j
throw
…… 
new
…… 
AdsException
…… &
(
……& '
$str
……' m
)
……m n
;
……n o
}
   
}
ÃÃ 	
public
ŒŒ 
static
ŒŒ 
void
ŒŒ %
FetchAndUpdateTrackings
ŒŒ 2
(
ŒŒ2 3
WfpictContext
ŒŒ3 @
db
ŒŒA C
,
ŒŒC D
Campaign
ŒŒE M
campaign
ŒŒN V
)
ŒŒV W
{
œœ 	
	LogHelper
–– 
.
–– 
AddLog
–– 
(
–– 
db
–– 
,
––  
LogType
––! (
.
––( )
ProData
––) 0
,
––0 1
campaign
––2 :
.
––: ;
OrderNumber
––; F
,
––F G
$"
––H J"
Starting refresh at 
––J ^
{
––^ _
DateTime
––_ g
.
––g h
Now
––h k
}
––k l
"
––m n
)
––n o
;
––o p
var
”” 
data
”” 
=
”” 
Fetch
”” 
(
”” 
campaign
”” %
.
””% &
OrderNumber
””& 1
)
””1 2
;
””2 3
SaveProData
‘‘ 
(
‘‘ 
db
‘‘ 
,
‘‘ 
campaign
‘‘ $
.
‘‘$ %
Id
‘‘% '
,
‘‘' (
campaign
‘‘) 1
.
‘‘1 2
OrderNumber
‘‘2 =
,
‘‘= >
string
‘‘? E
.
‘‘E F
Empty
‘‘F K
,
‘‘K L
data
‘‘M Q
)
‘‘Q R
;
‘‘R S
var
’’ 
campaignTracking
’’  
=
’’! "
UpdateTracking
’’# 1
(
’’1 2
db
’’2 4
,
’’4 5
campaign
’’6 >
,
’’> ?
campaign
’’@ H
.
’’H I
OrderNumber
’’I T
,
’’T U
string
’’V \
.
’’\ ]
Empty
’’] b
,
’’b c
data
’’d h
)
’’h i
;
’’i j
SaveNotification
÷÷ 
(
÷÷ 
db
÷÷ 
,
÷÷  
campaign
÷÷! )
.
÷÷) *
Id
÷÷* ,
,
÷÷, -
campaign
÷÷. 6
.
÷÷6 7
OrderNumber
÷÷7 B
,
÷÷B C
string
÷÷D J
.
÷÷J K
Empty
÷÷K P
,
÷÷P Q
data
÷÷R V
.
÷÷V W
ResponseStatus
÷÷W e
,
÷÷e f
campaignTracking
÷÷g w
)
÷÷w x
;
÷÷x y
if
ŸŸ 
(
ŸŸ 
campaign
ŸŸ 
.
ŸŸ 
ReBroadcasted
ŸŸ &
)
ŸŸ& '
{
⁄⁄ 
var
€€ 
data1
€€ 
=
€€ 
Fetch
€€ !
(
€€! "
campaign
€€" *
.
€€* +&
ReBroadcastedOrderNumber
€€+ C
)
€€C D
;
€€D E
SaveProData
‹‹ 
(
‹‹ 
db
‹‹ 
,
‹‹ 
campaign
‹‹  (
.
‹‹( )
Id
‹‹) +
,
‹‹+ ,
campaign
‹‹- 5
.
‹‹5 6&
ReBroadcastedOrderNumber
‹‹6 N
,
‹‹N O
string
‹‹P V
.
‹‹V W
Empty
‹‹W \
,
‹‹\ ]
data1
‹‹^ c
)
‹‹c d
;
‹‹d e
var
›› 
campaignTracking1
›› %
=
››& '
UpdateTracking
››( 6
(
››6 7
db
››7 9
,
››9 :
campaign
››; C
,
››C D
campaign
››E M
.
››M N&
ReBroadcastedOrderNumber
››N f
,
››f g
string
››h n
.
››n o
Empty
››o t
,
››t u
data1
››v {
)
››{ |
;
››| }
SaveNotification
ﬁﬁ  
(
ﬁﬁ  !
db
ﬁﬁ! #
,
ﬁﬁ# $
campaign
ﬁﬁ% -
.
ﬁﬁ- .
Id
ﬁﬁ. 0
,
ﬁﬁ0 1
campaign
ﬁﬁ2 :
.
ﬁﬁ: ;&
ReBroadcastedOrderNumber
ﬁﬁ; S
,
ﬁﬁS T
string
ﬁﬁU [
.
ﬁﬁ[ \
Empty
ﬁﬁ\ a
,
ﬁﬁa b
data1
ﬁﬁc h
.
ﬁﬁh i
ResponseStatus
ﬁﬁi w
,
ﬁﬁw x 
campaignTracking1ﬁﬁy ä
)ﬁﬁä ã
;ﬁﬁã å
}
ﬂﬂ 
foreach
‚‚ 
(
‚‚ 
var
‚‚ 
segment
‚‚  
in
‚‚! #
campaign
‚‚$ ,
.
‚‚, -
Segments
‚‚- 5
.
‚‚5 6
Where
‚‚6 ;
(
‚‚; <
x
‚‚< =
=>
‚‚> @
x
‚‚A B
.
‚‚B C
SegmentStatus
‚‚C P
==
‚‚Q S
(
‚‚T U
int
‚‚U X
)
‚‚X Y
SegmentStatus
‚‚Y f
.
‚‚f g

Monitoring
‚‚g q
)
‚‚q r
)
‚‚r s
{
„„ 
if
‰‰ 
(
‰‰ 
segment
‰‰ 
.
‰‰ 
SegmentStatus
‰‰ )
!=
‰‰* ,
(
‰‰- .
int
‰‰. 1
)
‰‰1 2
SegmentStatus
‰‰3 @
.
‰‰@ A

Monitoring
‰‰A K
)
‰‰K L
continue
‰‰M U
;
‰‰U V
var
ÊÊ 
data1
ÊÊ 
=
ÊÊ 
Fetch
ÊÊ !
(
ÊÊ! "
segment
ÊÊ" )
.
ÊÊ) *
SegmentNumber
ÊÊ* 7
)
ÊÊ7 8
;
ÊÊ8 9
SaveProData
ÁÁ 
(
ÁÁ 
db
ÁÁ 
,
ÁÁ 
campaign
ÁÁ  (
.
ÁÁ( )
Id
ÁÁ) +
,
ÁÁ+ ,
campaign
ÁÁ- 5
.
ÁÁ5 6
OrderNumber
ÁÁ6 A
,
ÁÁA B
segment
ÁÁC J
.
ÁÁJ K
SegmentNumber
ÁÁK X
,
ÁÁX Y
data1
ÁÁZ _
)
ÁÁ_ `
;
ÁÁ` a
var
ËË 
campaignTracking1
ËË %
=
ËË& '
UpdateTracking
ËË( 6
(
ËË6 7
db
ËË7 9
,
ËË9 :
campaign
ËË; C
,
ËËC D
campaign
ËËE M
.
ËËM N
OrderNumber
ËËN Y
,
ËËY Z
segment
ËË[ b
.
ËËb c
SegmentNumber
ËËc p
,
ËËp q
data1
ËËr w
)
ËËw x
;
ËËx y
SaveNotification
ÈÈ  
(
ÈÈ  !
db
ÈÈ! #
,
ÈÈ# $
campaign
ÈÈ% -
.
ÈÈ- .
Id
ÈÈ. 0
,
ÈÈ0 1
campaign
ÈÈ2 :
.
ÈÈ: ;
OrderNumber
ÈÈ; F
,
ÈÈF G
segment
ÈÈH O
.
ÈÈO P
SegmentNumber
ÈÈP ]
,
ÈÈ] ^
data
ÈÈ_ c
.
ÈÈc d
ResponseStatus
ÈÈd r
,
ÈÈr s 
campaignTracking1ÈÈt Ö
)ÈÈÖ Ü
;ÈÈÜ á
}
ÍÍ 
}
ÎÎ 	
private
ÌÌ 
static
ÌÌ 
void
ÌÌ 
SaveProData
ÌÌ '
(
ÌÌ' (
WfpictContext
ÌÌ( 5
db
ÌÌ6 8
,
ÌÌ8 9
Guid
ÌÌ: >
?
ÌÌ> ?

campaignId
ÌÌ@ J
,
ÌÌJ K
string
ÌÌL R
orderNumber
ÌÌS ^
,
ÌÌ^ _
string
ÌÌ` f
segmentNumber
ÌÌg t
,
ÌÌt u
ProDataResponseÌÌv Ö
dataÌÌÜ ä
)ÌÌä ã
{
ÓÓ 	
	LogHelper
 
.
 
AddLog
 
(
 
db
 
,
  
LogType
! (
.
( )
ProData
) 0
,
0 1
orderNumber
2 =
,
= >
$"
? A#
Deleting Old ProData 
A V
"
V W
)
W X
;
X Y
var
ÒÒ 
proDatas
ÒÒ 
=
ÒÒ 
db
ÒÒ 
.
ÒÒ 
ProDatas
ÒÒ &
.
ÒÒ& '
Where
ÒÒ' ,
(
ÒÒ, -
x
ÒÒ- .
=>
ÒÒ/ 1
x
ÒÒ2 3
.
ÒÒ3 4

CampaignId
ÒÒ4 >
==
ÒÒ? A

campaignId
ÒÒB L
&&
ÒÒM O
x
ÒÒP Q
.
ÒÒQ R
OrderNumber
ÒÒR ]
==
ÒÒ^ `
orderNumber
ÒÒa l
&&
ÒÒm o
x
ÒÒp q
.
ÒÒq r
SegmentNumber
ÒÒr 
==ÒÒÄ Ç
segmentNumberÒÒÉ ê
)ÒÒê ë
;ÒÒë í
foreach
ÚÚ 
(
ÚÚ 
var
ÚÚ 
proData
ÚÚ  
in
ÚÚ! #
proDatas
ÚÚ$ ,
)
ÚÚ, -
{
ÛÛ 
db
ÙÙ 
.
ÙÙ 
ProDatas
ÙÙ 
.
ÙÙ 
Remove
ÙÙ "
(
ÙÙ" #
proData
ÙÙ# *
)
ÙÙ* +
;
ÙÙ+ ,
}
ıı 
db
ˆˆ 
.
ˆˆ 
SaveChanges
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
if
˘˘ 
(
˘˘ 
data
˘˘ 
.
˘˘ 
reports
˘˘ 
!=
˘˘ 
null
˘˘  $
&&
˘˘% '
data
˘˘( ,
.
˘˘, -
reports
˘˘- 4
.
˘˘4 5
report
˘˘5 ;
!=
˘˘< >
null
˘˘? C
)
˘˘C D
{
˙˙ 
var
˚˚ 
reports
˚˚ 
=
˚˚ 
data
˚˚ "
.
˚˚" #
reports
˚˚# *
.
˚˚* +
report
˚˚+ 1
;
˚˚1 2
	LogHelper
¸¸ 
.
¸¸ 
AddLog
¸¸  
(
¸¸  !
db
¸¸! #
,
¸¸# $
LogType
¸¸% ,
.
¸¸, -
ProData
¸¸- 4
,
¸¸4 5
orderNumber
¸¸6 A
,
¸¸A B
$"
¸¸C E
{
¸¸E F
reports
¸¸F M
.
¸¸M N
Length
¸¸N T
}
¸¸T U,
 records fetched from ProData 
¸¸U s
"
¸¸s t
)
¸¸t u
;
¸¸u v
foreach
˝˝ 
(
˝˝ 
var
˝˝ 
report
˝˝ #
in
˝˝$ &
reports
˝˝' .
)
˝˝. /
{
˛˛ 
db
ˇˇ 
.
ˇˇ 
ProDatas
ˇˇ 
.
ˇˇ  
Add
ˇˇ  #
(
ˇˇ# $
new
ˇˇ$ '
Data
ˇˇ( ,
.
ˇˇ, -
Entities
ˇˇ- 5
.
ˇˇ5 6
ProData
ˇˇ6 =
(
ˇˇ= >
)
ˇˇ> ?
{
ÄÄ 
Id
ÅÅ 
=
ÅÅ 
Guid
ÅÅ !
.
ÅÅ! "
NewGuid
ÅÅ" )
(
ÅÅ) *
)
ÅÅ* +
,
ÅÅ+ ,
	CreatedAt
ÇÇ !
=
ÇÇ" #
DateTime
ÇÇ$ ,
.
ÇÇ, -
Now
ÇÇ- 0
,
ÇÇ0 1

CampaignId
ÉÉ "
=
ÉÉ# $

campaignId
ÉÉ% /
,
ÉÉ/ 0
OrderNumber
ÑÑ #
=
ÑÑ$ %
orderNumber
ÑÑ& 1
,
ÑÑ1 2
SegmentNumber
ÖÖ %
=
ÖÖ& '
segmentNumber
ÖÖ( 5
,
ÖÖ5 6
CampaignName
áá $
=
áá% &
report
áá' -
.
áá- .
CampaignName
áá. :
,
áá: ;
Reportsite_URL
àà &
=
àà' (
report
àà) /
.
àà/ 0
Reportsite_URL
àà0 >
,
àà> ?
Destination_URL
ââ '
=
ââ( )
report
ââ* 0
.
ââ0 1
Destination_URL
ââ1 @
,
ââ@ A
CampaignStartDate
ää )
=
ää* +
report
ää, 2
.
ää2 3
CampaignStartDate
ää3 D
,
ääD E

ClickCount
ãã "
=
ãã# $
long
ãã% )
.
ãã) *
Parse
ãã* /
(
ãã/ 0
report
ãã0 6
.
ãã6 7

ClickCount
ãã7 A
)
ããA B
,
ããB C
	UniqueCnt
åå !
=
åå" #
report
åå$ *
.
åå* +
	UniqueCnt
åå+ 4
,
åå4 5
	MobileCnt
çç !
=
çç" #
report
çç$ *
.
çç* +
	MobileCnt
çç+ 4
,
çç4 5
ImpressionCnt
éé %
=
éé& '
report
éé( .
.
éé. /
ImpressionCnt
éé/ <
,
éé< =
IO
èè 
=
èè 
report
èè #
.
èè# $
IO
èè$ &
}
êê 
)
êê 
;
êê 
}
ëë 
db
íí 
.
íí 
SaveChanges
íí 
(
íí 
)
íí  
;
íí  !
	LogHelper
ìì 
.
ìì 
AddLog
ìì  
(
ìì  !
db
ìì! #
,
ìì# $
LogType
ìì% ,
.
ìì, -
ProData
ìì- 4
,
ìì4 5
orderNumber
ìì6 A
,
ììA B
$"
ììC E0
"Refresh completed successfully at 
ììE g
{
ììg h
DateTime
ììh p
.
ììp q
Now
ììq t
}
ììt u
"
ììv w
)
ììw x
;
ììx y
}
îî 
}
ññ 	
private
òò 
static
òò 
CampaignTracking
òò '
UpdateTracking
òò( 6
(
òò6 7
WfpictContext
òò7 D
db
òòE G
,
òòG H
Campaign
òòI Q
campaign
òòR Z
,
òòZ [
string
òò\ b
orderNumber
òòc n
,
òòn o
string
òòp v
segmentNumberòòw Ñ
,òòÑ Ö
ProDataResponseòòÜ ï
dataòòñ ö
)òòö õ
{
ôô 	
var
öö 
campaignTracking
öö  
=
öö! "
campaign
öö# +
.
öö+ ,
	Trackings
öö, 5
.
öö5 6
FirstOrDefault
öö6 D
(
ööD E
x
ööE F
=>
ööG I
x
ööJ K
.
ööK L
OrderNumber
ööL W
==
ööX Z
orderNumber
öö[ f
&&
öög i
x
ööj k
.
öök l
SegmentNumber
ööl y
==
ööz |
segmentNumberöö} ä
)ööä ã
;ööã å
if
ùù 
(
ùù 
campaignTracking
ùù  
==
ùù! #
null
ùù$ (
)
ùù( )
{
ûû 
string
üü 
orderNumberRdp
üü %
;
üü% &
long
†† 
quantity
†† 
;
†† 
if
°° 
(
°° 
campaign
°° 
.
°° 
ReBroadcasted
°° *
)
°°* +
{
¢¢ 
orderNumberRdp
££ "
=
££# $
campaign
££% -
.
££- .&
ReBroadcastedOrderNumber
££. F
;
££F G
quantity
§§ 
=
§§ 
campaign
§§ '
.
§§' (#
ReBroadcastedQuantity
§§( =
;
§§= >
}
•• 
else
¶¶ 
{
ßß 
orderNumberRdp
®® "
=
®®# $
campaign
®®% -
.
®®- .
OrderNumber
®®. 9
;
®®9 :
quantity
©© 
=
©© 
campaign
©© '
.
©©' (
Approved
©©( 0
.
©©0 1
Quantity
©©1 9
;
©©9 :
}
™™ 
var
´´ 

trackingId
´´ 
=
´´  
Guid
´´! %
.
´´% &
NewGuid
´´& -
(
´´- .
)
´´. /
;
´´/ 0
campaignTracking
¨¨  
=
¨¨! "
new
¨¨# &
CampaignTracking
¨¨' 7
(
¨¨7 8
)
¨¨8 9
{
≠≠ 
Id
ÆÆ 
=
ÆÆ 

trackingId
ÆÆ #
,
ÆÆ# $
	CreatedAt
ØØ 
=
ØØ 
DateTime
ØØ  (
.
ØØ( )
Now
ØØ) ,
,
ØØ, -

CampaignId
∞∞ 
=
∞∞  
campaign
∞∞! )
.
∞∞) *
Id
∞∞* ,
,
∞∞, -
OrderNumber
±± 
=
±±  !
orderNumberRdp
±±" 0
,
±±0 1
SegmentNumber
≤≤ !
=
≤≤" #
string
≤≤$ *
.
≤≤* +
Empty
≤≤+ 0
,
≤≤0 1
Quantity
≥≥ 
=
≥≥ 
quantity
≥≥ '
,
≥≥' (
DateSent
¥¥ 
=
¥¥ 
DateTime
¥¥ '
.
¥¥' (
Now
¥¥( +
,
¥¥+ ,!
IsCreatedThroughApi
µµ '
=
µµ( )
false
µµ* /
}
∂∂ 
;
∂∂ 
db
∑∑ 
.
∑∑ 
CampaignTrackings
∑∑ $
.
∑∑$ %
Add
∑∑% (
(
∑∑( )
campaignTracking
∑∑) 9
)
∑∑9 :
;
∑∑: ;
db
∏∏ 
.
∏∏ 
SaveChanges
∏∏ 
(
∏∏ 
)
∏∏  
;
∏∏  !
}
ππ 
if
ªª 
(
ªª 
campaignTracking
ªª  
?
ªª  !
.
ªª! "
DateSent
ªª" *
==
ªª+ -
null
ªª. 2
||
ªª3 5
data
ªª6 :
.
ªª: ;
reports
ªª; B
?
ªªB C
.
ªªC D
report
ªªD J
==
ªªK M
null
ªªN R
||
ªªS U
data
ªªV Z
.
ªªZ [
reports
ªª[ b
.
ªªb c
report
ªªc i
.
ªªi j
Length
ªªj p
==
ªªq s
$num
ªªt u
)
ªªu v
return
ªªw }
campaignTrackingªª~ é
;ªªé è
var
ΩΩ 
reports
ΩΩ 
=
ΩΩ 
data
ΩΩ 
.
ΩΩ 
reports
ΩΩ &
.
ΩΩ& '
report
ΩΩ' -
;
ΩΩ- .
var
ææ 
report
ææ 
=
ææ 
reports
ææ  
[
ææ  !
$num
ææ! "
]
ææ" #
;
ææ# $
DateTime
øø 
startDateTime
øø "
;
øø" #
DateTime
¿¿ 
.
¿¿ 
TryParse
¿¿ 
(
¿¿ 
report
¿¿ $
.
¿¿$ %
CampaignStartDate
¿¿% 6
,
¿¿6 7
out
¿¿8 ;
startDateTime
¿¿< I
)
¿¿I J
;
¿¿J K
campaignTracking
¡¡ 
.
¡¡ 
IoNumber
¡¡ %
=
¡¡& '
report
¡¡( .
.
¡¡. /
IO
¡¡/ 1
;
¡¡1 2
campaignTracking
¬¬ 
.
¬¬ 
	StartDate
¬¬ &
=
¬¬' (
startDateTime
¬¬) 6
;
¬¬6 7
campaignTracking
√√ 
.
√√ 
Opened
√√ #
=
√√$ %
campaign
√√& .
.
√√. /
Approved
√√/ 7
.
√√7 8!
IsUseApiDataForOpen
√√8 K
?
√√L M
report
√√N T
.
√√T U
ImpressionCnt
√√U b
:
√√c d
API
√√e h
.
√√h i
Campaign
√√i q
.
√√q r
GetOpens
√√r z
(
√√z {
campaignTracking√√{ ã
.√√ã å
Quantity√√å î
,√√î ï
startDateTime√√ñ £
)√√£ §
;√√§ •
campaignTracking
ƒƒ 
.
ƒƒ 
Clicked
ƒƒ $
=
ƒƒ% &
reports
ƒƒ' .
.
ƒƒ. /
Sum
ƒƒ/ 2
(
ƒƒ2 3
x
ƒƒ3 4
=>
ƒƒ5 7
long
ƒƒ8 <
.
ƒƒ< =
Parse
ƒƒ= B
(
ƒƒB C
x
ƒƒC D
.
ƒƒD E

ClickCount
ƒƒE O
)
ƒƒO P
)
ƒƒP Q
;
ƒƒQ R
campaignTracking
≈≈ 
.
≈≈ 
Mobile
≈≈ #
=
≈≈$ %
reports
≈≈& -
.
≈≈- .
Sum
≈≈. 1
(
≈≈1 2
x
≈≈2 3
=>
≈≈4 6
x
≈≈7 8
.
≈≈8 9
	MobileCnt
≈≈9 B
)
≈≈B C
;
≈≈C D
campaignTracking
∆∆ 
.
∆∆ 
Desktop
∆∆ $
=
∆∆% &
report
∆∆' -
.
∆∆- .
	UniqueCnt
∆∆. 7
;
∆∆7 8
campaignTracking
«« 
.
«« 
Unsub
«« "
=
««# $
Random
««% +
.
««+ ,
Next
««, 0
(
««0 1
$num
««1 2
,
««2 3
$num
««4 7
)
««7 8
;
««8 9
campaignTracking
»» 
.
»» 
Forwards
»» %
=
»»& '
Random
»»( .
.
»». /
Next
»»/ 3
(
»»3 4
$num
»»4 5
,
»»5 6
$num
»»7 :
)
»»: ;
;
»»; <
campaignTracking
…… 
.
…… 
Bounce
…… #
=
……$ %
Random
……& ,
.
……, -
Next
……- 1
(
……1 2
$num
……2 3
,
……3 4
$num
……5 7
)
……7 8
;
……8 9
campaignTracking
   
.
   
Opt
    
=
  ! "
Random
  # )
.
  ) *
Next
  * .
(
  . /
$num
  / 0
,
  0 1
$num
  2 4
)
  4 5
;
  5 6
campaignTracking
ÀÀ 
.
ÀÀ 
OpenedPercentage
ÀÀ -
=
ÀÀ. /
campaignTracking
ÀÀ0 @
.
ÀÀ@ A
Quantity
ÀÀA I
==
ÀÀJ L
$num
ÀÀM N
?
ÀÀO P
$num
ÀÀQ R
:
ÀÀS T
(
ÀÀU V
double
ÀÀV \
)
ÀÀ\ ]
campaignTracking
ÀÀ] m
.
ÀÀm n
Opened
ÀÀn t
/
ÀÀu v
campaignTrackingÀÀw á
.ÀÀá à
QuantityÀÀà ê
;ÀÀê ë
campaignTracking
ÃÃ 
.
ÃÃ 
ClickedPercentage
ÃÃ .
=
ÃÃ/ 0
campaignTracking
ÃÃ1 A
.
ÃÃA B
Quantity
ÃÃB J
==
ÃÃK M
$num
ÃÃN O
?
ÃÃP Q
$num
ÃÃR S
:
ÃÃT U
(
ÃÃV W
double
ÃÃW ]
)
ÃÃ] ^
campaignTracking
ÃÃ^ n
.
ÃÃn o
Clicked
ÃÃo v
/
ÃÃw x
campaignTrackingÃÃy â
.ÃÃâ ä
QuantityÃÃä í
;ÃÃí ì
campaignTracking
ÕÕ 
.
ÕÕ 
UnsubPercentage
ÕÕ ,
=
ÕÕ- .
campaignTracking
ÕÕ/ ?
.
ÕÕ? @
Quantity
ÕÕ@ H
==
ÕÕI K
$num
ÕÕL M
?
ÕÕN O
$num
ÕÕP Q
:
ÕÕR S
(
ÕÕT U
double
ÕÕU [
)
ÕÕ[ \
campaignTracking
ÕÕ\ l
.
ÕÕl m
Unsub
ÕÕm r
/
ÕÕs t
campaignTrackingÕÕu Ö
.ÕÕÖ Ü
QuantityÕÕÜ é
;ÕÕé è
campaignTracking
ŒŒ 
.
ŒŒ #
ClickToOpenPercentage
ŒŒ 2
=
ŒŒ3 4
campaignTracking
ŒŒ5 E
.
ŒŒE F
Opened
ŒŒF L
==
ŒŒM O
$num
ŒŒP Q
?
ŒŒR S
$num
ŒŒT U
:
ŒŒV W
(
ŒŒX Y
double
ŒŒY _
)
ŒŒ_ `
campaignTracking
ŒŒ` p
.
ŒŒp q
Clicked
ŒŒq x
/
ŒŒy z
campaignTrackingŒŒ{ ã
.ŒŒã å
OpenedŒŒå í
;ŒŒí ì
campaignTracking
œœ 
.
œœ #
UnsubToOpenPercentage
œœ 2
=
œœ3 4
campaignTracking
œœ5 E
.
œœE F
Opened
œœF L
==
œœM O
$num
œœP Q
?
œœR S
$num
œœT U
:
œœV W
(
œœX Y
double
œœY _
)
œœ_ `
campaignTracking
œœ` p
.
œœp q
Unsub
œœq v
/
œœw x
campaignTrackingœœy â
.œœâ ä
Openedœœä ê
;œœê ë
db
–– 
.
–– 
SaveChanges
–– 
(
–– 
)
–– 
;
–– 
return
““ 
campaignTracking
““ #
;
““# $
}
”” 	
private
’’ 
static
’’ 
void
’’ 
SaveNotification
’’ ,
(
’’, -
WfpictContext
’’- :
db
’’; =
,
’’= >
Guid
’’? C
?
’’C D

campaignId
’’E O
,
’’O P
string
’’Q W
orderNumber
’’X c
,
’’c d
string
’’e k
segmentNumber
’’l y
,
’’y z
string’’{ Å
responseStatus’’Ç ê
,’’ê ë 
CampaignTracking’’í ¢ 
campaignTracking’’£ ≥
)’’≥ ¥
{
÷÷ 	
int
◊◊ 
?
◊◊ 
hoursPassed
◊◊ 
=
◊◊ 
DateTime
◊◊ '
.
◊◊' (
Now
◊◊( +
.
◊◊+ ,
Hour
◊◊, 0
-
◊◊1 2
campaignTracking
◊◊3 C
.
◊◊C D
DateSent
◊◊D L
?
◊◊L M
.
◊◊M N
Hour
◊◊N R
;
◊◊R S
bool
ÿÿ 
problemFound
ÿÿ 
=
ÿÿ 
false
ÿÿ  %
;
ÿÿ% &
QcRule
ŸŸ 
qcRule
ŸŸ 
=
ŸŸ 
QcRule
ŸŸ "
.
ŸŸ" #%
NotStartedInFirst4Hours
ŸŸ# :
;
ŸŸ: ;
if
€€ 
(
€€ 
responseStatus
€€ 
==
€€ !#
ProDataResponseStatus
€€" 7
.
€€7 8
NotFound
€€8 @
.
€€@ A
ToString
€€A I
(
€€I J
)
€€J K
&&
€€L N
hoursPassed
€€O Z
>=
€€[ ]
$num
€€^ _
)
€€_ `
{
‹‹ 
problemFound
›› 
=
›› 
true
›› #
;
››# $
qcRule
ﬁﬁ 
=
ﬁﬁ 
QcRule
ﬁﬁ 
.
ﬁﬁ  %
NotStartedInFirst4Hours
ﬁﬁ  7
;
ﬁﬁ7 8
}
ﬂﬂ 
if
‚‚ 
(
‚‚ 
campaignTracking
‚‚  
.
‚‚  !
OpenedPercentage
‚‚! 1
<
‚‚2 3
$num
‚‚4 8
&&
‚‚9 ;
hoursPassed
‚‚< G
>=
‚‚H J
$num
‚‚K M
)
‚‚M N
{
„„ 
problemFound
‰‰ 
=
‰‰ 
true
‰‰ #
;
‰‰# $
qcRule
ÂÂ 
=
ÂÂ 
QcRule
ÂÂ 
.
ÂÂ  &
NotHitOpenRate5In24Hours
ÂÂ  8
;
ÂÂ8 9
}
ÊÊ 
if
ÈÈ 
(
ÈÈ 
campaignTracking
ÈÈ  
.
ÈÈ  !
OpenedPercentage
ÈÈ! 1
<
ÈÈ2 3
$num
ÈÈ4 8
&&
ÈÈ9 ;
hoursPassed
ÈÈ< G
>=
ÈÈH J
$num
ÈÈK M
)
ÈÈM N
{
ÍÍ 
problemFound
ÎÎ 
=
ÎÎ 
true
ÎÎ #
;
ÎÎ# $
qcRule
ÏÏ 
=
ÏÏ 
QcRule
ÏÏ 
.
ÏÏ  '
NotHitOpenRate10In72Hours
ÏÏ  9
;
ÏÏ9 :
}
ÌÌ 
if
 
(
 
campaignTracking
  
.
  !
ClickedPercentage
! 2
<
3 4
$num
5 :
&&
; =
hoursPassed
> I
>=
J L
$num
M O
)
O P
{
ÒÒ 
problemFound
ÚÚ 
=
ÚÚ 
true
ÚÚ #
;
ÚÚ# $
qcRule
ÛÛ 
=
ÛÛ 
QcRule
ÛÛ 
.
ÛÛ  )
NotHitClickRate750In24Hours
ÛÛ  ;
;
ÛÛ; <
}
ÙÙ 
if
˜˜ 
(
˜˜ 
campaignTracking
˜˜  
.
˜˜  !
ClickedPercentage
˜˜! 2
<
˜˜3 4
$num
˜˜5 9
&&
˜˜: <
hoursPassed
˜˜= H
>=
˜˜I K
$num
˜˜L N
)
˜˜N O
{
¯¯ 
problemFound
˘˘ 
=
˘˘ 
true
˘˘ #
;
˘˘# $
qcRule
˙˙ 
=
˙˙ 
QcRule
˙˙ 
.
˙˙  *
NotHitClickRate1500In72Hours
˙˙  <
;
˙˙< =
}
˚˚ 
if
˝˝ 
(
˝˝ 
!
˝˝ 
problemFound
˝˝ 
)
˝˝ 
return
˝˝ %
;
˝˝% &
var
ˇˇ 
alreadyNoted
ˇˇ 
=
ˇˇ 
db
ˇˇ !
.
ˇˇ! "
Notifications
ˇˇ" /
.
ÄÄ 
FirstOrDefault
ÄÄ 
(
ÄÄ  
x
ÄÄ  !
=>
ÄÄ" $
x
ÄÄ% &
.
ÄÄ& '

CampaignId
ÄÄ' 1
==
ÄÄ2 4

campaignId
ÄÄ5 ?
&&
ÄÄ@ B
x
ÄÄC D
.
ÄÄD E
OrderNumber
ÄÄE P
==
ÄÄQ S
orderNumber
ÄÄT _
&&
ÄÄ` b
x
ÄÄc d
.
ÄÄd e
SegmentNumber
ÄÄe r
==
ÄÄs u
segmentNumberÄÄv É
&&
ÅÅ 
x
ÅÅ  !
.
ÅÅ! "
QCRule
ÅÅ" (
==
ÅÅ) +
(
ÅÅ, -
int
ÅÅ- 0
)
ÅÅ0 1
qcRule
ÅÅ1 7
&&
ÅÅ8 :
x
ÅÅ; <
.
ÅÅ< =
Status
ÅÅ= C
==
ÅÅD F
(
ÅÅG H
int
ÅÅH K
)
ÅÅK L 
NotificationStatus
ÅÅL ^
.
ÅÅ^ _
Found
ÅÅ_ d
)
ÅÅd e
;
ÅÅe f
if
ÉÉ 
(
ÉÉ 
alreadyNoted
ÉÉ 
==
ÉÉ 
null
ÉÉ  $
)
ÉÉ$ %
{
ÑÑ 
	LogHelper
ÖÖ 
.
ÖÖ 
AddLog
ÖÖ  
(
ÖÖ  !
db
ÖÖ! #
,
ÖÖ# $
LogType
ÖÖ% ,
.
ÖÖ, -
RulesProcessing
ÖÖ- <
,
ÖÖ< =
orderNumber
ÖÖ> I
,
ÖÖI J
$str
ÖÖK c
+
ÖÖd e
qcRule
ÖÖf l
)
ÖÖl m
;
ÖÖm n
db
ÜÜ 
.
ÜÜ 
Notifications
ÜÜ  
.
ÜÜ  !
Add
ÜÜ! $
(
ÜÜ$ %
new
ÜÜ% (
Notification
ÜÜ) 5
(
ÜÜ5 6
)
ÜÜ6 7
{
áá 
Id
àà 
=
àà 
Guid
àà 
.
àà 
NewGuid
àà %
(
àà% &
)
àà& '
,
àà' (
	CreatedAt
ââ 
=
ââ 
DateTime
ââ  (
.
ââ( )
Now
ââ) ,
,
ââ, -

CampaignId
ää 
=
ää  

campaignId
ää! +
,
ää+ ,
OrderNumber
ãã 
=
ãã  !
orderNumber
ãã" -
,
ãã- .
SegmentNumber
åå !
=
åå" #
segmentNumber
åå$ 1
,
åå1 2
Status
çç 
=
çç 
(
çç 
int
çç !
)
çç! " 
NotificationStatus
çç" 4
.
çç4 5
Found
çç5 :
,
çç: ;
	CheckTime
éé 
=
éé 
DateTime
éé  (
.
éé( )
Now
éé) ,
,
éé, -
FoundAt
èè 
=
èè 
DateTime
èè &
.
èè& '
Now
èè' *
,
èè* +
QCRule
êê 
=
êê 
(
êê 
int
êê !
)
êê! "
qcRule
êê" (
}
ëë 
)
ëë 
;
ëë 
db
íí 
.
íí 
SaveChanges
íí 
(
íí 
)
íí  
;
íí  !
}
ìì 
}
ïï 	
}
óó 
}òò ÇB
HE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\Helpers\S3FileManager.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Async 
. 
Helpers #
{ 
public 

class 
S3FileManager 
{		 
public

 
readonly

 
static

 
string

 %
bucket

& ,
=

- .
$str

/ =
;

= >
public 
static 
void 
Upload !
(! "
string" (
fileKey) 0
,0 1
string2 8
localFilePath9 F
,F G
boolH L
ifMakePublicM Y
=Z [
true\ `
,` a
boolb f
	overWriteg p
=q r
falses x
)x y
{ 	
if 
( 
	overWrite 
) 
Delete !
(! "
fileKey" )
)) *
;* +
using 
( 
	IAmazonS3 
client #
=$ %
new& )
AmazonS3Client* 8
(8 9
RegionEndpoint9 G
.G H
USWest2H O
)O P
)P Q
{ 
PutObjectRequest  
request! (
=) *
new+ .
PutObjectRequest/ ?
(? @
)@ A
;A B
request 
. 

BucketName "
=# $
bucket% +
;+ ,
request 
. 
Key 
= 
fileKey %
;% &
request 
. 
FilePath  
=! "
localFilePath# 0
;0 1
client 
. 
	PutObject  
(  !
request! (
)( )
;) *
} 
if 
( 
ifMakePublic 
) 

MakePublic 
( 
fileKey "
)" #
;# $
} 	
public 
static 
void 
Download #
(# $
string$ *
fileKey+ 2
,2 3
string4 :
localFilePath; H
)H I
{ 	
using 
( 
	IAmazonS3 
client #
=$ %
new& )
AmazonS3Client* 8
(8 9
RegionEndpoint9 G
.G H
USWest2H O
)O P
)P Q
{   
GetObjectRequest!!  
request!!! (
=!!) *
new!!+ .
GetObjectRequest!!/ ?
(!!? @
)!!@ A
;!!A B
request"" 
."" 

BucketName"" "
=""# $
bucket""% +
;""+ ,
request## 
.## 
Key## 
=## 
fileKey## %
;##% &
GetObjectResponse$$ !
response$$" *
=$$+ ,
client$$- 3
.$$3 4
	GetObject$$4 =
($$= >
request$$> E
)$$E F
;$$F G
response%% 
.%% %
WriteResponseStreamToFile%% 2
(%%2 3
localFilePath%%3 @
)%%@ A
;%%A B
}&& 
}'' 	
public)) 
static)) 
void)) 
Delete)) !
())! "
string))" (
fileKey))) 0
)))0 1
{** 	
using++ 
(++ 
	IAmazonS3++ 
client++ #
=++$ %
new++& )
AmazonS3Client++* 8
(++8 9
RegionEndpoint++9 G
.++G H
USWest2++H O
)++O P
)++P Q
{,, 
DeleteObjectRequest-- #
request--$ +
=--, -
new--. 1
DeleteObjectRequest--2 E
(--E F
)--F G
;--G H
request.. 
... 

BucketName.. "
=..# $
bucket..% +
;..+ ,
request// 
.// 
Key// 
=// 
fileKey// %
;//% &
client00 
.00 
DeleteObject00 #
(00# $
request00$ +
)00+ ,
;00, -
}11 
}22 	
public44 
static44 
void44 
CreateDirectory44 *
(44* +
string44+ 1

folderName442 <
)44< =
{55 	
using66 
(66 
	IAmazonS366 
client66 #
=66$ %
new66& )
AmazonS3Client66* 8
(668 9
RegionEndpoint669 G
.66G H
USWest266H O
)66O P
)66P Q
{77 
S3DirectoryInfo88 
destination88  +
=88, -
new88. 1
S3DirectoryInfo882 A
(88A B
client88B H
,88H I
bucket88J P
,88P Q

folderName88R \
)88\ ]
;88] ^
if99 
(99 
!99 
destination99  
.99  !
Exists99! '
)99' (
destination99) 4
.994 5
Create995 ;
(99; <
)99< =
;99= >
}:: 
};; 	
public== 
static== 
void== 
Move== 
(==  
string==  &

oldFileKey==' 1
,==1 2
string==2 8

newFileKey==9 C
,==C D
string==E K

folderName==L V
,==V W
bool==X \
	overWrite==] f
===g h
false==i n
)==n o
{>> 	
if?? 
(?? 
string?? 
.?? 
IsNullOrEmpty?? #
(??# $

oldFileKey??$ .
)??. /
)??/ 0
return??1 7
;??7 8
ifAA 
(AA 
	overWriteAA 
)AA 
DeleteAA  
(AA  !

newFileKeyAA! +
)AA+ ,
;AA, -
usingCC 
(CC 
	IAmazonS3CC 
clientCC #
=CC$ %
newCC& )
AmazonS3ClientCC* 8
(CC8 9
RegionEndpointCC9 G
.CCG H
USWest2CCH O
)CCO P
)CCP Q
{DD 

S3FileInfoEE 
currentObjectEE (
=EE) *
newEE+ .

S3FileInfoEE/ 9
(EE9 :
clientEE: @
,EE@ A
bucketEEB H
,EEH I

oldFileKeyEEJ T
)EET U
;EEU V
S3DirectoryInfoFF 
destinationFF  +
=FF, -
newFF. 1
S3DirectoryInfoFF2 A
(FFA B
clientFFB H
,FFH I
bucketFFJ P
,FFP Q

folderNameFFR \
)FF\ ]
;FF] ^
ifGG 
(GG 
!GG 
destinationGG 
.GG  
ExistsGG  &
)GG& '
destinationGG( 3
.GG3 4
CreateGG4 :
(GG: ;
)GG; <
;GG< =

S3FileInfoHH 
movedObjectHH &
=HH' (
currentObjectHH) 6
.HH6 7
MoveToHH7 =
(HH= >
bucketHH> D
,HHD E

newFileKeyHHF P
)HHP Q
;HHQ R
}II 

MakePublicJJ 
(JJ 

newFileKeyJJ !
)JJ! "
;JJ" #
}KK 	
publicMM 
staticMM 
voidMM 

MakePublicMM %
(MM% &
stringMM& ,
fileKeyMM- 4
)MM4 5
{NN 	
usingOO 
(OO 
	IAmazonS3OO 
clientOO #
=OO$ %
newOO& )
AmazonS3ClientOO* 8
(OO8 9
RegionEndpointOO9 G
.OOG H
USWest2OOH O
)OOO P
)OOP Q
{PP 
PutACLRequestQQ 
requestQQ %
=QQ& '
newQQ( +
PutACLRequestQQ, 9
(QQ9 :
)QQ: ;
;QQ; <
requestRR 
.RR 

BucketNameRR "
=RR# $
bucketRR% +
;RR+ ,
requestSS 
.SS 
KeySS 
=SS 
fileKeySS %
;SS% &
requestTT 
.TT 
	CannedACLTT !
=TT" #
S3CannedACLTT$ /
.TT/ 0

PublicReadTT0 :
;TT: ;
clientUU 
.UU 
PutACLUU 
(UU 
requestUU %
)UU% &
;UU& '
}VV 
}WW 	
}XX 
}YY ®
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\NumberHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 
NumberHelper 
{		 
private

 
static

 
int

 
GetTotalFromRange

 ,
(

, -
int

- 0
firstNumber

1 <
,

< =
int

> A
secondNumber

B N
)

N O
{ 	
if 
( 
firstNumber 
== 
$num  
||! #
secondNumber$ 0
==1 3
$num4 5
)5 6
return 
$num 
; 
return 
secondNumber 
-  !
firstNumber" -
+. /
$num0 1
;1 2
} 	
public 
static 
int 
GetTotal "
(" #
int# &

firstStart' 1
,1 2
int3 6
firstEnd7 ?
,? @
intA D
secondStartE P
,P Q
intR U
	secondEndV _
,_ `
inta d

thirdStarte o
,o p
intq t
thirdEndu }
)} ~
{ 	
return 
GetTotalFromRange $
($ %

firstStart% /
,/ 0
firstEnd1 9
)9 :
+; <
GetTotalFromRange= N
(N O
secondStartO Z
,Z [
	secondEnd\ e
)e f
+g h
GetTotalFromRange $
($ %

thirdStart% /
,/ 0
thirdEnd1 9
)9 :
;: ;
} 	
} 
} ∂
BE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\QCRuleUtility.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public		 

static		 
class		 
QcRuleUtility		 %
{

 
public 
static 
string 
	GetString &
(& '
int' *
qcRule+ 1
)1 2
{ 	
switch 
( 
qcRule 
) 
{ 
case 
( 
int 
) 
QcRule  
.  !#
NotStartedInFirst4Hours! 8
:8 9
return 
$str T
;T U
case 
( 
int 
) 
QcRule  
.  !$
NotHitOpenRate5In24Hours! 9
:9 :
return 
$str V
;V W
case 
( 
int 
) 
QcRule  
.  !%
NotHitOpenRate10In72Hours! :
:: ;
return 
$str W
;W X
case 
( 
int 
) 
QcRule  
.  !'
NotHitClickRate750In24Hours! <
:< =
return 
$str Y
;Y Z
case 
( 
int 
) 
QcRule  
.  !(
NotHitClickRate1500In72Hours! =
:= >
return 
$str Y
;Y Z
} 
return 
$str 
; 
} 	
} 
} ≥#
HE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\SortSearchExtension.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

static 
class 
SortSearchExtension +
{		 
public 
static 
IHtmlString !
SortIdentifier" 0
(0 1
this1 5

HtmlHelper6 @

htmlHelperA K
,K L
stringM S
	sortOrderT ]
,] ^
string_ e
fieldf k
)k l
{ 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
	sortOrder% .
). /
||0 2
(3 4
	sortOrder4 =
.= >
Trim> B
(B C
)C D
!=E G
fieldH M
&&N P
	sortOrderQ Z
.Z [
Replace[ b
(b c
$strc j
,j k
$strl n
)n o
.o p
Trimp t
(t u
)u v
!=w y
fieldz 
)	 Ä
)
Ä Å
return
Ç à
null
â ç
;
ç é
string 
glyph 
= 
$str ;
;; <
if 
( 
	sortOrder 
. 
ToLower !
(! "
)" #
.# $
Contains$ ,
(, -
$str- 3
)3 4
)4 5
{ 
glyph 
= 
$str :
;: ;
} 
var 
span 
= 
new 

TagBuilder %
(% &
$str& ,
), -
;- .
span 
. 

Attributes 
[ 
$str #
]# $
=% &
glyph' ,
;, -
return 
MvcHtmlString  
.  !
Create! '
(' (
span( ,
., -
ToString- 5
(5 6
)6 7
)7 8
;8 9
} 	
public)) 
static))  
RouteValueDictionary)) *"
ToRouteValueDictionary))+ A
())A B
this))B F
NameValueCollection))G Z

collection))[ e
,))e f
string))g m
newKey))n t
,))t u
string))v |
newValue	))} Ö
)
))Ö Ü
{** 	
var++  
routeValueDictionary++ $
=++% &
new++' * 
RouteValueDictionary+++ ?
(++? @
)++@ A
;++A B
foreach,, 
(,, 
var,, 
key,, 
in,, 

collection,,  *
.,,* +
AllKeys,,+ 2
),,2 3
{-- 
if.. 
(.. 
key.. 
==.. 
null.. 
)..  
continue..! )
;..) *
if// 
(//  
routeValueDictionary// (
.//( )
ContainsKey//) 4
(//4 5
key//5 8
)//8 9
)//9 : 
routeValueDictionary00 (
.00( )
Remove00) /
(00/ 0
key000 3
)003 4
;004 5 
routeValueDictionary22 $
.22$ %
Add22% (
(22( )
key22) ,
,22, -

collection22. 8
[228 9
key229 <
]22< =
)22= >
;22> ?
}33 
if44 
(44 
string44 
.44 
IsNullOrEmpty44 $
(44$ %
newValue44% -
)44- .
)44. /
{55  
routeValueDictionary66 $
.66$ %
Remove66% +
(66+ ,
newKey66, 2
)662 3
;663 4
}77 
else88 
{99 
if:: 
(::  
routeValueDictionary:: (
.::( )
ContainsKey::) 4
(::4 5
newKey::5 ;
)::; <
)::< = 
routeValueDictionary;; (
.;;( )
Remove;;) /
(;;/ 0
newKey;;0 6
);;6 7
;;;7 8 
routeValueDictionary== $
.==$ %
Add==% (
(==( )
newKey==) /
,==/ 0
newValue==1 9
)==9 :
;==: ;
}>> 
return??  
routeValueDictionary?? '
;??' (
}@@ 	
}AA 
}BB ª
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\StringHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 
StringHelper 
{ 
public		 
static		 
bool		 
Contains		 #
(		# $
string		$ *
Source		+ 1
,		1 2
string		3 9
ToCheck		: A
)		A B
{

 	
if 
( 
string 
. 
IsNullOrEmpty $
($ %
Source% +
)+ ,
), -
return. 4
false5 :
;: ;
return 
Source 
. 
ToLowerInvariant *
(* +
)+ ,
., -
Contains- 5
(5 6
ToCheck6 =
.= >
ToLowerInvariant> N
(N O
)O P
)P Q
;Q R
} 	
public 
static 
string 
URLSubstring )
() *
string* 0
Source1 7
)7 8
{ 	
var 
parts 
= 
Source 
. 
Split $
($ %
$str% )
.) *
ToCharArray* 5
(5 6
)6 7
)7 8
;8 9
return 
string 
. 
Join 
( 
$str "
," #
parts$ )
.) *
ToList* 0
(0 1
)1 2
.2 3
Skip3 7
(7 8
parts8 =
.= >
Length> D
-E F
$numG H
)H I
)I J
;J K
} 	
public 
static 
string 
Trim !
(! "
string" (
source) /
)/ 0
{ 	
var 
lineTrimmed 
= 
Regex #
.# $
Replace$ +
(+ ,
source, 2
,2 3
$str4 @
,@ A
$strB D
,D E
RegexOptions +
.+ ,
None, 0
,0 1
TimeSpan2 :
.: ;
FromSeconds; F
(F G
$numG J
)J K
)K L
;L M
return 
lineTrimmed 
. 
Trim #
(# $
)$ %
;% &
} 	
} 
} Ã
?E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\Extensions.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

static 
class 

Extensions "
{		 
public

 
static

 
string

 
ToJson

 #
(

# $
this

$ (
object

) /
value

0 5
)

5 6
{ 	
return 
JsonConvert 
. 
SerializeObject .
(. /
value/ 4
,4 5

Formatting6 @
.@ A
IndentedA I
)I J
;J K
} 	
public 
static 
string 
ToCapitalized *
(* +
this+ /
string0 6
value7 <
)< =
{ 	
return 
CultureInfo 
. 
CurrentCulture -
.- .
TextInfo. 6
.6 7
ToTitleCase7 B
(B C
valueC H
.H I
ReplaceI P
(P Q
$strQ T
,T U
$strV X
)X Y
)Y Z
;Z [
} 	
public 
static 
bool 
Contains #
(# $
this$ (
string) /
source0 6
,6 7
string8 >
search? E
, 
StringComparison 
compare &
)& '
{ 	
return 
source 
. 
IndexOf !
(! "
search" (
,( )
compare* 1
)1 2
>=3 5
$num6 7
;7 8
} 	
static 
Regex 
r 
= 
new 
Regex "
(" #
$str# ,
,, -
RegexOptions. :
.: ;#
IgnorePatternWhitespace; R
)R S
;S T
public 
static 
string !
ToCapitalLetterString 2
(2 3
this3 7
string8 >
s? @
)@ A
{   	
return!! 
r!! 
.!! 
Replace!! 
(!! 
s!! 
,!! 
$str!!  #
)!!# $
;!!$ %
}"" 	
public$$ 
static$$ 
string$$ 
ToSafeString$$ )
($$) *
this$$* .
Guid$$/ 3
?$$3 4
value$$5 :
)$$: ;
{%% 	
return&& 
value&& 
?&& 
.&& 
ToString&& "
(&&" #
)&&# $
??&&% '
string&&( .
.&&. /
Empty&&/ 4
;&&4 5
}'' 	
public)) 
static)) 
string)) 
ToSafeString)) )
())) *
this))* .
DateTime))/ 7
?))7 8
value))9 >
,))> ?
string))@ F
format))G M
)))M N
{** 	
return++ 
value++ 
?++ 
.++ 
ToString++ "
(++" #
format++# )
)++) *
??+++ -
string++. 4
.++4 5
Empty++5 :
;++: ;
},, 	
}-- 
}.. óË
FE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Async\Helpers\EmailHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Async 
. 
Helpers #
{ 
public 

static 
class 
EmailHelper #
{ 
private 
const 
string 
Footer #
=$ %
$str& `
;` a
public 
static 
async 
Task  "
SendOrderEmailToClient! 7
(7 8
Campaign8 @
campaignA I
,I J
WfpUserK R
loggedInUserS _
,_ `
stringa g
	bccEmailsh q
)q r
{ 	
string 
subject 
= 
$" 
Order #  '
{' (
campaign( 0
.0 1
OrderNumber1 <
}< =
, Campaign Date = M
{M N
campaignN V
.V W
BroadcastDateW d
?d e
.e f
ToStringf n
(n o
$stro r
)r s
}s t
, QTY t z
{z {
campaign	{ É
.
É Ñ
Quantity
Ñ å
}
å ç 
 , Date Submitted 
ç ü
{
ü †
campaign
† ®
.
® ©
	CreatedAt
© ≤
:
≤ ≥
d
≥ ¥
}
¥ µ
"
µ ∂
;
∂ ∑
string 
body 
= 
$@" 
<br/><p>Dear  *
{* +
loggedInUser+ 7
.7 8
UserName8 @
.@ A!
ToCapitalLetterStringA V
(V W
)W X
.X Y
ToCapitalizedY f
(f g
)g h
}h i¨
ü</p><br/>We have recevied your order.<br/><br/>
                        <table border=""2"">
                        <tr><th align=""left"">Order #:</th><td>i @
{@ A
campaignA I
.I J
OrderNumberJ U
}U VW
K</td></tr>
                        <tr><th align=""left"">Status:</th><td>V ?
{? @
(@ A
CampaignStatusA O
)O P
campaignQ Y
.Y Z
StatusZ `
}` aY
M</td></tr>
                        <tr><th align=""left"">Username:</th><td>a A
{A B
loggedInUserB N
.N O
UserNameO W
}W X[
O</td></tr>
                        <tr><th align=""left"">User Email:</th><td>X C
{C D
loggedInUserD P
.P Q
EmailQ V
}V W^
R</td></tr>
                        <tr><th align=""left"">Campaign Name:</th><td>W F
{F G
campaignG O
.O P
CampaignNameP \
}\ ]_
S</td></tr>
                        <tr><th align=""left"">Broadcast Date:</th><td>] G
{G H
campaignH P
.P Q
BroadcastDateQ ^
.^ _
Value_ d
.d e
ToStringe m
(m n
$strn q
)q r
}r s\
P</td></tr>
                        <tr><th align=""left"">Rebroadcast:</th><td>s D
{D E
(E F
campaignF N
.N O
ReBroadCastO Z
?Z [
$str\ a
:a b
$strc g
)g h
}h ia
U</td></tr>
                        <tr><th align=""left"">Rebroadcast Date:</th><td>i I
{I J
(J K
campaignK S
.S T
ReBroadcastDateT c
.c d
HasValued l
?l m
campaignn v
.v w
ReBroadcastDate	w Ü
.
Ü á
ToString
á è
(
è ê
)
ê ë
:
ë í
$str
ì ï
)
ï ñ
}
ñ ó[
N</td></tr>
                        <tr><th align=""left"">From Line:</th><td>	 ó B
{  B C
campaign  C K
.  K L
FromLine  L T
}  T U]
Q</td></tr>
                        <tr><th align=""left"">Subject Line:</th><td> !U E
{!!E F
campaign!!F N
.!!N O
SubjectLine!!O Z
}!!Z [`
T</td></tr>
                        <tr><th align=""left"">Personalization:</th><td>!"[ H
{""H I
(""I J
campaign""J R
.""R S
IsPersonalization""S d
?""d e
$str""f k
:""k l
$str""m q
)""q r
}""r sZ
N</td></tr>
                        <tr><th align=""left"">Matchback:</th><td>"#s B
{##B C
(##C D
campaign##D L
.##L M
IsMatchback##M X
?##Y Z
$str##[ `
:##a b
$str##c g
)##g h
}##h i\
P</td></tr>
                        <tr><th align=""left"">Suppression:</th><td>#$i D
{$$D E
($$E F
campaign$$F N
.$$N O
IsSuppression$$O \
?$$\ ]
$str$$^ c
:$$c d
$str$$e i
)$$i j
}$$j k\
P</td></tr>
                        <tr><th align=""left"">White Label:</th><td>$%k D
{%%D E
campaign%%E M
.%%M N

WhiteLabel%%N X
}%%X YZ
N</td></tr>
                        <tr><th align=""left"">HTML File:</th><td>%&Y B
{&&B C
campaign&&C K
.&&K L
Assets&&L R
.&&R S
CreativeUrl&&S ^
}&&^ _Z
N</td></tr>
                        <tr><th align=""left"">Test Seed:</th><td>&'_ B
{''B C
campaign''C K
.''K L
Assets''L R
.''R S
TestSeedUrl''S ^
}''^ _\
P</td></tr>  
                        <tr><th align=""left"">Live Seed:</th><td>'(_ B
{((B C
campaign((C K
.((K L
Assets((L R
.((R S
LiveSeedUrl((S ^
}((^ _h
\</td></tr>   
                        <tr><th align=""left"">Special Instructions:</th><td>()_ M
{))M N
campaign))N V
.))V W
SpecialInstructions))W j
}))j kÄ
t</td></tr>                                     
                        <tr><th align=""left"">Start Time:</th><td>)*k C
{**C D
campaign**D L
.**L M
	CreatedAt**M V
.**V W

AddMinutes**W a
(**a b
$num**b c
)**c d
.**d e

AddSeconds**e o
(**o p
$num**p r
)**r s
}**s tS
G</td></tr>
                        <tr><th align=""left"">IP:</th><td>*+t ;
{++; <
campaign++< D
.++D E
IP++E G
}++G HX
L</td></tr>
                        <tr><th align=""left"">Browser:</th><td>+,H @
{,,@ A
campaign,,A I
.,,I J
Browser,,J Q
},,Q RS
G</td></tr>
                        <tr><th align=""left"">OS:</th><td>,-R ;
{--; <
campaign--< D
.--D E
OS--E G
}--G HY
M</td></tr>
                        <tr><th align=""left"">Referrer:</th><td>-.H A
{..A B
campaign..B J
...J K
Referrer..K S
}..S T~
r</td></tr>
                        </table></p> <p>We will soon contact you and update you about your order.</p> ./T f
{//f g
Footer//g m
}//m n
"//n o
;//o p
await11 
SendEmailAsync11  
(11  !
loggedInUser11! -
.11- .
Email11. 3
,113 4
subject115 <
,11< =
body11> B
,11B C
string11D J
.11J K
Empty11K P
,11P Q
	bccEmails11R [
)11[ \
;11\ ]
}22 	
public44 
static44 
async44 
Task44   
SendApprovedToVendor44! 5
(445 6
Vendor446 <
vendor44= C
,44C D
Campaign44E M
campaign44N V
,44V W
CampaignSegment44X g
segment44h o
)44o p
{55 	
string66 
newOld66 
=66 
!66 
campaign66 %
.66% &
ReBroadcasted66& 3
?664 5
$str666 ;
:66< =
$str66> C
;66C D
string77 
orderNumber77 
=77  
campaign77! )
.77) *
OrderNumber77* 5
;775 6
string88 

deployDate88 
=88 
campaign88  (
.88( )
Approved88) 1
.881 2

DeployDate882 <
?88< =
.88= >
ToString88> F
(88F G
$str88G J
)88J K
;88K L
string99 

deployTime99 
=99 
campaign99  (
.99( )
Approved99) 1
.991 2

DeployDate992 <
?99< =
.99= >
ToString99> F
(99F G
$str99G N
)99N O
;99O P
string:: 
quantity:: 
=:: 
campaign:: &
.::& '
Approved::' /
.::/ 0
Quantity::0 8
.::8 9
ToString::9 A
(::A B
)::B C
;::C D
string<< 
subject<< 
;<< 
string== 
segmentsHtml== 
===  !
string==" (
.==( )
Empty==) .
;==. /
if>> 
(>> 
segment>> 
==>> 
null>> 
)>>  
{?? 
subject@@ 
=@@ 
$"@@ 
{@@ 
newOld@@ #
}@@# $
 Order @@$ +
{@@+ ,
campaign@@, 4
.@@4 5
Approved@@5 =
.@@= >
CampaignName@@> J
}@@J K

, Order # @@K U
{@@U V
campaign@@V ^
.@@^ _
OrderNumber@@_ j
}@@j k
"@@k l
;@@l m
}AA 
elseAA 
{BB 
subjectCC 
=CC 
$"CC 
{CC 
newOldCC #
}CC# $
 Order CC$ +
{CC+ ,
campaignCC, 4
.CC4 5
ApprovedCC5 =
.CC= >
CampaignNameCC> J
}CCJ K

, Order # CCK U
{CCU V
segmentCCV ]
.CC] ^
SegmentNumberCC^ k
}CCk l
"CCl m
;CCm n
segmentsHtmlDD 
+=DD 
$@"DD  #i
]<table border=""1"">
                                <tr><th align=""left"">Segment</th><td>DE# G
{EEG H
segmentEEH O
.EEO P
SegmentNumberEEP ]
}EE] ^d
X</td></tr>
                                <tr><th align=""left"">Subject Line</th><td>EF^ L
{FFL M
segmentFFM T
.FFT U
SubjectLineFFU `
}FF` aa
U</td></tr>
                                <tr><th align=""left"">From Line</th><td>FGa I
{GGI J
segmentGGJ Q
.GGQ R
FromLineGGR Z
}GGZ [c
W</td></tr>
                                <tr><th align=""left"">White Label</th><td>GH[ K
{HHK L
segmentHHL S
.HHS T

WhiteLabelHHT ^
}HH^ _g
[</td></tr>
                                <tr><th align=""left"">Deployment Date</th><td>HI_ O
{IIO P
segmentIIP W
.IIW X
DeploymentDateIIX f
}IIf ga
U</td></tr>
                                <tr><th align=""left"">Data File</th><td>IJg I
{JJI J
segmentJJJ Q
.JJQ R
SegmentDataFileUrlJJR d
}JJd ee
Y</td></tr>
                                <tr><th align=""left"">Total Records</th><td>JKe M
{KKM N
NumberHelperKKN Z
.KKZ [
GetTotalKK[ c
(KKc d
segmentLL 
.LL 
FirstRangeStartLL +
,LL+ ,
segmentLL- 4
.LL4 5
FirstRangeEndLL5 B
,LLB C
segmentLLD K
.LLK L
SecondRangeStartLLL \
,LL\ ]
segmentLL^ e
.LLe f
SecondRangeEndLLf t
,LLt u
segmentMM 
.MM 
ThirdRangeStartMM +
,MM+ ,
segmentMM- 4
.MM4 5
ThirdRangeEndMM5 B
)MMB C
}MMC D
</td></tr></table>MMD V
"MMV W
;MMW X
}NN 
stringPP 
bodyPP 
=PP 
$@"PP 
<br/><p>Dear PP *
{PP* +
vendorPP+ 1
.PP1 2
NamePP2 6
}PP6 7¬
µ</p><br/>
                    Please find below Order details<br/><br/>
                    <table border=""2"">
                    <tr><th align=""left""> Reference #:</th><td>PS7 A
{SSA B
campaignSSB J
.SSJ K
ApprovedSSK S
.SSS T
ReferenceNumberSST c
}SSc dT
H</td></tr>
                    <tr><th align=""left"">Order #:</th><td>STd <
{TT< =
orderNumberTT= H
}TTH IZ
N</td></tr>
                    <tr><th align=""left"">Campaign Name:</th><td>TUI B
{UUB C
campaignUUC K
.UUK L
ApprovedUUL T
.UUT U
CampaignNameUUU a
}UUa bX
L</td></tr>
                    <tr><th align=""left"">Rebroadcast:</th><td>UVb @
{VV@ A
(VVA B
campaignVVB J
.VVJ K
ApprovedVVK S
.VVS T
ReBroadCastVVT _
?VV_ `
$strVVa f
:VVf g
$strVVh l
)VVl m
}VVm nÉ
w</td></tr>                                        
                    <tr><th align=""left"">Broadcast Date:</th><td>VWn C
{WWC D
campaignWWD L
.WWL M
ApprovedWWM U
.WWU V

DeployDateWWV `
.WW` a
ValueWWa f
:WWf g
dWWg h
}WWh iV
J</td></tr>
                    <tr><th align=""left"">From Line:</th><td>WXi >
{XX> ?
campaignXX? G
.XXG H
ApprovedXXH P
.XXP Q
FromLineXXQ Y
}XXY ZY
M</td></tr>
                    <tr><th align=""left"">Subject Line:</th><td>XYZ A
{YYA B
campaignYYB J
.YYJ K
ApprovedYYK S
.YYS T
SubjectLineYYT _
}YY_ `T
H</td></tr>
                    <tr><th align=""left"">Opt Out:</th><td>YZ` <
{ZZ< =
campaignZZ= E
.ZZE F
OptOutZZF L
}ZZL MX
L</td></tr>
                    <tr><th align=""left"">White Label:</th><td>Z[M @
{[[@ A
campaign[[A I
.[[I J
Approved[[J R
.[[R S

WhiteLabel[[S ]
}[[] ^Ñ
x</td></tr>                                        
                    <tr><th align=""left"">Personalization:</th><td>[\^ D
{\\D E
(\\E F
campaign\\F N
.\\N O
IsPersonalization\\O `
?\\` a
$str\\b g
:\\g h
$str\\i m
)\\m n
}\\n oY
M</td></tr>
                    <tr><th align=""left"">Creative URL:</th><td>\]o A
{]]A B
campaign]]B J
.]]J K
Assets]]K Q
.]]Q R
CreativeUrl]]R ]
}]]] ^U
I</td></tr>
                    <tr><th align=""left"">Quantity:</th><td>]^^ =
{^^= >
quantity^^> F
}^^F GT
H</td></tr>
                    <tr><th align=""left"">Geo (s):</th><td>^_G <
{__< =
campaign__= E
.__E F
Approved__F N
.__N O

GeoDetails__O Y
}__Y ZY
M</td></tr>
                    <tr><th align=""left"">Demographics:</th><td>_`Z A
{``A B
campaign``B J
.``J K
Approved``K S
.``S T
Demographics``T `
}``` aX
L</td></tr>
                    <tr><tr><th align=""left"">Zip URL:</th><td>`aa @
{aa@ A
campaignaaA I
.aaI J
AssetsaaJ P
.aaP Q

ZipCodeUrlaaQ [
}aa[ \a
U</td></tr>
                    <tr><th align=""left"">Special Instructions:</th><td>ab\ I
{bbI J
campaignbbJ R
.bbR S
ApprovedbbS [
.bb[ \
SpecialInstructionsbb\ o
}bbo pX
L</td></tr>
                    <tr><th align=""left"">Deploy Date:</th><td>bcp @
{cc@ A

deployDateccA K
}ccK LX
L</td></tr>
                    <tr><th align=""left"">Deploy Time:</th><td>cdL @
{dd@ A

deployTimeddA K
}ddK L\
P</td></tr>
                    <tr><th align=""left"">ReportSite Link:</th><td>deL D
{eeD E
campaigneeE M
.eeM N
ApprovedeeN V
.eeV W
ReportSiteLinkeeW e
}eee fZ
N</td></tr>
                    <tr><th align=""left"">Link Breakout:</th><td>eff B
{ffB C
campaignffC K
.ffK L
ApprovedffL T
.ffT U
LinkBreakoutffU a
}ffa b[
O</td></tr>
                    <tr><th align=""left"">Has Open Pixel:</th><td>fgb C
{ggC D
(ggD E
campaignggE M
.ggM N
ApprovedggN V
.ggV W
IsOpenPixelggW b
?ggb c
$strggd i
:ggi j
$strggk o
)ggo p
}ggp q[
O</td></tr>
                    <tr><th align=""left"">Open Pixel URL:</th><td>ghq C
{hhC D
campaignhhD L
.hhL M
ApprovedhhM U
.hhU V
OpenPixelUrlhhV b
}hhb cW
K</td></tr>
                    <tr><th align=""left"">Open Goals:</th><td>hic ?
{ii? @
campaignii@ H
.iiH I
ApprovediiI Q
.iiQ R
	OpenGoalsiiR [
}ii[ \X
L</td></tr>
                    <tr><th align=""left"">Click Goals:</th><td>ij\ @
{jj@ A
campaignjjA I
.jjI J
ApprovedjjJ R
.jjR S

ClickGoalsjjS ]
}jj] ^Y
M</td></tr>
                    <tr><th align=""left"">Segment Data:</th><td>jk^ A
{kkA B
segmentsHtmlkkB N
}kkN OA
5</td></tr>
                    </table></p> <p></p> klO )
{ll) *
Footerll* 0
}ll0 1
"ll1 2
;ll2 3
awaitmm 
SendEmailAsyncmm  
(mm  !
vendormm! '
.mm' (
Emailmm( -
,mm- .
subjectmm/ 6
,mm6 7
bodymm8 <
,mm< =
vendormm> D
.mmD E
CcEmailsmmE M
)mmM N
;mmN O
}nn 	
publicpp 
staticpp 
asyncpp 
Taskpp  %
SendNotificationsToVendorpp! :
(pp: ;
Vendorpp; A
vendorppB H
,ppH I
ListppJ N
<ppN O
CampaignppO W
>ppW X
	campaignsppY b
)ppb c
{qq 	
stringrr 
subjectrr 
=rr 
$strrr <
;rr< =
StringBuildertt 
problemstt "
=tt# $
newtt% (
StringBuildertt) 6
(tt6 7
$str	tt7 Ç
)
ttÇ É
;
ttÉ Ñ
foreachuu 
(uu 
varuu 
campaignuu !
inuu" $
	campaignsuu% .
)uu. /
{vv 
foreachww 
(ww 
varww 
notificationww )
inww* ,
campaignww- 5
.ww5 6
Notificationsww6 C
)wwC D
{xx 
problemsyy 
.yy 
Appendyy #
(yy# $
$"yy$ &
<tr><td>yy& .
{yy. /
campaignyy/ 7
.yy7 8
OrderNumberyy8 C
}yyC D
	</td><td>yyD M
{yyM N
campaignyyN V
.yyV W
CampaignNameyyW c
}yyc d
	</td><td>yyd m
{yym n
notificationyyn z
.yyz {
	CheckTime	yy{ Ñ
}
yyÑ Ö
	</td><td>
yyÖ é
{
yyé è
(
yyè ê
QcRule
yyê ñ
)
yyñ ó
notification
yyó £
.
yy£ §
QCRule
yy§ ™
}
yy™ ´
	</td><td>
yy´ ¥
{
yy¥ µ
QcRuleUtility
yyµ ¬
.
yy¬ √
	GetString
yy√ Ã
(
yyÃ Õ
notification
yyÕ Ÿ
.
yyŸ ⁄
QCRule
yy⁄ ‡
)
yy‡ ·
}
yy· ‚

</td></tr>
yy‚ Ï
"
yyÏ Ì
)
yyÌ Ó
;
yyÓ Ô
}zz 
}{{ 
problems|| 
.|| 
Append|| 
(|| 
$str|| &
)||& '
;||' (
string}} 
body}} 
=}} 
$@"}} 
<br/><p>Dear }} *
{}}* +
vendor}}+ 1
.}}1 2
Name}}2 6
}}}6 7I
=</p><br/>There is problem with these orders<br/><br/></p> <p>}}7 t
{}}t u
problems}}u }
}}}} ~
</p> 	}}~ É
{
}}É Ñ
Footer
}}Ñ ä
}
}}ä ã
"
}}ã å
;
}}å ç
await~~ 
SendEmailAsync~~  
(~~  !
vendor~~! '
.~~' (
Email~~( -
,~~- .
subject~~/ 6
,~~6 7
body~~8 <
,~~< =
vendor~~> D
.~~D E
CcEmails~~E M
)~~M N
;~~N O
} 	
public
ÅÅ 
static
ÅÅ 
void
ÅÅ 
SendErrorEmail
ÅÅ )
(
ÅÅ) *
string
ÅÅ* 0
to
ÅÅ1 3
,
ÅÅ3 4
	Exception
ÅÅ5 >
ex
ÅÅ? A
,
ÅÅA B
string
ÅÅC I
currentController
ÅÅJ [
,
ÅÅ[ \
string
ÅÅ] c
currentAction
ÅÅd q
)
ÅÅq r
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ "
ConfigurationManager
ÉÉ $
.
ÉÉ$ %
AppSettings
ÉÉ% 0
[
ÉÉ0 1
$str
ÉÉ1 9
]
ÉÉ9 :
==
ÉÉ; =
$str
ÉÉ> D
)
ÉÉD E
{
ÑÑ 
string
ÖÖ 
subject
ÖÖ 
=
ÖÖ  
$str
ÖÖ! F
;
ÖÖF G
string
ÜÜ 
body
ÜÜ 
=
ÜÜ 
$@"
ÜÜ !f
X<p>ADSLive: An error has been occured.</p>
                            <p>Controller : 
Üá! ,
{
áá, -
currentController
áá- >
}
áá> ?
</p><p>Action : 
áá? O
{
ááO P
currentAction
ááP ]
}
áá] ^C
5</p>
                            <p>Error Details : 
áà^ /
{
àà/ 0
ex
àà0 2
.
àà2 3!
GetExceptionMessage
àà3 F
(
ààF G
)
ààG H
}
ààH I
</p>
ààI M
"
ààM N
;
ààN O
	SendEmail
ââ 
(
ââ 
to
ââ 
,
ââ 
subject
ââ %
,
ââ% &
body
ââ' +
)
ââ+ ,
;
ââ, -
}
ää 
}
ãã 	
public
çç 
static
çç 
async
çç 
Task
çç  
SendEmailAsync
çç! /
(
çç/ 0
string
çç0 6
to
çç7 9
,
çç9 :
string
çç; A
subject
ççB I
,
ççI J
string
ççK Q
body
ççR V
,
ççV W
string
ççX ^
ccEmails
çç_ g
=
ççh i
$str
ççj l
,
ççl m
string
ççn t
	bccEmails
ççu ~
=çç Ä
$strççÅ É
,ççÉ Ñ
ListççÖ â
<ççä ã
stringççå í
>ççí ì
attachmentsççî ü
=çç† °
nullçç¢ ¶
)çç¶ ß
{
éé 	
using
èè 
(
èè 
var
èè 

smtpClient
èè !
=
èè" #
new
èè$ '

SmtpClient
èè( 2
(
èè2 3
)
èè3 4
)
èè4 5
{
êê 
var
ëë 
msg
ëë 
=
ëë 
CreateMessage
ëë '
(
ëë' (
to
ëë( *
,
ëë* +
subject
ëë, 3
,
ëë3 4
body
ëë5 9
,
ëë9 :
ccEmails
ëë; C
,
ëëC D
	bccEmails
ëëE N
,
ëëN O
attachments
ëëP [
)
ëë[ \
;
ëë\ ]
await
íí 

smtpClient
íí  
.
íí  !
SendMailAsync
íí! .
(
íí. /
msg
íí/ 2
)
íí2 3
;
íí3 4
}
ìì 
}
îî 	
public
ññ 
static
ññ 
void
ññ 
	SendEmail
ññ $
(
ññ$ %
string
ññ% +
to
ññ, .
,
ññ. /
string
ññ0 6
subject
ññ7 >
,
ññ> ?
string
ññ@ F
body
ññG K
,
ññK L
string
ññM S
ccEmails
ññT \
=
ññ] ^
$str
ññ_ a
,
ñña b
string
ññc i
	bccEmails
ññj s
=
ññt u
$str
ññv x
,
ññx y
List
ññz ~
<
ññ~ 
stringññ Ö
>ññÖ Ü
attachmentsññá í
=ññì î
nullññï ô
)ññô ö
{
óó 	
using
òò 
(
òò 
var
òò 

smtpClient
òò !
=
òò" #
new
òò$ '

SmtpClient
òò( 2
(
òò2 3
)
òò3 4
)
òò4 5
{
ôô 
var
öö 
msg
öö 
=
öö 
CreateMessage
öö '
(
öö' (
to
öö( *
,
öö* +
subject
öö, 3
,
öö3 4
body
öö5 9
,
öö9 :
ccEmails
öö; C
,
ööC D
	bccEmails
ööE N
,
ööN O
attachments
ööP [
)
öö[ \
;
öö\ ]

smtpClient
õõ 
.
õõ 
Send
õõ 
(
õõ  
msg
õõ  #
)
õõ# $
;
õõ$ %
}
úú 
}
ùù 	
private
üü 
static
üü 
MailMessage
üü "
CreateMessage
üü# 0
(
üü0 1
string
üü1 7
to
üü8 :
,
üü: ;
string
üü< B
subject
üüC J
,
üüJ K
string
üüL R
body
üüS W
,
üüW X
string
üüY _
ccEmails
üü` h
=
üüi j
$str
üük m
,
üüm n
string
üüo u
	bccEmails
üüv 
=üüÄ Å
$strüüÇ Ñ
,üüÑ Ö
ListüüÜ ä
<üüä ã
stringüüã ë
>üüë í
attachmentsüüì û
=üüü †
nullüü° •
)üü• ¶
{
†† 	
MailMessage
°° 
msg
°° 
=
°° 
new
°° !
MailMessage
°°" -
(
°°- .
)
°°. /
;
°°/ 0
msg
¢¢ 
.
¢¢ 
To
¢¢ 
.
¢¢ 
Add
¢¢ 
(
¢¢ 
new
¢¢ 
MailAddress
¢¢ &
(
¢¢& '
to
¢¢' )
)
¢¢) *
)
¢¢* +
;
¢¢+ ,
if
££ 
(
££ 
!
££ 
string
££ 
.
££ 
IsNullOrEmpty
££ %
(
££% &
ccEmails
££& .
)
££. /
)
££/ 0
{
§§ 
foreach
•• 
(
•• 
var
•• 
ccEmail
•• $
in
••% '
ccEmails
••( 0
.
••0 1
Split
••1 6
(
••6 7
$str
••7 ;
.
••; <
ToCharArray
••< G
(
••G H
)
••H I
,
••I J 
StringSplitOptions
••K ]
.
••] ^ 
RemoveEmptyEntries
••^ p
)
••p q
)
••q r
{
¶¶ 
msg
ßß 
.
ßß 
CC
ßß 
.
ßß 
Add
ßß 
(
ßß 
ccEmail
ßß &
)
ßß& '
;
ßß' (
}
®® 
}
©© 
if
´´ 
(
´´ 
!
´´ 
string
´´ 
.
´´ 
IsNullOrEmpty
´´ %
(
´´% &
	bccEmails
´´& /
)
´´/ 0
)
´´0 1
{
¨¨ 
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
bccEmail
≠≠ %
in
≠≠& (
	bccEmails
≠≠) 2
.
≠≠2 3
Split
≠≠3 8
(
≠≠8 9
$str
≠≠9 =
.
≠≠= >
ToCharArray
≠≠> I
(
≠≠I J
)
≠≠J K
,
≠≠K L 
StringSplitOptions
≠≠M _
.
≠≠_ ` 
RemoveEmptyEntries
≠≠` r
)
≠≠r s
)
≠≠s t
{
ÆÆ 
msg
ØØ 
.
ØØ 
Bcc
ØØ 
.
ØØ 
Add
ØØ 
(
ØØ  
bccEmail
ØØ  (
)
ØØ( )
;
ØØ) *
}
∞∞ 
}
±± 
msg
≥≥ 
.
≥≥ 
Subject
≥≥ 
=
≥≥ 
subject
≥≥ !
;
≥≥! "
msg
¥¥ 
.
¥¥ 

IsBodyHtml
¥¥ 
=
¥¥ 
true
¥¥ !
;
¥¥! "
msg
µµ 
.
µµ 
Body
µµ 
=
µµ 
body
µµ 
;
µµ 
if
∂∂ 
(
∂∂ 
attachments
∂∂ 
!=
∂∂ 
null
∂∂ #
)
∂∂# $
foreach
∑∑ 
(
∑∑ 
var
∑∑ 

attachment
∑∑ '
in
∑∑( *
attachments
∑∑+ 6
)
∑∑6 7
{
∏∏ 
msg
ππ 
.
ππ 
Attachments
ππ #
.
ππ# $
Add
ππ$ '
(
ππ' (
new
ππ( +
System
ππ, 2
.
ππ2 3
Net
ππ3 6
.
ππ6 7
Mail
ππ7 ;
.
ππ; <

Attachment
ππ< F
(
ππF G

attachment
ππG Q
)
ππQ R
)
ππR S
;
ππS T
}
∫∫ 
return
ªª 
msg
ªª 
;
ªª 
}
ºº 	
}
ΩΩ 
}ææ åD
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\ExceptionHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

static 
class 
ExceptionHelper '
{ 
public 
static 
string 
GetExceptionMessage 0
(0 1
this1 5
	Exception6 ?
ex@ B
,B C
stringD J
customMessageK X
=Y Z
$str[ ]
)] ^
{ 	
var 
message 
= 
( 
customMessage (
!=) +
$str, .
). /
? 
customMessage 
+  !
$str" %
+& '
ex( *
.* +
GetBaseException+ ;
(; <
)< =
.= >
Message> E
: 
ex 
. 
GetBaseException %
(% &
)& '
.' (
Message( /
;/ 0
message 
+= 
$str #
+$ %
ex& (
.( )

StackTrace) 3
+3 4
$str5 =
;= >
if 
( 
ex 
is 
SqlException "
)" #
{ 
return 
$str 6
+7 8
message9 @
;@ A
} 
else 
if 
( 
ex 
is $
IndexOutOfRangeException 3
)3 4
{ 
return 
$str 1
+2 3
message4 ;
;; <
} 
else 
if 
( 
ex 
is '
DbEntityValidationException 6
)6 7
{   
var!! 
	exception!! 
=!! 
(!!  !'
DbEntityValidationException!!! <
)!!< =
ex!!= ?
;!!? @
var"" 
errorMessages"" !
=""" #
	exception""$ -
.""- ."
EntityValidationErrors"". D
.## 

SelectMany## 
(##  
x##  !
=>##" $
x##% &
.##& '
ValidationErrors##' 7
)##7 8
.$$ 
Select$$ 
($$ 
x$$ 
=>$$  
x$$! "
.$$" #
ErrorMessage$$# /
)$$/ 0
;$$0 1
var%% 
messages%% 
=%% 
errorMessages%% ,
.%%, -
	Aggregate%%- 6
(%%6 7
$str%%7 9
,%%9 :
(&& 
current&& 
,&& 
errorMessage&& *
)&&* +
=>&&, .
current&&/ 6
+&&7 8
(&&9 :
$str&&: @
+&&A B
errorMessage&&C O
+&&P Q
$str&&R Y
)&&Y Z
)&&Z [
;&&[ \
return'' 
message'' 
+''  
$str''! (
+'') *
messages''+ 3
;''3 4
}(( 
else)) 
if)) 
()) 
ex)) 
is)) +
EntityCommandExecutionException)) :
))): ;
{** 
return++ 
$str++ >
+++? @
message++A H
;++H I
},, 
else-- 
if-- 
(-- 
ex-- 
is-- 
SecurityException-- ,
)--, -
{.. 
return// 
$str// *
+//+ ,
message//- 4
;//4 5
}00 
else11 
if11 
(11 
ex11 
is11 
SystemException11 *
)11* +
{22 
return33 
message33 
;33 
}44 
else55 
if55 
(55 
ex55 
is55  
ApplicationException55 /
)55/ 0
{66 
return77 
message77 
;77 
}88 
else99 
{:: 
return;; 
message;; 
;;; 
}<< 
}== 	
public>> 
static>> 
void>> 
HandleException>> *
(>>* +
this>>+ /
	Exception>>0 9
ex>>: <
,>>< =
string>>> D
customMessage>>E R
=>>S T
$str>>U W
)>>W X
{?? 	
var@@ 
message@@ 
=@@ 
(@@ 
customMessage@@ (
!=@@) +
$str@@, .
)@@. /
?AA 
customMessageAA 
+AA  !
$strAA" %
+AA& '
exAA( *
.AA* +
GetBaseExceptionAA+ ;
(AA; <
)AA< =
.AA= >
MessageAA> E
:BB 
exBB 
.BB 
GetBaseExceptionBB %
(BB% &
)BB& '
.BB' (
MessageBB( /
;BB/ 0
ifCC 
(CC 
exCC 
isCC 
SqlExceptionCC "
)CC" #
{DD 
}FF 
elseGG 
ifGG 
(GG 
exGG 
isGG $
IndexOutOfRangeExceptionGG 3
)GG3 4
{HH 
}JJ 
elseKK 
ifKK 
(KK 
exKK 
isKK '
DbEntityValidationExceptionKK 6
)KK6 7
{LL 
varMM 
	exceptionMM 
=MM 
(MM  !'
DbEntityValidationExceptionMM! <
)MM< =
exMM= ?
;MM? @
varNN 
errorMessagesNN !
=NN" #
	exceptionNN$ -
.NN- ."
EntityValidationErrorsNN. D
.OO 

SelectManyOO 
(OO  
xOO  !
=>OO" $
xOO% &
.OO& '
ValidationErrorsOO' 7
)OO7 8
.PP 
SelectPP 
(PP 
xPP 
=>PP  
xPP! "
.PP" #
ErrorMessagePP# /
)PP/ 0
;PP0 1
varQQ 
messagesQQ 
=QQ 
errorMessagesQQ ,
.QQ, -
	AggregateQQ- 6
(QQ6 7
$strQQ7 9
,QQ9 :
(RR 
currentRR 
,RR 
errorMessageRR *
)RR* +
=>RR, .
currentRR/ 6
+RR7 8
(RR9 :
$strRR: @
+RRA B
errorMessageRRC O
+RRP Q
$strRRR Y
)RRY Z
)RRZ [
;RR[ \
}TT 
elseUU 
ifUU 
(UU 
exUU 
isUU +
EntityCommandExecutionExceptionUU :
)UU: ;
{VV 
}XX 
elseYY 
ifYY 
(YY 
exYY 
isYY 
SecurityExceptionYY ,
)YY, -
{ZZ 
}\\ 
else]] 
if]] 
(]] 
ex]] 
is]] 
SystemException]] *
)]]* +
{^^ 
}`` 
elseaa 
ifaa 
(aa 
exaa 
isaa  
ApplicationExceptionaa /
)aa/ 0
{bb 
}dd 
elseee 
{ff 
}hh 
}ii 	
}jj 
publicnn 

staticnn 
classnn %
ControllerExceptionHelpernn 1
{oo 
publicpp 
staticpp 
stringpp 
GetModelStateErrorspp 0
(pp0 1
thispp1 5
ICollectionpp6 A
<ppA B

ModelStateppB L
>ppL M
valuesppN T
)ppT U
{qq 	
varrr 
sbrr 
=rr 
newrr 
StringBuilderrr &
(rr& '
)rr' (
;rr( )
foreachss 
(ss 
varss 

modelStatess #
inss$ &
valuesss' -
)ss- .
{tt 
foreachuu 
(uu 
varuu 
erroruu "
inuu# %

modelStateuu& 0
.uu0 1
Errorsuu1 7
)uu7 8
{vv 
varww 
liww 
=ww 
newww  

TagBuilderww! +
(ww+ ,
$strww, 0
)ww0 1
;ww1 2
lixx 
.xx 
SetInnerTextxx #
(xx# $
errorxx$ )
.xx) *
ErrorMessagexx* 6
)xx6 7
;xx7 8
sbyy 
.yy 
Appendyy 
(yy 
liyy  
)yy  !
;yy! "
}zz 
}{{ 
return|| 
sb|| 
.|| 
ToString|| 
(|| 
)||  
;||  !
}}} 	
}~~ 
} Ω
?E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\FileHelper.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 

FileHelper 
{ 
public 
static 
readonly 
string %&
UploadsSupplierListingPath& @
=A B
HttpContextC N
.N O
CurrentO V
.V W
ServerW ]
.] ^
MapPath^ e
(e f
$str	f É
)
É Ñ
;
Ñ Ö
public

 
static

 
string

 
GetImagePath

 )
(

) *
string

* 0
fileName

1 9
)

9 :
{ 	
return &
UploadsSupplierListingPath -
+- .
$str. 2
+2 3
fileName3 ;
+; <
$str< B
;B C
} 	
public 
static 
string 
GetValidFileName -
(- .
string. 4
fileName5 =
)= >
{ 	
string 
ret 
= 
Regex 
. 
Replace &
(& '
fileName' /
./ 0
Trim0 4
(4 5
)5 6
,6 7
$str8 J
,J K
$strL N
)N O
;O P
return 
ret 
. 
Replace 
( 
$str "
," #
string$ *
.* +
Empty+ 0
)0 1
;1 2
} 	
} 
} ◊
FE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Helpers\GatePassGenerator.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Helpers 
{ 
public 

class 
GatePassGenerator "
{ 
public 
static 
string 

GetNewPass '
(' (
)( )
{		 	
byte

 
[

 
]

 
buffer

 
=

 
Guid

  
.

  !
NewGuid

! (
(

( )
)

) *
.

* +
ToByteArray

+ 6
(

6 7
)

7 8
;

8 9
var 

FormNumber 
= 
BitConverter )
.) *
ToUInt32* 2
(2 3
buffer3 9
,9 :
$num; <
)< =
^> ?
BitConverter@ L
.L M
ToUInt32M U
(U V
bufferV \
,\ ]
$num^ _
)_ `
^a b
BitConverterc o
.o p
ToUInt32p x
(x y
buffery 
,	 Ä
$num
Å Ç
)
Ç É
^
Ñ Ö
BitConverter
Ü í
.
í ì
ToUInt32
ì õ
(
õ ú
buffer
ú ¢
,
¢ £
$num
§ ¶
)
¶ ß
;
ß ®
return 

FormNumber 
. 
ToString &
(& '
$str' *
)* +
;+ ,
} 	
static 
Random 
random 
= 
new "
Random# )
() *
)* +
;+ ,
public 
static 
string 

GetNewPass '
(' (
int( +
digits, 2
)2 3
{ 	
byte 
[ 
] 
buffer 
= 
new 
byte  $
[$ %
digits% +
/, -
$num. /
]/ 0
;0 1
random 
. 
	NextBytes 
( 
buffer #
)# $
;$ %
string 
result 
= 
string "
." #
Concat# )
() *
buffer* 0
.0 1
Select1 7
(7 8
x8 9
=>: <
x= >
.> ?
ToString? G
(G H
$strH L
)L M
)M N
.N O
ToArrayO V
(V W
)W X
)X Y
;Y Z
if 
( 
digits 
% 
$num 
== 
$num 
)  
return 
result 
; 
return 
result 
+ 
random "
." #
Next# '
(' (
$num( *
)* +
.+ ,
ToString, 4
(4 5
$str5 8
)8 9
;9 :
} 	
} 
} Ä
;E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Hubs\WFPICTHub.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Hubs 
{ 
[ 
HubName 
( 
$str 
) 
] 
public 

class 
	WFPICTHub 
: 
Hub  
{ 
private		 
readonly		 
WFPICTUpdater		 &
_wfpictUpdater		' 5
;		5 6
public 
	WFPICTHub 
( 
) 
: 
this !
(! "
WFPICTUpdater" /
./ 0
Instance0 8
)8 9
{ 	
} 	
public 
	WFPICTHub 
( 
WFPICTUpdater &
wfpictUpdater' 4
)4 5
{ 	
_wfpictUpdater 
= 
wfpictUpdater *
;* +
} 	
public 
void  
StartUpdatingClients (
(( )
)) *
{ 	
_wfpictUpdater 
.  
StartUpdatingClients /
(/ 0
)0 1
;1 2
} 	
public 
void 
StopUpdatingClients '
(' (
)( )
{ 	
_wfpictUpdater   
.   
StopUpdatingClients   .
(  . /
)  / 0
;  0 1
}!! 	
}"" 
}## £,
?E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Hubs\WFPICTUpdater.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Hubs

 
{ 
public 

class 
WFPICTUpdater 
{ 
private 
readonly 
static 
Lazy  $
<$ %
WFPICTUpdater% 2
>2 3
	_instance4 =
=> ?
new 
Lazy 
< 
WFPICTUpdater "
>" #
(# $
( 
) 
=> 
new 
WFPICTUpdater '
(' (

GlobalHost 
. 
ConnectionManager 0
.0 1
GetHubContext1 >
<> ?
	WFPICTHub? H
>H I
(I J
)J K
.K L
ClientsL S
)S T
)T U
;U V
private 
readonly 
object 
_lock  %
=& '
new( +
object, 2
(2 3
)3 4
;4 5
private 
readonly 
TimeSpan !
_updateInterval" 1
=2 3
TimeSpan4 <
.< =
FromSeconds= H
(H I
$numI K
)K L
;L M
private 
Timer 
_timer 
; 
private 
volatile 
bool 
_isUpdating )
;) *
private 
WFPICTUpdater 
( !
IHubConnectionContext 3
<3 4
dynamic4 ;
>; <
clients= D
)D E
{ 	
Clients 
= 
clients 
; 
} 	
public 
static 
WFPICTUpdater #
Instance$ ,
{   	
get!! 
{"" 
return## 
	_instance##  
.##  !
Value##! &
;##& '
}$$ 
}%% 	
private'' !
IHubConnectionContext'' %
<''% &
dynamic''& -
>''- .
Clients''/ 6
{(( 	
get)) 
;)) 
set** 
;** 
}++ 	
public-- 
void--  
StartUpdatingClients-- (
(--( )
)--) *
{.. 	
lock// 
(// 
_lock// 
)// 
{00 
_timer11 
=11 
new11 
Timer11 "
(11" #
UpdateClients11# 0
,110 1
null112 6
,116 7
_updateInterval118 G
,11G H
_updateInterval11I X
)11X Y
;11Y Z
}22 
}33 	
private55 
void55 
UpdateClients55 "
(55" #
object55# )
state55* /
)55/ 0
{66 	
lock77 
(77 
_lock77 
)77 
{88 
if99 
(99 
!99 
_isUpdating99  
)99  !
{:: 
_isUpdating;; 
=;;  !
true;;" &
;;;& '
using== 
(== 
var== 
db== !
===" #
new==$ '
WfpictContext==( 5
(==5 6
)==6 7
)==7 8
{>> 
var?? 
logs??  
=??! "
db??# %
.??% &

SystemLogs??& 0
.??0 1
OrderByDescending??1 B
(??B C
x??C D
=>??E G
x??H I
.??I J
	CreatedAt??J S
)??S T
.@@ 
Take@@ !
(@@! "
$num@@" %
)@@% &
.AA 
ToListAA #
(AA# $
)AA$ %
.BB 
SelectBB #
(BB# $
xBB$ %
=>BB& (
newBB) ,
SystemLogVMBB- 8
(BB8 9
)BB9 :
{CC 
	CreatedAtDD  )
=DD* +
xDD, -
.DD- .
	CreatedAtDD. 7
.DD7 8
ToStringDD8 @
(DD@ A
StringConstantsDDA P
.DDP Q 
DateTimeFormatDashesDDQ e
)DDe f
,DDf g
LogTypeEE  '
=EE( )
SystemEE* 0
.EE0 1
EnumEE1 5
.EE5 6
GetNameEE6 =
(EE= >
typeofEE> D
(EED E
LogTypeEEE L
)EEL M
,EEM N
(EEO P
LogTypeEEP W
)EEW X
xEEX Y
.EEY Z
LogTypeEEZ a
)EEa b
,EEb c
OrderNumberFF  +
=FF, -
xFF. /
.FF/ 0
OrderNumberFF0 ;
,FF; <
MessageGG  '
=GG( )
xGG* +
.GG+ ,
MessageGG, 3
}HH 
)HH 
.II 
ToListII #
(II# $
)II$ %
;II% &
ClientsJJ 
.JJ  
AllJJ  #
.JJ# $
refreshJJ$ +
(JJ+ ,
logsJJ, 0
)JJ0 1
;JJ1 2
}KK 
_isUpdatingLL 
=LL  !
falseLL" '
;LL' (
}MM 
}NN 
}OO 	
publicQQ 
voidQQ 
StopUpdatingClientsQQ '
(QQ' (
)QQ( )
{RR 	
lockSS 
(SS 
_lockSS 
)SS 
{TT 
ifUU 
(UU 
_timerUU 
!=UU 
nullUU "
)UU" #
{VV 
_timerWW 
.WW 
DisposeWW "
(WW" #
)WW# $
;WW$ %
}XX 
}YY 
}ZZ 	
}[[ 
}\\ „ù
9E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\API\Campaign.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
API 
{ 
public 

class 
Campaign 
{ 
private		 
static		 
readonly		 
SortedDictionary		  0
<		0 1
int		1 4
,		4 5
KeyValuePair		6 B
<		B C
int		C F
,		F G
int		H K
>		K L
>		L M,
 HoursPercentageDictionaryDynamic		N n
=

 
new

 
SortedDictionary

 "
<

" #
int

# &
,

& '
KeyValuePair

( 4
<

4 5
int

5 8
,

8 9
int

: =
>

= >
>

> ?
(

? @
)

@ A
{ 	
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ -
,- .
$num/ 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ -
,- .
$num/ 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair  
<  !
int! $
,$ %
int& )
>) *
(* +
$num+ .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 3
)3 4
}5 6
,6 7
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
,5 6
{ 
$num 
, 
new 
KeyValuePair !
<! "
int" %
,% &
int' *
>* +
(+ ,
$num, .
,. /
$num0 2
)2 3
}4 5
} 	
;	 

public 
static 
double  
GetPercentageDynamic 1
(1 2
int2 5
hr6 8
)8 9
{ 	
var 
r 
= 
new 
Random 
( 
)  
;  !
double 
finalPercentage "
=# $
$num% (
;( )
if 
( 
hr 
>= 
$num 
) 
finalPercentage 
+=  "
r# $
.$ %
Next% )
() *,
 HoursPercentageDictionaryDynamic* J
[J K
$numK L
]L M
.M N
KeyN Q
,Q R,
 HoursPercentageDictionaryDynamicS s
[s t
$numt u
]u v
.v w
Valuew |
)| }
/~ 
$num
Ä á
;
á à
if 
( 
hr 
>= 
$num 
) 
finalPercentage   
+=    "
r  # $
.  $ %
Next  % )
(  ) *,
 HoursPercentageDictionaryDynamic  * J
[  J K
$num  K L
]  L M
.  M N
Key  N Q
,  Q R,
 HoursPercentageDictionaryDynamic  S s
[  s t
$num  t u
]  u v
.  v w
Value  w |
)  | }
/  ~ 
$num
  Ä á
;
  á à
if!! 
(!! 
hr!! 
>=!! 
$num!! 
)!! 
finalPercentage"" 
+=""  "
r""# $
.""$ %
Next""% )
("") *,
 HoursPercentageDictionaryDynamic""* J
[""J K
$num""K L
]""L M
.""M N
Key""N Q
,""Q R,
 HoursPercentageDictionaryDynamic""S s
[""s t
$num""t u
]""u v
.""v w
Value""w |
)""| }
/""~ 
$num
""Ä á
;
""á à
if## 
(## 
hr## 
>=## 
$num## 
)## 
finalPercentage$$ 
+=$$  "
r$$# $
.$$$ %
Next$$% )
($$) *,
 HoursPercentageDictionaryDynamic$$* J
[$$J K
$num$$K L
]$$L M
.$$M N
Key$$N Q
,$$Q R,
 HoursPercentageDictionaryDynamic$$S s
[$$s t
$num$$t u
]$$u v
.$$v w
Value$$w |
)$$| }
/$$~ 
$num
$$Ä á
;
$$á à
if%% 
(%% 
hr%% 
>=%% 
$num%% 
)%% 
finalPercentage&& 
+=&&  "
r&&# $
.&&$ %
Next&&% )
(&&) *,
 HoursPercentageDictionaryDynamic&&* J
[&&J K
$num&&K L
]&&L M
.&&M N
Key&&N Q
,&&Q R,
 HoursPercentageDictionaryDynamic&&S s
[&&s t
$num&&t u
]&&u v
.&&v w
Value&&w |
)&&| }
/&&~ 
$num
&&Ä á
;
&&á à
if'' 
('' 
hr'' 
>='' 
$num'' 
)'' 
finalPercentage(( 
+=((  "
r((# $
.(($ %
Next((% )
((() *,
 HoursPercentageDictionaryDynamic((* J
[((J K
$num((K M
]((M N
.((N O
Key((O R
,((R S,
 HoursPercentageDictionaryDynamic((T t
[((t u
$num((u w
]((w x
.((x y
Value((y ~
)((~ 
/
((Ä Å
$num
((Ç â
;
((â ä
if)) 
()) 
hr)) 
>=)) 
$num)) 
))) 
finalPercentage** 
+=**  "
r**# $
.**$ %
Next**% )
(**) *,
 HoursPercentageDictionaryDynamic*** J
[**J K
$num**K M
]**M N
.**N O
Key**O R
,**R S,
 HoursPercentageDictionaryDynamic**T t
[**t u
$num**u w
]**w x
.**x y
Value**y ~
)**~ 
/
**Ä Å
$num
**Ç â
;
**â ä
if++ 
(++ 
hr++ 
>=++ 
$num++ 
)++ 
finalPercentage,, 
+=,,  "
r,,# $
.,,$ %
Next,,% )
(,,) *,
 HoursPercentageDictionaryDynamic,,* J
[,,J K
$num,,K M
],,M N
.,,N O
Key,,O R
,,,R S,
 HoursPercentageDictionaryDynamic,,T t
[,,t u
$num,,u w
],,w x
.,,x y
Value,,y ~
),,~ 
/
,,Ä Å
$num
,,Ç â
;
,,â ä
if-- 
(-- 
hr-- 
>=-- 
$num-- 
)-- 
finalPercentage.. 
+=..  "
r..# $
...$ %
Next..% )
(..) *,
 HoursPercentageDictionaryDynamic..* J
[..J K
$num..K M
]..M N
...N O
Key..O R
,..R S,
 HoursPercentageDictionaryDynamic..T t
[..t u
$num..u w
]..w x
...x y
Value..y ~
)..~ 
/
..Ä Å
$num
..Ç â
;
..â ä
if// 
(// 
hr// 
>=// 
$num// 
)// 
finalPercentage00 
+=00  "
r00# $
.00$ %
Next00% )
(00) *,
 HoursPercentageDictionaryDynamic00* J
[00J K
$num00K M
]00M N
.00N O
Key00O R
,00R S,
 HoursPercentageDictionaryDynamic00T t
[00t u
$num00u w
]00w x
.00x y
Value00y ~
)00~ 
/
00Ä Å
$num
00Ç â
;
00â ä
if11 
(11 
hr11 
>=11 
$num11 
)11 
finalPercentage22 
+=22  "
r22# $
.22$ %
Next22% )
(22) *,
 HoursPercentageDictionaryDynamic22* J
[22J K
$num22K M
]22M N
.22N O
Key22O R
,22R S,
 HoursPercentageDictionaryDynamic22T t
[22t u
$num22u w
]22w x
.22x y
Value22y ~
)22~ 
/
22Ä Å
$num
22Ç â
;
22â ä
return33 
finalPercentage33 "
;33" #
}44 	
private66 
static66 
readonly66 
SortedDictionary66  0
<660 1
int661 4
,664 5
double666 <
>66< =%
HoursPercentageDictionary66> W
=66X Y
new66Z ]
SortedDictionary66^ n
<66n o
int66o r
,66r s
double66t z
>66z {
(66{ |
)66| }
{77 	
{88 
$num88 
,88 
$num88 
}88 
,88 
{88 
$num88 
,88 
$num88 $
}88$ %
,88% &
{88' (
$num88( )
,88) *
$num88+ 1
}881 2
,882 3
{884 5
$num885 7
,887 8
$num889 ?
}88? @
,88@ A
{88B C
$num88C E
,88E F
$num88G M
}88M N
,88N O
{88P Q
$num88Q S
,88S T
$num88U [
}88[ \
,88\ ]
{88^ _
$num88_ a
,88a b
$num88c i
}88i j
,88j k
{88l m
$num88m o
,88o p
$num88q w
}88w x
,88x y
{88z {
$num88{ }
,88} ~
$num	88 Ö
}
88Ö Ü
}99 	
;99	 

public?? 
static?? 
double?? 
GetPercentage?? *
(??* +
int??+ .
hr??/ 1
)??1 2
{@@ 	
ifAA 
(AA 
hrAA 
>=AA 
$numAA 
)AA 
returnAA  %
HoursPercentageDictionaryAA! :
[AA: ;
$numAA; =
]AA= >
;AA> ?
intCC 
actualHrCC 
=CC 
-CC 
$numCC 
;CC 
intDD 
[DD 
]DD 
hrsDD 
=DD %
HoursPercentageDictionaryDD 1
.DD1 2
KeysDD2 6
.DD6 7
ToArrayDD7 >
(DD> ?
)DD? @
;DD@ A
forEE 
(EE 
intEE 
iEE 
=EE 
$numEE 
;EE 
iEE 
<EE 
hrsEE "
.EE" #
LengthEE# )
;EE) *
iEE* +
++EE+ -
)EE- .
{FF 
ifGG 
(GG 
hrGG 
>=GG 
hrsGG 
[GG 
iGG 
]GG  
&&GG! #
hrGG$ &
<GG' (
hrsGG) ,
[GG, -
iGG- .
+GG/ 0
$numGG1 2
]GG2 3
)GG3 4
{HH 
actualHrII 
=II 
hrsII "
[II" #
iII# $
]II$ %
;II% &
breakJJ 
;JJ 
}KK 
}LL 
returnMM %
HoursPercentageDictionaryMM ,
[MM, -
actualHrMM- 5
]MM5 6
;MM6 7
}NN 	
publicPP 
staticPP 
intPP 
GetOpensPP "
(PP" #
longPP# '
quantityPP( 0
,PP0 1
DateTimePP2 :
startDateTimePP; H
)PPH I
{QQ 	
intRR 
	hrsPassedRR 
=RR 
(RR 
intRR  
)RR  !
MathRR! %
.RR% &
RoundRR& +
(RR+ ,
(RR, -
DateTimeRR- 5
.RR5 6
NowRR6 9
-RR: ;
startDateTimeRR< I
)RRI J
.RRJ K

TotalHoursRRK U
)RRU V
;RRV W
returnSS 
(SS 
intSS 
)SS 
MathSS 
.SS 
RoundSS #
(SS# $
quantitySS$ ,
*SS- . 
GetPercentageDynamicSS/ C
(SSC D
	hrsPassedSSD M
)SSM N
)SSN O
;SSO P
}TT 	
publicVV 
stringVV 
CampaignNameVV "
{VV# $
getVV% (
;VV( )
setVV* -
;VV- .
}VV/ 0
publicWW 
stringWW 
OrderNumberWW !
{WW" #
getWW$ '
;WW' (
setWW) ,
;WW, -
}WW. /
publicXX 
stringXX 
IoNumberXX 
{XX  
getXX! $
;XX$ %
setXX& )
;XX) *
}XX+ ,
publicYY 
stringYY 
	StartDateYY 
{YY  !
getYY" %
;YY% &
setYY' *
;YY* +
}YY, -
publicZZ 
stringZZ 

EmailsSentZZ  
{ZZ! "
getZZ# &
;ZZ& '
setZZ( +
;ZZ+ ,
}ZZ- .
public[[ 
string[[ 
EmailsOpened[[ "
{[[# $
get[[% (
;[[( )
set[[* -
;[[- .
}[[/ 0
public\\ 
string\\ 
EmailsClicked\\ #
{\\$ %
get\\& )
;\\) *
set\\+ .
;\\. /
}\\0 1
public^^ 
List^^ 
<^^ 
LinkBreakout^^  
>^^  !
LinkBreakout^^" .
{^^/ 0
get^^1 4
;^^4 5
set^^6 9
;^^9 :
}^^; <
public`` 
static`` 
Campaign`` 
FromCampaign`` +
(``+ ,
WFP``, /
.``/ 0
ICT``0 3
.``3 4
Data``4 8
.``8 9
Entities``9 A
.``A B
Campaign``B J
campaign``K S
)``S T
{aa 	
longbb 
clickedbb 
=bb 
$numbb 
,bb 
openedbb $
=bb% &
$numbb' (
;bb( )
DateTimecc 
startDateTimecc "
=cc# $
DateTimecc% -
.cc- .
MinValuecc. 6
;cc6 7
stringdd 
ioNumberdd 
=dd 
$strdd "
;dd" #
ifee 
(ee 
campaignee 
.ee 
ProDatasee !
.ee! "
Countee" '
>ee( )
$numee* +
)ee+ ,
{ff 
clickedgg 
=gg 
campaigngg "
.gg" #
ProDatasgg# +
.gg+ ,
Sumgg, /
(gg/ 0
xgg0 1
=>gg2 4
xgg5 6
.gg6 7

ClickCountgg7 A
)ggA B
;ggB C
startDateTimehh 
=hh 
DateTimehh  (
.hh( )
Parsehh) .
(hh. /
campaignhh/ 7
.hh7 8
ProDatashh8 @
.hh@ A
FirstOrDefaulthhA O
(hhO P
)hhP Q
.hhQ R
CampaignStartDatehhR c
)hhc d
;hhd e
openedii 
=ii 
GetOpensii !
(ii! "
campaignii" *
.ii* +
Approvedii+ 3
.ii3 4
Quantityii4 <
,ii< =
startDateTimeii> K
)iiK L
;iiL M
}jj 
varkk 
modelkk 
=kk 
newkk 
Campaignkk $
(kk$ %
)kk% &
{ll 
CampaignNamemm 
=mm 
campaignmm '
.mm' (
Approvedmm( 0
.mm0 1
CampaignNamemm1 =
,mm= >
EmailsClickednn 
=nn 
clickednn  '
==nn( *
$numnn+ ,
?nn- .
$strnn/ 3
:nn4 5
clickednn6 =
.nn= >
ToStringnn> F
(nnF G
)nnG H
,nnH I
EmailsOpenedoo 
=oo 
openedoo %
==oo& (
$numoo) *
?oo+ ,
$stroo- 1
:oo2 3
openedoo4 :
.oo: ;
ToStringoo; C
(ooC D
)ooD E
,ooE F
IoNumberpp 
=pp 
campaignpp #
.pp# $
ProDataspp$ ,
.pp, -
FirstOrDefaultpp- ;
(pp; <
)pp< =
.pp= >
IOpp> @
,pp@ A
	StartDateqq 
=qq 
startDateTimeqq )
==qq* ,
DateTimeqq- 5
.qq5 6
MinValueqq6 >
?qq? @
$strqqA E
:qqF G
startDateTimeqqH U
.qqU V
ToStringqqV ^
(qq^ _
)qq_ `
,qq` a

EmailsSentrr 
=rr 
campaignrr %
.rr% &
Quantityrr& .
.rr. /
ToStringrr/ 7
(rr7 8
)rr8 9
,rr9 :
}ss 
;ss 
modeltt 
.tt 
LinkBreakouttt 
=tt  
newtt! $
Listtt% )
<tt) *
LinkBreakouttt* 6
>tt6 7
(tt7 8
)tt8 9
;tt9 :
foreachuu 
(uu 
varuu 
proDatauu  
inuu! #
campaignuu$ ,
.uu, -
ProDatasuu- 5
)uu5 6
{vv 
modelww 
.ww 
LinkBreakoutww "
.ww" #
Addww# &
(ww& '
newww' *
LinkBreakoutww+ 7
(ww7 8
)ww8 9
{xx 
Linkyy 
=yy 
proDatayy "
.yy" #
Destination_URLyy# 2
,yy2 3
Quantityzz 
=zz 
proDatazz &
.zz& '

ClickCountzz' 1
.zz1 2
ToStringzz2 :
(zz: ;
)zz; <
}{{ 
){{ 
;{{ 
}|| 
return}} 
model}} 
;}} 
}~~ 	
} 
public
ÅÅ 

class
ÅÅ 
LinkBreakout
ÅÅ 
{
ÇÇ 
public
ÉÉ 
string
ÉÉ 
Link
ÉÉ 
{
ÉÉ 
get
ÉÉ  
;
ÉÉ  !
set
ÉÉ" %
;
ÉÉ% &
}
ÉÉ' (
public
ÑÑ 
string
ÑÑ 
Quantity
ÑÑ 
{
ÑÑ  
get
ÑÑ! $
;
ÑÑ$ %
set
ÑÑ& )
;
ÑÑ) *
}
ÑÑ+ ,
}
ÖÖ 
}àà õ	
LE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignTrackingDetailVm.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class $
CampaignTrackingDetailVm )
:* +
CampaignTrackingVm, >
{ 
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Link 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 

ClickCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
UniqueCount !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
MobileCount		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
} 
} ∂
EE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignSegmentVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
CampaignSegmentVM "
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 

CampaignId		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
OrderNumber

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
string 
SegmentNumber #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DateTime 
? 
DeploymentDate '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
Quantity 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CreativeFiles #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
FirstRangeStart "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
FirstRangeEnd  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
SecondRangeStart #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
SecondRangeEnd !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
ThirdRangeStart "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
ThirdRangeEnd  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
SegmentDataFileUrl (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DateTime 
? 
DateFetched $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
UploadStatus 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
SegmentStatus  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
DateApproved %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public   
DateTime   
?   
DateComplete   %
{  & '
get  ( +
;  + ,
set  - 0
;  0 1
}  2 3
}"" 
}## Ì.
FE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignApprovedVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{		 
public

 

class

 
CampaignApprovedVM

 #
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
Guid 
? 

CampaignId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
	CreatedAt !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
long 
ReferenceNumber #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ReBroadCast 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
ReBroadcastDate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 

DeployDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 

GeoDetails  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Demographics "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Range	 
( 
$num 
, 
int 
. 
MaxValue 
, 
ErrorMessage  ,
=- .
$str/ T
)T U
]U V
public 
long 
Quantity 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
SpecialInstructions )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public   
string   
ReportSiteLink   $
{  % &
get  ' *
;  * +
set  , /
;  / 0
}  1 2
public!! 
string!! 
LinkBreakout!! "
{!!# $
get!!% (
;!!( )
set!!* -
;!!- .
}!!/ 0
public$$ 
long$$ 
	OpenGoals$$ 
{$$ 
get$$  #
;$$# $
set$$% (
;$$( )
}$$* +
public%% 
long%% 

ClickGoals%% 
{%%  
get%%! $
;%%$ %
set%%& )
;%%) *
}%%+ ,
public&& 
long&& 
DataFileQuantity&& $
{&&% &
get&&' *
;&&* +
set&&, /
;&&/ 0
}&&1 2
public'' 
string'' 
DataFileUrl'' !
{''" #
get''$ '
;''' (
set'') ,
;'', -
}''. /
public** 
bool** 
IsOpenPixel** 
{**  !
get**" %
;**% &
set**' *
;*** +
}**, -
public++ 
string++ 
OpenPixelUrl++ "
{++# $
get++% (
;++( )
set++* -
;++- .
}++/ 0
public,, 
bool,, 
IsOmniOrder,, 
{,,  !
get,," %
;,,% &
set,,' *
;,,* +
},,, -
public-- 
DateTime-- 
?-- 
OmniDeployDate-- '
{--( )
get--* -
;--- .
set--/ 2
;--2 3
}--4 5
public.. 
long.. 
Impressions.. 
{..  !
get.." %
;..% &
set..' *
;..* +
}.., -
public00 
bool00 
IsUseApiDataForOpen00 '
{00( )
get00* -
;00- .
set00/ 2
;002 3
}004 5
public22 
List22 
<22 
ChannelType22 
>22  
ChannelTypes22! -
{22. /
get220 3
;223 4
set225 8
;228 9
}22: ;
public44 
virtual44 
CampaignAsset44 $
Assets44% +
{44, -
get44. 1
;441 2
set443 6
;446 7
}448 9
public66 
ICollection66 
<66 
CampaignSegmentVM66 ,
>66, -
Segments66. 6
{667 8
get669 <
;66< =
set66> A
;66A B
}66C D
public88 
CampaignApprovedVM88 !
(88! "
)88" #
{99 	
Segments:: 
=:: 
new:: 
HashSet:: "
<::" #
CampaignSegmentVM::# 4
>::4 5
(::5 6
)::6 7
;::7 8
};; 	
}<< 
}== ˚.
EE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignTestingVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{		 
public

 

class

 
CampaignTestingVM

 "
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
Guid 
? 

CampaignId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
	CreatedAt !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ReBroadCast 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
ReBroadcastDate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
IsTested 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
TestingTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
TestingUrgency !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 

DeployDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 

GeoDetails  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   
string   
Demographics   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
[!! 	
Range!!	 
(!! 
$num!! 
,!! 
int!! 
.!! 
MaxValue!! 
,!! 
ErrorMessage!!  ,
=!!- .
$str!!/ T
)!!T U
]!!U V
public"" 
long"" 
Quantity"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public## 
string## 
SpecialInstructions## )
{##* +
get##, /
;##/ 0
set##1 4
;##4 5
}##6 7
public&& 
long&& 
	OpenGoals&& 
{&& 
get&&  #
;&&# $
set&&% (
;&&( )
}&&* +
public'' 
long'' 

ClickGoals'' 
{''  
get''! $
;''$ %
set''& )
;'') *
}''+ ,
public(( 
long(( 
DataFileQuantity(( $
{((% &
get((' *
;((* +
set((, /
;((/ 0
}((1 2
public)) 
string)) 
DataFileUrl)) !
{))" #
get))$ '
;))' (
set))) ,
;)), -
})). /
public** 
DateTime** 
?** 
DateFetched** $
{**% &
get**' *
;*** +
set**, /
;**/ 0
}**1 2
public-- 
bool-- 
IsOpenPixel-- 
{--  !
get--" %
;--% &
set--' *
;--* +
}--, -
public.. 
string.. 
OpenPixelUrl.. "
{..# $
get..% (
;..( )
set..* -
;..- .
}../ 0
public// 
bool// 
IsOmniOrder// 
{//  !
get//" %
;//% &
set//' *
;//* +
}//, -
public00 
DateTime00 
?00 
OmniDeployDate00 '
{00( )
get00* -
;00- .
set00/ 2
;002 3
}004 5
public11 
long11 
Impressions11 
{11  !
get11" %
;11% &
set11' *
;11* +
}11, -
public22 
List22 
<22 
ChannelType22 
>22  
ChannelTypes22! -
{22. /
get220 3
;223 4
set225 8
;228 9
}22: ;
public44 
virtual44 
CampaignAsset44 $
Assets44% +
{44, -
get44. 1
;441 2
set443 6
;446 7
}448 9
public66 
ICollection66 
<66 
CampaignSegmentVM66 ,
>66, -
Segments66. 6
{667 8
get669 <
;66< =
set66> A
;66A B
}66C D
public88 
CampaignTestingVM88  
(88  !
)88! "
{99 	
Segments:: 
=:: 
new:: 
HashSet:: "
<::" #
CampaignSegmentVM::# 4
>::4 5
(::5 6
)::6 7
;::7 8
};; 	
}<< 
}== ÎM
>E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignVM.cs
	namespace

 	
WFP


 
.

 
ICT

 
.

 
Web

 
.

 
Models

 
{ 
public 

class 

CampaignVM 
{ 
public 
Guid 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
] 
public 
DateTime 
? 
BroadcastDate &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RepresentativeName (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
RepresentativeEmail )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
bool 
ReBroadCast 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
ReBroadcastDate (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
long 
Price 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
TestingUrgency !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

GeoDetails  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   
string   
Demographics   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
["" 	
Range""	 
("" 
$num"" 
,"" 
int"" 
."" 
MaxValue"" 
,"" 
ErrorMessage""  ,
=""- .
$str""/ T
)""T U
]""U V
public## 
long## 
Quantity## 
{## 
get## "
;##" #
set##$ '
;##' (
}##) *
public&& 
string&& 
FromLine&& 
{&&  
get&&! $
;&&$ %
set&&& )
;&&) *
}&&+ ,
public'' 
string'' 
SubjectLine'' !
{''" #
get''$ '
;''' (
set'') ,
;'', -
}''. /
public)) 
bool)) 
IsPersonalization)) %
{))& '
get))( +
;))+ ,
set))- 0
;))0 1
}))2 3
public** 
bool** 
IsMatchback** 
{**  !
get**" %
;**% &
set**' *
;*** +
}**, -
public++ 
bool++ 
IsSuppression++ !
{++" #
get++$ '
;++' (
set++) ,
;++, -
}++. /
public,, 
string,, 

WhiteLabel,,  
{,,! "
get,,# &
;,,& '
set,,( +
;,,+ ,
},,- .
public-- 
string-- 
OptOut-- 
{-- 
get-- "
;--" #
set--$ '
;--' (
}--) *
public.. 
bool.. 
IsAddViewInBrowser.. &
{..' (
get..) ,
;.., -
set... 1
;..1 2
}..3 4
public// 
bool// 
IsAddOptOut// 
{//  !
get//" %
;//% &
set//' *
;//* +
}//, -
public00 
string00 
SpecialInstructions00 )
{00* +
get00, /
;00/ 0
set001 4
;004 5
}006 7
public11 
string11 
IP11 
{11 
get11 
;11 
set11  #
;11# $
}11% &
public22 
string22 
Browser22 
{22 
get22  #
;22# $
set22% (
;22( )
}22* +
public33 
string33 
OS33 
{33 
get33 
;33 
set33  #
;33# $
}33% &
public44 
string44 
Referrer44 
{44  
get44! $
;44$ %
set44& )
;44) *
}44+ ,
public66 
string66 
AssignedToCustomer66 (
{66) *
get66+ .
;66. /
set660 3
;663 4
}665 6
public99 
long99 
DataFileQuantity99 $
{99% &
get99' *
;99* +
set99, /
;99/ 0
}991 2
public<< 
bool<< 
IsOpenPixel<< 
{<<  !
get<<" %
;<<% &
set<<' *
;<<* +
}<<, -
public== 
string== 
OpenPixelUrl== "
{==# $
get==% (
;==( )
set==* -
;==- .
}==/ 0
public>> 
bool>> 
IsOmniOrder>> 
{>>  !
get>>" %
;>>% &
set>>' *
;>>* +
}>>, -
public?? 
DateTime?? 
??? 
OmniDeployDate?? '
{??( )
get??* -
;??- .
set??/ 2
;??2 3
}??4 5
public@@ 
long@@ 
Impressions@@ 
{@@  !
get@@" %
;@@% &
set@@' *
;@@* +
}@@, -
publicAA 
ListAA 
<AA 
ChannelTypeAA 
>AA  
ChannelTypesAA! -
{AA. /
getAA0 3
;AA3 4
setAA5 8
;AA8 9
}AA: ;
publicCC 
boolCC 
ReBroadcastedCC !
{CC" #
getCC$ '
;CC' (
setCC) ,
;CC, -
}CC. /
publicDD 
DateTimeDD 
?DD 
ReBroadcastedDateDD *
{DD+ ,
getDD- 0
;DD0 1
setDD2 5
;DD5 6
}DD7 8
publicEE 
longEE !
ReBroadcastedQuantityEE )
{EE* +
getEE, /
;EE/ 0
setEE1 4
;EE4 5
}EE6 7
publicFF 
stringFF $
ReBroadcastedOrderNumberFF .
{FF/ 0
getFF1 4
;FF4 5
setFF6 9
;FF9 :
}FF; <
publicHH 
GuidHH 
?HH 
AssetsIdHH 
{HH 
getHH  #
;HH# $
setHH% (
;HH( )
}HH* +
publicII 
virtualII 
CampaignAssetII $
AssetsII% +
{II, -
getII. 1
;II1 2
setII3 6
;II6 7
}II8 9
publicKK 
GuidKK 
?KK 
	TestingIdKK 
{KK  
getKK! $
;KK$ %
setKK& )
;KK) *
}KK+ ,
publicLL 
virtualLL 
CampaignTestingLL &
TestingLL' .
{LL/ 0
getLL1 4
;LL4 5
setLL6 9
;LL9 :
}LL; <
publicNN 
GuidNN 
?NN 

CreativeIdNN 
{NN  !
getNN" %
;NN% &
setNN' *
;NN* +
}NN, -
publicOO 
virtualOO 
CampaignCreativeOO '
CreativeOO( 0
{OO1 2
getOO3 6
;OO6 7
setOO8 ;
;OO; <
}OO= >
publicQQ 
GuidQQ 
?QQ 

ApprovedIdQQ 
{QQ  !
getQQ" %
;QQ% &
setQQ' *
;QQ* +
}QQ, -
publicRR 
virtualRR 
CampaignApprovedRR '
ApprovedRR( 0
{RR1 2
getRR3 6
;RR6 7
setRR8 ;
;RR; <
}RR= >
publicTT 
ICollectionTT 
<TT 
CampaignSegmentVMTT ,
>TT, -
SegmentsTT. 6
{TT7 8
getTT9 <
;TT< =
setTT> A
;TTA B
}TTC D
publicYY 

CampaignVMYY 
(YY 
)YY 
{ZZ 	
Segments[[ 
=[[ 
new[[ 
HashSet[[ "
<[[" #
CampaignSegmentVM[[# 4
>[[4 5
([[5 6
)[[6 7
;[[7 8
}__ 	
publicaa 
Campaignaa 

ToCampaignaa "
(aa" #
)aa# $
{bb 	
varcc 
ccc 
=cc 
newcc 
Campaigncc  
(cc  !
)cc! "
{dd 
Idee 
=ee 
Idee 
,ee 
OrderNumberff 
=ff 
OrderNumberff )
,ff) *
}gg 
;gg 
foreachhh 
(hh 
varhh 
	segmentVmhh "
inhh# %
Segmentshh& .
)hh. /
{ii 
cjj 
.jj 
Segmentsjj 
.jj 
Addjj 
(jj 

TinyMapperjj )
.jj) *
Mapjj* -
<jj- .
CampaignSegmentjj. =
>jj= >
(jj> ?
	segmentVmjj? H
)jjH I
)jjI J
;jjJ K
}kk 
returnll 
cll 
;ll 
}mm 	
}nn 
}pp …
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CreativeUtility.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
CreativeUtility  
{ 
public 
static 
List 
< 
SelectItemPair )
>) *

ReadEmails+ 5
(5 6
string6 <
filePath= E
)E F
{ 	
List 
< 
SelectItemPair 
>  
emails! '
=( )
new* -
List. 2
<2 3
SelectItemPair3 A
>A B
(B C
)C D
;D E
foreach 
( 
var 
line 
in  
File! %
.% &
ReadAllLines& 2
(2 3
filePath3 ;
); <
)< =
{ 
var 
trimmed 
= 
StringHelper *
.* +
Trim+ /
(/ 0
line0 4
)4 5
;5 6
if 
( 
string 
. 
IsNullOrEmpty (
(( )
trimmed) 0
)0 1
)1 2
continue3 ;
;; <
if 
( 
! 
EmailChecker  
.  !
IsValidEmail! -
(- .
trimmed. 5
)5 6
)6 7
continue8 @
;@ A
emails 
. 
Add 
( 
new 
SelectItemPair -
(- .
). /
{0 1
Selected2 :
=; <
true= A
,A B
TextC G
=H I
trimmedJ Q
,Q R
ValueS X
=Y Z
trimmed[ b
}c d
)d e
;e f
} 
return 
emails 
; 
} 	
public 
void 
Add 
( 
string 
filePath '
,' (
string) /
email0 5
)5 6
{ 	
File   
.   
AppendAllLines   
(    
filePath    (
,  ( )
new  * -
string  . 4
[  4 5
]  5 6
{  7 8
email  8 =
}  = >
)  > ?
;  ? @
}!! 	
public## 
void## 
Remove## 
(## 
string## !
filePath##" *
,##* +
string##, 2
email##3 8
)##8 9
{$$ 	
File%% 
.%% 
WriteAllLines%% 
(%% 
filePath%% '
,%%' (
File%%) -
.%%- .
ReadAllLines%%. :
(%%: ;
filePath%%; C
)%%C D
.%%D E
Where%%E J
(%%J K
x%%K L
=>%%M O
StringHelper%%P \
.%%\ ]
Trim%%] a
(%%a b
x%%b c
)%%c d
!=%%e g
email%%h m
)%%m n
)%%n o
;%%o p
}&& 	
}'' 
}(( ï
>E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CreativeVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 

CreativeVM 
{ 
public		 
string		 
Id		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
string

 

CampaignId

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
TestSeedFile "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
LiveSeedFile "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
	AllowHtml	 
] 
public 
string 
	Creatives 
{  !
get" %
;% &
set' *
;* +
}, -
public 
List 
< 
SelectItemPair "
>" #

TestEmails$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
List 
< 
SelectItemPair "
>" #

LiveEmails$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string 
QuickTestEmails %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
MailChimpList #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
MailChimpCampaign '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
} 
} Çd
FE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignTrackingVm.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public		 

class		 
CampaignTrackingVm		 #
{

 
public 
string 

CampaignId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 

TrackingId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
FromLine 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
SubjectLine !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	OrderDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Quantity 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
IoNumber 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	StartDate 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Opened 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Clicked 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Unsub 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Forwards 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
OpenedPercentage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
ClickedPercentage '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
UnsubPercentage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string !
ClickToOpenPercentage +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public   
string   !
UnsubToOpenPercentage   +
{  , -
get  . 1
;  1 2
set  3 6
;  6 7
}  8 9
public!! 
string!! 
Bounce!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public"" 
string"" 
Opt"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
public## 
string## 
Desktop## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
public$$ 
string$$ 
Mobile$$ 
{$$ 
get$$ "
;$$" #
set$$$ '
;$$' (
}$$) *
public&& 
List&& 
<&& $
CampaignTrackingDetailVm&& ,
>&&, -
PerLink&&. 5
{&&6 7
get&&8 ;
;&&; <
set&&= @
;&&@ A
}&&B C
public(( 
static(( 
CampaignTrackingVm(( ( 
FromCampaignTracking(() =
(((= >
Campaign((> F
campaign((G O
,((O P
CampaignTracking((Q a
campaignTracking((b r
)((r s
{)) 	
var** 
model** 
=** 
new** 
CampaignTrackingVm** .
{++ 

CampaignId,, 
=,, 
campaign,, %
.,,% &
Id,,& (
.,,( )
ToString,,) 1
(,,1 2
),,2 3
,,,3 4

TrackingId-- 
=-- 
campaignTracking-- -
.--- .
Id--. 0
.--0 1
ToString--1 9
(--9 :
)--: ;
,--; <
OrderNumber.. 
=.. 
string.. $
...$ %
IsNullOrEmpty..% 2
(..2 3
campaignTracking..3 C
...C D
SegmentNumber..D Q
)..Q R
?..S T
campaignTracking..U e
...e f
OrderNumber..f q
:..r s
campaignTracking	..t Ñ
.
..Ñ Ö
SegmentNumber
..Ö í
,
..í ì
CampaignName// 
=// 
campaign// '
.//' (
Approved//( 0
.//0 1
CampaignName//1 =
,//= >

WhiteLabel00 
=00 
campaign00 %
.00% &
Approved00& .
.00. /

WhiteLabel00/ 9
,009 :
SubjectLine11 
=11 
campaign11 &
.11& '
Approved11' /
.11/ 0
SubjectLine110 ;
,11; <
FromLine22 
=22 
campaign22 #
.22# $
Approved22$ ,
.22, -
FromLine22- 5
,225 6
	OrderDate33 
=33 
campaign33 $
.33$ %
	CreatedAt33% .
.33. /
ToString33/ 7
(337 8
StringConstants338 G
.33G H
DateFormatSlashes33H Y
)33Y Z
,33Z [
Status44 
=44 
(44 
(44 
CampaignStatus44 )
)44) *
campaign44* 2
.442 3
Status443 9
)449 :
.44: ;
ToString44; C
(44C D
)44D E
,44E F
Quantity66 
=66 
campaignTracking66 +
.66+ ,
Quantity66, 4
.664 5
ToString665 =
(66= >
)66> ?
,66? @
IoNumber77 
=77 
campaignTracking77 +
.77+ ,
IoNumber77, 4
,774 5
	StartDate88 
=88 
campaignTracking88 ,
.88, -
	StartDate88- 6
?886 7
.887 8
ToString888 @
(88@ A
StringConstants88A P
.88P Q
DateFormatSlashes88Q b
)88b c
,88c d
Opened99 
=99 
campaignTracking99 )
.99) *
Opened99* 0
==991 3
$num994 5
?996 7
$str998 <
:99= >
campaignTracking99? O
.99O P
Opened99P V
.99V W
ToString99W _
(99_ `
)99` a
,99a b
Clicked:: 
=:: 
campaignTracking:: *
.::* +
Clicked::+ 2
==::3 5
$num::6 7
?::8 9
$str::: >
:::? @
campaignTracking::A Q
.::Q R
Clicked::R Y
.::Y Z
ToString::Z b
(::b c
)::c d
,::d e
Unsub;; 
=;; 
campaignTracking;; (
.;;( )
Unsub;;) .
==;;/ 1
$num;;2 3
?;;4 5
$str;;6 :
:;;; <
campaignTracking;;= M
.;;M N
Unsub;;N S
.;;S T
ToString;;T \
(;;\ ]
);;] ^
,;;^ _
Forwards<< 
=<< 
campaignTracking<< +
.<<+ ,
Forwards<<, 4
==<<5 7
$num<<8 9
?<<: ;
$str<<< @
:<<A B
campaignTracking<<C S
.<<S T
Forwards<<T \
.<<\ ]
ToString<<] e
(<<e f
)<<f g
,<<g h
Mobile== 
=== 
campaignTracking== )
.==) *
Mobile==* 0
.==0 1
ToString==1 9
(==9 :
)==: ;
,==; <
Desktop>> 
=>> 
campaignTracking>> *
.>>* +
Desktop>>+ 2
.>>2 3
ToString>>3 ;
(>>; <
)>>< =
,>>= >
Bounce?? 
=?? 
campaignTracking?? )
.??) *
Bounce??* 0
.??0 1
ToString??1 9
(??9 :
)??: ;
,??; <
Opt@@ 
=@@ 
campaignTracking@@ &
.@@& '
Opt@@' *
.@@* +
ToString@@+ 3
(@@3 4
)@@4 5
,@@5 6
OpenedPercentageAA  
=AA! "
campaignTrackingAA# 3
.AA3 4
OpenedPercentageAA4 D
.AAD E
ToStringAAE M
(AAM N
$strAAN U
)AAU V
,AAV W
ClickedPercentageBB !
=BB" #
campaignTrackingBB$ 4
.BB4 5
ClickedPercentageBB5 F
.BBF G
ToStringBBG O
(BBO P
$strBBP W
)BBW X
,BBX Y
UnsubPercentageCC 
=CC  !
campaignTrackingCC" 2
.CC2 3
UnsubPercentageCC3 B
.CCB C
ToStringCCC K
(CCK L
$strCCL S
)CCS T
,CCT U!
ClickToOpenPercentageDD %
=DD& '
campaignTrackingDD( 8
.DD8 9!
ClickToOpenPercentageDD9 N
.DDN O
ToStringDDO W
(DDW X
$strDDX _
)DD_ `
,DD` a!
UnsubToOpenPercentageEE %
=EE& '
campaignTrackingEE( 8
.EE8 9!
UnsubToOpenPercentageEE9 N
.EEN O
ToStringEEO W
(EEW X
$strEEX _
)EE_ `
,EE` a
PerLinkGG 
=GG 
newGG 
ListGG "
<GG" #$
CampaignTrackingDetailVmGG# ;
>GG; <
(GG< =
)GG= >
}HH 
;HH 
varJJ 
proDatasJJ 
=JJ 
campaignJJ #
.JJ# $
ProDatasJJ$ ,
.KK 
WhereKK 
(KK 
xKK 
=>KK 
xKK 
.KK 
OrderNumberKK )
==KK* ,
campaignTrackingKK- =
.KK= >
OrderNumberKK> I
&&KKJ L
xKKM N
.KKN O
SegmentNumberKKO \
==KK] _
campaignTrackingKK` p
.KKp q
SegmentNumberKKq ~
)KK~ 
.LL 
OrderByLL 
(LL 
xLL 
=>LL 
ProDataHelperLL +
.LL+ ,
GetIndexLL, 4
(LL4 5
xLL5 6
.LL6 7
Reportsite_URLLL7 E
)LLE F
)LLF G
;LLG H
foreachNN 
(NN 
varNN 
proDataNN  
inNN! #
proDatasNN$ ,
)NN, -
{OO 
modelPP 
.PP 
PerLinkPP 
.PP 
AddPP !
(PP! "
newPP" %$
CampaignTrackingDetailVmPP& >
{QQ 
IoNumberRR 
=RR 
proDataRR &
.RR& '
IORR' )
,RR) *
OrderNumberSS 
=SS  !
proDataSS" )
.SS) *
Reportsite_URLSS* 8
,SS8 9
LinkTT 
=TT 
proDataTT "
.TT" #
Destination_URLTT# 2
,TT2 3

ClickCountUU 
=UU  
proDataUU! (
.UU( )

ClickCountUU) 3
.UU3 4
ToStringUU4 <
(UU< =
)UU= >
,UU> ?
UniqueCountVV 
=VV  !
proDataVV" )
.VV) *
	UniqueCntVV* 3
.VV3 4
ToStringVV4 <
(VV< =
)VV= >
,VV> ?
MobileCountWW 
=WW  !
proDataWW" )
.WW) *
	MobileCntWW* 3
.WW3 4
ToStringWW4 <
(WW< =
)WW= >
}XX 
)XX 
;XX 
}YY 
return[[ 
model[[ 
;[[ 
}\\ 	
}]] 
}^^ í
EE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\HtmlProcessResult.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
HtmlProcessResult "
{ 
public 
string 
filePathLive "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
UploadFileStatus 
Status  &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
}		 
}

 Ì
CE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\ProData\ProDataRequest.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
ProData 
{ 
public 

class 
ProDataRequest 
{ 
public 
string 
io 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
campaign_name #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
is_rebroadcast $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
white_label !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
creative_url		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public

 
long

 
quantity

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
geo_type 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
geo_url 
{ 
get  #
;# $
set% (
;( )
}* +
public 
double 
ctr_percent !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
subject 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
	from_name 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

from_email  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
deploy_date !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
is_open_pixel #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
double 
open_percent "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

open_pixel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
is_data_file "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
data_file_url #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string '
data_file_replacement_param 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 
string (
data_file_replacement_column 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
string 
data_file_unique_ip )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
} 
} ˘
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\ProData\ProDataResponse.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
ProData 
{ 
public 

class 
ProDataResponse  
{ 
public 
string 
status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Reports 
reports 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
	timestamp		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
string

 
message

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
List 
< 
string 
> 
error_fields (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
long &
queued_pending_campaign_id .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string 
ResponseStatus $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ResponseMessage %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class 
Reports 
{ 
public 
Report 
[ 
] 
report 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public 

class 
Report 
{ 
public 
string 
IO 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Reportsite_URL $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
Destination_URL %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
CampaignStartDate '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 

ClickCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
CampaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
long 
	UniqueCnt 
{ 
get  #
;# $
set% (
;( )
}* +
public   
long   
	MobileCnt   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
public!! 
long!! 
ImpressionCnt!! !
{!!" #
get!!$ '
;!!' (
set!!) ,
;!!, -
}!!. /
}"" 
}$$ ◊
GE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CompanyPermissionVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
CompanyPermissionVM $
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public		 
string		 

ClaimValue		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
	ClaimType

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 

RolesCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 

IsEditable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
IsDeletable 
{  !
get" %
;% &
set' *
;* +
}, -
public 
IEnumerable 
< 
SelectListItem )
>) *

ClaimTypes+ 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
} 
} ¯
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CompanyRoleVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
CompanyRoleVM 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public		 
string		 
Name		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
string

 
Description

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
bool 

IsEditable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
IsDeletable 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
InUsers 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Action 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
PermissionId "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
List 
< 
SelectItemPair "
>" #
Permissions$ /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ©
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CampaignSearchVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
CampaignSearchVM !
{ 
public 
string 
	sortOrder 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
page 
{ 
get 
; 
set  #
;# $
}% &
public 
string 

searchType  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
string		 
basicString		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
basicOrderNumber

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
public 
string 
basicStatus !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
advancedStatus $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
advancedUser "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
campaignName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
isTested 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
orderedFrom !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	orderedTo 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
broadcastFrom #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
broadcastTo !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
clearSessionId $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} ÙU
@E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\OfficeUserVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class .
"ExternalLoginConfirmationViewModel 3
{ 
[ 	
Required	 
] 
[		 	
Display			 
(		 
Name		 
=		 
$str		 
)		  
]		  !
public

 
string

 
Email

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
} 
public 

class &
ExternalLoginListViewModel +
{ 
public 
string 
	ReturnUrl 
{  !
get" %
;% &
set' *
;* +
}, -
} 
public 

class 
SendCodeViewModel "
{ 
public 
string 
SelectedProvider &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
ICollection 
< 
System !
.! "
Web" %
.% &
Mvc& )
.) *
SelectListItem* 8
>8 9
	Providers: C
{D E
getF I
;I J
setK N
;N O
}P Q
public 
string 
	ReturnUrl 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 

RememberMe 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public 

class 
VerifyCodeViewModel $
{ 
[ 	
Required	 
] 
public 
string 
Provider 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
[   	
Display  	 
(   
Name   
=   
$str   
)   
]    
public!! 
string!! 
Code!! 
{!! 
get!!  
;!!  !
set!!" %
;!!% &
}!!' (
public"" 
string"" 
	ReturnUrl"" 
{""  !
get""" %
;""% &
set""' *
;""* +
}"", -
[$$ 	
Display$$	 
($$ 
Name$$ 
=$$ 
$str$$ 0
)$$0 1
]$$1 2
public%% 
bool%% 
RememberBrowser%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public'' 
bool'' 

RememberMe'' 
{''  
get''! $
;''$ %
set''& )
;'') *
}''+ ,
}(( 
public** 

class** 
ForgotViewModel**  
{++ 
[,, 	
Required,,	 
],, 
[-- 	
Display--	 
(-- 
Name-- 
=-- 
$str-- 
)--  
]--  !
public.. 
string.. 
Email.. 
{.. 
get.. !
;..! "
set..# &
;..& '
}..( )
}// 
public11 

class11 
LoginViewModel11 
{22 
[33 	
Required33	 
(33 
ErrorMessage33 
=33  
$str33! 8
)338 9
]339 :
[44 	
Display44	 
(44 
Name44 
=44 
$str44 "
)44" #
]44# $
public66 
string66 
Username66 
{66  
get66! $
;66$ %
set66& )
;66) *
}66+ ,
[88 	
Required88	 
(88 
ErrorMessage88 
=88  
$str88  7
)887 8
]888 9
[99 	
DataType99	 
(99 
DataType99 
.99 
Password99 #
)99# $
]99$ %
[:: 	
Display::	 
(:: 
Name:: 
=:: 
$str:: "
)::" #
]::# $
public;; 
string;; 
Password;; 
{;;  
get;;! $
;;;$ %
set;;& )
;;;) *
};;+ ,
[== 	
Display==	 
(== 
Name== 
=== 
$str== &
)==& '
]==' (
public>> 
bool>> 

RememberMe>> 
{>>  
get>>! $
;>>$ %
set>>& )
;>>) *
}>>+ ,
}?? 
publicAA 

classAA 
RegisterViewModelAA "
{BB 
[CC 	
RequiredCC	 
]CC 
[DD 	
DisplayDD	 
(DD 
NameDD 
=DD 
$strDD %
)DD% &
]DD& '
publicEE 
stringEE 

WhiteLabelEE  
{EE! "
getEE# &
;EE& '
setEE( +
;EE+ ,
}EE- .
[GG 	
RequiredGG	 
]GG 
[HH 	
DisplayHH	 
(HH 
NameHH 
=HH 
$strHH #
)HH# $
]HH$ %
publicII 
stringII 
UserNameII 
{II  
getII! $
;II$ %
setII& )
;II) *
}II+ ,
[KK 	
RequiredKK	 
]KK 
[LL 	
DisplayLL	 
(LL 
NameLL 
=LL 
$strLL '
)LL' (
]LL( )
publicMM 
boolMM 
IsAdminUserMM 
{MM  !
getMM" %
;MM% &
setMM' *
;MM* +
}MM, -
[OO 	
RequiredOO	 
]OO 
[PP 	
DisplayPP	 
(PP 
NamePP 
=PP 
$strPP %
)PP% &
]PP& '
publicQQ 
boolQQ 
	IsUsesAPIQQ 
{QQ 
getQQ  #
;QQ# $
setQQ% (
;QQ( )
}QQ* +
[SS 	
RequiredSS	 
]SS 
[TT 	
DisplayTT	 
(TT 
NameTT 
=TT 
$strTT 2
)TT2 3
]TT3 4
publicUU 
boolUU 
IsTestsCreativesUU $
{UU% &
getUU' *
;UU* +
setUU, /
;UU/ 0
}UU1 2
[WW 	
RequiredWW	 
]WW 
[XX 	
EmailAddressXX	 
]XX 
[YY 	
DisplayYY	 
(YY 
NameYY 
=YY 
$strYY 
)YY  
]YY  !
publicZZ 
stringZZ 
EmailZZ 
{ZZ 
getZZ !
;ZZ! "
setZZ# &
;ZZ& '
}ZZ( )
[\\ 	
Required\\	 
]\\ 
[]] 	
StringLength]]	 
(]] 
$num]] 
,]] 
ErrorMessage]] '
=]]( )
$str]]* Y
,]]Y Z
MinimumLength]][ h
=]]i j
$num]]k l
)]]l m
]]]m n
[^^ 	
DataType^^	 
(^^ 
DataType^^ 
.^^ 
Password^^ #
)^^# $
]^^$ %
[__ 	
Display__	 
(__ 
Name__ 
=__ 
$str__ "
)__" #
]__# $
public`` 
string`` 
Password`` 
{``  
get``! $
;``$ %
set``& )
;``) *
}``+ ,
[bb 	
DataTypebb	 
(bb 
DataTypebb 
.bb 
Passwordbb #
)bb# $
]bb$ %
[cc 	
Displaycc	 
(cc 
Namecc 
=cc 
$strcc *
)cc* +
]cc+ ,
[dd 	
Comparedd	 
(dd 
$strdd 
,dd 
ErrorMessagedd )
=dd* +
$strdd, b
)ddb c
]ddc d
publicee 
stringee 
ConfirmPasswordee %
{ee& '
getee( +
;ee+ ,
setee- 0
;ee0 1
}ee2 3
}ff 
publichh 

classhh "
ResetPasswordViewModelhh '
{ii 
[jj 	
Requiredjj	 
]jj 
[kk 	
EmailAddresskk	 
]kk 
[ll 	
Displayll	 
(ll 
Namell 
=ll 
$strll 
)ll  
]ll  !
publicmm 
stringmm 
Emailmm 
{mm 
getmm !
;mm! "
setmm# &
;mm& '
}mm( )
[oo 	
Requiredoo	 
]oo 
[pp 	
StringLengthpp	 
(pp 
$numpp 
,pp 
ErrorMessagepp '
=pp( )
$strpp* Y
,ppY Z
MinimumLengthpp[ h
=ppi j
$numppk l
)ppl m
]ppm n
[qq 	
DataTypeqq	 
(qq 
DataTypeqq 
.qq 
Passwordqq #
)qq# $
]qq$ %
[rr 	
Displayrr	 
(rr 
Namerr 
=rr 
$strrr "
)rr" #
]rr# $
publicss 
stringss 
Passwordss 
{ss  
getss! $
;ss$ %
setss& )
;ss) *
}ss+ ,
[uu 	
DataTypeuu	 
(uu 
DataTypeuu 
.uu 
Passworduu #
)uu# $
]uu$ %
[vv 	
Displayvv	 
(vv 
Namevv 
=vv 
$strvv *
)vv* +
]vv+ ,
[ww 	
Compareww	 
(ww 
$strww 
,ww 
ErrorMessageww )
=ww* +
$strww, b
)wwb c
]wwc d
publicxx 
stringxx 
ConfirmPasswordxx %
{xx& '
getxx( +
;xx+ ,
setxx- 0
;xx0 1
}xx2 3
publiczz 
stringzz 
Codezz 
{zz 
getzz  
;zz  !
setzz" %
;zz% &
}zz' (
}{{ 
public}} 

class}} #
ForgotPasswordViewModel}} (
{~~ 
[ 	
Required	 
] 
[
ÄÄ 	
EmailAddress
ÄÄ	 
]
ÄÄ 
[
ÅÅ 	
Display
ÅÅ	 
(
ÅÅ 
Name
ÅÅ 
=
ÅÅ 
$str
ÅÅ 
)
ÅÅ  
]
ÅÅ  !
public
ÇÇ 
string
ÇÇ 
Email
ÇÇ 
{
ÇÇ 
get
ÇÇ !
;
ÇÇ! "
set
ÇÇ# &
;
ÇÇ& '
}
ÇÇ( )
}
ÉÉ 
}ÑÑ Û
BE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\CompanyUsersVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
CompanyUsersVM 
{ 
public		 
Guid		 
ID		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Action 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
OfficeID 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
UnitID 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

OfficeName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
UnitName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Role 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
SelectItemPair "
>" #
Roles$ )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
bool 
IsLocalUser 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} ò
@E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\JsonResponse.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
JsonResponse 
{ 
public 
bool 
IsSucess 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
ErrorMessage "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
object 
Result 
{ 
get "
;" #
set$ '
;' (
}) *
} 
}		 Û8
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\ManageViewModels.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
IndexViewModel 
{		 
public

 
bool

 
HasPassword

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
IList 
< 
UserLoginInfo "
>" #
Logins$ *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
PhoneNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
	TwoFactor 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
BrowserRemembered %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class !
ManageLoginsViewModel &
{ 
public 
IList 
< 
UserLoginInfo "
>" #
CurrentLogins$ 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 
IList 
< %
AuthenticationDescription .
>. /
OtherLogins0 ;
{< =
get> A
;A B
setC F
;F G
}H I
} 
public 

class 
FactorViewModel  
{ 
public 
string 
Purpose 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

class  
SetPasswordViewModel %
{ 
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage '
=( )
$str* Y
,Y Z
MinimumLength[ h
=i j
$numk l
)l m
]m n
[   	
DataType  	 
(   
DataType   
.   
Password   #
)  # $
]  $ %
[!! 	
Display!!	 
(!! 
Name!! 
=!! 
$str!! &
)!!& '
]!!' (
public"" 
string"" 
NewPassword"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
[$$ 	
DataType$$	 
($$ 
DataType$$ 
.$$ 
Password$$ #
)$$# $
]$$$ %
[%% 	
Display%%	 
(%% 
Name%% 
=%% 
$str%% .
)%%. /
]%%/ 0
[&& 	
Compare&&	 
(&& 
$str&& 
,&& 
ErrorMessage&&  ,
=&&- .
$str&&/ i
)&&i j
]&&j k
public'' 
string'' 
ConfirmPassword'' %
{''& '
get''( +
;''+ ,
set''- 0
;''0 1
}''2 3
}(( 
public** 

class** #
ChangePasswordViewModel** (
{++ 
[,, 	
Required,,	 
],, 
[-- 	
DataType--	 
(-- 
DataType-- 
.-- 
Password-- #
)--# $
]--$ %
[.. 	
Display..	 
(.. 
Name.. 
=.. 
$str.. *
)..* +
]..+ ,
public// 
string// 
OldPassword// !
{//" #
get//$ '
;//' (
set//) ,
;//, -
}//. /
[11 	
Required11	 
]11 
[22 	
StringLength22	 
(22 
$num22 
,22 
ErrorMessage22 '
=22( )
$str22* Y
,22Y Z
MinimumLength22[ h
=22i j
$num22k l
)22l m
]22m n
[33 	
DataType33	 
(33 
DataType33 
.33 
Password33 #
)33# $
]33$ %
[44 	
Display44	 
(44 
Name44 
=44 
$str44 &
)44& '
]44' (
public55 
string55 
NewPassword55 !
{55" #
get55$ '
;55' (
set55) ,
;55, -
}55. /
[77 	
DataType77	 
(77 
DataType77 
.77 
Password77 #
)77# $
]77$ %
[88 	
Display88	 
(88 
Name88 
=88 
$str88 .
)88. /
]88/ 0
[99 	
Compare99	 
(99 
$str99 
,99 
ErrorMessage99  ,
=99- .
$str99/ i
)99i j
]99j k
public:: 
string:: 
ConfirmPassword:: %
{::& '
get::( +
;::+ ,
set::- 0
;::0 1
}::2 3
};; 
public== 

class== #
AddPhoneNumberViewModel== (
{>> 
[?? 	
Required??	 
]?? 
[@@ 	
Phone@@	 
]@@ 
[AA 	
DisplayAA	 
(AA 
NameAA 
=AA 
$strAA &
)AA& '
]AA' (
publicBB 
stringBB 
NumberBB 
{BB 
getBB "
;BB" #
setBB$ '
;BB' (
}BB) *
}CC 
publicEE 

classEE &
VerifyPhoneNumberViewModelEE +
{FF 
[GG 	
RequiredGG	 
]GG 
[HH 	
DisplayHH	 
(HH 
NameHH 
=HH 
$strHH 
)HH 
]HH  
publicII 
stringII 
CodeII 
{II 
getII  
;II  !
setII" %
;II% &
}II' (
[KK 	
RequiredKK	 
]KK 
[LL 	
PhoneLL	 
]LL 
[MM 	
DisplayMM	 
(MM 
NameMM 
=MM 
$strMM &
)MM& '
]MM' (
publicNN 
stringNN 
PhoneNumberNN !
{NN" #
getNN$ '
;NN' (
setNN) ,
;NN, -
}NN. /
}OO 
publicQQ 

classQQ '
ConfigureTwoFactorViewModelQQ ,
{RR 
publicSS 
stringSS 
SelectedProviderSS &
{SS' (
getSS) ,
;SS, -
setSS. 1
;SS1 2
}SS3 4
publicTT 
ICollectionTT 
<TT 
SystemTT !
.TT! "
WebTT" %
.TT% &
MvcTT& )
.TT) *
SelectListItemTT* 8
>TT8 9
	ProvidersTT: C
{TTD E
getTTF I
;TTI J
setTTK N
;TTN O
}TTP Q
}UU 
}VV ù
?E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\SystemLogVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public		 

class		 
SystemLogVM		 
{

 
public 
string 
	CreatedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LogType 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
public 
SystemLogVM 
( 
) 
{ 	
} 	
} 
} Ü
@E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\UploadFileVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public		 

class		 
UploadFileVM		 
{

 
public 
string 
FileName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
FileType 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
OrderNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
SegmentNumber #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
bool 
IsValid 
( 
string "
filePath# +
)+ ,
{ 	
bool 
isValid 
= 
true 
;  
switch 
( 
FileType 
) 
{ 
case 
$str )
:) *
int 
n 
; 
foreach 
( 
var  
line! %
in& (
File) -
.- .
ReadAllLines. :
(: ;
filePath; C
)C D
)D E
{ 
if 
( 
line  
.  !
Trim! %
(% &
)& '
.' (
Length( .
!=/ 1
$num2 3
&&4 6
!7 8
int8 ;
.; <
TryParse< D
(D E
lineE I
.I J
TrimJ N
(N O
)O P
,P Q
outR U
nV W
)W X
)X Y
{ 
isValid #
=$ %
false& +
;+ ,
break !
;! "
} 
} 
break 
; 
}   
return!! 
isValid!! 
;!! 
}"" 	
}$$ 
}%% ü
AE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Models\UserProfileVM.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Models 
{ 
public 

class 
UserProfileVM 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
CCEmails

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
Status 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
Type 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
DateCreated !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
	IsUsesApi 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
ApiKey 
{ 
get "
;" #
set$ '
;' (
}) *
public 
bool 
IsTestsCreatives $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
CompanyName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
CompanyLogo !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 

WhiteLabel  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
ReportTemplate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} Ô
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str &
)& '
]' (
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str (
)( )
]) *
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[!! 
assembly!! 	
:!!	 

AssemblyVersion!! 
(!! 
$str!! $
)!!$ %
]!!% &
["" 
assembly"" 	
:""	 

AssemblyFileVersion"" 
("" 
$str"" (
)""( )
]"") *†◊
DE:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Reports\TrackingReports.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Reports 
{ 
public 

static 
class 
TrackingReports '
{ 
public 
static 
void 
GenerateTemplate1 ,
(, -
CampaignTrackingVm- ?
model@ E
,E F
stringG M
templateFileN Z
,Z [
string\ b
logoFilePathc o
,o p
stringq w
imageFilePath	x Ö
,
Ö Ü
string
á ç

outputFile
é ò
)
ò ô
{ 	
File 
. 
Copy 
( 
templateFile "
," #

outputFile$ .
,. /
true0 4
)4 5
;5 6
byte 
[ 
] 
	byteArray 
= 
File #
.# $
ReadAllBytes$ 0
(0 1

outputFile1 ;
); <
;< =
using 
( 
MemoryStream 
stream  &
=' (
new) ,
MemoryStream- 9
(9 :
): ;
); <
{ 
stream 
. 
Write 
( 
	byteArray &
,& '
$num( )
,) *
	byteArray+ 4
.4 5
Length5 ;
); <
;< =
using 
( 
SpreadsheetDocument *
spreadSheet+ 6
=7 8
SpreadsheetDocument9 L
.L M
OpenM Q
(Q R
streamR X
,X Y
trueZ ^
)^ _
)_ `
{ 
IEnumerable   
<    
Sheet    %
>  % &
sheets  ' -
=  . /
spreadSheet  0 ;
.  ; <
WorkbookPart  < H
.  H I
Workbook  I Q
.!! 
GetFirstChild!! &
<!!& '
Sheets!!' -
>!!- .
(!!. /
)!!/ 0
.!!0 1
Elements!!1 9
<!!9 :
Sheet!!: ?
>!!? @
(!!@ A
)!!A B
."" 
Where"" 
("" 
s""  
=>""! #
s""$ %
.""% &
Name""& *
==""+ -
$str"". >
)""> ?
.## 
ToArray##  
(##  !
)##! "
;##" #
if%% 
(%% 
!%% 
sheets%% 
.%%  
Any%%  #
(%%# $
)%%$ %
)%%% &
{&& 
throw'' 
new'' !
AdsException''" .
(''. /
$str''/ :
)'': ;
;''; <
}(( 
string** 
relationshipId** )
=*** +
sheets**, 2
.**2 3
First**3 8
(**8 9
)**9 :
.**: ;
Id**; =
.**= >
Value**> C
;**C D
WorksheetPart++ !
worksheetPart++" /
=++0 1
(++2 3
WorksheetPart++3 @
)++@ A
spreadSheet++B M
.++M N
WorkbookPart++N Z
.++Z [
GetPartById++[ f
(++f g
relationshipId++g u
)++u v
;++v w
AddImage// 
(// 
worksheetPart// *
,//* +
logoFilePath//, 8
,//8 9
$num//: ;
,//; <
$num//= >
)//> ?
;//? @
AddImage00 
(00 
worksheetPart00 *
,00* +
logoFilePath00, 8
,008 9
$num00: <
,00< =
$num00> ?
)00? @
;00@ A
Cell22 
cell22 
=22 
GetCell22  '
(22' (
worksheetPart22( 5
.225 6
	Worksheet226 ?
,22? @
$str22A D
,22D E
$num22F G
)22G H
;22H I
cell33 
.33 
	CellValue33 "
=33# $
new33% (
	CellValue33) 2
(332 3
model333 8
.338 9
OrderNumber339 D
)33D E
;33E F
cell44 
.44 
DataType44 !
=44" #
new44$ '
	EnumValue44( 1
<441 2

CellValues442 <
>44< =
(44= >

CellValues44> H
.44H I
String44I O
)44O P
;44P Q
cell66 
=66 
GetCell66 "
(66" #
worksheetPart66# 0
.660 1
	Worksheet661 :
,66: ;
$str66< ?
,66? @
$num66A B
)66B C
;66C D
cell77 
.77 
	CellValue77 "
=77# $
new77% (
	CellValue77) 2
(772 3
model773 8
.778 9
	StartDate779 B
)77B C
;77C D
cell88 
.88 
DataType88 !
=88" #
new88$ '
	EnumValue88( 1
<881 2

CellValues882 <
>88< =
(88= >

CellValues88> H
.88H I
String88I O
)88O P
;88P Q
cell:: 
=:: 
GetCell:: "
(::" #
worksheetPart::# 0
.::0 1
	Worksheet::1 :
,::: ;
$str::< ?
,::? @
$num::A C
)::C D
;::D E
cell;; 
.;; 
	CellValue;; "
=;;# $
new;;% (
	CellValue;;) 2
(;;2 3
DateTime;;3 ;
.;;; <
Now;;< ?
.;;? @
ToString;;@ H
(;;H I
StringConstants;;I X
.;;X Y
DateFormatSlashes;;Y j
);;j k
);;k l
;;;l m
cell<< 
.<< 
DataType<< !
=<<" #
new<<$ '
	EnumValue<<( 1
<<<1 2

CellValues<<2 <
><<< =
(<<= >

CellValues<<> H
.<<H I
String<<I O
)<<O P
;<<P Q
cell>> 
=>> 
GetCell>> "
(>>" #
worksheetPart>># 0
.>>0 1
	Worksheet>>1 :
,>>: ;
$str>>< ?
,>>? @
$num>>A B
)>>B C
;>>C D
cell?? 
.?? 
	CellValue?? "
=??# $
new??% (
	CellValue??) 2
(??2 3
model??3 8
.??8 9
CampaignName??9 E
)??E F
;??F G
cell@@ 
.@@ 
DataType@@ !
=@@" #
new@@$ '
	EnumValue@@( 1
<@@1 2

CellValues@@2 <
>@@< =
(@@= >

CellValues@@> H
.@@H I
String@@I O
)@@O P
;@@P Q
cellCC 
=CC 
GetCellCC "
(CC" #
worksheetPartCC# 0
.CC0 1
	WorksheetCC1 :
,CC: ;
$strCC< ?
,CC? @
$numCCA C
)CCC D
;CCD E
cellDD 
.DD 
	CellValueDD "
=DD# $
newDD% (
	CellValueDD) 2
(DD2 3
modelDD3 8
.DD8 9
OpenedPercentageDD9 I
)DDI J
;DDJ K
cellEE 
.EE 
DataTypeEE !
=EE" #
newEE$ '
	EnumValueEE( 1
<EE1 2

CellValuesEE2 <
>EE< =
(EE= >

CellValuesEE> H
.EEH I
StringEEI O
)EEO P
;EEP Q
cellGG 
=GG 
GetCellGG "
(GG" #
worksheetPartGG# 0
.GG0 1
	WorksheetGG1 :
,GG: ;
$strGG< ?
,GG? @
$numGGA C
)GGC D
;GGD E
cellHH 
.HH 
	CellValueHH "
=HH# $
newHH% (
	CellValueHH) 2
(HH2 3
modelHH3 8
.HH8 9
QuantityHH9 A
)HHA B
;HHB C
cellII 
.II 
DataTypeII !
=II" #
newII$ '
	EnumValueII( 1
<II1 2

CellValuesII2 <
>II< =
(II= >

CellValuesII> H
.IIH I
StringIII O
)IIO P
;IIP Q
cellKK 
=KK 
GetCellKK "
(KK" #
worksheetPartKK# 0
.KK0 1
	WorksheetKK1 :
,KK: ;
$strKK< ?
,KK? @
$numKKA C
)KKC D
;KKD E
cellLL 
.LL 
	CellValueLL "
=LL# $
newLL% (
	CellValueLL) 2
(LL2 3
modelLL3 8
.LL8 9
OpenedLL9 ?
)LL? @
;LL@ A
cellMM 
.MM 
DataTypeMM !
=MM" #
newMM$ '
	EnumValueMM( 1
<MM1 2

CellValuesMM2 <
>MM< =
(MM= >

CellValuesMM> H
.MMH I
StringMMI O
)MMO P
;MMP Q
cellPP 
=PP 
GetCellPP "
(PP" #
worksheetPartPP# 0
.PP0 1
	WorksheetPP1 :
,PP: ;
$strPP< ?
,PP? @
$numPPA C
)PPC D
;PPD E
cellQQ 
.QQ 
	CellValueQQ "
=QQ# $
newQQ% (
	CellValueQQ) 2
(QQ2 3
modelQQ3 8
.QQ8 9
OpenedPercentageQQ9 I
)QQI J
;QQJ K
cellRR 
.RR 
DataTypeRR !
=RR" #
newRR$ '
	EnumValueRR( 1
<RR1 2

CellValuesRR2 <
>RR< =
(RR= >

CellValuesRR> H
.RRH I
StringRRI O
)RRO P
;RRP Q
cellTT 
=TT 
GetCellTT "
(TT" #
worksheetPartTT# 0
.TT0 1
	WorksheetTT1 :
,TT: ;
$strTT< ?
,TT? @
$numTTA C
)TTC D
;TTD E
cellUU 
.UU 
	CellValueUU "
=UU# $
newUU% (
	CellValueUU) 2
(UU2 3
modelUU3 8
.UU8 9
OpenedUU9 ?
)UU? @
;UU@ A
cellVV 
.VV 
DataTypeVV !
=VV" #
newVV$ '
	EnumValueVV( 1
<VV1 2

CellValuesVV2 <
>VV< =
(VV= >

CellValuesVV> H
.VVH I
StringVVI O
)VVO P
;VVP Q
cellYY 
=YY 
GetCellYY "
(YY" #
worksheetPartYY# 0
.YY0 1
	WorksheetYY1 :
,YY: ;
$strYY< ?
,YY? @
$numYYA C
)YYC D
;YYD E
cellZZ 
.ZZ 
	CellValueZZ "
=ZZ# $
newZZ% (
	CellValueZZ) 2
(ZZ2 3
modelZZ3 8
.ZZ8 9
ClickedZZ9 @
)ZZ@ A
;ZZA B
cell[[ 
.[[ 
DataType[[ !
=[[" #
new[[$ '
	EnumValue[[( 1
<[[1 2

CellValues[[2 <
>[[< =
([[= >

CellValues[[> H
.[[H I
String[[I O
)[[O P
;[[P Q
cell]] 
=]] 
GetCell]] "
(]]" #
worksheetPart]]# 0
.]]0 1
	Worksheet]]1 :
,]]: ;
$str]]< ?
,]]? @
$num]]A C
)]]C D
;]]D E
cell^^ 
.^^ 
	CellValue^^ "
=^^# $
new^^% (
	CellValue^^) 2
(^^2 3
model^^3 8
.^^8 9
ClickedPercentage^^9 J
)^^J K
;^^K L
cell__ 
.__ 
DataType__ !
=__" #
new__$ '
	EnumValue__( 1
<__1 2

CellValues__2 <
>__< =
(__= >

CellValues__> H
.__H I
String__I O
)__O P
;__P Q
cellaa 
=aa 
GetCellaa "
(aa" #
worksheetPartaa# 0
.aa0 1
	Worksheetaa1 :
,aa: ;
$straa< ?
,aa? @
$numaaA C
)aaC D
;aaD E
cellbb 
.bb 
	CellValuebb "
=bb# $
newbb% (
	CellValuebb) 2
(bb2 3
modelbb3 8
.bb8 9!
ClickToOpenPercentagebb9 N
)bbN O
;bbO P
cellcc 
.cc 
DataTypecc !
=cc" #
newcc$ '
	EnumValuecc( 1
<cc1 2

CellValuescc2 <
>cc< =
(cc= >

CellValuescc> H
.ccH I
StringccI O
)ccO P
;ccP Q
cellff 
=ff 
GetCellff "
(ff" #
worksheetPartff# 0
.ff0 1
	Worksheetff1 :
,ff: ;
$strff< ?
,ff? @
$numffA C
)ffC D
;ffD E
cellgg 
.gg 
	CellValuegg "
=gg# $
newgg% (
	CellValuegg) 2
(gg2 3
modelgg3 8
.gg8 9
Bouncegg9 ?
)gg? @
;gg@ A
cellhh 
.hh 
DataTypehh !
=hh" #
newhh$ '
	EnumValuehh( 1
<hh1 2

CellValueshh2 <
>hh< =
(hh= >

CellValueshh> H
.hhH I
StringhhI O
)hhO P
;hhP Q
celljj 
=jj 
GetCelljj "
(jj" #
worksheetPartjj# 0
.jj0 1
	Worksheetjj1 :
,jj: ;
$strjj< ?
,jj? @
$numjjA C
)jjC D
;jjD E
cellkk 
.kk 
	CellValuekk "
=kk# $
newkk% (
	CellValuekk) 2
(kk2 3
modelkk3 8
.kk8 9
Optkk9 <
)kk< =
;kk= >
cellll 
.ll 
DataTypell !
=ll" #
newll$ '
	EnumValuell( 1
<ll1 2

CellValuesll2 <
>ll< =
(ll= >

CellValuesll> H
.llH I
StringllI O
)llO P
;llP Q
celloo 
=oo 
GetCelloo "
(oo" #
worksheetPartoo# 0
.oo0 1
	Worksheetoo1 :
,oo: ;
$stroo< ?
,oo? @
$numooA C
)ooC D
;ooD E
cellpp 
.pp 
	CellValuepp "
=pp# $
newpp% (
	CellValuepp) 2
(pp2 3
modelpp3 8
.pp8 9
Desktoppp9 @
)pp@ A
;ppA B
cellqq 
.qq 
DataTypeqq !
=qq" #
newqq$ '
	EnumValueqq( 1
<qq1 2

CellValuesqq2 <
>qq< =
(qq= >

CellValuesqq> H
.qqH I
StringqqI O
)qqO P
;qqP Q
cellss 
=ss 
GetCellss "
(ss" #
worksheetPartss# 0
.ss0 1
	Worksheetss1 :
,ss: ;
$strss< ?
,ss? @
$numssA C
)ssC D
;ssD E
celltt 
.tt 
	CellValuett "
=tt# $
newtt% (
	CellValuett) 2
(tt2 3
modeltt3 8
.tt8 9
Mobilett9 ?
)tt? @
;tt@ A
celluu 
.uu 
DataTypeuu !
=uu" #
newuu$ '
	EnumValueuu( 1
<uu1 2

CellValuesuu2 <
>uu< =
(uu= >

CellValuesuu> H
.uuH I
StringuuI O
)uuO P
;uuP Q
cellxx 
=xx 
GetCellxx "
(xx" #
worksheetPartxx# 0
.xx0 1
	Worksheetxx1 :
,xx: ;
$strxx< ?
,xx? @
$numxxA C
)xxC D
;xxD E
cellyy 
.yy 
	CellValueyy "
=yy# $
newyy% (
	CellValueyy) 2
(yy2 3
modelyy3 8
.yy8 9
SubjectLineyy9 D
)yyD E
;yyE F
cellzz 
.zz 
DataTypezz !
=zz" #
newzz$ '
	EnumValuezz( 1
<zz1 2

CellValueszz2 <
>zz< =
(zz= >

CellValueszz> H
.zzH I
StringzzI O
)zzO P
;zzP Q
cell|| 
=|| 
GetCell|| "
(||" #
worksheetPart||# 0
.||0 1
	Worksheet||1 :
,||: ;
$str||< ?
,||? @
$num||A C
)||C D
;||D E
cell}} 
.}} 
	CellValue}} "
=}}# $
new}}% (
	CellValue}}) 2
(}}2 3
model}}3 8
.}}8 9
FromLine}}9 A
)}}A B
;}}B C
cell~~ 
.~~ 
DataType~~ !
=~~" #
new~~$ '
	EnumValue~~( 1
<~~1 2

CellValues~~2 <
>~~< =
(~~= >

CellValues~~> H
.~~H I
String~~I O
)~~O P
;~~P Q
if
ÑÑ 
(
ÑÑ 
File
ÑÑ 
.
ÑÑ 
Exists
ÑÑ #
(
ÑÑ# $
imageFilePath
ÑÑ$ 1
)
ÑÑ1 2
)
ÑÑ2 3
AddImage
ÖÖ  
(
ÖÖ  !
worksheetPart
ÖÖ! .
,
ÖÖ. /
imageFilePath
ÖÖ0 =
,
ÖÖ= >
$num
ÖÖ? A
,
ÖÖA B
$num
ÖÖC D
)
ÖÖD E
;
ÖÖE F
cell
áá 
=
áá 
GetCell
áá "
(
áá" #
worksheetPart
áá# 0
.
áá0 1
	Worksheet
áá1 :
,
áá: ;
$str
áá< ?
,
áá? @
$num
ááA C
)
ááC D
;
ááD E
cell
àà 
.
àà 
	CellValue
àà "
=
àà# $
new
àà% (
	CellValue
àà) 2
(
àà2 3
model
àà3 8
.
àà8 9
OrderNumber
àà9 D
)
ààD E
;
ààE F
cell
ââ 
.
ââ 
DataType
ââ !
=
ââ" #
new
ââ$ '
	EnumValue
ââ( 1
<
ââ1 2

CellValues
ââ2 <
>
ââ< =
(
ââ= >

CellValues
ââ> H
.
ââH I
String
ââI O
)
ââO P
;
ââP Q
cell
ãã 
=
ãã 
GetCell
ãã "
(
ãã" #
worksheetPart
ãã# 0
.
ãã0 1
	Worksheet
ãã1 :
,
ãã: ;
$str
ãã< ?
,
ãã? @
$num
ããA C
)
ããC D
;
ããD E
cell
åå 
.
åå 
	CellValue
åå "
=
åå# $
new
åå% (
	CellValue
åå) 2
(
åå2 3
model
åå3 8
.
åå8 9
	StartDate
åå9 B
)
ååB C
;
ååC D
cell
çç 
.
çç 
DataType
çç !
=
çç" #
new
çç$ '
	EnumValue
çç( 1
<
çç1 2

CellValues
çç2 <
>
çç< =
(
çç= >

CellValues
çç> H
.
ççH I
String
ççI O
)
ççO P
;
ççP Q
cell
èè 
=
èè 
GetCell
èè "
(
èè" #
worksheetPart
èè# 0
.
èè0 1
	Worksheet
èè1 :
,
èè: ;
$str
èè< ?
,
èè? @
$num
èèA C
)
èèC D
;
èèD E
cell
êê 
.
êê 
	CellValue
êê "
=
êê# $
new
êê% (
	CellValue
êê) 2
(
êê2 3
DateTime
êê3 ;
.
êê; <
Now
êê< ?
.
êê? @
ToString
êê@ H
(
êêH I
StringConstants
êêI X
.
êêX Y
DateFormatSlashes
êêY j
)
êêj k
)
êêk l
;
êêl m
cell
ëë 
.
ëë 
DataType
ëë !
=
ëë" #
new
ëë$ '
	EnumValue
ëë( 1
<
ëë1 2

CellValues
ëë2 <
>
ëë< =
(
ëë= >

CellValues
ëë> H
.
ëëH I
String
ëëI O
)
ëëO P
;
ëëP Q
uint
ìì 
start
ìì 
=
ìì  
$num
ìì! #
;
ìì# $
foreach
îî 
(
îî 
var
îî  
vm
îî! #
in
îî$ &
model
îî' ,
.
îî, -
PerLink
îî- 4
)
îî4 5
{
ïï "
PopulateRowTemplate1
ññ ,
(
ññ, -
worksheetPart
ññ- :
.
ññ: ;
	Worksheet
ññ; D
,
ññD E
vm
ññF H
,
ññH I
start
ññJ O
)
ññO P
;
ññP Q
start
óó 
++
óó 
;
óó  
}
òò 
worksheetPart
úú !
.
úú! "
	Worksheet
úú" +
.
úú+ ,
Save
úú, 0
(
úú0 1
)
úú1 2
;
úú2 3
spreadSheet
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 
File
üü 
.
üü 
WriteAllBytes
üü "
(
üü" #

outputFile
üü# -
,
üü- .
stream
üü/ 5
.
üü5 6
ToArray
üü6 =
(
üü= >
)
üü> ?
)
üü? @
;
üü@ A
}
†† 
}
°° 	
public
££ 
static
££ 
void
££ 
GenerateTemplate2
££ ,
(
££, - 
CampaignTrackingVm
££- ?
model
££@ E
,
££E F
string
££G M
templateFile
££N Z
,
££Z [
string
££\ b
logoFilePath
££c o
,
££o p
string
££q w
imageFilePath££x Ö
,££Ö Ü
string££á ç

outputFile££é ò
)££ò ô
{
§§ 	
File
•• 
.
•• 
Copy
•• 
(
•• 
templateFile
•• "
,
••" #

outputFile
••$ .
,
••. /
true
••0 4
)
••4 5
;
••5 6
byte
ßß 
[
ßß 
]
ßß 
	byteArray
ßß 
=
ßß 
File
ßß #
.
ßß# $
ReadAllBytes
ßß$ 0
(
ßß0 1

outputFile
ßß1 ;
)
ßß; <
;
ßß< =
using
®® 
(
®® 
MemoryStream
®® 
stream
®®  &
=
®®' (
new
®®) ,
MemoryStream
®®- 9
(
®®9 :
)
®®: ;
)
®®; <
{
©© 
stream
™™ 
.
™™ 
Write
™™ 
(
™™ 
	byteArray
™™ &
,
™™& '
$num
™™( )
,
™™) *
	byteArray
™™+ 4
.
™™4 5
Length
™™5 ;
)
™™; <
;
™™< =
using
´´ 
(
´´ !
SpreadsheetDocument
´´ *
spreadSheet
´´+ 6
=
´´7 8!
SpreadsheetDocument
´´9 L
.
´´L M
Open
´´M Q
(
´´Q R
stream
´´R X
,
´´X Y
true
´´Z ^
)
´´^ _
)
´´_ `
{
¨¨ 
IEnumerable
ÆÆ 
<
ÆÆ  
Sheet
ÆÆ  %
>
ÆÆ% &
sheets
ÆÆ' -
=
ÆÆ. /
spreadSheet
ÆÆ0 ;
.
ÆÆ; <
WorkbookPart
ÆÆ< H
.
ÆÆH I
Workbook
ÆÆI Q
.
ØØ 
GetFirstChild
ØØ &
<
ØØ& '
Sheets
ØØ' -
>
ØØ- .
(
ØØ. /
)
ØØ/ 0
.
ØØ0 1
Elements
ØØ1 9
<
ØØ9 :
Sheet
ØØ: ?
>
ØØ? @
(
ØØ@ A
)
ØØA B
.
∞∞ 
Where
∞∞ 
(
∞∞ 
s
∞∞  
=>
∞∞! #
s
∞∞$ %
.
∞∞% &
Name
∞∞& *
==
∞∞+ -
$str
∞∞. >
)
∞∞> ?
.
±± 
ToArray
±±  
(
±±  !
)
±±! "
;
±±" #
if
≥≥ 
(
≥≥ 
!
≥≥ 
sheets
≥≥ 
.
≥≥  
Any
≥≥  #
(
≥≥# $
)
≥≥$ %
)
≥≥% &
{
¥¥ 
throw
µµ 
new
µµ !
AdsException
µµ" .
(
µµ. /
$str
µµ/ :
)
µµ: ;
;
µµ; <
}
∂∂ 
string
∏∏ 
relationshipId
∏∏ )
=
∏∏* +
sheets
∏∏, 2
.
∏∏2 3
First
∏∏3 8
(
∏∏8 9
)
∏∏9 :
.
∏∏: ;
Id
∏∏; =
.
∏∏= >
Value
∏∏> C
;
∏∏C D
WorksheetPart
ππ !
worksheetPart
ππ" /
=
ππ0 1
(
ππ2 3
WorksheetPart
ππ3 @
)
ππ@ A
spreadSheet
ππA L
.
ππL M
WorkbookPart
ππM Y
.
ππY Z
GetPartById
ππZ e
(
ππe f
relationshipId
ππf t
)
ππt u
;
ππu v
AddImage
ΩΩ 
(
ΩΩ 
worksheetPart
ΩΩ *
,
ΩΩ* +
logoFilePath
ΩΩ, 8
,
ΩΩ8 9
$num
ΩΩ: ;
,
ΩΩ; <
$num
ΩΩ= >
)
ΩΩ> ?
;
ΩΩ? @
Cell
øø 
cell
øø 
=
øø 
GetCell
øø  '
(
øø' (
worksheetPart
øø( 5
.
øø5 6
	Worksheet
øø6 ?
,
øø? @
$str
øøA D
,
øøD E
$num
øøF G
)
øøG H
;
øøH I
cell
¿¿ 
.
¿¿ 
	CellValue
¿¿ "
=
¿¿# $
new
¿¿% (
	CellValue
¿¿) 2
(
¿¿2 3
model
¿¿3 8
.
¿¿8 9
	StartDate
¿¿9 B
)
¿¿B C
;
¿¿C D
cell
¡¡ 
.
¡¡ 
DataType
¡¡ !
=
¡¡" #
new
¡¡$ '
	EnumValue
¡¡( 1
<
¡¡1 2

CellValues
¡¡2 <
>
¡¡< =
(
¡¡= >

CellValues
¡¡> H
.
¡¡H I
String
¡¡I O
)
¡¡O P
;
¡¡P Q
cell
√√ 
=
√√ 
GetCell
√√ "
(
√√" #
worksheetPart
√√# 0
.
√√0 1
	Worksheet
√√1 :
,
√√: ;
$str
√√< ?
,
√√? @
$num
√√A B
)
√√B C
;
√√C D
cell
ƒƒ 
.
ƒƒ 
	CellValue
ƒƒ "
=
ƒƒ# $
new
ƒƒ% (
	CellValue
ƒƒ) 2
(
ƒƒ2 3
model
ƒƒ3 8
.
ƒƒ8 9
SubjectLine
ƒƒ9 D
)
ƒƒD E
;
ƒƒE F
cell
≈≈ 
.
≈≈ 
DataType
≈≈ !
=
≈≈" #
new
≈≈$ '
	EnumValue
≈≈( 1
<
≈≈1 2

CellValues
≈≈2 <
>
≈≈< =
(
≈≈= >

CellValues
≈≈> H
.
≈≈H I
String
≈≈I O
)
≈≈O P
;
≈≈P Q
cell
«« 
=
«« 
GetCell
«« "
(
««" #
worksheetPart
««# 0
.
««0 1
	Worksheet
««1 :
,
««: ;
$str
««< ?
,
««? @
$num
««A C
)
««C D
;
««D E
cell
»» 
.
»» 
	CellValue
»» "
=
»»# $
new
»»% (
	CellValue
»») 2
(
»»2 3
model
»»3 8
.
»»8 9
FromLine
»»9 A
)
»»A B
;
»»B C
cell
…… 
.
…… 
DataType
…… !
=
……" #
new
……$ '
	EnumValue
……( 1
<
……1 2

CellValues
……2 <
>
……< =
(
……= >

CellValues
……> H
.
……H I
String
……I O
)
……O P
;
……P Q
cell
ÀÀ 
=
ÀÀ 
GetCell
ÀÀ "
(
ÀÀ" #
worksheetPart
ÀÀ# 0
.
ÀÀ0 1
	Worksheet
ÀÀ1 :
,
ÀÀ: ;
$str
ÀÀ< ?
,
ÀÀ? @
$num
ÀÀA C
)
ÀÀC D
;
ÀÀD E
cell
ÃÃ 
.
ÃÃ 
	CellValue
ÃÃ "
=
ÃÃ# $
new
ÃÃ% (
	CellValue
ÃÃ) 2
(
ÃÃ2 3
model
ÃÃ3 8
.
ÃÃ8 9

WhiteLabel
ÃÃ9 C
)
ÃÃC D
;
ÃÃD E
cell
ÕÕ 
.
ÕÕ 
DataType
ÕÕ !
=
ÕÕ" #
new
ÕÕ$ '
	EnumValue
ÕÕ( 1
<
ÕÕ1 2

CellValues
ÕÕ2 <
>
ÕÕ< =
(
ÕÕ= >

CellValues
ÕÕ> H
.
ÕÕH I
String
ÕÕI O
)
ÕÕO P
;
ÕÕP Q
cell
œœ 
=
œœ 
GetCell
œœ "
(
œœ" #
worksheetPart
œœ# 0
.
œœ0 1
	Worksheet
œœ1 :
,
œœ: ;
$str
œœ< ?
,
œœ? @
$num
œœA C
)
œœC D
;
œœD E
cell
–– 
.
–– 
	CellValue
–– "
=
––# $
new
––% (
	CellValue
––) 2
(
––2 3
model
––3 8
.
––8 9
OrderNumber
––9 D
)
––D E
;
––E F
cell
—— 
.
—— 
DataType
—— !
=
——" #
new
——$ '
	EnumValue
——( 1
<
——1 2

CellValues
——2 <
>
——< =
(
——= >

CellValues
——> H
.
——H I
String
——I O
)
——O P
;
——P Q
cell
”” 
=
”” 
GetCell
”” "
(
””" #
worksheetPart
””# 0
.
””0 1
	Worksheet
””1 :
,
””: ;
$str
””< ?
,
””? @
$num
””A C
)
””C D
;
””D E
cell
‘‘ 
.
‘‘ 
	CellValue
‘‘ "
=
‘‘# $
new
‘‘% (
	CellValue
‘‘) 2
(
‘‘2 3
model
‘‘3 8
.
‘‘8 9
CampaignName
‘‘9 E
)
‘‘E F
;
‘‘F G
cell
’’ 
.
’’ 
DataType
’’ !
=
’’" #
new
’’$ '
	EnumValue
’’( 1
<
’’1 2

CellValues
’’2 <
>
’’< =
(
’’= >

CellValues
’’> H
.
’’H I
String
’’I O
)
’’O P
;
’’P Q
cell
ÿÿ 
=
ÿÿ 
GetCell
ÿÿ "
(
ÿÿ" #
worksheetPart
ÿÿ# 0
.
ÿÿ0 1
	Worksheet
ÿÿ1 :
,
ÿÿ: ;
$str
ÿÿ< ?
,
ÿÿ? @
$num
ÿÿA B
)
ÿÿB C
;
ÿÿC D
cell
ŸŸ 
.
ŸŸ 
	CellValue
ŸŸ "
=
ŸŸ# $
new
ŸŸ% (
	CellValue
ŸŸ) 2
(
ŸŸ2 3
model
ŸŸ3 8
.
ŸŸ8 9
Quantity
ŸŸ9 A
)
ŸŸA B
;
ŸŸB C
cell
⁄⁄ 
.
⁄⁄ 
DataType
⁄⁄ !
=
⁄⁄" #
new
⁄⁄$ '
	EnumValue
⁄⁄( 1
<
⁄⁄1 2

CellValues
⁄⁄2 <
>
⁄⁄< =
(
⁄⁄= >

CellValues
⁄⁄> H
.
⁄⁄H I
String
⁄⁄I O
)
⁄⁄O P
;
⁄⁄P Q
cell
‹‹ 
=
‹‹ 
GetCell
‹‹ "
(
‹‹" #
worksheetPart
‹‹# 0
.
‹‹0 1
	Worksheet
‹‹1 :
,
‹‹: ;
$str
‹‹< ?
,
‹‹? @
$num
‹‹A B
)
‹‹B C
;
‹‹C D
cell
›› 
.
›› 
	CellValue
›› "
=
››# $
new
››% (
	CellValue
››) 2
(
››2 3
model
››3 8
.
››8 9
OpenedPercentage
››9 I
)
››I J
;
››J K
cell
ﬁﬁ 
.
ﬁﬁ 
DataType
ﬁﬁ !
=
ﬁﬁ" #
new
ﬁﬁ$ '
	EnumValue
ﬁﬁ( 1
<
ﬁﬁ1 2

CellValues
ﬁﬁ2 <
>
ﬁﬁ< =
(
ﬁﬁ= >

CellValues
ﬁﬁ> H
.
ﬁﬁH I
String
ﬁﬁI O
)
ﬁﬁO P
;
ﬁﬁP Q
cell
‡‡ 
=
‡‡ 
GetCell
‡‡ "
(
‡‡" #
worksheetPart
‡‡# 0
.
‡‡0 1
	Worksheet
‡‡1 :
,
‡‡: ;
$str
‡‡< ?
,
‡‡? @
$num
‡‡A C
)
‡‡C D
;
‡‡D E
cell
·· 
.
·· 
	CellValue
·· "
=
··# $
new
··% (
	CellValue
··) 2
(
··2 3
model
··3 8
.
··8 9
ClickedPercentage
··9 J
)
··J K
;
··K L
cell
‚‚ 
.
‚‚ 
DataType
‚‚ !
=
‚‚" #
new
‚‚$ '
	EnumValue
‚‚( 1
<
‚‚1 2

CellValues
‚‚2 <
>
‚‚< =
(
‚‚= >

CellValues
‚‚> H
.
‚‚H I
String
‚‚I O
)
‚‚O P
;
‚‚P Q
cell
‰‰ 
=
‰‰ 
GetCell
‰‰ "
(
‰‰" #
worksheetPart
‰‰# 0
.
‰‰0 1
	Worksheet
‰‰1 :
,
‰‰: ;
$str
‰‰< ?
,
‰‰? @
$num
‰‰A C
)
‰‰C D
;
‰‰D E
cell
ÂÂ 
.
ÂÂ 
	CellValue
ÂÂ "
=
ÂÂ# $
new
ÂÂ% (
	CellValue
ÂÂ) 2
(
ÂÂ2 3
model
ÂÂ3 8
.
ÂÂ8 9#
UnsubToOpenPercentage
ÂÂ9 N
)
ÂÂN O
;
ÂÂO P
cell
ÊÊ 
.
ÊÊ 
DataType
ÊÊ !
=
ÊÊ" #
new
ÊÊ$ '
	EnumValue
ÊÊ( 1
<
ÊÊ1 2

CellValues
ÊÊ2 <
>
ÊÊ< =
(
ÊÊ= >

CellValues
ÊÊ> H
.
ÊÊH I
String
ÊÊI O
)
ÊÊO P
;
ÊÊP Q
cell
ÈÈ 
=
ÈÈ 
GetCell
ÈÈ "
(
ÈÈ" #
worksheetPart
ÈÈ# 0
.
ÈÈ0 1
	Worksheet
ÈÈ1 :
,
ÈÈ: ;
$str
ÈÈ< ?
,
ÈÈ? @
$num
ÈÈA C
)
ÈÈC D
;
ÈÈD E
cell
ÍÍ 
.
ÍÍ 
	CellValue
ÍÍ "
=
ÍÍ# $
new
ÍÍ% (
	CellValue
ÍÍ) 2
(
ÍÍ2 3
model
ÍÍ3 8
.
ÍÍ8 9
Quantity
ÍÍ9 A
)
ÍÍA B
;
ÍÍB C
cell
ÎÎ 
.
ÎÎ 
DataType
ÎÎ !
=
ÎÎ" #
new
ÎÎ$ '
	EnumValue
ÎÎ( 1
<
ÎÎ1 2

CellValues
ÎÎ2 <
>
ÎÎ< =
(
ÎÎ= >

CellValues
ÎÎ> H
.
ÎÎH I
String
ÎÎI O
)
ÎÎO P
;
ÎÎP Q
cell
ÌÌ 
=
ÌÌ 
GetCell
ÌÌ "
(
ÌÌ" #
worksheetPart
ÌÌ# 0
.
ÌÌ0 1
	Worksheet
ÌÌ1 :
,
ÌÌ: ;
$str
ÌÌ< ?
,
ÌÌ? @
$num
ÌÌA C
)
ÌÌC D
;
ÌÌD E
cell
ÓÓ 
.
ÓÓ 
	CellValue
ÓÓ "
=
ÓÓ# $
new
ÓÓ% (
	CellValue
ÓÓ) 2
(
ÓÓ2 3
model
ÓÓ3 8
.
ÓÓ8 9
OpenedPercentage
ÓÓ9 I
)
ÓÓI J
;
ÓÓJ K
cell
ÔÔ 
.
ÔÔ 
DataType
ÔÔ !
=
ÔÔ" #
new
ÔÔ$ '
	EnumValue
ÔÔ( 1
<
ÔÔ1 2

CellValues
ÔÔ2 <
>
ÔÔ< =
(
ÔÔ= >

CellValues
ÔÔ> H
.
ÔÔH I
String
ÔÔI O
)
ÔÔO P
;
ÔÔP Q
cell
ÒÒ 
=
ÒÒ 
GetCell
ÒÒ "
(
ÒÒ" #
worksheetPart
ÒÒ# 0
.
ÒÒ0 1
	Worksheet
ÒÒ1 :
,
ÒÒ: ;
$str
ÒÒ< ?
,
ÒÒ? @
$num
ÒÒA C
)
ÒÒC D
;
ÒÒD E
cell
ÚÚ 
.
ÚÚ 
	CellValue
ÚÚ "
=
ÚÚ# $
new
ÚÚ% (
	CellValue
ÚÚ) 2
(
ÚÚ2 3
model
ÚÚ3 8
.
ÚÚ8 9
Opened
ÚÚ9 ?
)
ÚÚ? @
;
ÚÚ@ A
cell
ÛÛ 
.
ÛÛ 
DataType
ÛÛ !
=
ÛÛ" #
new
ÛÛ$ '
	EnumValue
ÛÛ( 1
<
ÛÛ1 2

CellValues
ÛÛ2 <
>
ÛÛ< =
(
ÛÛ= >

CellValues
ÛÛ> H
.
ÛÛH I
String
ÛÛI O
)
ÛÛO P
;
ÛÛP Q
cell
ıı 
=
ıı 
GetCell
ıı "
(
ıı" #
worksheetPart
ıı# 0
.
ıı0 1
	Worksheet
ıı1 :
,
ıı: ;
$str
ıı< ?
,
ıı? @
$num
ııA C
)
ııC D
;
ııD E
cell
ˆˆ 
.
ˆˆ 
	CellValue
ˆˆ "
=
ˆˆ# $
new
ˆˆ% (
	CellValue
ˆˆ) 2
(
ˆˆ2 3
model
ˆˆ3 8
.
ˆˆ8 9
ClickedPercentage
ˆˆ9 J
)
ˆˆJ K
;
ˆˆK L
cell
˜˜ 
.
˜˜ 
DataType
˜˜ !
=
˜˜" #
new
˜˜$ '
	EnumValue
˜˜( 1
<
˜˜1 2

CellValues
˜˜2 <
>
˜˜< =
(
˜˜= >

CellValues
˜˜> H
.
˜˜H I
String
˜˜I O
)
˜˜O P
;
˜˜P Q
cell
˘˘ 
=
˘˘ 
GetCell
˘˘ "
(
˘˘" #
worksheetPart
˘˘# 0
.
˘˘0 1
	Worksheet
˘˘1 :
,
˘˘: ;
$str
˘˘< ?
,
˘˘? @
$num
˘˘A C
)
˘˘C D
;
˘˘D E
cell
˙˙ 
.
˙˙ 
	CellValue
˙˙ "
=
˙˙# $
new
˙˙% (
	CellValue
˙˙) 2
(
˙˙2 3
model
˙˙3 8
.
˙˙8 9
Clicked
˙˙9 @
)
˙˙@ A
;
˙˙A B
cell
˚˚ 
.
˚˚ 
DataType
˚˚ !
=
˚˚" #
new
˚˚$ '
	EnumValue
˚˚( 1
<
˚˚1 2

CellValues
˚˚2 <
>
˚˚< =
(
˚˚= >

CellValues
˚˚> H
.
˚˚H I
String
˚˚I O
)
˚˚O P
;
˚˚P Q
cell
˝˝ 
=
˝˝ 
GetCell
˝˝ "
(
˝˝" #
worksheetPart
˝˝# 0
.
˝˝0 1
	Worksheet
˝˝1 :
,
˝˝: ;
$str
˝˝< ?
,
˝˝? @
$num
˝˝A C
)
˝˝C D
;
˝˝D E
cell
˛˛ 
.
˛˛ 
	CellValue
˛˛ "
=
˛˛# $
new
˛˛% (
	CellValue
˛˛) 2
(
˛˛2 3
model
˛˛3 8
.
˛˛8 9#
ClickToOpenPercentage
˛˛9 N
)
˛˛N O
;
˛˛O P
cell
ˇˇ 
.
ˇˇ 
DataType
ˇˇ !
=
ˇˇ" #
new
ˇˇ$ '
	EnumValue
ˇˇ( 1
<
ˇˇ1 2

CellValues
ˇˇ2 <
>
ˇˇ< =
(
ˇˇ= >

CellValues
ˇˇ> H
.
ˇˇH I
String
ˇˇI O
)
ˇˇO P
;
ˇˇP Q
cell
ÅÅ 
=
ÅÅ 
GetCell
ÅÅ "
(
ÅÅ" #
worksheetPart
ÅÅ# 0
.
ÅÅ0 1
	Worksheet
ÅÅ1 :
,
ÅÅ: ;
$str
ÅÅ< ?
,
ÅÅ? @
$num
ÅÅA C
)
ÅÅC D
;
ÅÅD E
cell
ÇÇ 
.
ÇÇ 
	CellValue
ÇÇ "
=
ÇÇ# $
new
ÇÇ% (
	CellValue
ÇÇ) 2
(
ÇÇ2 3
$str
ÇÇ3 @
+
ÇÇA B
model
ÇÇC H
.
ÇÇH I
Forwards
ÇÇI Q
)
ÇÇQ R
;
ÇÇR S
cell
ÉÉ 
.
ÉÉ 
DataType
ÉÉ !
=
ÉÉ" #
new
ÉÉ$ '
	EnumValue
ÉÉ( 1
<
ÉÉ1 2

CellValues
ÉÉ2 <
>
ÉÉ< =
(
ÉÉ= >

CellValues
ÉÉ> H
.
ÉÉH I
String
ÉÉI O
)
ÉÉO P
;
ÉÉP Q
cell
ÖÖ 
=
ÖÖ 
GetCell
ÖÖ "
(
ÖÖ" #
worksheetPart
ÖÖ# 0
.
ÖÖ0 1
	Worksheet
ÖÖ1 :
,
ÖÖ: ;
$str
ÖÖ< ?
,
ÖÖ? @
$num
ÖÖA C
)
ÖÖC D
;
ÖÖD E
cell
ÜÜ 
.
ÜÜ 
	CellValue
ÜÜ "
=
ÜÜ# $
new
ÜÜ% (
	CellValue
ÜÜ) 2
(
ÜÜ2 3
model
ÜÜ3 8
.
ÜÜ8 9
UnsubPercentage
ÜÜ9 H
)
ÜÜH I
;
ÜÜI J
cell
áá 
.
áá 
DataType
áá !
=
áá" #
new
áá$ '
	EnumValue
áá( 1
<
áá1 2

CellValues
áá2 <
>
áá< =
(
áá= >

CellValues
áá> H
.
ááH I
String
ááI O
)
ááO P
;
ááP Q
cell
ââ 
=
ââ 
GetCell
ââ "
(
ââ" #
worksheetPart
ââ# 0
.
ââ0 1
	Worksheet
ââ1 :
,
ââ: ;
$str
ââ< ?
,
ââ? @
$num
ââA C
)
ââC D
;
ââD E
cell
ää 
.
ää 
	CellValue
ää "
=
ää# $
new
ää% (
	CellValue
ää) 2
(
ää2 3
model
ää3 8
.
ää8 9
Unsub
ää9 >
)
ää> ?
;
ää? @
cell
ãã 
.
ãã 
DataType
ãã !
=
ãã" #
new
ãã$ '
	EnumValue
ãã( 1
<
ãã1 2

CellValues
ãã2 <
>
ãã< =
(
ãã= >

CellValues
ãã> H
.
ããH I
String
ããI O
)
ããO P
;
ããP Q
cell
çç 
=
çç 
GetCell
çç "
(
çç" #
worksheetPart
çç# 0
.
çç0 1
	Worksheet
çç1 :
,
çç: ;
$str
çç< ?
,
çç? @
$num
ççA C
)
ççC D
;
ççD E
cell
éé 
.
éé 
	CellValue
éé "
=
éé# $
new
éé% (
	CellValue
éé) 2
(
éé2 3
model
éé3 8
.
éé8 9#
UnsubToOpenPercentage
éé9 N
)
ééN O
;
ééO P
cell
èè 
.
èè 
DataType
èè !
=
èè" #
new
èè$ '
	EnumValue
èè( 1
<
èè1 2

CellValues
èè2 <
>
èè< =
(
èè= >

CellValues
èè> H
.
èèH I
String
èèI O
)
èèO P
;
èèP Q
uint
ïï 
start
ïï 
=
ïï  
$num
ïï! #
;
ïï# $
foreach
ññ 
(
ññ 
var
ññ  
vm
ññ! #
in
ññ$ &
model
ññ' ,
.
ññ, -
PerLink
ññ- 4
)
ññ4 5
{
óó "
PopulateRowTemplate2
òò ,
(
òò, -
worksheetPart
òò- :
.
òò: ;
	Worksheet
òò; D
,
òòD E
vm
òòF H
,
òòH I
start
òòJ O
)
òòO P
;
òòP Q
start
ôô 
++
ôô 
;
ôô  
}
öö 
worksheetPart
ûû !
.
ûû! "
	Worksheet
ûû" +
.
ûû+ ,
Save
ûû, 0
(
ûû0 1
)
ûû1 2
;
ûû2 3
spreadSheet
üü 
.
üü  
Close
üü  %
(
üü% &
)
üü& '
;
üü' (
}
†† 
File
°° 
.
°° 
WriteAllBytes
°° "
(
°°" #

outputFile
°°# -
,
°°- .
stream
°°/ 5
.
°°5 6
ToArray
°°6 =
(
°°= >
)
°°> ?
)
°°? @
;
°°@ A
}
¢¢ 
}
££ 	
private
•• 
static
•• 
void
•• "
PopulateRowTemplate1
•• 0
(
••0 1
	Worksheet
••1 :
	worksheet
••; D
,
••D E&
CampaignTrackingDetailVm
••F ^
row
••_ b
,
••b c
uint
••d h
	rowNumber
••i r
)
••r s
{
¶¶ 	
Cell
ßß 
cell
ßß 
=
ßß 
GetCell
ßß 
(
ßß  
	worksheet
ßß  )
,
ßß) *
$str
ßß+ .
,
ßß. /
	rowNumber
ßß0 9
)
ßß9 :
;
ßß: ;
cell
®® 
.
®® 
	CellValue
®® 
=
®® 
new
®®  
	CellValue
®®! *
(
®®* +
row
®®+ .
.
®®. /
Link
®®/ 3
)
®®3 4
;
®®4 5
cell
©© 
.
©© 
DataType
©© 
=
©© 
new
©© 
	EnumValue
©©  )
<
©©) *

CellValues
©©* 4
>
©©4 5
(
©©5 6

CellValues
©©6 @
.
©©@ A
String
©©A G
)
©©G H
;
©©H I
cell
´´ 
=
´´ 
GetCell
´´ 
(
´´ 
	worksheet
´´ $
,
´´$ %
$str
´´& )
,
´´) *
	rowNumber
´´+ 4
)
´´4 5
;
´´5 6
cell
¨¨ 
.
¨¨ 
	CellValue
¨¨ 
=
¨¨ 
new
¨¨  
	CellValue
¨¨! *
(
¨¨* +
row
¨¨+ .
.
¨¨. /

ClickCount
¨¨/ 9
)
¨¨9 :
;
¨¨: ;
cell
≠≠ 
.
≠≠ 
DataType
≠≠ 
=
≠≠ 
new
≠≠ 
	EnumValue
≠≠  )
<
≠≠) *

CellValues
≠≠* 4
>
≠≠4 5
(
≠≠5 6

CellValues
≠≠6 @
.
≠≠@ A
String
≠≠A G
)
≠≠G H
;
≠≠H I
cell
ØØ 
=
ØØ 
GetCell
ØØ 
(
ØØ 
	worksheet
ØØ $
,
ØØ$ %
$str
ØØ& )
,
ØØ) *
	rowNumber
ØØ+ 4
)
ØØ4 5
;
ØØ5 6
cell
∞∞ 
.
∞∞ 
	CellValue
∞∞ 
=
∞∞ 
new
∞∞  
	CellValue
∞∞! *
(
∞∞* +
row
∞∞+ .
.
∞∞. /
UniqueCount
∞∞/ :
)
∞∞: ;
;
∞∞; <
cell
±± 
.
±± 
DataType
±± 
=
±± 
new
±± 
	EnumValue
±±  )
<
±±) *

CellValues
±±* 4
>
±±4 5
(
±±5 6

CellValues
±±6 @
.
±±@ A
String
±±A G
)
±±G H
;
±±H I
cell
≥≥ 
=
≥≥ 
GetCell
≥≥ 
(
≥≥ 
	worksheet
≥≥ $
,
≥≥$ %
$str
≥≥& )
,
≥≥) *
	rowNumber
≥≥+ 4
)
≥≥4 5
;
≥≥5 6
cell
¥¥ 
.
¥¥ 
	CellValue
¥¥ 
=
¥¥ 
new
¥¥  
	CellValue
¥¥! *
(
¥¥* +
row
¥¥+ .
.
¥¥. /
MobileCount
¥¥/ :
)
¥¥: ;
;
¥¥; <
cell
µµ 
.
µµ 
DataType
µµ 
=
µµ 
new
µµ 
	EnumValue
µµ  )
<
µµ) *

CellValues
µµ* 4
>
µµ4 5
(
µµ5 6

CellValues
µµ6 @
.
µµ@ A
String
µµA G
)
µµG H
;
µµH I
}
∂∂ 	
private
∏∏ 
static
∏∏ 
void
∏∏ "
PopulateRowTemplate2
∏∏ 0
(
∏∏0 1
	Worksheet
∏∏1 :
	worksheet
∏∏; D
,
∏∏D E&
CampaignTrackingDetailVm
∏∏F ^
row
∏∏_ b
,
∏∏b c
uint
∏∏d h
	rowNumber
∏∏i r
)
∏∏r s
{
ππ 	
Cell
∫∫ 
cell
∫∫ 
=
∫∫ 
GetCell
∫∫ 
(
∫∫  
	worksheet
∫∫  )
,
∫∫) *
$str
∫∫+ .
,
∫∫. /
	rowNumber
∫∫0 9
)
∫∫9 :
;
∫∫: ;
cell
ªª 
.
ªª 
	CellValue
ªª 
=
ªª 
new
ªª  
	CellValue
ªª! *
(
ªª* +
row
ªª+ .
.
ªª. /
Link
ªª/ 3
)
ªª3 4
;
ªª4 5
cell
ºº 
.
ºº 
DataType
ºº 
=
ºº 
new
ºº 
	EnumValue
ºº  )
<
ºº) *

CellValues
ºº* 4
>
ºº4 5
(
ºº5 6

CellValues
ºº6 @
.
ºº@ A
String
ººA G
)
ººG H
;
ººH I
cell
ææ 
=
ææ 
GetCell
ææ 
(
ææ 
	worksheet
ææ $
,
ææ$ %
$str
ææ& )
,
ææ) *
	rowNumber
ææ+ 4
)
ææ4 5
;
ææ5 6
cell
øø 
.
øø 
	CellValue
øø 
=
øø 
new
øø  
	CellValue
øø! *
(
øø* +
row
øø+ .
.
øø. /

ClickCount
øø/ 9
)
øø9 :
;
øø: ;
cell
¿¿ 
.
¿¿ 
DataType
¿¿ 
=
¿¿ 
new
¿¿ 
	EnumValue
¿¿  )
<
¿¿) *

CellValues
¿¿* 4
>
¿¿4 5
(
¿¿5 6

CellValues
¿¿6 @
.
¿¿@ A
String
¿¿A G
)
¿¿G H
;
¿¿H I
}
¡¡ 	
private
√√ 
static
√√ 
Cell
√√ 
GetCell
√√ #
(
√√# $
	Worksheet
√√$ -
	worksheet
√√. 7
,
√√7 8
string
√√9 ?

columnName
√√@ J
,
√√J K
uint
√√L P
rowIndex
√√Q Y
)
√√Y Z
{
ƒƒ 	
Row
≈≈ 
row
≈≈ 
=
≈≈ 
GetRow
≈≈ 
(
≈≈ 
	worksheet
≈≈ &
,
≈≈& '
rowIndex
≈≈( 0
)
≈≈0 1
;
≈≈1 2
if
«« 
(
«« 
row
«« 
!=
«« 
null
«« 
)
«« 
return
»» 
row
»» 
.
»» 
Elements
»» #
<
»»# $
Cell
»»$ (
>
»»( )
(
»») *
)
»»* +
.
»»+ ,
FirstOrDefault
»», :
(
»»: ;
c
»»; <
=>
»»= ?
string
»»@ F
.
»»F G
Compare
»»G N
(
»»N O
c
»»O P
.
»»P Q
CellReference
»»Q ^
.
»»^ _
Value
»»_ d
,
»»d e

columnName
»»f p
+
»»q r
rowIndex
»»s {
,
»»{ |
true»»} Å
)»»Å Ç
==»»É Ö
$num»»Ü á
)»»á à
;»»à â
var
   
firstRow
   
=
   
GetRow
   !
(
  ! "
	worksheet
  " +
,
  + ,
$num
  - /
)
  / 0
;
  0 1
var
ÀÀ 
lastRow
ÀÀ 
=
ÀÀ 
GetRow
ÀÀ  
(
ÀÀ  !
	worksheet
ÀÀ! *
,
ÀÀ* +
$num
ÀÀ, .
)
ÀÀ. /
;
ÀÀ/ 0
var
œœ 
newRow
œœ 
=
œœ 
	InsertRow
œœ "
(
œœ" #
rowIndex
œœ# +
,
œœ+ ,
	worksheet
œœ- 6
.
œœ6 7
WorksheetPart
œœ7 D
,
œœD E
null
œœF J
,
œœJ K
true
œœL P
)
œœP Q
;
œœQ R
return
—— 
newRow
—— 
.
—— 
Elements
—— "
<
——" #
Cell
——# '
>
——' (
(
——( )
)
——) *
.
——* +
FirstOrDefault
——+ 9
(
——9 :
c
——: ;
=>
——< >
string
——? E
.
——E F
Compare
——F M
(
——M N
c
——N O
.
——O P
CellReference
——P ]
.
——] ^
Value
——^ c
,
——c d

columnName
——e o
+
——p q
rowIndex
——r z
,
——z {
true——| Ä
)——Ä Å
==——Ç Ñ
$num——Ö Ü
)——Ü á
;——á à
}
”” 	
private
’’ 
static
’’ 
Row
’’ 
	CreateRow
’’ $
(
’’$ %
Row
’’% (
firstRow
’’) 1
,
’’1 2
Row
’’3 6
lastRow
’’7 >
,
’’> ?
uint
’’@ D
newRowIndex
’’E P
,
’’P Q
	SheetData
’’R [
	sheetData
’’\ e
)
’’e f
{
÷÷ 	
var
◊◊ 
newRow
◊◊ 
=
◊◊ 
(
◊◊ 
Row
◊◊ 
)
◊◊ 
firstRow
◊◊ &
.
◊◊& '
	CloneNode
◊◊' 0
(
◊◊0 1
true
◊◊1 5
)
◊◊5 6
;
◊◊6 7
foreach
ÿÿ 
(
ÿÿ 
Cell
ÿÿ 
cell
ÿÿ 
in
ÿÿ !
newRow
ÿÿ" (
.
ÿÿ( )
Elements
ÿÿ) 1
<
ÿÿ1 2
Cell
ÿÿ2 6
>
ÿÿ6 7
(
ÿÿ7 8
)
ÿÿ8 9
)
ÿÿ9 :
{
ŸŸ 
string
⁄⁄ 
cellReference
⁄⁄ $
=
⁄⁄% &
cell
⁄⁄' +
.
⁄⁄+ ,
CellReference
⁄⁄, 9
.
⁄⁄9 :
Value
⁄⁄: ?
;
⁄⁄? @
cell
€€ 
.
€€ 
CellReference
€€ "
=
€€# $
new
€€% (
StringValue
€€) 4
(
€€4 5
cellReference
€€5 B
.
€€B C
Replace
€€C J
(
€€J K
firstRow
€€K S
.
€€S T
RowIndex
€€T \
.
€€\ ]
Value
€€] b
.
€€b c
ToString
€€c k
(
€€k l
)
€€l m
,
€€m n
newRowIndex
€€o z
.
€€z {
ToString€€{ É
(€€É Ñ
)€€Ñ Ö
)€€Ö Ü
)€€Ü á
;€€á à
}
‹‹ 
newRow
›› 
.
›› 
RowIndex
›› 
=
›› 
new
›› !
UInt32Value
››" -
(
››- .
newRowIndex
››. 9
)
››9 :
;
››: ;
	sheetData
ﬂﬂ 
.
ﬂﬂ 
InsertAfter
ﬂﬂ !
(
ﬂﬂ! "
newRow
ﬂﬂ" (
,
ﬂﬂ( )
lastRow
ﬂﬂ* 1
)
ﬂﬂ1 2
;
ﬂﬂ2 3
return
‡‡ 
newRow
‡‡ 
;
‡‡ 
}
·· 	
private
‰‰ 
static
‰‰ 
Row
‰‰ 
GetRow
‰‰ !
(
‰‰! "
	Worksheet
‰‰" +
	worksheet
‰‰, 5
,
‰‰5 6
uint
‰‰7 ;
rowIndex
‰‰< D
)
‰‰D E
{
ÂÂ 	
return
ÊÊ 
	worksheet
ÊÊ 
.
ÊÊ 
GetFirstChild
ÊÊ *
<
ÊÊ* +
	SheetData
ÊÊ+ 4
>
ÊÊ4 5
(
ÊÊ5 6
)
ÊÊ6 7
.
ÊÊ7 8
Elements
ÊÊ8 @
<
ÊÊ@ A
Row
ÊÊA D
>
ÊÊD E
(
ÊÊE F
)
ÊÊF G
.
ÊÊG H
FirstOrDefault
ÊÊH V
(
ÊÊV W
r
ÊÊW X
=>
ÊÊY [
r
ÊÊ\ ]
.
ÊÊ] ^
RowIndex
ÊÊ^ f
==
ÊÊg i
rowIndex
ÊÊj r
)
ÊÊr s
;
ÊÊs t
}
ÁÁ 	
public
ıı 
static
ıı 
Row
ıı 
	InsertRow
ıı #
(
ıı# $
uint
ıı$ (
rowIndex
ıı) 1
,
ıı1 2
WorksheetPart
ıı3 @
worksheetPart
ııA N
,
ııN O
Row
ııP S
	insertRow
ııT ]
,
ıı] ^
bool
ıı_ c
isNewLastRow
ııd p
=
ııq r
false
ııs x
)
ııx y
{
ˆˆ 	
	Worksheet
˜˜ 
	worksheet
˜˜ 
=
˜˜  !
worksheetPart
˜˜" /
.
˜˜/ 0
	Worksheet
˜˜0 9
;
˜˜9 :
	SheetData
¯¯ 
	sheetData
¯¯ 
=
¯¯  !
	worksheet
¯¯" +
.
¯¯+ ,
GetFirstChild
¯¯, 9
<
¯¯9 :
	SheetData
¯¯: C
>
¯¯C D
(
¯¯D E
)
¯¯E F
;
¯¯F G
Row
˙˙ 
retRow
˙˙ 
=
˙˙ 
!
˙˙ 
isNewLastRow
˙˙ &
?
˙˙' (
	sheetData
˙˙) 2
.
˙˙2 3
Elements
˙˙3 ;
<
˙˙; <
Row
˙˙< ?
>
˙˙? @
(
˙˙@ A
)
˙˙A B
.
˙˙B C
FirstOrDefault
˙˙C Q
(
˙˙Q R
r
˙˙R S
=>
˙˙T V
r
˙˙W X
.
˙˙X Y
RowIndex
˙˙Y a
==
˙˙b d
rowIndex
˙˙e m
)
˙˙m n
:
˙˙o p
null
˙˙q u
;
˙˙u v
if
˝˝ 
(
˝˝ 
retRow
˝˝ 
!=
˝˝ 
null
˝˝ 
)
˝˝ 
{
˛˛ 
if
ÄÄ 
(
ÄÄ 
	insertRow
ÄÄ 
!=
ÄÄ  
null
ÄÄ! %
)
ÄÄ% &
{
ÅÅ 
UpdateRowIndexes
ÇÇ $
(
ÇÇ$ %
worksheetPart
ÇÇ% 2
,
ÇÇ2 3
rowIndex
ÇÇ4 <
,
ÇÇ< =
false
ÇÇ> C
)
ÇÇC D
;
ÇÇD E(
UpdateMergedCellReferences
ÉÉ .
(
ÉÉ. /
worksheetPart
ÉÉ/ <
,
ÉÉ< =
rowIndex
ÉÉ> F
,
ÉÉF G
false
ÉÉH M
)
ÉÉM N
;
ÉÉN O'
UpdateHyperlinkReferences
ÑÑ -
(
ÑÑ- .
worksheetPart
ÑÑ. ;
,
ÑÑ; <
rowIndex
ÑÑ= E
,
ÑÑE F
false
ÑÑG L
)
ÑÑL M
;
ÑÑM N
retRow
áá 
=
áá 
	sheetData
áá &
.
áá& '
InsertBefore
áá' 3
(
áá3 4
	insertRow
áá4 =
,
áá= >
retRow
áá? E
)
ááE F
;
ááF G
string
ââ 
curIndex
ââ #
=
ââ$ %
retRow
ââ& ,
.
ââ, -
RowIndex
ââ- 5
.
ââ5 6
ToString
ââ6 >
(
ââ> ?
)
ââ? @
;
ââ@ A
string
ää 
newIndex
ää #
=
ää$ %
rowIndex
ää& .
.
ää. /
ToString
ää/ 7
(
ää7 8
)
ää8 9
;
ää9 :
foreach
åå 
(
åå 
Cell
åå !
cell
åå" &
in
åå' )
retRow
åå* 0
.
åå0 1
Elements
åå1 9
<
åå9 :
Cell
åå: >
>
åå> ?
(
åå? @
)
åå@ A
)
ååA B
{
çç 
cell
èè 
.
èè 
CellReference
èè *
=
èè+ ,
new
èè- 0
StringValue
èè1 <
(
èè< =
cell
èè= A
.
èèA B
CellReference
èèB O
.
èèO P
Value
èèP U
.
èèU V
Replace
èèV ]
(
èè] ^
curIndex
èè^ f
,
èèf g
newIndex
èèh p
)
èèp q
)
èèq r
;
èèr s
}
êê 
retRow
ìì 
.
ìì 
RowIndex
ìì #
=
ìì$ %
rowIndex
ìì& .
;
ìì. /
}
îî 
}
ïï 
else
ññ 
{
óó 
Row
öö 
refRow
öö 
=
öö 
!
öö 
isNewLastRow
öö *
?
öö+ ,
	sheetData
öö- 6
.
öö6 7
Elements
öö7 ?
<
öö? @
Row
öö@ C
>
ööC D
(
ööD E
)
ööE F
.
ööF G
FirstOrDefault
ööG U
(
ööU V
row
ööV Y
=>
ööZ \
row
öö] `
.
öö` a
RowIndex
ööa i
>
ööj k
rowIndex
ööl t
)
ööt u
:
ööv w
null
ööx |
;
öö| }
retRow
ùù 
=
ùù 
	insertRow
ùù "
??
ùù# %
new
ùù& )
Row
ùù* -
(
ùù- .
)
ùù. /
{
ùù0 1
RowIndex
ùù2 :
=
ùù; <
rowIndex
ùù= E
}
ùùF G
;
ùùG H
IEnumerable
üü 
<
üü 
Cell
üü  
>
üü  !

cellsInRow
üü" ,
=
üü- .
retRow
üü/ 5
.
üü5 6
Elements
üü6 >
<
üü> ?
Cell
üü? C
>
üüC D
(
üüD E
)
üüE F
;
üüF G
if
°° 
(
°° 

cellsInRow
°° 
.
°° 
Any
°° "
(
°°" #
)
°°# $
)
°°$ %
{
¢¢ 
string
££ 
curIndex
££ #
=
££$ %
retRow
££& ,
.
££, -
RowIndex
££- 5
.
££5 6
ToString
££6 >
(
££> ?
)
££? @
;
££@ A
string
§§ 
newIndex
§§ #
=
§§$ %
rowIndex
§§& .
.
§§. /
ToString
§§/ 7
(
§§7 8
)
§§8 9
;
§§9 :
foreach
¶¶ 
(
¶¶ 
Cell
¶¶ !
cell
¶¶" &
in
¶¶' )

cellsInRow
¶¶* 4
)
¶¶4 5
{
ßß 
cell
©© 
.
©© 
CellReference
©© *
=
©©+ ,
new
©©- 0
StringValue
©©1 <
(
©©< =
cell
©©= A
.
©©A B
CellReference
©©B O
.
©©O P
Value
©©P U
.
©©U V
Replace
©©V ]
(
©©] ^
curIndex
©©^ f
,
©©f g
newIndex
©©h p
)
©©p q
)
©©q r
;
©©r s
}
™™ 
retRow
≠≠ 
.
≠≠ 
RowIndex
≠≠ #
=
≠≠$ %
rowIndex
≠≠& .
;
≠≠. /
}
ÆÆ 
	sheetData
∞∞ 
.
∞∞ 
InsertBefore
∞∞ &
(
∞∞& '
retRow
∞∞' -
,
∞∞- .
refRow
∞∞/ 5
)
∞∞5 6
;
∞∞6 7
}
±± 
return
≥≥ 
retRow
≥≥ 
;
≥≥ 
}
¥¥ 	
private
ΩΩ 
static
ΩΩ 
void
ΩΩ 
UpdateRowIndexes
ΩΩ ,
(
ΩΩ, -
WorksheetPart
ΩΩ- :
worksheetPart
ΩΩ; H
,
ΩΩH I
uint
ΩΩJ N
rowIndex
ΩΩO W
,
ΩΩW X
bool
ΩΩY ]
isDeletedRow
ΩΩ^ j
)
ΩΩj k
{
ææ 	
IEnumerable
¿¿ 
<
¿¿ 
Row
¿¿ 
>
¿¿ 
rows
¿¿ !
=
¿¿" #
worksheetPart
¿¿$ 1
.
¿¿1 2
	Worksheet
¿¿2 ;
.
¿¿; <
Descendants
¿¿< G
<
¿¿G H
Row
¿¿H K
>
¿¿K L
(
¿¿L M
)
¿¿M N
.
¿¿N O
Where
¿¿O T
(
¿¿T U
r
¿¿U V
=>
¿¿W Y
r
¿¿Z [
.
¿¿[ \
RowIndex
¿¿\ d
.
¿¿d e
Value
¿¿e j
>=
¿¿k m
rowIndex
¿¿n v
)
¿¿v w
;
¿¿w x
foreach
¬¬ 
(
¬¬ 
Row
¬¬ 
row
¬¬ 
in
¬¬ 
rows
¬¬  $
)
¬¬$ %
{
√√ 
uint
ƒƒ 
newIndex
ƒƒ 
=
ƒƒ 
(
ƒƒ  !
isDeletedRow
ƒƒ! -
?
ƒƒ. /
row
ƒƒ0 3
.
ƒƒ3 4
RowIndex
ƒƒ4 <
-
ƒƒ= >
$num
ƒƒ? @
:
ƒƒA B
row
ƒƒC F
.
ƒƒF G
RowIndex
ƒƒG O
+
ƒƒP Q
$num
ƒƒR S
)
ƒƒS T
;
ƒƒT U
string
≈≈ 
curRowIndex
≈≈ "
=
≈≈# $
row
≈≈% (
.
≈≈( )
RowIndex
≈≈) 1
.
≈≈1 2
ToString
≈≈2 :
(
≈≈: ;
)
≈≈; <
;
≈≈< =
string
∆∆ 
newRowIndex
∆∆ "
=
∆∆# $
newIndex
∆∆% -
.
∆∆- .
ToString
∆∆. 6
(
∆∆6 7
)
∆∆7 8
;
∆∆8 9
foreach
»» 
(
»» 
Cell
»» 
cell
»» "
in
»»# %
row
»»& )
.
»») *
Elements
»»* 2
<
»»2 3
Cell
»»3 7
>
»»7 8
(
»»8 9
)
»»9 :
)
»»: ;
{
…… 
cell
ÀÀ 
.
ÀÀ 
CellReference
ÀÀ &
=
ÀÀ' (
new
ÀÀ) ,
StringValue
ÀÀ- 8
(
ÀÀ8 9
cell
ÀÀ9 =
.
ÀÀ= >
CellReference
ÀÀ> K
.
ÀÀK L
Value
ÀÀL Q
.
ÀÀQ R
Replace
ÀÀR Y
(
ÀÀY Z
curRowIndex
ÀÀZ e
,
ÀÀe f
newRowIndex
ÀÀg r
)
ÀÀr s
)
ÀÀs t
;
ÀÀt u
}
ÃÃ 
row
œœ 
.
œœ 
RowIndex
œœ 
=
œœ 
newIndex
œœ '
;
œœ' (
}
–– 
}
—— 	
private
€€ 
static
€€ 
void
€€ (
UpdateMergedCellReferences
€€ 6
(
€€6 7
WorksheetPart
€€7 D
worksheetPart
€€E R
,
€€R S
uint
€€T X
rowIndex
€€Y a
,
€€a b
bool
€€c g
isDeletedRow
€€h t
)
€€t u
{
‹‹ 	
if
›› 
(
›› 
worksheetPart
›› 
.
›› 
	Worksheet
›› '
.
››' (
Elements
››( 0
<
››0 1

MergeCells
››1 ;
>
››; <
(
››< =
)
››= >
.
››> ?
Count
››? D
(
››D E
)
››E F
>
››G H
$num
››I J
)
››J K
{
ﬁﬁ 

MergeCells
ﬂﬂ 

mergeCells
ﬂﬂ %
=
ﬂﬂ& '
worksheetPart
ﬂﬂ( 5
.
ﬂﬂ5 6
	Worksheet
ﬂﬂ6 ?
.
ﬂﬂ? @
Elements
ﬂﬂ@ H
<
ﬂﬂH I

MergeCells
ﬂﬂI S
>
ﬂﬂS T
(
ﬂﬂT U
)
ﬂﬂU V
.
ﬂﬂV W
FirstOrDefault
ﬂﬂW e
(
ﬂﬂe f
)
ﬂﬂf g
;
ﬂﬂg h
if
·· 
(
·· 

mergeCells
·· 
!=
·· !
null
··" &
)
··& '
{
‚‚ 
List
‰‰ 
<
‰‰ 
	MergeCell
‰‰ "
>
‰‰" #
mergeCellsList
‰‰$ 2
=
‰‰3 4

mergeCells
‰‰5 ?
.
‰‰? @
Elements
‰‰@ H
<
‰‰H I
	MergeCell
‰‰I R
>
‰‰R S
(
‰‰S T
)
‰‰T U
.
‰‰U V
Where
‰‰V [
(
‰‰[ \
r
‰‰\ ]
=>
‰‰^ `
r
‰‰a b
.
‰‰b c
	Reference
‰‰c l
.
‰‰l m
HasValue
‰‰m u
)
‰‰u v
.
ÂÂU V
Where
ÂÂV [
(
ÂÂ[ \
r
ÂÂ\ ]
=>
ÂÂ^ `
GetRowIndex
ÂÂa l
(
ÂÂl m
r
ÂÂm n
.
ÂÂn o
	Reference
ÂÂo x
.
ÂÂx y
Value
ÂÂy ~
.
ÂÂ~ 
SplitÂÂ Ñ
(ÂÂÑ Ö
$charÂÂÖ à
)ÂÂà â
.ÂÂâ ä
	ElementAtÂÂä ì
(ÂÂì î
$numÂÂî ï
)ÂÂï ñ
)ÂÂñ ó
>=ÂÂò ö
rowIndexÂÂõ £
||ÂÂ§ ¶
GetRowIndex
ÊÊa l
(
ÊÊl m
r
ÊÊm n
.
ÊÊn o
	Reference
ÊÊo x
.
ÊÊx y
Value
ÊÊy ~
.
ÊÊ~ 
SplitÊÊ Ñ
(ÊÊÑ Ö
$charÊÊÖ à
)ÊÊà â
.ÊÊâ ä
	ElementAtÊÊä ì
(ÊÊì î
$numÊÊî ï
)ÊÊï ñ
)ÊÊñ ó
>=ÊÊò ö
rowIndexÊÊõ £
)ÊÊ£ §
.ÊÊ§ •
ToListÊÊ• ´
(ÊÊ´ ¨
)ÊÊ¨ ≠
;ÊÊ≠ Æ
if
ÈÈ 
(
ÈÈ 
isDeletedRow
ÈÈ $
)
ÈÈ$ %
{
ÍÍ 
List
ÎÎ 
<
ÎÎ 
	MergeCell
ÎÎ &
>
ÎÎ& ' 
mergeCellsToDelete
ÎÎ( :
=
ÎÎ; <
mergeCellsList
ÎÎ= K
.
ÎÎK L
Where
ÎÎL Q
(
ÎÎQ R
r
ÎÎR S
=>
ÎÎT V
GetRowIndex
ÎÎW b
(
ÎÎb c
r
ÎÎc d
.
ÎÎd e
	Reference
ÎÎe n
.
ÎÎn o
Value
ÎÎo t
.
ÎÎt u
Split
ÎÎu z
(
ÎÎz {
$char
ÎÎ{ ~
)
ÎÎ~ 
.ÎÎ Ä
	ElementAtÎÎÄ â
(ÎÎâ ä
$numÎÎä ã
)ÎÎã å
)ÎÎå ç
==ÎÎé ê
rowIndexÎÎë ô
||ÎÎö ú
GetRowIndex
ÏÏW b
(
ÏÏb c
r
ÏÏc d
.
ÏÏd e
	Reference
ÏÏe n
.
ÏÏn o
Value
ÏÏo t
.
ÏÏt u
Split
ÏÏu z
(
ÏÏz {
$char
ÏÏ{ ~
)
ÏÏ~ 
.ÏÏ Ä
	ElementAtÏÏÄ â
(ÏÏâ ä
$numÏÏä ã
)ÏÏã å
)ÏÏå ç
==ÏÏé ê
rowIndexÏÏë ô
)ÏÏô ö
.ÏÏö õ
ToListÏÏõ °
(ÏÏ° ¢
)ÏÏ¢ £
;ÏÏ£ §
foreach
ÔÔ 
(
ÔÔ  !
	MergeCell
ÔÔ! *
cellToDelete
ÔÔ+ 7
in
ÔÔ8 : 
mergeCellsToDelete
ÔÔ; M
)
ÔÔM N
{
 
cellToDelete
ÒÒ (
.
ÒÒ( )
Remove
ÒÒ) /
(
ÒÒ/ 0
)
ÒÒ0 1
;
ÒÒ1 2
}
ÚÚ 
mergeCellsList
ıı &
=
ıı' (

mergeCells
ıı) 3
.
ıı3 4
Elements
ıı4 <
<
ıı< =
	MergeCell
ıı= F
>
ııF G
(
ııG H
)
ııH I
.
ııI J
Where
ııJ O
(
ııO P
r
ııP Q
=>
ııR T
r
ııU V
.
ııV W
	Reference
ııW `
.
ıı` a
HasValue
ııa i
)
ııi j
.
ˆˆI J
Where
ˆˆJ O
(
ˆˆO P
r
ˆˆP Q
=>
ˆˆR T
GetRowIndex
ˆˆU `
(
ˆˆ` a
r
ˆˆa b
.
ˆˆb c
	Reference
ˆˆc l
.
ˆˆl m
Value
ˆˆm r
.
ˆˆr s
Split
ˆˆs x
(
ˆˆx y
$char
ˆˆy |
)
ˆˆ| }
.
ˆˆ} ~
	ElementAtˆˆ~ á
(ˆˆá à
$numˆˆà â
)ˆˆâ ä
)ˆˆä ã
>ˆˆå ç
rowIndexˆˆé ñ
||ˆˆó ô
GetRowIndex
˜˜U `
(
˜˜` a
r
˜˜a b
.
˜˜b c
	Reference
˜˜c l
.
˜˜l m
Value
˜˜m r
.
˜˜r s
Split
˜˜s x
(
˜˜x y
$char
˜˜y |
)
˜˜| }
.
˜˜} ~
	ElementAt˜˜~ á
(˜˜á à
$num˜˜à â
)˜˜â ä
)˜˜ä ã
>˜˜å ç
rowIndex˜˜é ñ
)˜˜ñ ó
.˜˜ó ò
ToList˜˜ò û
(˜˜û ü
)˜˜ü †
;˜˜† °
}
¯¯ 
foreach
˚˚ 
(
˚˚ 
	MergeCell
˚˚ &
	mergeCell
˚˚' 0
in
˚˚1 3
mergeCellsList
˚˚4 B
)
˚˚B C
{
¸¸ 
string
˝˝ 
[
˝˝ 
]
˝˝  
cellReference
˝˝! .
=
˝˝/ 0
	mergeCell
˝˝1 :
.
˝˝: ;
	Reference
˝˝; D
.
˝˝D E
Value
˝˝E J
.
˝˝J K
Split
˝˝K P
(
˝˝P Q
$char
˝˝Q T
)
˝˝T U
;
˝˝U V
if
ˇˇ 
(
ˇˇ 
GetRowIndex
ˇˇ '
(
ˇˇ' (
cellReference
ˇˇ( 5
.
ˇˇ5 6
	ElementAt
ˇˇ6 ?
(
ˇˇ? @
$num
ˇˇ@ A
)
ˇˇA B
)
ˇˇB C
>=
ˇˇD F
rowIndex
ˇˇG O
)
ˇˇO P
{
ÄÄ 
string
ÅÅ "

columnName
ÅÅ# -
=
ÅÅ. /
GetColumnName
ÅÅ0 =
(
ÅÅ= >
cellReference
ÅÅ> K
.
ÅÅK L
	ElementAt
ÅÅL U
(
ÅÅU V
$num
ÅÅV W
)
ÅÅW X
)
ÅÅX Y
;
ÅÅY Z
cellReference
ÇÇ )
[
ÇÇ) *
$num
ÇÇ* +
]
ÇÇ+ ,
=
ÇÇ- .
isDeletedRow
ÇÇ/ ;
?
ÇÇ< =

columnName
ÇÇ> H
+
ÇÇI J
(
ÇÇK L
GetRowIndex
ÇÇL W
(
ÇÇW X
cellReference
ÇÇX e
.
ÇÇe f
	ElementAt
ÇÇf o
(
ÇÇo p
$num
ÇÇp q
)
ÇÇq r
)
ÇÇr s
-
ÇÇt u
$num
ÇÇv w
)
ÇÇw x
.
ÇÇx y
ToStringÇÇy Å
(ÇÇÅ Ç
)ÇÇÇ É
:ÇÇÑ Ö&
IncrementCellReferenceÇÇÜ ú
(ÇÇú ù
cellReferenceÇÇù ™
.ÇÇ™ ´
	ElementAtÇÇ´ ¥
(ÇÇ¥ µ
$numÇÇµ ∂
)ÇÇ∂ ∑
,ÇÇ∑ ∏%
CellReferencePartEnumÇÇπ Œ
.ÇÇŒ œ
RowÇÇœ “
)ÇÇ“ ”
;ÇÇ” ‘
}
ÉÉ 
if
ÖÖ 
(
ÖÖ 
GetRowIndex
ÖÖ '
(
ÖÖ' (
cellReference
ÖÖ( 5
.
ÖÖ5 6
	ElementAt
ÖÖ6 ?
(
ÖÖ? @
$num
ÖÖ@ A
)
ÖÖA B
)
ÖÖB C
>=
ÖÖD F
rowIndex
ÖÖG O
)
ÖÖO P
{
ÜÜ 
string
áá "

columnName
áá# -
=
áá. /
GetColumnName
áá0 =
(
áá= >
cellReference
áá> K
.
ááK L
	ElementAt
ááL U
(
ááU V
$num
ááV W
)
ááW X
)
ááX Y
;
ááY Z
cellReference
àà )
[
àà) *
$num
àà* +
]
àà+ ,
=
àà- .
isDeletedRow
àà/ ;
?
àà< =

columnName
àà> H
+
ààI J
(
ààK L
GetRowIndex
ààL W
(
ààW X
cellReference
ààX e
.
ààe f
	ElementAt
ààf o
(
àào p
$num
ààp q
)
ààq r
)
ààr s
-
ààt u
$num
ààv w
)
ààw x
.
ààx y
ToStringàày Å
(ààÅ Ç
)ààÇ É
:ààÑ Ö&
IncrementCellReferenceààÜ ú
(ààú ù
cellReferenceààù ™
.àà™ ´
	ElementAtàà´ ¥
(àà¥ µ
$numààµ ∂
)àà∂ ∑
,àà∑ ∏%
CellReferencePartEnumààπ Œ
.ààŒ œ
Rowààœ “
)àà“ ”
;àà” ‘
}
ââ 
	mergeCell
ãã !
.
ãã! "
	Reference
ãã" +
=
ãã, -
new
ãã. 1
StringValue
ãã2 =
(
ãã= >
cellReference
ãã> K
[
ããK L
$num
ããL M
]
ããM N
+
ããO P
$str
ããQ T
+
ããU V
cellReference
ããW d
[
ããd e
$num
ããe f
]
ããf g
)
ããg h
;
ããh i
}
åå 
}
çç 
}
éé 
}
èè 	
private
óó 
static
óó 
void
óó '
UpdateHyperlinkReferences
óó 5
(
óó5 6
WorksheetPart
óó6 C
worksheetPart
óóD Q
,
óóQ R
uint
óóS W
rowIndex
óóX `
,
óó` a
bool
óób f
isDeletedRow
óóg s
)
óós t
{
òò 	

Hyperlinks
ôô 

hyperlinks
ôô !
=
ôô" #
worksheetPart
ôô$ 1
.
ôô1 2
	Worksheet
ôô2 ;
.
ôô; <
Elements
ôô< D
<
ôôD E

Hyperlinks
ôôE O
>
ôôO P
(
ôôP Q
)
ôôQ R
.
ôôR S
FirstOrDefault
ôôS a
(
ôôa b
)
ôôb c
;
ôôc d
if
õõ 
(
õõ 

hyperlinks
õõ 
!=
õõ 
null
õõ "
)
õõ" #
{
úú 
Match
ùù $
hyperlinkRowIndexMatch
ùù ,
;
ùù, -
uint
ûû 
hyperlinkRowIndex
ûû &
;
ûû& '
foreach
†† 
(
†† 
	Hyperlink
†† "
	hyperlink
††# ,
in
††- /

hyperlinks
††0 :
.
††: ;
Elements
††; C
<
††C D
	Hyperlink
††D M
>
††M N
(
††N O
)
††O P
)
††P Q
{
°° $
hyperlinkRowIndexMatch
¢¢ *
=
¢¢+ ,
Regex
¢¢- 2
.
¢¢2 3
Match
¢¢3 8
(
¢¢8 9
	hyperlink
¢¢9 B
.
¢¢B C
	Reference
¢¢C L
.
¢¢L M
Value
¢¢M R
,
¢¢R S
$str
¢¢T \
)
¢¢\ ]
;
¢¢] ^
if
££ 
(
££ $
hyperlinkRowIndexMatch
££ .
.
££. /
Success
££/ 6
&&
££7 9
uint
££: >
.
££> ?
TryParse
££? G
(
££G H$
hyperlinkRowIndexMatch
££H ^
.
££^ _
Value
££_ d
,
££d e
out
££f i
hyperlinkRowIndex
££j {
)
££{ |
&&
££} !
hyperlinkRowIndex££Ä ë
>=££í î
rowIndex££ï ù
)££ù û
{
§§ 
if
¶¶ 
(
¶¶ 
isDeletedRow
¶¶ (
)
¶¶( )
{
ßß 
if
©© 
(
©©  
hyperlinkRowIndex
©©  1
==
©©2 4
rowIndex
©©5 =
)
©©= >
{
™™ 
	hyperlink
´´  )
.
´´) *
Remove
´´* 0
(
´´0 1
)
´´1 2
;
´´2 3
}
¨¨ 
else
ÆÆ  
{
ØØ 
	hyperlink
∞∞  )
.
∞∞) *
	Reference
∞∞* 3
.
∞∞3 4
Value
∞∞4 9
=
∞∞: ;
	hyperlink
∞∞< E
.
∞∞E F
	Reference
∞∞F O
.
∞∞O P
Value
∞∞P U
.
∞∞U V
Replace
∞∞V ]
(
∞∞] ^$
hyperlinkRowIndexMatch
∞∞^ t
.
∞∞t u
Value
∞∞u z
,
∞∞z {
(
∞∞| } 
hyperlinkRowIndex∞∞} é
-∞∞è ê
$num∞∞ë í
)∞∞í ì
.∞∞ì î
ToString∞∞î ú
(∞∞ú ù
)∞∞ù û
)∞∞û ü
;∞∞ü †
}
≤≤ 
}
≥≥ 
else
µµ 
{
∂∂ 
	hyperlink
∑∑ %
.
∑∑% &
	Reference
∑∑& /
.
∑∑/ 0
Value
∑∑0 5
=
∑∑6 7
	hyperlink
∑∑8 A
.
∑∑A B
	Reference
∑∑B K
.
∑∑K L
Value
∑∑L Q
.
∑∑Q R
Replace
∑∑R Y
(
∑∑Y Z$
hyperlinkRowIndexMatch
∑∑Z p
.
∑∑p q
Value
∑∑q v
,
∑∑v w
(
∑∑x y 
hyperlinkRowIndex∑∑y ä
+∑∑ã å
$num∑∑ç é
)∑∑é è
.∑∑è ê
ToString∑∑ê ò
(∑∑ò ô
)∑∑ô ö
)∑∑ö õ
;∑∑õ ú
}
∏∏ 
}
ππ 
}
∫∫ 
if
ΩΩ 
(
ΩΩ 

hyperlinks
ΩΩ 
.
ΩΩ 
Elements
ΩΩ '
<
ΩΩ' (
	Hyperlink
ΩΩ( 1
>
ΩΩ1 2
(
ΩΩ2 3
)
ΩΩ3 4
.
ΩΩ4 5
Count
ΩΩ5 :
(
ΩΩ: ;
)
ΩΩ; <
==
ΩΩ= ?
$num
ΩΩ@ A
)
ΩΩA B
{
ææ 

hyperlinks
øø 
.
øø 
Remove
øø %
(
øø% &
)
øø& '
;
øø' (
}
¿¿ 
}
¡¡ 
}
¬¬ 	
public
…… 
static
…… 
uint
…… 
GetRowIndex
…… &
(
……& '
string
……' -
cellReference
……. ;
)
……; <
{
   	
Regex
ÃÃ 
regex
ÃÃ 
=
ÃÃ 
new
ÃÃ 
Regex
ÃÃ #
(
ÃÃ# $
$str
ÃÃ$ *
)
ÃÃ* +
;
ÃÃ+ ,
Match
ÕÕ 
match
ÕÕ 
=
ÕÕ 
regex
ÕÕ 
.
ÕÕ  
Match
ÕÕ  %
(
ÕÕ% &
cellReference
ÕÕ& 3
)
ÕÕ3 4
;
ÕÕ4 5
return
œœ 
uint
œœ 
.
œœ 
Parse
œœ 
(
œœ 
match
œœ #
.
œœ# $
Value
œœ$ )
)
œœ) *
;
œœ* +
}
–– 	
public
ŸŸ 
static
ŸŸ 
string
ŸŸ $
IncrementCellReference
ŸŸ 3
(
ŸŸ3 4
string
ŸŸ4 :
	reference
ŸŸ; D
,
ŸŸD E#
CellReferencePartEnum
ŸŸF [
cellRefPart
ŸŸ\ g
)
ŸŸg h
{
⁄⁄ 	
string
€€ 
newReference
€€ 
=
€€  !
	reference
€€" +
;
€€+ ,
if
›› 
(
›› 
cellRefPart
›› 
!=
›› #
CellReferencePartEnum
›› 4
.
››4 5
None
››5 9
&&
››: <
!
››= >
String
››> D
.
››D E
IsNullOrEmpty
››E R
(
››R S
	reference
››S \
)
››\ ]
)
››] ^
{
ﬁﬁ 
string
ﬂﬂ 
[
ﬂﬂ 
]
ﬂﬂ 
parts
ﬂﬂ 
=
ﬂﬂ  
Regex
ﬂﬂ! &
.
ﬂﬂ& '
Split
ﬂﬂ' ,
(
ﬂﬂ, -
	reference
ﬂﬂ- 6
,
ﬂﬂ6 7
$str
ﬂﬂ8 B
)
ﬂﬂB C
;
ﬂﬂC D
if
·· 
(
·· 
cellRefPart
·· 
==
··  "#
CellReferencePartEnum
··# 8
.
··8 9
Column
··9 ?
||
··@ B
cellRefPart
··C N
==
··O Q#
CellReferencePartEnum
··R g
.
··g h
Both
··h l
)
··l m
{
‚‚ 
List
„„ 
<
„„ 
char
„„ 
>
„„ 
col
„„ "
=
„„# $
parts
„„% *
[
„„* +
$num
„„+ ,
]
„„, -
.
„„- .
ToCharArray
„„. 9
(
„„9 :
)
„„: ;
.
„„; <
ToList
„„< B
(
„„B C
)
„„C D
;
„„D E
bool
‰‰ 
needsIncrement
‰‰ '
=
‰‰( )
true
‰‰* .
;
‰‰. /
int
ÂÂ 
index
ÂÂ 
=
ÂÂ 
col
ÂÂ  #
.
ÂÂ# $
Count
ÂÂ$ )
-
ÂÂ* +
$num
ÂÂ, -
;
ÂÂ- .
do
ÁÁ 
{
ËË 
col
ÍÍ 
[
ÍÍ 
index
ÍÍ !
]
ÍÍ! "
=
ÍÍ# $
Letters
ÍÍ% ,
[
ÍÍ, -
Letters
ÍÍ- 4
.
ÍÍ4 5
IndexOf
ÍÍ5 <
(
ÍÍ< =
col
ÍÍ= @
[
ÍÍ@ A
index
ÍÍA F
]
ÍÍF G
)
ÍÍG H
+
ÍÍI J
$num
ÍÍK L
]
ÍÍL M
;
ÍÍM N
if
ÌÌ 
(
ÌÌ 
col
ÌÌ 
[
ÌÌ  
index
ÌÌ  %
]
ÌÌ% &
==
ÌÌ' )
Letters
ÌÌ* 1
[
ÌÌ1 2
Letters
ÌÌ2 9
.
ÌÌ9 :
Count
ÌÌ: ?
-
ÌÌ@ A
$num
ÌÌB C
]
ÌÌC D
)
ÌÌD E
{
ÓÓ 
col
ÔÔ 
[
ÔÔ  
index
ÔÔ  %
]
ÔÔ% &
=
ÔÔ' (
Letters
ÔÔ) 0
[
ÔÔ0 1
$num
ÔÔ1 2
]
ÔÔ2 3
;
ÔÔ3 4
}
 
else
ÒÒ 
{
ÚÚ 
needsIncrement
ÛÛ *
=
ÛÛ+ ,
false
ÛÛ- 2
;
ÛÛ2 3
}
ÙÙ 
}
ˆˆ 
while
ˆˆ 
(
ˆˆ 
needsIncrement
ˆˆ +
&&
ˆˆ, .
--
ˆˆ/ 1
index
ˆˆ1 6
>=
ˆˆ7 9
$num
ˆˆ: ;
)
ˆˆ; <
;
ˆˆ< =
if
˘˘ 
(
˘˘ 
needsIncrement
˘˘ &
)
˘˘& '
{
˙˙ 
col
˚˚ 
.
˚˚ 
Add
˚˚ 
(
˚˚  
Letters
˚˚  '
[
˚˚' (
$num
˚˚( )
]
˚˚) *
)
˚˚* +
;
˚˚+ ,
}
¸¸ 
parts
˛˛ 
[
˛˛ 
$num
˛˛ 
]
˛˛ 
=
˛˛ 
new
˛˛ "
String
˛˛# )
(
˛˛) *
col
˛˛* -
.
˛˛- .
ToArray
˛˛. 5
(
˛˛5 6
)
˛˛6 7
)
˛˛7 8
;
˛˛8 9
}
ˇˇ 
if
ÅÅ 
(
ÅÅ 
cellRefPart
ÅÅ 
==
ÅÅ  "#
CellReferencePartEnum
ÅÅ# 8
.
ÅÅ8 9
Row
ÅÅ9 <
||
ÅÅ= ?
cellRefPart
ÅÅ@ K
==
ÅÅL N#
CellReferencePartEnum
ÅÅO d
.
ÅÅd e
Both
ÅÅe i
)
ÅÅi j
{
ÇÇ 
parts
ÑÑ 
[
ÑÑ 
$num
ÑÑ 
]
ÑÑ 
=
ÑÑ 
(
ÑÑ  
int
ÑÑ  #
.
ÑÑ# $
Parse
ÑÑ$ )
(
ÑÑ) *
parts
ÑÑ* /
[
ÑÑ/ 0
$num
ÑÑ0 1
]
ÑÑ1 2
)
ÑÑ2 3
+
ÑÑ4 5
$num
ÑÑ6 7
)
ÑÑ7 8
.
ÑÑ8 9
ToString
ÑÑ9 A
(
ÑÑA B
)
ÑÑB C
;
ÑÑC D
}
ÖÖ 
newReference
áá 
=
áá 
parts
áá $
[
áá$ %
$num
áá% &
]
áá& '
+
áá( )
parts
áá* /
[
áá/ 0
$num
áá0 1
]
áá1 2
;
áá2 3
}
àà 
return
ää 
newReference
ää 
;
ää  
}
ãã 	
private
íí 
static
íí 
string
íí 
GetColumnName
íí +
(
íí+ ,
string
íí, 2
cellName
íí3 ;
)
íí; <
{
ìì 	
Regex
ïï 
regex
ïï 
=
ïï 
new
ïï 
Regex
ïï #
(
ïï# $
$str
ïï$ /
)
ïï/ 0
;
ïï0 1
Match
ññ 
match
ññ 
=
ññ 
regex
ññ 
.
ññ  
Match
ññ  %
(
ññ% &
cellName
ññ& .
)
ññ. /
;
ññ/ 0
return
òò 
match
òò 
.
òò 
Value
òò 
;
òò 
}
ôô 	
public
öö 
enum
öö #
CellReferencePartEnum
öö )
{
õõ 	
None
úú 
,
úú 
Column
ùù 
,
ùù 
Row
ûû 
,
ûû 
Both
üü 
}
†† 	
private
°° 
static
°° 
List
°° 
<
°° 
char
°°  
>
°°  !
Letters
°°" )
=
°°* +
new
°°, /
List
°°0 4
<
°°4 5
char
°°5 9
>
°°9 :
(
°°: ;
)
°°; <
{
°°= >
$char
°°? B
,
°°B C
$char
°°D G
,
°°G H
$char
°°I L
,
°°L M
$char
°°N Q
,
°°Q R
$char
°°S V
,
°°V W
$char
°°X [
,
°°[ \
$char
°°] `
,
°°` a
$char
°°b e
,
°°e f
$char
°°g j
,
°°j k
$char
°°l o
,
°°o p
$char
°°q t
,
°°t u
$char
°°v y
,
°°y z
$char
°°{ ~
,
°°~ 
$char°°Ä É
,°°É Ñ
$char°°Ö à
,°°à â
$char°°ä ç
,°°ç é
$char°°è í
,°°í ì
$char°°î ó
,°°ó ò
$char°°ô ú
,°°ú ù
$char°°û °
,°°° ¢
$char°°£ ¶
,°°¶ ß
$char°°® ´
,°°´ ¨
$char°°≠ ∞
,°°∞ ±
$char°°≤ µ
,°°µ ∂
$char°°∑ ∫
,°°∫ ª
$char°°º ø
,°°ø ¿
$char°°¡ ƒ
}°°≈ ∆
;°°∆ «
private
¶¶ 
static
¶¶ 
void
¶¶ 
AddImage
¶¶ $
(
¶¶$ %
WorksheetPart
¶¶% 2
worksheetPart
¶¶3 @
,
¶¶@ A
string
¶¶B H
imageFilePath
¶¶I V
,
¶¶V W
int
¶¶X [
	rowNumber
¶¶\ e
,
¶¶e f
int
¶¶g j
	colNumber
¶¶k t
)
¶¶t u
{
ßß 	
Bitmap
®® 
bm
®® 
=
®® 
new
®® 
Bitmap
®® "
(
®®" #
imageFilePath
®®# 0
)
®®0 1
;
®®1 2
DocumentFormat
©© 
.
©© 
OpenXml
©© "
.
©©" #
Drawing
©©# *
.
©©* +
Extents
©©+ 2
extents
©©3 :
=
©©; <
new
©©= @
DocumentFormat
©©A O
.
©©O P
OpenXml
©©P W
.
©©W X
Drawing
©©X _
.
©©_ `
Extents
©©` g
(
©©g h
)
©©h i
;
©©i j
var
™™ 
	extentsCx
™™ 
=
™™ 
(
™™ 
long
™™ !
)
™™! "
bm
™™" $
.
™™$ %
Width
™™% *
*
™™+ ,
(
™™- .
long
™™. 2
)
™™2 3
(
™™3 4
(
™™4 5
float
™™5 :
)
™™: ;
$num
™™; A
/
™™B C
bm
™™D F
.
™™F G"
HorizontalResolution
™™G [
)
™™[ \
;
™™\ ]
var
´´ 
	extentsCy
´´ 
=
´´ 
(
´´ 
long
´´ !
)
´´! "
bm
´´" $
.
´´$ %
Height
´´% +
*
´´, -
(
´´. /
long
´´/ 3
)
´´3 4
(
´´4 5
(
´´5 6
float
´´6 ;
)
´´; <
$num
´´< B
/
´´C D
bm
´´E G
.
´´G H 
VerticalResolution
´´H Z
)
´´Z [
;
´´[ \
bm
¨¨ 
.
¨¨ 
Dispose
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
var
ÆÆ 
	colOffset
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
var
ØØ 
	rowOffset
ØØ 
=
ØØ 
$num
ØØ 
;
ØØ 
var
≥≥ 
drawingsPart
≥≥ 
=
≥≥ 
worksheetPart
≥≥ ,
.
≥≥, -
DrawingsPart
≥≥- 9
;
≥≥9 :
var
¥¥ 
worksheetDrawing
¥¥  
=
¥¥! "
drawingsPart
¥¥# /
.
¥¥/ 0
WorksheetDrawing
¥¥0 @
;
¥¥@ A
var
∂∂ 
	imagePart
∂∂ 
=
∂∂ 
drawingsPart
∂∂ (
.
∂∂( )
AddImagePart
∂∂) 5
(
∂∂5 6
ImagePartType
∂∂6 C
.
∂∂C D
Jpeg
∂∂D H
)
∂∂H I
;
∂∂I J
using
∏∏ 
(
∏∏ 
var
∏∏ 
stream
∏∏ 
=
∏∏ 
new
∏∏  #

FileStream
∏∏$ .
(
∏∏. /
imageFilePath
∏∏/ <
,
∏∏< =
FileMode
∏∏> F
.
∏∏F G
Open
∏∏G K
)
∏∏K L
)
∏∏L M
{
ππ 
	imagePart
∫∫ 
.
∫∫ 
FeedData
∫∫ "
(
∫∫" #
stream
∫∫# )
)
∫∫) *
;
∫∫* +
}
ªª 
var
ΩΩ 
nvps
ΩΩ 
=
ΩΩ 
worksheetDrawing
ΩΩ '
.
ΩΩ' (
Descendants
ΩΩ( 3
<
ΩΩ3 4
Xdr
ΩΩ4 7
.
ΩΩ7 8(
NonVisualDrawingProperties
ΩΩ8 R
>
ΩΩR S
(
ΩΩS T
)
ΩΩT U
;
ΩΩU V
var
ææ 
nvpId
ææ 
=
ææ 
nvps
ææ 
.
ææ 
Count
ææ "
(
ææ" #
)
ææ# $
>
ææ% &
$num
ææ' (
?
ææ) *
(
øø 
UInt32Value
øø 
)
øø 
worksheetDrawing
øø -
.
øø- .
Descendants
øø. 9
<
øø9 :
Xdr
øø: =
.
øø= >(
NonVisualDrawingProperties
øø> X
>
øøX Y
(
øøY Z
)
øøZ [
.
øø[ \
Max
øø\ _
(
øø_ `
p
øø` a
=>
øøb d
p
øøe f
.
øøf g
Id
øøg i
.
øøi j
Value
øøj o
)
øøo p
+
øøq r
$num
øøs t
:
øøu v
$num
¿¿ 
;
¿¿ 
var
¬¬ 
oneCellAnchor
¬¬ 
=
¬¬ 
new
¬¬  #
Xdr
¬¬$ '
.
¬¬' (
OneCellAnchor
¬¬( 5
(
¬¬5 6
new
√√ 
Xdr
√√ 
.
√√ 

FromMarker
√√ "
{
ƒƒ 
ColumnId
≈≈ 
=
≈≈ 
new
≈≈ "
Xdr
≈≈# &
.
≈≈& '
ColumnId
≈≈' /
(
≈≈/ 0
(
≈≈0 1
	colNumber
≈≈1 :
-
≈≈; <
$num
≈≈= >
)
≈≈> ?
.
≈≈? @
ToString
≈≈@ H
(
≈≈H I
)
≈≈I J
)
≈≈J K
,
≈≈K L
RowId
∆∆ 
=
∆∆ 
new
∆∆ 
Xdr
∆∆  #
.
∆∆# $
RowId
∆∆$ )
(
∆∆) *
(
∆∆* +
	rowNumber
∆∆+ 4
-
∆∆5 6
$num
∆∆7 8
)
∆∆8 9
.
∆∆9 :
ToString
∆∆: B
(
∆∆B C
)
∆∆C D
)
∆∆D E
,
∆∆E F
ColumnOffset
««  
=
««! "
new
««# &
Xdr
««' *
.
««* +
ColumnOffset
««+ 7
(
««7 8
	colOffset
««8 A
.
««A B
ToString
««B J
(
««J K
)
««K L
)
««L M
,
««M N
	RowOffset
»» 
=
»» 
new
»»  #
Xdr
»»$ '
.
»»' (
	RowOffset
»»( 1
(
»»1 2
	rowOffset
»»2 ;
.
»»; <
ToString
»»< D
(
»»D E
)
»»E F
)
»»F G
}
…… 
,
…… 
new
   
Xdr
   
.
   
Extent
   
{
    
Cx
  ! #
=
  $ %
	extentsCx
  & /
,
  / 0
Cy
  1 3
=
  4 5
	extentsCy
  6 ?
}
  @ A
,
  A B
new
ÀÀ 
Xdr
ÀÀ 
.
ÀÀ 
Picture
ÀÀ 
(
ÀÀ  
new
ÃÃ 
Xdr
ÃÃ 
.
ÃÃ (
NonVisualPictureProperties
ÃÃ 6
(
ÃÃ6 7
new
ÕÕ 
Xdr
ÕÕ 
.
ÕÕ  (
NonVisualDrawingProperties
ÕÕ  :
{
ÕÕ; <
Id
ÕÕ= ?
=
ÕÕ@ A
nvpId
ÕÕB G
,
ÕÕG H
Name
ÕÕI M
=
ÕÕN O
$str
ÕÕP Z
+
ÕÕ[ \
nvpId
ÕÕ] b
,
ÕÕb c
Description
ÕÕd o
=
ÕÕp q
imageFilePath
ÕÕr 
}ÕÕÄ Å
,ÕÕÅ Ç
new
ŒŒ 
Xdr
ŒŒ 
.
ŒŒ  /
!NonVisualPictureDrawingProperties
ŒŒ  A
(
ŒŒA B
new
ŒŒB E
A
ŒŒF G
.
ŒŒG H
PictureLocks
ŒŒH T
{
ŒŒU V
NoChangeAspect
ŒŒW e
=
ŒŒf g
true
ŒŒh l
}
ŒŒm n
)
ŒŒn o
)
œœ 
,
œœ 
new
–– 
Xdr
–– 
.
–– 
BlipFill
–– $
(
––$ %
new
—— 
A
—— 
.
—— 
Blip
—— "
{
——# $
Embed
——% *
=
——+ ,
drawingsPart
——- 9
.
——9 :
GetIdOfPart
——: E
(
——E F
	imagePart
——F O
)
——O P
,
——P Q
CompressionState
——R b
=
——c d
A
——e f
.
——f g#
BlipCompressionValues
——g |
.
——| }
Print——} Ç
}——É Ñ
,——Ñ Ö
new
““ 
A
““ 
.
““ 
Stretch
““ %
(
““% &
new
““& )
A
““* +
.
““+ ,
FillRectangle
““, 9
(
““9 :
)
““: ;
)
““; <
)
”” 
,
”” 
new
‘‘ 
Xdr
‘‘ 
.
‘‘ 
ShapeProperties
‘‘ +
(
‘‘+ ,
new
’’ 
A
’’ 
.
’’ 
Transform2D
’’ )
(
’’) *
new
÷÷ 
A
÷÷  !
.
÷÷! "
Offset
÷÷" (
{
÷÷) *
X
÷÷+ ,
=
÷÷- .
$num
÷÷/ 0
,
÷÷0 1
Y
÷÷2 3
=
÷÷4 5
$num
÷÷6 7
}
÷÷8 9
,
÷÷9 :
new
◊◊ 
A
◊◊  !
.
◊◊! "
Extents
◊◊" )
{
◊◊* +
Cx
◊◊, .
=
◊◊/ 0
	extentsCx
◊◊1 :
,
◊◊: ;
Cy
◊◊< >
=
◊◊? @
	extentsCy
◊◊A J
}
◊◊K L
)
ÿÿ 
,
ÿÿ 
new
ŸŸ 
A
ŸŸ 
.
ŸŸ 
PresetGeometry
ŸŸ ,
{
ŸŸ- .
Preset
ŸŸ/ 5
=
ŸŸ6 7
A
ŸŸ8 9
.
ŸŸ9 :
ShapeTypeValues
ŸŸ: I
.
ŸŸI J
	Rectangle
ŸŸJ S
}
ŸŸT U
)
⁄⁄ 
)
€€ 
,
€€ 
new
‹‹ 
Xdr
‹‹ 
.
‹‹ 

ClientData
‹‹ "
(
‹‹" #
)
‹‹# $
)
›› 
;
›› 
worksheetDrawing
ﬁﬁ 
.
ﬁﬁ 
Append
ﬁﬁ #
(
ﬁﬁ# $
oneCellAnchor
ﬁﬁ$ 1
)
ﬁﬁ1 2
;
ﬁﬁ2 3
}
˛˛ 	
}
ÄÄ 
}ÅÅ ¶
@E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Reports\ReportModel.cs
	namespace 	
WFP
 
. 
ICT 
. 
Web 
. 
Reports 
{ 
public 

sealed 
class 
ReportModel #
{ 
public 
DataSet 
DataSet 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 

Dictionary		 
<		 
string		  
,		  !
object		" (
>		( )

Parameters		* 4
{		5 6
get		7 :
;		: ;
set		< ?
;		? @
}		A B
public 
ReportModel 
( 
) 
{ 	

Parameters 
= 
new 

Dictionary '
<' (
string( .
,. /
object0 6
>6 7
(7 8
)8 9
;9 :
} 	
} 
} Ê
4E:\NET_PROJECTS\ADSDataDirect\WFP.ICT.Web\Startup.cs
[ 
assembly 	
:	 

OwinStartup 
( 
typeof 
( 
WFP !
.! "
ICT" %
.% &
Web& )
.) *
Startup* 1
)1 2
)2 3
]3 4
	namespace 	
WFP
 
. 
ICT 
. 
Web 
{ 
public 

partial 
class 
Startup  
{ 
public 
void 
Configuration !
(! "
IAppBuilder" -
app. 1
)1 2
{ 	
CultureInfo 
. '
DefaultThreadCurrentCulture 3
=4 5
CultureInfo6 A
.A B
GetCultureInfoB P
(P Q
$strQ X
)X Y
;Y Z
CultureInfo 
. )
DefaultThreadCurrentUICulture 5
=6 7
CultureInfo8 C
.C D
GetCultureInfoD R
(R S
$strS Z
)Z [
;[ \
ConfigureAuth 
( 
app 
) 
;  
SetupInitialSettings  
(  !
)! "
;" #
app 
.  
UseHangfireDashboard $
($ %
$"% '
	/hangfire' 0
"0 1
,1 2
new3 6
DashboardOptions7 G
{ 
Authorization   
=   
new    #
[  # $
]  $ %
{!! 
new## 0
$LocalRequestsOnlyAuthorizationFilter## <
(##< =
)##= >
}$$ 
}%% 
)%% 
;%% 
app&& 
.&& 
UseHangfireServer&& !
(&&! "
)&&" #
;&&# $
app(( 
.(( 

MapSignalR(( 
((( 
)(( 
;(( 
WFPICTUpdater** 
.** 
Instance** "
.**" # 
StartUpdatingClients**# 7
(**7 8
)**8 9
;**9 :
RecurringJob-- 
.-- 
AddOrUpdate-- $
(--$ %
$str--% >
,--> ?
(--@ A
)--A B
=>--C E"
NotificationsProcessor--F \
.--\ ]#
FetchAndCheckForQcRules--] t
(--t u
)--u v
,--v w
Cron--x |
.--| }
HourInterval	--} â
(
--â ä
$num
--ä ã
)
--ã å
)
--å ç
;
--ç é
RecurringJob// 
.// 
AddOrUpdate// $
(//$ %
$str//% =
,//= >
(//? @
)//@ A
=>//B D"
NotificationsProcessor//E [
.//[ \"
SendNotificationEmails//\ r
(//r s
)//s t
,//t u
$str	//v á
)
//á à
;
//à â
}22 	
private44 
void44  
SetupInitialSettings44 )
(44) *
)44* +
{55 	
using66 
(66 
WfpictContext66  
ctx66! $
=66% &
new66' *
WfpictContext66+ 8
(668 9
)669 :
)66: ;
{77 
var88 
userManager88 
=88  !
new88" %
UserManager88& 1
<881 2
Data882 6
.886 7
Entities887 ?
.88? @
WfpUser88@ G
>88G H
(88H I
new88I L
	UserStore88M V
<88V W
Data88W [
.88[ \
Entities88\ d
.88d e
WfpUser88e l
>88l m
(88m n
ctx88n q
)88q r
)88r s
;88s t
userManager99 
.99 

FindByName99 &
(99& '
$str99' .
)99. /
;99/ 0
}:: 
};; 	
}<< 
}== 